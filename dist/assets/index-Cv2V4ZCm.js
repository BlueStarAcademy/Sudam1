var wp=Object.defineProperty;var Np=(e,n,s)=>n in e?wp(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s;var _n=(e,n,s)=>Np(e,typeof n!="symbol"?n+"":n,s);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();function kp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Xu={exports:{}},va={},Zu={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var er=Symbol.for("react.element"),Sp=Symbol.for("react.portal"),Cp=Symbol.for("react.fragment"),Ip=Symbol.for("react.strict_mode"),Pp=Symbol.for("react.profiler"),Ep=Symbol.for("react.provider"),Mp=Symbol.for("react.context"),Tp=Symbol.for("react.forward_ref"),_p=Symbol.for("react.suspense"),Ap=Symbol.for("react.memo"),Rp=Symbol.for("react.lazy"),_c=Symbol.iterator;function Lp(e){return e===null||typeof e!="object"?null:(e=_c&&e[_c]||e["@@iterator"],typeof e=="function"?e:null)}var em={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tm=Object.assign,nm={};function nl(e,n,s){this.props=e,this.context=n,this.refs=nm,this.updater=s||em}nl.prototype.isReactComponent={};nl.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};nl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function sm(){}sm.prototype=nl.prototype;function Po(e,n,s){this.props=e,this.context=n,this.refs=nm,this.updater=s||em}var Eo=Po.prototype=new sm;Eo.constructor=Po;tm(Eo,nl.prototype);Eo.isPureReactComponent=!0;var Ac=Array.isArray,lm=Object.prototype.hasOwnProperty,Mo={current:null},rm={key:!0,ref:!0,__self:!0,__source:!0};function am(e,n,s){var l,r={},a=null,i=null;if(n!=null)for(l in n.ref!==void 0&&(i=n.ref),n.key!==void 0&&(a=""+n.key),n)lm.call(n,l)&&!rm.hasOwnProperty(l)&&(r[l]=n[l]);var o=arguments.length-2;if(o===1)r.children=s;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(l in o=e.defaultProps,o)r[l]===void 0&&(r[l]=o[l]);return{$$typeof:er,type:e,key:a,ref:i,props:r,_owner:Mo.current}}function $p(e,n){return{$$typeof:er,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function To(e){return typeof e=="object"&&e!==null&&e.$$typeof===er}function Bp(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return n[s]})}var Rc=/\/+/g;function Qa(e,n){return typeof e=="object"&&e!==null&&e.key!=null?Bp(""+e.key):n.toString(36)}function Lr(e,n,s,l,r){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case er:case Sp:i=!0}}if(i)return i=e,r=r(i),e=l===""?"."+Qa(i,0):l,Ac(r)?(s="",e!=null&&(s=e.replace(Rc,"$&/")+"/"),Lr(r,n,s,"",function(d){return d})):r!=null&&(To(r)&&(r=$p(r,s+(!r.key||i&&i.key===r.key?"":(""+r.key).replace(Rc,"$&/")+"/")+e)),n.push(r)),1;if(i=0,l=l===""?".":l+":",Ac(e))for(var o=0;o<e.length;o++){a=e[o];var c=l+Qa(a,o);i+=Lr(a,n,s,c,r)}else if(c=Lp(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=l+Qa(a,o++),i+=Lr(a,n,s,c,r);else if(a==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return i}function cr(e,n,s){if(e==null)return e;var l=[],r=0;return Lr(e,l,"","",function(a){return n.call(s,a,r++)}),l}function Op(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var Et={current:null},$r={transition:null},Dp={ReactCurrentDispatcher:Et,ReactCurrentBatchConfig:$r,ReactCurrentOwner:Mo};function im(){throw Error("act(...) is not supported in production builds of React.")}Be.Children={map:cr,forEach:function(e,n,s){cr(e,function(){n.apply(this,arguments)},s)},count:function(e){var n=0;return cr(e,function(){n++}),n},toArray:function(e){return cr(e,function(n){return n})||[]},only:function(e){if(!To(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Be.Component=nl;Be.Fragment=Cp;Be.Profiler=Pp;Be.PureComponent=Po;Be.StrictMode=Ip;Be.Suspense=_p;Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dp;Be.act=im;Be.cloneElement=function(e,n,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=tm({},e.props),r=e.key,a=e.ref,i=e._owner;if(n!=null){if(n.ref!==void 0&&(a=n.ref,i=Mo.current),n.key!==void 0&&(r=""+n.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in n)lm.call(n,c)&&!rm.hasOwnProperty(c)&&(l[c]=n[c]===void 0&&o!==void 0?o[c]:n[c])}var c=arguments.length-2;if(c===1)l.children=s;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];l.children=o}return{$$typeof:er,type:e.type,key:r,ref:a,props:l,_owner:i}};Be.createContext=function(e){return e={$$typeof:Mp,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ep,_context:e},e.Consumer=e};Be.createElement=am;Be.createFactory=function(e){var n=am.bind(null,e);return n.type=e,n};Be.createRef=function(){return{current:null}};Be.forwardRef=function(e){return{$$typeof:Tp,render:e}};Be.isValidElement=To;Be.lazy=function(e){return{$$typeof:Rp,_payload:{_status:-1,_result:e},_init:Op}};Be.memo=function(e,n){return{$$typeof:Ap,type:e,compare:n===void 0?null:n}};Be.startTransition=function(e){var n=$r.transition;$r.transition={};try{e()}finally{$r.transition=n}};Be.unstable_act=im;Be.useCallback=function(e,n){return Et.current.useCallback(e,n)};Be.useContext=function(e){return Et.current.useContext(e)};Be.useDebugValue=function(){};Be.useDeferredValue=function(e){return Et.current.useDeferredValue(e)};Be.useEffect=function(e,n){return Et.current.useEffect(e,n)};Be.useId=function(){return Et.current.useId()};Be.useImperativeHandle=function(e,n,s){return Et.current.useImperativeHandle(e,n,s)};Be.useInsertionEffect=function(e,n){return Et.current.useInsertionEffect(e,n)};Be.useLayoutEffect=function(e,n){return Et.current.useLayoutEffect(e,n)};Be.useMemo=function(e,n){return Et.current.useMemo(e,n)};Be.useReducer=function(e,n,s){return Et.current.useReducer(e,n,s)};Be.useRef=function(e){return Et.current.useRef(e)};Be.useState=function(e){return Et.current.useState(e)};Be.useSyncExternalStore=function(e,n,s){return Et.current.useSyncExternalStore(e,n,s)};Be.useTransition=function(){return Et.current.useTransition()};Be.version="18.3.1";Zu.exports=Be;var f=Zu.exports;const Mn=kp(f);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qp=f,zp=Symbol.for("react.element"),Up=Symbol.for("react.fragment"),Fp=Object.prototype.hasOwnProperty,Gp=qp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Wp={key:!0,ref:!0,__self:!0,__source:!0};function om(e,n,s){var l,r={},a=null,i=null;s!==void 0&&(a=""+s),n.key!==void 0&&(a=""+n.key),n.ref!==void 0&&(i=n.ref);for(l in n)Fp.call(n,l)&&!Wp.hasOwnProperty(l)&&(r[l]=n[l]);if(e&&e.defaultProps)for(l in n=e.defaultProps,n)r[l]===void 0&&(r[l]=n[l]);return{$$typeof:zp,type:e,key:a,ref:i,props:r,_owner:Gp.current}}va.Fragment=Up;va.jsx=om;va.jsxs=om;Xu.exports=va;var t=Xu.exports,Ti={},cm={exports:{}},Ut={},dm={exports:{}},um={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n($,q){var z=$.length;$.push(q);e:for(;0<z;){var W=z-1>>>1,H=$[W];if(0<r(H,q))$[W]=q,$[z]=H,z=W;else break e}}function s($){return $.length===0?null:$[0]}function l($){if($.length===0)return null;var q=$[0],z=$.pop();if(z!==q){$[0]=z;e:for(var W=0,H=$.length,ne=H>>>1;W<ne;){var re=2*(W+1)-1,ce=$[re],ve=re+1,F=$[ve];if(0>r(ce,z))ve<H&&0>r(F,ce)?($[W]=F,$[ve]=z,W=ve):($[W]=ce,$[re]=z,W=re);else if(ve<H&&0>r(F,z))$[W]=F,$[ve]=z,W=ve;else break e}}return q}function r($,q){var z=$.sortIndex-q.sortIndex;return z!==0?z:$.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],d=[],u=1,p=null,m=3,h=!1,y=!1,b=!1,j=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v($){for(var q=s(d);q!==null;){if(q.callback===null)l(d);else if(q.startTime<=$)l(d),q.sortIndex=q.expirationTime,n(c,q);else break;q=s(d)}}function w($){if(b=!1,v($),!y)if(s(c)!==null)y=!0,Q(k);else{var q=s(d);q!==null&&D(w,q.startTime-$)}}function k($,q){y=!1,b&&(b=!1,g(E),E=-1),h=!0;var z=m;try{for(v(q),p=s(c);p!==null&&(!(p.expirationTime>q)||$&&!I());){var W=p.callback;if(typeof W=="function"){p.callback=null,m=p.priorityLevel;var H=W(p.expirationTime<=q);q=e.unstable_now(),typeof H=="function"?p.callback=H:p===s(c)&&l(c),v(q)}else l(c);p=s(c)}if(p!==null)var ne=!0;else{var re=s(d);re!==null&&D(w,re.startTime-q),ne=!1}return ne}finally{p=null,m=z,h=!1}}var P=!1,S=null,E=-1,_=5,C=-1;function I(){return!(e.unstable_now()-C<_)}function R(){if(S!==null){var $=e.unstable_now();C=$;var q=!0;try{q=S(!0,$)}finally{q?A():(P=!1,S=null)}}else P=!1}var A;if(typeof x=="function")A=function(){x(R)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,L=O.port2;O.port1.onmessage=R,A=function(){L.postMessage(null)}}else A=function(){j(R,0)};function Q($){S=$,P||(P=!0,A())}function D($,q){E=j(function(){$(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,Q(k))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return s(c)},e.unstable_next=function($){switch(m){case 1:case 2:case 3:var q=3;break;default:q=m}var z=m;m=q;try{return $()}finally{m=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,q){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var z=m;m=$;try{return q()}finally{m=z}},e.unstable_scheduleCallback=function($,q,z){var W=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?W+z:W):z=W,$){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=z+H,$={id:u++,callback:q,priorityLevel:$,startTime:z,expirationTime:H,sortIndex:-1},z>W?($.sortIndex=z,n(d,$),s(c)===null&&$===s(d)&&(b?(g(E),E=-1):b=!0,D(w,z-W))):($.sortIndex=H,n(c,$),y||h||(y=!0,Q(k))),$},e.unstable_shouldYield=I,e.unstable_wrapCallback=function($){var q=m;return function(){var z=m;m=q;try{return $.apply(this,arguments)}finally{m=z}}}})(um);dm.exports=um;var Hp=dm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vp=f,zt=Hp;function se(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mm=new Set,Tl={};function vs(e,n){Vs(e,n),Vs(e+"Capture",n)}function Vs(e,n){for(Tl[e]=n,e=0;e<n.length;e++)mm.add(n[e])}var Sn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_i=Object.prototype.hasOwnProperty,Kp=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Lc={},$c={};function Qp(e){return _i.call($c,e)?!0:_i.call(Lc,e)?!1:Kp.test(e)?$c[e]=!0:(Lc[e]=!0,!1)}function Jp(e,n,s,l){if(s!==null&&s.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return l?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Yp(e,n,s,l){if(n===null||typeof n>"u"||Jp(e,n,s,l))return!0;if(l)return!1;if(s!==null)switch(s.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Mt(e,n,s,l,r,a,i){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=l,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=n,this.sanitizeURL=a,this.removeEmptyString=i}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){bt[e]=new Mt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];bt[n]=new Mt(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){bt[e]=new Mt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){bt[e]=new Mt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){bt[e]=new Mt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){bt[e]=new Mt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){bt[e]=new Mt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){bt[e]=new Mt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){bt[e]=new Mt(e,5,!1,e.toLowerCase(),null,!1,!1)});var _o=/[\-:]([a-z])/g;function Ao(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(_o,Ao);bt[n]=new Mt(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(_o,Ao);bt[n]=new Mt(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(_o,Ao);bt[n]=new Mt(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){bt[e]=new Mt(e,1,!1,e.toLowerCase(),null,!1,!1)});bt.xlinkHref=new Mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){bt[e]=new Mt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ro(e,n,s,l){var r=bt.hasOwnProperty(n)?bt[n]:null;(r!==null?r.type!==0:l||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(Yp(n,s,r,l)&&(s=null),l||r===null?Qp(n)&&(s===null?e.removeAttribute(n):e.setAttribute(n,""+s)):r.mustUseProperty?e[r.propertyName]=s===null?r.type===3?!1:"":s:(n=r.attributeName,l=r.attributeNamespace,s===null?e.removeAttribute(n):(r=r.type,s=r===3||r===4&&s===!0?"":""+s,l?e.setAttributeNS(l,n,s):e.setAttribute(n,s))))}var Tn=Vp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dr=Symbol.for("react.element"),Es=Symbol.for("react.portal"),Ms=Symbol.for("react.fragment"),Lo=Symbol.for("react.strict_mode"),Ai=Symbol.for("react.profiler"),fm=Symbol.for("react.provider"),xm=Symbol.for("react.context"),$o=Symbol.for("react.forward_ref"),Ri=Symbol.for("react.suspense"),Li=Symbol.for("react.suspense_list"),Bo=Symbol.for("react.memo"),On=Symbol.for("react.lazy"),pm=Symbol.for("react.offscreen"),Bc=Symbol.iterator;function il(e){return e===null||typeof e!="object"?null:(e=Bc&&e[Bc]||e["@@iterator"],typeof e=="function"?e:null)}var lt=Object.assign,Ja;function pl(e){if(Ja===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);Ja=n&&n[1]||""}return`
`+Ja+e}var Ya=!1;function Xa(e,n){if(!e||Ya)return"";Ya=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(d){var l=d}Reflect.construct(e,[],n)}else{try{n.call()}catch(d){l=d}e.call(n.prototype)}else{try{throw Error()}catch(d){l=d}e()}}catch(d){if(d&&l&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),a=l.stack.split(`
`),i=r.length-1,o=a.length-1;1<=i&&0<=o&&r[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(r[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||r[i]!==a[o]){var c=`
`+r[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{Ya=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?pl(e):""}function Xp(e){switch(e.tag){case 5:return pl(e.type);case 16:return pl("Lazy");case 13:return pl("Suspense");case 19:return pl("SuspenseList");case 0:case 2:case 15:return e=Xa(e.type,!1),e;case 11:return e=Xa(e.type.render,!1),e;case 1:return e=Xa(e.type,!0),e;default:return""}}function $i(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ms:return"Fragment";case Es:return"Portal";case Ai:return"Profiler";case Lo:return"StrictMode";case Ri:return"Suspense";case Li:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case xm:return(e.displayName||"Context")+".Consumer";case fm:return(e._context.displayName||"Context")+".Provider";case $o:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Bo:return n=e.displayName||null,n!==null?n:$i(e.type)||"Memo";case On:n=e._payload,e=e._init;try{return $i(e(n))}catch{}}return null}function Zp(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $i(n);case 8:return n===Lo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Zn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function gm(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function eg(e){var n=gm(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),l=""+e[n];if(!e.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var r=s.get,a=s.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return r.call(this)},set:function(i){l=""+i,a.call(this,i)}}),Object.defineProperty(e,n,{enumerable:s.enumerable}),{getValue:function(){return l},setValue:function(i){l=""+i},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function ur(e){e._valueTracker||(e._valueTracker=eg(e))}function hm(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var s=n.getValue(),l="";return e&&(l=gm(e)?e.checked?"true":"false":e.value),e=l,e!==s?(n.setValue(e),!0):!1}function Vr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Bi(e,n){var s=n.checked;return lt({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Oc(e,n){var s=n.defaultValue==null?"":n.defaultValue,l=n.checked!=null?n.checked:n.defaultChecked;s=Zn(n.value!=null?n.value:s),e._wrapperState={initialChecked:l,initialValue:s,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function ym(e,n){n=n.checked,n!=null&&Ro(e,"checked",n,!1)}function Oi(e,n){ym(e,n);var s=Zn(n.value),l=n.type;if(s!=null)l==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Di(e,n.type,s):n.hasOwnProperty("defaultValue")&&Di(e,n.type,Zn(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function Dc(e,n,s){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var l=n.type;if(!(l!=="submit"&&l!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,s||n===e.value||(e.value=n),e.defaultValue=n}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function Di(e,n,s){(n!=="number"||Vr(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var gl=Array.isArray;function zs(e,n,s,l){if(e=e.options,n){n={};for(var r=0;r<s.length;r++)n["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=n.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&l&&(e[s].defaultSelected=!0)}else{for(s=""+Zn(s),n=null,r=0;r<e.length;r++){if(e[r].value===s){e[r].selected=!0,l&&(e[r].defaultSelected=!0);return}n!==null||e[r].disabled||(n=e[r])}n!==null&&(n.selected=!0)}}function qi(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(se(91));return lt({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function qc(e,n){var s=n.value;if(s==null){if(s=n.children,n=n.defaultValue,s!=null){if(n!=null)throw Error(se(92));if(gl(s)){if(1<s.length)throw Error(se(93));s=s[0]}n=s}n==null&&(n=""),s=n}e._wrapperState={initialValue:Zn(s)}}function bm(e,n){var s=Zn(n.value),l=Zn(n.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),n.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),l!=null&&(e.defaultValue=""+l)}function zc(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function vm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zi(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?vm(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mr,jm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,s,l,r){MSApp.execUnsafeLocalFunction(function(){return e(n,s,l,r)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(mr=mr||document.createElement("div"),mr.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=mr.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function _l(e,n){if(n){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=n;return}}e.textContent=n}var bl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tg=["Webkit","ms","Moz","O"];Object.keys(bl).forEach(function(e){tg.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),bl[n]=bl[e]})});function wm(e,n,s){return n==null||typeof n=="boolean"||n===""?"":s||typeof n!="number"||n===0||bl.hasOwnProperty(e)&&bl[e]?(""+n).trim():n+"px"}function Nm(e,n){e=e.style;for(var s in n)if(n.hasOwnProperty(s)){var l=s.indexOf("--")===0,r=wm(s,n[s],l);s==="float"&&(s="cssFloat"),l?e.setProperty(s,r):e[s]=r}}var ng=lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ui(e,n){if(n){if(ng[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(se(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(se(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(se(61))}if(n.style!=null&&typeof n.style!="object")throw Error(se(62))}}function Fi(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gi=null;function Oo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Wi=null,Us=null,Fs=null;function Uc(e){if(e=sr(e)){if(typeof Wi!="function")throw Error(se(280));var n=e.stateNode;n&&(n=Sa(n),Wi(e.stateNode,e.type,n))}}function km(e){Us?Fs?Fs.push(e):Fs=[e]:Us=e}function Sm(){if(Us){var e=Us,n=Fs;if(Fs=Us=null,Uc(e),n)for(e=0;e<n.length;e++)Uc(n[e])}}function Cm(e,n){return e(n)}function Im(){}var Za=!1;function Pm(e,n,s){if(Za)return e(n,s);Za=!0;try{return Cm(e,n,s)}finally{Za=!1,(Us!==null||Fs!==null)&&(Im(),Sm())}}function Al(e,n){var s=e.stateNode;if(s===null)return null;var l=Sa(s);if(l===null)return null;s=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(se(231,n,typeof s));return s}var Hi=!1;if(Sn)try{var ol={};Object.defineProperty(ol,"passive",{get:function(){Hi=!0}}),window.addEventListener("test",ol,ol),window.removeEventListener("test",ol,ol)}catch{Hi=!1}function sg(e,n,s,l,r,a,i,o,c){var d=Array.prototype.slice.call(arguments,3);try{n.apply(s,d)}catch(u){this.onError(u)}}var vl=!1,Kr=null,Qr=!1,Vi=null,lg={onError:function(e){vl=!0,Kr=e}};function rg(e,n,s,l,r,a,i,o,c){vl=!1,Kr=null,sg.apply(lg,arguments)}function ag(e,n,s,l,r,a,i,o,c){if(rg.apply(this,arguments),vl){if(vl){var d=Kr;vl=!1,Kr=null}else throw Error(se(198));Qr||(Qr=!0,Vi=d)}}function js(e){var n=e,s=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(s=n.return),e=n.return;while(e)}return n.tag===3?s:null}function Em(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Fc(e){if(js(e)!==e)throw Error(se(188))}function ig(e){var n=e.alternate;if(!n){if(n=js(e),n===null)throw Error(se(188));return n!==e?null:e}for(var s=e,l=n;;){var r=s.return;if(r===null)break;var a=r.alternate;if(a===null){if(l=r.return,l!==null){s=l;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===s)return Fc(r),e;if(a===l)return Fc(r),n;a=a.sibling}throw Error(se(188))}if(s.return!==l.return)s=r,l=a;else{for(var i=!1,o=r.child;o;){if(o===s){i=!0,s=r,l=a;break}if(o===l){i=!0,l=r,s=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===s){i=!0,s=a,l=r;break}if(o===l){i=!0,l=a,s=r;break}o=o.sibling}if(!i)throw Error(se(189))}}if(s.alternate!==l)throw Error(se(190))}if(s.tag!==3)throw Error(se(188));return s.stateNode.current===s?e:n}function Mm(e){return e=ig(e),e!==null?Tm(e):null}function Tm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Tm(e);if(n!==null)return n;e=e.sibling}return null}var _m=zt.unstable_scheduleCallback,Gc=zt.unstable_cancelCallback,og=zt.unstable_shouldYield,cg=zt.unstable_requestPaint,at=zt.unstable_now,dg=zt.unstable_getCurrentPriorityLevel,Do=zt.unstable_ImmediatePriority,Am=zt.unstable_UserBlockingPriority,Jr=zt.unstable_NormalPriority,ug=zt.unstable_LowPriority,Rm=zt.unstable_IdlePriority,ja=null,hn=null;function mg(e){if(hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(ja,e,void 0,(e.current.flags&128)===128)}catch{}}var on=Math.clz32?Math.clz32:pg,fg=Math.log,xg=Math.LN2;function pg(e){return e>>>=0,e===0?32:31-(fg(e)/xg|0)|0}var fr=64,xr=4194304;function hl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yr(e,n){var s=e.pendingLanes;if(s===0)return 0;var l=0,r=e.suspendedLanes,a=e.pingedLanes,i=s&268435455;if(i!==0){var o=i&~r;o!==0?l=hl(o):(a&=i,a!==0&&(l=hl(a)))}else i=s&~r,i!==0?l=hl(i):a!==0&&(l=hl(a));if(l===0)return 0;if(n!==0&&n!==l&&!(n&r)&&(r=l&-l,a=n&-n,r>=a||r===16&&(a&4194240)!==0))return n;if(l&4&&(l|=s&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=l;0<n;)s=31-on(n),r=1<<s,l|=e[s],n&=~r;return l}function gg(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hg(e,n){for(var s=e.suspendedLanes,l=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-on(a),o=1<<i,c=r[i];c===-1?(!(o&s)||o&l)&&(r[i]=gg(o,n)):c<=n&&(e.expiredLanes|=o),a&=~o}}function Ki(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Lm(){var e=fr;return fr<<=1,!(fr&4194240)&&(fr=64),e}function ei(e){for(var n=[],s=0;31>s;s++)n.push(e);return n}function tr(e,n,s){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-on(n),e[n]=s}function yg(e,n){var s=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-on(s),a=1<<r;n[r]=0,l[r]=-1,e[r]=-1,s&=~a}}function qo(e,n){var s=e.entangledLanes|=n;for(e=e.entanglements;s;){var l=31-on(s),r=1<<l;r&n|e[l]&n&&(e[l]|=n),s&=~r}}var Ge=0;function $m(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Bm,zo,Om,Dm,qm,Qi=!1,pr=[],Gn=null,Wn=null,Hn=null,Rl=new Map,Ll=new Map,qn=[],bg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wc(e,n){switch(e){case"focusin":case"focusout":Gn=null;break;case"dragenter":case"dragleave":Wn=null;break;case"mouseover":case"mouseout":Hn=null;break;case"pointerover":case"pointerout":Rl.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ll.delete(n.pointerId)}}function cl(e,n,s,l,r,a){return e===null||e.nativeEvent!==a?(e={blockedOn:n,domEventName:s,eventSystemFlags:l,nativeEvent:a,targetContainers:[r]},n!==null&&(n=sr(n),n!==null&&zo(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,r!==null&&n.indexOf(r)===-1&&n.push(r),e)}function vg(e,n,s,l,r){switch(n){case"focusin":return Gn=cl(Gn,e,n,s,l,r),!0;case"dragenter":return Wn=cl(Wn,e,n,s,l,r),!0;case"mouseover":return Hn=cl(Hn,e,n,s,l,r),!0;case"pointerover":var a=r.pointerId;return Rl.set(a,cl(Rl.get(a)||null,e,n,s,l,r)),!0;case"gotpointercapture":return a=r.pointerId,Ll.set(a,cl(Ll.get(a)||null,e,n,s,l,r)),!0}return!1}function zm(e){var n=cs(e.target);if(n!==null){var s=js(n);if(s!==null){if(n=s.tag,n===13){if(n=Em(s),n!==null){e.blockedOn=n,qm(e.priority,function(){Om(s)});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Br(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var s=Ji(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var l=new s.constructor(s.type,s);Gi=l,s.target.dispatchEvent(l),Gi=null}else return n=sr(s),n!==null&&zo(n),e.blockedOn=s,!1;n.shift()}return!0}function Hc(e,n,s){Br(e)&&s.delete(n)}function jg(){Qi=!1,Gn!==null&&Br(Gn)&&(Gn=null),Wn!==null&&Br(Wn)&&(Wn=null),Hn!==null&&Br(Hn)&&(Hn=null),Rl.forEach(Hc),Ll.forEach(Hc)}function dl(e,n){e.blockedOn===n&&(e.blockedOn=null,Qi||(Qi=!0,zt.unstable_scheduleCallback(zt.unstable_NormalPriority,jg)))}function $l(e){function n(r){return dl(r,e)}if(0<pr.length){dl(pr[0],e);for(var s=1;s<pr.length;s++){var l=pr[s];l.blockedOn===e&&(l.blockedOn=null)}}for(Gn!==null&&dl(Gn,e),Wn!==null&&dl(Wn,e),Hn!==null&&dl(Hn,e),Rl.forEach(n),Ll.forEach(n),s=0;s<qn.length;s++)l=qn[s],l.blockedOn===e&&(l.blockedOn=null);for(;0<qn.length&&(s=qn[0],s.blockedOn===null);)zm(s),s.blockedOn===null&&qn.shift()}var Gs=Tn.ReactCurrentBatchConfig,Xr=!0;function wg(e,n,s,l){var r=Ge,a=Gs.transition;Gs.transition=null;try{Ge=1,Uo(e,n,s,l)}finally{Ge=r,Gs.transition=a}}function Ng(e,n,s,l){var r=Ge,a=Gs.transition;Gs.transition=null;try{Ge=4,Uo(e,n,s,l)}finally{Ge=r,Gs.transition=a}}function Uo(e,n,s,l){if(Xr){var r=Ji(e,n,s,l);if(r===null)di(e,n,l,Zr,s),Wc(e,l);else if(vg(r,e,n,s,l))l.stopPropagation();else if(Wc(e,l),n&4&&-1<bg.indexOf(e)){for(;r!==null;){var a=sr(r);if(a!==null&&Bm(a),a=Ji(e,n,s,l),a===null&&di(e,n,l,Zr,s),a===r)break;r=a}r!==null&&l.stopPropagation()}else di(e,n,l,null,s)}}var Zr=null;function Ji(e,n,s,l){if(Zr=null,e=Oo(l),e=cs(e),e!==null)if(n=js(e),n===null)e=null;else if(s=n.tag,s===13){if(e=Em(n),e!==null)return e;e=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Zr=e,null}function Um(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dg()){case Do:return 1;case Am:return 4;case Jr:case ug:return 16;case Rm:return 536870912;default:return 16}default:return 16}}var Un=null,Fo=null,Or=null;function Fm(){if(Or)return Or;var e,n=Fo,s=n.length,l,r="value"in Un?Un.value:Un.textContent,a=r.length;for(e=0;e<s&&n[e]===r[e];e++);var i=s-e;for(l=1;l<=i&&n[s-l]===r[a-l];l++);return Or=r.slice(e,1<l?1-l:void 0)}function Dr(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function gr(){return!0}function Vc(){return!1}function Ft(e){function n(s,l,r,a,i){this._reactName=s,this._targetInst=r,this.type=l,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(s=e[o],this[o]=s?s(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?gr:Vc,this.isPropagationStopped=Vc,this}return lt(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=gr)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=gr)},persist:function(){},isPersistent:gr}),n}var sl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Go=Ft(sl),nr=lt({},sl,{view:0,detail:0}),kg=Ft(nr),ti,ni,ul,wa=lt({},nr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ul&&(ul&&e.type==="mousemove"?(ti=e.screenX-ul.screenX,ni=e.screenY-ul.screenY):ni=ti=0,ul=e),ti)},movementY:function(e){return"movementY"in e?e.movementY:ni}}),Kc=Ft(wa),Sg=lt({},wa,{dataTransfer:0}),Cg=Ft(Sg),Ig=lt({},nr,{relatedTarget:0}),si=Ft(Ig),Pg=lt({},sl,{animationName:0,elapsedTime:0,pseudoElement:0}),Eg=Ft(Pg),Mg=lt({},sl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Tg=Ft(Mg),_g=lt({},sl,{data:0}),Qc=Ft(_g),Ag={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $g(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Lg[e])?!!n[e]:!1}function Wo(){return $g}var Bg=lt({},nr,{key:function(e){if(e.key){var n=Ag[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=Dr(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Rg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wo,charCode:function(e){return e.type==="keypress"?Dr(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Dr(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Og=Ft(Bg),Dg=lt({},wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jc=Ft(Dg),qg=lt({},nr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wo}),zg=Ft(qg),Ug=lt({},sl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fg=Ft(Ug),Gg=lt({},wa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Wg=Ft(Gg),Hg=[9,13,27,32],Ho=Sn&&"CompositionEvent"in window,jl=null;Sn&&"documentMode"in document&&(jl=document.documentMode);var Vg=Sn&&"TextEvent"in window&&!jl,Gm=Sn&&(!Ho||jl&&8<jl&&11>=jl),Yc=" ",Xc=!1;function Wm(e,n){switch(e){case"keyup":return Hg.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ts=!1;function Kg(e,n){switch(e){case"compositionend":return Hm(n);case"keypress":return n.which!==32?null:(Xc=!0,Yc);case"textInput":return e=n.data,e===Yc&&Xc?null:e;default:return null}}function Qg(e,n){if(Ts)return e==="compositionend"||!Ho&&Wm(e,n)?(e=Fm(),Or=Fo=Un=null,Ts=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Gm&&n.locale!=="ko"?null:n.data;default:return null}}var Jg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zc(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Jg[e.type]:n==="textarea"}function Vm(e,n,s,l){km(l),n=ea(n,"onChange"),0<n.length&&(s=new Go("onChange","change",null,s,l),e.push({event:s,listeners:n}))}var wl=null,Bl=null;function Yg(e){lf(e,0)}function Na(e){var n=Rs(e);if(hm(n))return e}function Xg(e,n){if(e==="change")return n}var Km=!1;if(Sn){var li;if(Sn){var ri="oninput"in document;if(!ri){var ed=document.createElement("div");ed.setAttribute("oninput","return;"),ri=typeof ed.oninput=="function"}li=ri}else li=!1;Km=li&&(!document.documentMode||9<document.documentMode)}function td(){wl&&(wl.detachEvent("onpropertychange",Qm),Bl=wl=null)}function Qm(e){if(e.propertyName==="value"&&Na(Bl)){var n=[];Vm(n,Bl,e,Oo(e)),Pm(Yg,n)}}function Zg(e,n,s){e==="focusin"?(td(),wl=n,Bl=s,wl.attachEvent("onpropertychange",Qm)):e==="focusout"&&td()}function eh(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Na(Bl)}function th(e,n){if(e==="click")return Na(n)}function nh(e,n){if(e==="input"||e==="change")return Na(n)}function sh(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var dn=typeof Object.is=="function"?Object.is:sh;function Ol(e,n){if(dn(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var s=Object.keys(e),l=Object.keys(n);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var r=s[l];if(!_i.call(n,r)||!dn(e[r],n[r]))return!1}return!0}function nd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function sd(e,n){var s=nd(e);e=0;for(var l;s;){if(s.nodeType===3){if(l=e+s.textContent.length,e<=n&&l>=n)return{node:s,offset:n-e};e=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=nd(s)}}function Jm(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Jm(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Ym(){for(var e=window,n=Vr();n instanceof e.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)e=n.contentWindow;else break;n=Vr(e.document)}return n}function Vo(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function lh(e){var n=Ym(),s=e.focusedElem,l=e.selectionRange;if(n!==s&&s&&s.ownerDocument&&Jm(s.ownerDocument.documentElement,s)){if(l!==null&&Vo(s)){if(n=l.start,e=l.end,e===void 0&&(e=n),"selectionStart"in s)s.selectionStart=n,s.selectionEnd=Math.min(e,s.value.length);else if(e=(n=s.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var r=s.textContent.length,a=Math.min(l.start,r);l=l.end===void 0?a:Math.min(l.end,r),!e.extend&&a>l&&(r=l,l=a,a=r),r=sd(s,a);var i=sd(s,l);r&&i&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(n=n.createRange(),n.setStart(r.node,r.offset),e.removeAllRanges(),a>l?(e.addRange(n),e.extend(i.node,i.offset)):(n.setEnd(i.node,i.offset),e.addRange(n)))}}for(n=[],e=s;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<n.length;s++)e=n[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var rh=Sn&&"documentMode"in document&&11>=document.documentMode,_s=null,Yi=null,Nl=null,Xi=!1;function ld(e,n,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Xi||_s==null||_s!==Vr(l)||(l=_s,"selectionStart"in l&&Vo(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Nl&&Ol(Nl,l)||(Nl=l,l=ea(Yi,"onSelect"),0<l.length&&(n=new Go("onSelect","select",null,n,s),e.push({event:n,listeners:l}),n.target=_s)))}function hr(e,n){var s={};return s[e.toLowerCase()]=n.toLowerCase(),s["Webkit"+e]="webkit"+n,s["Moz"+e]="moz"+n,s}var As={animationend:hr("Animation","AnimationEnd"),animationiteration:hr("Animation","AnimationIteration"),animationstart:hr("Animation","AnimationStart"),transitionend:hr("Transition","TransitionEnd")},ai={},Xm={};Sn&&(Xm=document.createElement("div").style,"AnimationEvent"in window||(delete As.animationend.animation,delete As.animationiteration.animation,delete As.animationstart.animation),"TransitionEvent"in window||delete As.transitionend.transition);function ka(e){if(ai[e])return ai[e];if(!As[e])return e;var n=As[e],s;for(s in n)if(n.hasOwnProperty(s)&&s in Xm)return ai[e]=n[s];return e}var Zm=ka("animationend"),ef=ka("animationiteration"),tf=ka("animationstart"),nf=ka("transitionend"),sf=new Map,rd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(e,n){sf.set(e,n),vs(n,[e])}for(var ii=0;ii<rd.length;ii++){var oi=rd[ii],ah=oi.toLowerCase(),ih=oi[0].toUpperCase()+oi.slice(1);ts(ah,"on"+ih)}ts(Zm,"onAnimationEnd");ts(ef,"onAnimationIteration");ts(tf,"onAnimationStart");ts("dblclick","onDoubleClick");ts("focusin","onFocus");ts("focusout","onBlur");ts(nf,"onTransitionEnd");Vs("onMouseEnter",["mouseout","mouseover"]);Vs("onMouseLeave",["mouseout","mouseover"]);Vs("onPointerEnter",["pointerout","pointerover"]);Vs("onPointerLeave",["pointerout","pointerover"]);vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vs("onBeforeInput",["compositionend","keypress","textInput","paste"]);vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oh=new Set("cancel close invalid load scroll toggle".split(" ").concat(yl));function ad(e,n,s){var l=e.type||"unknown-event";e.currentTarget=s,ag(l,n,void 0,e),e.currentTarget=null}function lf(e,n){n=(n&4)!==0;for(var s=0;s<e.length;s++){var l=e[s],r=l.event;l=l.listeners;e:{var a=void 0;if(n)for(var i=l.length-1;0<=i;i--){var o=l[i],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==a&&r.isPropagationStopped())break e;ad(r,o,d),a=c}else for(i=0;i<l.length;i++){if(o=l[i],c=o.instance,d=o.currentTarget,o=o.listener,c!==a&&r.isPropagationStopped())break e;ad(r,o,d),a=c}}}if(Qr)throw e=Vi,Qr=!1,Vi=null,e}function Xe(e,n){var s=n[so];s===void 0&&(s=n[so]=new Set);var l=e+"__bubble";s.has(l)||(rf(n,e,2,!1),s.add(l))}function ci(e,n,s){var l=0;n&&(l|=4),rf(s,e,l,n)}var yr="_reactListening"+Math.random().toString(36).slice(2);function Dl(e){if(!e[yr]){e[yr]=!0,mm.forEach(function(s){s!=="selectionchange"&&(oh.has(s)||ci(s,!1,e),ci(s,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[yr]||(n[yr]=!0,ci("selectionchange",!1,n))}}function rf(e,n,s,l){switch(Um(n)){case 1:var r=wg;break;case 4:r=Ng;break;default:r=Uo}s=r.bind(null,n,s,e),r=void 0,!Hi||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(r=!0),l?r!==void 0?e.addEventListener(n,s,{capture:!0,passive:r}):e.addEventListener(n,s,!0):r!==void 0?e.addEventListener(n,s,{passive:r}):e.addEventListener(n,s,!1)}function di(e,n,s,l,r){var a=l;if(!(n&1)&&!(n&2)&&l!==null)e:for(;;){if(l===null)return;var i=l.tag;if(i===3||i===4){var o=l.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(i===4)for(i=l.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;i=i.return}for(;o!==null;){if(i=cs(o),i===null)return;if(c=i.tag,c===5||c===6){l=a=i;continue e}o=o.parentNode}}l=l.return}Pm(function(){var d=a,u=Oo(s),p=[];e:{var m=sf.get(e);if(m!==void 0){var h=Go,y=e;switch(e){case"keypress":if(Dr(s)===0)break e;case"keydown":case"keyup":h=Og;break;case"focusin":y="focus",h=si;break;case"focusout":y="blur",h=si;break;case"beforeblur":case"afterblur":h=si;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Kc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Cg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=zg;break;case Zm:case ef:case tf:h=Eg;break;case nf:h=Fg;break;case"scroll":h=kg;break;case"wheel":h=Wg;break;case"copy":case"cut":case"paste":h=Tg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Jc}var b=(n&4)!==0,j=!b&&e==="scroll",g=b?m!==null?m+"Capture":null:m;b=[];for(var x=d,v;x!==null;){v=x;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,g!==null&&(w=Al(x,g),w!=null&&b.push(ql(x,w,v)))),j)break;x=x.return}0<b.length&&(m=new h(m,y,null,s,u),p.push({event:m,listeners:b}))}}if(!(n&7)){e:{if(m=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",m&&s!==Gi&&(y=s.relatedTarget||s.fromElement)&&(cs(y)||y[Cn]))break e;if((h||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,h?(y=s.relatedTarget||s.toElement,h=d,y=y?cs(y):null,y!==null&&(j=js(y),y!==j||y.tag!==5&&y.tag!==6)&&(y=null)):(h=null,y=d),h!==y)){if(b=Kc,w="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(b=Jc,w="onPointerLeave",g="onPointerEnter",x="pointer"),j=h==null?m:Rs(h),v=y==null?m:Rs(y),m=new b(w,x+"leave",h,s,u),m.target=j,m.relatedTarget=v,w=null,cs(u)===d&&(b=new b(g,x+"enter",y,s,u),b.target=v,b.relatedTarget=j,w=b),j=w,h&&y)t:{for(b=h,g=y,x=0,v=b;v;v=Ss(v))x++;for(v=0,w=g;w;w=Ss(w))v++;for(;0<x-v;)b=Ss(b),x--;for(;0<v-x;)g=Ss(g),v--;for(;x--;){if(b===g||g!==null&&b===g.alternate)break t;b=Ss(b),g=Ss(g)}b=null}else b=null;h!==null&&id(p,m,h,b,!1),y!==null&&j!==null&&id(p,j,y,b,!0)}}e:{if(m=d?Rs(d):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var k=Xg;else if(Zc(m))if(Km)k=nh;else{k=eh;var P=Zg}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(k=th);if(k&&(k=k(e,d))){Vm(p,k,s,u);break e}P&&P(e,m,d),e==="focusout"&&(P=m._wrapperState)&&P.controlled&&m.type==="number"&&Di(m,"number",m.value)}switch(P=d?Rs(d):window,e){case"focusin":(Zc(P)||P.contentEditable==="true")&&(_s=P,Yi=d,Nl=null);break;case"focusout":Nl=Yi=_s=null;break;case"mousedown":Xi=!0;break;case"contextmenu":case"mouseup":case"dragend":Xi=!1,ld(p,s,u);break;case"selectionchange":if(rh)break;case"keydown":case"keyup":ld(p,s,u)}var S;if(Ho)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ts?Wm(e,s)&&(E="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(E="onCompositionStart");E&&(Gm&&s.locale!=="ko"&&(Ts||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ts&&(S=Fm()):(Un=u,Fo="value"in Un?Un.value:Un.textContent,Ts=!0)),P=ea(d,E),0<P.length&&(E=new Qc(E,e,null,s,u),p.push({event:E,listeners:P}),S?E.data=S:(S=Hm(s),S!==null&&(E.data=S)))),(S=Vg?Kg(e,s):Qg(e,s))&&(d=ea(d,"onBeforeInput"),0<d.length&&(u=new Qc("onBeforeInput","beforeinput",null,s,u),p.push({event:u,listeners:d}),u.data=S))}lf(p,n)})}function ql(e,n,s){return{instance:e,listener:n,currentTarget:s}}function ea(e,n){for(var s=n+"Capture",l=[];e!==null;){var r=e,a=r.stateNode;r.tag===5&&a!==null&&(r=a,a=Al(e,s),a!=null&&l.unshift(ql(e,a,r)),a=Al(e,n),a!=null&&l.push(ql(e,a,r))),e=e.return}return l}function Ss(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function id(e,n,s,l,r){for(var a=n._reactName,i=[];s!==null&&s!==l;){var o=s,c=o.alternate,d=o.stateNode;if(c!==null&&c===l)break;o.tag===5&&d!==null&&(o=d,r?(c=Al(s,a),c!=null&&i.unshift(ql(s,c,o))):r||(c=Al(s,a),c!=null&&i.push(ql(s,c,o)))),s=s.return}i.length!==0&&e.push({event:n,listeners:i})}var ch=/\r\n?/g,dh=/\u0000|\uFFFD/g;function od(e){return(typeof e=="string"?e:""+e).replace(ch,`
`).replace(dh,"")}function br(e,n,s){if(n=od(n),od(e)!==n&&s)throw Error(se(425))}function ta(){}var Zi=null,eo=null;function to(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var no=typeof setTimeout=="function"?setTimeout:void 0,uh=typeof clearTimeout=="function"?clearTimeout:void 0,cd=typeof Promise=="function"?Promise:void 0,mh=typeof queueMicrotask=="function"?queueMicrotask:typeof cd<"u"?function(e){return cd.resolve(null).then(e).catch(fh)}:no;function fh(e){setTimeout(function(){throw e})}function ui(e,n){var s=n,l=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&r.nodeType===8)if(s=r.data,s==="/$"){if(l===0){e.removeChild(r),$l(n);return}l--}else s!=="$"&&s!=="$?"&&s!=="$!"||l++;s=r}while(s);$l(n)}function Vn(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function dd(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return e;n--}else s==="/$"&&n++}e=e.previousSibling}return null}var ll=Math.random().toString(36).slice(2),gn="__reactFiber$"+ll,zl="__reactProps$"+ll,Cn="__reactContainer$"+ll,so="__reactEvents$"+ll,xh="__reactListeners$"+ll,ph="__reactHandles$"+ll;function cs(e){var n=e[gn];if(n)return n;for(var s=e.parentNode;s;){if(n=s[Cn]||s[gn]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(e=dd(e);e!==null;){if(s=e[gn])return s;e=dd(e)}return n}e=s,s=e.parentNode}return null}function sr(e){return e=e[gn]||e[Cn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Rs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(se(33))}function Sa(e){return e[zl]||null}var lo=[],Ls=-1;function ns(e){return{current:e}}function Ze(e){0>Ls||(e.current=lo[Ls],lo[Ls]=null,Ls--)}function Ye(e,n){Ls++,lo[Ls]=e.current,e.current=n}var es={},St=ns(es),Lt=ns(!1),ps=es;function Ks(e,n){var s=e.type.contextTypes;if(!s)return es;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===n)return l.__reactInternalMemoizedMaskedChildContext;var r={},a;for(a in s)r[a]=n[a];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=r),r}function $t(e){return e=e.childContextTypes,e!=null}function na(){Ze(Lt),Ze(St)}function ud(e,n,s){if(St.current!==es)throw Error(se(168));Ye(St,n),Ye(Lt,s)}function af(e,n,s){var l=e.stateNode;if(n=n.childContextTypes,typeof l.getChildContext!="function")return s;l=l.getChildContext();for(var r in l)if(!(r in n))throw Error(se(108,Zp(e)||"Unknown",r));return lt({},s,l)}function sa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||es,ps=St.current,Ye(St,e),Ye(Lt,Lt.current),!0}function md(e,n,s){var l=e.stateNode;if(!l)throw Error(se(169));s?(e=af(e,n,ps),l.__reactInternalMemoizedMergedChildContext=e,Ze(Lt),Ze(St),Ye(St,e)):Ze(Lt),Ye(Lt,s)}var jn=null,Ca=!1,mi=!1;function of(e){jn===null?jn=[e]:jn.push(e)}function gh(e){Ca=!0,of(e)}function ss(){if(!mi&&jn!==null){mi=!0;var e=0,n=Ge;try{var s=jn;for(Ge=1;e<s.length;e++){var l=s[e];do l=l(!0);while(l!==null)}jn=null,Ca=!1}catch(r){throw jn!==null&&(jn=jn.slice(e+1)),_m(Do,ss),r}finally{Ge=n,mi=!1}}return null}var $s=[],Bs=0,la=null,ra=0,Qt=[],Jt=0,gs=null,wn=1,Nn="";function is(e,n){$s[Bs++]=ra,$s[Bs++]=la,la=e,ra=n}function cf(e,n,s){Qt[Jt++]=wn,Qt[Jt++]=Nn,Qt[Jt++]=gs,gs=e;var l=wn;e=Nn;var r=32-on(l)-1;l&=~(1<<r),s+=1;var a=32-on(n)+r;if(30<a){var i=r-r%5;a=(l&(1<<i)-1).toString(32),l>>=i,r-=i,wn=1<<32-on(n)+r|s<<r|l,Nn=a+e}else wn=1<<a|s<<r|l,Nn=e}function Ko(e){e.return!==null&&(is(e,1),cf(e,1,0))}function Qo(e){for(;e===la;)la=$s[--Bs],$s[Bs]=null,ra=$s[--Bs],$s[Bs]=null;for(;e===gs;)gs=Qt[--Jt],Qt[Jt]=null,Nn=Qt[--Jt],Qt[Jt]=null,wn=Qt[--Jt],Qt[Jt]=null}var qt=null,Dt=null,et=!1,an=null;function df(e,n){var s=Yt(5,null,null,0);s.elementType="DELETED",s.stateNode=n,s.return=e,n=e.deletions,n===null?(e.deletions=[s],e.flags|=16):n.push(s)}function fd(e,n){switch(e.tag){case 5:var s=e.type;return n=n.nodeType!==1||s.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,qt=e,Dt=Vn(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,qt=e,Dt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(s=gs!==null?{id:wn,overflow:Nn}:null,e.memoizedState={dehydrated:n,treeContext:s,retryLane:1073741824},s=Yt(18,null,null,0),s.stateNode=n,s.return=e,e.child=s,qt=e,Dt=null,!0):!1;default:return!1}}function ro(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ao(e){if(et){var n=Dt;if(n){var s=n;if(!fd(e,n)){if(ro(e))throw Error(se(418));n=Vn(s.nextSibling);var l=qt;n&&fd(e,n)?df(l,s):(e.flags=e.flags&-4097|2,et=!1,qt=e)}}else{if(ro(e))throw Error(se(418));e.flags=e.flags&-4097|2,et=!1,qt=e}}}function xd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qt=e}function vr(e){if(e!==qt)return!1;if(!et)return xd(e),et=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!to(e.type,e.memoizedProps)),n&&(n=Dt)){if(ro(e))throw uf(),Error(se(418));for(;n;)df(e,n),n=Vn(n.nextSibling)}if(xd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(se(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(n===0){Dt=Vn(e.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++}e=e.nextSibling}Dt=null}}else Dt=qt?Vn(e.stateNode.nextSibling):null;return!0}function uf(){for(var e=Dt;e;)e=Vn(e.nextSibling)}function Qs(){Dt=qt=null,et=!1}function Jo(e){an===null?an=[e]:an.push(e)}var hh=Tn.ReactCurrentBatchConfig;function ml(e,n,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(se(309));var l=s.stateNode}if(!l)throw Error(se(147,e));var r=l,a=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===a?n.ref:(n=function(i){var o=r.refs;i===null?delete o[a]:o[a]=i},n._stringRef=a,n)}if(typeof e!="string")throw Error(se(284));if(!s._owner)throw Error(se(290,e))}return e}function jr(e,n){throw e=Object.prototype.toString.call(n),Error(se(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function pd(e){var n=e._init;return n(e._payload)}function mf(e){function n(g,x){if(e){var v=g.deletions;v===null?(g.deletions=[x],g.flags|=16):v.push(x)}}function s(g,x){if(!e)return null;for(;x!==null;)n(g,x),x=x.sibling;return null}function l(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function r(g,x){return g=Yn(g,x),g.index=0,g.sibling=null,g}function a(g,x,v){return g.index=v,e?(v=g.alternate,v!==null?(v=v.index,v<x?(g.flags|=2,x):v):(g.flags|=2,x)):(g.flags|=1048576,x)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,x,v,w){return x===null||x.tag!==6?(x=bi(v,g.mode,w),x.return=g,x):(x=r(x,v),x.return=g,x)}function c(g,x,v,w){var k=v.type;return k===Ms?u(g,x,v.props.children,w,v.key):x!==null&&(x.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===On&&pd(k)===x.type)?(w=r(x,v.props),w.ref=ml(g,x,v),w.return=g,w):(w=Hr(v.type,v.key,v.props,null,g.mode,w),w.ref=ml(g,x,v),w.return=g,w)}function d(g,x,v,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==v.containerInfo||x.stateNode.implementation!==v.implementation?(x=vi(v,g.mode,w),x.return=g,x):(x=r(x,v.children||[]),x.return=g,x)}function u(g,x,v,w,k){return x===null||x.tag!==7?(x=xs(v,g.mode,w,k),x.return=g,x):(x=r(x,v),x.return=g,x)}function p(g,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return x=bi(""+x,g.mode,v),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case dr:return v=Hr(x.type,x.key,x.props,null,g.mode,v),v.ref=ml(g,null,x),v.return=g,v;case Es:return x=vi(x,g.mode,v),x.return=g,x;case On:var w=x._init;return p(g,w(x._payload),v)}if(gl(x)||il(x))return x=xs(x,g.mode,v,null),x.return=g,x;jr(g,x)}return null}function m(g,x,v,w){var k=x!==null?x.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return k!==null?null:o(g,x,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case dr:return v.key===k?c(g,x,v,w):null;case Es:return v.key===k?d(g,x,v,w):null;case On:return k=v._init,m(g,x,k(v._payload),w)}if(gl(v)||il(v))return k!==null?null:u(g,x,v,w,null);jr(g,v)}return null}function h(g,x,v,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(v)||null,o(x,g,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case dr:return g=g.get(w.key===null?v:w.key)||null,c(x,g,w,k);case Es:return g=g.get(w.key===null?v:w.key)||null,d(x,g,w,k);case On:var P=w._init;return h(g,x,v,P(w._payload),k)}if(gl(w)||il(w))return g=g.get(v)||null,u(x,g,w,k,null);jr(x,w)}return null}function y(g,x,v,w){for(var k=null,P=null,S=x,E=x=0,_=null;S!==null&&E<v.length;E++){S.index>E?(_=S,S=null):_=S.sibling;var C=m(g,S,v[E],w);if(C===null){S===null&&(S=_);break}e&&S&&C.alternate===null&&n(g,S),x=a(C,x,E),P===null?k=C:P.sibling=C,P=C,S=_}if(E===v.length)return s(g,S),et&&is(g,E),k;if(S===null){for(;E<v.length;E++)S=p(g,v[E],w),S!==null&&(x=a(S,x,E),P===null?k=S:P.sibling=S,P=S);return et&&is(g,E),k}for(S=l(g,S);E<v.length;E++)_=h(S,g,E,v[E],w),_!==null&&(e&&_.alternate!==null&&S.delete(_.key===null?E:_.key),x=a(_,x,E),P===null?k=_:P.sibling=_,P=_);return e&&S.forEach(function(I){return n(g,I)}),et&&is(g,E),k}function b(g,x,v,w){var k=il(v);if(typeof k!="function")throw Error(se(150));if(v=k.call(v),v==null)throw Error(se(151));for(var P=k=null,S=x,E=x=0,_=null,C=v.next();S!==null&&!C.done;E++,C=v.next()){S.index>E?(_=S,S=null):_=S.sibling;var I=m(g,S,C.value,w);if(I===null){S===null&&(S=_);break}e&&S&&I.alternate===null&&n(g,S),x=a(I,x,E),P===null?k=I:P.sibling=I,P=I,S=_}if(C.done)return s(g,S),et&&is(g,E),k;if(S===null){for(;!C.done;E++,C=v.next())C=p(g,C.value,w),C!==null&&(x=a(C,x,E),P===null?k=C:P.sibling=C,P=C);return et&&is(g,E),k}for(S=l(g,S);!C.done;E++,C=v.next())C=h(S,g,E,C.value,w),C!==null&&(e&&C.alternate!==null&&S.delete(C.key===null?E:C.key),x=a(C,x,E),P===null?k=C:P.sibling=C,P=C);return e&&S.forEach(function(R){return n(g,R)}),et&&is(g,E),k}function j(g,x,v,w){if(typeof v=="object"&&v!==null&&v.type===Ms&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case dr:e:{for(var k=v.key,P=x;P!==null;){if(P.key===k){if(k=v.type,k===Ms){if(P.tag===7){s(g,P.sibling),x=r(P,v.props.children),x.return=g,g=x;break e}}else if(P.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===On&&pd(k)===P.type){s(g,P.sibling),x=r(P,v.props),x.ref=ml(g,P,v),x.return=g,g=x;break e}s(g,P);break}else n(g,P);P=P.sibling}v.type===Ms?(x=xs(v.props.children,g.mode,w,v.key),x.return=g,g=x):(w=Hr(v.type,v.key,v.props,null,g.mode,w),w.ref=ml(g,x,v),w.return=g,g=w)}return i(g);case Es:e:{for(P=v.key;x!==null;){if(x.key===P)if(x.tag===4&&x.stateNode.containerInfo===v.containerInfo&&x.stateNode.implementation===v.implementation){s(g,x.sibling),x=r(x,v.children||[]),x.return=g,g=x;break e}else{s(g,x);break}else n(g,x);x=x.sibling}x=vi(v,g.mode,w),x.return=g,g=x}return i(g);case On:return P=v._init,j(g,x,P(v._payload),w)}if(gl(v))return y(g,x,v,w);if(il(v))return b(g,x,v,w);jr(g,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,x!==null&&x.tag===6?(s(g,x.sibling),x=r(x,v),x.return=g,g=x):(s(g,x),x=bi(v,g.mode,w),x.return=g,g=x),i(g)):s(g,x)}return j}var Js=mf(!0),ff=mf(!1),aa=ns(null),ia=null,Os=null,Yo=null;function Xo(){Yo=Os=ia=null}function Zo(e){var n=aa.current;Ze(aa),e._currentValue=n}function io(e,n,s){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===s)break;e=e.return}}function Ws(e,n){ia=e,Yo=Os=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(Rt=!0),e.firstContext=null)}function Zt(e){var n=e._currentValue;if(Yo!==e)if(e={context:e,memoizedValue:n,next:null},Os===null){if(ia===null)throw Error(se(308));Os=e,ia.dependencies={lanes:0,firstContext:e}}else Os=Os.next=e;return n}var ds=null;function ec(e){ds===null?ds=[e]:ds.push(e)}function xf(e,n,s,l){var r=n.interleaved;return r===null?(s.next=s,ec(n)):(s.next=r.next,r.next=s),n.interleaved=s,In(e,l)}function In(e,n){e.lanes|=n;var s=e.alternate;for(s!==null&&(s.lanes|=n),s=e,e=e.return;e!==null;)e.childLanes|=n,s=e.alternate,s!==null&&(s.childLanes|=n),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Dn=!1;function tc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pf(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function kn(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Kn(e,n,s){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,ze&2){var r=l.pending;return r===null?n.next=n:(n.next=r.next,r.next=n),l.pending=n,In(e,s)}return r=l.interleaved,r===null?(n.next=n,ec(l)):(n.next=r.next,r.next=n),l.interleaved=n,In(e,s)}function qr(e,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194240)!==0)){var l=n.lanes;l&=e.pendingLanes,s|=l,n.lanes=s,qo(e,s)}}function gd(e,n){var s=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var r=null,a=null;if(s=s.firstBaseUpdate,s!==null){do{var i={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};a===null?r=a=i:a=a.next=i,s=s.next}while(s!==null);a===null?r=a=n:a=a.next=n}else r=a=n;s={baseState:l.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:l.shared,effects:l.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=n:e.next=n,s.lastBaseUpdate=n}function oa(e,n,s,l){var r=e.updateQueue;Dn=!1;var a=r.firstBaseUpdate,i=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var c=o,d=c.next;c.next=null,i===null?a=d:i.next=d,i=c;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=d:o.next=d,u.lastBaseUpdate=c))}if(a!==null){var p=r.baseState;i=0,u=d=c=null,o=a;do{var m=o.lane,h=o.eventTime;if((l&m)===m){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=e,b=o;switch(m=n,h=s,b.tag){case 1:if(y=b.payload,typeof y=="function"){p=y.call(h,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=b.payload,m=typeof y=="function"?y.call(h,p,m):y,m==null)break e;p=lt({},p,m);break e;case 2:Dn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=r.effects,m===null?r.effects=[o]:m.push(o))}else h={eventTime:h,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(d=u=h,c=p):u=u.next=h,i|=m;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;m=o,o=m.next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}while(!0);if(u===null&&(c=p),r.baseState=c,r.firstBaseUpdate=d,r.lastBaseUpdate=u,n=r.shared.interleaved,n!==null){r=n;do i|=r.lane,r=r.next;while(r!==n)}else a===null&&(r.shared.lanes=0);ys|=i,e.lanes=i,e.memoizedState=p}}function hd(e,n,s){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var l=e[n],r=l.callback;if(r!==null){if(l.callback=null,l=s,typeof r!="function")throw Error(se(191,r));r.call(l)}}}var lr={},yn=ns(lr),Ul=ns(lr),Fl=ns(lr);function us(e){if(e===lr)throw Error(se(174));return e}function nc(e,n){switch(Ye(Fl,n),Ye(Ul,e),Ye(yn,lr),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:zi(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=zi(n,e)}Ze(yn),Ye(yn,n)}function Ys(){Ze(yn),Ze(Ul),Ze(Fl)}function gf(e){us(Fl.current);var n=us(yn.current),s=zi(n,e.type);n!==s&&(Ye(Ul,e),Ye(yn,s))}function sc(e){Ul.current===e&&(Ze(yn),Ze(Ul))}var tt=ns(0);function ca(e){for(var n=e;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var fi=[];function lc(){for(var e=0;e<fi.length;e++)fi[e]._workInProgressVersionPrimary=null;fi.length=0}var zr=Tn.ReactCurrentDispatcher,xi=Tn.ReactCurrentBatchConfig,hs=0,st=null,ut=null,xt=null,da=!1,kl=!1,Gl=0,yh=0;function wt(){throw Error(se(321))}function rc(e,n){if(n===null)return!1;for(var s=0;s<n.length&&s<e.length;s++)if(!dn(e[s],n[s]))return!1;return!0}function ac(e,n,s,l,r,a){if(hs=a,st=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,zr.current=e===null||e.memoizedState===null?wh:Nh,e=s(l,r),kl){a=0;do{if(kl=!1,Gl=0,25<=a)throw Error(se(301));a+=1,xt=ut=null,n.updateQueue=null,zr.current=kh,e=s(l,r)}while(kl)}if(zr.current=ua,n=ut!==null&&ut.next!==null,hs=0,xt=ut=st=null,da=!1,n)throw Error(se(300));return e}function ic(){var e=Gl!==0;return Gl=0,e}function pn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?st.memoizedState=xt=e:xt=xt.next=e,xt}function en(){if(ut===null){var e=st.alternate;e=e!==null?e.memoizedState:null}else e=ut.next;var n=xt===null?st.memoizedState:xt.next;if(n!==null)xt=n,ut=e;else{if(e===null)throw Error(se(310));ut=e,e={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},xt===null?st.memoizedState=xt=e:xt=xt.next=e}return xt}function Wl(e,n){return typeof n=="function"?n(e):n}function pi(e){var n=en(),s=n.queue;if(s===null)throw Error(se(311));s.lastRenderedReducer=e;var l=ut,r=l.baseQueue,a=s.pending;if(a!==null){if(r!==null){var i=r.next;r.next=a.next,a.next=i}l.baseQueue=r=a,s.pending=null}if(r!==null){a=r.next,l=l.baseState;var o=i=null,c=null,d=a;do{var u=d.lane;if((hs&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),l=d.hasEagerState?d.eagerState:e(l,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=p,i=l):c=c.next=p,st.lanes|=u,ys|=u}d=d.next}while(d!==null&&d!==a);c===null?i=l:c.next=o,dn(l,n.memoizedState)||(Rt=!0),n.memoizedState=l,n.baseState=i,n.baseQueue=c,s.lastRenderedState=l}if(e=s.interleaved,e!==null){r=e;do a=r.lane,st.lanes|=a,ys|=a,r=r.next;while(r!==e)}else r===null&&(s.lanes=0);return[n.memoizedState,s.dispatch]}function gi(e){var n=en(),s=n.queue;if(s===null)throw Error(se(311));s.lastRenderedReducer=e;var l=s.dispatch,r=s.pending,a=n.memoizedState;if(r!==null){s.pending=null;var i=r=r.next;do a=e(a,i.action),i=i.next;while(i!==r);dn(a,n.memoizedState)||(Rt=!0),n.memoizedState=a,n.baseQueue===null&&(n.baseState=a),s.lastRenderedState=a}return[a,l]}function hf(){}function yf(e,n){var s=st,l=en(),r=n(),a=!dn(l.memoizedState,r);if(a&&(l.memoizedState=r,Rt=!0),l=l.queue,oc(jf.bind(null,s,l,e),[e]),l.getSnapshot!==n||a||xt!==null&&xt.memoizedState.tag&1){if(s.flags|=2048,Hl(9,vf.bind(null,s,l,r,n),void 0,null),pt===null)throw Error(se(349));hs&30||bf(s,n,r)}return r}function bf(e,n,s){e.flags|=16384,e={getSnapshot:n,value:s},n=st.updateQueue,n===null?(n={lastEffect:null,stores:null},st.updateQueue=n,n.stores=[e]):(s=n.stores,s===null?n.stores=[e]:s.push(e))}function vf(e,n,s,l){n.value=s,n.getSnapshot=l,wf(n)&&Nf(e)}function jf(e,n,s){return s(function(){wf(n)&&Nf(e)})}function wf(e){var n=e.getSnapshot;e=e.value;try{var s=n();return!dn(e,s)}catch{return!0}}function Nf(e){var n=In(e,1);n!==null&&cn(n,e,1,-1)}function yd(e){var n=pn();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wl,lastRenderedState:e},n.queue=e,e=e.dispatch=jh.bind(null,st,e),[n.memoizedState,e]}function Hl(e,n,s,l){return e={tag:e,create:n,destroy:s,deps:l,next:null},n=st.updateQueue,n===null?(n={lastEffect:null,stores:null},st.updateQueue=n,n.lastEffect=e.next=e):(s=n.lastEffect,s===null?n.lastEffect=e.next=e:(l=s.next,s.next=e,e.next=l,n.lastEffect=e)),e}function kf(){return en().memoizedState}function Ur(e,n,s,l){var r=pn();st.flags|=e,r.memoizedState=Hl(1|n,s,void 0,l===void 0?null:l)}function Ia(e,n,s,l){var r=en();l=l===void 0?null:l;var a=void 0;if(ut!==null){var i=ut.memoizedState;if(a=i.destroy,l!==null&&rc(l,i.deps)){r.memoizedState=Hl(n,s,a,l);return}}st.flags|=e,r.memoizedState=Hl(1|n,s,a,l)}function bd(e,n){return Ur(8390656,8,e,n)}function oc(e,n){return Ia(2048,8,e,n)}function Sf(e,n){return Ia(4,2,e,n)}function Cf(e,n){return Ia(4,4,e,n)}function If(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Pf(e,n,s){return s=s!=null?s.concat([e]):null,Ia(4,4,If.bind(null,n,e),s)}function cc(){}function Ef(e,n){var s=en();n=n===void 0?null:n;var l=s.memoizedState;return l!==null&&n!==null&&rc(n,l[1])?l[0]:(s.memoizedState=[e,n],e)}function Mf(e,n){var s=en();n=n===void 0?null:n;var l=s.memoizedState;return l!==null&&n!==null&&rc(n,l[1])?l[0]:(e=e(),s.memoizedState=[e,n],e)}function Tf(e,n,s){return hs&21?(dn(s,n)||(s=Lm(),st.lanes|=s,ys|=s,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,Rt=!0),e.memoizedState=s)}function bh(e,n){var s=Ge;Ge=s!==0&&4>s?s:4,e(!0);var l=xi.transition;xi.transition={};try{e(!1),n()}finally{Ge=s,xi.transition=l}}function _f(){return en().memoizedState}function vh(e,n,s){var l=Jn(e);if(s={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null},Af(e))Rf(n,s);else if(s=xf(e,n,s,l),s!==null){var r=Pt();cn(s,e,l,r),Lf(s,n,l)}}function jh(e,n,s){var l=Jn(e),r={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null};if(Af(e))Rf(n,r);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=n.lastRenderedReducer,a!==null))try{var i=n.lastRenderedState,o=a(i,s);if(r.hasEagerState=!0,r.eagerState=o,dn(o,i)){var c=n.interleaved;c===null?(r.next=r,ec(n)):(r.next=c.next,c.next=r),n.interleaved=r;return}}catch{}finally{}s=xf(e,n,r,l),s!==null&&(r=Pt(),cn(s,e,l,r),Lf(s,n,l))}}function Af(e){var n=e.alternate;return e===st||n!==null&&n===st}function Rf(e,n){kl=da=!0;var s=e.pending;s===null?n.next=n:(n.next=s.next,s.next=n),e.pending=n}function Lf(e,n,s){if(s&4194240){var l=n.lanes;l&=e.pendingLanes,s|=l,n.lanes=s,qo(e,s)}}var ua={readContext:Zt,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useInsertionEffect:wt,useLayoutEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useMutableSource:wt,useSyncExternalStore:wt,useId:wt,unstable_isNewReconciler:!1},wh={readContext:Zt,useCallback:function(e,n){return pn().memoizedState=[e,n===void 0?null:n],e},useContext:Zt,useEffect:bd,useImperativeHandle:function(e,n,s){return s=s!=null?s.concat([e]):null,Ur(4194308,4,If.bind(null,n,e),s)},useLayoutEffect:function(e,n){return Ur(4194308,4,e,n)},useInsertionEffect:function(e,n){return Ur(4,2,e,n)},useMemo:function(e,n){var s=pn();return n=n===void 0?null:n,e=e(),s.memoizedState=[e,n],e},useReducer:function(e,n,s){var l=pn();return n=s!==void 0?s(n):n,l.memoizedState=l.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},l.queue=e,e=e.dispatch=vh.bind(null,st,e),[l.memoizedState,e]},useRef:function(e){var n=pn();return e={current:e},n.memoizedState=e},useState:yd,useDebugValue:cc,useDeferredValue:function(e){return pn().memoizedState=e},useTransition:function(){var e=yd(!1),n=e[0];return e=bh.bind(null,e[1]),pn().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,s){var l=st,r=pn();if(et){if(s===void 0)throw Error(se(407));s=s()}else{if(s=n(),pt===null)throw Error(se(349));hs&30||bf(l,n,s)}r.memoizedState=s;var a={value:s,getSnapshot:n};return r.queue=a,bd(jf.bind(null,l,a,e),[e]),l.flags|=2048,Hl(9,vf.bind(null,l,a,s,n),void 0,null),s},useId:function(){var e=pn(),n=pt.identifierPrefix;if(et){var s=Nn,l=wn;s=(l&~(1<<32-on(l)-1)).toString(32)+s,n=":"+n+"R"+s,s=Gl++,0<s&&(n+="H"+s.toString(32)),n+=":"}else s=yh++,n=":"+n+"r"+s.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},Nh={readContext:Zt,useCallback:Ef,useContext:Zt,useEffect:oc,useImperativeHandle:Pf,useInsertionEffect:Sf,useLayoutEffect:Cf,useMemo:Mf,useReducer:pi,useRef:kf,useState:function(){return pi(Wl)},useDebugValue:cc,useDeferredValue:function(e){var n=en();return Tf(n,ut.memoizedState,e)},useTransition:function(){var e=pi(Wl)[0],n=en().memoizedState;return[e,n]},useMutableSource:hf,useSyncExternalStore:yf,useId:_f,unstable_isNewReconciler:!1},kh={readContext:Zt,useCallback:Ef,useContext:Zt,useEffect:oc,useImperativeHandle:Pf,useInsertionEffect:Sf,useLayoutEffect:Cf,useMemo:Mf,useReducer:gi,useRef:kf,useState:function(){return gi(Wl)},useDebugValue:cc,useDeferredValue:function(e){var n=en();return ut===null?n.memoizedState=e:Tf(n,ut.memoizedState,e)},useTransition:function(){var e=gi(Wl)[0],n=en().memoizedState;return[e,n]},useMutableSource:hf,useSyncExternalStore:yf,useId:_f,unstable_isNewReconciler:!1};function ln(e,n){if(e&&e.defaultProps){n=lt({},n),e=e.defaultProps;for(var s in e)n[s]===void 0&&(n[s]=e[s]);return n}return n}function oo(e,n,s,l){n=e.memoizedState,s=s(l,n),s=s==null?n:lt({},n,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Pa={isMounted:function(e){return(e=e._reactInternals)?js(e)===e:!1},enqueueSetState:function(e,n,s){e=e._reactInternals;var l=Pt(),r=Jn(e),a=kn(l,r);a.payload=n,s!=null&&(a.callback=s),n=Kn(e,a,r),n!==null&&(cn(n,e,r,l),qr(n,e,r))},enqueueReplaceState:function(e,n,s){e=e._reactInternals;var l=Pt(),r=Jn(e),a=kn(l,r);a.tag=1,a.payload=n,s!=null&&(a.callback=s),n=Kn(e,a,r),n!==null&&(cn(n,e,r,l),qr(n,e,r))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var s=Pt(),l=Jn(e),r=kn(s,l);r.tag=2,n!=null&&(r.callback=n),n=Kn(e,r,l),n!==null&&(cn(n,e,l,s),qr(n,e,l))}};function vd(e,n,s,l,r,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,a,i):n.prototype&&n.prototype.isPureReactComponent?!Ol(s,l)||!Ol(r,a):!0}function $f(e,n,s){var l=!1,r=es,a=n.contextType;return typeof a=="object"&&a!==null?a=Zt(a):(r=$t(n)?ps:St.current,l=n.contextTypes,a=(l=l!=null)?Ks(e,r):es),n=new n(s,a),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Pa,e.stateNode=n,n._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),n}function jd(e,n,s,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,l),n.state!==e&&Pa.enqueueReplaceState(n,n.state,null)}function co(e,n,s,l){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},tc(e);var a=n.contextType;typeof a=="object"&&a!==null?r.context=Zt(a):(a=$t(n)?ps:St.current,r.context=Ks(e,a)),r.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(oo(e,n,a,s),r.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(n=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),n!==r.state&&Pa.enqueueReplaceState(r,r.state,null),oa(e,s,r,l),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Xs(e,n){try{var s="",l=n;do s+=Xp(l),l=l.return;while(l);var r=s}catch(a){r=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:n,stack:r,digest:null}}function hi(e,n,s){return{value:e,source:null,stack:s??null,digest:n??null}}function uo(e,n){try{console.error(n.value)}catch(s){setTimeout(function(){throw s})}}var Sh=typeof WeakMap=="function"?WeakMap:Map;function Bf(e,n,s){s=kn(-1,s),s.tag=3,s.payload={element:null};var l=n.value;return s.callback=function(){fa||(fa=!0,jo=l),uo(e,n)},s}function Of(e,n,s){s=kn(-1,s),s.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var r=n.value;s.payload=function(){return l(r)},s.callback=function(){uo(e,n)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(s.callback=function(){uo(e,n),typeof l!="function"&&(Qn===null?Qn=new Set([this]):Qn.add(this));var i=n.stack;this.componentDidCatch(n.value,{componentStack:i!==null?i:""})}),s}function wd(e,n,s){var l=e.pingCache;if(l===null){l=e.pingCache=new Sh;var r=new Set;l.set(n,r)}else r=l.get(n),r===void 0&&(r=new Set,l.set(n,r));r.has(s)||(r.add(s),e=Dh.bind(null,e,n,s),n.then(e,e))}function Nd(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function kd(e,n,s,l,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===n?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(n=kn(-1,1),n.tag=2,Kn(s,n,1))),s.lanes|=1),e)}var Ch=Tn.ReactCurrentOwner,Rt=!1;function It(e,n,s,l){n.child=e===null?ff(n,null,s,l):Js(n,e.child,s,l)}function Sd(e,n,s,l,r){s=s.render;var a=n.ref;return Ws(n,r),l=ac(e,n,s,l,a,r),s=ic(),e!==null&&!Rt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r,Pn(e,n,r)):(et&&s&&Ko(n),n.flags|=1,It(e,n,l,r),n.child)}function Cd(e,n,s,l,r){if(e===null){var a=s.type;return typeof a=="function"&&!hc(a)&&a.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(n.tag=15,n.type=a,Df(e,n,a,l,r)):(e=Hr(s.type,null,l,n,n.mode,r),e.ref=n.ref,e.return=n,n.child=e)}if(a=e.child,!(e.lanes&r)){var i=a.memoizedProps;if(s=s.compare,s=s!==null?s:Ol,s(i,l)&&e.ref===n.ref)return Pn(e,n,r)}return n.flags|=1,e=Yn(a,l),e.ref=n.ref,e.return=n,n.child=e}function Df(e,n,s,l,r){if(e!==null){var a=e.memoizedProps;if(Ol(a,l)&&e.ref===n.ref)if(Rt=!1,n.pendingProps=l=a,(e.lanes&r)!==0)e.flags&131072&&(Rt=!0);else return n.lanes=e.lanes,Pn(e,n,r)}return mo(e,n,s,l,r)}function qf(e,n,s){var l=n.pendingProps,r=l.children,a=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(qs,Ot),Ot|=s;else{if(!(s&1073741824))return e=a!==null?a.baseLanes|s:s,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Ye(qs,Ot),Ot|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=a!==null?a.baseLanes:s,Ye(qs,Ot),Ot|=l}else a!==null?(l=a.baseLanes|s,n.memoizedState=null):l=s,Ye(qs,Ot),Ot|=l;return It(e,n,r,s),n.child}function zf(e,n){var s=n.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(n.flags|=512,n.flags|=2097152)}function mo(e,n,s,l,r){var a=$t(s)?ps:St.current;return a=Ks(n,a),Ws(n,r),s=ac(e,n,s,l,a,r),l=ic(),e!==null&&!Rt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r,Pn(e,n,r)):(et&&l&&Ko(n),n.flags|=1,It(e,n,s,r),n.child)}function Id(e,n,s,l,r){if($t(s)){var a=!0;sa(n)}else a=!1;if(Ws(n,r),n.stateNode===null)Fr(e,n),$f(n,s,l),co(n,s,l,r),l=!0;else if(e===null){var i=n.stateNode,o=n.memoizedProps;i.props=o;var c=i.context,d=s.contextType;typeof d=="object"&&d!==null?d=Zt(d):(d=$t(s)?ps:St.current,d=Ks(n,d));var u=s.getDerivedStateFromProps,p=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";p||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==l||c!==d)&&jd(n,i,l,d),Dn=!1;var m=n.memoizedState;i.state=m,oa(n,l,i,r),c=n.memoizedState,o!==l||m!==c||Lt.current||Dn?(typeof u=="function"&&(oo(n,s,u,l),c=n.memoizedState),(o=Dn||vd(n,s,o,l,m,c,d))?(p||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(n.flags|=4194308)):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=c),i.props=l,i.state=c,i.context=d,l=o):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{i=n.stateNode,pf(e,n),o=n.memoizedProps,d=n.type===n.elementType?o:ln(n.type,o),i.props=d,p=n.pendingProps,m=i.context,c=s.contextType,typeof c=="object"&&c!==null?c=Zt(c):(c=$t(s)?ps:St.current,c=Ks(n,c));var h=s.getDerivedStateFromProps;(u=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==p||m!==c)&&jd(n,i,l,c),Dn=!1,m=n.memoizedState,i.state=m,oa(n,l,i,r);var y=n.memoizedState;o!==p||m!==y||Lt.current||Dn?(typeof h=="function"&&(oo(n,s,h,l),y=n.memoizedState),(d=Dn||vd(n,s,d,l,m,y,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(l,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(l,y,c)),typeof i.componentDidUpdate=="function"&&(n.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=y),i.props=l,i.state=y,i.context=c,l=d):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=1024),l=!1)}return fo(e,n,s,l,a,r)}function fo(e,n,s,l,r,a){zf(e,n);var i=(n.flags&128)!==0;if(!l&&!i)return r&&md(n,s,!1),Pn(e,n,a);l=n.stateNode,Ch.current=n;var o=i&&typeof s.getDerivedStateFromError!="function"?null:l.render();return n.flags|=1,e!==null&&i?(n.child=Js(n,e.child,null,a),n.child=Js(n,null,o,a)):It(e,n,o,a),n.memoizedState=l.state,r&&md(n,s,!0),n.child}function Uf(e){var n=e.stateNode;n.pendingContext?ud(e,n.pendingContext,n.pendingContext!==n.context):n.context&&ud(e,n.context,!1),nc(e,n.containerInfo)}function Pd(e,n,s,l,r){return Qs(),Jo(r),n.flags|=256,It(e,n,s,l),n.child}var xo={dehydrated:null,treeContext:null,retryLane:0};function po(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ff(e,n,s){var l=n.pendingProps,r=tt.current,a=!1,i=(n.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(r&2)!==0),o?(a=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),Ye(tt,r&1),e===null)return ao(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(i=l.children,e=l.fallback,a?(l=n.mode,a=n.child,i={mode:"hidden",children:i},!(l&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Ta(i,l,0,null),e=xs(e,l,s,null),a.return=n,e.return=n,a.sibling=e,n.child=a,n.child.memoizedState=po(s),n.memoizedState=xo,e):dc(n,i));if(r=e.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return Ih(e,n,i,l,o,r,s);if(a){a=l.fallback,i=n.mode,r=e.child,o=r.sibling;var c={mode:"hidden",children:l.children};return!(i&1)&&n.child!==r?(l=n.child,l.childLanes=0,l.pendingProps=c,n.deletions=null):(l=Yn(r,c),l.subtreeFlags=r.subtreeFlags&14680064),o!==null?a=Yn(o,a):(a=xs(a,i,s,null),a.flags|=2),a.return=n,l.return=n,l.sibling=a,n.child=l,l=a,a=n.child,i=e.child.memoizedState,i=i===null?po(s):{baseLanes:i.baseLanes|s,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~s,n.memoizedState=xo,l}return a=e.child,e=a.sibling,l=Yn(a,{mode:"visible",children:l.children}),!(n.mode&1)&&(l.lanes=s),l.return=n,l.sibling=null,e!==null&&(s=n.deletions,s===null?(n.deletions=[e],n.flags|=16):s.push(e)),n.child=l,n.memoizedState=null,l}function dc(e,n){return n=Ta({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function wr(e,n,s,l){return l!==null&&Jo(l),Js(n,e.child,null,s),e=dc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Ih(e,n,s,l,r,a,i){if(s)return n.flags&256?(n.flags&=-257,l=hi(Error(se(422))),wr(e,n,i,l)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(a=l.fallback,r=n.mode,l=Ta({mode:"visible",children:l.children},r,0,null),a=xs(a,r,i,null),a.flags|=2,l.return=n,a.return=n,l.sibling=a,n.child=l,n.mode&1&&Js(n,e.child,null,i),n.child.memoizedState=po(i),n.memoizedState=xo,a);if(!(n.mode&1))return wr(e,n,i,null);if(r.data==="$!"){if(l=r.nextSibling&&r.nextSibling.dataset,l)var o=l.dgst;return l=o,a=Error(se(419)),l=hi(a,l,void 0),wr(e,n,i,l)}if(o=(i&e.childLanes)!==0,Rt||o){if(l=pt,l!==null){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(l.suspendedLanes|i)?0:r,r!==0&&r!==a.retryLane&&(a.retryLane=r,In(e,r),cn(l,e,r,-1))}return gc(),l=hi(Error(se(421))),wr(e,n,i,l)}return r.data==="$?"?(n.flags|=128,n.child=e.child,n=qh.bind(null,e),r._reactRetry=n,null):(e=a.treeContext,Dt=Vn(r.nextSibling),qt=n,et=!0,an=null,e!==null&&(Qt[Jt++]=wn,Qt[Jt++]=Nn,Qt[Jt++]=gs,wn=e.id,Nn=e.overflow,gs=n),n=dc(n,l.children),n.flags|=4096,n)}function Ed(e,n,s){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),io(e.return,n,s)}function yi(e,n,s,l,r){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:r}:(a.isBackwards=n,a.rendering=null,a.renderingStartTime=0,a.last=l,a.tail=s,a.tailMode=r)}function Gf(e,n,s){var l=n.pendingProps,r=l.revealOrder,a=l.tail;if(It(e,n,l.children,s),l=tt.current,l&2)l=l&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ed(e,s,n);else if(e.tag===19)Ed(e,s,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Ye(tt,l),!(n.mode&1))n.memoizedState=null;else switch(r){case"forwards":for(s=n.child,r=null;s!==null;)e=s.alternate,e!==null&&ca(e)===null&&(r=s),s=s.sibling;s=r,s===null?(r=n.child,n.child=null):(r=s.sibling,s.sibling=null),yi(n,!1,r,s,a);break;case"backwards":for(s=null,r=n.child,n.child=null;r!==null;){if(e=r.alternate,e!==null&&ca(e)===null){n.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}yi(n,!0,s,null,a);break;case"together":yi(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Fr(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function Pn(e,n,s){if(e!==null&&(n.dependencies=e.dependencies),ys|=n.lanes,!(s&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(se(153));if(n.child!==null){for(e=n.child,s=Yn(e,e.pendingProps),n.child=s,s.return=n;e.sibling!==null;)e=e.sibling,s=s.sibling=Yn(e,e.pendingProps),s.return=n;s.sibling=null}return n.child}function Ph(e,n,s){switch(n.tag){case 3:Uf(n),Qs();break;case 5:gf(n);break;case 1:$t(n.type)&&sa(n);break;case 4:nc(n,n.stateNode.containerInfo);break;case 10:var l=n.type._context,r=n.memoizedProps.value;Ye(aa,l._currentValue),l._currentValue=r;break;case 13:if(l=n.memoizedState,l!==null)return l.dehydrated!==null?(Ye(tt,tt.current&1),n.flags|=128,null):s&n.child.childLanes?Ff(e,n,s):(Ye(tt,tt.current&1),e=Pn(e,n,s),e!==null?e.sibling:null);Ye(tt,tt.current&1);break;case 19:if(l=(s&n.childLanes)!==0,e.flags&128){if(l)return Gf(e,n,s);n.flags|=128}if(r=n.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ye(tt,tt.current),l)break;return null;case 22:case 23:return n.lanes=0,qf(e,n,s)}return Pn(e,n,s)}var Wf,go,Hf,Vf;Wf=function(e,n){for(var s=n.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};go=function(){};Hf=function(e,n,s,l){var r=e.memoizedProps;if(r!==l){e=n.stateNode,us(yn.current);var a=null;switch(s){case"input":r=Bi(e,r),l=Bi(e,l),a=[];break;case"select":r=lt({},r,{value:void 0}),l=lt({},l,{value:void 0}),a=[];break;case"textarea":r=qi(e,r),l=qi(e,l),a=[];break;default:typeof r.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=ta)}Ui(s,l);var i;s=null;for(d in r)if(!l.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var o=r[d];for(i in o)o.hasOwnProperty(i)&&(s||(s={}),s[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Tl.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in l){var c=l[d];if(o=r!=null?r[d]:void 0,l.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(s||(s={}),s[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(s||(s={}),s[i]=c[i])}else s||(a||(a=[]),a.push(d,s)),s=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Tl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Xe("scroll",e),a||o===c||(a=[])):(a=a||[]).push(d,c))}s&&(a=a||[]).push("style",s);var d=a;(n.updateQueue=d)&&(n.flags|=4)}};Vf=function(e,n,s,l){s!==l&&(n.flags|=4)};function fl(e,n){if(!et)switch(e.tailMode){case"hidden":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Nt(e){var n=e.alternate!==null&&e.alternate.child===e.child,s=0,l=0;if(n)for(var r=e.child;r!==null;)s|=r.lanes|r.childLanes,l|=r.subtreeFlags&14680064,l|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)s|=r.lanes|r.childLanes,l|=r.subtreeFlags,l|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=l,e.childLanes=s,n}function Eh(e,n,s){var l=n.pendingProps;switch(Qo(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(n),null;case 1:return $t(n.type)&&na(),Nt(n),null;case 3:return l=n.stateNode,Ys(),Ze(Lt),Ze(St),lc(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(vr(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,an!==null&&(ko(an),an=null))),go(e,n),Nt(n),null;case 5:sc(n);var r=us(Fl.current);if(s=n.type,e!==null&&n.stateNode!=null)Hf(e,n,s,l,r),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!l){if(n.stateNode===null)throw Error(se(166));return Nt(n),null}if(e=us(yn.current),vr(n)){l=n.stateNode,s=n.type;var a=n.memoizedProps;switch(l[gn]=n,l[zl]=a,e=(n.mode&1)!==0,s){case"dialog":Xe("cancel",l),Xe("close",l);break;case"iframe":case"object":case"embed":Xe("load",l);break;case"video":case"audio":for(r=0;r<yl.length;r++)Xe(yl[r],l);break;case"source":Xe("error",l);break;case"img":case"image":case"link":Xe("error",l),Xe("load",l);break;case"details":Xe("toggle",l);break;case"input":Oc(l,a),Xe("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!a.multiple},Xe("invalid",l);break;case"textarea":qc(l,a),Xe("invalid",l)}Ui(s,a),r=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?l.textContent!==o&&(a.suppressHydrationWarning!==!0&&br(l.textContent,o,e),r=["children",o]):typeof o=="number"&&l.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&br(l.textContent,o,e),r=["children",""+o]):Tl.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Xe("scroll",l)}switch(s){case"input":ur(l),Dc(l,a,!0);break;case"textarea":ur(l),zc(l);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(l.onclick=ta)}l=r,n.updateQueue=l,l!==null&&(n.flags|=4)}else{i=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=vm(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=i.createElement(s,{is:l.is}):(e=i.createElement(s),s==="select"&&(i=e,l.multiple?i.multiple=!0:l.size&&(i.size=l.size))):e=i.createElementNS(e,s),e[gn]=n,e[zl]=l,Wf(e,n,!1,!1),n.stateNode=e;e:{switch(i=Fi(s,l),s){case"dialog":Xe("cancel",e),Xe("close",e),r=l;break;case"iframe":case"object":case"embed":Xe("load",e),r=l;break;case"video":case"audio":for(r=0;r<yl.length;r++)Xe(yl[r],e);r=l;break;case"source":Xe("error",e),r=l;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),r=l;break;case"details":Xe("toggle",e),r=l;break;case"input":Oc(e,l),r=Bi(e,l),Xe("invalid",e);break;case"option":r=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},r=lt({},l,{value:void 0}),Xe("invalid",e);break;case"textarea":qc(e,l),r=qi(e,l),Xe("invalid",e);break;default:r=l}Ui(s,r),o=r;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?Nm(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&jm(e,c)):a==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&_l(e,c):typeof c=="number"&&_l(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Tl.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Xe("scroll",e):c!=null&&Ro(e,a,c,i))}switch(s){case"input":ur(e),Dc(e,l,!1);break;case"textarea":ur(e),zc(e);break;case"option":l.value!=null&&e.setAttribute("value",""+Zn(l.value));break;case"select":e.multiple=!!l.multiple,a=l.value,a!=null?zs(e,!!l.multiple,a,!1):l.defaultValue!=null&&zs(e,!!l.multiple,l.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=ta)}switch(s){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Nt(n),null;case 6:if(e&&n.stateNode!=null)Vf(e,n,e.memoizedProps,l);else{if(typeof l!="string"&&n.stateNode===null)throw Error(se(166));if(s=us(Fl.current),us(yn.current),vr(n)){if(l=n.stateNode,s=n.memoizedProps,l[gn]=n,(a=l.nodeValue!==s)&&(e=qt,e!==null))switch(e.tag){case 3:br(l.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&br(l.nodeValue,s,(e.mode&1)!==0)}a&&(n.flags|=4)}else l=(s.nodeType===9?s:s.ownerDocument).createTextNode(l),l[gn]=n,n.stateNode=l}return Nt(n),null;case 13:if(Ze(tt),l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(et&&Dt!==null&&n.mode&1&&!(n.flags&128))uf(),Qs(),n.flags|=98560,a=!1;else if(a=vr(n),l!==null&&l.dehydrated!==null){if(e===null){if(!a)throw Error(se(318));if(a=n.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(se(317));a[gn]=n}else Qs(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Nt(n),a=!1}else an!==null&&(ko(an),an=null),a=!0;if(!a)return n.flags&65536?n:null}return n.flags&128?(n.lanes=s,n):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(n.child.flags|=8192,n.mode&1&&(e===null||tt.current&1?mt===0&&(mt=3):gc())),n.updateQueue!==null&&(n.flags|=4),Nt(n),null);case 4:return Ys(),go(e,n),e===null&&Dl(n.stateNode.containerInfo),Nt(n),null;case 10:return Zo(n.type._context),Nt(n),null;case 17:return $t(n.type)&&na(),Nt(n),null;case 19:if(Ze(tt),a=n.memoizedState,a===null)return Nt(n),null;if(l=(n.flags&128)!==0,i=a.rendering,i===null)if(l)fl(a,!1);else{if(mt!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(i=ca(e),i!==null){for(n.flags|=128,fl(a,!1),l=i.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),n.subtreeFlags=0,l=s,s=n.child;s!==null;)a=s,e=l,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Ye(tt,tt.current&1|2),n.child}e=e.sibling}a.tail!==null&&at()>Zs&&(n.flags|=128,l=!0,fl(a,!1),n.lanes=4194304)}else{if(!l)if(e=ca(i),e!==null){if(n.flags|=128,l=!0,s=e.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),fl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!et)return Nt(n),null}else 2*at()-a.renderingStartTime>Zs&&s!==1073741824&&(n.flags|=128,l=!0,fl(a,!1),n.lanes=4194304);a.isBackwards?(i.sibling=n.child,n.child=i):(s=a.last,s!==null?s.sibling=i:n.child=i,a.last=i)}return a.tail!==null?(n=a.tail,a.rendering=n,a.tail=n.sibling,a.renderingStartTime=at(),n.sibling=null,s=tt.current,Ye(tt,l?s&1|2:s&1),n):(Nt(n),null);case 22:case 23:return pc(),l=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(n.flags|=8192),l&&n.mode&1?Ot&1073741824&&(Nt(n),n.subtreeFlags&6&&(n.flags|=8192)):Nt(n),null;case 24:return null;case 25:return null}throw Error(se(156,n.tag))}function Mh(e,n){switch(Qo(n),n.tag){case 1:return $t(n.type)&&na(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Ys(),Ze(Lt),Ze(St),lc(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return sc(n),null;case 13:if(Ze(tt),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(se(340));Qs()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Ze(tt),null;case 4:return Ys(),null;case 10:return Zo(n.type._context),null;case 22:case 23:return pc(),null;case 24:return null;default:return null}}var Nr=!1,kt=!1,Th=typeof WeakSet=="function"?WeakSet:Set,ye=null;function Ds(e,n){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(l){rt(e,n,l)}else s.current=null}function ho(e,n,s){try{s()}catch(l){rt(e,n,l)}}var Md=!1;function _h(e,n){if(Zi=Xr,e=Ym(),Vo(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var r=l.anchorOffset,a=l.focusNode;l=l.focusOffset;try{s.nodeType,a.nodeType}catch{s=null;break e}var i=0,o=-1,c=-1,d=0,u=0,p=e,m=null;t:for(;;){for(var h;p!==s||r!==0&&p.nodeType!==3||(o=i+r),p!==a||l!==0&&p.nodeType!==3||(c=i+l),p.nodeType===3&&(i+=p.nodeValue.length),(h=p.firstChild)!==null;)m=p,p=h;for(;;){if(p===e)break t;if(m===s&&++d===r&&(o=i),m===a&&++u===l&&(c=i),(h=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=h}s=o===-1||c===-1?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(eo={focusedElem:e,selectionRange:s},Xr=!1,ye=n;ye!==null;)if(n=ye,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,ye=e;else for(;ye!==null;){n=ye;try{var y=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var b=y.memoizedProps,j=y.memoizedState,g=n.stateNode,x=g.getSnapshotBeforeUpdate(n.elementType===n.type?b:ln(n.type,b),j);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=n.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(w){rt(n,n.return,w)}if(e=n.sibling,e!==null){e.return=n.return,ye=e;break}ye=n.return}return y=Md,Md=!1,y}function Sl(e,n,s){var l=n.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var r=l=l.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,a!==void 0&&ho(n,s,a)}r=r.next}while(r!==l)}}function Ea(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var l=s.create;s.destroy=l()}s=s.next}while(s!==n)}}function yo(e){var n=e.ref;if(n!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof n=="function"?n(e):n.current=e}}function Kf(e){var n=e.alternate;n!==null&&(e.alternate=null,Kf(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[gn],delete n[zl],delete n[so],delete n[xh],delete n[ph])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Qf(e){return e.tag===5||e.tag===3||e.tag===4}function Td(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Qf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function bo(e,n,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?s.nodeType===8?s.parentNode.insertBefore(e,n):s.insertBefore(e,n):(s.nodeType===8?(n=s.parentNode,n.insertBefore(e,s)):(n=s,n.appendChild(e)),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=ta));else if(l!==4&&(e=e.child,e!==null))for(bo(e,n,s),e=e.sibling;e!==null;)bo(e,n,s),e=e.sibling}function vo(e,n,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?s.insertBefore(e,n):s.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(vo(e,n,s),e=e.sibling;e!==null;)vo(e,n,s),e=e.sibling}var gt=null,rn=!1;function An(e,n,s){for(s=s.child;s!==null;)Jf(e,n,s),s=s.sibling}function Jf(e,n,s){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(ja,s)}catch{}switch(s.tag){case 5:kt||Ds(s,n);case 6:var l=gt,r=rn;gt=null,An(e,n,s),gt=l,rn=r,gt!==null&&(rn?(e=gt,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):gt.removeChild(s.stateNode));break;case 18:gt!==null&&(rn?(e=gt,s=s.stateNode,e.nodeType===8?ui(e.parentNode,s):e.nodeType===1&&ui(e,s),$l(e)):ui(gt,s.stateNode));break;case 4:l=gt,r=rn,gt=s.stateNode.containerInfo,rn=!0,An(e,n,s),gt=l,rn=r;break;case 0:case 11:case 14:case 15:if(!kt&&(l=s.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){r=l=l.next;do{var a=r,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&ho(s,n,i),r=r.next}while(r!==l)}An(e,n,s);break;case 1:if(!kt&&(Ds(s,n),l=s.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=s.memoizedProps,l.state=s.memoizedState,l.componentWillUnmount()}catch(o){rt(s,n,o)}An(e,n,s);break;case 21:An(e,n,s);break;case 22:s.mode&1?(kt=(l=kt)||s.memoizedState!==null,An(e,n,s),kt=l):An(e,n,s);break;default:An(e,n,s)}}function _d(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Th),n.forEach(function(l){var r=zh.bind(null,e,l);s.has(l)||(s.add(l),l.then(r,r))})}}function sn(e,n){var s=n.deletions;if(s!==null)for(var l=0;l<s.length;l++){var r=s[l];try{var a=e,i=n,o=i;e:for(;o!==null;){switch(o.tag){case 5:gt=o.stateNode,rn=!1;break e;case 3:gt=o.stateNode.containerInfo,rn=!0;break e;case 4:gt=o.stateNode.containerInfo,rn=!0;break e}o=o.return}if(gt===null)throw Error(se(160));Jf(a,i,r),gt=null,rn=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(d){rt(r,n,d)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Yf(n,e),n=n.sibling}function Yf(e,n){var s=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(sn(n,e),xn(e),l&4){try{Sl(3,e,e.return),Ea(3,e)}catch(b){rt(e,e.return,b)}try{Sl(5,e,e.return)}catch(b){rt(e,e.return,b)}}break;case 1:sn(n,e),xn(e),l&512&&s!==null&&Ds(s,s.return);break;case 5:if(sn(n,e),xn(e),l&512&&s!==null&&Ds(s,s.return),e.flags&32){var r=e.stateNode;try{_l(r,"")}catch(b){rt(e,e.return,b)}}if(l&4&&(r=e.stateNode,r!=null)){var a=e.memoizedProps,i=s!==null?s.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&ym(r,a),Fi(o,i);var d=Fi(o,a);for(i=0;i<c.length;i+=2){var u=c[i],p=c[i+1];u==="style"?Nm(r,p):u==="dangerouslySetInnerHTML"?jm(r,p):u==="children"?_l(r,p):Ro(r,u,p,d)}switch(o){case"input":Oi(r,a);break;case"textarea":bm(r,a);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?zs(r,!!a.multiple,h,!1):m!==!!a.multiple&&(a.defaultValue!=null?zs(r,!!a.multiple,a.defaultValue,!0):zs(r,!!a.multiple,a.multiple?[]:"",!1))}r[zl]=a}catch(b){rt(e,e.return,b)}}break;case 6:if(sn(n,e),xn(e),l&4){if(e.stateNode===null)throw Error(se(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(b){rt(e,e.return,b)}}break;case 3:if(sn(n,e),xn(e),l&4&&s!==null&&s.memoizedState.isDehydrated)try{$l(n.containerInfo)}catch(b){rt(e,e.return,b)}break;case 4:sn(n,e),xn(e);break;case 13:sn(n,e),xn(e),r=e.child,r.flags&8192&&(a=r.memoizedState!==null,r.stateNode.isHidden=a,!a||r.alternate!==null&&r.alternate.memoizedState!==null||(fc=at())),l&4&&_d(e);break;case 22:if(u=s!==null&&s.memoizedState!==null,e.mode&1?(kt=(d=kt)||u,sn(n,e),kt=d):sn(n,e),xn(e),l&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(ye=e,u=e.child;u!==null;){for(p=ye=u;ye!==null;){switch(m=ye,h=m.child,m.tag){case 0:case 11:case 14:case 15:Sl(4,m,m.return);break;case 1:Ds(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){l=m,s=m.return;try{n=l,y.props=n.memoizedProps,y.state=n.memoizedState,y.componentWillUnmount()}catch(b){rt(l,s,b)}}break;case 5:Ds(m,m.return);break;case 22:if(m.memoizedState!==null){Rd(p);continue}}h!==null?(h.return=m,ye=h):Rd(p)}u=u.sibling}e:for(u=null,p=e;;){if(p.tag===5){if(u===null){u=p;try{r=p.stateNode,d?(a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,c=p.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=wm("display",i))}catch(b){rt(e,e.return,b)}}}else if(p.tag===6){if(u===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(b){rt(e,e.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:sn(n,e),xn(e),l&4&&_d(e);break;case 21:break;default:sn(n,e),xn(e)}}function xn(e){var n=e.flags;if(n&2){try{e:{for(var s=e.return;s!==null;){if(Qf(s)){var l=s;break e}s=s.return}throw Error(se(160))}switch(l.tag){case 5:var r=l.stateNode;l.flags&32&&(_l(r,""),l.flags&=-33);var a=Td(e);vo(e,a,r);break;case 3:case 4:var i=l.stateNode.containerInfo,o=Td(e);bo(e,o,i);break;default:throw Error(se(161))}}catch(c){rt(e,e.return,c)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Ah(e,n,s){ye=e,Xf(e)}function Xf(e,n,s){for(var l=(e.mode&1)!==0;ye!==null;){var r=ye,a=r.child;if(r.tag===22&&l){var i=r.memoizedState!==null||Nr;if(!i){var o=r.alternate,c=o!==null&&o.memoizedState!==null||kt;o=Nr;var d=kt;if(Nr=i,(kt=c)&&!d)for(ye=r;ye!==null;)i=ye,c=i.child,i.tag===22&&i.memoizedState!==null?Ld(r):c!==null?(c.return=i,ye=c):Ld(r);for(;a!==null;)ye=a,Xf(a),a=a.sibling;ye=r,Nr=o,kt=d}Ad(e)}else r.subtreeFlags&8772&&a!==null?(a.return=r,ye=a):Ad(e)}}function Ad(e){for(;ye!==null;){var n=ye;if(n.flags&8772){var s=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:kt||Ea(5,n);break;case 1:var l=n.stateNode;if(n.flags&4&&!kt)if(s===null)l.componentDidMount();else{var r=n.elementType===n.type?s.memoizedProps:ln(n.type,s.memoizedProps);l.componentDidUpdate(r,s.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var a=n.updateQueue;a!==null&&hd(n,a,l);break;case 3:var i=n.updateQueue;if(i!==null){if(s=null,n.child!==null)switch(n.child.tag){case 5:s=n.child.stateNode;break;case 1:s=n.child.stateNode}hd(n,i,s)}break;case 5:var o=n.stateNode;if(s===null&&n.flags&4){s=o;var c=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var d=n.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var p=u.dehydrated;p!==null&&$l(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}kt||n.flags&512&&yo(n)}catch(m){rt(n,n.return,m)}}if(n===e){ye=null;break}if(s=n.sibling,s!==null){s.return=n.return,ye=s;break}ye=n.return}}function Rd(e){for(;ye!==null;){var n=ye;if(n===e){ye=null;break}var s=n.sibling;if(s!==null){s.return=n.return,ye=s;break}ye=n.return}}function Ld(e){for(;ye!==null;){var n=ye;try{switch(n.tag){case 0:case 11:case 15:var s=n.return;try{Ea(4,n)}catch(c){rt(n,s,c)}break;case 1:var l=n.stateNode;if(typeof l.componentDidMount=="function"){var r=n.return;try{l.componentDidMount()}catch(c){rt(n,r,c)}}var a=n.return;try{yo(n)}catch(c){rt(n,a,c)}break;case 5:var i=n.return;try{yo(n)}catch(c){rt(n,i,c)}}}catch(c){rt(n,n.return,c)}if(n===e){ye=null;break}var o=n.sibling;if(o!==null){o.return=n.return,ye=o;break}ye=n.return}}var Rh=Math.ceil,ma=Tn.ReactCurrentDispatcher,uc=Tn.ReactCurrentOwner,Xt=Tn.ReactCurrentBatchConfig,ze=0,pt=null,dt=null,yt=0,Ot=0,qs=ns(0),mt=0,Vl=null,ys=0,Ma=0,mc=0,Cl=null,_t=null,fc=0,Zs=1/0,vn=null,fa=!1,jo=null,Qn=null,kr=!1,Fn=null,xa=0,Il=0,wo=null,Gr=-1,Wr=0;function Pt(){return ze&6?at():Gr!==-1?Gr:Gr=at()}function Jn(e){return e.mode&1?ze&2&&yt!==0?yt&-yt:hh.transition!==null?(Wr===0&&(Wr=Lm()),Wr):(e=Ge,e!==0||(e=window.event,e=e===void 0?16:Um(e.type)),e):1}function cn(e,n,s,l){if(50<Il)throw Il=0,wo=null,Error(se(185));tr(e,s,l),(!(ze&2)||e!==pt)&&(e===pt&&(!(ze&2)&&(Ma|=s),mt===4&&zn(e,yt)),Bt(e,l),s===1&&ze===0&&!(n.mode&1)&&(Zs=at()+500,Ca&&ss()))}function Bt(e,n){var s=e.callbackNode;hg(e,n);var l=Yr(e,e===pt?yt:0);if(l===0)s!==null&&Gc(s),e.callbackNode=null,e.callbackPriority=0;else if(n=l&-l,e.callbackPriority!==n){if(s!=null&&Gc(s),n===1)e.tag===0?gh($d.bind(null,e)):of($d.bind(null,e)),mh(function(){!(ze&6)&&ss()}),s=null;else{switch($m(l)){case 1:s=Do;break;case 4:s=Am;break;case 16:s=Jr;break;case 536870912:s=Rm;break;default:s=Jr}s=ax(s,Zf.bind(null,e))}e.callbackPriority=n,e.callbackNode=s}}function Zf(e,n){if(Gr=-1,Wr=0,ze&6)throw Error(se(327));var s=e.callbackNode;if(Hs()&&e.callbackNode!==s)return null;var l=Yr(e,e===pt?yt:0);if(l===0)return null;if(l&30||l&e.expiredLanes||n)n=pa(e,l);else{n=l;var r=ze;ze|=2;var a=tx();(pt!==e||yt!==n)&&(vn=null,Zs=at()+500,fs(e,n));do try{Bh();break}catch(o){ex(e,o)}while(!0);Xo(),ma.current=a,ze=r,dt!==null?n=0:(pt=null,yt=0,n=mt)}if(n!==0){if(n===2&&(r=Ki(e),r!==0&&(l=r,n=No(e,r))),n===1)throw s=Vl,fs(e,0),zn(e,l),Bt(e,at()),s;if(n===6)zn(e,l);else{if(r=e.current.alternate,!(l&30)&&!Lh(r)&&(n=pa(e,l),n===2&&(a=Ki(e),a!==0&&(l=a,n=No(e,a))),n===1))throw s=Vl,fs(e,0),zn(e,l),Bt(e,at()),s;switch(e.finishedWork=r,e.finishedLanes=l,n){case 0:case 1:throw Error(se(345));case 2:os(e,_t,vn);break;case 3:if(zn(e,l),(l&130023424)===l&&(n=fc+500-at(),10<n)){if(Yr(e,0)!==0)break;if(r=e.suspendedLanes,(r&l)!==l){Pt(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=no(os.bind(null,e,_t,vn),n);break}os(e,_t,vn);break;case 4:if(zn(e,l),(l&4194240)===l)break;for(n=e.eventTimes,r=-1;0<l;){var i=31-on(l);a=1<<i,i=n[i],i>r&&(r=i),l&=~a}if(l=r,l=at()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*Rh(l/1960))-l,10<l){e.timeoutHandle=no(os.bind(null,e,_t,vn),l);break}os(e,_t,vn);break;case 5:os(e,_t,vn);break;default:throw Error(se(329))}}}return Bt(e,at()),e.callbackNode===s?Zf.bind(null,e):null}function No(e,n){var s=Cl;return e.current.memoizedState.isDehydrated&&(fs(e,n).flags|=256),e=pa(e,n),e!==2&&(n=_t,_t=s,n!==null&&ko(n)),e}function ko(e){_t===null?_t=e:_t.push.apply(_t,e)}function Lh(e){for(var n=e;;){if(n.flags&16384){var s=n.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var l=0;l<s.length;l++){var r=s[l],a=r.getSnapshot;r=r.value;try{if(!dn(a(),r))return!1}catch{return!1}}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function zn(e,n){for(n&=~mc,n&=~Ma,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var s=31-on(n),l=1<<s;e[s]=-1,n&=~l}}function $d(e){if(ze&6)throw Error(se(327));Hs();var n=Yr(e,0);if(!(n&1))return Bt(e,at()),null;var s=pa(e,n);if(e.tag!==0&&s===2){var l=Ki(e);l!==0&&(n=l,s=No(e,l))}if(s===1)throw s=Vl,fs(e,0),zn(e,n),Bt(e,at()),s;if(s===6)throw Error(se(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,os(e,_t,vn),Bt(e,at()),null}function xc(e,n){var s=ze;ze|=1;try{return e(n)}finally{ze=s,ze===0&&(Zs=at()+500,Ca&&ss())}}function bs(e){Fn!==null&&Fn.tag===0&&!(ze&6)&&Hs();var n=ze;ze|=1;var s=Xt.transition,l=Ge;try{if(Xt.transition=null,Ge=1,e)return e()}finally{Ge=l,Xt.transition=s,ze=n,!(ze&6)&&ss()}}function pc(){Ot=qs.current,Ze(qs)}function fs(e,n){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,uh(s)),dt!==null)for(s=dt.return;s!==null;){var l=s;switch(Qo(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&na();break;case 3:Ys(),Ze(Lt),Ze(St),lc();break;case 5:sc(l);break;case 4:Ys();break;case 13:Ze(tt);break;case 19:Ze(tt);break;case 10:Zo(l.type._context);break;case 22:case 23:pc()}s=s.return}if(pt=e,dt=e=Yn(e.current,null),yt=Ot=n,mt=0,Vl=null,mc=Ma=ys=0,_t=Cl=null,ds!==null){for(n=0;n<ds.length;n++)if(s=ds[n],l=s.interleaved,l!==null){s.interleaved=null;var r=l.next,a=s.pending;if(a!==null){var i=a.next;a.next=r,l.next=i}s.pending=l}ds=null}return e}function ex(e,n){do{var s=dt;try{if(Xo(),zr.current=ua,da){for(var l=st.memoizedState;l!==null;){var r=l.queue;r!==null&&(r.pending=null),l=l.next}da=!1}if(hs=0,xt=ut=st=null,kl=!1,Gl=0,uc.current=null,s===null||s.return===null){mt=1,Vl=n,dt=null;break}e:{var a=e,i=s.return,o=s,c=n;if(n=yt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=o,p=u.tag;if(!(u.mode&1)&&(p===0||p===11||p===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=Nd(i);if(h!==null){h.flags&=-257,kd(h,i,o,a,n),h.mode&1&&wd(a,d,n),n=h,c=d;var y=n.updateQueue;if(y===null){var b=new Set;b.add(c),n.updateQueue=b}else y.add(c);break e}else{if(!(n&1)){wd(a,d,n),gc();break e}c=Error(se(426))}}else if(et&&o.mode&1){var j=Nd(i);if(j!==null){!(j.flags&65536)&&(j.flags|=256),kd(j,i,o,a,n),Jo(Xs(c,o));break e}}a=c=Xs(c,o),mt!==4&&(mt=2),Cl===null?Cl=[a]:Cl.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,n&=-n,a.lanes|=n;var g=Bf(a,c,n);gd(a,g);break e;case 1:o=c;var x=a.type,v=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Qn===null||!Qn.has(v)))){a.flags|=65536,n&=-n,a.lanes|=n;var w=Of(a,o,n);gd(a,w);break e}}a=a.return}while(a!==null)}sx(s)}catch(k){n=k,dt===s&&s!==null&&(dt=s=s.return);continue}break}while(!0)}function tx(){var e=ma.current;return ma.current=ua,e===null?ua:e}function gc(){(mt===0||mt===3||mt===2)&&(mt=4),pt===null||!(ys&268435455)&&!(Ma&268435455)||zn(pt,yt)}function pa(e,n){var s=ze;ze|=2;var l=tx();(pt!==e||yt!==n)&&(vn=null,fs(e,n));do try{$h();break}catch(r){ex(e,r)}while(!0);if(Xo(),ze=s,ma.current=l,dt!==null)throw Error(se(261));return pt=null,yt=0,mt}function $h(){for(;dt!==null;)nx(dt)}function Bh(){for(;dt!==null&&!og();)nx(dt)}function nx(e){var n=rx(e.alternate,e,Ot);e.memoizedProps=e.pendingProps,n===null?sx(e):dt=n,uc.current=null}function sx(e){var n=e;do{var s=n.alternate;if(e=n.return,n.flags&32768){if(s=Mh(s,n),s!==null){s.flags&=32767,dt=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mt=6,dt=null;return}}else if(s=Eh(s,n,Ot),s!==null){dt=s;return}if(n=n.sibling,n!==null){dt=n;return}dt=n=e}while(n!==null);mt===0&&(mt=5)}function os(e,n,s){var l=Ge,r=Xt.transition;try{Xt.transition=null,Ge=1,Oh(e,n,s,l)}finally{Xt.transition=r,Ge=l}return null}function Oh(e,n,s,l){do Hs();while(Fn!==null);if(ze&6)throw Error(se(327));s=e.finishedWork;var r=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(se(177));e.callbackNode=null,e.callbackPriority=0;var a=s.lanes|s.childLanes;if(yg(e,a),e===pt&&(dt=pt=null,yt=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||kr||(kr=!0,ax(Jr,function(){return Hs(),null})),a=(s.flags&15990)!==0,s.subtreeFlags&15990||a){a=Xt.transition,Xt.transition=null;var i=Ge;Ge=1;var o=ze;ze|=4,uc.current=null,_h(e,s),Yf(s,e),lh(eo),Xr=!!Zi,eo=Zi=null,e.current=s,Ah(s),cg(),ze=o,Ge=i,Xt.transition=a}else e.current=s;if(kr&&(kr=!1,Fn=e,xa=r),a=e.pendingLanes,a===0&&(Qn=null),mg(s.stateNode),Bt(e,at()),n!==null)for(l=e.onRecoverableError,s=0;s<n.length;s++)r=n[s],l(r.value,{componentStack:r.stack,digest:r.digest});if(fa)throw fa=!1,e=jo,jo=null,e;return xa&1&&e.tag!==0&&Hs(),a=e.pendingLanes,a&1?e===wo?Il++:(Il=0,wo=e):Il=0,ss(),null}function Hs(){if(Fn!==null){var e=$m(xa),n=Xt.transition,s=Ge;try{if(Xt.transition=null,Ge=16>e?16:e,Fn===null)var l=!1;else{if(e=Fn,Fn=null,xa=0,ze&6)throw Error(se(331));var r=ze;for(ze|=4,ye=e.current;ye!==null;){var a=ye,i=a.child;if(ye.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(ye=d;ye!==null;){var u=ye;switch(u.tag){case 0:case 11:case 15:Sl(8,u,a)}var p=u.child;if(p!==null)p.return=u,ye=p;else for(;ye!==null;){u=ye;var m=u.sibling,h=u.return;if(Kf(u),u===d){ye=null;break}if(m!==null){m.return=h,ye=m;break}ye=h}}}var y=a.alternate;if(y!==null){var b=y.child;if(b!==null){y.child=null;do{var j=b.sibling;b.sibling=null,b=j}while(b!==null)}}ye=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,ye=i;else e:for(;ye!==null;){if(a=ye,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Sl(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,ye=g;break e}ye=a.return}}var x=e.current;for(ye=x;ye!==null;){i=ye;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,ye=v;else e:for(i=x;ye!==null;){if(o=ye,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ea(9,o)}}catch(k){rt(o,o.return,k)}if(o===i){ye=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,ye=w;break e}ye=o.return}}if(ze=r,ss(),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(ja,e)}catch{}l=!0}return l}finally{Ge=s,Xt.transition=n}}return!1}function Bd(e,n,s){n=Xs(s,n),n=Bf(e,n,1),e=Kn(e,n,1),n=Pt(),e!==null&&(tr(e,1,n),Bt(e,n))}function rt(e,n,s){if(e.tag===3)Bd(e,e,s);else for(;n!==null;){if(n.tag===3){Bd(n,e,s);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Qn===null||!Qn.has(l))){e=Xs(s,e),e=Of(n,e,1),n=Kn(n,e,1),e=Pt(),n!==null&&(tr(n,1,e),Bt(n,e));break}}n=n.return}}function Dh(e,n,s){var l=e.pingCache;l!==null&&l.delete(n),n=Pt(),e.pingedLanes|=e.suspendedLanes&s,pt===e&&(yt&s)===s&&(mt===4||mt===3&&(yt&130023424)===yt&&500>at()-fc?fs(e,0):mc|=s),Bt(e,n)}function lx(e,n){n===0&&(e.mode&1?(n=xr,xr<<=1,!(xr&130023424)&&(xr=4194304)):n=1);var s=Pt();e=In(e,n),e!==null&&(tr(e,n,s),Bt(e,s))}function qh(e){var n=e.memoizedState,s=0;n!==null&&(s=n.retryLane),lx(e,s)}function zh(e,n){var s=0;switch(e.tag){case 13:var l=e.stateNode,r=e.memoizedState;r!==null&&(s=r.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(se(314))}l!==null&&l.delete(n),lx(e,s)}var rx;rx=function(e,n,s){if(e!==null)if(e.memoizedProps!==n.pendingProps||Lt.current)Rt=!0;else{if(!(e.lanes&s)&&!(n.flags&128))return Rt=!1,Ph(e,n,s);Rt=!!(e.flags&131072)}else Rt=!1,et&&n.flags&1048576&&cf(n,ra,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;Fr(e,n),e=n.pendingProps;var r=Ks(n,St.current);Ws(n,s),r=ac(null,n,l,e,r,s);var a=ic();return n.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,$t(l)?(a=!0,sa(n)):a=!1,n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,tc(n),r.updater=Pa,n.stateNode=r,r._reactInternals=n,co(n,l,e,s),n=fo(null,n,l,!0,a,s)):(n.tag=0,et&&a&&Ko(n),It(null,n,r,s),n=n.child),n;case 16:l=n.elementType;e:{switch(Fr(e,n),e=n.pendingProps,r=l._init,l=r(l._payload),n.type=l,r=n.tag=Fh(l),e=ln(l,e),r){case 0:n=mo(null,n,l,e,s);break e;case 1:n=Id(null,n,l,e,s);break e;case 11:n=Sd(null,n,l,e,s);break e;case 14:n=Cd(null,n,l,ln(l.type,e),s);break e}throw Error(se(306,l,""))}return n;case 0:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:ln(l,r),mo(e,n,l,r,s);case 1:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:ln(l,r),Id(e,n,l,r,s);case 3:e:{if(Uf(n),e===null)throw Error(se(387));l=n.pendingProps,a=n.memoizedState,r=a.element,pf(e,n),oa(n,l,null,s);var i=n.memoizedState;if(l=i.element,a.isDehydrated)if(a={element:l,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},n.updateQueue.baseState=a,n.memoizedState=a,n.flags&256){r=Xs(Error(se(423)),n),n=Pd(e,n,l,s,r);break e}else if(l!==r){r=Xs(Error(se(424)),n),n=Pd(e,n,l,s,r);break e}else for(Dt=Vn(n.stateNode.containerInfo.firstChild),qt=n,et=!0,an=null,s=ff(n,null,l,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Qs(),l===r){n=Pn(e,n,s);break e}It(e,n,l,s)}n=n.child}return n;case 5:return gf(n),e===null&&ao(n),l=n.type,r=n.pendingProps,a=e!==null?e.memoizedProps:null,i=r.children,to(l,r)?i=null:a!==null&&to(l,a)&&(n.flags|=32),zf(e,n),It(e,n,i,s),n.child;case 6:return e===null&&ao(n),null;case 13:return Ff(e,n,s);case 4:return nc(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Js(n,null,l,s):It(e,n,l,s),n.child;case 11:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:ln(l,r),Sd(e,n,l,r,s);case 7:return It(e,n,n.pendingProps,s),n.child;case 8:return It(e,n,n.pendingProps.children,s),n.child;case 12:return It(e,n,n.pendingProps.children,s),n.child;case 10:e:{if(l=n.type._context,r=n.pendingProps,a=n.memoizedProps,i=r.value,Ye(aa,l._currentValue),l._currentValue=i,a!==null)if(dn(a.value,i)){if(a.children===r.children&&!Lt.current){n=Pn(e,n,s);break e}}else for(a=n.child,a!==null&&(a.return=n);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===l){if(a.tag===1){c=kn(-1,s&-s),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}a.lanes|=s,c=a.alternate,c!==null&&(c.lanes|=s),io(a.return,s,n),o.lanes|=s;break}c=c.next}}else if(a.tag===10)i=a.type===n.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(se(341));i.lanes|=s,o=i.alternate,o!==null&&(o.lanes|=s),io(i,s,n),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===n){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}It(e,n,r.children,s),n=n.child}return n;case 9:return r=n.type,l=n.pendingProps.children,Ws(n,s),r=Zt(r),l=l(r),n.flags|=1,It(e,n,l,s),n.child;case 14:return l=n.type,r=ln(l,n.pendingProps),r=ln(l.type,r),Cd(e,n,l,r,s);case 15:return Df(e,n,n.type,n.pendingProps,s);case 17:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:ln(l,r),Fr(e,n),n.tag=1,$t(l)?(e=!0,sa(n)):e=!1,Ws(n,s),$f(n,l,r),co(n,l,r,s),fo(null,n,l,!0,e,s);case 19:return Gf(e,n,s);case 22:return qf(e,n,s)}throw Error(se(156,n.tag))};function ax(e,n){return _m(e,n)}function Uh(e,n,s,l){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yt(e,n,s,l){return new Uh(e,n,s,l)}function hc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Fh(e){if(typeof e=="function")return hc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===$o)return 11;if(e===Bo)return 14}return 2}function Yn(e,n){var s=e.alternate;return s===null?(s=Yt(e.tag,n,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=n,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,n=e.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Hr(e,n,s,l,r,a){var i=2;if(l=e,typeof e=="function")hc(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ms:return xs(s.children,r,a,n);case Lo:i=8,r|=8;break;case Ai:return e=Yt(12,s,n,r|2),e.elementType=Ai,e.lanes=a,e;case Ri:return e=Yt(13,s,n,r),e.elementType=Ri,e.lanes=a,e;case Li:return e=Yt(19,s,n,r),e.elementType=Li,e.lanes=a,e;case pm:return Ta(s,r,a,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case fm:i=10;break e;case xm:i=9;break e;case $o:i=11;break e;case Bo:i=14;break e;case On:i=16,l=null;break e}throw Error(se(130,e==null?e:typeof e,""))}return n=Yt(i,s,n,r),n.elementType=e,n.type=l,n.lanes=a,n}function xs(e,n,s,l){return e=Yt(7,e,l,n),e.lanes=s,e}function Ta(e,n,s,l){return e=Yt(22,e,l,n),e.elementType=pm,e.lanes=s,e.stateNode={isHidden:!1},e}function bi(e,n,s){return e=Yt(6,e,null,n),e.lanes=s,e}function vi(e,n,s){return n=Yt(4,e.children!==null?e.children:[],e.key,n),n.lanes=s,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Gh(e,n,s,l,r){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ei(0),this.expirationTimes=ei(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ei(0),this.identifierPrefix=l,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function yc(e,n,s,l,r,a,i,o,c){return e=new Gh(e,n,s,o,c),n===1?(n=1,a===!0&&(n|=8)):n=0,a=Yt(3,null,null,n),e.current=a,a.stateNode=e,a.memoizedState={element:l,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},tc(a),e}function Wh(e,n,s){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Es,key:l==null?null:""+l,children:e,containerInfo:n,implementation:s}}function ix(e){if(!e)return es;e=e._reactInternals;e:{if(js(e)!==e||e.tag!==1)throw Error(se(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if($t(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(se(171))}if(e.tag===1){var s=e.type;if($t(s))return af(e,s,n)}return n}function ox(e,n,s,l,r,a,i,o,c){return e=yc(s,l,!0,e,r,a,i,o,c),e.context=ix(null),s=e.current,l=Pt(),r=Jn(s),a=kn(l,r),a.callback=n??null,Kn(s,a,r),e.current.lanes=r,tr(e,r,l),Bt(e,l),e}function _a(e,n,s,l){var r=n.current,a=Pt(),i=Jn(r);return s=ix(s),n.context===null?n.context=s:n.pendingContext=s,n=kn(a,i),n.payload={element:e},l=l===void 0?null:l,l!==null&&(n.callback=l),e=Kn(r,n,i),e!==null&&(cn(e,r,i,a),qr(e,r,i)),i}function ga(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Od(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<n?s:n}}function bc(e,n){Od(e,n),(e=e.alternate)&&Od(e,n)}function Hh(){return null}var cx=typeof reportError=="function"?reportError:function(e){console.error(e)};function vc(e){this._internalRoot=e}Aa.prototype.render=vc.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(se(409));_a(e,n,null,null)};Aa.prototype.unmount=vc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;bs(function(){_a(null,e,null,null)}),n[Cn]=null}};function Aa(e){this._internalRoot=e}Aa.prototype.unstable_scheduleHydration=function(e){if(e){var n=Dm();e={blockedOn:null,target:e,priority:n};for(var s=0;s<qn.length&&n!==0&&n<qn[s].priority;s++);qn.splice(s,0,e),s===0&&zm(e)}};function jc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ra(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Dd(){}function Vh(e,n,s,l,r){if(r){if(typeof l=="function"){var a=l;l=function(){var d=ga(i);a.call(d)}}var i=ox(n,l,e,0,null,!1,!1,"",Dd);return e._reactRootContainer=i,e[Cn]=i.current,Dl(e.nodeType===8?e.parentNode:e),bs(),i}for(;r=e.lastChild;)e.removeChild(r);if(typeof l=="function"){var o=l;l=function(){var d=ga(c);o.call(d)}}var c=yc(e,0,!1,null,null,!1,!1,"",Dd);return e._reactRootContainer=c,e[Cn]=c.current,Dl(e.nodeType===8?e.parentNode:e),bs(function(){_a(n,c,s,l)}),c}function La(e,n,s,l,r){var a=s._reactRootContainer;if(a){var i=a;if(typeof r=="function"){var o=r;r=function(){var c=ga(i);o.call(c)}}_a(n,i,e,r)}else i=Vh(s,n,e,r,l);return ga(i)}Bm=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var s=hl(n.pendingLanes);s!==0&&(qo(n,s|1),Bt(n,at()),!(ze&6)&&(Zs=at()+500,ss()))}break;case 13:bs(function(){var l=In(e,1);if(l!==null){var r=Pt();cn(l,e,1,r)}}),bc(e,1)}};zo=function(e){if(e.tag===13){var n=In(e,134217728);if(n!==null){var s=Pt();cn(n,e,134217728,s)}bc(e,134217728)}};Om=function(e){if(e.tag===13){var n=Jn(e),s=In(e,n);if(s!==null){var l=Pt();cn(s,e,n,l)}bc(e,n)}};Dm=function(){return Ge};qm=function(e,n){var s=Ge;try{return Ge=e,n()}finally{Ge=s}};Wi=function(e,n,s){switch(n){case"input":if(Oi(e,s),n=s.name,s.type==="radio"&&n!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<s.length;n++){var l=s[n];if(l!==e&&l.form===e.form){var r=Sa(l);if(!r)throw Error(se(90));hm(l),Oi(l,r)}}}break;case"textarea":bm(e,s);break;case"select":n=s.value,n!=null&&zs(e,!!s.multiple,n,!1)}};Cm=xc;Im=bs;var Kh={usingClientEntryPoint:!1,Events:[sr,Rs,Sa,km,Sm,xc]},xl={findFiberByHostInstance:cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qh={bundleType:xl.bundleType,version:xl.version,rendererPackageName:xl.rendererPackageName,rendererConfig:xl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Tn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Mm(e),e===null?null:e.stateNode},findFiberByHostInstance:xl.findFiberByHostInstance||Hh,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sr.isDisabled&&Sr.supportsFiber)try{ja=Sr.inject(Qh),hn=Sr}catch{}}Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kh;Ut.createPortal=function(e,n){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!jc(n))throw Error(se(200));return Wh(e,n,null,s)};Ut.createRoot=function(e,n){if(!jc(e))throw Error(se(299));var s=!1,l="",r=cx;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(r=n.onRecoverableError)),n=yc(e,1,!1,null,null,s,!1,l,r),e[Cn]=n.current,Dl(e.nodeType===8?e.parentNode:e),new vc(n)};Ut.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(se(188)):(e=Object.keys(e).join(","),Error(se(268,e)));return e=Mm(n),e=e===null?null:e.stateNode,e};Ut.flushSync=function(e){return bs(e)};Ut.hydrate=function(e,n,s){if(!Ra(n))throw Error(se(200));return La(null,e,n,!0,s)};Ut.hydrateRoot=function(e,n,s){if(!jc(e))throw Error(se(405));var l=s!=null&&s.hydratedSources||null,r=!1,a="",i=cx;if(s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(i=s.onRecoverableError)),n=ox(n,null,e,1,s??null,r,!1,a,i),e[Cn]=n.current,Dl(e),l)for(e=0;e<l.length;e++)s=l[e],r=s._getVersion,r=r(s._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[s,r]:n.mutableSourceEagerHydrationData.push(s,r);return new Aa(n)};Ut.render=function(e,n,s){if(!Ra(n))throw Error(se(200));return La(null,e,n,!1,s)};Ut.unmountComponentAtNode=function(e){if(!Ra(e))throw Error(se(40));return e._reactRootContainer?(bs(function(){La(null,null,e,!1,function(){e._reactRootContainer=null,e[Cn]=null})}),!0):!1};Ut.unstable_batchedUpdates=xc;Ut.unstable_renderSubtreeIntoContainer=function(e,n,s,l){if(!Ra(s))throw Error(se(200));if(e==null||e._reactInternals===void 0)throw Error(se(38));return La(e,n,s,!1,l)};Ut.version="18.3.1-next-f1338f8080-20240426";function dx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dx)}catch(e){console.error(e)}}dx(),cm.exports=Ut;var Jh=cm.exports,qd=Jh;Ti.createRoot=qd.createRoot,Ti.hydrateRoot=qd.hydrateRoot;const U=({children:e,onClick:n,colorScheme:s="accent",disabled:l=!1,className:r="",type:a="button",title:i})=>{const o="px-4 py-2 font-bold rounded-lg transition-all duration-150 ease-in-out border border-color shadow-lg active:translate-y-0.5 active:shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-primary disabled:bg-secondary disabled:opacity-70 disabled:cursor-not-allowed",c={accent:"bg-accent hover:bg-accent-hover text-white focus:ring-accent",blue:"bg-blue-600 hover:bg-blue-500 text-white focus:ring-blue-400",red:"bg-danger hover:bg-danger-hover text-white focus:ring-red-400",gray:"bg-secondary hover:bg-tertiary text-secondary focus:ring-color",green:"bg-success hover:opacity-90 text-white focus:ring-green-400",yellow:"bg-yellow-500 hover:bg-yellow-400 text-black focus:ring-yellow-300",purple:"bg-purple-600 hover:bg-purple-500 text-white focus:ring-purple-400",orange:"bg-orange-500 hover:bg-orange-400 text-white focus:ring-orange-300"};return t.jsx("button",{type:a,onClick:n,disabled:l,className:`${o} ${c[s]} ${r}`,title:i,children:e})},Yh=({userId:e,userName:n,avatarUrl:s,borderUrl:l,size:r=40,className:a=""})=>{const i=r/16,o=l&&(l.startsWith("#")||l.startsWith("conic-gradient")),c=l&&!o,d=s||"/images/profiles/profile1.png";if(c){let u=i*1.4;l.includes("Ring")&&(u=i*1.5);const p={width:`${i}rem`,height:`${i}rem`};return l.includes("Ring5.png")&&(p.transform=`translateX(-${i*.2}rem)`),t.jsxs("div",{className:`relative flex-shrink-0 flex items-center justify-center ${a}`,style:{width:`${u}rem`,height:`${u}rem`},children:[t.jsx("div",{className:"rounded-full overflow-hidden bg-gray-700",style:p,children:t.jsx("img",{src:d,alt:n,className:"w-full h-full object-cover"})}),t.jsx("img",{src:l,alt:"",className:"absolute inset-0 w-full h-full pointer-events-none object-contain","aria-hidden":"true"})]})}if(o){const u=i*.85,p=l.startsWith("conic-gradient");return t.jsx("div",{className:`relative flex items-center justify-center rounded-full flex-shrink-0 ${a}`,style:{width:`${i}rem`,height:`${i}rem`,...p?{background:l}:{backgroundColor:l}},children:t.jsx("div",{className:"flex items-center justify-center rounded-full overflow-hidden bg-gray-700",style:{width:`${u}rem`,height:`${u}rem`},children:t.jsx("img",{src:d,alt:n,className:"w-full h-full object-cover"})})})}return t.jsx("div",{className:`rounded-full overflow-hidden bg-gray-700 flex-shrink-0 ${a}`,style:{width:`${i}rem`,height:`${i}rem`},children:t.jsx("img",{src:d,alt:n,className:"w-full h-full object-cover"})})},Ce=Mn.memo(Yh);var B=(e=>(e[e.None=0]="None",e[e.Black=1]="Black",e[e.White=2]="White",e))(B||{}),T=(e=>(e.Standard=" ",e.Capture=" ",e.Speed=" ",e.Base=" ",e.Hidden=" ",e.Missile=" ",e.Mix=" ",e.Dice=" ",e.Omok="",e.Ttamok="",e.Thief=" ",e.Alkkagi="",e.Curling=" ",e))(T||{}),ht=(e=>(e.Sprout="",e.Rookie="",e.Rising="",e.Ace="",e.Diamond="",e.Master="",e.Grandmaster="",e.Challenger="",e))(ht||{}),wc=(e=>(e.Basic="basic",e))(wc||{}),Nc=(e=>(e.TurnByTurn=" ",e.Simultaneous=" ",e))(Nc||{}),Kl=(e=>(e.Normal="",e.Battle="",e))(Kl||{}),N=(e=>(e.Concentration="",e.ThinkingSpeed="",e.Judgment="",e.Calculation="",e.CombatPower="",e.Stability="",e))(N||{}),Fe=(e=>(e.ActionPointMax=" ",e.ActionPointRegen=" ",e.StrategyXpBonus="  ",e.PlayfulXpBonus="  ",e.GoldBonus="   ",e.ItemDropRate="  ",e.MaterialDropRate="  ",e))(Fe||{}),ct=(e=>(e.MannerActionCooldown="    ",e.StrategicGoldBonus="    20% (10~50) 5",e.PlayfulGoldBonus="   60 20% (10~50) 5",e.DiceGoOddBonus=" / ",e.AlkkagiSlowBonus="     1",e.AlkkagiAimingBonus="     1",e))(ct||{}),Ae=(e=>(e.="",e.="",e.="",e.="",e.="",e))(Ae||{});const el="ai-player-01",Qe=[{mode:T.Standard,name:" ",description:"  .",available:!0,image:"/images/simbols/simbol1.png"},{mode:T.Capture,name:" ",description:"       .",available:!0,image:"/images/simbols/simbol2.png"},{mode:T.Speed,name:" ",description:"       .       .",available:!0,image:"/images/simbols/simbol3.png"},{mode:T.Base,name:" ",description:"  ''     .   ,    /    .        .",available:!0,image:"/images/simbols/simbol4.png"},{mode:T.Hidden,name:" ",description:"   ''   ,  ''       .        ,      .",available:!0,image:"/images/simbols/simbol5.png"},{mode:T.Missile,name:" ",description:"        .",available:!0,image:"/images/simbols/simbol6.png"},{mode:T.Mix,name:" ",description:", , , ,    2    .",available:!0,image:"/images/simbols/simbol7.png"}],nt=[{mode:T.Dice,name:" ",description:" 3 ,          .     .",available:!0,image:"/images/simbols/simbolp1.png"},{mode:T.Omok,name:"",description:"        .",available:!0,image:"/images/simbols/simbolp2.png"},{mode:T.Ttamok,name:"",description:"       .",available:!0,image:"/images/simbols/simbolp3.png"},{mode:T.Thief,name:"",description:"() ()    5 ,      .",available:!0,image:"/images/simbols/simbolp4.png"},{mode:T.Alkkagi,name:"",description:"        .",available:!0,image:"/images/simbols/simbolp5.png"},{mode:T.Curling,name:"",description:"    ()      .",available:!0,image:"/images/simbols/simbolp6.png"}],zd=[19,13,9],Ud=[19,15],Fd=[13,11,9,7],Gd=[7,9,11,13,19],Wd=[19,13,11,9,7],Hd=[9,13,19],Vd=[19,13,9],Kd=[5,10,15,20,25,30],Xh=[10,20,30],Qd=[1,2,3],Jd=[1,2,3,4,5,6,7,8,9,10],Yd=Array.from({length:15},(e,n)=>n+1),Zh=[{value:0,label:""},{value:5,label:"5"},{value:10,label:"10"},{value:15,label:"15"},{value:20,label:"20"},{value:30,label:"30"},{value:40,label:"40"},{value:50,label:"50"},{value:60,label:"1"},{value:120,label:"2"},{value:180,label:"3"}],e0=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:30,label:"30"}],t0=[1,2,3,4,5,6,7,8,9,10],n0=[10,20,30,40,50,60],ji=[3,4,5,6,7,8,9,10],ux=6.5,s0=5,Xd=[0,1,2,3],Zd=[0,1,2,3],l0=[1,2,3],r0=[1,2,3],eu=[0,1,2,3,4,5],tu={boardSize:19,timeLimit:10,byoyomiCount:3,byoyomiTime:30,baseStones:4,diceGoVariant:wc.Basic,diceGoRounds:3,oddDiceCount:1,evenDiceCount:1,captureTarget:20,timeIncrement:5,hiddenStoneCount:2,scanCount:5,missileCount:5,mixedModes:[T.Hidden,T.Speed],hasOverlineForbidden:!0,has33Forbidden:!0,alkkagiPlacementType:Nc.TurnByTurn,alkkagiLayout:Kl.Normal,alkkagiStoneCount:5,alkkagiGaugeSpeed:700,alkkagiSlowItemCount:2,alkkagiAimingLineItemCount:2,alkkagiRounds:1,curlingStoneCount:5,curlingGaugeSpeed:700,curlingSlowItemCount:2,curlingAimingLineItemCount:2,curlingRounds:3,komi:ux,player1Color:B.Black,aiDifficulty:1},a0=[5,7,10],i0=30,Cr=30,nu=30;wc.Basic+"";const su=[3,5,7,9],o0=30,c0=30,d0=30,So=[{value:1e3,label:"x1 ()"},{value:700,label:"x2 ()"},{value:400,label:"x3 ()"}],lu={[B.Black]:[{x:7,y:4,width:5,height:2},{x:4,y:7,width:2,height:4},{x:13,y:7,width:2,height:4},{x:7,y:13,width:2,height:2},{x:10,y:13,width:2,height:2}],[B.White]:[{x:4,y:4,width:2,height:2},{x:13,y:4,width:2,height:2},{x:7,y:7,width:5,height:2},{x:7,y:10,width:5,height:2}]},u0=5,ru=[3,5,7],m0=30,Co=[{value:1e3,label:"x1 ()"},{value:700,label:"x2 ()"},{value:400,label:"x3 ()"}],$a={fan:"images/equipments/EmptyFanSlot.png",board:"images/equipments/EmptyBoardSlot.png",top:"images/equipments/EmptyTopSlot.png",bottom:"images/equipments/EmptyBottomSlot.png",bowl:"images/equipments/EmptyStoneBoxSlot.png",stones:"images/equipments/EmptyStoneSlot.png"},En={normal:1,uncommon:1,rare:5,epic:12,legendary:20,mythic:30},kc=[{name:"  ",slot:"fan",image:"images/equipments/Fan1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:"  ",slot:"fan",image:"images/equipments/Fan2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"fan",image:"images/equipments/Fan3.png",grade:"rare",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"fan",image:"images/equipments/Fan4.png",grade:"epic",stars:0,type:"equipment",description:"        ."},{name:"  ",slot:"fan",image:"images/equipments/Fan5.png",grade:"legendary",stars:0,type:"equipment",description:"      ."},{name:"  ",slot:"fan",image:"images/equipments/Fan6.png",grade:"mythic",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"board",image:"images/equipments/Board1.png",grade:"normal",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"board",image:"images/equipments/Board2.png",grade:"uncommon",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"board",image:"images/equipments/Board3.png",grade:"rare",stars:0,type:"equipment",description:"       ."},{name:" ",slot:"board",image:"images/equipments/Board4.png",grade:"epic",stars:0,type:"equipment",description:"    ."},{name:" ",slot:"board",image:"images/equipments/Board5.png",grade:"legendary",stars:0,type:"equipment",description:"       ."},{name:" ",slot:"board",image:"images/equipments/Board6.png",grade:"mythic",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top1.png",grade:"normal",stars:0,type:"equipment",description:"    ."},{name:"  ",slot:"top",image:"images/equipments/Top2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top3.png",grade:"rare",stars:0,type:"equipment",description:"    ."},{name:"  ",slot:"top",image:"images/equipments/Top4.png",grade:"epic",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top5.png",grade:"legendary",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top6.png",grade:"mythic",stars:0,type:"equipment",description:"       ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom3.png",grade:"rare",stars:0,type:"equipment",description:"      ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom4.png",grade:"epic",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom5.png",grade:"legendary",stars:0,type:"equipment",description:"      ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom6.png",grade:"mythic",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox3.png",grade:"rare",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox4.png",grade:"epic",stars:0,type:"equipment",description:"       ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox5.png",grade:"legendary",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox6.png",grade:"mythic",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"stones",image:"images/equipments/Stone1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:" ",slot:"stones",image:"images/equipments/Stone2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"stones",image:"images/equipments/Stone3.png",grade:"rare",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"stones",image:"images/equipments/Stone4.png",grade:"epic",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"stones",image:"images/equipments/Stone5.png",grade:"legendary",stars:0,type:"equipment",description:" ,      ."},{name:" ",slot:"stones",image:"images/equipments/Stone6.png",grade:"mythic",stars:0,type:"equipment",description:"      ."}],ws=[{name:"  I",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox1.png",grade:"normal"},{name:"  II",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox2.png",grade:"uncommon"},{name:"  III",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox3.png",grade:"rare"},{name:"  IV",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox4.png",grade:"epic"},{name:"  V",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox5.png",grade:"legendary"},{name:"  VI",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox6.png",grade:"mythic"},{name:"  I",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox1.png",grade:"normal"},{name:"  II",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox2.png",grade:"uncommon"},{name:"  III",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox3.png",grade:"rare"},{name:"  IV",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox4.png",grade:"epic"},{name:"  V",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox5.png",grade:"legendary"},{name:"  VI",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox6.png",grade:"mythic"},{name:" 1",description:"10 ~ 500  ",type:"consumable",slot:null,image:"/images/Box/GoldBox1.png",grade:"normal"},{name:" 2",description:"100 ~ 1,000  ",type:"consumable",slot:null,image:"/images/Box/GoldBox2.png",grade:"uncommon"},{name:" 3",description:"500 ~ 3,000  ",type:"consumable",slot:null,image:"/images/Box/GoldBox3.png",grade:"rare"},{name:" 4",description:"1,000 ~ 10,000  ",type:"consumable",slot:null,image:"/images/Box/GoldBox4.png",grade:"epic"},{name:" 1",description:"1 ~ 20  ",type:"consumable",slot:null,image:"/images/Box/DiaBox1.png",grade:"rare"},{name:" 2",description:"10 ~ 30  ",type:"consumable",slot:null,image:"/images/Box/DiaBox2.png",grade:"epic"},{name:" 3",description:"20 ~ 50  ",type:"consumable",slot:null,image:"/images/Box/DiaBox3.png",grade:"legendary"},{name:" 4",description:"30 ~ 100  ",type:"consumable",slot:null,image:"/images/Box/DiaBox4.png",grade:"mythic"}],tn={" ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials1.png",grade:"normal"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials2.png",grade:"uncommon"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials3.png",grade:"rare"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials4.png",grade:"epic"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials5.png",grade:"legendary"}},Ba={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},Pl={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},f0=[100,90,80,70,60,55,50,45,40,35],x0={normal:5,uncommon:4,rare:3,epic:2,legendary:1,mythic:.5},ha={normal:[[{amount:10,name:" "}],[{amount:15,name:" "}],[{amount:20,name:" "}],[{amount:25,name:" "}],[{amount:30,name:" "}],[{amount:30,name:" "}],[{amount:50,name:" "}],[{amount:5,name:" "}],[{amount:10,name:" "}],[{amount:5,name:" "}]],uncommon:[[{amount:20,name:" "}],[{amount:30,name:" "}],[{amount:40,name:" "}],[{amount:50,name:" "}],[{amount:60,name:" "}],[{amount:50,name:" "}],[{amount:10,name:" "}],[{amount:20,name:" "}],[{amount:10,name:" "}],[{amount:20,name:" "}]],rare:[[{amount:10,name:" "}],[{amount:15,name:" "}],[{amount:20,name:" "}],[{amount:25,name:" "}],[{amount:30,name:" "}],[{amount:100,name:" "}],[{amount:20,name:" "}],[{amount:40,name:" "}],[{amount:15,name:" "}],[{amount:30,name:" "}]],epic:[[{amount:20,name:" "}],[{amount:30,name:" "}],[{amount:40,name:" "}],[{amount:50,name:" "}],[{amount:60,name:" "}],[{amount:30,name:" "}],[{amount:50,name:" "}],[{amount:20,name:" "}],[{amount:45,name:" "}],[{amount:80,name:" "}]],legendary:[[{amount:10,name:" "}],[{amount:15,name:" "}],[{amount:20,name:" "}],[{amount:25,name:" "}],[{amount:30,name:" "}],[{amount:100,name:" "}],[{amount:20,name:" "}],[{amount:50,name:" "}],[{amount:100,name:" "}],[{amount:10,name:" "}]],mythic:[[{amount:20,name:" "}],[{amount:30,name:" "}],[{amount:40,name:" "}],[{amount:50,name:" "}],[{amount:60,name:" "}],[{amount:40,name:" "}],[{amount:80,name:" "}],[{amount:10,name:" "}],[{amount:50,name:" "}],[{amount:100,name:" "}]]},p0={normal:100,uncommon:200,rare:300,epic:500,legendary:1e3,mythic:2e3},g0=(e,n)=>{const s=p0[e];return Math.round(s*1.5**n)},h0={normal:50,uncommon:100,rare:200,epic:300,legendary:500,mythic:1e3},ms=30,Sc=10,y0=100,b0=50,v0=50,j0={[N.Concentration]:{name:"",description:"    .    ,      ."},[N.ThinkingSpeed]:{name:"",description:"   .            ."},[N.Judgment]:{name:"",description:"     .          ."},[N.Calculation]:{name:"",description:"      .       ."},[N.CombatPower]:{name:"",description:"     .           ."},[N.Stability]:{name:"",description:"    .         ."}},w0={fan:{isPercentage:!0,options:{normal:{stats:[N.ThinkingSpeed,N.Concentration],value:4},uncommon:{stats:[N.ThinkingSpeed,N.Concentration],value:6},rare:{stats:[N.ThinkingSpeed,N.Concentration],value:8},epic:{stats:[N.ThinkingSpeed,N.Concentration],value:10},legendary:{stats:[N.ThinkingSpeed,N.Concentration],value:12},mythic:{stats:[N.ThinkingSpeed,N.Concentration],value:15}}},board:{isPercentage:!0,options:{normal:{stats:[N.Stability,N.Calculation],value:4},uncommon:{stats:[N.Stability,N.Calculation],value:6},rare:{stats:[N.Stability,N.Calculation],value:8},epic:{stats:[N.Stability,N.Calculation],value:10},legendary:{stats:[N.Stability,N.Calculation],value:12},mythic:{stats:[N.Stability,N.Calculation],value:15}}},top:{isPercentage:!0,options:{normal:{stats:[N.CombatPower,N.Judgment],value:4},uncommon:{stats:[N.CombatPower,N.Judgment],value:6},rare:{stats:[N.CombatPower,N.Judgment],value:8},epic:{stats:[N.CombatPower,N.Judgment],value:10},legendary:{stats:[N.CombatPower,N.Judgment],value:12},mythic:{stats:[N.CombatPower,N.Judgment],value:15}}},bottom:{isPercentage:!1,options:{normal:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:8},uncommon:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:12},rare:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:16},epic:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:20},legendary:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:24},mythic:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:30}}},stones:{isPercentage:!1,options:{normal:{stats:[N.CombatPower,N.Calculation],value:8},uncommon:{stats:[N.CombatPower,N.Calculation],value:12},rare:{stats:[N.CombatPower,N.Calculation],value:16},epic:{stats:[N.CombatPower,N.Calculation],value:20},legendary:{stats:[N.CombatPower,N.Calculation],value:24},mythic:{stats:[N.CombatPower,N.Calculation],value:30}}},bowl:{isPercentage:!1,options:{normal:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:8},uncommon:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:12},rare:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:16},epic:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:20},legendary:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:24},mythic:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:30}}}},mx={[Fe.ActionPointMax]:{name:" ",description:"  .",isPercentage:!1,range:[2,5]},[Fe.ActionPointRegen]:{name:" ",description:"   .",isPercentage:!0,range:[1,3]},[Fe.StrategyXpBonus]:{name:"  ",description:"      .",isPercentage:!0,range:[1,3]},[Fe.PlayfulXpBonus]:{name:"  ",description:"      .",isPercentage:!0,range:[1,3]},[Fe.GoldBonus]:{name:" ",description:"      .",isPercentage:!0,range:[1,3]},[Fe.ItemDropRate]:{name:"  ",description:"      .",isPercentage:!0,range:[1,2]},[Fe.MaterialDropRate]:{name:"  ",description:"      .",isPercentage:!0,range:[1,3]}},fx={[ct.MannerActionCooldown]:{name:"    ",description:"    .",value:()=>30},[ct.StrategicGoldBonus]:{name:"  ",description:"    20% (10~50) 5",value:()=>1},[ct.PlayfulGoldBonus]:{name:"  ",description:"   60 20% (10~50) 5",value:()=>1},[ct.DiceGoOddBonus]:{name:" / ",description:"  /  1 ",value:()=>1},[ct.AlkkagiSlowBonus]:{name:"  ",description:"     1",value:()=>1},[ct.AlkkagiAimingBonus]:{name:"  ",description:"     1",value:()=>1}},N0={normal:{combatCount:[1,2],specialCount:[0,0],mythicCount:[0,0],combatTier:1},uncommon:{combatCount:[2,3],specialCount:[1,1],mythicCount:[0,0],combatTier:2},rare:{combatCount:[3,3],specialCount:[1,1],mythicCount:[0,0],combatTier:3},epic:{combatCount:[3,4],specialCount:[1,1],mythicCount:[0,0],combatTier:4},legendary:{combatCount:[4,4],specialCount:[1,2],mythicCount:[0,0],combatTier:5},mythic:{combatCount:[4,4],specialCount:[1,2],mythicCount:[1,1],combatTier:6}},k0={fan:{1:[{type:N.Concentration,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!0,range:[1,2]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!0,range:[2,3]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!0,range:[3,5]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!0,range:[4,6]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!0,range:[5,7]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!1,range:[10,15]},{type:N.Judgment,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!0,range:[8,10]},{type:N.Stability,isPercentage:!1,range:[10,15]},{type:N.Calculation,isPercentage:!1,range:[10,15]}]},board:{1:[{type:N.Concentration,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!0,range:[1,2]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!0,range:[2,3]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!0,range:[3,5]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!0,range:[4,6]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!0,range:[5,7]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!1,range:[10,15]},{type:N.Judgment,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!1,range:[10,15]},{type:N.Stability,isPercentage:!0,range:[8,10]},{type:N.Calculation,isPercentage:!1,range:[10,15]}]},top:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.Concentration,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!0,range:[1,2]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!0,range:[1,2]},{type:N.Calculation,isPercentage:!0,range:[1,2]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.Concentration,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!0,range:[2,3]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!0,range:[2,3]},{type:N.Calculation,isPercentage:!0,range:[2,3]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.Concentration,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!0,range:[3,5]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!0,range:[3,5]},{type:N.Calculation,isPercentage:!0,range:[3,5]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.Concentration,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!0,range:[4,6]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!0,range:[4,6]},{type:N.Calculation,isPercentage:!0,range:[4,6]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.Concentration,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!0,range:[5,7]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!0,range:[5,7]},{type:N.Calculation,isPercentage:!0,range:[5,7]}],6:[{type:N.Concentration,isPercentage:!1,range:[10,15]},{type:N.Concentration,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!1,range:[10,15]},{type:N.Judgment,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!0,range:[8,10]},{type:N.Stability,isPercentage:!1,range:[10,15]},{type:N.Stability,isPercentage:!0,range:[8,10]},{type:N.Calculation,isPercentage:!0,range:[8,10]}]},bottom:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!1,range:[8,12]},{type:N.CombatPower,isPercentage:!1,range:[8,12]},{type:N.Judgment,isPercentage:!1,range:[8,12]},{type:N.ThinkingSpeed,isPercentage:!1,range:[8,12]},{type:N.Stability,isPercentage:!1,range:[8,12]},{type:N.Calculation,isPercentage:!1,range:[8,12]}]},stones:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!1,range:[8,12]},{type:N.CombatPower,isPercentage:!1,range:[8,12]},{type:N.Judgment,isPercentage:!1,range:[8,12]},{type:N.ThinkingSpeed,isPercentage:!1,range:[8,12]},{type:N.Stability,isPercentage:!1,range:[8,12]}]},bowl:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!1,range:[8,12]},{type:N.CombatPower,isPercentage:!1,range:[8,12]},{type:N.Judgment,isPercentage:!1,range:[8,12]},{type:N.Stability,isPercentage:!1,range:[8,12]},{type:N.Calculation,isPercentage:!1,range:[8,12]}]}},xx=[20,40,60,80,100],px=[20,40,60,80,100],gx=[20,40,60,80,100],S0=[{items:[{itemId:" 1",quantity:1}]},{items:[{itemId:" 2",quantity:1}]},{items:[{itemId:"  I",quantity:1}]},{items:[{itemId:"  I",quantity:1}]},{items:[{itemId:" 1",quantity:1}]}],C0=[{items:[{itemId:" 2",quantity:1}]},{items:[{itemId:" 3",quantity:1}]},{items:[{itemId:"  II",quantity:1}]},{items:[{itemId:"  II",quantity:1}]},{items:[{itemId:" 2",quantity:1}]}],I0=[{items:[{itemId:" 3",quantity:1}]},{items:[{itemId:" 4",quantity:1}]},{items:[{itemId:"  III",quantity:1}]},{items:[{itemId:"  III",quantity:1}]},{items:[{itemId:" 3",quantity:1}]}],tl=[{tier:ht.Sprout,name:" ",scoreThreshold:0,icon:"/images/tire/auto1.png"},{tier:ht.Rookie,name:" ",scoreThreshold:1300,icon:"/images/tire/auto2.png"},{tier:ht.Rising,name:" ",scoreThreshold:1400,icon:"/images/tire/auto3.png"},{tier:ht.Ace,name:" ",scoreThreshold:1500,icon:"/images/tire/auto4.png"},{tier:ht.Diamond,name:" ",scoreThreshold:1600,icon:"/images/tire/auto5.png"},{tier:ht.Master,name:" ",scoreThreshold:1700,icon:"/images/tire/auto6.png"},{tier:ht.Grandmaster,name:" ",scoreThreshold:1800,icon:"/images/tire/auto7.png"},{tier:ht.Challenger,name:" ",scoreThreshold:2e3,icon:"/images/tire/auto8.png"}],P0={[ht.Sprout]:[{rankStart:1,rankEnd:1,diamonds:50,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:30,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:15,outcome:"promote"},{rankStart:4,rankEnd:16,diamonds:5,outcome:"maintain"}],[ht.Rookie]:[{rankStart:1,rankEnd:1,diamonds:65,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:40,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:25,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:15,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:5,outcome:"demote"}],[ht.Rising]:[{rankStart:1,rankEnd:1,diamonds:80,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:50,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:35,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:20,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:10,outcome:"demote"}],[ht.Ace]:[{rankStart:1,rankEnd:1,diamonds:95,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:60,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:45,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:25,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:15,outcome:"demote"}],[ht.Diamond]:[{rankStart:1,rankEnd:1,diamonds:110,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:70,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:55,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:30,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:20,outcome:"demote"}],[ht.Master]:[{rankStart:1,rankEnd:1,diamonds:125,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:80,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:65,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:35,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:25,outcome:"demote"}],[ht.Grandmaster]:[{rankStart:1,rankEnd:1,diamonds:150,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:100,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:80,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:50,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:35,outcome:"demote"}],[ht.Challenger]:[{rankStart:1,rankEnd:1,diamonds:200,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:125,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:100,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:75,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:50,outcome:"demote"}]},At=[{name:"",icon:"/images/tire/tire9.png",color:"text-cyan-400",threshold:(e,n,s)=>e>=3500&&n<=100},{name:"",icon:"/images/tire/tire8.png",color:"text-purple-400",threshold:(e,n,s)=>e>=3e3},{name:"",icon:"/images/tire/tire7.png",color:"text-blue-400",threshold:(e,n,s)=>e>=2400},{name:"",icon:"/images/tire/tire6.png",color:"text-teal-400",threshold:(e,n,s)=>e>=2e3},{name:"",icon:"/images/tire/tire5.png",color:"text-yellow-400",threshold:(e,n,s)=>e>=1700},{name:"",icon:"/images/tire/tire4.png",color:"text-gray-300",threshold:(e,n,s)=>e>=1500},{name:"",icon:"/images/tire/tire3.png",color:"text-orange-400",threshold:(e,n,s)=>e>=1400},{name:"",icon:"/images/tire/tire2.png",color:"text-green-400",threshold:(e,n,s)=>e>=1300},{name:"",icon:"/images/tire/tire1.png",color:"text-green-200",threshold:(e,n,s)=>e<1300||s<50}],E0={:{diamonds:75,items:[{itemId:"  I",quantity:1},{itemId:"  I",quantity:1},{itemId:" 1",quantity:1}]},:{diamonds:100,items:[{itemId:"  I",quantity:1},{itemId:"  II",quantity:1},{itemId:" 2",quantity:1}]},:{diamonds:125,items:[{itemId:"  II",quantity:1},{itemId:"  II",quantity:1},{itemId:" 2",quantity:1}]},:{diamonds:150,items:[{itemId:"  II",quantity:1},{itemId:"  III",quantity:1},{itemId:" 3",quantity:1}]},:{diamonds:200,items:[{itemId:"  III",quantity:1},{itemId:"  III",quantity:1},{itemId:" 3",quantity:1}]},:{diamonds:250,items:[{itemId:"  IV",quantity:1},{itemId:"  IV",quantity:1},{itemId:" 4",quantity:1}]},:{diamonds:300,items:[{itemId:"  V",quantity:1},{itemId:"  V",quantity:1},{itemId:" 4",quantity:1}]},:{diamonds:400,items:[{itemId:"  V",quantity:1},{itemId:"  VI",quantity:1},{itemId:" 4",quantity:1}]},:{diamonds:500,items:[{itemId:"  VI",quantity:1},{itemId:"  VI",quantity:1},{itemId:" 4",quantity:1}]}},au=5,M0=3,T0=5*60*1e3,_0=[10,20,30,50,80,120,180,250,350,500],iu=10,A0=30,Cc=20,El=["uncommon","rare","epic","legendary","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic"],Ql=[{normal:50,uncommon:30},{normal:50,uncommon:30,rare:20},{normal:50,uncommon:30,rare:20,epic:10},{normal:50,uncommon:30,rare:20,epic:10,legendary:1},{normal:50,uncommon:30,rare:20,epic:10,legendary:1.5,mythic:25},{normal:65,uncommon:40,rare:25,epic:12.5,legendary:2,mythic:30},{normal:80,uncommon:50,rare:30,epic:15,legendary:2.5,mythic:35},{normal:95,uncommon:60,rare:35,epic:17.5,legendary:3,mythic:40},{normal:100,uncommon:70,rare:40,epic:20,legendary:3.5,mythic:45},{normal:100,uncommon:80,rare:45,epic:22.5,legendary:4,mythic:50},{normal:100,uncommon:90,rare:50,epic:25,legendary:4.5,mythic:55},{normal:100,uncommon:100,rare:55,epic:27.5,legendary:5,mythic:60},{normal:100,uncommon:100,rare:60,epic:30,legendary:5.5,mythic:65},{normal:100,uncommon:100,rare:65,epic:32.5,legendary:6,mythic:70},{normal:100,uncommon:100,rare:70,epic:35,legendary:6.5,mythic:75},{normal:100,uncommon:100,rare:75,epic:37.5,legendary:7,mythic:80},{normal:100,uncommon:100,rare:80,epic:40,legendary:7.5,mythic:85},{normal:100,uncommon:100,rare:85,epic:42.5,legendary:8,mythic:90},{normal:100,uncommon:100,rare:90,epic:45,legendary:8.5,mythic:95},{normal:100,uncommon:100,rare:100,epic:50,legendary:10,mythic:100}],ya=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40],ou=e=>e<1?0:e>=Cc?1/0:e*1e4,Ml={neighborhood:{id:"neighborhood",name:"",description:"6   .    !",format:"round-robin",players:6,image:"/images/championship/Champ1.png"},national:{id:"national",name:"",description:"  8   .",format:"tournament",players:8,image:"/images/championship/Champ2.png"},world:{id:"world",name:"",description:"    16 .",format:"tournament",players:16,image:"/images/championship/Champ3.png"}},R0={neighborhood:{rewardType:"rank",rewards:{1:{items:[{itemId:" 4",quantity:1},{itemId:" 1",quantity:1}]},2:{items:[{itemId:" 3",quantity:1}]},3:{items:[{itemId:" 2",quantity:1}]},4:{items:[{itemId:" 1",quantity:1}]}}},national:{rewardType:"rank",rewards:{1:{items:[{itemId:" 4",quantity:1},{itemId:" 2",quantity:1}]},2:{items:[{itemId:" 3",quantity:1},{itemId:" 1",quantity:1}]},3:{items:[{itemId:" 2",quantity:1},{itemId:" 1",quantity:1}]},4:{items:[{itemId:" 1",quantity:1},{itemId:" 1",quantity:1}]},5:{items:[{itemId:" 1",quantity:1}]}}},world:{rewardType:"rank",rewards:{1:{items:[{itemId:" 4",quantity:1},{itemId:" 3",quantity:1}]},2:{items:[{itemId:" 3",quantity:1},{itemId:" 2",quantity:1}]},3:{items:[{itemId:" 3",quantity:1},{itemId:" 1",quantity:1}]},4:{items:[{itemId:" 2",quantity:1},{itemId:" 1",quantity:1}]},5:{items:[{itemId:" 1",quantity:1},{itemId:" 1",quantity:1}]},9:{items:[{itemId:" 1",quantity:1}]}}}},Ee=[{id:"profile_1",name:"  1",url:"/images/profiles/profile1.png",requiredLevel:1,type:"any"},{id:"profile_2",name:"  2",url:"/images/profiles/profile2.png",requiredLevel:1,type:"any"},{id:"profile_3",name:"  3",url:"/images/profiles/profile3.png",requiredLevel:1,type:"any"},{id:"profile_4",name:"  4",url:"/images/profiles/profile4.png",requiredLevel:1,type:"any"},{id:"profile_5",name:"  5",url:"/images/profiles/profile5.png",requiredLevel:1,type:"any"},{id:"profile_6",name:"  6",url:"/images/profiles/profile6.png",requiredLevel:1,type:"any"},{id:"profile_7",name:"  7",url:"/images/profiles/profile7.png",requiredLevel:1,type:"any"},{id:"profile_8",name:"  8",url:"/images/profiles/profile8.png",requiredLevel:1,type:"any"},{id:"profile_9",name:"  9",url:"/images/profiles/profile9.png",requiredLevel:1,type:"any"},{id:"profile_10",name:"  10",url:"/images/profiles/profile10.png",requiredLevel:1,type:"any"},{id:"profile_11",name:"  11",url:"/images/profiles/profile11.png",requiredLevel:1,type:"any"},{id:"profile_12",name:"  12",url:"/images/profiles/profile12.png",requiredLevel:1,type:"any"},{id:"profile_13",name:"  13",url:"/images/profiles/profile13.png",requiredLevel:1,type:"any"},{id:"profile_14",name:"  14",url:"/images/profiles/profile14.png",requiredLevel:1,type:"any"},{id:"profile_15",name:"  15",url:"/images/profiles/profile15.png",requiredLevel:1,type:"any"},{id:"profile_16",name:"  16",url:"/images/profiles/profile16.png",requiredLevel:1,type:"any"},{id:"profile_17",name:"  17",url:"/images/profiles/profile17.png",requiredLevel:1,type:"any"},{id:"profile_18",name:"  18",url:"/images/profiles/profile18.png",requiredLevel:1,type:"any"},{id:"profile_19",name:"  19",url:"/images/profiles/profile19.png",requiredLevel:1,type:"any"},{id:"profile_20",name:"  20",url:"/images/profiles/profile20.png",requiredLevel:1,type:"any"},{id:"profile_21",name:"  21",url:"/images/profiles/profile21.png",requiredLevel:1,type:"any"},{id:"profile_22",name:"  22",url:"/images/profiles/profile22.png",requiredLevel:1,type:"any"},{id:"profile_23",name:"  23",url:"/images/profiles/profile23.png",requiredLevel:1,type:"any"},{id:"profile_24",name:"  24",url:"/images/profiles/profile24.png",requiredLevel:1,type:"any"},{id:"profile_25",name:"  25",url:"/images/profiles/profile25.png",requiredLevel:1,type:"any"},{id:"profile_26",name:"  26",url:"/images/profiles/profile26.png",requiredLevel:1,type:"any"},{id:"profile_27",name:"  27",url:"/images/profiles/profile27.png",requiredLevel:1,type:"any"},{id:"profile_28",name:"  28",url:"/images/profiles/profile28.png",requiredLevel:1,type:"any"},{id:"profile_29",name:"  29",url:"/images/profiles/profile29.png",requiredLevel:1,type:"any"},{id:"profile_30",name:"  30",url:"/images/profiles/profile30.png",requiredLevel:1,type:"any"},{id:"profile_31",name:"  31",url:"/images/profiles/profile31.png",requiredLevel:1,type:"any"},{id:"profile_32",name:"  32",url:"/images/profiles/profile32.png",requiredLevel:1,type:"any"},{id:"profile_33",name:"  33",url:"/images/profiles/profile33.png",requiredLevel:1,type:"any"},{id:"profile_34",name:"  34",url:"/images/profiles/profile34.png",requiredLevel:1,type:"any"},{id:"profile_35",name:"  35",url:"/images/profiles/profile35.png",requiredLevel:1,type:"any"}],Re=[{id:"default",name:" ",url:"#FFFFFF",description:"   ."},{id:"simple_black",name:" ",url:"#000000",description:"    ."},{id:"red",name:"",url:"#ef4444",description:"/   3   .",requiredLevelSum:3},{id:"orange",name:"",url:"#f97316",description:"/   4   .",requiredLevelSum:4},{id:"yellow",name:"",url:"#eab308",description:"/   5   .",requiredLevelSum:5},{id:"green",name:"",url:"#22c55e",description:"/   6   .",requiredLevelSum:6},{id:"blue",name:"",url:"#3b82f6",description:"/   7   .",requiredLevelSum:7},{id:"indigo",name:"",url:"#6366f1",description:"/   8   .",requiredLevelSum:8},{id:"purple",name:"",url:"#8b5cf6",description:"/   9   .",requiredLevelSum:9},{id:"rainbow",name:"",url:"conic-gradient(red, yellow, lime, aqua, blue, magenta, red)",description:"/   10   .",requiredLevelSum:10},{id:"bronze_reward",name:" ",url:"/images/tire/Round1.png",description:"     .",unlockTier:""},{id:"silver_reward",name:" ",url:"/images/tire/Round2.png",description:"     .",unlockTier:""},{id:"gold_reward",name:" ",url:"/images/tire/Round3.png",description:"     .",unlockTier:""},{id:"platinum_reward",name:" ",url:"/images/tire/Round4.png",description:"     .",unlockTier:""},{id:"diamond_reward",name:" ",url:"/images/tire/Round5.png",description:"     .",unlockTier:""},{id:"master_reward",name:" ",url:"/images/tire/Round6.png",description:"     .",unlockTier:""},{id:"challenger_reward",name:" ",url:"/images/tire/Round7.png",description:"     .",unlockTier:""},{id:"tier_ring_1",name:"",url:"/images/tire/Ring1.png",description:"     ."},{id:"tier_ring_2",name:"",url:"/images/tire/Ring2.png",description:"     ."},{id:"tier_ring_3",name:"",url:"/images/tire/Ring3.png",description:"     ."},{id:"tier_ring_4",name:"",url:"/images/tire/Ring4.png",description:"     ."},{id:"tier_ring_5",name:"1",url:"/images/tire/Ring5.png",description:"     ."},{id:"tier_ring_6",name:"2",url:"/images/tire/Ring6.png",description:"     ."},{id:"tier_ring_7",name:"",url:"/images/tire/Ring7.png",description:"     ."},{id:"tier_ring_8",name:"VIP",url:"/images/tire/Ring8.png",description:"     ."}],cu=[{id:"tier_ring_1",name:"",url:"/images/tire/Ring1.png",description:"     .",price:{gold:1e4}},{id:"tier_ring_2",name:"",url:"/images/tire/Ring2.png",description:"     .",price:{gold:15e3}},{id:"tier_ring_3",name:"",url:"/images/tire/Ring3.png",description:"     .",price:{gold:3e4}},{id:"tier_ring_4",name:"",url:"/images/tire/Ring4.png",description:"     .",price:{diamonds:200}},{id:"tier_ring_5",name:"1",url:"/images/tire/Ring5.png",description:"     .",price:{diamonds:1e3}},{id:"tier_ring_6",name:"2",url:"/images/tire/Ring6.png",description:"     .",price:{diamonds:1e3}},{id:"tier_ring_7",name:"",url:"/images/tire/Ring7.png",description:"     .",price:{diamonds:1e3}},{id:"tier_ring_8",name:"VIP",url:"/images/tire/Ring8.png",description:"     .",price:{diamonds:2e3}}];T.Standard+"",T.Capture+"",T.Speed+"",T.Base+"",T.Hidden+"",T.Missile+"",T.Mix+"",T.Dice+"",T.Omok+"",T.Ttamok+"",T.Thief+"",T.Alkkagi+"",T.Curling+"";const hx=[",  ."," !",". ."," !",",   ."," .","GG!  .","?"],yx=["","","","","","","","",""],Jl=[{id:"-1",name:" 1",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:0,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:10},repeatClear:{gold:10,exp:10}}},{id:"-2",name:" 2",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:0,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:11},repeatClear:{gold:10,exp:10}}},{id:"-3",name:" 3",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:1,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:12},repeatClear:{gold:10,exp:10}}},{id:"-4",name:" 4",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:2,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:13},repeatClear:{gold:10,exp:10}}},{id:"-5",name:" 5",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:2,white:3,blackPattern:2,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:14,items:[{itemId:" 1",quantity:1}]},repeatClear:{gold:10,exp:10}}},{id:"-6",name:" 6",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:5,blackPattern:2,whitePattern:0,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:15},repeatClear:{gold:10,exp:10}}},{id:"-7",name:" 7",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:4,blackPattern:2,whitePattern:2,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:16},repeatClear:{gold:10,exp:10}}},{id:"-8",name:" 8",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:5,blackPattern:3,whitePattern:2,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:17},repeatClear:{gold:10,exp:10}}},{id:"-9",name:" 9",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:4,blackPattern:3,whitePattern:3,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:100,exp:18},repeatClear:{gold:10,exp:10}}},{id:"-10",name:" 10",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:2,whitePattern:3,centerBlackStoneChance:50},timeControl:{type:"fischer",mainTime:5,increment:10},rewards:{firstClear:{gold:150,exp:20,items:[{itemId:"  I",quantity:1}]},repeatClear:{gold:10,exp:15}}},{id:"-11",name:" 11",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:5,blackPattern:2,whitePattern:2,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:21},repeatClear:{gold:10,exp:10}}},{id:"-12",name:" 12",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:2,whitePattern:3,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:22},repeatClear:{gold:10,exp:10}}},{id:"-13",name:" 13",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:3,whitePattern:2,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:23},repeatClear:{gold:10,exp:10}}},{id:"-14",name:" 14",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:3,whitePattern:4,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:24},repeatClear:{gold:10,exp:10}}},{id:"-15",name:" 15",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:6,blackPattern:2,whitePattern:3,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:25,items:[{itemId:"  I",quantity:1}]},repeatClear:{gold:10,exp:10}}},{id:"-16",name:" 16",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:4,blackPattern:3,whitePattern:3,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:26},repeatClear:{gold:10,exp:10}}},{id:"-17",name:" 17",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:4,blackPattern:4,whitePattern:4,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:27},repeatClear:{gold:10,exp:10}}},{id:"-18",name:" 18",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:5,blackPattern:3,whitePattern:4,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:28},repeatClear:{gold:10,exp:10}}},{id:"-19",name:" 19",level:Ae.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:4,blackPattern:2,whitePattern:2,centerBlackStoneChance:80},timeControl:{type:"fischer",mainTime:1,increment:8},rewards:{firstClear:{gold:150,exp:30},repeatClear:{gold:10,exp:10}}},{id:"-20",name:" 20",level:Ae.,actionPointCost:3,boardSize:7,targetScore:{black:9,white:8},katagoLevel:2,placements:{black:5,white:5,blackPattern:2,whitePattern:1,centerBlackStoneChance:50},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:50,items:[{itemId:" 1",quantity:1}],bonus:"10"},repeatClear:{gold:30,exp:20}}},{id:"-1",name:" 1",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:5,blackPattern:2,whitePattern:4,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:30},repeatClear:{gold:30,exp:20}}},{id:"-2",name:" 2",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:5,blackPattern:3,whitePattern:4,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:32},repeatClear:{gold:30,exp:20}}},{id:"-3",name:" 3",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:5,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:34},repeatClear:{gold:30,exp:20}}},{id:"-4",name:" 4",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:6,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:36},repeatClear:{gold:30,exp:20}}},{id:"-5",name:" 5",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:6,blackPattern:4,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:38,items:[{itemId:" 2",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-6",name:" 6",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:3,white:6,blackPattern:4,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:40},repeatClear:{gold:30,exp:20}}},{id:"-7",name:" 7",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:6,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:42},repeatClear:{gold:30,exp:20}}},{id:"-8",name:" 8",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:6,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:44,items:[{itemId:"  I",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-9",name:" 9",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:5,blackPattern:2,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"fischer",mainTime:1,increment:8},rewards:{firstClear:{gold:200,exp:46},repeatClear:{gold:30,exp:20}}},{id:"-10",name:" 10",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:6,blackPattern:2,whitePattern:4,centerBlackStoneChance:50},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:50,items:[{itemId:"  II",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-11",name:" 11",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:6,blackPattern:1,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:52},repeatClear:{gold:30,exp:20}}},{id:"-12",name:" 12",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:6,blackPattern:2,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:54},repeatClear:{gold:30,exp:20}}},{id:"-13",name:" 13",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:7,blackPattern:3,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:56},repeatClear:{gold:30,exp:20}}},{id:"-14",name:" 14",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:7,blackPattern:3,whitePattern:4,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:58},repeatClear:{gold:30,exp:20}}},{id:"-15",name:" 15",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:3,white:6,blackPattern:4,whitePattern:1,centerBlackStoneChance:70},timeControl:{type:"fischer",mainTime:1,increment:7},rewards:{firstClear:{gold:250,exp:60,items:[{itemId:"  II",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-16",name:" 16",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:4,white:8,blackPattern:5,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:62},repeatClear:{gold:30,exp:20}}},{id:"-17",name:" 17",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:6,white:6,blackPattern:1,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:64},repeatClear:{gold:30,exp:20}}},{id:"-18",name:" 18",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:4,white:8,blackPattern:5,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:66},repeatClear:{gold:30,exp:20}}},{id:"-19",name:" 19",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:6,white:6,blackPattern:5,whitePattern:3,centerBlackStoneChance:50},timeControl:{type:"fischer",mainTime:1,increment:7},rewards:{firstClear:{gold:250,exp:100},repeatClear:{gold:30,exp:20}}},{id:"-20",name:" 20",level:Ae.,actionPointCost:3,boardSize:9,targetScore:{black:15,white:12},katagoLevel:7,placements:{black:5,white:6,blackPattern:5,whitePattern:3,centerBlackStoneChance:50},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:300,exp:120,items:[{itemId:" 2",quantity:1}],bonus:"10"},repeatClear:{gold:50,exp:30}}}],bx=e=>{const n=e.mannerScore??200,s={maxActionPoints:30,actionPointRegenInterval:T0,goldBonusPercent:0,itemDropRateBonus:0,mannerActionButtonBonus:0,rewardMultiplier:1,enhancementSuccessRateBonus:0};return n>=400&&(s.maxActionPoints+=10),n>=800&&(s.goldBonusPercent+=10),n>=1200&&(s.itemDropRateBonus+=10),n>=1600&&(s.enhancementSuccessRateBonus+=10),n<=199&&(s.mannerActionButtonBonus+=1),n<=99&&(s.rewardMultiplier*=.5),n<=49&&(s.actionPointRegenInterval=20*60*1e3),n<=0&&(s.maxActionPoints=Math.floor(s.maxActionPoints*.1)),s},vx=e=>{const s={...bx(e),coreStatBonuses:{},specialStatBonuses:{},mythicStatBonuses:{}};for(const a of Object.values(N))s.coreStatBonuses[a]={flat:0,percent:0};for(const a of Object.values(Fe))s.specialStatBonuses[a]={flat:0,percent:0};for(const a of Object.values(ct))s.mythicStatBonuses[a]={flat:0,percent:0};const l=e.inventory.filter(a=>a.isEquipped&&a.type==="equipment"&&a.options);for(const a of l){const i=[a.options.main,...a.options.combatSubs,...a.options.specialSubs,...a.options.mythicSubs];for(const o of i){if(!o)continue;const{type:c,value:d,isPercentage:u}=o;Object.values(N).includes(c)?u?s.coreStatBonuses[c].percent+=d:s.coreStatBonuses[c].flat+=d:Object.values(Fe).includes(c)?u?s.specialStatBonuses[c].percent+=d:s.specialStatBonuses[c].flat+=d:Object.values(ct).includes(c)&&(s.mythicStatBonuses[c].flat+=d)}}s.maxActionPoints+=s.specialStatBonuses[Fe.ActionPointMax].flat;const r=s.specialStatBonuses[Fe.ActionPointRegen].percent;return r>0&&(s.actionPointRegenInterval=Math.floor(s.actionPointRegenInterval/(1+r/100))),s},bn={graphics:{theme:"black",panelColor:void 0,textColor:void 0},sound:{masterVolume:.5,masterMuted:!1,categoryMuted:{stone:!1,notification:!1,item:!1,countdown:!1,turn:!1}},features:{mobileConfirm:!1,stonePreview:!0,lastMoveMarker:!0,questNotifications:!0,chatNotifications:!0}},du="appSettings_v2";class L0{constructor(){_n(this,"audioContext",null);_n(this,"isInitializing",!1);_n(this,"scanBgmSourceNode",null);_n(this,"timerWarningSourceNode",null);_n(this,"audioBuffers",new Map);_n(this,"soundsPath","/sound/");_n(this,"settings",bn.sound)}isReady(){return!!this.audioContext&&this.audioContext.state==="running"}async initialize(){if(!(this.isReady()||this.isInitializing)){this.isInitializing=!0;try{this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.audioContext.state==="suspended"&&await this.audioContext.resume()}catch(n){console.error("Audio context initialization failed:",n)}finally{this.isInitializing=!1}}}updateSettings(n){this.settings=n}async loadSound(n){if(this.audioContext||await this.initialize(),!this.audioContext)return null;if(this.audioBuffers.has(n))return this.audioBuffers.get(n);try{const s=await fetch(n);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const l=await s.arrayBuffer(),r=await this.audioContext.decodeAudioData(l);return this.audioBuffers.set(n,r),r}catch(s){return console.error(`Failed to load sound: ${n}`,s),null}}playSound(n,s=1,l=!1){if(!this.isReady()||!this.audioContext)return null;const r=this.audioContext.createBufferSource();r.buffer=n,r.loop=l;const a=this.audioContext.createGain();return a.gain.setValueAtTime(s,this.audioContext.currentTime),r.connect(a),a.connect(this.audioContext.destination),r.start(0),r}async play(n,s,l,r=!1){if(this.settings.masterMuted||this.settings.categoryMuted[s])return null;try{const a=await this.loadSound(`${this.soundsPath}${n}.mp3`);if(a)return this.playSound(a,l*this.settings.masterVolume,r)}catch(a){console.error(`Could not play sound ${n}`,a)}return null}placeStone(){this.play("move","stone",.7)}rollDice(n){this.play("dice","item",.6),n>1&&setTimeout(()=>this.play("dice","item",.6),500)}enhancementFail(){this.play("failure","notification",.7)}revealHiddenStone(){this.play("hidden","item",.8)}async playScanBgm(){this.stopScanBgm(),this.scanBgmSourceNode=await this.play("scanbgm","item",.4,!0)}stopScanBgm(){if(this.scanBgmSourceNode){try{this.scanBgmSourceNode.stop()}catch{}this.scanBgmSourceNode=null}}scanSuccess(){this.play("find","item",.7)}stoneCollision(){this.play("hit","stone",.4)}launchMissile(){this.play("rocket","item",.7)}gameLose(){this.play("lose","notification",.6)}gameWin(){this.play("win","notification",.6)}levelUp(){this.play("levelup","notification",.7)}disassemblyJackpot(){this.play("jackpot2","notification",.8)}gachaEpicOrHigher(){this.play("jackpot","notification",.7)}gameStart(){this.play("gamestart","notification",.6)}myTurn(){this.play("myturn","turn",.7)}scanFail(){this.play("scanfail","item",.6)}async timerWarning(){this.stopTimerWarning(),this.timerWarningSourceNode=await this.play("timer10","countdown",.7)}stopTimerWarning(){if(this.timerWarningSourceNode){try{this.timerWarningSourceNode.stop()}catch{}this.timerWarningSourceNode=null}}timeoutFoul(){this.play("bip","notification",.8)}enhancementSuccess(){this.play("success","notification",.7)}combinationGreatSuccess(){this.play("jackpot","notification",.7)}combinationSuccess(){this.play("success","notification",.7)}stoneFallOff(){this.play("fall","stone",.5)}claimReward(){this.play("reward","notification",.7)}}const Pe=new L0;function uu(e){const n=e.replace(/^#\/?/,""),[s,...l]=n.split("/");switch(s){case"lobby":return{view:"lobby",params:{type:l[0]||"strategic"}};case"waiting":return{view:"waiting",params:{mode:l[0]?decodeURIComponent(l[0]):null}};case"game":return{view:"game",params:{id:l[0]}};case"tournament":return{view:"tournament",params:{}};case"singleplayer":return{view:"singleplayer",params:{}};case"admin":return{view:"admin",params:{}};case"register":return{view:"register",params:{}};case"profile":return{view:"profile",params:{}};default:return{view:"login",params:{}}}}const $0=()=>{const[e,n]=f.useState(()=>{try{const V=sessionStorage.getItem("currentUser");if(V)return JSON.parse(V)}catch(V){console.error("Failed to parse user from sessionStorage",V)}return null}),[s,l]=f.useState(()=>uu(window.location.hash)),r=f.useRef(s),[a,i]=f.useState(null),o=f.useRef(!1),[c,d]=f.useState(()=>{try{const V=localStorage.getItem(du);if(V){let te=JSON.parse(V);return typeof te.theme=="string"&&(te={...bn,graphics:{theme:te.theme,panelColor:void 0,textColor:void 0},sound:te.sound||bn.sound,features:te.features||bn.features}),{...bn,...te,graphics:{...bn.graphics,...te.graphics||{}},sound:{...bn.sound,...te.sound||{}},features:{...bn.features,...te.features||{}}}}}catch(V){console.error("Error reading settings from localStorage",V)}return bn}),[u,p]=f.useState({}),[m,h]=f.useState([]),[y,b]=f.useState({}),[j,g]=f.useState({}),[x,v]=f.useState({}),[w,k]=f.useState({}),[P,S]=f.useState([]),[E,_]=f.useState({}),[C,I]=f.useState([]),[R,A]=f.useState(null),[O,L]=f.useState(3),[Q,D]=f.useState(!1),[$,q]=f.useState(!1),[z,W]=f.useState(!1),[H,ne]=f.useState(!1),[re,ce]=f.useState(!1),[ve,F]=f.useState(null),[X,ee]=f.useState(null),[xe,J]=f.useState(null),[G,K]=f.useState(null),[Z,fe]=f.useState(!1),[we,M]=f.useState(null),[Y,ie]=f.useState(null),[oe,ue]=f.useState(!1),[le,ge]=f.useState(!1),[je,me]=f.useState(!1),[ke,Ue]=f.useState(null),[Le,He]=f.useState(null),[ae,Me]=f.useState(null),[Te,We]=f.useState(null),[it,Gt]=f.useState(null),[vt,nn]=f.useState(null),[Ct,jt]=f.useState(!1),pe=f.useRef(null),[de,_e]=f.useState(!1),[Ne,Ie]=f.useState(null),[ft,ot]=f.useState(!1),[Wt,Ht]=f.useState(!1),[un,mn]=f.useState(!1),[fn,ls]=f.useState(null),[rr,Ns]=f.useState("enhance"),[za,ar]=f.useState(null),[Ua,ir]=f.useState(!1),[Fa,Je]=f.useState(!1);f.useEffect(()=>{Je(!!Le)},[Le]),f.useEffect(()=>{try{localStorage.setItem(du,JSON.stringify(c))}catch(te){console.error("Error saving settings to localStorage",te)}const V=document.documentElement;c.graphics.panelColor?V.style.setProperty("--custom-panel-bg",c.graphics.panelColor):V.style.removeProperty("--custom-panel-bg"),c.graphics.textColor?V.style.setProperty("--custom-text-color",c.graphics.textColor):V.style.removeProperty("--custom-text-color")},[c]),f.useEffect(()=>{document.documentElement.setAttribute("data-theme",c.graphics.theme)},[c.graphics.theme]),f.useEffect(()=>{Pe.updateSettings(c.sound)},[c.sound]);const Ga=f.useCallback(V=>{d(te=>({...te,graphics:{...te.graphics,theme:V,panelColor:void 0,textColor:void 0}}))},[]),rs=f.useCallback(V=>{d(te=>({...te,graphics:{...te.graphics,panelColor:V}}))},[]),zx=f.useCallback(V=>{d(te=>({...te,graphics:{...te.graphics,textColor:V}}))},[]),Ux=f.useCallback(()=>{d(V=>({...V,graphics:{...V.graphics,panelColor:void 0,textColor:void 0}}))},[]),Fx=f.useCallback((V,te)=>{d(he=>({...he,sound:{...he.sound,[V]:te}}))},[]),Gx=f.useCallback((V,te)=>{d(he=>({...he,features:{...he.features,[V]:te}}))},[]),rl=f.useMemo(()=>!u||typeof u!="object"?[]:Object.values(u),[u]),Ve=f.useMemo(()=>{if(!e)return null;const V=m.find(te=>te.id===e.id);return{...e,...V||{status:"online"}}},[e,m]),as=f.useMemo(()=>{if(!Ve)return null;const V=Ve.gameId||Ve.spectatingGameId;if(V&&(Ve.status==="in-game"||Ve.status==="spectating"||Ve.status==="negotiating")){const te=y[V];if(te)return te}return null},[Ve,y]),Wx=f.useMemo(()=>{if(!Ve||!j||typeof j!="object"||Array.isArray(j))return null;try{return Object.values(j).find(te=>te&&te.challenger&&te.opponent&&(te.challenger.id===Ve.id&&(te.status==="pending"||te.status==="draft")||te.opponent.id===Ve.id&&te.status==="pending"))||null}catch(V){return console.error("[activeNegotiation] Error:",V),null}},[Ve,j]),Hx=f.useMemo(()=>(e==null?void 0:e.mail.filter(V=>!V.isRead).length)||0,[e==null?void 0:e.mail]),Vx=f.useMemo(()=>{if(!(e!=null&&e.quests))return!1;const{daily:V,weekly:te,monthly:he}=e.quests,Se=$e=>$e?$e.quests.some(qe=>qe.progress>=qe.target&&!qe.isClaimed):!1,Ke=($e,qe)=>!$e||!qe?!1:$e.claimedMilestones.some((Vt,Kt)=>!Vt&&$e.activityProgress>=qe[Kt]);return Se(V)||Se(te)||Se(he)||Ke(V,xx)||Ke(te,px)||Ke(he,gx)},[e==null?void 0:e.quests]),Mc=V=>{let te=V;V.includes("Invalid move: ko")?te=" .         .":V.includes("action point")&&(te="   ."),i(te),setTimeout(()=>i(null),5e3)};f.useEffect(()=>{e?sessionStorage.setItem("currentUser",JSON.stringify(e)):sessionStorage.removeItem("currentUser")},[e]);const ks=f.useCallback(async V=>{V.type==="CLEAR_TOURNAMENT_SESSION"&&n(te=>te?{...te,lastNeighborhoodTournament:null,lastNationalTournament:null,lastWorldTournament:null}:null),V.type==="TOGGLE_EQUIP_ITEM"?n(te=>{if(!te)return null;const{itemId:he}=V.payload,Se=te.inventory.find(Kt=>Kt.id===he);if(!Se||Se.type!=="equipment"||!Se.slot)return te;const Ke=Se.slot,$e=!Se.isEquipped,qe={...te.equipment};$e?qe[Ke]=Se.id:delete qe[Ke];const Vt=te.inventory.map(Kt=>Kt.id===he?{...Kt,isEquipped:$e}:$e&&Kt.slot===Ke&&Kt.id!==he?{...Kt,isEquipped:!1}:Kt);return{...te,inventory:Vt,equipment:qe}}):V.type==="SAVE_PRESET"&&n(te=>{if(!te)return null;const{preset:he,index:Se}=V.payload,Ke=[...te.equipmentPresets];return Ke[Se]=he,{...te,equipmentPresets:Ke}});try{Pe.initialize();const te=await fetch("/api/action",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...V,userId:e==null?void 0:e.id})});if(te.ok){const he=await te.json();if(he.updatedUser&&n(he.updatedUser),he.obtainedItemsBulk&&F(he.obtainedItemsBulk),he.rewardSummary&&K(he.rewardSummary),he.claimAllSummary&&(M(he.claimAllSummary),fe(!0)),he.disassemblyResult&&(ee(he.disassemblyResult),he.disassemblyResult.jackpot&&Pe.disassemblyJackpot()),he.craftResult&&J(he.craftResult),he.combinationResult&&(ar(he.combinationResult),he.combinationResult.isGreatSuccess?Pe.combinationGreatSuccess():Pe.combinationSuccess()),he.enhancementOutcome){const{message:Se,success:Ke,itemBefore:$e,itemAfter:qe}=he.enhancementOutcome;Ue({message:Se,success:Ke}),He({message:Se,success:Ke,itemBefore:$e,itemAfter:qe}),Ke?Pe.enhancementSuccess():Pe.enhancementFail()}he.enhancementAnimationTarget&&Me(he.enhancementAnimationTarget),he.redirectToTournament&&(window.location.hash=`#/tournament/${he.redirectToTournament}`)}else{const he=await te.json();Mc(he.message||"An unknown error occurred."),(V.type==="TOGGLE_EQUIP_ITEM"||V.type==="USE_ITEM")&&n(Se=>Se?{...Se}:null)}}catch(te){Mc(te.message)}},[e==null?void 0:e.id]),Wa=f.useCallback(()=>{e&&(o.current=!0,ks({type:"LOGOUT"}),n(null),window.location.hash="")},[e,ks]);f.useEffect(()=>{if(!e){p({}),h([]),b({}),g({});return}let V=null,te=null,he=!1,Se=!0;const Ke=()=>{if(!(!Se||!e))try{V&&V.readyState!==WebSocket.CLOSED&&V.close(),V=new WebSocket(`ws://${window.location.hostname}:4000`),V.onopen=()=>{console.log("[WebSocket] Connected"),he=!1},V.onmessage=$e=>{try{const qe=JSON.parse($e.data);switch(qe.type){case"INITIAL_STATE":console.log("INITIAL_STATE payload:",qe.payload);const{users:Vt,onlineUsers:Kt,liveGames:up,negotiations:mp,waitingRoomChats:fp,gameChats:xp,adminLogs:pp,announcements:gp,globalOverrideAnnouncement:hp,gameModeAvailability:yp,announcementInterval:bp}=qe.payload;console.log("[WebSocket] Received users:",Vt?Object.keys(Vt).length:0,"users"),Vt&&typeof Vt=="object"&&!Array.isArray(Vt)?(p(Vt),console.log("[WebSocket] usersMap updated with",Object.keys(Vt).length,"users")):(console.warn("[WebSocket] Invalid users data:",Vt),p({})),h(Kt||[]),b(up||{}),g(mp||{}),v(fp||{}),k(xp||{}),S(pp||[]),I(gp||[]),A(hp||null),_(yp||{}),L(bp||3);break;case"USER_STATUS_UPDATE":p(Va=>{const Tc={...Va},vp=Object.entries(qe.payload).map(([or,jp])=>{let al=Va[or];if(!al){if(al=Object.values(Va).find(Ka=>(Ka==null?void 0:Ka.id)===or),!al){console.warn(`[WebSocket] User ${or} not found in usersMap or allUsers`);return}Tc[or]=al}return{...al,...jp}}).filter(Boolean);return h(vp),Tc});break}}catch(qe){console.error("[WebSocket] Error parsing message:",qe)}},V.onerror=$e=>{console.error("[WebSocket] Error:",$e)},V.onclose=$e=>{console.log("[WebSocket] Disconnected",$e.code,$e.reason),!he&&Se&&e&&(te=setTimeout(()=>{Se&&e&&(console.log("[WebSocket] Attempting to reconnect..."),Ke())},3e3))}}catch($e){console.error("[WebSocket] Failed to create connection:",$e),Se&&e&&(te=setTimeout(()=>{Se&&e&&Ke()},3e3))}};return Ke(),()=>{Se=!1,he=!0,te&&(clearTimeout(te),te=null),V&&((V.readyState===WebSocket.OPEN||V.readyState===WebSocket.CONNECTING)&&V.close(),V=null)}},[e==null?void 0:e.id]);const Ha=f.useRef(!1);f.useEffect(()=>{r.current=s},[s]),f.useEffect(()=>{const V=()=>{const te=r.current,he=uu(window.location.hash);if(te.view==="profile"&&he.view==="login"&&window.location.hash===""&&e)if(Ct)Wa();else{jt(!0),pe.current=window.setTimeout(()=>jt(!1),2e3),window.history.pushState(null,"","#/profile");return}else pe.current&&clearTimeout(pe.current),Ct&&jt(!1);l(he)};return window.addEventListener("hashchange",V),()=>window.removeEventListener("hashchange",V)},[e,Wa,Ct]),f.useEffect(()=>{if(!e){Ha.current=!1,window.location.hash&&window.location.hash!=="#/register"&&(window.location.hash="");return}const V=window.location.hash;if(!Ha.current&&(Ha.current=!0,V===""||V==="#/")){if(as){window.location.hash=`#/game/${as.id}`;return}window.location.hash="#/profile";return}const te=V.startsWith("#/game/");if(as&&!te)window.location.hash=`#/game/${as.id}`;else if(!as&&te){let he="#/profile";(Ve==null?void 0:Ve.status)==="waiting"&&(Ve!=null&&Ve.mode)&&(he=`#/waiting/${encodeURIComponent(Ve.mode)}`),V!==he&&(window.location.hash=he)}},[e,as,Ve]),f.useEffect(()=>{const V=()=>document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`);return V(),window.addEventListener("resize",V),window.addEventListener("orientationchange",V),()=>{window.removeEventListener("resize",V),window.removeEventListener("orientationchange",V)}},[]),f.useEffect(()=>{if(ke){const V=setTimeout(()=>{Ue(null)},5e3);return()=>clearTimeout(V)}},[ke]);const Kx=V=>{ks({type:"ENTER_WAITING_ROOM",payload:{mode:V}}),window.location.hash=`#/waiting/${encodeURIComponent(V)}`},Qx=f.useCallback(V=>{const te=m.find(he=>he.id===V)||rl.find(he=>he.id===V);if(te){const he=m.find(Se=>Se.id===V);ie({...te,...he||{status:"online"}})}},[m,rl]),Jx=f.useCallback(V=>{const te=m.find(he=>he.id===V)||rl.find(he=>he.id===V);if(te){const he=m.find(Se=>Se.id===V);Ie({...te,...he||{status:"online"}})}},[m,rl]),Yx=f.useCallback(()=>Ie(null),[]),Xx=f.useCallback(V=>{n(V),p(te=>({...te,[V.id]:V})),window.location.hash="#/profile"},[]),Zx=f.useCallback(V=>{ls(V),Ns("enhance"),mn(!0)},[]),ep=f.useCallback(V=>{ls(V),Ns("enhance"),mn(!0)},[]),tp=f.useCallback((V,te)=>{nn({item:V,isOwnedByCurrentUser:te})},[]),np=f.useCallback(()=>{if(Le!=null&&Le.success){const V=Le.itemAfter;nn(te=>te&&V&&te.item.id===V.id?{...te,item:V}:te),n(te=>te?{...te,inventory:te.inventory.map(he=>he.id===V.id?V:he)}:null)}He(null)},[Le]),sp=f.useCallback(()=>{He(null)},[]),lp=f.useCallback(()=>{fe(!1),M(null)},[]),rp=f.useCallback(V=>{ks({type:"APPLY_PRESET",payload:{presetName:V.name}})},[ks]),ap=f.useMemo(()=>(e==null?void 0:e.equipmentPresets)||[],[e==null?void 0:e.equipmentPresets]),{mainOptionBonuses:ip,combatSubOptionBonuses:op,specialStatBonuses:cp,aggregatedMythicStats:dp}=f.useMemo(()=>{const V={mainOptionBonuses:{},combatSubOptionBonuses:{},specialStatBonuses:{},aggregatedMythicStats:{}};return!Ve||!Ve.equipment||!Ve.inventory?V:Ve.inventory.filter(Se=>Ve.equipment&&Object.values(Ve.equipment).includes(Se.id)).reduce((Se,Ke)=>{if(!Ke.options)return Se;if(Ke.options.main){const $e=Ke.options.main.type;Se.mainOptionBonuses[$e]||(Se.mainOptionBonuses[$e]={value:0,isPercentage:Ke.options.main.isPercentage}),Se.mainOptionBonuses[$e].value+=Ke.options.main.value}return Ke.options.combatSubs.forEach($e=>{const qe=$e.type;Se.combatSubOptionBonuses[qe]||(Se.combatSubOptionBonuses[qe]={value:0,isPercentage:$e.isPercentage}),Se.combatSubOptionBonuses[qe].value+=$e.value}),Ke.options.specialSubs.forEach($e=>{const qe=$e.type;Se.specialStatBonuses[qe]||(Se.specialStatBonuses[qe]={flat:0,percent:0}),$e.isPercentage?Se.specialStatBonuses[qe].percent+=$e.value:Se.specialStatBonuses[qe].flat+=$e.value}),Ke.options.mythicSubs.forEach($e=>{const qe=$e.type;Se.aggregatedMythicStats[qe]||(Se.aggregatedMythicStats[qe]={count:0,totalValue:0}),Se.aggregatedMythicStats[qe].count++,Se.aggregatedMythicStats[qe].totalValue+=$e.value}),Se},V)},[Ve]);return{currentUser:e,presets:ap,setCurrentUserAndRoute:Xx,currentUserWithStatus:Ve,currentRoute:s,error:a,allUsers:rl,onlineUsers:m,liveGames:y,negotiations:j,waitingRoomChats:x,gameChats:w,adminLogs:P,gameModeAvailability:E,announcements:C,globalOverrideAnnouncement:R,announcementInterval:O,activeGame:as,activeNegotiation:Wx,showExitToast:Ct,enhancementResult:ke,enhancementOutcome:Le,unreadMailCount:Hx,hasClaimableQuest:Vx,settings:c,updateTheme:Ga,updateSoundSetting:Fx,updateFeatureSetting:Gx,updatePanelColor:rs,updateTextColor:zx,resetGraphicsToDefault:Ux,mainOptionBonuses:ip,combatSubOptionBonuses:op,specialStatBonuses:cp,aggregatedMythicStats:dp,modals:{isSettingsModalOpen:Q,isInventoryOpen:$,isMailboxOpen:z,isQuestsOpen:H,isShopOpen:re,lastUsedItemResult:ve,disassemblyResult:X,craftResult:xe,rewardSummary:G,viewingUser:Y,isInfoModalOpen:oe,isEncyclopediaOpen:le,isStatAllocationModalOpen:je,enhancementAnimationTarget:ae,pastRankingsInfo:Te,viewingItem:vt,isProfileEditModalOpen:de,moderatingUser:Ne,isClaimAllSummaryOpen:Z,claimAllSummary:we,isMbtiInfoModalOpen:ft,isEquipmentEffectsModalOpen:Wt,isBlacksmithModalOpen:un,blacksmithSelectedItemForEnhancement:fn,blacksmithActiveTab:rr,combinationResult:za,isBlacksmithHelpOpen:Ua,isEnhancementResultModalOpen:Fa,enhancingItem:it},handlers:{handleAction:ks,handleLogout:Wa,handleEnterWaitingRoom:Kx,applyPreset:rp,openSettingsModal:()=>D(!0),closeSettingsModal:()=>D(!1),openInventory:()=>q(!0),closeInventory:()=>q(!1),openMailbox:()=>W(!0),closeMailbox:()=>W(!1),openQuests:()=>ne(!0),closeQuests:()=>ne(!1),openShop:()=>ce(!0),closeShop:()=>ce(!1),closeItemObtained:()=>F(null),closeDisassemblyResult:()=>ee(null),closeCraftResult:()=>J(null),closeCombinationResult:()=>ar(null),closeRewardSummary:()=>K(null),closeClaimAllSummary:lp,openViewingUser:Qx,closeViewingUser:()=>ie(null),openInfoModal:()=>ue(!0),closeInfoModal:()=>ue(!1),openEncyclopedia:()=>ge(!0),closeEncyclopedia:()=>ge(!1),openStatAllocationModal:()=>me(!0),closeStatAllocationModal:()=>me(!1),openProfileEditModal:()=>_e(!0),closeProfileEditModal:()=>_e(!1),openPastRankings:V=>We(V),closePastRankings:()=>We(null),openViewingItem:tp,closeViewingItem:()=>nn(null),openEnhancingItem:Zx,openEnhancementFromDetail:ep,clearEnhancementOutcome:np,clearEnhancementAnimation:()=>Me(null),openModerationModal:Jx,closeModerationModal:Yx,openMbtiInfoModal:()=>ot(!0),closeMbtiInfoModal:()=>ot(!1),openEquipmentEffectsModal:()=>Ht(!0),closeEquipmentEffectsModal:()=>Ht(!1),openBlacksmithModal:()=>mn(!0),closeBlacksmithModal:()=>{mn(!1),ls(null),Ns("enhance")},openBlacksmithHelp:()=>ir(!0),closeBlacksmithHelp:()=>ir(!1),setBlacksmithActiveTab:Ns,closeEnhancementModal:sp}}},jx=f.createContext(void 0),B0=({children:e})=>{const n=$0();return t.jsx(jx.Provider,{value:n,children:e})},De=()=>{const e=f.useContext(jx);if(e===void 0)throw new Error("useAppContext must be used within an AppProvider");return e},wi=({icon:e,value:n,className:s})=>t.jsxs("div",{className:`flex items-center gap-1 sm:gap-2 bg-tertiary/50 rounded-full py-1 pl-1 pr-2 sm:pr-3 shadow-inner ${s}`,children:[t.jsx("div",{className:"bg-primary w-7 h-7 flex items-center justify-center rounded-full text-lg flex-shrink-0",children:e}),t.jsx("span",{className:"font-bold text-xs sm:text-sm text-primary",children:n})]}),O0=({user:e})=>{const{actionPoints:n,lastActionPointUpdate:s}=e,[l,r]=f.useState(""),a=f.useMemo(()=>bx(e).actionPointRegenInterval,[e]);return f.useEffect(()=>{if(n.current>=n.max){r("");return}const i=()=>{const c=s+a,d=Math.max(0,c-Date.now()),u=Math.floor(d/1e3),p=Math.floor(u/60),m=u%60;r(`${String(p).padStart(2,"0")}:${String(m).padStart(2,"0")}`)};i();const o=setInterval(i,1e3);return()=>clearInterval(o)},[n.current,n.max,s,a]),l?t.jsxs("span",{className:"text-xs text-tertiary font-mono text-center",children:["(",l,")"]}):null},D0=()=>{const{currentUserWithStatus:e,handlers:n,unreadMailCount:s}=De();if(!e)return null;const{handleLogout:l,openShop:r,openSettingsModal:a,openProfileEditModal:i,openMailbox:o}=n,{actionPoints:c,gold:d,diamonds:u,isAdmin:p,avatarId:m,borderId:h,mbti:y}=e,b=f.useMemo(()=>{var g;return(g=Ee.find(x=>x.id===m))==null?void 0:g.url},[m]),j=f.useMemo(()=>{var g;return(g=Re.find(x=>x.id===h))==null?void 0:g.url},[h]);return t.jsx("header",{className:"flex-shrink-0 bg-primary/80 backdrop-blur-sm shadow-lg",children:t.jsxs("div",{className:"p-2 flex justify-between items-center gap-2 h-[60px]",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink min-w-0 cursor-pointer relative",onClick:i,children:[t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:b,borderUrl:j,size:40}),t.jsxs("div",{className:"hidden sm:block min-w-0",children:[t.jsx("h1",{className:"font-bold text-primary truncate",children:e.nickname}),t.jsxs("p",{className:"text-xs text-tertiary truncate",children:[" Lv.",e.strategyLevel," /  Lv.",e.playfulLevel]})]}),!y&&t.jsx("span",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"})]}),t.jsxs("div",{className:"flex items-center justify-end flex-wrap gap-1 sm:gap-2",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(wi,{icon:"",value:`${c.current}/${c.max}`}),t.jsx(O0,{user:e}),t.jsx("button",{onClick:r,className:"ml-1 w-6 h-6 flex-shrink-0 rounded-full bg-green-600 hover:bg-green-500 text-white font-bold flex items-center justify-center text-lg shadow-md transition-transform hover:scale-110 active:scale-95",title:" ",children:"+"})]}),t.jsx(wi,{icon:t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-5 h-5 object-contain"}),value:d.toLocaleString()}),t.jsx(wi,{icon:t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-5 h-5 object-contain"}),value:u.toLocaleString()}),t.jsx("div",{className:"h-9 w-px bg-border-color mx-1 sm:mx-2"}),p&&t.jsx(U,{onClick:()=>window.location.hash="#/admin",colorScheme:"purple",className:"text-xs sm:text-sm",children:""}),t.jsxs("button",{onClick:o,className:"relative p-2 rounded-lg text-xl hover:bg-secondary transition-colors",title:"",children:[t.jsx("img",{src:"/images/icon/mail.png",alt:"",className:"w-6 h-6"}),s>0&&t.jsx("span",{className:"absolute top-1 right-1 bg-red-500 rounded-full w-2.5 h-2.5 border-2 border-primary"})]}),t.jsx("button",{onClick:a,className:"p-2 rounded-lg text-xl hover:bg-secondary transition-colors",title:"",children:""}),t.jsx(U,{onClick:l,colorScheme:"red",className:"text-xs sm:text-sm",children:""})]})]})})},q0=()=>{const{setCurrentUserAndRoute:e}=De(),[n,s]=f.useState(""),[l,r]=f.useState(""),[a,i]=f.useState(null),[o,c]=f.useState(!1),d=async u=>{if(u.preventDefault(),!n.trim()||!l.trim()){i("   .");return}c(!0),i(null);try{const p=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:l})});if(!p.ok){let h=`  (${p.statusText})`;try{const y=await p.json();y&&y.message&&(h=y.message)}catch(y){console.error("Login failed with a non-JSON response body.",y)}throw new Error(h)}const m=await p.json();e(m.user)}catch(p){i(p.message)}finally{c(!1)}};return t.jsx("div",{className:"flex items-center justify-center",children:t.jsxs("div",{className:"w-full max-w-sm p-6 space-y-6 bg-gray-800 rounded-lg shadow-2xl border border-color",children:[t.jsx("div",{children:t.jsx("p",{className:"mt-2 text-center text-gray-400",children:"   ."})}),t.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d,children:[t.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"username-login",className:"sr-only",children:"Username"}),t.jsx("input",{id:"username-login",name:"username",type:"text",autoComplete:"username",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:n,onChange:u=>s(u.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password-login",className:"sr-only",children:"Password"}),t.jsx("input",{id:"password-login",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:l,onChange:u=>r(u.target.value)})]})]}),a&&t.jsx("p",{className:"text-sm text-red-400 text-center",children:a}),t.jsx("div",{className:"w-full flex justify-center",children:t.jsx(U,{type:"submit",disabled:o,className:"w-full py-3 text-lg",children:o?" ...":""})})]}),t.jsx("div",{className:"text-sm text-center",children:t.jsx("a",{href:"#/register",onClick:u=>{u.preventDefault(),window.location.hash="#/register"},className:"font-medium text-blue-400 hover:text-blue-300",children:" ? "})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 flex items-center",children:t.jsx("div",{className:"w-full border-t border-gray-600"})}),t.jsx("div",{className:"relative flex justify-center text-sm",children:t.jsx("span",{className:"px-2 bg-gray-800 text-gray-400",children:"   "})})]}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(U,{disabled:!0,colorScheme:"yellow",className:"w-full",children:""}),t.jsx(U,{disabled:!0,colorScheme:"gray",className:"w-full",children:""})]})]})})},z0=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Yl=e=>{if(!e)return!1;const n=e.toLowerCase().replace(/\s/g,"");return z0.some(s=>n.includes(s))},U0=()=>{const{setCurrentUserAndRoute:e}=De(),[n,s]=f.useState(""),[l,r]=f.useState(""),[a,i]=f.useState(""),[o,c]=f.useState(""),[d,u]=f.useState(null),[p,m]=f.useState(!1),h=async y=>{if(y.preventDefault(),u(null),!n.trim()||!l.trim()||!a.trim()){u("  .");return}if(n.trim().length<2){u(" 2  .");return}if(a.trim().length<4){u(" 4  .");return}if(a!==o){u("  .");return}if(Yl(n)||Yl(l)){u("      .");return}m(!0);try{const b=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,nickname:l,password:a})});if(!b.ok){let g=`  (${b.statusText})`;try{g=(await b.json()).message||g}catch(x){console.error("Could not parse error response as JSON",x)}throw new Error(g)}const j=await b.json();e(j.user)}catch(b){u(b.message)}finally{m(!1)}};return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-gray-800 rounded-lg shadow-2xl border border-color",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold text-center text-white",children:""}),t.jsx("p",{className:"mt-2 text-center text-gray-400",children:"  ."})]}),t.jsxs("form",{className:"mt-8 space-y-4",onSubmit:h,children:[t.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"username-register",className:"sr-only",children:"Username"}),t.jsx("input",{id:"username-register",name:"username",type:"text",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:n,onChange:y=>s(y.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"nickname-register",className:"sr-only",children:"Nickname"}),t.jsx("input",{id:"nickname-register",name:"nickname",type:"text",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:l,onChange:y=>r(y.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password-register",className:"sr-only",children:"Password"}),t.jsx("input",{id:"password-register",name:"password",type:"password",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:a,onChange:y=>i(y.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password-confirm",className:"sr-only",children:"Confirm Password"}),t.jsx("input",{id:"password-confirm",name:"passwordConfirm",type:"password",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:" ",value:o,onChange:y=>c(y.target.value)})]})]}),d&&t.jsx("p",{className:"text-sm text-red-400 text-center",children:d}),t.jsx("div",{className:"w-full flex justify-center",children:t.jsx(U,{type:"submit",disabled:p,className:"w-full py-3 text-lg",children:p?" ...":""})})]}),t.jsx("div",{className:"text-sm text-center",children:t.jsx("a",{href:"#",onClick:y=>{y.preventDefault(),window.location.hash=""},className:"font-medium text-blue-400 hover:text-blue-300",children:"  ? "})})]})})},Oa="/images/Base.png",Da="/images/Base.png",Ic="/images/Hidden.png",Pc="/images/Hidden.png",wx="/images/RatingArena.png",Nx="/images/PlayingArena.png",kx="/images/Championship.png",Sx="/images/single/Map.png",Cx="/images/tower/Tower.png",Ni="draggableWindowSettings",be=({title:e,windowId:n,onClose:s,children:l,initialWidth:r=500,initialHeight:a,modal:i=!0,closeOnOutsideClick:o=!0,isTopmost:c=!0,headerContent:d,zIndex:u=50})=>{const[p,m]=f.useState({x:0,y:0}),[h,y]=f.useState(!1),b=f.useRef({x:0,y:0}),j=f.useRef({x:0,y:0}),[g,x]=f.useState(!1),v=f.useRef(p),[w,k]=f.useState(window.innerWidth<768),[P,S]=f.useState(!0),[E,_]=f.useState(1),C=f.useRef(null),I=f.useCallback(H=>{s&&o&&c&&C.current&&!C.current.contains(H.target)&&s()},[s,o,c]);f.useEffect(()=>{if(i&&s)return document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[i,s,I]),f.useEffect(()=>{const H=()=>k(window.innerWidth<768);return window.addEventListener("resize",H),H(),()=>window.removeEventListener("resize",H)},[]),f.useEffect(()=>{const H=()=>{if(w){_(1);return}const ne=window.innerWidth,re=Math.min(1,ne/(r+100));_(re)};return window.addEventListener("resize",H),H(),()=>window.removeEventListener("resize",H)},[w,r]),f.useEffect(()=>{v.current=p},[p]),f.useEffect(()=>{try{const ne=JSON.parse(localStorage.getItem(Ni)||"{}").rememberPosition??!0;if(S(ne),ne){const re=JSON.parse(localStorage.getItem("draggableWindowPositions")||"{}");re[n]?m(re[n]):m({x:0,y:0})}else m({x:0,y:0})}catch(H){console.error("Failed to load window settings from localStorage",H),m({x:0,y:0})}x(!0)},[n]);const R=f.useCallback((H,ne)=>{y(!0),b.current={x:H,y:ne},j.current=v.current},[]),A=f.useCallback(H=>{!c||H.button!==0||R(H.clientX,H.clientY)},[R,c]),O=f.useCallback(H=>{if(!c)return;const ne=H.touches[0];R(ne.clientX,ne.clientY)},[R,c]),L=f.useCallback((H,ne)=>{if(!h||!C.current)return;const re=H-b.current.x,ce=ne-b.current.y;let ve=j.current.x+re,F=j.current.y+ce;const{offsetWidth:X,offsetHeight:ee}=C.current,{innerWidth:xe,innerHeight:J}=window,G=X/2,K=ee/2,Z=-(xe/2)+G,fe=xe/2-G,we=50;let M,Y;ee<=J?(M=-(J/2)+K,Y=J/2-K):(M=-(J/2)-K+we,Y=J/2+K-we),ve=Math.max(Z,Math.min(ve,fe)),F=Math.max(M,Math.min(F,Y)),m({x:ve,y:F})},[h]),Q=f.useCallback(H=>{L(H.clientX,H.clientY)},[L]),D=f.useCallback(H=>{if(h){const ne=H.touches[0];L(ne.clientX,ne.clientY)}},[h,L]),$=f.useCallback(()=>{if(h&&(y(!1),P))try{const H=JSON.parse(localStorage.getItem("draggableWindowPositions")||"{}");H[n]=v.current,localStorage.setItem("draggableWindowPositions",JSON.stringify(H))}catch(H){console.error("Failed to save window position to localStorage",H)}},[h,n,P]);f.useEffect(()=>(h&&(window.addEventListener("mousemove",Q),window.addEventListener("mouseup",$),window.addEventListener("touchmove",D),window.addEventListener("touchend",$)),()=>{window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",$),window.removeEventListener("touchmove",D),window.removeEventListener("touchend",$)}),[h,Q,D,$]);const q=H=>{const ne=H.target.checked;S(ne);try{const re=JSON.parse(localStorage.getItem(Ni)||"{}");if(re.rememberPosition=ne,localStorage.setItem(Ni,JSON.stringify(re)),!ne){m({x:0,y:0});const ce=JSON.parse(localStorage.getItem("draggableWindowPositions")||"{}");delete ce[n],localStorage.setItem("draggableWindowPositions",JSON.stringify(ce))}}catch(re){console.error("Failed to save remember position setting",re)}},z=`translate(calc(-50% + ${p.x}px), calc(-50% + ${p.y}px)) scale(${h?E*1.02:E})`;if(!g)return null;const W=c?"cursor-move":"";return t.jsxs(t.Fragment,{children:[i&&t.jsx("div",{className:`fixed inset-0 z-40 bg-black/50 ${c?"":"backdrop-blur-sm"}`}),t.jsxs("div",{ref:C,className:"fixed top-1/2 left-1/2 bg-primary rounded-xl shadow-2xl border border-color flex flex-col text-on-panel",style:{width:w?"90vw":void 0,minWidth:w?"90vw":`${r}px`,maxWidth:w?"90vw":"calc(100vw - 40px)",height:a?`${a}px`:void 0,maxHeight:"90vh",transform:z,transformOrigin:"center",boxShadow:h?"0 25px 50px -12px rgba(0, 0, 0, 0.5)":"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",zIndex:u},children:["                ",!c&&t.jsx("div",{className:"absolute inset-0 bg-black/30 z-20 rounded-xl cursor-not-allowed"}),t.jsxs("div",{className:`bg-secondary p-3 rounded-t-xl flex justify-between items-center ${W} touch-none`,onMouseDown:A,onTouchStart:O,children:[t.jsx("h2",{className:"text-lg font-bold text-secondary select-none",children:e}),t.jsxs("div",{className:"flex items-center gap-2",children:[d,s&&t.jsx("button",{onClick:c?s:void 0,className:"w-10 h-10 flex items-center justify-center rounded-full bg-tertiary hover:bg-danger transition-colors z-30",children:t.jsx("span",{className:"text-white font-bold text-lg",children:""})})]})]}),t.jsx("div",{className:"p-3 md:p-6 flex-grow h-full",children:l}),t.jsx("div",{className:"flex-shrink-0 p-2 border-t border-color flex justify-end items-center bg-secondary rounded-b-xl",children:t.jsxs("label",{className:"flex items-center text-xs text-tertiary gap-2 cursor-pointer select-none",children:[t.jsx("input",{type:"checkbox",checked:P,onChange:q,className:"w-4 h-4 bg-tertiary border-color rounded focus:ring-accent"}),"  "]})})]})]})},F0=({currentUser:e,statsType:n,onClose:s,onAction:l})=>{const r=n==="strategic",a=r?"   ":"   ",i=r?Qe:nt,{stats:o,diamonds:c}=e,d=300,u=500,p=c>=d,m=c>=u,h=b=>{p&&window.confirm(` ${d}  '${b}'   ?`)&&l({type:"RESET_SINGLE_STAT",payload:{mode:b}})},y=()=>{if(!m)return;const b=r?"":"";window.confirm(` ${u}   '${b}'   ?`)&&l({type:"RESET_STATS_CATEGORY",payload:{category:n}})};return t.jsxs(be,{title:a,onClose:s,windowId:"detailed-stats",initialWidth:600,children:[t.jsx("div",{className:"max-h-[calc(var(--vh,1vh)*60)] overflow-y-auto pr-2",children:t.jsx("ul",{className:"space-y-3",children:i.map(({mode:b})=>{const j=o==null?void 0:o[b];if(!j||j.wins===0&&j.losses===0)return null;const g=j.wins+j.losses,x=g>0?Math.round(j.wins/g*100):0;return t.jsxs("li",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsx("h3",{className:"text-lg font-bold text-yellow-300 mb-2",children:b}),t.jsx(U,{onClick:()=>h(b),disabled:!p,className:"!text-xs !py-1",colorScheme:"orange",title:`:  ${d}`,children:""})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm text-center",children:[t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:"/"}),t.jsxs("p",{className:"font-semibold text-white",children:[j.wins," ",j.losses,""]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:""}),t.jsxs("p",{className:"font-semibold text-white",children:[x,"%"]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[j.rankingScore,""]})]})]})]},b)})})}),t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700 text-center",children:[t.jsxs("p",{className:"text-sm mb-2 text-gray-300",children:[" :",t.jsxs("span",{className:"font-bold text-cyan-300 ml-2 flex items-center justify-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",c.toLocaleString()]})]}),t.jsxs(U,{onClick:y,colorScheme:"red",disabled:!m,title:`:  ${u}`,children:[r?"":"","   "]})]})]})},Ix=e=>e.mannerScore??200,Ec=e=>e>=2e3?{rank:"",color:"text-purple-400"}:e>=1600?{rank:"",color:"text-blue-400"}:e>=1100?{rank:"",color:"text-cyan-400"}:e>=800?{rank:" ",color:"text-teal-400"}:e>=400?{rank:"",color:"text-green-400"}:e>=200?{rank:"",color:"text-gray-300"}:e>=100?{rank:"",color:"text-yellow-400"}:e>=50?{rank:"",color:"text-orange-400"}:e>=1?{rank:" ",color:"text-red-500"}:{rank:"",color:"text-red-700"},Px=e=>{const n=Math.max(0,Math.min(100,e/2e3*100));let s="bg-red-700";return e>=2e3?s="bg-purple-400":e>=1600?s="bg-blue-400":e>=1100?s="bg-cyan-400":e>=800?s="bg-teal-400":e>=400?s="bg-green-400":e>=200?s="bg-gray-300":e>=100?s="bg-yellow-400":e>=50?s="bg-orange-400":e>=1&&(s="bg-red-500"),{percentage:n,colorClass:s}},Xl=({mobile:e=!1,compact:n=!1,showOnlyWhenQuestCompleted:s=!1,fillHeight:l=!0})=>{const{handlers:r,unreadMailCount:a,hasClaimableQuest:i}=De();if(s&&!i)return null;const o=[{label:"",iconUrl:"/images/quickmenu/quest.png",handler:r.openQuests,disabled:!1,notification:i},{label:"",iconUrl:"/images/quickmenu/gibo.png",handler:()=>alert("   ."),disabled:!0,notification:!1},{label:"",iconUrl:"/images/quickmenu/enhance.png",handler:r.openBlacksmithModal,disabled:!1,notification:!1},{label:"",iconUrl:"/images/quickmenu/store.png",handler:r.openShop,disabled:!1,notification:!1},{label:"",iconUrl:"/images/quickmenu/bag.png",handler:r.openInventory,disabled:!1,notification:!1}],c=e?"flex justify-around items-center gap-2":`bg-gray-800/50 rounded-lg p-${n?1:2} flex flex-col justify-around gap-${n?1:2} ${l?"h-full":""}`,d=e?"flex flex-col items-center justify-center p-1 rounded-md w-14 h-14 bg-gray-700/50 hover:bg-gray-600/50":"flex flex-col items-center justify-center p-1 rounded-lg w-full bg-gray-700/50 hover:bg-gray-600/50",u=e?"w-6 h-6 object-contain":n?"w-7 h-7 object-contain":"w-8 h-8 object-contain",p=e||n?"text-[10px] mt-1":"text-xs mt-1",m=e?"absolute top-1 right-1 bg-red-500 rounded-full w-2.5 h-2.5 border-2 border-gray-800":`absolute top-1 right-1 bg-red-500 rounded-full w-2.5 h-2.5 border-2 ${n?"border-gray-800":"border-gray-800/50"}`,h=e?"absolute top-0 right-0 bg-red-500 text-white text-[10px] font-bold rounded-full w-4 h-4 flex items-center justify-center border-2 border-gray-800":`absolute top-0 right-0 bg-red-500 text-white text-[10px] font-bold rounded-full ${n?"w-4 h-4":"w-5 h-5"} flex items-center justify-center border-2 ${n?"border-gray-800":"border-gray-800/50"}`,y=b=>t.jsxs("button",{onClick:b.handler,disabled:b.disabled,className:`relative flex-1 ${d} disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,title:b.label,children:[t.jsx("img",{src:b.iconUrl,alt:b.label,className:u}),t.jsx("span",{className:p,children:b.label}),b.notification&&(b.count&&b.count>0?t.jsx("span",{className:h,children:b.count>9?"9+":b.count}):t.jsx("span",{className:m}))]},b.label);return t.jsx("div",{className:c,children:o.map(y)})},Zl=({messages:e,onAction:n,mode:s,onViewUser:l,locationPrefix:r})=>{const a=f.useRef(null),i=f.useRef(null),[o,c]=f.useState(""),[d,u]=f.useState(!1),[p,m]=f.useState(0),{currentUserWithStatus:h,handlers:y}=De();f.useEffect(()=>{a.current&&(a.current.scrollTop=a.current.scrollHeight)},[e]),f.useEffect(()=>{if(p>0){const P=setTimeout(()=>{m(S=>Math.max(0,S-1))},1e3);return()=>clearTimeout(P)}},[p]),f.useEffect(()=>{const P=S=>{i.current&&!i.current.contains(S.target)&&u(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]);const b=P=>{if(p>0)return;const S={channel:"global",...P,location:r};n({type:"SEND_CHAT_MESSAGE",payload:S}),u(!1),c(""),m(5)},j=P=>{if(P.preventDefault(),!!o.trim()){if(Yl(o)){alert("       ."),c("");return}b({text:o})}};if(!h)return null;const g=P=>{h.isAdmin&&P!==h.id?y.openModerationModal(P):P!==h.id&&(l||y.openViewingUser)(P)},x=(h.chatBanUntil??0)>Date.now(),v=x?Math.ceil((h.chatBanUntil-Date.now())/1e3/60):0,w=x||p>0,k=x?`   (${v} )`:w?`(${p})`:"[ ]";return t.jsxs("div",{className:"p-4 flex flex-col h-full min-h-0 text-on-panel",children:[t.jsx("h2",{className:"text-lg font-semibold border-b border-color pb-1 flex-shrink-0",children:""}),t.jsx("p",{className:"text-[10px] text-center text-yellow-400 bg-tertiary/50 rounded-sm p-0.5",children:"AI      . "}),t.jsxs("div",{ref:a,className:"flex-grow space-y-0.5 overflow-y-auto pr-1 bg-tertiary/40 p-1 rounded-md min-h-0",children:[e.map(P=>{const S=P.system&&!P.actionInfo&&P.user.nickname==="AI ";return t.jsxs("div",{className:"text-xs",children:[P.location&&t.jsx("span",{className:"font-semibold text-tertiary pr-1",children:P.location}),t.jsxs("span",{className:`font-semibold pr-2 ${P.system?"text-highlight":"text-tertiary cursor-pointer hover:underline"}`,onClick:()=>!P.system&&g(P.user.id),title:P.system?"":`${P.user.nickname}   / `,children:[P.system?S?"AI ":"":P.user.nickname,":"]}),P.text&&t.jsxs("span",{className:S?"text-highlight":"",children:[P.text,S&&" "]}),P.emoji&&t.jsx("span",{className:"text-xl",children:P.emoji})]},P.id)}),e.length===0&&t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:"  ."})]}),t.jsxs("div",{className:"relative flex-shrink-0",children:[d&&t.jsxs("div",{ref:i,className:"absolute bottom-full mb-2 w-full bg-secondary rounded-lg shadow-xl p-1 z-10 max-h-64 overflow-y-auto",children:[t.jsx("div",{className:"grid grid-cols-5 gap-1 text-xl mb-1 border-b border-color pb-1",children:yx.map(P=>t.jsxs("button",{onClick:()=>b({emoji:P}),className:"w-full p-1 rounded-md hover:bg-accent transition-colors text-center",children:[" ",P," "]},P))}),t.jsx("ul",{className:"space-y-0.5",children:hx.map(P=>t.jsxs("li",{children:[" ",t.jsxs("button",{onClick:()=>b({text:P}),className:"w-full text-left text-xs p-1 rounded-md hover:bg-accent transition-colors",children:[" ",P," "]})," "]},P))})]}),t.jsxs("form",{onSubmit:j,className:"flex gap-1",children:[t.jsx("button",{type:"button",onClick:()=>u(P=>!P),className:"bg-secondary hover:bg-tertiary text-primary font-bold px-2.5 rounded-md transition-colors text-lg flex items-center justify-center",title:" ",disabled:w,children:t.jsx("span",{children:""})}),t.jsx("input",{type:"text",value:o,onChange:P=>c(P.target.value),placeholder:k,className:"flex-grow bg-tertiary border border-color rounded-md p-1 focus:ring-accent focus:border-accent text-xs disabled:bg-secondary disabled:text-tertiary",maxLength:30,disabled:w}),t.jsx(U,{type:"submit",disabled:!o.trim()||w,className:"!px-2 !py-1",title:"",children:""})]})]})]})},mu=e=>{if(!e.inventory)return 0;const n=e.inventory.filter(l=>l.isEquipped);let s=0;return n.forEach(l=>{if(l.options){const{main:r,combatSubs:a,specialSubs:i,mythicSubs:o}=l.options;r&&(s+=r.value),a.forEach(c=>s+=c.value),i.forEach(c=>s+=c.value),o.forEach(c=>s+=c.value)}}),s},fu=({user:e,rank:n,value:s,isCurrentUser:l,onViewUser:r})=>{const a=f.useMemo(()=>{var c;return(c=Ee.find(d=>d.id===e.avatarId))==null?void 0:c.url},[e.avatarId]),i=f.useMemo(()=>{var c;return(c=Re.find(d=>d.id===e.borderId))==null?void 0:c.url},[e.borderId]),o=()=>{!l&&r&&r(e.id)};return t.jsxs("div",{className:`flex items-center p-1 rounded-md ${l?"bg-blue-500/30":r?"cursor-pointer hover:bg-secondary/50":""}`,onClick:o,title:!l&&r?`${e.nickname}  `:"",children:[t.jsx("span",{className:"w-8 text-center font-bold",children:n}),t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:a,borderUrl:i,size:24}),t.jsx("span",{className:"flex-1 truncate font-semibold ml-2",children:e.nickname}),t.jsx("span",{className:"w-16 text-right font-mono",children:s.toLocaleString()})]})},xu=({isTopmost:e})=>{const{allUsers:n,currentUserWithStatus:s,handlers:l}=De(),[r,a]=f.useState("combat"),i=f.useMemo(()=>{if(!n||n.length===0)return console.log("[GameRankingBoard] No users available"),[];if(r==="combat"){const c=n.filter(d=>d&&d.id).map(d=>({user:d,value:mu(d)})).sort((d,u)=>u.value-d.value).slice(0,100);return console.log("[GameRankingBoard] Combat rankings:",c.length,"users"),c}else{const c=n.filter(d=>d&&d.id).map(d=>({user:d,value:d.mannerScore||0})).sort((d,u)=>u.value-d.value).slice(0,100);return console.log("[GameRankingBoard] Manner rankings:",c.length,"users"),c}},[n,r]),o=f.useMemo(()=>{if(!s)return null;const c=i.findIndex(u=>u.user&&u.user.id===s.id);if(c!==-1)return{...i[c],rank:c+1};const d=r==="combat"?mu(s):s.mannerScore;return{user:s,value:d,rank:"N/A"}},[i,s,r]);return t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-2 h-full",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0",children:" "}),t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg flex-shrink-0",children:[t.jsx("button",{onClick:()=>a("combat"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${r==="combat"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("manner"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${r==="manner"?"bg-yellow-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-1 text-xs flex flex-col gap-1 min-h-0 h-48",children:i.length===0?t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-xs",children:n.length===0?"  ...":"  ."}):t.jsxs(t.Fragment,{children:[o&&t.jsx("div",{className:"sticky top-0 bg-panel z-10",children:t.jsx(fu,{user:o.user,rank:o.rank,value:o.value,isCurrentUser:!0})}),t.jsx("div",{className:"flex flex-col gap-1",children:i.filter(c=>c&&c.user&&c.user.id).map((c,d)=>t.jsx(fu,{user:c.user,rank:d+1,value:c.value,isCurrentUser:!1,onViewUser:l.openViewingUser},c.user.id))})]})})]})},pu=({user:e,rank:n,value:s,isCurrentUser:l,onViewUser:r})=>{const a=f.useMemo(()=>{var c;return(c=Ee.find(d=>d.id===e.avatarId))==null?void 0:c.url},[e.avatarId]),i=f.useMemo(()=>{var c;return(c=Re.find(d=>d.id===e.borderId))==null?void 0:c.url},[e.borderId]),o=()=>{!l&&r&&r(e.id)};return t.jsxs("div",{className:`flex items-center p-1 rounded-md ${l?"bg-blue-500/30":r?"cursor-pointer hover:bg-secondary/50":""}`,onClick:o,title:!l&&r?`${e.nickname}  `:"",children:[t.jsx("span",{className:"w-8 text-center font-bold",children:n}),t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:a,borderUrl:i,size:24}),t.jsx("span",{className:"flex-1 truncate font-semibold ml-2",children:e.nickname}),t.jsx("span",{className:"w-16 text-right font-mono",children:s.toLocaleString()})]})},gu=({isTopmost:e})=>{const{allUsers:n,currentUserWithStatus:s,handlers:l}=De(),[r,a]=f.useState("strategic"),i=f.useMemo(()=>{if(!n||n.length===0)return console.log("[BadukRankingBoard] No users available"),[];if(r==="championship"){const c=n.filter(d=>d&&d.id&&typeof d.tournamentScore=="number").map(d=>({user:d,value:d.tournamentScore||0})).sort((d,u)=>u.value-d.value).slice(0,100);return console.log("[BadukRankingBoard] Championship rankings:",c.length,"users"),c}else{const c=r==="strategic"?"standard":"playful",d=n.filter(u=>u&&u.id).map(u=>{var p;return{user:u,value:((p=u.cumulativeRankingScore)==null?void 0:p[c])||0}}).sort((u,p)=>p.value-u.value).slice(0,100);return console.log("[BadukRankingBoard]",c,"rankings:",d.length,"users"),d}},[n,r]),o=f.useMemo(()=>{var u;if(!s)return null;let c;if(r==="championship")c=s.tournamentScore;else{const p=r==="strategic"?"standard":"playful";c=((u=s.cumulativeRankingScore)==null?void 0:u[p])||0}const d=i.findIndex(p=>p.user&&p.user.id===s.id);return d!==-1?{...i[d],rank:d+1}:{user:s,value:c,rank:"N/A"}},[i,s,r]);return t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-2 h-full",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0",children:" "}),t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg flex-shrink-0",children:[t.jsx("button",{onClick:()=>a("strategic"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${r==="strategic"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "}),t.jsx("button",{onClick:()=>a("playful"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${r==="playful"?"bg-yellow-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "}),t.jsx("button",{onClick:()=>a("championship"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${r==="championship"?"bg-purple-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-1 text-xs flex flex-col gap-1 min-h-0 h-48",children:i.length===0?t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-xs",children:n.length===0?"  ...":"  ."}):t.jsxs(t.Fragment,{children:[o&&t.jsx("div",{className:"sticky top-0 bg-panel z-10",children:t.jsx(pu,{user:o.user,rank:o.rank,value:o.value,isCurrentUser:!0})}),t.jsx("div",{className:"flex flex-col gap-1",children:i.filter(c=>c&&c.user&&c.user.id).map((c,d)=>t.jsx(pu,{user:c.user,rank:d+1,value:c.value,isCurrentUser:!1,onViewUser:l.openViewingUser},c.user.id))})]})})]})};function G0(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const hu=({level:e,currentXp:n,label:s,colorClass:l})=>{const r=1e3+(e-1)*200,a=Math.min(n/r*100,100);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-0.5 text-xs",children:[t.jsxs("span",{className:"font-semibold",children:[s," ",t.jsxs("span",{className:"text-base font-bold",children:["Lv.",e]})]}),t.jsxs("span",{className:"font-mono text-tertiary",children:[n," / ",r]})]}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-full h-3 border border-color",children:t.jsx("div",{className:`${l} h-full rounded-full transition-width duration-500`,style:{width:`${a}%`}})})]})},W0={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},H0=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-purple-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},yu=({slot:e,item:n,onClick:s})=>{const l=n&&s?"cursor-pointer hover:scale-105 transition-transform":"";if(n){const r=En[n.grade],a=`${n.name} (  : ${r}) -  `,i=H0(n.stars);return t.jsxs("div",{className:`relative w-full aspect-square rounded-lg border-2 border-color/50 bg-tertiary/50 ${l}`,title:a,onClick:s,children:[t.jsx("img",{src:W0[n.grade],alt:n.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),n.stars>0&&t.jsxs("div",{className:`absolute top-1 right-1.5 text-sm font-bold z-10 ${i.colorClass}`,style:{textShadow:"1px 1px 2px black"},children:["",n.stars]}),n.image&&t.jsx("img",{src:n.image,alt:n.name,className:"relative w-full h-full object-contain p-1.5"})]})}else return t.jsx("img",{src:$a[e],alt:`${e} empty slot`,className:"w-full aspect-square rounded-lg bg-tertiary/50 border-2 border-color/50"})},bu=({type:e,stats:n,onEnter:s,onViewStats:l,level:r,title:a,imageUrl:i,tier:o})=>{const d=e==="strategic"?"hover:shadow-blue-500/30":"hover:shadow-yellow-500/30",u=n.wins+n.losses,p=u>0?Math.round(n.wins/u*100):0;return t.jsxs("div",{onClick:s,className:`bg-panel border border-color rounded-lg p-2 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg ${d} cursor-pointer h-full text-on-panel`,children:[t.jsxs("h2",{className:"text-base font-bold flex items-center justify-center gap-1 h-6 mb-1",children:[a,o&&t.jsx("img",{src:o.icon,alt:o.name,className:"w-5 h-5",title:o.name}),t.jsxs("span",{className:"text-sm text-highlight font-normal",children:["Lv.",r]})]}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden",children:t.jsx("img",{src:i,alt:a,className:"w-full h-full object-cover"})}),t.jsxs("div",{onClick:m=>{m.stopPropagation(),l()},className:"w-full bg-tertiary/50 rounded-md p-1 text-xs flex justify-between items-center cursor-pointer hover:bg-tertiary transition-colors mt-2",title:"  ",children:[t.jsxs("span",{children:[" : ",n.wins," ",n.losses," (",p,"%)"]}),t.jsx("span",{className:"text-accent font-semibold",children:""})]})]})},V0=({title:e,imageUrl:n,layout:s,footerContent:l})=>{const r=s==="tall";return t.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 border-2 border-purple-500/50 rounded-lg p-2 flex flex-col text-center shadow-lg shadow-purple-500/20 h-full text-on-panel relative overflow-hidden cursor-not-allowed group",children:[t.jsx("div",{className:"absolute top-2 -right-10 transform rotate-45 bg-purple-600 text-white text-[10px] font-bold px-10 py-0.5 z-10",children:"Coming Soon"}),t.jsx("h2",{className:"text-base font-bold text-purple-300 mt-1 h-6 mb-1",children:e}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden transition-transform duration-300 group-hover:scale-105 bg-black/20",children:t.jsx("img",{src:n,alt:e,className:`w-full h-full object-contain p-2 ${r?"object-contain":"object-cover"}`})}),l&&t.jsx("div",{className:"w-full bg-tertiary/50 rounded-md p-1 text-xs mt-2",children:l})]})},vu=(e,n,s)=>{if(s===0)return At[At.length-1];for(const l of At)if(l.threshold(e,n,s))return l;return At[At.length-1]},K0=()=>{const{currentUserWithStatus:e,allUsers:n,handlers:s,waitingRoomChats:l,hasClaimableQuest:r,presets:a}=De(),[i,o]=f.useState(null),[c,d]=f.useState(!1),[u,p]=f.useState(!1),[m,h]=f.useState(""),[y,b]=f.useState(0);if(f.useEffect(()=>{const G=()=>{const Z=new Date,fe=Z.getFullYear(),we=Z.getMonth(),Y=new Date(fe,we+1,1).getTime()-Z.getTime(),ie=Math.floor(Y/(1e3*60*60*24)),oe=Math.floor(Y%(1e3*60*60*24)/(1e3*60*60));h(`${ie} ${oe} `)};G();const K=setInterval(G,60*60*1e3);return()=>clearInterval(K)},[]),!e)return null;const{inventory:j,stats:g,nickname:x,avatarId:v,borderId:w}=e,k=f.useMemo(()=>l.global||[],[l]),P=G0(k.length),S=u||r;f.useEffect(()=>{!c&&P!==void 0&&k.length>P&&p(!0)},[k.length,P,c]);const E=f.useMemo(()=>{var G;return(G=Ee.find(K=>K.id===v))==null?void 0:G.url},[v]),_=f.useMemo(()=>{var G;return(G=Re.find(K=>K.id===w))==null?void 0:G.url},[w]),C=f.useMemo(()=>(j||[]).filter(G=>G.isEquipped),[j]),I=G=>C.find(K=>K.slot===G),R=f.useMemo(()=>{const G={wins:0,losses:0},K={wins:0,losses:0};if(g){for(const Z of Qe){const fe=g[Z.mode];fe&&(G.wins+=fe.wins,G.losses+=fe.losses)}for(const Z of nt){const fe=g[Z.mode];fe&&(K.wins+=fe.wins,K.losses+=fe.losses)}}return{strategic:G,playful:K}},[g]),A=Ix(e),O=Ec(A),L=Px(A),{coreStatBonuses:Q,specialStatBonuses:D,mythicStatBonuses:$}=f.useMemo(()=>vx(e),[e]);f.useMemo(()=>Object.values(D).some(G=>G.flat>0||G.percent>0),[D]),f.useMemo(()=>Object.values($).some(G=>G.flat>0),[$]),f.useMemo(()=>{const G={};for(const K of Object.values(ct))G[K]={count:0,totalValue:0};return C.forEach(K=>{var Z;(Z=K.options)==null||Z.mythicSubs.forEach(fe=>{const we=fe.type;G[we]&&(G[we].count++,G[we].totalValue+=fe.value)})}),G},[C]);const q=(e.strategyLevel-1)*2+(e.playfulLevel-1)*2,z=e.mannerMasteryApplied?20:0,W=e.bonusStatPoints||0,H=q+z+W,ne=f.useMemo(()=>Object.values(e.spentStatPoints||{}).reduce((G,K)=>G+K,0),[e.spentStatPoints]),re=H-ne,ce=G=>window.location.hash=`#/waiting/${G}`,ve=()=>window.location.hash="#/tournament",F=()=>window.location.hash="#/singleplayer",X=G=>{const K=Number(G.target.value);b(K);const Z=a[K];Z&&s.applyPreset(Z)},ee=f.useMemo(()=>{var ue,le;const G=(ge,je)=>{var Ue;let me=0,ke=0;for(const Le of je){const He=(Ue=ge.stats)==null?void 0:Ue[Le.mode];He&&(me+=He.rankingScore,ke++)}return ke>0?me/ke:1200},K=n.map(ge=>({id:ge.id,score:G(ge,Qe)})).sort((ge,je)=>je.score-ge.score),Z=n.map(ge=>({id:ge.id,score:G(ge,nt)})).sort((ge,je)=>je.score-ge.score),fe=K.findIndex(ge=>ge.id===e.id)+1,we=Z.findIndex(ge=>ge.id===e.id)+1,M=((ue=K.find(ge=>ge.id===e.id))==null?void 0:ue.score)||0,Y=((le=Z.find(ge=>ge.id===e.id))==null?void 0:le.score)||0,ie=vu(M,fe,K.length),oe=vu(Y,we,Z.length);return{strategicTier:ie,playfulTier:oe}},[e,n]);N.Concentration+"",N.ThinkingSpeed+"",N.Judgment+"",N.Calculation+"",N.CombatPower+"",N.Stability+"",Fe.ActionPointMax+"",Fe.ActionPointRegen+"",Fe.StrategyXpBonus+"",Fe.PlayfulXpBonus+"",Fe.GoldBonus+"",Fe.ItemDropRate+"",Fe.MaterialDropRate+"",f.useMemo(()=>{const G={};return C.forEach(K=>{var Z;if((Z=K.options)!=null&&Z.main){const fe=K.options.main,we=fe.type;G[we]||(G[we]={value:0,isPercentage:fe.isPercentage}),G[we].value+=fe.value}}),G},[C]),f.useMemo(()=>{const G={};return C.forEach(K=>{var Z;(Z=K.options)!=null&&Z.combatSubs&&K.options.combatSubs.forEach(fe=>{const we=fe.type;G[we]||(G[we]={value:0,isPercentage:fe.isPercentage}),G[we].value+=fe.value})}),G},[C]);const xe=f.useMemo(()=>t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[t.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center gap-1 w-24",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ce,{userId:e.id,userName:x,size:80,avatarUrl:E,borderUrl:_}),t.jsxs("button",{onClick:s.openProfileEditModal,className:"absolute bottom-0 right-0 w-6 h-6 flex items-center justify-center bg-secondary hover:bg-tertiary rounded-full p-1 border-2 border-primary transition-transform hover:scale-110 active:scale-95",title:" ",children:[t.jsx("span",{className:"text-sm",children:""}),!e.mbti&&t.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-red-500 rounded-full"})]})]}),t.jsxs("div",{className:"flex flex-col items-center w-full",children:[t.jsx("div",{className:"flex items-center gap-1 w-full justify-center",children:t.jsx("h2",{className:"text-base font-bold truncate",title:x,children:x})}),t.jsxs("p",{className:"text-xs text-tertiary mt-0.5",children:["MBTI: ",e.mbti?e.mbti:""]})]})]}),t.jsxs("div",{className:"flex-grow space-y-1 bg-tertiary/30 p-2 rounded-md flex flex-col justify-center",children:[t.jsx(hu,{level:e.strategyLevel,currentXp:e.strategyXp,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-400"}),t.jsx(hu,{level:e.playfulLevel,currentXp:e.playfulXp,label:"",colorClass:"bg-gradient-to-r from-yellow-500 to-orange-400"}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-0.5 text-xs",children:[t.jsx("span",{className:"font-semibold",children:" "}),t.jsxs("span",{className:`font-semibold text-xs ${O.color}`,children:[A," (",O.rank,")"]})]}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-full h-2 border border-color",children:t.jsx("div",{className:`${L.colorClass} h-full rounded-full`,style:{width:`${L.percentage}%`}})})]})]})]}),t.jsxs("div",{className:"flex-grow flex flex-col min-h-0 border-t border-color mt-2 pt-2",children:[t.jsx("div",{className:"bg-tertiary/30 p-2 rounded-md text-center mb-2",children:e.guildId?t.jsx(U,{onClick:()=>window.location.hash="#/guild",colorScheme:"green",className:"w-full",children:" "}):t.jsx(U,{onClick:()=>window.location.hash="#/guild",colorScheme:"blue",className:"w-full",children:" "})}),t.jsxs("div",{className:"flex justify-between items-center mb-1 flex-shrink-0",children:[t.jsx("h3",{className:"font-semibold text-secondary text-sm",children:""}),t.jsxs("div",{className:"text-xs flex items-center gap-2",children:[t.jsxs("span",{children:[": ",t.jsx("span",{className:"font-bold text-green-400",children:re}),"P"]}),t.jsx(U,{onClick:s.openStatAllocationModal,colorScheme:"yellow",className:"!text-[10px] !py-0.5",children:""})]})]}),t.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:Object.values(N).map(G=>{var we;const K=(e.baseStats[G]||0)+(((we=e.spentStatPoints)==null?void 0:we[G])||0),Z=Math.floor(K*(Q[G].percent/100))+Q[G].flat,fe=K+Z;return t.jsxs("div",{className:"bg-tertiary/40 p-1 rounded-md flex items-center justify-between text-xs",children:[t.jsx("span",{className:"font-semibold text-secondary",children:G}),t.jsxs("span",{className:"font-mono font-bold",title:`: ${K}, : ${Z}`,children:[fe,Z>0&&t.jsxs("span",{className:"text-green-400 text-xs ml-0.5",children:["(+",Z,")"]})]})]},G)})})]})]}),[e,s,O,L,A,re,Q]),J=t.jsxs("div",{className:"grid grid-cols-10 grid-rows-2 lg:grid-rows-7 gap-4 h-full",children:[t.jsx("div",{className:"col-span-5 row-span-1 lg:col-span-5 lg:row-span-3",children:t.jsx(bu,{type:"strategic",stats:R.strategic,onEnter:()=>ce("strategic"),onViewStats:()=>o("strategic"),level:e.strategyLevel,title:" ",imageUrl:wx,tier:ee.strategicTier})}),t.jsx("div",{className:"col-span-5 row-span-1 lg:col-span-5 lg:row-span-3",children:t.jsx(bu,{type:"playful",stats:R.playful,onEnter:()=>ce("playful"),onViewStats:()=>o("playful"),level:e.playfulLevel,title:" ",imageUrl:Nx,tier:ee.playfulTier})}),t.jsx("div",{className:"col-span-4 row-span-1 lg:col-span-4 lg:row-span-4",children:t.jsxs("div",{onClick:ve,className:"bg-panel border border-color rounded-lg p-2 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-purple-500/30 cursor-pointer h-full text-on-panel",children:[t.jsx("h2",{className:"text-base font-bold h-6 mb-1",children:""}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden",children:t.jsx("img",{src:kx,alt:"",className:"w-full h-full object-cover"})}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-md p-1 text-xs mt-2",title:" ",children:t.jsxs("span",{children:[": ",e.tournamentScore.toLocaleString()," / : ",e.league]})})]})}),t.jsx("div",{className:"col-span-4 row-span-1 lg:col-span-4 lg:row-span-4",children:t.jsxs("div",{onClick:F,className:"bg-panel border border-color rounded-lg p-2 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-green-500/30 cursor-pointer h-full text-on-panel",children:[t.jsx("h2",{className:"text-base font-bold h-6 mb-1",children:""}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden",children:t.jsx("img",{src:Sx,alt:"",className:"w-full h-full object-cover"})}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-md p-1 text-xs mt-2",title:" ",children:t.jsxs("span",{children:[": ",e.singlePlayerProgress??0," / ",Jl.length]})})]})}),t.jsx("div",{className:"col-span-2 row-span-1 lg:col-span-2 lg:row-span-4",children:t.jsx(V0,{title:" ",imageUrl:Cx,layout:"tall",footerContent:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{children:" : 1"}),t.jsx("span",{className:"text-tertiary",children:m})]})})})]});return t.jsxs("div",{className:"bg-primary text-primary p-2 sm:p-4 lg:p-2 max-w-screen-2xl mx-auto w-full h-full flex flex-col",children:[t.jsxs("header",{className:"flex justify-between items-center mb-2 px-2 flex-shrink-0",children:[t.jsx("h1",{className:"text-2xl font-bold text-primary",children:""}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:s.openEncyclopedia,className:"w-8 h-8 flex items-center justify-center bg-purple-600 hover:bg-purple-500 rounded-full text-white font-bold text-lg flex-shrink-0 transition-transform hover:scale-110",title:"",children:""}),t.jsx("button",{onClick:s.openInfoModal,className:"w-8 h-8 flex items-center justify-center bg-gray-600 hover:bg-gray-500 rounded-full text-white font-bold text-lg flex-shrink-0 transition-transform hover:scale-110",title:"",children:"?"})]})]}),t.jsxs("main",{className:"flex-1 flex flex-col min-h-0",children:[t.jsxs("div",{className:"hidden lg:flex flex-col h-full gap-2",children:[t.jsxs("div",{className:"flex flex-row gap-2",children:[t.jsx("div",{className:"w-[25%] bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-1",children:xe}),t.jsxs("div",{className:"flex-1 flex flex-row gap-2 min-w-0",children:[t.jsxs("div",{className:"w-[240px] bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0 mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:["fan","top","bottom","board","bowl","stones"].map(G=>{const K=I(G);return t.jsx("div",{className:"w-full",children:t.jsx(yu,{slot:G,item:K,onClick:()=>K&&s.openViewingItem(K,!0)})},G)})}),t.jsx(U,{onClick:s.openEquipmentEffectsModal,colorScheme:"blue",className:"mt-2 !text-xs",children:"  "}),t.jsx("div",{className:"mt-2",children:t.jsx("select",{value:y,onChange:X,className:"bg-secondary border border-color text-xs rounded-md p-1 focus:ring-accent focus:border-accent w-full",children:a&&a.map((G,K)=>t.jsx("option",{value:K,children:G.name},K))})})]}),t.jsxs("div",{className:"flex-1 flex flex-row gap-2",children:[t.jsx("div",{className:"flex-1",children:t.jsx(xu,{})}),t.jsx("div",{className:"flex-1",children:t.jsx(gu,{})})]}),t.jsx("div",{className:"w-24 flex-shrink-0",children:t.jsx(Xl,{})})]})]}),t.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2 min-h-0",children:[t.jsx("div",{className:"col-span-5 bg-panel border border-color text-on-panel rounded-lg min-h-0 flex flex-col",children:t.jsx(Zl,{messages:k,mode:"global",onAction:s.handleAction,onViewUser:s.openViewingUser,locationPrefix:"[]"})}),t.jsx("div",{className:"col-span-7 min-h-0 flex flex-col justify-end",children:J})]})]}),t.jsxs("div",{className:"lg:hidden flex flex-col h-full gap-2 relative",children:[t.jsxs("div",{className:"flex flex-col gap-2 flex-1 min-h-0 overflow-y-auto",children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-1",children:xe}),t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0 mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:["fan","top","bottom","board","bowl","stones"].map(G=>{const K=I(G);return t.jsx("div",{className:"w-full",children:t.jsx(yu,{slot:G,item:K,onClick:()=>K&&s.openViewingItem(K,!0)})},G)})}),t.jsx(U,{onClick:s.openEquipmentEffectsModal,colorScheme:"blue",className:"mt-2 !text-xs",children:"  "}),t.jsx("div",{className:"mt-2",children:t.jsx("select",{value:y,onChange:X,className:"bg-secondary border border-color text-xs rounded-md p-1 focus:ring-accent focus:border-accent w-full",children:a&&a.map((G,K)=>t.jsx("option",{value:K,children:G.name},K))})})]})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx(xu,{}),t.jsx(gu,{})]}),t.jsx("div",{className:"flex-shrink-0",children:J})]}),t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",children:t.jsx("button",{onClick:()=>{d(!0),p(!1)},className:"w-8 h-12 bg-secondary/80 backdrop-blur-sm rounded-l-lg flex items-center justify-center text-primary shadow-lg","aria-label":"/ ",children:t.jsxs("span",{className:"relative font-bold text-lg",children:["<",S&&t.jsx("div",{className:"absolute -top-1 -right-1.5 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-secondary"})]})})}),t.jsxs("div",{className:`fixed top-0 right-0 h-full w-[280px] bg-primary shadow-2xl z-50 transition-transform duration-300 ease-in-out ${c?"translate-x-0":"translate-x-full"} flex flex-col`,children:[t.jsxs("div",{className:"flex justify-between items-center p-2 border-b border-color flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold",children:" / "}),t.jsx("button",{onClick:()=>d(!1),className:"text-2xl font-bold text-tertiary hover:text-primary",children:""})]}),t.jsxs("div",{className:"flex flex-col gap-2 p-2 flex-grow min-h-0",children:[t.jsx("div",{className:"flex-shrink-0 p-1 bg-panel rounded-lg border border-color",children:t.jsx(Xl,{mobile:!0})}),t.jsx("div",{className:"flex-1 bg-panel border border-color rounded-lg min-h-0",children:t.jsx(Zl,{messages:k,mode:"global",onAction:s.handleAction,onViewUser:s.openViewingUser,locationPrefix:"[]"})})]})]}),c&&t.jsx("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:()=>d(!1)})]})]}),i&&t.jsx(F0,{currentUser:e,statsType:i,onClose:()=>o(null),onAction:s.handleAction})]})},Q0=({mode:e,description:n,image:s,available:l,onSelect:r,hoverColorClass:a})=>{const[i,o]=f.useState(!1);return t.jsxs("div",{className:`bg-panel text-on-panel rounded-lg p-5 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg ${a} ${l?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,onClick:l?r:void 0,children:[t.jsx("div",{className:"w-[200px] h-[150px] mx-auto bg-tertiary rounded-md mb-4 flex items-center justify-center text-tertiary overflow-hidden shadow-inner",children:i?t.jsx("span",{className:"text-xs",children:e}):t.jsx("img",{src:s,alt:e,className:"w-full h-full object-cover",onError:()=>o(!0)})}),t.jsxs("div",{className:"flex-grow flex flex-col",children:[t.jsx("h3",{className:"text-xl font-bold text-primary mb-2",children:e}),t.jsx("p",{className:"text-tertiary text-sm flex-grow",children:n})]})]})},J0=({lobbyType:e})=>{const{gameModeAvailability:n,handlers:s}=De(),l=e==="strategic",r=l?" ":" ",a=l?Qe:nt,i=l?" ":" ",o=l?"border-blue-400":"border-yellow-400",c=l?"hover:shadow-blue-500/20":"hover:shadow-yellow-500/20",d=()=>window.location.hash="#/profile";return t.jsxs("div",{className:"bg-primary text-primary p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto",children:[t.jsxs("header",{className:"flex flex-wrap justify-between items-center mb-8 gap-4",children:[t.jsx("button",{onClick:d,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsxs("div",{className:"text-center flex-grow",children:[t.jsxs("h1",{className:"text-4xl font-bold",children:[r," "]}),t.jsx("p",{className:"text-secondary mt-2",children:"  ."})]}),t.jsx("div",{className:"w-24"})," "]}),t.jsx("main",{children:t.jsxs("section",{children:[t.jsx("h2",{className:`text-2xl font-semibold mb-5 border-l-4 ${o} pl-4`,children:i}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(u=>t.jsx(Q0,{...u,available:n[u.mode]??u.available,onSelect:()=>s.handleEnterWaitingRoom(u.mode),hoverColorClass:c},u.mode))})]})})]})},Y0={[T.Standard]:{title:" ",sections:[{subtitle:" ",content:["   ()    .","            ."]},{subtitle:" ",content:["    .","       .","          ()  .","   ()   ."]},{subtitle:" ",content:["  ,    .","     ( 6.5)   .","     ."]}]},[T.Capture]:{title:" ",sections:[{subtitle:" ",content:["          ."]},{subtitle:" : ",content:["  (: 20)       .","     () ,      .","   ,       ."]},{subtitle:" ",content:["   ,         ."]},{subtitle:" ",content:["         ,   .","   ."]}]},[T.Speed]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" :   ",content:["      .","     ,   (: 5)    .","   ."]},{subtitle:" ",content:["  ,      .","      . (: 5 1)","       ."]}]},[T.Base]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" ",content:["1.  :         .","2.  :   ,    ()  () ,      ( ) .","3.  :       ,     ."]},{subtitle:" ",content:["  ,   1    (5) .","       ."]}]},[T.Hidden]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" ",content:["     ( , )    ."," :     .     .",":           .      ."]},{subtitle:" ",content:["     (4) .","   ,        ."]}]},[T.Missile]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" ",content:["          . (   )"]},{subtitle:" : ",content:["     , , ,      .","       .","       ."]}]},[T.Mix]:{title:" ",sections:[{subtitle:" ",content:["       ."]},{subtitle:" ",content:[", , , ,    2    ."," , + , +     .","        ."]}]},[T.Omok]:{title:"",sections:[{subtitle:" ",content:["  , ,        ."]},{subtitle:"",content:["    .","       .","    3-3 , (6 )     ."]}]},[T.Ttamok]:{title:"",sections:[{subtitle:" ",content:["        .","1.       ()","2.    (: 10) "]},{subtitle:"  ",content:["       ,             .","   ."]},{subtitle:" ",content:["  (3-3 ,   )    ."]}]},[T.Dice]:{title:" ",sections:[{subtitle:" ",content:[" 3 ,    ()  .","        ."]},{subtitle:" ",content:["1.    . (/   )","2.      ( )   .","3.       ."]},{subtitle:" ",content:["   1 1 .","        .","3        .    ."]}]},[T.Thief]:{title:" ",sections:[{subtitle:" ",content:[" 2      ,      ."]},{subtitle:"",content:[" ():         . 1  1 ."," ():     . 1  2 ."]},{subtitle:" ",content:["       .","      ,       .","   5 ."]},{subtitle:" ",content:[":       1 1 ",":      1 1 ","2         .    ."]}]},[T.Alkkagi]:{title:"",sections:[{subtitle:" ",content:["      ."]},{subtitle:" ",content:["1.  :       .","2. :            .","3.       ,           .","       ."]},{subtitle:" ",content:["      .","  ,          .","        ."]},{subtitle:" ",content:[",         .","    ,       ."]}]},[T.Curling]:{title:" ",sections:[{subtitle:" ",content:[" 3       ."]},{subtitle:" ",content:["     ()   .","        .","       ."]},{subtitle:" ",content:[" :   , ()      .  5, 3, 2, 1,      ."," :        1   ."]},{subtitle:"",content:["     ,     1     .    ."]},{subtitle:" ",content:[",         .","    ,       ."]}]}},X0=({mode:e,onClose:n})=>{const s=Y0[e];return s?t.jsx(be,{title:`${s.title}  `,onClose:n,windowId:`help-${e}`,initialWidth:550,children:t.jsx("div",{className:"max-h-[70vh] overflow-y-auto pr-2 text-gray-300",children:t.jsx("div",{className:"space-y-4",children:s.sections.map((l,r)=>t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"font-bold text-lg text-yellow-300 mb-2",children:l.subtitle}),t.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm",children:l.content.map((a,i)=>t.jsx("li",{children:a},i))})]},r))})})}):t.jsx(be,{title:"",onClose:n,windowId:`help-${e}`,initialWidth:500,children:t.jsx("p",{className:"text-center text-gray-400",children:"       ."})})},Z0=({mode:e,image:n,onChallenge:s,isRejected:l})=>{const[r,a]=f.useState(!1);return t.jsxs("div",{className:`bg-panel text-on-panel rounded-lg p-3 flex flex-col text-center transition-all transform ${l?"opacity-50 cursor-not-allowed grayscale pointer-events-none":"hover:-translate-y-1 shadow-lg cursor-pointer"}`,onClick:()=>{l||s(e)},children:[t.jsx("div",{className:"w-[120px] h-[90px] mx-auto bg-tertiary rounded-md mb-2 flex items-center justify-center text-tertiary overflow-hidden shadow-inner relative",children:r?t.jsx("span",{className:"text-xs",children:e}):t.jsxs(t.Fragment,{children:[t.jsx("img",{src:n,alt:e,className:`w-full h-full object-cover ${l?"grayscale":""}`,onError:()=>a(!0)}),l&&t.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center",children:t.jsx("span",{className:"text-white font-bold text-sm",children:""})})]})}),t.jsx("div",{className:"flex-grow flex flex-col",children:t.jsx("h3",{className:`text-lg font-bold mb-1 ${l?"text-gray-400":"text-primary"}`,children:e})})]})},ey=({opponent:e,onChallenge:n,onClose:s,lobbyType:l})=>{const{currentUserWithStatus:r,handlers:a}=De(),i=async o=>{var c;if(!((c=e.rejectedGameModes)!=null&&c.includes(o)))if(r&&r.status!=="waiting"&&r.status!=="resting")try{await a.handleAction({type:"ENTER_WAITING_ROOM",payload:{mode:l==="strategic"?"strategic":"playful"}}),await new Promise(d=>setTimeout(d,200)),n(o)}catch(d){console.error("Failed to enter waiting room:",d),n(o)}else n(o)};return t.jsx(be,{title:" ",windowId:"challenge-selection",onClose:s,initialWidth:600,children:t.jsxs("div",{onMouseDown:o=>o.stopPropagation(),className:"text-sm",children:[t.jsxs("p",{className:"text-center text-yellow-300 mb-4",children:[e.nickname,"  ."]}),t.jsx("div",{className:"flex flex-col gap-6",children:t.jsx("div",{className:"grid grid-cols-3 gap-4",children:(l==="strategic"?Qe:nt).map(o=>{var d;const c=((d=e.rejectedGameModes)==null?void 0:d.includes(o.mode))||!1;return t.jsx(Z0,{mode:o.mode,image:o.image,onChallenge:i,isRejected:c},o.mode)})})}),t.jsx("div",{className:"mt-6 border-t border-gray-700 pt-6 flex justify-end gap-4",children:t.jsx(U,{onClick:s,variant:"secondary",children:""})})]})})},ty=({onClose:e,lobbyType:n})=>{const{currentUserWithStatus:s,handlers:l}=De(),[r,a]=f.useState([]);f.useEffect(()=>{s!=null&&s.rejectedGameModes&&a(s.rejectedGameModes)},[s]);const i=f.useMemo(()=>n==="strategic"?Qe.map(d=>({mode:d.mode,name:d.name})):n==="playful"?nt.map(d=>({mode:d.mode,name:d.name})):[...Qe.map(d=>({mode:d.mode,name:d.name})),...nt.map(d=>({mode:d.mode,name:d.name}))],[n]),o=d=>{a(u=>u.includes(d)?u.filter(p=>p!==d):[...u,d])},c=()=>{l.handleAction({type:"UPDATE_REJECTION_SETTINGS",payload:{rejectedGameModes:r}}),e()};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-panel rounded-xl shadow-2xl w-full max-w-md p-6 border border-gray-700 flex flex-col",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-white",children:"  "}),t.jsx("p",{className:"text-gray-300 mb-4",children:"      ."}),t.jsx("div",{className:"flex flex-col gap-2 mb-6",children:i.length>0?i.map((d,u)=>t.jsxs("label",{className:"flex items-center text-white cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:r.includes(d.mode),onChange:()=>o(d.mode),className:"form-checkbox h-5 w-5 text-accent rounded"}),t.jsx("span",{className:"ml-2",children:d.name})]},`${d.mode}-${u}`)):t.jsx("p",{className:"text-gray-400 text-sm",children:"   ."})}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx(U,{onClick:e,colorScheme:"gray",children:""}),t.jsx(U,{onClick:c,colorScheme:"green",children:""})]})]})})},ju={online:{text:"",color:"text-green-500"},waiting:{text:" ",color:"text-green-400"},resting:{text:" ",color:"text-gray-400"},negotiating:{text:" ",color:"text-yellow-400"},"in-game":{text:" ",color:"text-blue-400"},spectating:{text:" ",color:"text-purple-400"}},wu=({users:e,onAction:n,currentUser:s,mode:l,negotiations:r,onViewUser:a,lobbyType:i})=>{const[o,c]=f.useState(!1),[d,u]=f.useState(null),[p,m]=f.useState(!1),h=e.find(g=>g.id===s.id),y=e.filter(g=>g.id!==s.id).sort((g,x)=>g.nickname.localeCompare(x.nickname)),b=g=>s.status!=="waiting"?!1:g.status==="waiting"||g.status==="online",j=(g,x)=>{var _,C;const v=!x&&b(g),w=ju[g.status],k=l===T.Dice,P=x?null:r.find(I=>I.challenger.id===s.id&&I.opponent.id===g.id&&(I.status==="pending"||I.status==="draft")),S=(_=Ee.find(I=>I.id===g.avatarId))==null?void 0:_.url,E=(C=Re.find(I=>I.id===g.borderId))==null?void 0:C.url;return t.jsxs("li",{className:`flex items-center justify-between p-1.5 rounded-lg ${x?"bg-blue-900/40 border border-blue-700":"bg-tertiary/50"}`,children:[t.jsxs("div",{className:`flex items-center gap-2 lg:gap-3 overflow-hidden ${x?"":"cursor-pointer"}`,onClick:()=>!x&&a(g.id),title:x?"":`${g.nickname}  `,children:[t.jsx(Ce,{userId:g.id,userName:g.nickname,size:36,className:"border-2 border-color",avatarUrl:S,borderUrl:E}),k&&t.jsx("div",{className:"w-5 h-5 rounded-full bg-black border border-gray-300 flex-shrink-0"}),t.jsxs("div",{className:"overflow-hidden",children:[t.jsx("h3",{className:"font-bold text-sm lg:text-base truncate",children:g.nickname}),t.jsxs("span",{className:`text-xs ${w.color}`,children:[" ",w.text]})]})]}),x?t.jsxs("select",{value:s.status,onChange:I=>n({type:"SET_USER_STATUS",payload:{status:I.target.value}}),disabled:!["waiting","resting"].includes(s.status),className:"px-2 py-1 lg:px-3 lg:py-1.5 bg-secondary border border-color rounded-lg text-xs lg:text-sm transition-colors w-20 lg:w-24 text-center focus:ring-accent focus:border-accent disabled:opacity-50",children:[t.jsx("option",{value:"waiting",children:" "}),t.jsx("option",{value:"resting",children:" "}),!["waiting","resting"].includes(s.status)&&t.jsx("option",{value:s.status,disabled:!0,children:ju[s.status].text})]}):t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[s.isAdmin&&!g.isAdmin&&t.jsx(U,{onClick:()=>{window.confirm(`[${g.nickname}]   ?`)&&n({type:"ADMIN_FORCE_LOGOUT",payload:{targetUserId:g.id}})},colorScheme:"red",className:"!text-xs !py-1 !px-2",children:" "}),P?t.jsx(U,{onClick:()=>n({type:"DECLINE_NEGOTIATION",payload:{negotiationId:P.id}}),colorScheme:"red",className:"!text-xs !py-1 !px-2",children:" "}):t.jsx(U,{onClick:()=>{u(g),c(!0)},disabled:!v,className:"!text-xs !py-1 !px-2",children:" "})]})]},g.id)};return t.jsxs("div",{className:"p-3 flex flex-col min-h-0 text-on-panel",children:[t.jsxs("h2",{className:"text-xl font-semibold mb-2 border-b border-color pb-2 flex-shrink-0 flex justify-between items-center",children:[t.jsx("span",{children:" "}),t.jsx(U,{onClick:()=>m(!0),colorScheme:"none",className:"!text-xs !py-1 !px-2 bg-gradient-to-r from-purple-600 to-blue-500 hover:from-purple-700 hover:to-blue-600 text-white font-bold rounded-lg shadow-lg transition-all duration-200",children:"  "}),"            "]}),h&&t.jsx("div",{className:"flex-shrink-0 mb-2",children:j(h,!0)}),t.jsx("ul",{className:"space-y-2 overflow-y-auto pr-2 max-h-[calc(var(--vh,1vh)*25)] min-h-[96px]",children:y.length>0?y.map(g=>j(g,!1)):t.jsx("p",{className:"text-center text-tertiary pt-8",children:"  ."})}),p&&t.jsx(ty,{onClose:()=>m(!1),lobbyType:i}),o&&d&&t.jsx(ey,{opponent:d,onClose:()=>c(!1),onChallenge:g=>{n({type:"CHALLENGE_USER",payload:{opponentId:d.id,mode:g}}),c(!1)},lobbyType:i})]})},ny=(e,n,s)=>{for(const l of At)if(l.threshold(e,n,s))return l;return At[At.length-1]},sy=()=>{const e=new Date,n=e.getFullYear().toString().slice(-2),s=e.getMonth();let l;return s<3?l=1:s<6?l=2:s<9?l=3:l=4,`${n}-${l}`},Nu=({currentUser:e,mode:n,onViewUser:s,onShowTierInfo:l,onShowPastRankings:r,lobbyType:a})=>{const{allUsers:i}=De(),o=f.useMemo(()=>{const b=a==="strategic"?Qe:nt;return[...i].map(j=>{var w;let g=0,x=0;for(const k of b){const P=(w=j.stats)==null?void 0:w[k.mode];P&&(g+=P.rankingScore||0,x++)}const v=x>0?g/x:0;return{...j,avgScore:v}}).filter(j=>j.avgScore>0).sort((j,g)=>g.avgScore-j.avgScore)},[i,a]),c=f.useMemo(()=>{const b=a==="strategic"?Qe:nt;return o.filter(j=>{var x;let g=0;for(const v of b){const w=(x=j.stats)==null?void 0:x[v.mode];w&&(g+=(w.wins||0)+(w.losses||0))}return g>=20})},[o,a]);c.length;const d=At[At.length-1],u=o.findIndex(b=>b.id===e.id),p=u!==-1?{user:o[u],rank:u+1,score:o[u].avgScore}:null,m=o.slice(0,100),h=f.useCallback(b=>{var v;const j=c.findIndex(w=>w.id===b.id)+1;if(j===0)return d;const g=a==="strategic"?Qe:nt;let x=0;for(const w of g){const k=(v=b.stats)==null?void 0:v[w.mode];k&&(x+=(k.wins||0)+(k.losses||0))}return ny(b.avgScore,j,x)},[a,c,d]),y=f.useCallback((b,j,g)=>{var D,$,q;const x=a==="strategic"?Qe:nt;let v=0,w=0;for(const z of x){const W=(D=b.stats)==null?void 0:D[z.mode];W&&(v+=W.wins||0,w+=W.losses||0)}const k=v+w>0?Math.round(v/(v+w)*100):0,P=b.avgScore,S=h(b),E=!g&&b.id===e.id,_="flex items-center gap-2 rounded-lg",C="bg-yellow-900/40 border border-yellow-700",I="bg-blue-900/60 border border-blue-600",R="bg-tertiary/50",A=!g&&b.id!==e.id,O=`${_} ${g?C:E?I:R} p-1.5 ${A?"cursor-pointer hover:bg-secondary/50":""}`,L=($=Ee.find(z=>z.id===b.avatarId))==null?void 0:$.url,Q=(q=Re.find(z=>z.id===b.borderId))==null?void 0:q.url;return t.jsxs("li",{className:O,onClick:A?()=>s(b.id):void 0,title:A?`${b.nickname}  `:"",children:[t.jsx("span",{className:"w-8 text-center font-mono text-sm",children:j}),t.jsx("img",{src:S.icon,alt:S.name,className:"w-8 h-8 flex-shrink-0",title:S.name}),t.jsx(Ce,{userId:b.id,userName:b.nickname,size:32,avatarUrl:L,borderUrl:Q}),t.jsxs("div",{className:"flex-grow overflow-hidden",children:[t.jsx("p",{className:"font-semibold text-sm truncate",children:b.nickname}),t.jsxs("p",{className:"text-xs text-highlight font-mono",children:[Math.round(P),""]})]}),t.jsxs("div",{className:"text-right text-[10px] lg:text-xs flex-shrink-0 w-20 text-tertiary",children:[t.jsxs("p",{children:[v," ",w,""]}),t.jsxs("p",{className:"font-semibold",children:[k,"%"]})]})]},b.id)},[a,e.id,h,s]);return t.jsxs("div",{className:"p-4 flex flex-col text-on-panel",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-color pb-2 flex-shrink-0 flex-wrap gap-2",children:[t.jsxs("h2",{className:"text-xl font-semibold",children:[n,"  (",sy(),")"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(U,{onClick:()=>r({user:e,mode:n}),colorScheme:"none",className:"!text-xs !py-1 bg-gradient-to-r from-purple-600 to-blue-500 hover:from-purple-700 hover:to-blue-600 text-white font-bold rounded-lg shadow-lg transition-all duration-200",children:" "}),t.jsx(U,{onClick:l,colorScheme:"none",className:"!text-xs !py-1 bg-gradient-to-r from-purple-600 to-blue-500 hover:from-purple-700 hover:to-blue-600 text-white font-bold rounded-lg shadow-lg transition-all duration-200",children:" "})]})]}),p&&t.jsx("div",{className:"flex-shrink-0 mb-3",children:y(p.user,p.rank,!0)}),t.jsx("ul",{className:"space-y-2 overflow-y-auto pr-2 h-72",children:m.length>0?m.map((b,j)=>y(b,j+1,!1)):t.jsx("p",{className:"text-center text-tertiary pt-8",children:"  ."})})]})},ku=({games:e,onAction:n,currentUser:s})=>{const[l,r]=f.useState(""),[a,i]=f.useState(null),o=f.useRef(null);f.useEffect(()=>{const m=h=>{o.current&&!o.current.contains(h.target)&&i(null)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const c=()=>{const m=parseInt(l,10);if(isNaN(m)||m<1||m>e.length){alert("   .");return}const h=e[m-1];h&&n({type:"SPECTATE_GAME",payload:{gameId:h.id}}),r("")},d=m=>{i(h=>h===m?null:m)},u=m=>{const h=prompt("   (50 ):",m.description||"");if(h!==null){if(h.length>50){alert("  50   .");return}n({type:"ADMIN_SET_GAME_DESCRIPTION",payload:{gameId:m.id,description:h}})}i(null)},p=m=>{window.confirm(`[${m.player1.nickname} vs ${m.player2.nickname}]   ?`)&&n({type:"ADMIN_FORCE_DELETE_GAME",payload:{gameId:m.id}}),i(null)};return t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg shadow-lg p-4 flex flex-col min-h-0 h-full",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-color pb-2 flex-shrink-0",children:[t.jsx("h2",{className:"text-xl font-semibold",children:" "}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"number",min:"1",placeholder:" ",value:l,onChange:m=>{const h=m.target.value;(h===""||parseInt(h,10)>0)&&r(h)},onKeyDown:m=>{m.key==="Enter"&&c()},className:"w-24 bg-tertiary border border-color rounded-md p-2 focus:ring-accent focus:border-accent text-sm text-center"}),t.jsx("button",{onClick:c,className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg text-sm transition-colors shrink-0",children:""})]})]}),t.jsx("ul",{className:"space-y-3 overflow-y-auto pr-2 flex-grow",children:e.length>0?e.map((m,h)=>!m||!m.player1||!m.player2?null:t.jsxs("li",{className:"relative",children:[t.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-tertiary/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[t.jsx("div",{className:`flex-shrink-0 w-8 h-8 flex items-center justify-center bg-secondary rounded-full font-bold text-sm ${s.isAdmin?"cursor-pointer hover:bg-tertiary transition-colors":""}`,onClick:s.isAdmin?()=>d(m.id):void 0,title:s.isAdmin?"  ":` : ${h+1}`,children:h+1}),t.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[t.jsxs("div",{className:"text-center truncate",children:[t.jsx(Ce,{userId:m.player1.id,userName:m.player1.nickname,size:36,className:"border-2 border-color mx-auto"}),t.jsx("span",{className:"text-xs font-semibold block truncate",children:m.player1.nickname})]}),t.jsx("span",{className:"text-tertiary font-bold",children:"vs"}),t.jsxs("div",{className:"text-center truncate",children:[t.jsx(Ce,{userId:m.player2.id,userName:m.player2.nickname,size:36,className:"border-2 border-color mx-auto"}),t.jsx("span",{className:"text-xs font-semibold block truncate",children:m.player2.nickname})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[m.description&&t.jsx("div",{className:"text-sm text-highlight truncate max-w-xs hidden md:block",title:m.description,children:m.description}),t.jsx("button",{onClick:()=>n({type:"SPECTATE_GAME",payload:{gameId:m.id}}),className:"ml-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg text-sm transition-colors shrink-0",children:""})]})]}),s.isAdmin&&a===m.id&&t.jsxs("div",{ref:o,className:"absolute top-12 left-2 z-10 bg-secondary rounded-md shadow-lg p-2 space-y-2 w-48 border border-color",children:[t.jsx("button",{onClick:()=>u(m),className:"w-full text-left px-3 py-1.5 text-sm rounded hover:bg-accent transition-colors",children:"  /"}),t.jsx("button",{onClick:()=>p(m),className:"w-full text-left px-3 py-1.5 text-sm rounded hover:bg-danger text-red-300 transition-colors",children:"  "})]})]},m.id)):t.jsx("p",{className:"text-center text-tertiary pt-8",children:"  ."})})]})},ly=({onClose:e})=>{const n={:" 0.1%",:" 3%",:" 5%",:" 10%",:" 25%",:" 40%",:" 60%",:" 80%",:" "},s=r=>{if(r.includes(""))return"/images/icon/Zem.png";const a=ws.find(i=>i.name===r);return(a==null?void 0:a.image)||null},l=r=>{const a=E0[r];if(!a)return t.jsx("span",{className:"text-gray-500",children:"  "});const i=[];return a.diamonds&&i.push({name:`${a.diamonds.toLocaleString()}`,image:"/images/icon/Zem.png"}),a.items&&a.items.forEach(o=>{const c="itemId"in o?o.itemId:o.name,d=s(c);i.push({name:`${c} x${o.quantity}`,image:d})}),t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:i.map((o,c)=>o.image&&t.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-700/50 px-2 py-1 rounded-md",title:o.name,children:[t.jsx("img",{src:o.image,alt:o.name,className:"w-5 h-5 object-contain"}),t.jsx("span",{className:"text-gray-300 whitespace-nowrap text-xs",children:o.name})]},c))})};return t.jsx(be,{title:"   ",onClose:e,windowId:"ranking-tier-info-modal",initialWidth:600,children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-300",children:"        .        ,  ."}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg",children:[t.jsx("h4",{className:"font-bold text-lg text-yellow-300 mb-2",children:" "}),t.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 1:"})," 1 1 ~ 3 31"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 2:"})," 4 1 ~ 6 30"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 3:"})," 7 1 ~ 9 30"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 4:"})," 10 1 ~ 12 31"]})]}),t.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"       ."})]}),t.jsx("ul",{className:"space-y-2 max-h-[40vh] overflow-y-auto pr-2",children:At.map(r=>t.jsxs("li",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{src:r.icon,alt:r.name,className:"w-12 h-12 mr-4 flex-shrink-0"}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("p",{className:`font-bold text-lg ${r.color}`,children:r.name}),t.jsx("p",{className:"text-sm text-gray-400",children:n[r.name]||"N/A"})]})]}),t.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-700/50",children:[t.jsx("h5",{className:"text-xs font-semibold text-gray-400 mb-1.5",children:"  "}),l(r.name)]})]},r.name))})]})})},ry=[T.Dice,T.Omok,T.Ttamok,T.Thief,T.Alkkagi,T.Curling];function ay(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const Su=({mode:e})=>{const{handlers:n}=De(),s=Qe.some(a=>a.mode===e),l=ry.includes(e);if(!s&&!l)return null;const r=s?`${e}()`:`${e}`;return t.jsxs("div",{className:"bg-panel rounded-lg shadow-lg p-3 flex items-center justify-between flex-shrink-0 text-on-panel",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ce,{userId:el,userName:"AI",size:40,className:"border-2 border-purple-500"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-base font-bold text-purple-300",children:"AI "}),t.jsxs("p",{className:"text-xs text-tertiary",children:[r,"()   ."]})]})]}),t.jsx(U,{onClick:()=>n.handleAction({type:"CHALLENGE_USER",payload:{opponentId:el,mode:e}}),colorScheme:"purple",className:"!text-sm !py-1.5",children:"  "})]})},Cu=({mode:e})=>{const{announcements:n,globalOverrideAnnouncement:s,announcementInterval:l}=De(),[r,a]=f.useState(0),i=f.useMemo(()=>n.map(c=>c.id).join(","),[n]);return f.useEffect(()=>{if(!n||n.length<=1){a(0);return}const c=setInterval(()=>{a(d=>(d+1)%n.length)},l*1e3);return()=>clearInterval(c)},[i,n.length,l]),s&&(s.modes==="all"||s.modes.includes(e))?t.jsx("div",{className:"bg-yellow-800/50 border border-yellow-600 rounded-lg shadow-lg p-2 flex items-center justify-center flex-shrink-0 h-10",children:t.jsx("span",{className:"font-bold text-yellow-300 animate-pulse text-center",children:s.message})}):!n||n.length===0?t.jsx("div",{className:"bg-panel rounded-lg shadow-lg p-2 flex items-center justify-center flex-shrink-0 h-10 text-on-panel",children:t.jsx("span",{className:"font-bold text-tertiary text-center",children:"[   .]"})}):t.jsx("div",{className:"bg-panel rounded-lg shadow-lg px-4 relative overflow-hidden flex-shrink-0 h-10",children:t.jsx("div",{className:"w-full absolute top-0 left-0 transition-transform duration-1000 ease-in-out",style:{transform:`translateY(-${r*2.5}rem)`},children:n.map(c=>t.jsx("div",{className:"w-full h-10 flex items-center justify-center",children:t.jsxs("span",{className:"font-bold",children:[t.jsx("span",{className:"text-red-500 mr-2",children:"[]"}),t.jsx("span",{className:"text-highlight",children:c.message})]})},c.id))})})},iy=({mode:e})=>{const{currentUserWithStatus:n,onlineUsers:s,allUsers:l,liveGames:r,waitingRoomChats:a,negotiations:i,handlers:o}=De(),[c,d]=f.useState(window.innerWidth<1024),[u,p]=f.useState(!1),[m,h]=f.useState(!1),[y,b]=f.useState(!1),[j,g]=f.useState(!1),x=f.useRef(null),v=a.global||[],w=ay(v.length);f.useEffect(()=>{n&&(e==="strategic"||e==="playful"||typeof e=="string")&&(!(n.status==="waiting"||n.status==="resting")||n.mode!==e)&&o.handleAction({type:"ENTER_WAITING_ROOM",payload:{mode:e}})},[e,n==null?void 0:n.id,n==null?void 0:n.status,n==null?void 0:n.mode]),f.useEffect(()=>{!u&&w!==void 0&&v.length>w&&h(!0)},[v.length,w,u]);const k=()=>{o.handleAction({type:"LEAVE_WAITING_ROOM"}),window.location.hash="#/profile"};if(f.useEffect(()=>{const I=()=>d(window.innerWidth<1024);return window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]),!n)return null;const P=Object.values(r).filter(I=>I.mode===e),S=f.useMemo(()=>{const I=e==="strategic",R=e==="playful",A=s.filter(L=>I||R?L.status==="waiting"||L.status==="resting":L.mode===e),O=A.find(L=>L.id===n.id);return O?[O,...A.filter(L=>L.id!==n.id)]:[{...n,status:"waiting",mode:e},...A]},[s,e,n]),E=f.useMemo(()=>e==="strategic"?!0:e==="playful"?!1:Qe.some(I=>I.mode===e),[e]),C=`[${E?"":""}:${e}]`;return t.jsxs("div",{className:"bg-primary text-primary flex flex-col h-full max-w-full",children:[t.jsxs("header",{className:"flex justify-between items-center mb-4 flex-shrink-0 px-2 sm:px-4 lg:px-6 pt-2 sm:pt-4 lg:pt-6",children:[t.jsx("div",{className:"flex-1",children:t.jsx(U,{onClick:k,colorScheme:"gray",children:"  "})}),t.jsxs("div",{className:"flex-1 text-center flex items-center justify-center",children:[t.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:e==="strategic"?" ":e==="playful"?" ":`${e} `}),t.jsx("button",{onClick:()=>g(!0),className:"ml-3 w-8 h-8 flex items-center justify-center bg-secondary hover:bg-tertiary rounded-full text-primary font-bold text-xl flex-shrink-0 transition-transform hover:scale-110","aria-label":"  ",title:"  ",children:"?"})]}),t.jsx("div",{className:"flex-1 text-right",children:t.jsxs("p",{className:"text-secondary text-sm",children:[S.length,"  "]})})]}),t.jsx("div",{className:"flex-1 min-h-0 relative px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6",children:c?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col h-full gap-2",children:[t.jsx("div",{className:"flex-shrink-0",children:e!=="strategic"&&e!=="playful"&&t.jsx(Cu,{mode:e})}),t.jsx("div",{className:"flex-shrink-0",children:e!=="strategic"&&e!=="playful"&&t.jsx(Su,{mode:e})}),t.jsx("div",{className:"flex-1 flex flex-row gap-2 items-stretch min-h-0",children:t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(ku,{games:P,onAction:o.handleAction,currentUser:n})})}),t.jsx("div",{className:"flex-1 min-h-0 bg-panel border border-color rounded-lg shadow-lg flex flex-col",children:t.jsx(Zl,{messages:v,mode:"global",onAction:o.handleAction,locationPrefix:C,onViewUser:o.openViewingUser})})]}),t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",children:t.jsx("button",{onClick:()=>{p(!0),h(!1)},className:"w-8 h-12 bg-secondary/80 backdrop-blur-sm rounded-l-lg flex items-center justify-center text-primary shadow-lg","aria-label":"    ",children:t.jsxs("span",{className:"relative font-bold text-lg",children:["<",m&&t.jsx("div",{className:"absolute -top-1 -right-1.5 w-2.5 h-2.5 bg-danger rounded-full border-2 border-secondary"})]})})}),t.jsxs("div",{className:`fixed top-0 right-0 h-full w-[280px] bg-primary shadow-2xl z-50 transition-transform duration-300 ease-in-out ${u?"translate-x-0":"translate-x-full"}`,children:[t.jsx("button",{onClick:()=>p(!1),className:"self-end text-2xl p-2 text-tertiary hover:text-primary",children:""}),t.jsx("div",{className:"flex-shrink-0 p-2 border-b border-color",children:t.jsx(Xl,{mobile:!0})}),t.jsx("div",{className:"flex-1 min-h-0",children:t.jsx(wu,{users:S,mode:e,onAction:o.handleAction,currentUser:n,negotiations:Object.values(i),onViewUser:o.openViewingUser,lobbyType:E?"strategic":"playful"})}),t.jsx("div",{className:"flex-1 min-h-0 border-t border-color",children:t.jsx(Nu,{mode:e,onShowTierInfo:()=>b(!0),currentUser:n,onViewUser:o.openViewingUser,onShowPastRankings:I=>o.openPastRankings(I),lobbyType:E?"strategic":"playful"})})]}),u&&t.jsx("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:()=>p(!1)})]}):t.jsxs("div",{ref:x,className:"grid grid-cols-1 lg:grid-cols-5 h-full gap-4",children:[t.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-4 min-h-0",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(Cu,{mode:e})}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx(Su,{mode:e})}),t.jsx("div",{className:"h-[350px] min-h-0",children:t.jsx(ku,{games:P,onAction:o.handleAction,currentUser:n})}),t.jsx("div",{className:"flex-1 flex flex-col bg-panel border border-color rounded-lg shadow-lg min-h-0",children:t.jsx(Zl,{messages:v,mode:"global",onAction:o.handleAction,locationPrefix:C,onViewUser:o.openViewingUser})})]}),t.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-4",children:[t.jsxs("div",{className:"flex-1 flex flex-row gap-4 items-stretch min-h-0",children:[t.jsx("div",{className:"flex-1 bg-panel border border-color rounded-lg shadow-lg min-w-0",children:t.jsx(wu,{users:S,mode:e,onAction:o.handleAction,currentUser:n,negotiations:Object.values(i),onViewUser:o.openViewingUser,lobbyType:E?"strategic":"playful"})}),t.jsx("div",{className:"w-24 flex-shrink-0",children:t.jsx(Xl,{})})]}),t.jsx("div",{className:"flex-1 bg-panel border border-color rounded-lg shadow-lg",children:t.jsx(Nu,{currentUser:n,mode:e,onViewUser:o.openViewingUser,onShowTierInfo:()=>b(!0),onShowPastRankings:o.openPastRankings,lobbyType:E?"strategic":"playful"})})]})]})}),y&&t.jsx(ly,{onClose:()=>b(!1)}),j&&t.jsx(X0,{mode:e,onClose:()=>g(!1)})]})},oy=({animation:e,toSvgCoords:n,cellSize:s})=>{const{text:l,point:r}=e,{cx:a,cy:i}=n(r),o=s*1.5;return t.jsx("g",{style:{pointerEvents:"none"},className:"bonus-text-animation",children:t.jsx("text",{x:a,y:i,textAnchor:"middle",dy:".35em",fontSize:o,fontWeight:"bold",fill:"url(#bonus-gradient)",stroke:"black",strokeWidth:"1.5px",paintOrder:"stroke",children:l})})},cy=({ownershipMap:e,toSvgCoords:n,cellSize:s})=>t.jsx("g",{style:{pointerEvents:"none"},className:"animate-fade-in",children:e.map((l,r)=>l.map((a,i)=>{const{cx:o,cy:c}=n({x:i,y:r}),u=Math.abs(a)/10;if(u<.3)return null;const p=s*u*.9,m=u*.7,h=a>0?`rgba(0, 0, 0, ${m})`:`rgba(255, 255, 255, ${m})`;return t.jsx("rect",{x:o-p/2,y:c-p/2,width:p,height:p,fill:h,rx:p*.3},`${i}-${r}`)}))}),dy=({animation:e,stone_radius:n,toSvgCoords:s})=>{const{from:l,to:r,player:a}=e,i=s(l),o=s(r),c={"--from-x":`${i.cx}px`,"--from-y":`${i.cy}px`,"--to-x":`${o.cx}px`,"--to-y":`${o.cy}px`},d=Math.atan2(o.cy-i.cy,o.cx-i.cx)*180/Math.PI;return t.jsx("g",{style:c,className:"missile-flight-group",children:t.jsxs("g",{transform:"translate(0, 0)",children:[t.jsx("ellipse",{cx:0,cy:0,rx:n*1.5,ry:n*.7,fill:"url(#missile_fire)",className:"missile-fire-trail",transform:`rotate(${d}) translate(${-n}, 0)`}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===B.Black?"#111827":"#f5f2e8"}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===B.Black?"url(#slate_highlight)":"url(#clamshell_highlight)"})]})})},uy=({animation:e,stone_radius:n,toSvgCoords:s})=>{const{from:l,to:r,player:a,duration:i}=e,o=s(l),c=s(r),d={"--from-x":`${o.cx}px`,"--from-y":`${o.cy}px`,"--to-x":`${c.cx}px`,"--to-y":`${c.cy}px`,animationDuration:`${i}ms`,animationFillMode:"forwards"},u=n*2*.7,p=u/2,m=Math.atan2(c.cy-o.cy,c.cx-o.cx)*180/Math.PI,h=t.jsx("g",{style:d,className:"hidden-missile-flight-group",children:t.jsxs("g",{transform:"translate(0, 0)",children:[t.jsx("ellipse",{cx:0,cy:0,rx:n*1.5,ry:n*.7,fill:"url(#missile_fire)",className:"missile-fire-trail",transform:`rotate(${m}) translate(${-n}, 0)`}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===B.Black?"#111827":"#f5f2e8"}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===B.Black?"url(#slate_highlight)":"url(#clamshell_highlight)"}),t.jsx("image",{href:a===B.Black?Pc:Ic,x:-p,y:-p,width:u,height:u})]})});return t.jsx("g",{style:{pointerEvents:"none"},children:h})},my=({animation:e,toSvgCoords:n,stone_radius:s})=>{const{point:l,success:r}=e,{cx:a,cy:i}=n(l),o=s*2.5;return t.jsx("g",{style:{pointerEvents:"none"},children:r?t.jsxs(t.Fragment,{children:[t.jsx("circle",{cx:a,cy:i,r:o*.2,fill:"none",stroke:"#34d399",className:"scan-success-circle",style:{animationDelay:"0s"}}),t.jsx("circle",{cx:a,cy:i,r:o*.2,fill:"none",stroke:"#34d399",className:"scan-success-circle",style:{animationDelay:"0.2s"}}),t.jsx("circle",{cx:a,cy:i,r:o*.2,fill:"none",stroke:"#34d399",className:"scan-success-circle",style:{animationDelay:"0.4s"}})]}):t.jsxs(t.Fragment,{children:[t.jsx("line",{x1:a-o/2,y1:i-o/2,x2:a+o/2,y2:i+o/2,stroke:"#f87171",strokeWidth:"4",strokeLinecap:"round",className:"scan-fail-line"}),t.jsx("line",{x1:a+o/2,y1:i-o/2,x2:a-o/2,y2:i+o/2,stroke:"#f87171",strokeWidth:"4",strokeLinecap:"round",className:"scan-fail-line",style:{animationDelay:"0.2s"}})]})})},fy=({move:e,toSvgCoords:n,cellSize:s,onClick:l})=>{const{cx:r,cy:a}=n({x:e.x,y:e.y}),i=s*.45,c=["#3b82f6","#16a34a","#f59e0b"][e.order-1]||"#6b7280";return t.jsxs("g",{onClick:d=>{d.stopPropagation(),l(e.x,e.y)},className:"cursor-pointer recommended-move-marker",children:[t.jsx("circle",{cx:r,cy:a,r:i,fill:c,fillOpacity:"0.7",stroke:"white",strokeWidth:"2"}),t.jsx("text",{x:r,y:a,textAnchor:"middle",dy:".35em",fontSize:i*1.2,fontWeight:"bold",fill:"white",style:{pointerEvents:"none",textShadow:"0 0 3px black"},children:e.order})]})},Ir=({player:e,cx:n,cy:s,isLastMove:l,isSelectedMissile:r,isHoverSelectableMissile:a,isKnownHidden:i,isNewlyRevealed:o,animationClass:c,isPending:d,isBaseStone:u,isPatternStone:p,radius:m,isFaint:h})=>{const y=m*2*.7,b=y/2,j=d?"rgb(34, 197, 94)":r?"rgb(239, 68, 68)":"none",g=r||d?3.5:0;return t.jsxs("g",{className:`${c||""} ${a?"missile-selectable-stone":""}`,opacity:d?.6:h?.4:1,children:[t.jsx("circle",{cx:n,cy:s,r:m,fill:e===B.Black?"#111827":"#f5f2e8",stroke:j,strokeWidth:g}),e===B.White&&t.jsx("circle",{cx:n,cy:s,r:m,fill:"url(#clam_grain)"}),t.jsx("circle",{cx:n,cy:s,r:m,fill:e===B.Black?"url(#slate_highlight)":"url(#clamshell_highlight)"}),u&&t.jsx("image",{href:e===B.Black?Da:Oa,x:n-b,y:s-b,width:y,height:y}),i&&t.jsx("image",{href:e===B.Black?Pc:Ic,x:n-b,y:s-b,width:y,height:y}),p&&t.jsx("image",{href:e===B.Black?"/images/single/BlackDouble.png":"/images/single/WhiteDouble.png",x:n-b,y:s-b,width:y,height:y}),o&&t.jsx("circle",{cx:n,cy:s,r:m,fill:"none",stroke:"rgba(0, 255, 255, 0.8)",strokeWidth:"4",className:"sparkle-animation",style:{pointerEvents:"none",transformOrigin:"center"}}),l&&t.jsx("circle",{cx:n,cy:s,r:m*.25,fill:"rgba(239, 68, 68, 0.9)",className:"animate-pulse",style:{pointerEvents:"none"}})]})},qa=e=>{var jt;const{boardState:n,boardSize:s,onBoardClick:l,onMissileLaunch:r,lastMove:a,lastTurnStones:i,isBoardDisabled:o,stoneColor:c,winningLine:d,hiddenMoves:u,moveHistory:p,baseStones:m,baseStones_p1:h,baseStones_p2:y,myPlayerEnum:b,gameStatus:j,highlightedPoints:g,highlightStyle:x="circle",myRevealedStones:v,allRevealedStones:w,newlyRevealed:k,isSpectator:P,analysisResult:S,showTerritoryOverlay:E=!1,showHintOverlay:_=!1,currentUser:C,blackPlayerNickname:I,whitePlayerNickname:R,currentPlayer:A,isItemModeActive:O,animation:L,mode:Q,mixedModes:D,justCaptured:$,permanentlyRevealedStones:q,onAction:z,gameId:W,showLastMoveMarker:H,blackPatternStones:ne,whitePatternStones:re}=e,[ce,ve]=f.useState(null),[F,X]=f.useState(null),[ee,xe]=f.useState(!1),[J,G]=f.useState(null),[K,Z]=f.useState(null),[fe,we]=f.useState(window.innerWidth<1024),M=f.useRef(null),Y=f.useRef(null),ie=840,oe=s>0?s:19,ue=ie/oe,le=ue/2,ge=ue*.47;f.useEffect(()=>{const pe=()=>we(window.innerWidth<1024);return window.addEventListener("resize",pe),()=>window.removeEventListener("resize",pe)},[]);const je=f.useMemo(()=>{const pe=Qe.map(_e=>_e.mode),de=[T.Omok,T.Ttamok,T.Dice,T.Thief];return pe.includes(Q)||de.includes(Q)||j.startsWith("single_player")},[Q,j]);f.useEffect(()=>{j!=="missile_selecting"&&X(null)},[j]);const me=f.useMemo(()=>oe===19?[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}]:oe===15?[{x:3,y:3},{x:11,y:3},{x:7,y:7},{x:3,y:11},{x:11,y:11}]:oe===13?[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9},{x:6,y:6}]:oe===11?[{x:2,y:2},{x:8,y:2},{x:5,y:5},{x:2,y:8},{x:8,y:8}]:oe===9?[{x:2,y:2},{x:6,y:2},{x:4,y:4},{x:2,y:6},{x:6,y:6}]:oe===7?[{x:3,y:3}]:[],[oe]),ke=pe=>({cx:le+pe.x*ue,cy:le+pe.y*ue}),Ue=pe=>{const de=Y.current;if(!de)return null;const _e=de.createSVGPoint();_e.x=pe.clientX,_e.y=pe.clientY;const Ne=de.getScreenCTM();if(Ne){const Ie=_e.matrixTransform(Ne.inverse()),ft=Math.round((Ie.x-le)/ue),ot=Math.round((Ie.y-le)/ue);if(ft>=0&&ft<oe&&ot>=0&&ot<oe)return{x:ft,y:ot}}return null},Le=f.useCallback(pe=>{const de=[];return pe.x>0&&de.push({x:pe.x-1,y:pe.y}),pe.x<oe-1&&de.push({x:pe.x+1,y:pe.y}),pe.y>0&&de.push({x:pe.x,y:pe.y-1}),pe.y<oe-1&&de.push({x:pe.x,y:pe.y+1}),de},[oe]),He=pe=>{const de=Ue(pe);de&&(ve(de),j==="missile_selecting"&&!o&&n[de.y][de.x]===b&&Le(de).some(Ie=>n[Ie.y][Ie.x]===B.None)&&(X(de),xe(!0),G({x:pe.clientX,y:pe.clientY}),M.current=de,pe.target.setPointerCapture(pe.pointerId)))},ae=pe=>{const de=Ue(pe);ve(de),ee&&Z({x:pe.clientX,y:pe.clientY})},Me=pe=>{pe.target.releasePointerCapture(pe.pointerId);const de=Ue(pe);if(ee){const _e=J&&K?Math.hypot(K.x-J.x,K.y-J.y):0,Ne=M.current;if(xe(!1),G(null),Z(null),!fe&&_e<10)return;if(Ne&&de&&r){const Ie=de.x-Ne.x,ft=de.y-Ne.y;if(Ie!==0||ft!==0){let ot;Math.abs(Ie)>Math.abs(ft)?ot=Ie>0?"right":"left":ot=ft>0?"down":"up",r(Ne,ot),X(null)}}}else!o&&de&&l(de.x,de.y)},Te=f.useMemo(()=>j!=="base_placement"?null:b===B.Black?h:y,[j,b,h,y]),We=pe=>{if(!u||!p||j!=="playing"&&j!=="hidden_placing")return!1;const de=b===B.Black?B.White:B.Black;for(let _e=p.length-1;_e>=0;_e--){const Ne=p[_e];if(Ne.x===pe.x&&Ne.y===pe.y)return!!u[_e]&&Ne.player===de}return!1},it=j==="ended"||j==="no_contest",Gt=ce&&!o&&j!=="scanning"&&j!=="missile_selecting"&&(n[ce.y][ce.x]===B.None||We(ce)),vt=()=>!E||!S||!S.deadStones?null:t.jsx("g",{style:{pointerEvents:"none"},className:"animate-fade-in",children:S.deadStones.map((pe,de)=>{const{cx:_e,cy:Ne}=ke(pe),Ie=ge*.7;return t.jsxs("g",{children:[t.jsx("line",{x1:_e-Ie,y1:Ne-Ie,x2:_e+Ie,y2:Ne+Ie,stroke:"red",strokeWidth:"3",strokeLinecap:"round"}),t.jsx("line",{x1:_e-Ie,y1:Ne+Ie,x2:_e+Ie,y2:Ne-Ie,stroke:"red",strokeWidth:"3",strokeLinecap:"round"})]},`ds-${de}`)})}),nn=(pe,de,_e)=>{const Ne=pe.moveHistory||[];if(!Array.isArray(Ne))return-1;for(let Ie=Ne.length-1;Ie>=0;Ie--)if(Ne[Ie].x===de&&Ne[Ie].y===_e)return Ie;return-1},Ct=()=>{var Ne;if(j!=="missile_selecting"||!F||!r)return null;if(ee&&J&&K){const Ie=Y.current;if(!Ie)return null;const ft=(Ne=Ie.getScreenCTM())==null?void 0:Ne.inverse();if(!ft)return null;const ot=ke(F),Wt=Ie.createSVGPoint();Wt.x=K.x,Wt.y=K.y;const Ht=Wt.matrixTransform(ft),un=Ht.x-ot.cx,mn=Ht.y-ot.cy;let fn={cx:ot.cx,cy:ot.cy};return Math.abs(un)>Math.abs(mn)?fn.cx+=Math.sign(un)*ue*2:fn.cy+=Math.sign(mn)*ue*2,t.jsx("g",{style:{pointerEvents:"none"},children:t.jsx("line",{x1:ot.cx,y1:ot.cy,x2:fn.cx,y2:fn.cy,stroke:"rgba(239, 68, 68, 0.7)",strokeWidth:"4",strokeDasharray:"8 4",markerEnd:"url(#arrowhead-missile)"})})}const pe=Le(F).filter(Ie=>n[Ie.y][Ie.x]===B.None);if(pe.length===0)return null;const de=ue*.4,_e=[{dir:"up",point:{x:F.x,y:F.y-1}},{dir:"down",point:{x:F.x,y:F.y+1}},{dir:"left",point:{x:F.x-1,y:F.y}},{dir:"right",point:{x:F.x+1,y:F.y}}];return t.jsx("g",{children:_e.map(({dir:Ie,point:ft})=>{if(!pe.some(un=>un.x===ft.x&&un.y===ft.y))return null;const{cx:Wt,cy:Ht}=ke(ft);return t.jsx("polygon",{points:`${Wt},${Ht-de} ${Wt+de},${Ht} ${Wt},${Ht+de} ${Wt-de},${Ht}`,fill:"rgba(239, 68, 68, 0.8)",stroke:"white",strokeWidth:"1",className:"cursor-pointer hover:opacity-100 opacity-80",onClick:()=>r(F,Ie)},Ie)})})};return t.jsx("div",{className:`relative w-full h-full shadow-2xl rounded-lg overflow-hidden p-0 border-4 ${O?"prism-border":"border-gray-800"}`,children:t.jsxs("svg",{ref:Y,viewBox:`0 0 ${ie} ${ie}`,className:"w-full h-full touch-none",onPointerDown:He,onPointerMove:ae,onPointerUp:Me,onPointerLeave:()=>{ve(null)},children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"slate_highlight",cx:"35%",cy:"35%",r:"60%",fx:"30%",fy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#6b7280",stopOpacity:"0.8"}),t.jsx("stop",{offset:"100%",stopColor:"#111827",stopOpacity:"0.2"})]}),t.jsxs("radialGradient",{id:"clamshell_highlight",cx:"35%",cy:"35%",r:"60%",fx:"30%",fy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"0.9"}),t.jsx("stop",{offset:"100%",stopColor:"#e5e7eb",stopOpacity:"0.1"})]}),t.jsxs("filter",{id:"clam_grain_filter",children:[t.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.8",numOctaves:"4",stitchTiles:"stitch"}),t.jsx("feColorMatrix",{type:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 0.1 0"})]}),t.jsxs("pattern",{id:"clam_grain",patternUnits:"userSpaceOnUse",width:"100",height:"100",children:[t.jsx("rect",{width:"100",height:"100",fill:"#f5f2e8"}),t.jsx("rect",{width:"100",height:"100",filter:"url(#clam_grain_filter)"})]}),t.jsxs("radialGradient",{id:"missile_fire",cx:"50%",cy:"50%",r:"50%",children:[t.jsx("stop",{offset:"0%",stopColor:"#fca5a5"}),t.jsx("stop",{offset:"50%",stopColor:"#f87171"}),t.jsx("stop",{offset:"100%",stopColor:"#ef4444",stopOpacity:"0"})]}),t.jsxs("linearGradient",{id:"bonus-gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#fef08a"}),t.jsx("stop",{offset:"100%",stopColor:"#f59e0b"})]}),t.jsxs("filter",{id:"blue-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"3.5",result:"blur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"blur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsx("marker",{id:"arrowhead-missile",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"rgba(239, 68, 68, 0.9)"})})]}),t.jsx("rect",{width:ie,height:ie,fill:"#e0b484"}),Array.from({length:oe}).map((pe,de)=>t.jsxs("g",{children:[t.jsx("line",{x1:le+de*ue,y1:le,x2:le+de*ue,y2:ie-le,stroke:"#54432a",strokeWidth:"1.5"}),t.jsx("line",{x1:le,y1:le+de*ue,x2:ie-le,y2:le+de*ue,stroke:"#54432a",strokeWidth:"1.5"})]},de)),me.map((pe,de)=>t.jsx("circle",{...ke(pe),r:oe>9?6:4,fill:"#54432a"},de)),E&&(S==null?void 0:S.ownershipMap)&&t.jsx(cy,{ownershipMap:S.ownershipMap,toSvgCoords:ke,cellSize:ue}),n.map((pe,de)=>pe.map((_e,Ne)=>{if(_e===B.None)return null;const{cx:Ie,cy:ft}=ke({x:Ne,y:de}),ot=H&&je&&a&&a.x===Ne&&a.y===de,Wt=H&&je&&i&&i.some(Je=>Je.x===Ne&&Je.y===de),Ht=!!(ot||Wt),un=p?nn({moveHistory:p},Ne,de):-1,mn=u&&un!==-1&&u[un],fn=q==null?void 0:q.some(Je=>Je.x===Ne&&Je.y===de);let ls=!0;if(mn)if(P)ls=it||!!fn;else{const Je=!P&&(v==null?void 0:v.some(rs=>rs.x===Ne&&rs.y===de)),Ga=k==null?void 0:k.some(rs=>rs.point.x===Ne&&rs.point.y===de);ls=it||!!fn||_e===b||!!Je||!!Ga}if(!ls||(L==null?void 0:L.type)==="missile"&&L.from.x===Ne&&L.from.y===de||(L==null?void 0:L.type)==="hidden_missile"&&L.from.x===Ne&&L.from.y===de)return null;const rr=k==null?void 0:k.some(Je=>Je.point.x===Ne&&Je.point.y===de),Ns=!P&&(v==null?void 0:v.some(Je=>Je.x===Ne&&Je.y===de))&&!fn,za=m==null?void 0:m.some(Je=>Je.x===Ne&&Je.y===de&&Je.player===_e),ar=mn,Ua=(F==null?void 0:F.x)===Ne&&(F==null?void 0:F.y)===de,ir=j==="missile_selecting"&&!F&&_e===b,Fa=_e===B.Black&&(ne==null?void 0:ne.some(Je=>Je.x===Ne&&Je.y===de))||_e===B.White&&(re==null?void 0:re.some(Je=>Je.x===Ne&&Je.y===de));return t.jsx(Ir,{player:_e,cx:Ie,cy:ft,isLastMove:Ht,isKnownHidden:ar,isBaseStone:za,isPatternStone:Fa,isNewlyRevealed:rr,animationClass:rr?"sparkle-animation":"",isSelectedMissile:Ua,isHoverSelectableMissile:ir,radius:ge,isFaint:Ns},`${Ne}-${de}`)})),Te==null?void 0:Te.map((pe,de)=>{const{cx:_e,cy:Ne}=ke(pe);return t.jsx("g",{opacity:.7,className:"animate-fade-in",children:t.jsx(Ir,{player:b,cx:_e,cy:Ne,isBaseStone:!0,radius:ge})},`my-base-${de}`)}),d&&d.length>0&&t.jsx("path",{d:`M ${ke(d[0]).cx} ${ke(d[0]).cy} L ${ke(d[d.length-1]).cx} ${ke(d[d.length-1]).cy}`,stroke:"rgba(239, 68, 68, 0.8)",strokeWidth:"10",strokeLinecap:"round",className:"animate-fade-in"}),g&&g.map((pe,de)=>{const{cx:_e,cy:Ne}=ke(pe);return x==="ring"?t.jsx("circle",{cx:_e,cy:Ne,r:ge*.9,fill:"none",stroke:"#0ea5e9",strokeWidth:"3",strokeDasharray:"5 3",className:"animate-pulse",style:{pointerEvents:"none"}},`highlight-ring-${de}`):t.jsx("circle",{cx:_e,cy:Ne,r:ge*.3,fill:A===B.Black?"black":"white",opacity:"0.3"},`highlight-circle-${de}`)}),Gt&&ce&&t.jsxs("g",{opacity:"0.5",children:[" ",t.jsx(Ir,{player:c,cx:ke(ce).cx,cy:ke(ce).cy,radius:ge})," "]}),Ct(),L&&t.jsxs(t.Fragment,{children:[L.type==="missile"&&t.jsx(dy,{animation:L,stone_radius:ge,toSvgCoords:ke}),L.type==="hidden_missile"&&L.player===b&&!P&&t.jsx(uy,{animation:L,stone_radius:ge,toSvgCoords:ke}),L.type==="scan"&&!P&&L.playerId===C.id&&t.jsx(my,{animation:L,toSvgCoords:ke,stone_radius:ge}),L.type==="hidden_reveal"&&L.stones.map((pe,de)=>t.jsx(Ir,{player:pe.player,cx:ke(pe.point).cx,cy:ke(pe.point).cy,isKnownHidden:!0,animationClass:"sparkle-animation",radius:ge},`reveal-${de}`)),L.type==="bonus_text"&&t.jsx(oy,{animation:L,toSvgCoords:ke,cellSize:ue})]}),vt(),_&&!o&&((jt=S==null?void 0:S.recommendedMoves)==null?void 0:jt.map(pe=>t.jsx(fy,{move:pe,toSvgCoords:ke,cellSize:ue,onClick:l},`rec-${pe.order}`)))]})})},xy=e=>{var _,C;const{session:n,onAction:s,myPlayerEnum:l,handleBoardClick:r,isItemModeActive:a,showTerritoryOverlay:i,isMyTurn:o,isMobile:c,myRevealedMoves:d,showLastMoveMarker:u}=e,{blackPlayerId:p,whitePlayerId:m,player1:h,player2:y,settings:b,lastMove:j,gameStatus:g,mode:x}=n,v=[h,y],w=v.find(I=>I.id===p)||null,k=v.find(I=>I.id===m)||null,P=f.useMemo(()=>(d||[]).map(I=>{var R;return(R=n.moveHistory)==null?void 0:R[I]}).filter(I=>!!I).map(I=>({x:I.x,y:I.y})),[d,n.moveHistory]),S=f.useMemo(()=>{if(!n.moveHistory||!n.revealedHiddenMoves)return{};const I={};for(const R in n.revealedHiddenMoves)I[R]=n.revealedHiddenMoves[R].map(A=>{var O;return(O=n.moveHistory)==null?void 0:O[A]}).filter(A=>!!A).map(A=>({x:A.x,y:A.y}));return I},[n.revealedHiddenMoves,n.moveHistory]),E=f.useMemo(()=>Qe.some(I=>I.mode===x)?"bg-strategic-background":nt.some(I=>I.mode===x)?"bg-playful-background":"bg-primary",[x]);return t.jsx("div",{className:`w-full h-full flex items-center justify-center ${E}`,children:t.jsx(qa,{boardState:n.boardState,boardSize:b.boardSize,onBoardClick:r,onMissileLaunch:(I,R)=>{s({type:"LAUNCH_MISSILE",payload:{gameId:n.id,from:I,direction:R}})},onAction:s,gameId:n.id,lastMove:j,lastTurnStones:n.lastTurnStones,isBoardDisabled:e.isSpectator||!o&&g!=="base_placement",stoneColor:l,winningLine:n.winningLine,mode:n.mode,mixedModes:n.settings.mixedModes,hiddenMoves:n.hiddenMoves,moveHistory:n.moveHistory,baseStones:n.baseStones,myPlayerEnum:l,gameStatus:g,currentPlayer:n.currentPlayer,highlightedPoints:[],myRevealedStones:P,allRevealedStones:S,newlyRevealed:n.newlyRevealed,justCaptured:n.justCaptured,permanentlyRevealedStones:n.permanentlyRevealedStones,isSpectator:e.isSpectator,analysisResult:((_=n.analysisResult)==null?void 0:_[e.currentUser.id])??(g==="ended"?(C=n.analysisResult)==null?void 0:C.system:null),showTerritoryOverlay:i,showHintOverlay:!1,showLastMoveMarker:u,baseStones_p1:g==="base_placement"?n.baseStones_p1:void 0,baseStones_p2:g==="base_placement"?n.baseStones_p2:void 0,currentUser:e.currentUser,blackPlayerNickname:(w==null?void 0:w.nickname)||"",whitePlayerNickname:(k==null?void 0:k.nickname)||"",isItemModeActive:a,animation:n.animation,isMobile:c})})},py=f.forwardRef((e,n)=>{const{stones:s,gameStatus:l,myPlayer:r,isMyTurn:a,settings:i,onPlacementClick:o,onStoneInteractionStart:c,isSpectator:d,dragStartPoint:u,dragEndPoint:p,selectedStone:m,myStonesCount:h,maxStones:y,session:b,currentUser:j}=e,[g,x]=f.useState(s),[v,w]=f.useState(null),k=f.useRef(null),P=840,S=i.boardSize>0?i.boardSize:19,E=P/S,_=E/2,C=f.useMemo(()=>S===19?[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}]:S===13?[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9},{x:6,y:6}]:S===11?[{x:2,y:2},{x:8,y:2},{x:2,y:8},{x:8,y:8},{x:5,y:5}]:S===9?[{x:2,y:2},{x:6,y:2},{x:2,y:6},{x:6,y:6},{x:4,y:4}]:[],[S]),I=q=>({cx:_+q.x*E,cy:_+q.y*E});f.useEffect(()=>{l!=="alkkagi_animating"&&x(s)},[s,l]),f.useImperativeHandle(n,()=>({updateLocalStones:q=>{x([...q])},getSvg:()=>k.current}));const R=q=>{const z=k.current;if(!z)return null;const W=z.createSVGPoint();W.x=q.clientX,W.y=q.clientY;const H=z.getScreenCTM();if(H){const ne=W.matrixTransform(H.inverse());return{x:ne.x,y:ne.y}}return null},A=f.useCallback(q=>{if(!q||l!=="alkkagi_placement"&&l!=="alkkagi_simultaneous_placement"||r===B.None)return!1;const z=g&&g.length>0&&g[0].radius?g[0].radius:840/19*.47,{x:W,y:H}=q;if(W<z||W>P-z||H<z||H>P-z)return!1;let ne=!1;if(i.alkkagiLayout===Kl.Battle)ne=lu[r].some(ce=>{const ve=_+(ce.x-.5)*E,F=_+(ce.y-.5)*E,X=ve+ce.width*E,ee=F+ce.height*E;return W>=ve&&W<=X&&H>=F&&H<=ee});else{const re=P*.15,ce=P*.35,ve=P*.65,F=P*.85;r===B.White?H>=re&&H<=ce&&(ne=!0):H>=ve&&H<=F&&(ne=!0)}if(!ne)return!1;for(const re of g)if(re.player===r&&Math.hypot(W-re.x,H-re.y)<re.radius*2)return!1;return!0},[l,r,g,i.alkkagiLayout,E,_]),O=f.useMemo(()=>A(v),[v,A]),L=q=>{if(l!=="alkkagi_placement"&&l!=="alkkagi_simultaneous_placement"||!a)return;const z=R(q);z&&A(z)&&o({x:z.x,y:z.y})},Q=a&&(l==="alkkagi_placement"||l==="alkkagi_simultaneous_placement")&&h<y,D=()=>{if(l!=="alkkagi_placement"&&l!=="alkkagi_simultaneous_placement"||d||r===B.None)return null;const q={strokeWidth:"3",rx:"5",className:Q?"animate-pulse-blue":"",style:{pointerEvents:"none"}};if(i.alkkagiLayout===Kl.Battle){const z=lu[r],W=r===B.Black?"rgba(0, 0, 0, 0.25)":"rgba(255, 255, 255, 0.35)",H=r===B.Black?"rgba(50, 50, 50, 0.8)":"rgba(220, 220, 220, 0.8)";return t.jsx("g",{children:z.map((ne,re)=>t.jsx("rect",{x:_+(ne.x-.5)*E,y:_+(ne.y-.5)*E,width:ne.width*E,height:ne.height*E,fill:W,stroke:H,...q},`zone-${re}`))})}else{const z=P*.15,W=P*.35,H=P*.65,ne=r===B.White?z:H,re=W-z,ce=r===B.Black?"rgba(0, 0, 0, 0.25)":"rgba(255, 255, 255, 0.35)",ve=r===B.Black?"rgba(50, 50, 50, 0.8)":"rgba(220, 220, 220, 0.8)";return t.jsx("rect",{x:0,y:ne,width:P,height:re,fill:ce,stroke:ve,...q})}},$=f.useMemo(()=>{var we,M;if(!u||!p||!m||!k.current)return null;const q=k.current,z=(we=q.getScreenCTM())==null?void 0:we.inverse();if(!z)return null;const W=q.createSVGPoint();W.x=u.x,W.y=u.y;const H=W.matrixTransform(z);W.x=p.x,W.y=p.y;const ne=W.matrixTransform(z),re=ne.x-H.x,ce=ne.y-H.y,ve=m,F={x:ve.x,y:ve.y};let X={x:F.x-re,y:F.y-ce};const xe=(((M=b.activeAlkkagiItems)==null?void 0:M[j.id])||[]).includes("aimingLine"),J=80*.2,G=xe?J*11:J,K=X.x-F.x,Z=X.y-F.y,fe=Math.hypot(K,Z);return fe>G&&(X.x=F.x+K/fe*G,X.y=F.y+Z/fe*G),{start:F,end:X}},[u,p,m,b.activeAlkkagiItems,j.id]);return t.jsx("div",{className:"relative w-full h-full shadow-2xl rounded-lg overflow-hidden border-4 border-gray-800",children:t.jsxs("svg",{ref:k,viewBox:`0 0 ${P} ${P}`,className:"w-full h-full touch-none",onClick:L,onMouseMove:q=>{const z=R(q);w(z)},onMouseLeave:()=>w(null),children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"gloss-alkkagi-1",children:[t.jsx("stop",{offset:"10%",stopColor:"#333"}),t.jsx("stop",{offset:"95%",stopColor:"#000"})]}),t.jsxs("radialGradient",{id:"gloss-alkkagi-2",children:[t.jsx("stop",{offset:"10%",stopColor:"#fff"}),t.jsx("stop",{offset:"95%",stopColor:"#ccc"})]}),t.jsx("marker",{id:"arrowhead-alkkagi",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"rgba(239, 68, 68, 0.9)"})})]}),t.jsx("rect",{width:P,height:P,fill:"#DDAA77"}),Array.from({length:S}).map((q,z)=>t.jsxs("g",{children:[t.jsx("line",{x1:_+z*E,y1:_,x2:_+z*E,y2:P-_,stroke:"#54432a",strokeWidth:"1.5"}),t.jsx("line",{x1:_,y1:_+z*E,x2:P-_,y2:_+z*E,stroke:"#54432a",strokeWidth:"1.5"})]},z)),C.map((q,z)=>t.jsx("circle",{...I(q),r:S>9?5:4,fill:"#54432a"},z)),D(),g.map(q=>{if(!q.onBoard)return null;const z=q.player===r,W=!d&&a&&l==="alkkagi_playing",H=W&&z?"cursor-pointer":"";return t.jsxs("g",{className:H,onMouseDown:W&&z?ne=>c(q,ne):void 0,onTouchStart:W&&z?ne=>{ne.preventDefault(),c(q,ne)}:void 0,children:[t.jsx("circle",{cx:q.x,cy:q.y,r:q.radius,fill:q.player===B.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:q.x,cy:q.y,r:q.radius,fill:`url(#gloss-alkkagi-${q.player})`})]},q.id)}),Q&&v&&O&&t.jsx("g",{opacity:"0.5",style:{pointerEvents:"none"},children:t.jsx("circle",{cx:v.x,cy:v.y,r:g&&g[0]?g[0].radius:840/19*.47,fill:r===B.Black?"#111827":"#f9fafb"})}),$&&t.jsx("g",{style:{pointerEvents:"none"},children:t.jsx("line",{x1:$.start.x,y1:$.start.y,x2:$.end.x,y2:$.end.y,stroke:"rgba(239, 68, 68, 0.7)",strokeWidth:"4",strokeDasharray:"8 4",markerEnd:"url(#arrowhead-alkkagi)"})})]})})});function Iu(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const gy=e=>{const{session:n,onAction:s,currentUser:l,isSpectator:r}=e,{id:a,settings:i,gameStatus:o,alkkagiStones:c,currentPlayer:d,player1:u,alkkagiStones_p1:p,alkkagiStones_p2:m,activeAlkkagiItems:h}=n,y=f.useRef(null),b=f.useRef(null),j=f.useRef(null),g=f.useRef(null),x=f.useRef(null),v=f.useRef(0),w=f.useRef(!1),k=f.useRef(null),P=f.useRef(null),S=f.useRef(0),[E,_]=f.useState(null),[C,I]=f.useState(null),[R,A]=f.useState(null),[O,L]=f.useState(0),[Q,D]=f.useState(null),[$,q]=f.useState(window.innerWidth<1024),z=f.useRef(e);f.useEffect(()=>{z.current=e});const W=Iu(n.turnStartTime),H=Iu(n.gameStatus),ne=f.useCallback(()=>{j.current&&(cancelAnimationFrame(j.current),j.current=null),g.current=null},[]),re=f.useCallback(()=>{w.current=!1,k.current=null,P.current=null,ne(),_(null),I(null),A(null),L(0),S.current=0},[ne]);f.useEffect(()=>{n.turnStartTime!==W&&re()},[n.turnStartTime,W,re]),f.useEffect(()=>{H==="alkkagi_animating"&&n.gameStatus!=="alkkagi_animating"&&D(null)},[n.gameStatus,H]),f.useEffect(()=>{const M=()=>q(window.innerWidth<1024);return window.addEventListener("resize",M),()=>window.removeEventListener("resize",M)},[]);const ce=f.useMemo(()=>n.blackPlayerId===l.id?B.Black:n.whitePlayerId===l.id?B.White:B.None,[n.blackPlayerId,n.whitePlayerId,l.id]),ve=f.useMemo(()=>r?!1:o==="alkkagi_simultaneous_placement"?!0:d===ce,[o,d,ce,r]),F=ce===B.White,X=f.useMemo(()=>{if(o==="alkkagi_simultaneous_placement"||o==="alkkagi_placement"){const M=l.id===u.id?p:m;return[...c||[],...M||[]]}return c||[]},[o,c,p,m,l.id,u.id]),ee=f.useMemo(()=>{var Y;const M=(n.alkkagiStones||[]).filter(ie=>ie.player===ce).length;if(n.gameStatus==="alkkagi_simultaneous_placement"||n.gameStatus==="alkkagi_placement"){const ie=((Y=l.id===n.player1.id?n.alkkagiStones_p1:n.alkkagiStones_p2)==null?void 0:Y.length)||0;return M+ie}return M},[n,l.id,ce]),xe=f.useCallback(M=>{const{session:Y,onAction:ie}=z.current;ie({type:"ALKKAGI_PLACE_STONE",payload:{gameId:Y.id,point:M}})},[]),J=f.useCallback(()=>{ne(),D(null),g.current=performance.now();const M=Y=>{var He;g.current||(g.current=Y);const{session:ie,currentUser:oe}=z.current,le=(((He=ie.activeAlkkagiItems)==null?void 0:He[oe.id])||[]).includes("slow"),ge=ie.settings.alkkagiGaugeSpeed||900,je=le?ge*2:ge,me=je/2,Ue=(Y-g.current)%je/me;let Le;Ue<=1?Le=Ue*100:Le=(2-Ue)*100,x.current&&(x.current.style.width=`${Le}%`),S.current=Le,j.current=requestAnimationFrame(M)};j.current=requestAnimationFrame(M)},[ne]),G=f.useCallback((M,Y,ie,oe)=>{b.current&&cancelAnimationFrame(b.current);let ue=JSON.parse(JSON.stringify(M||[])),le=ue.find(Le=>Le.id===Y);if(le)le.vx=ie,le.vy=oe;else return;const ge=840,je=.98;let me=0;const ke=1e3,Ue=()=>{var He;let Le=!1;for(const ae of ue)ae.onBoard&&(ae.x+=ae.vx,ae.y+=ae.vy,ae.vx*=je,ae.vy*=je,Math.abs(ae.vx)<.01&&(ae.vx=0),Math.abs(ae.vy)<.01&&(ae.vy=0),(Math.abs(ae.vx)>0||Math.abs(ae.vy)>0)&&(Le=!0),(ae.x<0||ae.x>ge||ae.y<0||ae.y>ge)&&ae.onBoard&&(ae.onBoard=!1,ae.timeOffBoard=Date.now(),Pe.stoneFallOff()));for(let ae=0;ae<ue.length;ae++)for(let Me=ae+1;Me<ue.length;Me++){const Te=ue[ae],We=ue[Me];if(!Te.onBoard||!We.onBoard)continue;const it=We.x-Te.x,Gt=We.y-Te.y,vt=Math.hypot(it,Gt),nn=Te.radius+We.radius;if(vt<nn){Pe.stoneCollision();const Ct=it/vt,jt=Gt/vt,pe=We.vx-Te.vx,de=We.vy-Te.vy,_e=pe*Ct+de*jt;if(_e<0){const Ie=_e;Te.vx+=Ie*Ct,Te.vy+=Ie*jt,We.vx-=Ie*Ct,We.vy-=Ie*jt}const Ne=(nn-vt)/2;Te.x-=Ne*Ct,Te.y-=Ne*jt,We.x+=Ne*Ct,We.y+=Ne*jt}}(He=y.current)==null||He.updateLocalStones(ue),me++,Le&&me<ke?b.current=requestAnimationFrame(Ue):b.current=null};b.current=requestAnimationFrame(Ue)},[]),K=f.useCallback((M,Y)=>{Y.preventDefault();const{session:ie,currentUser:oe}=z.current,ue=ie.blackPlayerId===oe.id?B.Black:ie.whitePlayerId===oe.id?B.White:B.None;if(!(ie.currentPlayer===ue)||ie.gameStatus!=="alkkagi_playing")return;const ge="touches"in Y?{x:Y.touches[0].clientX,y:Y.touches[0].clientY}:{x:Y.clientX,y:Y.clientY};w.current=!0,k.current=M,P.current=ge,_(M.id),I(ge),A(ge),J()},[J]);f.useEffect(()=>{const M=oe=>{if(!w.current)return;"preventDefault"in oe&&oe.preventDefault();const ue="touches"in oe?{x:oe.touches[0].clientX,y:oe.touches[0].clientY}:{x:oe.clientX,y:oe.clientY};A(ue)},Y=oe=>{var Ue,Le;if(!w.current)return;const{session:ue,onAction:le}=z.current,ge=k.current,je=P.current,me="touches"in oe?{x:oe.changedTouches[0].clientX,y:oe.changedTouches[0].clientY}:{x:oe.clientX,y:oe.clientY};ne();const ke=S.current;if(D(ke),ge&&je&&me){const He=(Ue=y.current)==null?void 0:Ue.getSvg();if(!He){re();return}const ae=(Le=He.getScreenCTM())==null?void 0:Le.inverse();if(!ae){re();return}const Me=He.createSVGPoint();Me.x=je.x,Me.y=je.y;const Te=Me.matrixTransform(ae);Me.x=me.x,Me.y=me.y;const We=Me.matrixTransform(ae),it=We.x-Te.x,Gt=We.y-Te.y,vt=-it,nn=-Gt,Ct=ke/100*25,jt=Math.hypot(vt,nn);if(jt>0){const pe=vt/jt*Ct,de=nn/jt*Ct;le({type:"ALKKAGI_FLICK_STONE",payload:{gameId:ue.id,stoneId:ge.id,vx:pe,vy:de}})}}w.current=!1,k.current=null,P.current=null,_(null),I(null),A(null),L(0),S.current=0,setTimeout(()=>D(null),1500)},ie=oe=>{w.current&&(oe.preventDefault(),re())};return window.addEventListener("mousemove",M,{passive:!1}),window.addEventListener("touchmove",M,{passive:!1}),window.addEventListener("mouseup",Y),window.addEventListener("touchend",Y),window.addEventListener("contextmenu",ie),()=>{window.removeEventListener("mousemove",M),window.removeEventListener("touchmove",M),window.removeEventListener("mouseup",Y),window.removeEventListener("touchend",Y),window.removeEventListener("contextmenu",ie),ne(),b.current&&cancelAnimationFrame(b.current)}},[ne,re]),f.useEffect(()=>{const{session:M}=z.current,Y=M.animation;if((Y==null?void 0:Y.type)==="alkkagi_flick"&&Y.startTime>v.current){v.current=Y.startTime;const{stoneId:ie,vx:oe,vy:ue}=Y;G(M.alkkagiStones||[],ie,oe,ue)}},[n.animation,G]);const Z=Q!==null?Q:O,fe=n.settings.alkkagiStoneCount||5,we=f.useMemo(()=>E&&(c==null?void 0:c.find(M=>M.id===E))||null,[E,c]);return t.jsxs("div",{className:"relative w-full h-full flex items-center justify-center px-4 sm:px-6 lg:px-0",children:[t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 w-3/4 max-w-md z-10 pointer-events-none",children:(C||Q!==null)&&t.jsxs("div",{className:`bg-gray-900/50 rounded-full h-6 border-2 border-gray-500 ${Q!==null?"animate-flick-power-pulse":""}`,children:[t.jsx("div",{ref:x,className:"bg-gradient-to-r from-yellow-400 to-red-500 h-full rounded-full",style:{width:`${Z}%`}}),t.jsx("span",{className:"absolute inset-0 w-full h-full flex items-center justify-center text-white font-bold text-sm drop-shadow-md",children:"POWER"})]})}),t.jsx("div",{className:`w-full h-full transition-transform duration-500 ${F?"rotate-180":""}`,children:t.jsx(py,{ref:y,stones:X,gameStatus:o,myPlayer:ce,isMyTurn:ve,settings:i,onPlacementClick:xe,onStoneInteractionStart:K,isSpectator:r,dragStartPoint:C,dragEndPoint:R,selectedStone:we,myStonesCount:ee,maxStones:fe,session:n,currentUser:l})})]})},hy=f.forwardRef((e,n)=>{const{stones:s,gameStatus:l,myPlayer:r,currentPlayer:a,onLaunchAreaInteractionStart:i,isSpectator:o,dragStartPoint:c,dragEndPoint:d,selectedStone:u,currentUser:p,session:m}=e,[h,y]=f.useState(s),b=f.useRef(null),j=840,g=19,x=j/g,v=x/2,w={x:j/2,y:j/2};f.useEffect(()=>{y(s)},[s]),f.useImperativeHandle(n,()=>({updateLocalStones:A=>{y([...A])},getSvg:()=>b.current}));const k=f.useMemo(()=>[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}],[g]),P=A=>({cx:v+A.x*x,cy:v+A.y*x}),S=f.useMemo(()=>{var xe,J;if(!c||!d||!u||!b.current)return null;const A=b.current,O=(xe=A.getScreenCTM())==null?void 0:xe.inverse();if(!O)return null;const L=A.createSVGPoint();L.x=c.x,L.y=c.y;const Q=L.matrixTransform(O);L.x=d.x,L.y=d.y;const D=L.matrixTransform(O),$=D.x-Q.x,q=D.y-Q.y,z=u,W={x:z.x,y:z.y};let H={x:W.x-$,y:W.y-q};const re=(((J=m.activeCurlingItems)==null?void 0:J[p.id])||[]).includes("aimingLine"),ce=80*.2,ve=re?ce*11:ce,F=H.x-W.x,X=H.y-W.y,ee=Math.hypot(F,X);return ee>ve&&(H.x=W.x+F/ee*ve,H.y=W.y+X/ee*ve),{start:W,end:H}},[c,d,u,m.activeCurlingItems,p.id]),E=()=>{const A=[x*6,x*4,x*2,x*.5],O=["rgba(0, 100, 255, 0.2)","rgba(255, 255, 255, 0.2)","rgba(255, 0, 0, 0.2)","white"];return t.jsxs("g",{children:[A.map((L,Q)=>t.jsx("circle",{cx:w.x,cy:w.y,r:L,fill:O[Q]},Q)),t.jsx("line",{x1:0,y1:w.y,x2:j,y2:w.y,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1"}),t.jsx("line",{x1:w.x,y1:0,x2:w.x,y2:j,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1"})]})},_=!o&&l==="curling_playing"&&r===a,I=1*x,R=[{x:v,y:v,player:B.White},{x:j-v-I,y:v,player:B.White},{x:v,y:j-v-I,player:B.Black},{x:j-v-I,y:j-v-I,player:B.Black}];return t.jsx("div",{className:"relative w-full h-full shadow-2xl rounded-lg overflow-hidden border-4 border-gray-800",children:t.jsxs("svg",{ref:b,viewBox:`0 0 ${j} ${j}`,className:"w-full h-full",children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"gloss-curling-1",children:[t.jsx("stop",{offset:"10%",stopColor:"#333"}),t.jsx("stop",{offset:"95%",stopColor:"#000"})]}),t.jsxs("radialGradient",{id:"gloss-curling-2",children:[t.jsx("stop",{offset:"10%",stopColor:"#fff"}),t.jsx("stop",{offset:"95%",stopColor:"#ccc"})]}),t.jsx("marker",{id:"arrowhead-curling",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"rgba(239, 68, 68, 0.9)"})})]}),t.jsx("rect",{width:j,height:j,fill:"#DDAA77"}),Array.from({length:g}).map((A,O)=>t.jsxs("g",{children:[t.jsx("line",{x1:v+O*x,y1:v,x2:v+O*x,y2:j-v,stroke:"#54432a",strokeWidth:"1.5"}),t.jsx("line",{x1:v,y1:v+O*x,x2:j-v,y2:v+O*x,stroke:"#54432a",strokeWidth:"1.5"})]},O)),k.map((A,O)=>t.jsx("circle",{...P(A),r:5,fill:"#54432a"},O)),E(),R.map((A,O)=>{const L=_&&A.player===r,Q=[L?"cursor-pointer":"cursor-default",L?"animate-pulse-white":""].filter(Boolean).join(" ");return t.jsx("rect",{x:A.x,y:A.y,width:I,height:I,fill:L?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.03)",stroke:L?"rgba(255, 255, 255, 0.8)":"rgba(255, 255, 255, 0.1)",strokeWidth:L?3:2,rx:"5",className:Q,onMouseDown:L?D=>i(D,A):void 0,onTouchStart:L?D=>{D.preventDefault(),i(D,A)}:void 0},`launch-area-${O}`)}),h.map(A=>A.onBoard?t.jsxs("g",{children:[t.jsx("circle",{cx:A.x,cy:A.y,r:A.radius,fill:A.player===B.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:A.x,cy:A.y,r:A.radius,fill:`url(#gloss-curling-${A.player})`})]},A.id):null),u&&S&&t.jsxs("g",{opacity:"0.7",children:[t.jsx("circle",{cx:u.x,cy:u.y,r:u.radius,fill:u.player===B.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:u.x,cy:u.y,r:u.radius,fill:`url(#gloss-curling-${u.player})`})]}),S&&t.jsx("g",{style:{pointerEvents:"none"},children:t.jsx("line",{x1:S.start.x,y1:S.start.y,x2:S.end.x,y2:S.end.y,stroke:"rgba(239, 68, 68, 0.7)",strokeWidth:"4",strokeDasharray:"8 4",markerEnd:"url(#arrowhead-curling)"})})]})})});function Pu(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const yy=f.forwardRef((e,n)=>{const{session:s,onAction:l,currentUser:r,isSpectator:a}=e,{id:i,settings:o,gameStatus:c,curlingStones:d,currentPlayer:u,activeCurlingItems:p}=s,m=f.useRef(null),h=f.useRef(null),y=f.useRef(null),b=f.useRef(null),j=f.useRef(null),g=f.useRef(0),x=f.useRef(0),v=f.useRef(!1),w=f.useRef(null),k=f.useRef(null),[P,S]=f.useState(null),[E,_]=f.useState(null),[C,I]=f.useState(null),[R,A]=f.useState(0),[O,L]=f.useState(null),[Q,D]=f.useState(!1),[$,q]=f.useState(window.innerWidth<1024),z=f.useRef(e);f.useEffect(()=>{z.current=e});const W=f.useMemo(()=>s.blackPlayerId===r.id?B.Black:s.whitePlayerId===r.id?B.White:B.None,[s.blackPlayerId,s.whitePlayerId,r.id]);f.useMemo(()=>a?!1:u===W,[u,W,a]);const H=W===B.White,ne=Pu(s.gameStatus),re=Pu(s.turnStartTime);f.useEffect(()=>{s.turnStartTime!==re&&L(null)},[s.turnStartTime,re]),f.useEffect(()=>{ne==="curling_animating"&&s.gameStatus!=="curling_animating"&&(S(null),h.current&&(cancelAnimationFrame(h.current),h.current=null))},[s.gameStatus,ne]),f.useEffect(()=>{const J=()=>q(window.innerWidth<1024);return window.addEventListener("resize",J),()=>window.removeEventListener("resize",J)},[]);const ce=f.useCallback(()=>{y.current&&(cancelAnimationFrame(y.current),y.current=null),b.current=null},[]),ve=f.useCallback(()=>{v.current=!1,w.current=null,k.current=null,ce(),_(null),I(null),A(0),L(null),D(!1),x.current=0},[ce]),F=f.useCallback(()=>{ce(),L(null),b.current=performance.now();const J=G=>{var ge;b.current||(b.current=G);const{session:K,currentUser:Z}=z.current,we=(((ge=K.activeCurlingItems)==null?void 0:ge[Z.id])||[]).includes("slow"),M=K.settings.curlingGaugeSpeed||700,Y=we?M*2:M,ie=Y/2,ue=(G-b.current)%Y/ie;let le;ue<=1?le=ue*100:le=(2-ue)*100,j.current&&(j.current.style.width=`${le}%`),x.current=le,y.current=requestAnimationFrame(J)};y.current=requestAnimationFrame(J)},[ce]),X=f.useCallback((J,G,K)=>{h.current&&cancelAnimationFrame(h.current);let Z=JSON.parse(JSON.stringify(J||[])),fe={...G,vx:K.x,vy:K.y,onBoard:!0};Z.push(fe),S(Z);const we=840,M=.98;let Y=0;const ie=1e3,oe=()=>{let ue=!1;for(const le of Z)le.onBoard&&(le.x+=le.vx,le.y+=le.vy,le.vx*=M,le.vy*=M,Math.abs(le.vx)<.01&&(le.vx=0),Math.abs(le.vy)<.01&&(le.vy=0),(Math.abs(le.vx)>0||Math.abs(le.vy)>0)&&(ue=!0),(le.x<0||le.x>we||le.y<0||le.y>we)&&le.onBoard&&(le.onBoard=!1,le.timeOffBoard=Date.now(),Pe.stoneFallOff()));for(let le=0;le<Z.length;le++)for(let ge=le+1;ge<Z.length;ge++){const je=Z[le],me=Z[ge];if(!je.onBoard||!me.onBoard)continue;const ke=me.x-je.x,Ue=me.y-je.y,Le=Math.hypot(ke,Ue),He=je.radius+me.radius;if(Le<He){Pe.stoneCollision();const ae=ke/Le,Me=Ue/Le,Te=me.vx-je.vx,We=me.vy-je.vy,it=Te*ae+We*Me;if(it<0){const vt=it;je.vx+=vt*ae,je.vy+=vt*Me,me.vx-=vt*ae,me.vy-=vt*Me}const Gt=(He-Le)/2;je.x-=Gt*ae,je.y-=Gt*Me,me.x+=Gt*ae,me.y+=Gt*Me}}S([...Z]),Y++,ue&&Y<ie?h.current=requestAnimationFrame(oe):h.current=null};h.current=requestAnimationFrame(oe)},[]),ee=f.useCallback((J,G)=>{const{session:K,currentUser:Z}=z.current,fe=K.blackPlayerId===Z.id?B.Black:K.whitePlayerId===Z.id?B.White:B.None;if(!(K.currentPlayer===fe)||K.gameStatus!=="curling_playing")return;v.current=!0;const M=840/19*.47,Y={id:Date.now(),player:fe,x:G.x+M,y:G.y+M,vx:0,vy:0,radius:M,onBoard:!1};w.current=Y;const ie="touches"in J?{x:J.touches[0].clientX,y:J.touches[0].clientY}:{x:J.clientX,y:J.clientY};k.current=ie,_(ie),I(ie),D(!0),F()},[F]);f.useEffect(()=>{const J=Z=>{if(!v.current)return;"touches"in Z&&Z.preventDefault();const fe="touches"in Z?{x:Z.touches[0].clientX,y:Z.touches[0].clientY}:{x:Z.clientX,y:Z.clientY};I(fe)},G=()=>{if(!v.current)return;const{session:Z,onAction:fe}=z.current,we=w.current,M=k.current;ce();const Y=x.current;L(Y),I(ie=>{var oe,ue;if(we&&M&&ie){const le=(oe=m.current)==null?void 0:oe.getSvg();if(!le)return console.error("SVG element not found for coordinate conversion."),ve(),null;const ge=(ue=le.getScreenCTM())==null?void 0:ue.inverse();if(!ge)return console.error("Could not get CTM for coordinate conversion."),ve(),null;const je=le.createSVGPoint();je.x=M.x,je.y=M.y;const me=je.matrixTransform(ge);je.x=ie.x,je.y=ie.y;const ke=je.matrixTransform(ge),Ue=ke.x-me.x,Le=ke.y-me.y,He=-Ue,ae=-Le,Me=Y/100*25,Te=Math.hypot(He,ae);if(Te>0){const We=He/Te*Me,it=ae/Te*Me;fe({type:"CURLING_FLICK_STONE",payload:{gameId:Z.id,launchPosition:{x:we.x,y:we.y},velocity:{x:We,y:it}}})}}return v.current=!1,w.current=null,k.current=null,_(null),D(!1),null}),A(0),x.current=0,setTimeout(()=>L(null),1500)},K=Z=>{v.current&&(Z.preventDefault(),ve())};return window.addEventListener("mousemove",J),window.addEventListener("touchmove",J,{passive:!1}),window.addEventListener("mouseup",G),window.addEventListener("touchend",G),window.addEventListener("contextmenu",K),()=>{window.removeEventListener("mousemove",J),window.removeEventListener("touchmove",J),window.removeEventListener("mouseup",G),window.removeEventListener("touchend",G),window.removeEventListener("contextmenu",K),ce(),h.current&&cancelAnimationFrame(h.current)}},[ce,ve]),f.useEffect(()=>{const{session:J}=z.current,G=J.animation;if((G==null?void 0:G.type)==="curling_flick"&&G.startTime>g.current){g.current=G.startTime;const{stone:K,velocity:Z}=G;X(J.curlingStones||[],K,Z)}},[s.animation,X]);const xe=O!==null?O:R;return t.jsxs("div",{className:"relative w-full h-full flex items-center justify-center px-4 sm:px-6 lg:px-0",children:[t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 w-3/4 max-w-md z-10 pointer-events-none",children:(E||O!==null)&&t.jsxs("div",{className:`bg-gray-900/50 rounded-full h-6 border-2 border-gray-500 ${O!==null?"animate-flick-power-pulse":""}`,children:[t.jsx("div",{ref:j,className:"bg-gradient-to-r from-yellow-400 to-red-500 h-full rounded-full",style:{width:`${xe}%`}}),t.jsx("span",{className:"absolute inset-0 w-full h-full flex items-center justify-center text-white font-bold text-sm drop-shadow-md",children:"POWER"})]})}),t.jsx("div",{className:`w-full h-full transition-transform duration-500 ${H?"rotate-180":""}`,children:t.jsx(hy,{ref:m,stones:P??d??[],gameStatus:c,myPlayer:W,currentPlayer:u,onLaunchAreaInteractionStart:ee,isSpectator:a,dragStartPoint:E,dragEndPoint:C,selectedStone:Q?w.current:null,activeCurlingItems:s.activeCurlingItems,currentUser:r,session:s})})]})}),by=(e,n,s,l,r)=>{const{x:a,y:i,player:o}=n,c=e.length,d=o===B.Black?B.White:B.Black;if(i<0||i>=c||a<0||a>=c||e[i][a]!==B.None)return{isValid:!1,reason:"occupied",newBoardState:e,capturedStones:[],newKoInfo:s};if(s&&s.point.x===a&&s.point.y===i&&s.turn===l)return{isValid:!1,reason:"ko",newBoardState:e,capturedStones:[],newKoInfo:s};const u=JSON.parse(JSON.stringify(e));u[i][a]=o;const p=(x,v)=>{const w=[];return x>0&&w.push({x:x-1,y:v}),x<c-1&&w.push({x:x+1,y:v}),v>0&&w.push({x,y:v-1}),v<c-1&&w.push({x,y:v+1}),w},m=(x,v,w,k)=>{var C;if(((C=k[v])==null?void 0:C[x])!==w)return null;const P=[{x,y:v}],S=new Set([`${x},${v}`]),E=new Set,_=[{x,y:v}];for(;P.length>0;){const{x:I,y:R}=P.shift();for(const A of p(I,R)){const O=`${A.x},${A.y}`,L=k[A.y][A.x];L===B.None?E.add(O):L===w&&(S.has(O)||(S.add(O),P.push(A),_.push(A)))}}return{stones:_,liberties:E.size}};let h=[],y=null;const b=new Set;for(const x of p(a,i)){const v=`${x.x},${x.y}`;if(u[x.y][x.x]===d&&!b.has(v)){const w=m(x.x,x.y,d,u);w&&w.liberties===0&&(h.push(...w.stones),w.stones.length===1&&(y=w.stones[0]),w.stones.forEach(k=>b.add(`${k.x},${k.y}`)))}}if(h.length>0)for(const x of h)u[x.y][x.x]=B.None;const j=m(a,i,o,u);if(j&&j.liberties===0)return{isValid:!1,reason:"suicide",newBoardState:e,capturedStones:[],newKoInfo:s};let g=null;return j&&h.length===1&&j.stones.length===1&&j.liberties===1&&(g={point:y,turn:l+1}),{isValid:!0,newBoardState:u,capturedStones:h,newKoInfo:g}},Ex=e=>{const{boardState:n,settings:{boardSize:s}}=e,l=(d,u)=>{const p=e.currentPlayer,m=by(e.boardState,{x:d,y:u,player:p},e.koInfo,e.moveHistory.length);return m.isValid&&(e.boardState=m.newBoardState,e.captures[p]+=m.capturedStones.length,e.koInfo=m.newKoInfo),m},r=(d,u)=>{const p=[];return d>0&&p.push({x:d-1,y:u}),d<s-1&&p.push({x:d+1,y:u}),u>0&&p.push({x:d,y:u-1}),u<s-1&&p.push({x:d,y:u+1}),p},a=(d,u,p,m)=>{var g;if(u<0||u>=s||d<0||d>=s||((g=m[u])==null?void 0:g[d])!==p)return null;const h=[{x:d,y:u}],y=new Set([`${d},${u}`]),b=new Set,j=[{x:d,y:u}];for(;h.length>0;){const{x,y:v}=h.shift();for(const w of r(x,v)){const k=`${w.x},${w.y}`,P=m[w.y][w.x];P===B.None?b.add(k):P===p&&(y.has(k)||(y.add(k),h.push(w),j.push(w)))}}return{stones:j,liberties:b.size,libertyPoints:b,player:p}};return{getScore:()=>{const d={[B.Black]:0,[B.White]:0,[B.None]:0},u=Array(s).fill(0).map(()=>Array(s).fill(!1));for(let p=0;p<s;p++)for(let m=0;m<s;m++)if(n[p][m]!==B.None)d[n[p][m]]++;else if(!u[p][m]){const h=[{x:m,y:p}];u[p][m]=!0;const y=[{x:m,y:p}];let b=!1,j=!1;for(;h.length>0;){const g=h.shift();for(const x of r(g.x,g.y))u[x.y][x.x]||(n[x.y][x.x]===B.None?(u[x.y][x.x]=!0,h.push(x),y.push(x)):n[x.y][x.x]===B.Black?b=!0:j=!0)}b&&!j?d[B.Black]+=y.length:j&&!b&&(d[B.White]+=y.length)}return d[B.Black]+=e.captures[B.Black],d[B.White]+=e.captures[B.White],{score:{black:d[B.Black],white:d[B.White]}}},findGroup:a,getAllLibertiesOfPlayer:(d,u)=>{const p=new Set,m=new Set;for(let h=0;h<s;h++)for(let y=0;y<s;y++){const b=`${y},${h}`;if(u[h][y]===d&&!m.has(b)){const j=a(y,h,d,u);j&&(j.stones.forEach(g=>m.add(`${g.x},${g.y}`)),j.libertyPoints.forEach(g=>p.add(g)))}}return Array.from(p).map(h=>{const[y,b]=h.split(",").map(Number);return{x:y,y:b}})},getNeighbors:r,getAllGroups:(d,u)=>{const p=[],m=new Set;for(let h=0;h<s;h++)for(let y=0;y<s;y++)if(u[h][y]===d&&!m.has(`${y},${h}`)){const b=a(y,h,d,u);b&&(p.push(b),b.stones.forEach(j=>m.add(`${j.x},${j.y}`)))}return p},placeStone:l}},vy=e=>{const{session:n,onAction:s,currentUser:l,isSpectator:r,isMyTurn:a,isMobile:i,showLastMoveMarker:o}=e,{id:c,boardState:d,settings:u,lastMove:p,winningLine:m,gameStatus:h,currentPlayer:y,blackPlayerId:b,whitePlayerId:j,player1:g,player2:x,animation:v,lastTurnStones:w}=n,k=b===l.id?B.Black:B.White,P=[g,x],S=P.find(I=>I.id===b)||null,E=P.find(I=>I.id===j)||null,_=f.useMemo(()=>{if(h!=="dice_placing"||!a)return[];if(!d.flat().some(R=>R===B.White)){const R=[];for(let A=0;A<u.boardSize;A++)for(let O=0;O<u.boardSize;O++)d[A][O]===B.None&&R.push({x:O,y:A});return R}return Ex(n).getAllLibertiesOfPlayer(B.White,d)},[n,h,a,d,u.boardSize]),C=(I,R)=>{!a||h!=="dice_placing"||!_.some(O=>O.x===I&&O.y===R)||s({type:"DICE_PLACE_STONE",payload:{gameId:c,x:I,y:R}})};return t.jsx("div",{className:"relative w-full h-full flex flex-col items-center justify-center",children:t.jsx(qa,{boardState:d,boardSize:u.boardSize,onBoardClick:C,lastMove:p,lastTurnStones:w,isBoardDisabled:!a||h!=="dice_placing",stoneColor:B.Black,winningLine:m,mode:n.mode,mixedModes:n.settings.mixedModes,myPlayerEnum:k,gameStatus:h,currentPlayer:y,highlightedPoints:_,highlightStyle:"ring",isSpectator:r,currentUser:l,blackPlayerNickname:(S==null?void 0:S.nickname)||"",whitePlayerNickname:(E==null?void 0:E.nickname)||"",isItemModeActive:!1,animation:v,isMobile:i,showLastMoveMarker:o})})},jy=e=>{const{session:n,onAction:s,currentUser:l,isMyTurn:r,isSpectator:a,isMobile:i,showLastMoveMarker:o}=e,{id:c,boardState:d,settings:u,lastMove:p,winningLine:m,gameStatus:h,currentPlayer:y,blackPlayerId:b,whitePlayerId:j,thiefPlayerId:g,player1:x,player2:v,lastTurnStones:w}=n,k=b===l.id?B.Black:j===l.id?B.White:B.None,P=l.id===g?"":"",S=[x,v],E=S.find(R=>R.id===b)||null,_=S.find(R=>R.id===j)||null,C=(R,A)=>{!r||h!=="thief_placing"||s({type:"THIEF_PLACE_STONE",payload:{gameId:c,x:R,y:A}})},I=f.useMemo(()=>{if(h!=="thief_placing"||!r)return[];const R=Ex(n),A=()=>{const O=[];for(let L=0;L<u.boardSize;L++)for(let Q=0;Q<u.boardSize;Q++)d[L][Q]===B.None&&O.push({x:Q,y:L});return O};if(P===""){const O=!d.flat().includes(B.Black);if(n.turnInRound===1||O)return A();if(d.flat().includes(B.Black)){const D=R.getAllLibertiesOfPlayer(B.Black,d);return D.length>0?D:A()}else return A()}else if(d.flat().includes(B.Black)){const L=R.getAllLibertiesOfPlayer(B.Black,d);return L.length>0?L:A()}else return A()},[h,r,n,d,P,u.boardSize]);return t.jsx("div",{className:"relative w-full h-full",children:t.jsx(qa,{boardState:d,boardSize:u.boardSize,onBoardClick:C,lastMove:p,lastTurnStones:w,isBoardDisabled:!r||h!=="thief_placing",stoneColor:k,winningLine:m,mode:n.mode,mixedModes:n.settings.mixedModes,myPlayerEnum:k,gameStatus:h,currentPlayer:y,highlightedPoints:I,isSpectator:a,currentUser:l,blackPlayerNickname:(E==null?void 0:E.nickname)||"",whitePlayerNickname:(_==null?void 0:_.nickname)||"",isItemModeActive:!1,isMobile:i,showLastMoveMarker:o})})},wy=e=>{const{session:n,currentUser:s,isSpectator:l,isMyTurn:r,myPlayerEnum:a,handleBoardClick:i,isMobile:o,showLastMoveMarker:c}=e,{boardState:d,settings:u,lastMove:p,winningLine:m,gameStatus:h,currentPlayer:y,blackPlayerId:b,whitePlayerId:j,player1:g,player2:x,animation:v,blackPatternStones:w,whitePatternStones:k,lastTurnStones:P}=n,S=g.id===b?g:x,E=g.id===j?x:g;return t.jsx("div",{className:"relative w-full h-full flex flex-col items-center justify-center",children:t.jsx(qa,{boardState:d,boardSize:u.boardSize,onBoardClick:i,lastMove:p,lastTurnStones:P,isBoardDisabled:!r||l,stoneColor:a,winningLine:m,mode:n.mode,myPlayerEnum:a,gameStatus:h,currentPlayer:y,isSpectator:l,currentUser:s,blackPlayerNickname:S.nickname,whitePlayerNickname:E.nickname,animation:v,isMobile:o,showLastMoveMarker:c,blackPatternStones:w,whitePatternStones:k,isItemModeActive:!1})})},Eu=e=>{const{session:n}=e,{mode:s,isSinglePlayer:l}=n;if(l)return t.jsx(wy,{...e});switch(s){case T.Alkkagi:return t.jsx(gy,{...e});case T.Curling:return t.jsx(yy,{...e});case T.Dice:return t.jsx(vy,{...e});case T.Thief:return t.jsx(jy,{...e});case T.Standard:case T.Capture:case T.Speed:case T.Base:case T.Hidden:case T.Missile:case T.Mix:case T.Omok:case T.Ttamok:default:return t.jsx(xy,{...e})}},Ny=({session:e,onClose:n})=>{const{mode:s,settings:l,effectiveCaptureTargets:r}=e,a=(o,c)=>c!=null&&c!==""&&t.jsxs(Mn.Fragment,{children:[t.jsxs("div",{className:"font-semibold text-gray-400",children:[o,":"]}),t.jsx("div",{className:"whitespace-nowrap",children:c})]},o),i=f.useMemo(()=>{var u,p,m,h,y,b,j,g;const o=[],c=[T.Standard,T.Speed,T.Base,T.Hidden,T.Missile,T.Mix],d=[T.Alkkagi,T.Curling,T.Dice,T.Thief];if(o.push(a(" ",s)),[T.Alkkagi,T.Curling,T.Dice].includes(s)||o.push(a(" ",`${l.boardSize}x${l.boardSize}`)),c.includes(s)&&!((u=l.mixedModes)!=null&&u.includes(T.Base))&&o.push(a("",`${e.finalKomi??e.settings.komi??ux}`)),d.includes(s)||(l.timeLimit>0?(o.push(a("",`${l.timeLimit}`)),o.push(a("",s===T.Speed?`${l.timeIncrement} `:`${l.byoyomiTime} ${l.byoyomiCount}`))):o.push(a("",""))),s===T.Mix&&o.push(a(" ",(p=l.mixedModes)==null?void 0:p.join(", "))),(s===T.Omok||s===T.Ttamok)&&(o.push(a(" ",l.has33Forbidden?"":"")),o.push(a(" ",l.hasOverlineForbidden?"":""))),s===T.Ttamok&&o.push(a(" ",`${l.captureTarget}`)),s===T.Capture||s===T.Mix&&((m=l.mixedModes)!=null&&m.includes(T.Capture))){const x=r?`: ${r[B.Black]} / : ${r[B.White]}`:`${l.captureTarget} (/  )`;o.push(a(" ",x))}if((s===T.Base||s===T.Mix&&((h=l.mixedModes)!=null&&h.includes(T.Base)))&&o.push(a("",`${l.baseStones}`)),(s===T.Hidden||s===T.Mix&&((y=l.mixedModes)!=null&&y.includes(T.Hidden)))&&(o.push(a("",`${l.hiddenStoneCount}`)),o.push(a("",`${l.scanCount}`))),(s===T.Missile||s===T.Mix&&((b=l.mixedModes)!=null&&b.includes(T.Missile)))&&o.push(a("",`${l.missileCount}`)),s===T.Dice&&(o.push(a("",`${l.diceGoRounds}R`)),o.push(a(" ",`${l.oddDiceCount}`)),o.push(a(" ",`${l.evenDiceCount}`))),s===T.Alkkagi){const x=((j=So.find(v=>v.value===l.alkkagiGaugeSpeed))==null?void 0:j.label)||"";o.push(a("",`${l.alkkagiRounds}R`)),o.push(a(" ",`${l.alkkagiStoneCount}`)),o.push(a(" ",l.alkkagiPlacementType)),o.push(a(" ",l.alkkagiLayout)),o.push(a(" ",x)),o.push(a(" ",`${l.alkkagiSlowItemCount}`)),o.push(a(" ",`${l.alkkagiAimingLineItemCount}`))}if(s===T.Curling){const x=((g=Co.find(v=>v.value===l.curlingGaugeSpeed))==null?void 0:g.label)||"";o.push(a(" ",`${l.curlingStoneCount}`)),o.push(a(" ",x)),o.push(a(" ",`${l.curlingSlowItemCount}`)),o.push(a(" ",`${l.curlingAimingLineItemCount}`))}return o.filter(Boolean)},[e]);return t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md flex-shrink-0 border border-color",children:[t.jsxs("h3",{className:"text-base font-bold border-b border-gray-700 pb-1 mb-2 text-yellow-300 flex justify-between items-center",children:[" ",n&&t.jsx("button",{onClick:n,className:"text-xl font-bold text-gray-400 hover:text-white",children:""})]}),t.jsx("div",{className:"grid grid-cols-2 gap-x-3 gap-y-0.5 text-xs",children:i})]})},ky=({session:e,onlineUsers:n,currentUser:s,onClose:l,onAction:r,onViewUser:a})=>{const{player1:i,player2:o,blackPlayerId:c,whitePlayerId:d,gameStatus:u,isAiGame:p}=e,m=f.useMemo(()=>n.filter(x=>x.status==="in-game"&&x.gameId===e.id).sort((x,v)=>x.id===c?-1:v.id===c?1:0),[n,e.id,c]),h=f.useMemo(()=>n.filter(x=>x.status==="spectating"&&x.spectatingGameId===e.id),[n,e.id]),y=["ended","no_contest","rematch_pending"].includes(u),b=u==="rematch_pending",j=x=>{r({type:"REQUEST_REMATCH",payload:{opponentId:x,originalGameId:e.id}})},g=(x,v)=>{var E,_;const w=x.id===s.id,k=!w&&(x.id===i.id||x.id===o.id),P=(E=Ee.find(C=>C.id===x.avatarId))==null?void 0:E.url,S=(_=Re.find(C=>C.id===x.borderId))==null?void 0:_.url;return t.jsxs("div",{className:`flex items-center gap-2 p-1 rounded ${w?"bg-blue-900/50":""}`,children:[t.jsx(Ce,{userId:x.id,userName:x.nickname,size:28,avatarUrl:P,borderUrl:S}),t.jsxs("div",{className:`flex items-center gap-2 flex-grow overflow-hidden ${w?"":"cursor-pointer"}`,onClick:()=>!w&&a(x.id),title:w?"":`${x.nickname}  `,children:[t.jsx("span",{className:"font-semibold truncate text-sm",children:x.nickname}),y&&k&&!p&&t.jsx(U,{onClick:C=>{C==null||C.stopPropagation(),j(x.id)},disabled:b,colorScheme:"yellow",className:"!text-xs !py-0.5 !px-2 flex-shrink-0",children:b?"":""})]}),t.jsx("span",{className:"ml-auto text-xs text-gray-400 flex-shrink-0",children:v})]},x.id)};return t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md flex flex-col border border-color",children:[t.jsxs("h3",{className:"text-base font-bold border-b border-gray-700 pb-1 mb-2 text-yellow-300 flex-shrink-0 flex justify-between items-center",children:[" ",l&&t.jsx("button",{onClick:l,className:"text-xl font-bold text-gray-400 hover:text-white",children:""})]}),t.jsxs("div",{className:"space-y-0.5 overflow-y-auto pr-1 flex-grow",children:[m.map(x=>g(x,x.id===c?"":"")),h.map(x=>g(x,""))]})]})},Sy=e=>{const{session:n,isSpectator:s,onAction:l,waitingRoomChat:r,gameChat:a,onClose:i,onViewUser:o}=e,{mode:c}=n,{currentUserWithStatus:d,handlers:u}=De(),p=n.isAiGame,[m,h]=f.useState(p?"global":"game"),[y,b]=f.useState(""),[j,g]=f.useState(!1),[x,v]=f.useState(0),w=f.useRef(null),k=f.useRef(null),P=m==="game"?a:r;f.useEffect(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},[P]),f.useEffect(()=>{if(x>0){const D=setTimeout(()=>{v($=>Math.max(0,$-1))},1e3);return()=>clearTimeout(D)}},[x]),f.useEffect(()=>{const D=$=>{w.current&&!w.current.contains($.target)&&g(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]);const _=`[${Qe.some(D=>D.mode===c)?"":""}:${c}]`,C=D=>{if(s||x>0)return;const $=m==="game"?n.id:"global",q={channel:$,...D};$==="global"&&(q.location=_),l({type:"SEND_CHAT_MESSAGE",payload:q}),g(!1),b(""),v(5)},I=D=>{if(D.preventDefault(),y.trim()){if(Yl(y)){alert("       ."),b("");return}C({text:y})}};if(!d)return null;const R=D=>{d.isAdmin&&D!==d.id?u.openModerationModal(D):D!==d.id&&o(D)},A=(d.chatBanUntil??0)>Date.now(),O=A?Math.ceil((d.chatBanUntil-Date.now())/1e3/60):0,L=A||x>0,Q=A?`   (${O} )`:L?`(${x})`:"[ ]";return t.jsxs("div",{className:"flex flex-col h-full bg-gray-800 p-2 rounded-md border border-color",children:[p?t.jsx("h3",{className:"text-base font-bold border-b border-gray-700 pb-1 mb-2 text-yellow-300 flex-shrink-0",children:""}):t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-2 flex-shrink-0",children:[t.jsx("button",{onClick:()=>h("game"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md ${m==="game"?"bg-blue-600":"text-gray-400"}`,children:""}),t.jsx("button",{onClick:()=>h("global"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md ${m==="global"?"bg-blue-600":"text-gray-400"}`,children:""})]}),t.jsxs("div",{ref:k,className:"flex-grow space-y-1 overflow-y-auto pr-2 mb-2 bg-gray-900/40 p-1.5 rounded-md min-h-0",children:[P.map(D=>{const $=D.system&&!D.actionInfo&&D.user.nickname==="AI ";return t.jsx("div",{className:"text-sm",children:D.actionInfo?t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"font-semibold text-gray-400 pr-2",children:[D.user.nickname,":"]}),t.jsx("span",{className:"text-yellow-400",children:D.actionInfo.message}),t.jsx("span",{className:"text-gray-400",children:" ( "}),t.jsx("span",{className:D.actionInfo.scoreChange>0?"text-blue-400 font-bold":"text-red-400 font-bold",children:D.actionInfo.scoreChange>0?`+${D.actionInfo.scoreChange}`:D.actionInfo.scoreChange}),t.jsx("span",{className:"text-gray-400",children:")"})]}):t.jsxs(t.Fragment,{children:[D.location&&t.jsx("span",{className:"font-semibold text-gray-500 pr-1",children:D.location}),t.jsxs("span",{className:`font-semibold pr-2 ${D.system?"text-yellow-400":"text-gray-400 cursor-pointer hover:underline"}`,onClick:()=>!D.system&&R(D.user.id),title:D.system?"":`${D.user.nickname}   / `,children:[D.system?$?"AI ":"":D.user.nickname,":"]}),D.text&&t.jsxs("span",{className:$?"text-yellow-400":"",children:[D.text,$&&" "]}),D.emoji&&t.jsx("span",{className:"text-xl",children:D.emoji})]})},D.id)}),P.length===0&&t.jsx("div",{className:"h-full flex items-center justify-center text-gray-500 text-sm",children:"  ."})]}),!s&&t.jsxs("div",{className:"relative flex-shrink-0",children:[j&&t.jsxs("div",{ref:w,className:"absolute bottom-full mb-2 w-full bg-gray-600 rounded-lg shadow-xl p-2 z-10 max-h-64 overflow-y-auto",children:[t.jsx("div",{className:"grid grid-cols-5 gap-2 text-2xl mb-2 border-b border-gray-500 pb-2",children:yx.map(D=>t.jsxs("button",{onClick:()=>C({emoji:D}),className:"w-full p-2 rounded-md hover:bg-blue-600 transition-colors text-center",children:[" ",D," "]},D))}),t.jsx("ul",{className:"space-y-1",children:hx.map(D=>t.jsxs("li",{children:[" ",t.jsxs("button",{onClick:()=>C({text:D}),className:"w-full text-left text-sm p-2 rounded-md hover:bg-blue-600 transition-colors",children:[" ",D," "]})," "]},D))})]}),t.jsxs("form",{onSubmit:I,className:"flex gap-2",children:[t.jsx("button",{type:"button",onClick:()=>g(D=>!D),className:"bg-gray-700 hover:bg-gray-600 text-white font-bold px-2.5 rounded-md transition-colors text-lg flex items-center justify-center",title:" ",disabled:L,children:t.jsx("span",{children:""})}),t.jsx("input",{type:"text",value:y,onChange:D=>b(D.target.value),placeholder:Q,className:"flex-grow bg-gray-900 border border-gray-600 rounded-md p-1.5 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-800 disabled:text-gray-500",maxLength:30,disabled:L}),t.jsx(U,{type:"submit",disabled:!y.trim()||L,className:"!px-2.5 !py-1.5",title:"",children:""})]})]})]})},Mu=e=>{const{session:n,onLeaveOrResign:s,isNoContestLeaveAvailable:l,isSpectator:r}=e,{gameStatus:a}=n,i=["ended","no_contest","rematch_pending"].includes(a),o=l?"":i?"":r?"":"",c=l?"yellow":"red";return t.jsxs("div",{className:"flex flex-col h-full gap-1.5 bg-gray-900/80 rounded-lg p-2 border border-color",children:[t.jsxs("div",{className:"flex-shrink-0 space-y-2",children:[t.jsx(Ny,{session:n,onClose:e.onClose}),t.jsx(ky,{...e})]}),t.jsx("div",{className:"flex-1 mt-2 min-h-0",children:t.jsx(Sy,{...e})}),t.jsx("div",{className:"flex-shrink-0 pt-2",children:t.jsx(U,{onClick:s,colorScheme:c,className:"w-full",children:o})})]})},Cy=e=>{e<0&&(e=0);const n=Math.floor(e/60),s=Math.floor(e%60);return`${String(n).padStart(2,"0")}:${String(s).padStart(2,"0")}`},Iy=({count:e,target:n,panelType:s,mode:l})=>{const r=typeof n=="number"&&n>0?`${e}/${n}`:`${e}`,a=l===T.Dice;let i=" ";a?i=" ":[T.Thief,T.Curling].includes(l)&&(i="");const o="flex flex-col items-center justify-center w-[clamp(4.5rem,16vmin,6rem)] rounded-lg shadow-lg border-2 p-1 text-center h-full";let c="",d="text-gray-300",u="text-white";return s==="white"?(c="bg-gradient-to-br from-gray-50 to-gray-200 border-gray-400",d="text-gray-700",u="text-black"):c="bg-gradient-to-br from-gray-800 to-black border-gray-600",t.jsxs("div",{className:`${o} ${c}`,children:[t.jsx("span",{className:`${d} text-[clamp(0.6rem,2vmin,0.75rem)] font-semibold whitespace-nowrap`,children:i}),a?t.jsxs("div",{className:`font-mono font-bold text-[clamp(1rem,5vmin,2rem)] tracking-tighter my-1 ${u} flex items-center justify-center gap-1`,children:[t.jsx("div",{className:"w-[clamp(0.8rem,3vmin,1rem)] h-[clamp(0.8rem,3vmin,1rem)] rounded-full bg-white border border-black inline-block flex-shrink-0"}),t.jsx("span",{children:r})]}):t.jsx("span",{className:`font-mono font-bold text-[clamp(1rem,5vmin,2rem)] tracking-tighter my-1 ${u}`,children:r})]})},Py=({timeLeft:e,totalTime:n,byoyomiTime:s,byoyomiPeriods:l,totalByoyomi:r,isActive:a,isInByoyomi:i,isFoulMode:o=!1,isLeft:c})=>{const d=f.useMemo(()=>{if(o){const m=n>0?n:s;return m>0?e/m*100:0}return i?s>0?e/s*100:0:n>0?e/n*100:0},[e,n,s,i,o]),u=c?"right-1":"left-1",p=c?"justify-end":"justify-start";return t.jsxs("div",{className:"w-full relative",children:[t.jsx("div",{className:`w-full h-1.5 rounded-full transition-colors ${i||o?"bg-red-900/70":"bg-gray-700"}`,children:t.jsx("div",{className:`h-1.5 rounded-full ${i||o?"bg-red-500":"bg-blue-500"} ${a&&e<5?"animate-pulse":""}`,style:{width:`${Math.min(100,d)}%`,transition:"width 0.2s linear"}})}),(r>0||o)&&t.jsx("div",{className:`absolute ${u} top-1/2 -translate-y-1/2 flex items-center ${p} gap-1 sm:gap-1.5`,children:o?t.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:l}).map((m,h)=>t.jsx("span",{className:"text-base leading-none",title:`${l} fouls remaining`,children:""},h))}):t.jsxs("div",{className:"flex items-center gap-1 text-yellow-300",children:[t.jsx("span",{className:"text-base",children:""}),t.jsx("span",{className:"text-sm font-bold",children:l})]})})]})},Tu=e=>{var ie,oe;const{user:n,playerEnum:s,score:l,isActive:r,timeLeft:a,totalTime:i,mainTimeLeft:o,byoyomiPeriodsLeft:c,totalByoyomi:d,byoyomiTime:u,isLeft:p,session:m,captureTarget:h,role:y,isAiPlayer:b,mode:j,isSinglePlayer:g}=e,{gameStatus:x,winner:v,blackPlayerId:w,whitePlayerId:k}=m,P=f.useMemo(()=>{var ue;return(ue=Ee.find(le=>le.id===n.avatarId))==null?void 0:ue.url},[n.avatarId]),S=f.useMemo(()=>{var ue;return(ue=Re.find(le=>le.id===n.borderId))==null?void 0:ue.url},[n.borderId]),E=Qe.some(ue=>ue.mode===j),_=nt.some(ue=>ue.mode===j)&&![T.Omok,T.Ttamok].includes(j),C=j===T.Curling,I=_?i:u,R=E?n.strategyLevel:n.playfulLevel,O=`${E?"":""} Lv.${R}`,L=p?"flex-row":"flex-row-reverse",Q=p?"text-left":"text-right",D=p?"justify-start":"justify-end",$=["ended","no_contest","rematch_pending"].includes(x),q=v===B.Black&&w===n.id||v===B.White&&k===n.id,z=(v===B.Black||v===B.White)&&!q,W=!_&&o<=0&&d>0,H=u0,ne=_?H:d,re=_?H-(((ie=m.timeoutFouls)==null?void 0:ie[n.id])||0):c,ce=j===T.Dice,ve=ce||s===B.Black,F=!ce&&s===B.White,X=ve?"black":F?"white":"neutral";let ee="",xe="",J="",G="";g?(ee=r&&!$?"bg-stone-800 ring-2 ring-amber-400 border-stone-600":"bg-stone-900/50 border-stone-700",xe="text-stone-100",J="text-stone-400",G="text-stone-200"):X==="black"?(ee=r&&!$?"bg-gray-800 ring-2 ring-blue-400 border-gray-600":"bg-black/50 border-gray-700",xe="text-white",J="text-gray-400",G="text-gray-200"):X==="white"?(ee=r&&!$?"bg-gray-300 ring-2 ring-blue-500 border-blue-500":"bg-gray-200 border-gray-400",xe="text-black",J="text-gray-600",G="text-gray-800"):(ee=r&&!$?"bg-blue-900/50 ring-2 ring-blue-400":"bg-gray-800/30",xe="text-white",J="text-gray-400",G="text-gray-200");const fe=q?g?"text-amber-300":ve?"text-yellow-300":"text-yellow-600":z?g?"text-stone-500":"text-gray-500":xe,we=m.settings.curlingStoneCount||5,M=((oe=m.stonesThrownThisRound)==null?void 0:oe[n.id])||0,Y=we-M;return t.jsxs("div",{className:`flex items-stretch gap-2 flex-1 ${L} p-1 rounded-lg transition-all duration-300 border ${ee}`,children:[t.jsxs("div",{className:`flex flex-col ${Q} flex-grow justify-between min-w-0`,children:[t.jsxs("div",{className:`flex items-center gap-2 ${p?"":"flex-row-reverse"}`,children:[t.jsx(Ce,{userId:n.id,userName:n.nickname,size:48,avatarUrl:P,borderUrl:S}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs("div",{className:`flex items-baseline gap-2 ${D}`,children:[!p&&$&&q&&t.jsx("span",{className:"text-2xl font-black text-blue-400",children:""}),!p&&$&&z&&t.jsx("span",{className:"text-2xl font-black text-red-400",children:""}),t.jsxs("h2",{className:`font-bold text-[clamp(0.8rem,3vmin,1.125rem)] leading-tight whitespace-nowrap ${fe}`,children:[n.nickname," ",b&&""," ",y&&`(${y})`]}),p&&$&&q&&t.jsx("span",{className:"text-2xl font-black text-blue-400",children:""}),p&&$&&z&&t.jsx("span",{className:"text-2xl font-black text-red-400",children:""})]}),t.jsx("p",{className:`text-[clamp(0.6rem,2vmin,0.75rem)] ${J}`,children:O}),C&&t.jsxs("div",{className:`flex items-center gap-3 text-xs mt-1 ${D} ${J}`,children:[t.jsxs("span",{children:[m.curlingRound||1,"/",m.settings.curlingRounds||3,"R"]}),t.jsxs("span",{className:"font-semibold",children:[" : ",Y]})]})]})]}),t.jsxs("div",{className:"mt-1",children:[t.jsx(Py,{timeLeft:a,totalTime:i,byoyomiTime:I,byoyomiPeriods:re,totalByoyomi:ne,isActive:r&&!$,isInByoyomi:W,isFoulMode:_,isLeft:p}),t.jsx("div",{className:`flex items-center mt-0.5 ${D}`,children:t.jsx("span",{className:`font-mono font-bold ${W||_&&a<10?"text-red-400":G} text-[clamp(1rem,3.5vmin,1.25rem)]`,children:Cy(a)})})]})]}),t.jsx(Iy,{count:l,target:h,panelType:X,mode:j})]})},Ey=(e,n,s)=>{if(!(nt.some(r=>r.mode===e)&&![T.Omok,T.Ttamok].includes(e)))return s.timeLimit*60;switch(e){case T.Alkkagi:return n==="alkkagi_placement"?c0:n==="alkkagi_simultaneous_placement"?d0:o0;case T.Curling:return m0;case T.Dice:return n==="dice_rolling"?Cr:n==="dice_placing"?nu:Cr;case T.Thief:return n==="thief_rolling"?Cr:n==="thief_placing"?nu:Cr;default:return s.timeLimit*60}},_u=e=>{var q,z;const{session:n,clientTimes:s,isSinglePlayer:l}=e,{player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,captures:c,mode:d,settings:u,effectiveCaptureTargets:p,scores:m,currentPlayer:h}=n,y=[T.Dice,T.Thief,T.Curling].includes(d),b=r,j=a,g=b.id===i?B.Black:b.id===o?B.White:B.None,x=j.id===i?B.Black:j.id===o?B.White:B.None,v=h===g&&g!==B.None,w=h===x&&x!==B.None,k=d===T.Curling?((q=n.curlingScores)==null?void 0:q[g])??0:y?(m==null?void 0:m[b.id])??0:c[g],P=d===T.Curling?((z=n.curlingScores)==null?void 0:z[x])??0:y?(m==null?void 0:m[j.id])??0:c[x],S=g===B.Black?s.black:g===B.White?s.white:u.timeLimit*60,E=x===B.Black?s.black:x===B.White?s.white:u.timeLimit*60,_=g===B.Black?n.blackTimeLeft:g===B.White?n.whiteTimeLeft:u.timeLimit*60,C=x===B.Black?n.blackTimeLeft:x===B.White?n.whiteTimeLeft:u.timeLimit*60,I=g===B.Black?n.blackByoyomiPeriodsLeft:g===B.White?n.whiteByoyomiPeriodsLeft:u.byoyomiCount,R=x===B.Black?n.blackByoyomiPeriodsLeft:x===B.White?n.whiteByoyomiPeriodsLeft:u.byoyomiCount,A=d===T.Thief?b.id===n.thiefPlayerId?"":"":void 0,O=d===T.Thief?j.id===n.thiefPlayerId?"":"":void 0,L=W=>{if(n.isSinglePlayer||d===T.Capture)return p==null?void 0:p[W];if(d===T.Ttamok)return u.captureTarget},Q=n.isAiGame&&b.id===el,D=n.isAiGame&&j.id===el,$=Ey(d,n.gameStatus,u);return t.jsxs("div",{className:"flex justify-between items-start gap-2 flex-shrink-0 h-full",children:[t.jsx(Tu,{user:b,playerEnum:g,score:k,isActive:v,timeLeft:S,totalTime:$,mainTimeLeft:_,byoyomiPeriodsLeft:I,totalByoyomi:u.byoyomiCount,byoyomiTime:u.byoyomiTime,isLeft:!0,session:n,captureTarget:L(g),role:A,isAiPlayer:Q,mode:d,isSinglePlayer:l}),t.jsx(Tu,{user:j,playerEnum:x,score:P,isActive:w,timeLeft:E,totalTime:$,mainTimeLeft:C,byoyomiPeriodsLeft:R,totalByoyomi:u.byoyomiCount,byoyomiTime:u.byoyomiTime,isLeft:!1,session:n,captureTarget:L(x),role:O,isAiPlayer:D,mode:d,isSinglePlayer:l})]})},My=(e,n)=>{const{winner:s,blackPlayerId:l,whitePlayerId:r,player1:a,player2:i}=e;return s===null||s===B.None||!(n.id===a.id||n.id===i.id)?null:s===B.Black&&n.id===l||s===B.White&&n.id===r},Pr=e=>Ec(e).rank,Ty=({initial:e,final:n,max:s,levelUp:l,xpGain:r,finalLevel:a})=>{const[i,o]=f.useState(0),[c,d]=f.useState(0),[u,p]=f.useState(!1),m=s>0?e/s*100:0,h=s>0?l?100:n/s*100:0,y=h-m;f.useEffect(()=>{o(m),d(0),p(!1);const j=setTimeout(()=>{p(!0),d(1),o(h);const g=setTimeout(()=>{d(0)},500);return()=>clearTimeout(g)},500);return()=>clearTimeout(j)},[e,n,s,l,m,h]);const b=`${r}-${e}`;return t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-sm font-bold w-16 text-right",children:["Lv.",a]}),t.jsxs("div",{className:"w-full bg-gray-700/50 rounded-full h-4 relative border border-gray-900/50 overflow-hidden",children:[t.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-full transition-all duration-1000 ease-out",style:{width:`${i}%`}}),t.jsx("div",{className:"absolute top-0 h-full bg-gradient-to-r from-green-400 to-green-500 rounded-r-full transition-opacity duration-500 ease-out pointer-events-none",style:{left:`${m}%`,width:`${y}%`,opacity:c}}),t.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-black/80 drop-shadow-sm",children:[n," / ",s]}),l&&t.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-white animate-pulse",style:{textShadow:"0 0 5px black"},children:"LEVEL UP!"})]}),u&&r>0&&t.jsxs("span",{className:"text-sm font-bold text-green-400 whitespace-nowrap animate-fade-in-xp w-20",children:["+",r," XP"]},b),t.jsx("style",{children:`
                @keyframes fadeInXp {
                    from { opacity: 0; transform: scale(0.8); }
                    to { opacity: 1; transform: scale(1); }
                }
                .animate-fade-in-xp {
                    animation: fadeInXp 0.5s ease-out forwards;
                }
            `})]})},_y=({analysis:e,session:n})=>{var c,d,u;const{scoreDetails:s}=e,{mode:l,settings:r}=n;if(!s)return t.jsx("p",{className:"text-center text-gray-400",children:"  ."});const a=l===T.Speed||l===T.Mix&&((c=r.mixedModes)==null?void 0:c.includes(T.Speed)),i=l===T.Base||l===T.Mix&&((d=r.mixedModes)==null?void 0:d.includes(T.Base)),o=l===T.Hidden||l===T.Mix&&((u=r.mixedModes)==null?void 0:u.includes(T.Hidden));return t.jsx("div",{className:"space-y-3 text-xs md:text-sm",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.black.territory.toFixed(0)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.black.deadStones??0})]}),i&&t.jsxs("div",{className:"flex justify-between text-blue-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.baseStoneBonus})]}),o&&t.jsxs("div",{className:"flex justify-between text-purple-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.hiddenStoneBonus})]}),a&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.timeBonus.toFixed(1)})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:s.black.total.toFixed(1)})]})]}),t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.white.territory.toFixed(0)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.white.deadStones??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.white.komi})]}),i&&t.jsxs("div",{className:"flex justify-between text-blue-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.baseStoneBonus})]}),o&&t.jsxs("div",{className:"flex justify-between text-purple-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.hiddenStoneBonus})]}),a&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.timeBonus.toFixed(1)})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:s.white.total.toFixed(1)})]})]})]})})},Ay=({gameSession:e})=>{const{scores:n,player1:s,player2:l,diceGoBonuses:r}=e,a=s.id,i=l.id,o=n[a]||0,c=n[i]||0,d=(r==null?void 0:r[a])||0,u=(r==null?void 0:r[i])||0,p=o-d,m=c-u;return d>0||u>0?t.jsx("div",{className:"space-y-3 text-xs md:text-sm",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:s.nickname}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:p})]}),d>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  :"})," ",t.jsxs("span",{className:"text-green-400",children:["+",d]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:o})]})]}),t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:l.nickname}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:m})]}),u>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  :"})," ",t.jsxs("span",{className:"text-green-400",children:["+",u]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:c})]})]})]})}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300",children:" "}),t.jsxs("p",{className:"text-5xl font-mono my-2",children:[o," : ",c]})]})},Ry=({gameSession:e})=>{var y,b,j,g;const{curlingScores:n,player1:s,player2:l,blackPlayerId:r,whitePlayerId:a}=e;if(!n)return t.jsx("p",{className:"text-center text-gray-400",children:"  ."});const i=r===s.id?s:l,o=a===s.id?s:l,c=n[B.Black]||0,d=n[B.White]||0,u=(y=Ee.find(x=>x.id===i.avatarId))==null?void 0:y.url,p=(b=Re.find(x=>x.id===i.borderId))==null?void 0:b.url,m=(j=Ee.find(x=>x.id===o.avatarId))==null?void 0:j.url,h=(g=Re.find(x=>x.id===o.borderId))==null?void 0:g.url;return t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-4",children:" "}),t.jsxs("div",{className:"flex items-center justify-center my-2",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2 w-32 flex-shrink-0",children:[t.jsx(Ce,{userId:i.id,userName:i.nickname,size:64,avatarUrl:u,borderUrl:p}),t.jsxs("span",{className:"font-bold mt-1 w-full truncate",children:[i.nickname," ()"]})]}),t.jsxs("p",{className:"text-5xl font-mono text-center flex-grow px-2",children:[c," : ",d]}),t.jsxs("div",{className:"flex flex-col items-center gap-2 w-32 flex-shrink-0",children:[t.jsx(Ce,{userId:o.id,userName:o.nickname,size:64,avatarUrl:m,borderUrl:h}),t.jsxs("span",{className:"font-bold mt-1 w-full truncate",children:[o.nickname," ()"]})]})]})]})},Ly=({session:e,currentUser:n,onConfirm:s})=>{var _,C,I,R,A;const{winner:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,winReason:c}=e,d=f.useRef(!1),u=My(e,n),p=(_=e.summary)==null?void 0:_[n.id],m=nt.some(O=>O.mode===e.mode),h=f.useMemo(()=>{var O;return(O=Ee.find(L=>L.id===n.avatarId))==null?void 0:O.url},[n.avatarId]),y=f.useMemo(()=>{var O;return(O=Re.find(L=>L.id===n.borderId))==null?void 0:O.url},[n.borderId]),b=(C=p==null?void 0:p.items)==null?void 0:C[0],j=b?ws.find(O=>O.name===b.name):null;f.useEffect(()=>{d.current||(u===!0?Pe.gameWin():u===!1&&Pe.gameLose(),p&&(p.level&&p.level.initial<p.level.final&&setTimeout(()=>Pe.levelUp(),800),p.manner&&Pr(p.manner.initial)!==Pr(p.manner.final)&&setTimeout(()=>Pe.levelUp(),900)),d.current=!0)},[u,p]);const g=l===B.None,x=l===B.Black?r.id===i?r:a:l===B.White?r.id===o?r:a:null,{title:v,color:w}=f.useMemo(()=>{if(g)return{title:"",color:"text-yellow-400"};if(u===null)return x?{title:`${x.nickname} `,color:"text-gray-300"}:{title:" ",color:"text-gray-300"};if(u){let O="";return c==="resign"&&(O=""),c==="timeout"&&(O=""),{title:O,color:"text-green-400"}}else{let O="";return c==="resign"&&(O=""),c==="timeout"&&(O=""),{title:O,color:"text-red-400"}}},[u,g,c,x]),k=(I=e.analysisResult)==null?void 0:I.system,P=()=>{if(m&&c==="resign"){const O=u?"  .":" .";return t.jsx("p",{className:"text-center text-lg",children:O})}if(c==="score")return k?t.jsx("div",{className:"w-full",children:t.jsx(_y,{analysis:k,session:e})}):t.jsx("p",{className:"text-center text-gray-400 animate-pulse",children:"  ..."});if(e.mode===T.Dice||e.mode===T.Thief)return t.jsx(Ay,{gameSession:e});if(e.mode===T.Curling)return t.jsx(Ry,{gameSession:e});if(e.mode===T.Omok||e.mode===T.Ttamok){let O="";if(c==="omok_win"?O=u?" ":"  ":c==="capture_limit"&&(O=u?"  ":"   "),O)return t.jsx("p",{className:"text-center text-2xl font-bold",children:O})}if(e.mode===T.Alkkagi){const O=n.id===i?B.Black:B.White,L=(e.alkkagiStones||[]).filter(D=>D.player===O&&D.onBoard).length,Q=(e.alkkagiStones||[]).filter(D=>D.player!==O&&D.onBoard).length;return u?L>0?t.jsxs("p",{className:"text-center text-lg",children:[L,"   ."]}):t.jsx("p",{className:"text-center text-lg",children:"    ."}):Q>0?t.jsxs("p",{className:"text-center text-lg",children:["     . (  ",Q," )"]}):t.jsx("p",{className:"text-center text-lg",children:" ."})}return t.jsx("p",{className:"text-center text-gray-400",children:"   ."})},S=p?Pr(p.manner.initial):"",E=p?Pr(p.manner.final):"";return t.jsx(be,{title:" ",onClose:s,initialWidth:600,windowId:"game-summary",children:t.jsxs("div",{className:"text-white text-[clamp(0.75rem,2.5vw,1rem)]",children:[t.jsx("h1",{className:`text-[clamp(2.25rem,10vw,3rem)] font-black text-center mb-4 tracking-widest ${w}`,children:v}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsxs("div",{className:"w-full bg-gray-900/50 p-2 sm:p-4 rounded-lg",children:[t.jsx("h2",{className:"text-lg font-bold text-center text-gray-200 mb-3 border-b border-gray-700 pb-2",children:" "}),P()]}),p&&t.jsxs("div",{className:"w-full flex flex-col gap-2 sm:gap-4",children:[t.jsxs("div",{className:"bg-gray-900/50 p-2 sm:p-4 rounded-lg space-y-4",children:[t.jsx("h2",{className:"text-lg font-bold text-center text-gray-200 mb-3 border-b border-gray-700 pb-2",children:"  "}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ce,{userId:n.id,userName:n.nickname,size:48,avatarUrl:h,borderUrl:y}),t.jsxs("div",{children:[t.jsx("p",{className:"font-bold",children:n.nickname}),t.jsxs("p",{className:"text-xs text-gray-400",children:[m?"":""," Lv.",p.level?p.level.final:m?n.playfulLevel:n.strategyLevel]})]})]}),p.level&&t.jsx(Ty,{initial:p.level.progress.initial,final:p.level.progress.final,max:p.level.progress.max,levelUp:p.level.initial<p.level.final,xpGain:p.xp.change,finalLevel:p.level.final}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-center",children:[t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[p.rating.final," (",t.jsxs("span",{className:p.rating.change>=0?"text-green-400":"text-red-400",children:[p.rating.change>0?"+":"",p.rating.change]}),")"]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:"  "}),t.jsxs("p",{className:`font-semibold ${p.manner.change===0?"text-white":p.manner.change>0?"text-green-400":"text-red-400"}`,children:[p.manner.change>0?"+":"",p.manner.change]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[(R=p.overallRecord)==null?void 0:R.wins," ",(A=p.overallRecord)==null?void 0:A.losses,""]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[S,"  ",E]})]})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-2 sm:p-4 rounded-lg space-y-3",children:[t.jsx("h2",{className:"text-lg font-bold text-center text-gray-200 border-b border-gray-700 pb-2",children:" "}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-center",children:[t.jsx("div",{className:"bg-gray-800 p-2 rounded-md",children:t.jsxs("p",{className:"font-semibold flex items-center justify-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4"})," ",(p.gold??0).toLocaleString()," "]})}),t.jsx("div",{className:"bg-gray-800 p-2 rounded-md flex items-center justify-center",children:b&&j?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[j.image&&t.jsx("img",{src:j.image,alt:b.name,className:"w-6 h-6 object-contain"}),t.jsx("p",{className:"font-semibold text-xs",children:b.name})]}):t.jsx("p",{className:"font-semibold text-xs",children:"   "})})]})]})]})]}),t.jsx(U,{onClick:s,className:"w-full py-3 mt-6",children:""})]})})},$y=({session:e,currentUser:n,onAction:s})=>{const[l,r]=f.useState(15),a=f.useRef(!1),{id:i,nigiri:o,player1:c,player2:d,gameStatus:u}=e;if(!o)return null;const{holderId:p,guesserId:m,result:h,stones:y,guess:b}=o,j=n.id===m;f.useEffect(()=>{u==="nigiri_choosing"&&!a.current&&(a.current=!0)},[u]);const g=f.useCallback(w=>{var k;n.id!==((k=e.nigiri)==null?void 0:k.guesserId)||e.gameStatus!=="nigiri_guessing"||s({type:"NIGIRI_GUESS",payload:{gameId:e.id,guess:w}})},[e,n,s]);f.useEffect(()=>{if(u!=="nigiri_guessing"||!j)return;const w=e.guessDeadline||Date.now()+15*1e3,k=setInterval(()=>{const P=Math.max(0,Math.ceil((w-Date.now())/1e3));r(P),P<=0&&clearInterval(k)},1e3);return()=>clearInterval(k)},[u,j,e.guessDeadline]);const x=()=>{switch(u){case"nigiri_reveal":return" ";case"nigiri_guessing":return"  ";case"nigiri_choosing":default:return"/  ()"}},v=()=>{const w=c.id===p?c:d,k=c.id===m?c:d;if(u==="nigiri_reveal"){if(!h||!k||!w||typeof y!="number"||!b)return t.jsxs("div",{className:"text-center animate-pulse",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2",children:"  ..."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]});const P=h==="correct",S=P?k:w,E=n.id===S.id,_=E?"  .":"  .",C=E?"bg-black border-gray-300":"bg-white border-gray-800",I=P?`${k.nickname} !`:`${k.nickname} .`,R=P?"text-green-400":"text-red-400",A=`${S.nickname} ()  .`;return t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg space-y-3 mb-6",children:[t.jsxs("div",{className:"flex justify-between items-center text-lg",children:[t.jsx("span",{className:"text-gray-400",children:"  :"}),t.jsxs("span",{className:"font-semibold",children:[y,""]})]}),t.jsxs("div",{className:"flex justify-between items-center text-lg",children:[t.jsxs("span",{className:"text-gray-400",children:[k.nickname," :"]}),t.jsx("span",{className:"font-semibold",children:b===1?"":""})]}),t.jsx("div",{className:`mt-2 text-lg font-bold ${R}`,children:I})]}),t.jsx("p",{className:"text-lg font-semibold mb-4",children:A}),t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[t.jsx("div",{className:`w-24 h-24 rounded-full flex items-center justify-center border-4 ${C}`}),t.jsx("p",{className:"text-xl font-bold",children:_})]}),t.jsx("p",{className:"mt-6 text-sm text-gray-400 animate-pulse",children:"   ..."})]})}return u==="nigiri_guessing"?j?t.jsxs("div",{className:"text-center",children:[t.jsxs("h2",{className:"text-xl font-bold mb-2",children:[w.nickname,"  ."]}),t.jsx("p",{className:"text-gray-300 mb-4",children:"     ."}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${l/15*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:l})]}),t.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[t.jsx(U,{onClick:()=>g(1),colorScheme:"gray",className:"w-40 py-4 text-lg",children:""}),t.jsx(U,{onClick:()=>g(2),colorScheme:"gray",className:"w-40 py-4 text-lg",children:""})]})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2",children:"  "}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[k.nickname,"    ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6 animate-pulse",children:j?`${w.nickname}   ...`:"   ..."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]})};return t.jsx(be,{title:x(),windowId:"nigiri",children:v()})},Rn=Mn.memo(({amount:e,onAdjust:n,disabled:s})=>t.jsx(U,{onClick:()=>n(e),disabled:s,colorScheme:"gray",className:"w-full",children:e>0?`+${e}`:`${e}`})),By=e=>{const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,bids:o,biddingRound:c,captureBidDeadline:d,settings:u}=n,[p,m]=f.useState(1),[h,y]=f.useState(30),[b,j]=f.useState(!1),g=f.useRef(c),x=f.useRef(e);f.useEffect(()=>{x.current=e}),f.useEffect(()=>{c!==g.current&&(m(1),j(!1),g.current=c)},[c]);const v=s.id===a.id?i:a,w=o==null?void 0:o[s.id],k=o==null?void 0:o[v.id],P=typeof w=="number"&&typeof k=="number",S=f.useCallback(()=>{var O;const{onAction:C,session:I,currentUser:R}=x.current;typeof((O=I.bids)==null?void 0:O[R.id])=="number"||b||(j(!0),C({type:"UPDATE_CAPTURE_BID",payload:{gameId:r,bid:p}}),setTimeout(()=>j(!1),5e3))},[b,r,p]);f.useEffect(()=>{if(typeof w=="number"||!d){y(0);return}const C=setInterval(()=>{const I=Math.max(0,Math.ceil((d-Date.now())/1e3));y(I),I<=0&&clearInterval(C)},1e3);return()=>clearInterval(C)},[w,d]);const E=f.useCallback(C=>{typeof w!="number"&&m(I=>Math.max(1,Math.min(50,I+C)))},[w]),_=()=>{const C=u.captureTarget||20;if(P){const R=o[a.id],A=o[i.id];let O="";const L=R===A;let Q,D;R>A?(Q=a,D=R):A>R&&(Q=i,D=A),Q?O=`${Q.nickname} ${D}   () .`:O=c===2?"  ,  .":", !";const $=L&&c===1?"   ...":"   ...";return t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-lg mb-6",children:[t.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[t.jsxs("p",{className:"text-gray-400 text-sm mb-1",children:[a.nickname," "]}),t.jsxs("p",{className:"text-3xl font-bold",children:[R,""]})]}),t.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[t.jsxs("p",{className:"text-gray-400 text-sm mb-1",children:[i.nickname," "]}),t.jsxs("p",{className:"text-3xl font-bold",children:[A,""]})]})]}),t.jsx("p",{className:"mt-4 text-xl",children:t.jsx("span",{className:"font-bold text-yellow-300",children:O})}),t.jsx("p",{className:"mt-6 text-sm text-gray-400 animate-pulse",children:$})]})}if(typeof w=="number")return t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[v.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]});const I=typeof w=="number";return t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-gray-300 mb-6",children:["  ",t.jsxs("span",{className:"font-bold text-yellow-300",children:[C,""]}),". ()         .       ."]}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${h/30*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:h})]}),t.jsxs("div",{className:"my-4",children:[t.jsxs("div",{className:"bg-gray-900/70 p-2 rounded-lg text-4xl font-bold text-yellow-300 mb-4 text-center",children:[C," + ",p,""]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-2",children:[t.jsx(Rn,{amount:10,onAdjust:E,disabled:I}),t.jsx(Rn,{amount:5,onAdjust:E,disabled:I}),t.jsx(Rn,{amount:3,onAdjust:E,disabled:I}),t.jsx(Rn,{amount:1,onAdjust:E,disabled:I})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsx(Rn,{amount:-10,onAdjust:E,disabled:I}),t.jsx(Rn,{amount:-5,onAdjust:E,disabled:I}),t.jsx(Rn,{amount:-3,onAdjust:E,disabled:I}),t.jsx(Rn,{amount:-1,onAdjust:E,disabled:I})]})]}),t.jsx(U,{onClick:S,disabled:b||I,className:"w-full py-3",children:b?" ...":""})]})};return t.jsx(be,{title:`  ${c===2?"()":""}`,windowId:"capture-bid",children:_()})},Oy=({session:e,currentUser:n,onAction:s})=>{const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,effectiveCaptureTargets:c,gameStatus:d,settings:u,preGameConfirmations:p,revealEndTime:m}=e,h=p==null?void 0:p[n.id],[y,b]=f.useState(10);if(f.useEffect(()=>{const _=m||Date.now()+1e4,C=setInterval(()=>{const I=Math.max(0,Math.ceil((_-Date.now())/1e3));b(I)},1e3);return()=>{clearInterval(C)}},[m]),!i||!o||!c)return null;const j=r.id===i?r:a,g=r.id===o?r:a,x=c[B.Black],v=c[B.White],w=d==="capture_tiebreaker",k=()=>{if(w)return{title:"   ()",description:"    , /  ."};const _=c[B.Black]-u.captureTarget;return{title:"  ",description:`${j.nickname} ${_}  () .`}},{title:P,description:S}=k(),E=({user:_,color:C,target:I})=>t.jsxs("div",{className:"flex flex-col items-center text-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:_.id,userName:_.nickname,size:80,className:`border-4 ${C===""?"border-gray-500":"border-gray-400"}`}),t.jsx("p",{className:"mt-3 text-xl font-bold",children:_.nickname}),t.jsxs("p",{className:"text-lg font-semibold text-gray-300",children:[C,C===""&&" ()"]}),t.jsxs("div",{className:"mt-2 text-sm bg-gray-800 px-3 py-1 rounded-full",children:[t.jsx("span",{className:"text-gray-400",children:" : "}),t.jsxs("span",{className:"font-bold text-yellow-300",children:[I,""]}),t.jsx("span",{className:"text-gray-400",children:" "})]})]});return t.jsx(be,{title:P,initialWidth:550,windowId:"capture-tiebreaker",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-6",children:S}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 my-6",children:[t.jsx(E,{user:j,color:"",target:x}),t.jsx(E,{user:g,color:"",target:v})]}),t.jsx(U,{onClick:()=>s({type:"CONFIRM_CAPTURE_REVEAL",payload:{gameId:l}}),disabled:!!h,className:"w-full py-3",children:h?"   ...":`  (${y})`})]})})},ki=["rock","paper","scissors"],Cs={rock:{emoji:"",name:""},paper:{emoji:"",name:""},scissors:{emoji:"",name:""}},Dy=(e,n)=>e===n?"draw":e==="rock"&&n==="scissors"||e==="scissors"&&n==="paper"||e==="paper"&&n==="rock"?"p1":"p2",qy=e=>{const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,rpsState:o,gameStatus:c,mode:d,rpsRound:u}=n,[p,m]=f.useState(null),[h,y]=f.useState(30),b=f.useRef(e);f.useEffect(()=>{b.current=e});const j=s.id,g=j===a.id?i:a,x=o==null?void 0:o[j],v=f.useCallback(S=>{const{session:E,onAction:_,currentUser:C}=b.current,{id:I,rpsState:R}=E;R!=null&&R[C.id]||(m(S),_({type:"SUBMIT_RPS_CHOICE",payload:{gameId:I,choice:S}}))},[]);f.useEffect(()=>{(c==="dice_rps"||c==="thief_rps"||c==="alkkagi_rps"||c==="curling_rps"||c==="omok_rps"||c==="ttamok_rps")&&(m(null),y(30))},[c]),f.useEffect(()=>{if(!(!x&&!p&&(c==="dice_rps"||c==="thief_rps"||c==="alkkagi_rps"||c==="curling_rps"||c==="omok_rps"||c==="ttamok_rps")))return;const E=setInterval(()=>{y(_=>{if(_<=1){clearInterval(E);const C=ki[Math.floor(Math.random()*ki.length)];return v(C),0}return _-1})},1e3);return()=>clearInterval(E)},[x,p,c,v]);const w=()=>{switch(d){case T.Thief:return" !    .";case T.Alkkagi:case T.Curling:case T.Omok:case T.Ttamok:return" !     .";case T.Dice:default:return"    ."}},k=()=>` ${u?`(${u}/3)`:""}`,P=()=>{if(c.endsWith("_rps_reveal")){const E=o==null?void 0:o[a.id],_=o==null?void 0:o[i.id];if(E&&_){const C=Dy(E,_);let I="",R="";if(C==="draw")I=(u||1)>=3?"!  ...":"!  !",R="text-yellow-400";else if(j===a.id&&C==="p1"||j===i.id&&C==="p2"){let O="!";d===T.Dice&&(O="! ."),d===T.Thief&&(O="!   ."),(d===T.Alkkagi||d===T.Curling||d===T.Omok||d===T.Ttamok)&&n.turnChoices&&(O=`! ${n.turnChoices[j]==="first"?"":""} .`),I=O,R="text-green-400"}else{let O="!";d===T.Dice&&(O="! ."),d===T.Thief&&(O="!   ."),(d===T.Alkkagi||d===T.Curling||d===T.Omok||d===T.Ttamok)&&n.turnChoices&&(O=`!  ${n.turnChoices[g.id]==="first"?"":""} .`),I=O,R="text-red-400"}return t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"flex justify-around items-center mb-6",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-lg font-semibold",children:a.nickname}),t.jsx("span",{className:"text-7xl my-2",children:Cs[E].emoji}),t.jsx("span",{className:"text-gray-300",children:Cs[E].name})]}),t.jsx("span",{className:"text-4xl font-bold text-gray-500",children:"VS"}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-lg font-semibold",children:i.nickname}),t.jsx("span",{className:"text-7xl my-2",children:Cs[_].emoji}),t.jsx("span",{className:"text-gray-300",children:Cs[_].name})]})]}),t.jsx("h2",{className:`text-3xl font-bold animate-pulse ${R}`,children:I})]})}}return x||p?t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[g.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-4",children:w()}),u===3&&t.jsx("p",{className:"text-sm text-yellow-300 mb-4",children:"   !"}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${h/30*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:h})]}),t.jsx("div",{className:"flex justify-center gap-4 mt-4",children:ki.map(E=>t.jsx(U,{onClick:()=>v(E),colorScheme:"gray",className:"w-32 h-20 text-lg",children:t.jsxs("div",{className:"flex flex-col items-center justify-center",children:[t.jsx("span",{className:"text-3xl",children:Cs[E].emoji}),t.jsx("span",{children:Cs[E].name})]})},E))})]})};return t.jsx(be,{title:k(),windowId:"rps-minigame",children:P()})},zy=e=>{const{session:n,currentUser:s}=e,{player1:l,player2:r,roleChoices:a}=n,[i,o]=f.useState(null),[c,d]=f.useState(10),u=f.useRef(e);f.useEffect(()=>{u.current=e});const p=s.id,m=p===l.id?r:l,h=a==null?void 0:a[p],y=f.useCallback(j=>{var k;const{session:g,onAction:x,currentUser:v}=u.current;(k=g.roleChoices)!=null&&k[v.id]||(o(j),x({type:"THIEF_UPDATE_ROLE_CHOICE",payload:{gameId:g.id,choice:j}}))},[]);f.useEffect(()=>{if(h||i)return;const j=setInterval(()=>{d(g=>g<=1?(clearInterval(j),0):g-1)},1e3);return()=>clearInterval(j)},[h,i,y]);const b=()=>h||i?t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[m.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6",children:"  .    ."}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${c*10}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:c})]}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsx(U,{onClick:()=>y("thief"),colorScheme:"yellow",className:"w-full py-4 text-lg",children:" "}),t.jsx(U,{onClick:()=>y("police"),colorScheme:"blue",className:"w-full py-4 text-lg",children:" "})]})]});return t.jsx(be,{title:" ",windowId:"thief-role-selection",children:b()})},Uy=({session:e,currentUser:n,onAction:s})=>{var _,C,I,R,A,O;const{id:l,player1:r,player2:a,thiefPlayerId:i,policePlayerId:o,preGameConfirmations:c,revealEndTime:d,rpsState:u,turnChoices:p}=e,m=!!(c!=null&&c[n.id]),[h,y]=f.useState(10);if(f.useEffect(()=>{const L=d||Date.now()+1e4,Q=setInterval(()=>{const D=Math.max(0,Math.ceil((L-Date.now())/1e3));y(D)},1e3);return()=>clearInterval(Q)},[d]),!i||!o)return null;const b=r.id===i?r:a,j=r.id===o?r:a,g=(_=Ee.find(L=>L.id===b.avatarId))==null?void 0:_.url,x=(C=Re.find(L=>L.id===b.borderId))==null?void 0:C.url,v=(I=Ee.find(L=>L.id===j.avatarId))==null?void 0:I.url,w=(R=Re.find(L=>L.id===j.borderId))==null?void 0:R.url;let k=" .";const P=(A=e.roleChoices)==null?void 0:A[n.id],S=n.id===r.id?a.id:r.id,E=(O=e.roleChoices)==null?void 0:O[S];return P===E&&(k=` , ${b.id===n.id?"":""}  .`),t.jsx(be,{title:"  ",initialWidth:600,windowId:"thief-role-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:k}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,size:64,avatarUrl:g,borderUrl:x}),t.jsx("p",{className:"mt-2 font-bold",children:b.nickname}),t.jsx("p",{className:"font-semibold px-2 py-0.5 rounded-full text-sm my-1 bg-yellow-600 text-black",children:"  ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:j.id,userName:j.nickname,size:64,avatarUrl:v,borderUrl:w}),t.jsx("p",{className:"mt-2 font-bold",children:j.nickname}),t.jsx("p",{className:"font-semibold px-2 py-0.5 rounded-full text-sm my-1 bg-blue-600 text-white",children:"  ()"})]})]}),t.jsx(U,{onClick:()=>s({type:"CONFIRM_THIEF_ROLE",payload:{gameId:l}}),disabled:!!m,className:"w-full py-3 mt-6",children:m?"   ...":`  (${h})`})]})})},Fy=e=>{const{session:n,currentUser:s}=e,{player1:l,player2:r,turnChoices:a,turnChoiceDeadline:i}=n,[o,c]=f.useState(null),[d,u]=f.useState(30),p=f.useRef(e);f.useEffect(()=>{p.current=e});const m=s.id,h=m===l.id?r:l,y=a==null?void 0:a[m],b=f.useCallback(g=>{var P;const{session:x,onAction:v,currentUser:w}=p.current;(P=x.turnChoices)!=null&&P[w.id]||(c(g),v({type:"CHOOSE_TURN_PREFERENCE",payload:{gameId:x.id,choice:g}}))},[]);f.useEffect(()=>{if(y||o||!i)return;const g=setInterval(()=>{const x=Math.max(0,Math.ceil((i-Date.now())/1e3));u(x),x<=0&&clearInterval(g)},1e3);return()=>clearInterval(g)},[y,o,i]);const j=()=>y||o?t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[h.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6",children:"  .    ."}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${d/30*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:d})]}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsx(U,{onClick:()=>b("first"),colorScheme:"blue",className:"w-full py-4 text-lg",children:" ()"}),t.jsx(U,{onClick:()=>b("second"),colorScheme:"gray",className:"w-full py-4 text-lg",children:" ()"})]})]});return t.jsx(be,{title:" ",windowId:"turn-preference-selection",children:j()})},Gy=({session:e,currentUser:n,onConfirm:s})=>{var r;const l=(r=e.noContestInitiatorIds)==null?void 0:r.includes(n.id);return t.jsx(be,{title:" ",onClose:s,initialWidth:450,windowId:"no-contest",children:t.jsxs("div",{className:"text-white",children:[t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg mb-6 text-center",children:[t.jsxs("p",{className:"text-lg",children:["10       ",t.jsx("br",{}),"   ."]}),l&&t.jsx("p",{className:"text-sm text-red-400 mt-3",children:":     ,    ."})]}),t.jsx(U,{onClick:s,className:"w-full py-3",children:""})]})})},Au=(e,n)=>{var r,a;const s=(r=Ee.find(i=>i.id===n.avatarId))==null?void 0:r.url,l=(a=Re.find(i=>i.id===n.borderId))==null?void 0:a.url;return t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:n.id,userName:n.nickname,size:80,avatarUrl:s,borderUrl:l}),t.jsx("p",{className:"mt-2 font-bold text-lg",children:n.nickname}),t.jsx("p",{className:`px-2 py-0.5 rounded-full text-sm font-semibold my-2 ${e.role==="thief"?"bg-yellow-600 text-black":"bg-blue-600 text-white"}`,children:e.role==="thief"?" ":" "}),t.jsxs("div",{className:"text-left text-sm space-y-1 w-full",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold",children:[e.roundScore," ",e.role==="thief"?" ":" "]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-mono text-xl text-yellow-300",children:[e.cumulativeScore,""]})]})]})]})},Wy=({session:e,currentUser:n,onAction:s})=>{const{id:l,player1:r,player2:a,thiefRoundSummary:i,roundEndConfirmations:o,revealEndTime:c}=e,[d,u]=f.useState(20),p=!!(o!=null&&o[n.id]);if(f.useEffect(()=>{const x=c||Date.now()+2e4,v=setInterval(()=>{const w=Math.max(0,Math.ceil((x-Date.now())/1e3));u(w)},1e3);return()=>{clearInterval(v)}},[c]),!i)return null;const{round:m,isDeathmatch:h,player1:y,player2:b}=i,j=h?` ${m-2} `:`${m}  `;let g="";return h?g="  ,     .":m<2?g="     .":g="2  .     .",t.jsx(be,{title:j,initialWidth:550,windowId:"thief-round-summary",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-6",children:g}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 my-6",children:[Au(y,r),Au(b,a)]}),t.jsx(U,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:p,className:"w-full py-3",children:p?"   ...":`   (${d})`})]})})},Hy=({session:e,currentUser:n,onAction:s})=>{var D,$,q,z;const{id:l,curlingRoundSummary:r,player1:a,player2:i,blackPlayerId:o,whitePlayerId:c,roundEndConfirmations:d}=e,[u,p]=f.useState(20),m=!!(d!=null&&d[n.id]);if(f.useEffect(()=>{const W=e.revealEndTime||Date.now()+2e4,H=setInterval(()=>{const ne=Math.max(0,Math.ceil((W-Date.now())/1e3));p(ne)},1e3);return()=>clearInterval(H)},[e.revealEndTime]),!r)return null;const h=o===a.id?a:i,y=c===a.id?a:i,b=(D=Ee.find(W=>W.id===h.avatarId))==null?void 0:D.url,j=($=Re.find(W=>W.id===h.borderId))==null?void 0:$.url,g=(q=Ee.find(W=>W.id===y.avatarId))==null?void 0:q.url,x=(z=Re.find(W=>W.id===y.borderId))==null?void 0:z.url,{round:v,black:w,white:k,cumulativeScores:P,stonesState:S,scoredStones:E}=r,C=(n.id===o?B.Black:B.White)===B.White,I=e.settings.curlingRounds||3,R=840,A={x:R/2,y:R/2},O=R/19,L=[O*6,O*4,O*2,O*.5],Q=["rgba(0, 100, 255, 0.2)","rgba(255, 255, 255, 0.2)","rgba(255, 0, 0, 0.2)","white"];return t.jsx(be,{title:`${v}  `,initialWidth:900,windowId:"curling-round-summary",children:t.jsxs("div",{className:"text-white flex flex-col md:flex-row gap-4",children:[t.jsxs("div",{className:"w-full md:w-1/2 flex flex-col items-center flex-shrink-0",children:[t.jsx("h3",{className:"text-xl font-bold mb-2",children:"  "}),t.jsx("div",{className:`w-full aspect-square bg-gray-700 rounded-lg overflow-hidden border-2 border-gray-600 transition-transform duration-500 ${C?"rotate-180":""}`,children:t.jsxs("svg",{viewBox:`0 0 ${R} ${R}`,className:"w-full h-full bg-[#DDAA77]",children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"gloss-curling-summary-1",children:[t.jsx("stop",{offset:"10%",stopColor:"#333"}),t.jsx("stop",{offset:"95%",stopColor:"#000"})]}),t.jsxs("radialGradient",{id:"gloss-curling-summary-2",children:[t.jsx("stop",{offset:"10%",stopColor:"#fff"}),t.jsx("stop",{offset:"95%",stopColor:"#ccc"})]}),t.jsxs("filter",{id:"glow-effect",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),L.map((W,H)=>t.jsx("circle",{cx:A.x,cy:A.y,r:W,fill:Q[H]},H)),S.map(W=>{if(!W.onBoard)return null;const H=E[W.id];return t.jsxs("g",{children:[t.jsx("circle",{cx:W.x,cy:W.y,r:W.radius,fill:W.player===B.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:W.x,cy:W.y,r:W.radius,fill:`url(#gloss-curling-summary-${W.player})`}),H&&t.jsxs("g",{style:{pointerEvents:"none"},transform:C?`rotate(180, ${W.x}, ${W.y})`:void 0,children:[t.jsx("circle",{cx:W.x,cy:W.y,r:W.radius,fill:"none",stroke:W.player===B.Black?"#67e8f9":"#facc15",strokeWidth:"5",filter:"url(#glow-effect)"}),t.jsxs("text",{x:W.x,y:W.y,textAnchor:"middle",dy:".35em",fontSize:W.radius*.9,fontWeight:"bold",fill:W.player===B.Black?"white":"black",stroke:"rgba(0,0,0,0.5)",strokeWidth:"0.5px",children:["+",H]})]})]},W.id)})]})})]}),t.jsxs("div",{className:"w-full md:w-1/2 flex-grow flex flex-col justify-center",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-2 my-2",children:[t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(Ce,{userId:h.id,userName:h.nickname,size:48,avatarUrl:b,borderUrl:j}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold",children:h.nickname}),t.jsx("p",{className:"text-sm text-gray-400",children:""})]})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[w.houseScore,""]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[w.knockoutScore,""]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-2 mt-2 text-base",children:[t.jsx("strong",{children:" :"})," ",t.jsxs("strong",{className:"text-yellow-300",children:[w.total,""]})]})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:48,avatarUrl:g,borderUrl:x}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold",children:y.nickname}),t.jsx("p",{className:"text-sm text-gray-400",children:""})]})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[k.houseScore,""]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[k.knockoutScore,""]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-2 mt-2 text-base",children:[t.jsx("strong",{children:" :"})," ",t.jsxs("strong",{className:"text-yellow-300",children:[k.total,""]})]})]})]})]}),t.jsxs("div",{className:"text-center bg-gray-700/50 p-3 rounded-lg mt-4",children:[t.jsx("p",{className:"text-lg font-bold",children:" "}),t.jsxs("p",{className:"text-2xl font-mono",children:[t.jsxs("span",{children:[" ",P[B.Black]]}),t.jsx("span",{className:"mx-4 text-gray-400",children:":"}),t.jsxs("span",{children:[" ",P[B.White]]})]})]}),t.jsx(U,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:!!m,className:"w-full mt-6 py-3",children:m?"   ...":`${v>=I?"  ":"  "} (${u})`})]})]})})},Vy=({session:e,currentUser:n,onAction:s})=>{var _,C,I,R;const{id:l,player1:r,player2:a,diceRoundSummary:i,roundEndConfirmations:o,revealEndTime:c}=e,[d,u]=f.useState(20),p=!!(o!=null&&o[n.id]);if(f.useEffect(()=>{const A=c||Date.now()+2e4,O=setInterval(()=>{const L=Math.max(0,Math.ceil((A-Date.now())/1e3));u(L)},1e3);return()=>{clearInterval(O)}},[c]),!i)return null;const{round:m,scores:h,diceStats:y}=i,b=h[r.id]||0,j=h[a.id]||0,g=(_=Ee.find(A=>A.id===r.avatarId))==null?void 0:_.url,x=(C=Re.find(A=>A.id===r.borderId))==null?void 0:C.url,v=(I=Ee.find(A=>A.id===a.avatarId))==null?void 0:I.url,w=(R=Re.find(A=>A.id===a.borderId))==null?void 0:R.url,k=A=>{if(!y||!y[A])return null;const O=y[A];return O.totalRolls===0?t.jsx("p",{className:"text-sm text-gray-400",children:"  ."}):t.jsx("div",{className:"grid grid-cols-3 gap-x-4 gap-y-1 text-xs",children:Array.from({length:6},(L,Q)=>Q+1).map(L=>{const Q=O.rolls[L]||0,D=(Q/O.totalRolls*100).toFixed(0);return t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:[L,":"]}),t.jsxs("span",{className:"font-mono",children:[Q," (",D,"%)"]})]},L)})})},P=i.round>=(e.settings.diceGoRounds??3),S=b===j;let E=`   (${d})`;return P&&(S?E=`  (${d})`:E=`   (${d})`),p&&(E="   ..."),t.jsx(be,{title:`${m}   `,initialWidth:650,windowId:"dice-round-summary",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-6",children:"    ."}),t.jsxs("div",{className:"flex justify-around items-center my-6",children:[t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:r.id,userName:r.nickname,size:96,avatarUrl:g,borderUrl:x}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:r.nickname})]}),t.jsxs("span",{className:"text-4xl font-mono text-gray-300",children:[b," : ",j]}),t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:a.id,userName:a.nickname,size:96,avatarUrl:v,borderUrl:w}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:a.nickname})]})]}),y&&t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg my-6",children:[t.jsx("h3",{className:"text-lg font-bold text-center text-gray-200 mb-3",children:"1  "}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-gray-800/60 p-3 rounded",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:r.nickname}),k(r.id)]}),t.jsxs("div",{className:"bg-gray-800/60 p-3 rounded",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:a.nickname}),k(a.id)]})]})]}),t.jsx(U,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:!!p,className:"w-full py-3",children:E})]})})},Ky=({session:e,currentUser:n,onAction:s})=>{const{basePlacementDeadline:l,settings:r,player1:a,baseStones_p1:i,baseStones_p2:o}=e,c=r.baseStones||4,d=n.id===a.id?i:o,u=(d==null?void 0:d.length)||0,p=u>=c,[m,h]=f.useState(30);return f.useEffect(()=>{if(!l)return;const y=setInterval(()=>{const b=Math.max(0,Math.ceil((l-Date.now())/1e3));h(b)},1e3);return()=>clearInterval(y)},[l]),t.jsx(be,{title:" ",windowId:"base-placement",initialWidth:300,modal:!1,children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-200",children:"    ."}),t.jsxs("p",{className:"text-lg font-bold my-2",children:["(",u,"/",c,")"]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 my-3 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${m/30*100}%`,transition:"width 0.5s linear"}})}),t.jsx("div",{className:"text-5xl font-mono font-bold mt-1 text-white",children:m}),!p&&t.jsx(U,{onClick:()=>s({type:"PLACE_REMAINING_BASE_STONES_RANDOMLY"}),colorScheme:"yellow",className:"w-full mt-4 !text-sm !py-2",children:"   "}),p&&t.jsx("p",{className:"text-sm text-green-400 animate-pulse mt-4",children:" !  ..."})]})})},Qy=({session:e})=>{const{baseStones_p1:n,baseStones_p2:s,settings:{boardSize:l}}=e,r=[...(n||[]).map(m=>({...m,player:B.Black})),...(s||[]).map(m=>({...m,player:B.White}))],a=250,i=a/l,o=i/2,c=i*.47,d=c*2*.7,u=d/2,p=m=>({cx:o+m.x*i,cy:o+m.y*i});return t.jsxs("svg",{viewBox:`0 0 ${a} ${a}`,className:"w-full h-full bg-[#e0b484] rounded-md shadow-inner",children:[Array.from({length:l}).map((m,h)=>t.jsxs("g",{children:[t.jsx("line",{x1:o+h*i,y1:o,x2:o+h*i,y2:a-o,stroke:"#54432a",strokeWidth:"1"}),t.jsx("line",{x1:o,y1:o+h*i,x2:a-o,y2:o+h*i,stroke:"#54432a",strokeWidth:"1"})]},h)),r.map((m,h)=>{const{cx:y,cy:b}=p(m);return t.jsxs("g",{children:[t.jsx("circle",{cx:y,cy:b,r:c,fill:m.player===B.Black?"#111827":"#f5f2e8"}),t.jsx("image",{href:m.player===B.Black?Da:Oa,x:y-u,y:b-u,width:d,height:d})]},`base-stone-${h}`)})]})},Ln=Mn.memo(({amount:e,onAdjust:n,disabled:s})=>t.jsx(U,{onClick:()=>n(e),disabled:s,colorScheme:"gray",className:"w-full !py-1",children:e>0?`+${e}`:`${e}`})),Jy=e=>{const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,komiBids:o,komiBiddingDeadline:c,gameStatus:d,komiBiddingRound:u}=n,[p,m]=f.useState(B.Black),[h,y]=f.useState(0),[b,j]=f.useState(30),[g,x]=f.useState(!1),v=f.useRef(e);f.useEffect(()=>{v.current=e});const w=s.id===a.id?i:a,k=o==null?void 0:o[s.id],P=w?o==null?void 0:o[w.id]:void 0,S=f.useCallback(()=>{var $;const{session:A,onAction:O,currentUser:L}=v.current;if((($=A.komiBids)==null?void 0:$[L.id])||g||p===B.None)return;x(!0);const D={color:p,komi:h};O({type:"UPDATE_KOMI_BID",payload:{gameId:A.id,bid:D}}),setTimeout(()=>x(!1),5e3)},[g,p,h]);f.useEffect(()=>{m(B.Black),y(0)},[u]),f.useEffect(()=>{if(k||!c){j(k?0:30);return}const A=setInterval(()=>{const O=Math.max(0,Math.ceil((c-Date.now())/1e3));j(O),O<=0&&S()},1e3);return()=>clearInterval(A)},[k,c,S]);const E=A=>{y(O=>Math.max(0,Math.min(100,O+A)))},_=()=>{if(!k||!P||!w)return t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:"  ..."}),t.jsx("p",{className:"text-gray-400 animate-pulse",children:"  ."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-gray-100"})})]});let A="";const O=k.color===P.color&&k.komi===P.komi;k.color!==P.color?A="   ,    . ( 0.5)":k.komi!==P.komi?A="  ,      .":u===1?A="   , 2   .":A="2    , /  .";const L=O&&u===1?"   ...":"   ...";return t.jsxs("div",{className:"text-center",children:[t.jsxs("h3",{className:"text-lg font-bold mb-2",children:["   ",u===2&&"()"]}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-md space-y-2 text-sm",children:[t.jsxs("div",{children:[s.nickname,": ",t.jsxs("span",{className:"font-bold",children:[k.color===B.Black?"":"",", ",k.komi,""]})]}),t.jsxs("div",{children:[w.nickname,": ",t.jsxs("span",{className:"font-bold",children:[P.color===B.Black?"":"",", ",P.komi,""]})]})]}),t.jsx("p",{className:"mt-4 text-xs text-yellow-300",children:A}),t.jsx("p",{className:"mt-4 text-sm text-gray-400 animate-pulse",children:L})]})};if(d==="komi_bid_reveal")return t.jsx(be,{title:"  ",windowId:"komi-bidding",children:_()});if(k)return t.jsx(be,{title:" ",windowId:"komi-bidding",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:" !"}),t.jsx("p",{className:"text-gray-400 animate-pulse",children:"   ..."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-gray-100"})})]})});const C=.5,I=()=>{if(p===B.Black)return` ,   ${h+C} .`;{const A=C-h;return A>=0?` ,   ${A} .`:` ,    ${Math.abs(A)} .`}},R=!!k;return t.jsx(be,{title:`  ${u===2?"()":""}`,windowId:"komi-bidding",initialWidth:650,children:t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col",children:[t.jsx("p",{className:"text-center text-sm text-gray-400 mb-2",children:" "}),t.jsx("div",{className:"aspect-square",children:t.jsx(Qy,{session:n})}),t.jsx("p",{className:"text-center text-xs text-gray-400 mt-1",children:"(P1: , P2:  )"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col justify-between",children:[t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:["       . ( :  ",C,")"]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5 my-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-1.5 rounded-full",style:{width:`${b/30*100}%`,transition:"width 0.5s linear"}})}),t.jsx("div",{className:"text-3xl font-mono font-bold text-center text-white",children:b}),t.jsxs("div",{className:"flex justify-center gap-4 my-4",children:[t.jsx(U,{onClick:()=>m(B.Black),disabled:R,colorScheme:p===B.Black?"blue":"gray",className:"w-24",children:""}),t.jsx(U,{onClick:()=>m(B.White),disabled:R,colorScheme:p===B.White?"blue":"gray",className:"w-24",children:""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"   (0~100)"}),t.jsxs("div",{className:"bg-gray-900/70 p-2 rounded-lg text-2xl font-bold text-yellow-300 mb-2",children:[h,""]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-2",children:[t.jsx(Ln,{amount:10,onAdjust:E,disabled:R}),t.jsx(Ln,{amount:5,onAdjust:E,disabled:R}),t.jsx(Ln,{amount:3,onAdjust:E,disabled:R}),t.jsx(Ln,{amount:1,onAdjust:E,disabled:R})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsx(Ln,{amount:-10,onAdjust:E,disabled:R}),t.jsx(Ln,{amount:-5,onAdjust:E,disabled:R}),t.jsx(Ln,{amount:-3,onAdjust:E,disabled:R}),t.jsx(Ln,{amount:-1,onAdjust:E,disabled:R})]})]}),t.jsx("p",{className:"text-xs text-gray-400 text-center mt-3 h-8",children:I()})]}),t.jsx(U,{onClick:S,disabled:R||g,className:"w-full mt-auto",children:R?" ":"  "})]})]})})},Yy=({session:e,currentUser:n})=>{const{alkkagiPlacementDeadline:s,settings:l,player1:r,alkkagiStones:a,alkkagiStones_p1:i,alkkagiStones_p2:o,alkkagiStonesPlacedThisRound:c,blackPlayerId:d}=e,u=l.alkkagiStoneCount||5,p=(c==null?void 0:c[n.id])||0,m=u,h=(e.alkkagiRound||1)>1?`  (${e.alkkagiRound} )`:"  ",y=p>=m,[b,j]=f.useState(30);return f.useEffect(()=>{if(!s)return;const g=setInterval(()=>{const x=Math.max(0,Math.ceil((s-Date.now())/1e3));j(x)},1e3);return()=>clearInterval(g)},[s]),t.jsx(be,{title:h,windowId:"alkkagi-placement",initialWidth:300,modal:!1,children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-200",children:(e.alkkagiRound||1)>1?"  .":"    ."}),t.jsxs("p",{className:"text-lg font-bold my-2",children:["(",p,"/",m,")"]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 my-3 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${b/30*100}%`,transition:"width 0.5s linear"}})}),t.jsx("div",{className:"text-5xl font-mono font-bold mt-1 text-white",children:b}),y&&t.jsx("p",{className:"text-sm text-green-400 animate-pulse mt-4",children:" !  ..."})]})})},Ru="preferredGameSettings",Oe=({label:e,children:n,className:s})=>t.jsxs("div",{className:`grid grid-cols-2 gap-4 items-center ${s}`,children:[t.jsx("label",{className:"font-semibold text-gray-300",children:e}),n]}),Xy=({deadline:e})=>{const[n,s]=f.useState(()=>Math.max(0,Math.ceil((e-Date.now())/1e3)));return f.useEffect(()=>{s(Math.max(0,Math.ceil((e-Date.now())/1e3)));const l=setInterval(()=>{s(r=>{const a=Math.max(0,Math.ceil((e-Date.now())/1e3));return r!==a?a:r})},1e3);return()=>clearInterval(l)},[e]),t.jsxs("span",{children:["(",n,")"]})},Zy=e=>{var we;const{negotiation:n,currentUser:s,onAction:l,onlineUsers:r,isTopmost:a}=e,[i,o]=f.useState(n.settings),c=f.useRef(!1),d=n.proposerId===s.id,u=n.status==="pending",m=n.status==="draft"&&d,h=u&&d,y=u&&!d,b=f.useMemo(()=>{const M=n.challenger.id===s.id?n.opponent:n.challenger;return M.id===el?M:r.find(ie=>ie.id===M.id)||M},[n.challenger,n.opponent,s.id,r]),j=b.id===el,g=f.useCallback(()=>{l({type:"DECLINE_NEGOTIATION",payload:{negotiationId:n.id}})},[l,n.id]);f.useEffect(()=>{let M;if(m){M={...tu,...n.settings};try{const oe=`${Ru}_${n.mode}`,ue=localStorage.getItem(oe);if(ue){const le=JSON.parse(ue);if(n.mode===T.Alkkagi){const ge=So.map(je=>je.value);le.alkkagiGaugeSpeed&&!ge.includes(le.alkkagiGaugeSpeed)&&delete le.alkkagiGaugeSpeed,le.alkkagiStoneCount&&!su.includes(le.alkkagiStoneCount)&&delete le.alkkagiStoneCount}if(n.mode===T.Curling){const ge=Co.map(je=>je.value);le.curlingGaugeSpeed&&!ge.includes(le.curlingGaugeSpeed)&&delete le.curlingGaugeSpeed,le.curlingStoneCount&&!ru.includes(le.curlingStoneCount)&&delete le.curlingStoneCount}le.baseStones&&!ji.includes(le.baseStones)&&delete le.baseStones,M={...M,...le}}}catch(oe){console.error("Failed to load or parse preferred settings",oe)}}else M={...tu,...n.settings};n.mode===T.Base&&(M.komi=.5),j&&!M.player1Color&&(M.player1Color=B.Black);const ie=(oe=>{switch(oe){case T.Omok:case T.Ttamok:return Ud;case T.Capture:return Fd;case T.Speed:return Gd;case T.Hidden:return Wd;case T.Thief:return Hd;case T.Missile:return Vd;case T.Alkkagi:case T.Curling:case T.Dice:return[19];default:return zd}})(n.mode);if(ie.includes(M.boardSize)||(M.boardSize=ie[0]),M.mixedModes){const oe=M.mixedModes.includes(T.Base),ue=M.mixedModes.includes(T.Capture);oe&&ue&&(M.mixedModes=M.mixedModes.filter(le=>le!==T.Base))}o(M),c.current=!1},[n.id,n.turnCount]),f.useEffect(()=>{h&&!c.current&&(Pe.myTurn(),c.current=!0)},[h]);const x=f.useMemo(()=>{var me;const M=Qe.some(ke=>ke.mode===n.mode),Y=M?b.strategyLevel:b.playfulLevel,ie=(me=b.stats)==null?void 0:me[n.mode],oe=(ie==null?void 0:ie.wins)??0,ue=(ie==null?void 0:ie.losses)??0,le=b.mannerScore??200,ge=oe+ue,je=ge>0?Math.round(oe/ge*100):0;return{level:Y,levelLabel:M?"":"",wins:oe,losses:ue,mannerScore:le,winRate:je}},[b,n.mode]),v=f.useMemo(()=>{var M;return(M=Ee.find(Y=>Y.id===b.avatarId))==null?void 0:M.url},[b.avatarId]),w=f.useMemo(()=>{var M;return(M=Re.find(Y=>Y.id===b.borderId))==null?void 0:M.url},[b.borderId]),k=f.useMemo(()=>Qe.some(M=>M.mode===n.mode)?au:nt.some(M=>M.mode===n.mode)?M0:au,[n.mode]),P=f.useMemo(()=>JSON.stringify(i)!==JSON.stringify(n.settings),[i,n.settings]),S=f.useCallback((M,Y)=>o(ie=>({...ie,[M]:Y})),[]),E=(M,Y)=>o(ie=>({...ie,mixedModes:Y?[...ie.mixedModes||[],M]:(ie.mixedModes||[]).filter(oe=>oe!==M)})),_=f.useCallback(M=>{try{const Y=`${Ru}_${n.mode}`;localStorage.setItem(Y,JSON.stringify(i))}catch(Y){console.error("Failed to save preferred settings",Y)}l(M)},[l,i,n.mode]),C=()=>l({type:"ACCEPT_NEGOTIATION",payload:{negotiationId:n.id,settings:i}}),I=()=>l({type:"UPDATE_NEGOTIATION",payload:{negotiationId:n.id,settings:i}}),R=()=>_({type:"SEND_CHALLENGE",payload:{negotiationId:n.id,settings:i}}),A=()=>_({type:"START_AI_GAME",payload:{mode:n.mode,settings:i}}),O=f.useMemo(()=>j?`${n.mode} AI  `:n.rematchOfGameId?`  (${n.mode})`:`  (${n.mode})`,[n.mode,n.rematchOfGameId,j]),L=s.actionPoints.current>=k,Q=()=>{const M="flex-1";if(j)return t.jsxs("div",{className:"flex justify-end gap-4",children:[t.jsx(U,{onClick:g,colorScheme:"red",className:M,children:""}),t.jsxs(U,{onClick:A,colorScheme:"green",className:M,disabled:!L,children:[" ",L?`(${k})`:"()"]})]});if(m){const Y=n.mode===T.Mix&&(!i.mixedModes||i.mixedModes.length<2);return t.jsxs("div",{className:"flex justify-between items-center gap-4",children:[t.jsx(U,{onClick:g,colorScheme:"red",className:M,children:""}),t.jsxs(U,{onClick:R,disabled:Y||!L,colorScheme:"green",className:M,children:["  ",L?`(${k})`:"()"]})]})}return h?t.jsxs("div",{className:"flex justify-between items-center gap-4",children:[t.jsx(U,{onClick:g,colorScheme:"red",className:M,children:""}),t.jsx(U,{onClick:I,disabled:!P,colorScheme:"yellow",className:M,children:" "}),t.jsxs(U,{onClick:C,disabled:P||!L,colorScheme:"green",className:M,children:[" ",L?`(${k})`:"()"]})]}):null},D=y||!d,$=()=>j?"AI   .":m?"   [ ]  .":h?"  []  [ ].":y?`(${b.nickname})   ...`:"  ...",q=({value:M,onChange:Y,children:ie,disabled:oe})=>t.jsx("select",{value:M,onChange:ue=>Y(ue.target.value),disabled:oe,className:"w-full bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5",children:ie}),{mode:z}=n,W=![T.Alkkagi,T.Curling,T.Dice].includes(z),H=![T.Capture,T.Omok,T.Ttamok,T.Alkkagi,T.Curling,T.Dice,T.Thief,T.Base].includes(z),ne=![T.Alkkagi,T.Curling,T.Dice,T.Thief].includes(z),re=z===T.Speed||z===T.Mix&&!!((we=i.mixedModes)!=null&&we.includes(T.Speed)),ce=z===T.Capture,ve=z===T.Ttamok,F=z===T.Omok||z===T.Ttamok,X=z===T.Base,ee=z===T.Hidden,xe=z===T.Missile,J=z===T.Mix,G=z===T.Dice,K=z===T.Alkkagi,Z=z===T.Curling,fe=j;return t.jsx(be,{title:O,windowId:"negotiation",onClose:g,initialWidth:600,closeOnOutsideClick:!1,isTopmost:a,children:t.jsxs("div",{onMouseDown:M=>M.stopPropagation(),className:"text-sm",children:[t.jsxs("p",{className:"text-center text-yellow-300 mb-4",children:[$()," ",t.jsx(Xy,{deadline:n.deadline})]}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx("div",{className:"bg-gray-900/50 p-2 md:p-4 rounded-lg border border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,avatarUrl:v,borderUrl:w,size:48}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("h3",{className:"text-xl font-bold",children:b.nickname}),t.jsxs("p",{className:"text-sm text-gray-400",children:[x.levelLabel," Lv.",x.level]})]}),t.jsxs("div",{className:"text-right text-sm",children:[t.jsxs("p",{className:"font-semibold",children:[x.wins," ",x.losses," (",x.winRate,"%)"]}),t.jsxs("p",{className:"text-gray-300",children:[": ",x.mannerScore,""]})]})]})}),t.jsxs("div",{className:"space-y-3 max-h-[calc(60vh - 12rem)] overflow-y-auto pr-2",children:[W&&t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.boardSize,onChange:M=>S("boardSize",parseInt(M,10)),disabled:D,children:(n.mode===T.Omok||n.mode===T.Ttamok?Ud:n.mode===T.Capture?Fd:n.mode===T.Speed?Gd:n.mode===T.Hidden?Wd:n.mode===T.Thief?Hd:n.mode===T.Missile?Vd:zd).map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),H&&t.jsx(Oe,{label:" ()",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"number",step:"1",value:Math.floor(i.komi),onChange:M=>S("komi",parseInt(M.target.value,10)+.5),disabled:D,className:"w-full bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5"}),t.jsx("span",{className:"font-bold text-lg text-gray-300 whitespace-nowrap",children:".5 "})]})}),fe&&(n.mode===T.Thief?t.jsx(Oe,{label:" ",children:t.jsxs(q,{value:i.player1Color,onChange:M=>S("player1Color",parseInt(M,10)),disabled:D,children:[t.jsx("option",{value:B.Black,children:"()"}),t.jsx("option",{value:B.White,children:"()"})]})}):t.jsx(Oe,{label:"  ",children:t.jsxs(q,{value:i.player1Color,onChange:M=>S("player1Color",parseInt(M,10)),disabled:D,children:[t.jsx("option",{value:B.Black,children:""}),t.jsx("option",{value:B.White,children:""})]})})),ne&&(re?t.jsxs(t.Fragment,{children:[t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.timeLimit,onChange:M=>S("timeLimit",parseInt(M)),disabled:D,children:e0.map(M=>t.jsx("option",{value:M.value,children:M.label},M.value))})}),t.jsxs(Oe,{label:" ",children:[" ",t.jsxs("p",{className:"text-sm text-gray-300",children:[s0," ( )"]})," "]})]}):t.jsxs(t.Fragment,{children:[t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.timeLimit,onChange:M=>S("timeLimit",parseInt(M)),disabled:D,children:Zh.map(M=>t.jsx("option",{value:M.value,children:M.label},M.value))})}),t.jsx(Oe,{label:"",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(q,{value:i.byoyomiTime,onChange:M=>S("byoyomiTime",parseInt(M)),disabled:D,children:n0.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))}),t.jsx(q,{value:i.byoyomiCount,onChange:M=>S("byoyomiCount",parseInt(M)),disabled:D,children:t0.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})]})})]})),G&&t.jsxs(t.Fragment,{children:[t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.diceGoRounds??3,onChange:M=>S("diceGoRounds",parseInt(M,10)),disabled:D,children:[1,2,3].map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.oddDiceCount??1,onChange:M=>S("oddDiceCount",parseInt(M,10)),disabled:D,children:Xd.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.evenDiceCount??1,onChange:M=>S("evenDiceCount",parseInt(M,10)),disabled:D,children:Xd.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})})]}),ce&&t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.captureTarget,onChange:M=>S("captureTarget",parseInt(M)),disabled:D,children:Kd.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),ve&&t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.captureTarget,onChange:M=>S("captureTarget",parseInt(M)),disabled:D,children:Xh.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),F&&t.jsxs(t.Fragment,{children:[t.jsx(Oe,{label:" ",children:t.jsx("input",{type:"checkbox",checked:i.has33Forbidden,onChange:M=>S("has33Forbidden",M.target.checked),disabled:D,className:"w-5 h-5"})}),t.jsx(Oe,{label:" ",children:t.jsx("input",{type:"checkbox",checked:i.hasOverlineForbidden,onChange:M=>S("hasOverlineForbidden",M.target.checked),disabled:D,className:"w-5 h-5"})})]}),X&&t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.baseStones,onChange:M=>S("baseStones",parseInt(M)),disabled:D,children:ji.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),ee&&t.jsxs(t.Fragment,{children:[t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.hiddenStoneCount,onChange:M=>S("hiddenStoneCount",parseInt(M)),disabled:D,children:Qd.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.scanCount,onChange:M=>S("scanCount",parseInt(M)),disabled:D,children:Jd.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})})]}),xe&&t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.missileCount,onChange:M=>S("missileCount",parseInt(M)),disabled:D,children:Yd.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),J&&(()=>{var ie,oe,ue,le,ge,je;const M=(ie=i.mixedModes)==null?void 0:ie.includes(T.Base),Y=(oe=i.mixedModes)==null?void 0:oe.includes(T.Capture);return t.jsxs("div",{className:"col-span-2 pt-2 border-t border-gray-700",children:[t.jsx("h3",{className:"font-semibold text-gray-300 mb-2",children:"  (2  )"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Qe.filter(me=>me.mode!==T.Standard&&me.mode!==T.Mix).map(me=>{var Ue;const ke=me.mode===T.Base&&Y||me.mode===T.Capture&&M;return t.jsxs("label",{className:`flex items-center gap-2 p-2 bg-gray-700/50 rounded-md ${D||ke?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[t.jsx("input",{type:"checkbox",checked:(Ue=i.mixedModes)==null?void 0:Ue.includes(me.mode),onChange:Le=>E(me.mode,Le.target.checked),disabled:D||ke,className:"w-4 h-4"}),t.jsx("span",{children:me.mode})]},me.mode)})}),((ue=i.mixedModes)==null?void 0:ue.includes(T.Base))&&t.jsx(Oe,{label:" ",className:"mt-4",children:t.jsx(q,{value:i.baseStones,onChange:me=>S("baseStones",parseInt(me)),disabled:D,children:ji.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})}),((le=i.mixedModes)==null?void 0:le.includes(T.Hidden))&&t.jsxs(t.Fragment,{children:[t.jsx(Oe,{label:" ",className:"mt-2",children:t.jsx(q,{value:i.hiddenStoneCount,onChange:me=>S("hiddenStoneCount",parseInt(me)),disabled:D,children:Qd.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})}),t.jsx(Oe,{label:" ",className:"mt-2",children:t.jsx(q,{value:i.scanCount,onChange:me=>S("scanCount",parseInt(me)),disabled:D,children:Jd.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})})]}),((ge=i.mixedModes)==null?void 0:ge.includes(T.Missile))&&t.jsx(Oe,{label:" ",className:"mt-2",children:t.jsx(q,{value:i.missileCount,onChange:me=>S("missileCount",parseInt(me)),disabled:D,children:Yd.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})}),((je=i.mixedModes)==null?void 0:je.includes(T.Capture))&&t.jsx(Oe,{label:" ",className:"mt-2",children:t.jsx(q,{value:i.captureTarget,onChange:me=>S("captureTarget",parseInt(me)),disabled:D,children:Kd.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})})]})})(),K&&t.jsxs(t.Fragment,{children:[t.jsx(Oe,{label:"",children:t.jsx(q,{value:i.alkkagiRounds,onChange:M=>S("alkkagiRounds",parseInt(M)),disabled:D,children:l0.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.alkkagiPlacementType,onChange:M=>S("alkkagiPlacementType",M),disabled:D,children:Object.values(Nc).map(M=>t.jsx("option",{value:M,children:M},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.alkkagiLayout,onChange:M=>S("alkkagiLayout",M),disabled:D,children:Object.values(Kl).map(M=>t.jsx("option",{value:M,children:M},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.alkkagiStoneCount,onChange:M=>S("alkkagiStoneCount",parseInt(M)),disabled:D,children:su.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.alkkagiGaugeSpeed,onChange:M=>S("alkkagiGaugeSpeed",parseInt(M)),disabled:D,children:So.map(M=>t.jsx("option",{value:M.value,children:M.label},M.value))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.alkkagiSlowItemCount,onChange:M=>S("alkkagiSlowItemCount",parseInt(M)),disabled:D,children:Zd.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.alkkagiAimingLineItemCount,onChange:M=>S("alkkagiAimingLineItemCount",parseInt(M)),disabled:D,children:Zd.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})})]}),Z&&t.jsxs(t.Fragment,{children:[t.jsx(Oe,{label:"",children:t.jsx(q,{value:i.curlingRounds,onChange:M=>S("curlingRounds",parseInt(M)),disabled:D,children:r0.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.curlingStoneCount,onChange:M=>S("curlingStoneCount",parseInt(M)),disabled:D,children:ru.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.curlingGaugeSpeed,onChange:M=>S("curlingGaugeSpeed",parseInt(M)),disabled:D,children:Co.map(M=>t.jsx("option",{value:M.value,children:M.label},M.value))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.curlingSlowItemCount,onChange:M=>S("curlingSlowItemCount",parseInt(M)),disabled:D,children:eu.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})}),t.jsx(Oe,{label:" ",children:t.jsx(q,{value:i.curlingAimingLineItemCount,onChange:M=>S("curlingAimingLineItemCount",parseInt(M)),disabled:D,children:eu.map(M=>t.jsxs("option",{value:M,children:[M,""]},M))})})]})]})]}),t.jsx("div",{className:"mt-6 border-t border-gray-700 pt-6",children:Q()})]})})},eb=(e,n)=>{if(e.isTopmost!==n.isTopmost||JSON.stringify(e.negotiation)!==JSON.stringify(n.negotiation)||JSON.stringify(e.currentUser)!==JSON.stringify(n.currentUser))return!1;const l=(i=>(i.negotiation.challenger.id===i.currentUser.id?i.negotiation.opponent:i.negotiation.challenger).id)(e),r=e.onlineUsers.find(i=>i.id===l),a=n.onlineUsers.find(i=>i.id===l);return JSON.stringify(r)===JSON.stringify(a)},Mx=Mn.memo(Zy,eb),tb=({pos:e})=>t.jsx("div",{className:`w-[22%] h-[22%] bg-black rounded-full absolute ${e}`}),nb=({value:e})=>{var s;const n={1:["top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"],2:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],3:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],4:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/4 right-1/4 translate-x-1/2 -translate-y-1/2","bottom-1/4 left-1/4 -translate-x-1/2 translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],5:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/4 right-1/4 translate-x-1/2 -translate-y-1/2","top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","bottom-1/4 left-1/4 -translate-x-1/2 translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],6:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/4 right-1/4 translate-x-1/2 -translate-y-1/2","top-1/2 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/2 right-1/4 translate-x-1/2 -translate-y-1/2","bottom-1/4 left-1/4 -translate-x-1/2 translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"]};return t.jsx("div",{className:"w-full h-full relative",children:(s=n[e])==null?void 0:s.map((l,r)=>t.jsx(tb,{pos:l},r))})},Xn=({value:e,isRolling:n,sides:s=6,size:l=60,onClick:r,disabled:a=!1,displayText:i,color:o="gray"})=>{const[c,d]=f.useState(e||1),u=!a&&!n&&r;f.useEffect(()=>{let m;return n?m=window.setInterval(()=>{d(Math.floor(Math.random()*s)+1)},50):d(e||1),()=>{m&&clearInterval(m)}},[n,e,s]);const p={gray:"bg-gray-100 hover:bg-white text-black",blue:"bg-blue-400 hover:bg-blue-300 text-white",yellow:"bg-yellow-400 hover:bg-yellow-300 text-black"};return t.jsx("div",{onClick:u?r:void 0,className:`flex items-center justify-center rounded-lg shadow-md transition-all duration-200 p-1
                ${u?`cursor-pointer hover:shadow-lg hover:-translate-y-1 ${p[o]}`:`${p[o]}`}
                ${a?"opacity-60 cursor-not-allowed":""}
                ${n?"animate-dice-flicker":""}`,style:{width:l,height:l},children:i?t.jsx("span",{className:"select-none font-bold",style:{fontSize:l*.5},children:i}):t.jsx(nb,{value:c})})},sb=e=>{var C,I,R,A,O,L;const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,gameStatus:o,turnOrderRollReady:c,animation:d}=n,[u,p]=f.useState(i0),m=s.id===a.id?i:a;f.useEffect(()=>{let Q;const D=o==="dice_turn_rolling"?n.turnOrderRollDeadline:o==="dice_turn_choice"?n.turnChoiceDeadline:null;if(D){const $=()=>{const q=Math.max(0,Math.ceil((D-Date.now())/1e3));p(q)};$(),Q=window.setInterval($,1e3)}return()=>{Q&&clearInterval(Q)}},[o,n.turnOrderRollDeadline,n.turnChoiceDeadline]);const h=c==null?void 0:c[s.id],y=(d==null?void 0:d.type)==="dice_roll_turn"?d:null,b=o==="dice_turn_rolling_animating",j=!!(n.turnOrderRolls&&n.turnOrderRolls[s.id]!=null),g=o==="dice_turn_choice"||!!y&&!b,x=y?s.id===a.id?y.p1Roll:y.p2Roll:(C=n.turnOrderRolls)==null?void 0:C[s.id],v=y?m.id===a.id?y.p1Roll:y.p2Roll:(I=n.turnOrderRolls)==null?void 0:I[m.id];let w="",k="";g&&x!=null&&v!=null&&(x>v?(w="!",k="text-green-400"):x<v?(w="!",k="text-red-400"):(w="!",k="text-yellow-400"));const P=(R=Ee.find(Q=>Q.id===s.avatarId))==null?void 0:R.url,S=(A=Re.find(Q=>Q.id===s.borderId))==null?void 0:A.url,E=(O=Ee.find(Q=>Q.id===m.avatarId))==null?void 0:O.url,_=(L=Re.find(Q=>Q.id===m.borderId))==null?void 0:L.url;return t.jsx(be,{title:"/ ",windowId:"dice-go-turn-selection",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6",children:"    .     / ."}),n.turnOrderRollResult==="tie"&&t.jsx("p",{className:"text-yellow-400 font-bold text-lg mb-4 animate-pulse",children:"!    ."}),t.jsxs("div",{className:"flex justify-around w-full items-center my-4",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2 w-24",children:[t.jsx(Ce,{userId:s.id,userName:s.nickname,size:64,avatarUrl:P,borderUrl:S}),t.jsx("span",{className:"font-semibold",children:s.nickname}),(h||y||j)&&t.jsx(Xn,{value:g?x??null:null,isRolling:b,sides:6,size:64})]}),g&&x!=null&&v!=null?t.jsxs("div",{className:"text-4xl font-bold",children:[x," : ",v]}):t.jsx("span",{className:"text-3xl font-bold",children:"VS"}),t.jsxs("div",{className:"flex flex-col items-center gap-2 w-24",children:[t.jsx(Ce,{userId:m.id,userName:m.nickname,size:64,avatarUrl:E,borderUrl:_}),t.jsx("span",{className:"font-semibold",children:m.nickname}),((c==null?void 0:c[m.id])||y||j)&&t.jsx(Xn,{value:g?v??null:null,isRolling:b,sides:6,size:64})]})]}),t.jsx("div",{className:"min-h-[6rem] mt-6 text-xl font-bold flex items-center justify-center",children:o==="dice_turn_choice"?n.turnChooserId===s.id?t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsxs("p",{className:"text-base font-normal text-gray-300 mb-2",children:["   . (",u,")"]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx(U,{onClick:()=>l({type:"DICE_CHOOSE_TURN",payload:{gameId:r,choice:"first"}}),colorScheme:"blue",children:" ()"}),t.jsx(U,{onClick:()=>l({type:"DICE_CHOOSE_TURN",payload:{gameId:r,choice:"second"}}),colorScheme:"gray",children:" ()"})]})]}):t.jsx("p",{className:"text-base text-green-400 animate-pulse",children:" /  ..."}):g&&w?t.jsx("p",{className:k,children:w}):!h&&!y?t.jsxs(U,{onClick:()=>l({type:"DICE_READY_FOR_TURN_ROLL",payload:{gameId:r}}),colorScheme:"blue",children:[" (",u,")"]}):h&&!y?t.jsx("p",{className:"text-base text-green-400 animate-pulse",children:"  ..."}):b?t.jsx("p",{className:"text-base text-gray-400 animate-pulse",children:" ..."}):null})]})})},lb=({session:e})=>{const{boardState:n,baseStones:s,settings:{boardSize:l}}=e,r=300,a=r/l,i=a/2,o=a*.47,c=o*2*.7,d=c/2,u=p=>({cx:i+p.x*a,cy:i+p.y*a});return t.jsxs("svg",{viewBox:`0 0 ${r} ${r}`,className:"w-full h-full bg-[#e0b484] rounded-md shadow-inner",children:[Array.from({length:l}).map((p,m)=>t.jsxs("g",{children:[t.jsx("line",{x1:i+m*a,y1:i,x2:i+m*a,y2:r-i,stroke:"#54432a",strokeWidth:"1"}),t.jsx("line",{x1:i,y1:i+m*a,x2:r-i,y2:i+m*a,stroke:"#54432a",strokeWidth:"1"})]},m)),s==null?void 0:s.map((p,m)=>{const{cx:h,cy:y}=u(p);return t.jsxs("g",{children:[t.jsx("circle",{cx:h,cy:y,r:o,fill:p.player===B.Black?"#111827":"#f5f2e8"}),t.jsx("image",{href:p.player===B.Black?Da:Oa,x:h-d,y:y-d,width:c,height:c})]},`base-stone-${m}`)})]})},rb=({session:e,currentUser:n,onAction:s})=>{var w,k,P,S;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d,finalKomi:u}=e,p=c==null?void 0:c[n.id],[m,h]=f.useState(20);if(f.useEffect(()=>{const E=d||Date.now()+2e4,_=setInterval(()=>{const C=Math.max(0,Math.ceil((E-Date.now())/1e3));h(C)},1e3);return()=>clearInterval(_)},[d]),!i||!o)return null;const y=r.id===i?r:a,b=r.id===o?r:a,j=(w=Ee.find(E=>E.id===y.avatarId))==null?void 0:w.url,g=(k=Re.find(E=>E.id===y.borderId))==null?void 0:k.url,x=(P=Ee.find(E=>E.id===b.avatarId))==null?void 0:P.url,v=(S=Re.find(E=>E.id===b.borderId))==null?void 0:S.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"base-start-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:"/ .     20   ."}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:j,borderUrl:g}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,size:64,avatarUrl:x,borderUrl:v}),t.jsx("p",{className:"mt-2 font-bold",children:b.nickname}),t.jsxs("p",{className:"font-semibold",children:[" (: ",u,")"]})]})]}),t.jsx("div",{className:"my-4 mx-auto w-full max-w-xs",children:t.jsx(lb,{session:e})}),t.jsx(U,{onClick:()=>s({type:"CONFIRM_BASE_REVEAL",payload:{gameId:l}}),disabled:!!p,className:"w-full py-3",children:p?"   ...":`  (${m})`})]})})},ab=({session:e,currentUser:n,onAction:s})=>{var I,R,A,O;const{id:l,alkkagiRoundSummary:r,player1:a,player2:i,roundEndConfirmations:o,revealEndTime:c,alkkagiStones:d}=e,[u,p]=f.useState(30),m=!!(o!=null&&o[n.id]);if(f.useEffect(()=>{const L=c||Date.now()+3e4,Q=setInterval(()=>{const D=Math.max(0,Math.ceil((L-Date.now())/1e3));p(D)},1e3);return()=>clearInterval(Q)},[c]),!r)return null;const{round:h,winnerId:y}=r,b=a.id===y?a:i,j=a.id===e.blackPlayerId?B.Black:B.White,g=i.id===e.blackPlayerId?B.Black:B.White,x=(d==null?void 0:d.filter(L=>L.player===j&&L.onBoard).length)??0,v=(d==null?void 0:d.filter(L=>L.player===g&&L.onBoard).length)??0,w=(I=Ee.find(L=>L.id===a.avatarId))==null?void 0:I.url,k=(R=Re.find(L=>L.id===a.borderId))==null?void 0:R.url,P=(A=Ee.find(L=>L.id===i.avatarId))==null?void 0:A.url,S=(O=Re.find(L=>L.id===i.borderId))==null?void 0:O.url,E=h+1,_=e.settings.alkkagiRounds||1;let C="        .";return E>_&&(C="  .   ."),t.jsx(be,{title:`${h}  `,initialWidth:550,windowId:"alkkari-round-summary",children:t.jsxs("div",{className:"text-white text-center",children:[t.jsxs("h2",{className:"text-2xl font-bold mb-2",children:[b.nickname,"  !"]}),t.jsx("p",{className:"text-gray-300 mb-6",children:C}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 my-6",children:[t.jsxs("div",{className:"flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border-2 border-gray-600",children:[t.jsx(Ce,{userId:a.id,userName:a.nickname,size:80,avatarUrl:w,borderUrl:k}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:a.nickname}),t.jsxs("p",{className:"text-lg font-semibold",children:[" : ",x,""]})]}),t.jsxs("div",{className:"flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border-2 border-gray-600",children:[t.jsx(Ce,{userId:i.id,userName:i.nickname,size:80,avatarUrl:P,borderUrl:S}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:i.nickname}),t.jsxs("p",{className:"text-lg font-semibold",children:[" : ",v,""]})]})]}),t.jsx(U,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:!!m,className:"w-full py-3",children:m?"   ...":`${E>_?"  ":"  "} (${u})`})]})})},ib=({session:e,currentUser:n,onAction:s})=>{var S,E,_,C;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d,turnOrderRolls:u}=e,p=c==null?void 0:c[n.id],[m,h]=f.useState(10);if(f.useEffect(()=>{const I=d||Date.now()+1e4,R=setInterval(()=>{const A=Math.max(0,Math.ceil((I-Date.now())/1e3));h(A)},1e3);return()=>clearInterval(R)},[d]),!i||!o)return null;const y=r.id===i?r:a,b=r.id===o?r:a;n.id;const j=(u==null?void 0:u[r.id])??null,g=(u==null?void 0:u[a.id])??null,x=j!==null&&g!==null&&j>g?r:a,v=(S=Ee.find(I=>I.id===y.avatarId))==null?void 0:S.url,w=(E=Re.find(I=>I.id===y.borderId))==null?void 0:E.url,k=(_=Ee.find(I=>I.id===b.avatarId))==null?void 0:_.url,P=(C=Re.find(I=>I.id===b.borderId))==null?void 0:C.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"dice-go-start-confirm",children:t.jsxs("div",{className:"text-white",children:[j!==null&&g!==null&&t.jsxs("p",{className:"text-center text-gray-300 mb-2",children:["  ",t.jsx("span",{className:"font-bold text-yellow-300",children:x.nickname}),"  / ."]}),t.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm",children:"    10    ."}),j!==null&&g!==null&&t.jsxs("div",{className:"flex justify-around items-center my-4 bg-gray-900/50 p-3 rounded-lg",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(Ce,{userId:r.id,userName:r.nickname,size:48}),t.jsx("span",{className:"font-semibold text-sm",children:r.nickname}),t.jsx(Xn,{value:j,isRolling:!1,size:48})]}),t.jsx("span",{className:"text-2xl font-bold",children:"VS"}),t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(Ce,{userId:a.id,userName:a.nickname,size:48}),t.jsx("span",{className:"font-semibold text-sm",children:a.nickname}),t.jsx(Xn,{value:g,isRolling:!1,size:48})]})]}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:v,borderUrl:w}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,size:64,avatarUrl:k,borderUrl:P}),t.jsx("p",{className:"mt-2 font-bold",children:b.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]})]}),t.jsx(U,{onClick:()=>s({type:"DICE_CONFIRM_START",payload:{gameId:l}}),disabled:!!p,className:"w-full py-3 mt-6",children:p?"   ...":`  (${m})`})]})})},ob=({session:e,currentUser:n,onAction:s})=>{var _,C,I,R,A;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d}=e,u=c==null?void 0:c[n.id],[p,m]=f.useState(30);if(f.useEffect(()=>{const O=d||Date.now()+3e4,L=setInterval(()=>{const Q=Math.max(0,Math.ceil((O-Date.now())/1e3));m(Q)},1e3);return()=>clearInterval(L)},[d]),!i||!o)return null;const h=r.id===i?r:a,y=r.id===o?r:a,b=e.rpsState&&Object.values(e.rpsState).every(O=>O!==null),j=i===r.id?r.id:a.id,g=r.id===j?r:a,v=((_=e.turnChoices)==null?void 0:_[g.id])==="first"?"()":"()",w=b?`${g.nickname}   ${v}() .`:"/  .",k=(C=Ee.find(O=>O.id===h.avatarId))==null?void 0:C.url,P=(I=Re.find(O=>O.id===h.borderId))==null?void 0:I.url,S=(R=Ee.find(O=>O.id===y.avatarId))==null?void 0:R.url,E=(A=Re.find(O=>O.id===y.borderId))==null?void 0:A.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"curling-start-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:w}),t.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm",children:"    30    ."}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:h.id,userName:h.nickname,size:64,avatarUrl:k,borderUrl:P}),t.jsx("p",{className:"mt-2 font-bold",children:h.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:S,borderUrl:E}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]})]}),t.jsx(U,{onClick:()=>s({type:"CONFIRM_CURLING_START",payload:{gameId:l}}),disabled:!!u,className:"w-full py-3 mt-6",children:u?"   ...":`  (${p})`})]})})},cb=({session:e,currentUser:n,onAction:s})=>{var P,S,E,_;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d}=e,u=c==null?void 0:c[n.id],[p,m]=f.useState(30);if(f.useEffect(()=>{const C=d||Date.now()+3e4,I=setInterval(()=>{const R=Math.max(0,Math.ceil((C-Date.now())/1e3));m(R)},1e3);return()=>clearInterval(I)},[d]),!i||!o)return null;const h=r.id===i?r:a,y=r.id===o?r:a,b=e.rpsState&&Object.values(e.rpsState).every(C=>C!==null),j=i===r.id?r:a,g=b?`${j.nickname}   () .`:"/  .",x=(P=Ee.find(C=>C.id===h.avatarId))==null?void 0:P.url,v=(S=Re.find(C=>C.id===h.borderId))==null?void 0:S.url,w=(E=Ee.find(C=>C.id===y.avatarId))==null?void 0:E.url,k=(_=Re.find(C=>C.id===y.borderId))==null?void 0:_.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"alkkagi-start-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:g}),t.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm",children:"    30    ."}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:h.id,userName:h.nickname,size:64,avatarUrl:x,borderUrl:v}),t.jsx("p",{className:"mt-2 font-bold",children:h.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:w,borderUrl:k}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]})]}),t.jsx(U,{onClick:()=>s({type:"CONFIRM_ALKKAGI_START",payload:{gameId:l}}),disabled:!!u,className:"w-full py-3 mt-6",children:u?"   ...":`  (${p})`})]})})},db=({item:e})=>t.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-1 bg-gray-900/50 rounded-md",title:e.name,children:[t.jsx("img",{src:e.image,alt:e.name,className:"w-12 h-12 object-contain"}),t.jsxs("span",{className:"text-xs mt-1 text-gray-300 truncate w-full",children:[e.name,e.quantity>1?` x${e.quantity}`:""]})]}),ub=({session:e,currentUser:n,onAction:s,onClose:l})=>{var m,h,y;const r=e.winner===B.Black,a=(m=e.summary)==null?void 0:m[n.id],i=Jl.findIndex(b=>b.id===e.stageId),o=Jl[i+1],c=r&&o&&(n.singlePlayerProgress??0)>i,d=()=>{s({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:e.stageId}}),l()},u=()=>{c&&(s({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:o.id}}),l())},p=()=>{sessionStorage.setItem("postGameRedirect","#/singleplayer"),s({type:"LEAVE_AI_GAME",payload:{gameId:e.id}}),l()};return t.jsx(be,{title:r?" ":" ",onClose:l,windowId:"sp-summary-redesigned",initialWidth:500,children:t.jsxs("div",{className:`relative text-center p-4 rounded-lg overflow-hidden ${r?"bg-gradient-to-br from-blue-900/50 to-gray-900":"bg-gradient-to-br from-red-900/50 to-gray-900"}`,children:[r&&t.jsx("div",{className:"absolute -top-1/2 -left-1/4 w-full h-full bg-yellow-400/20 rounded-full blur-3xl animate-pulse"}),t.jsx("h1",{className:`text-5xl font-black mb-4 tracking-widest ${r?"text-yellow-300":"text-red-400"}`,style:{textShadow:r?"0 0 15px rgba(250, 204, 21, 0.5)":"0 0 10px rgba(220, 38, 38, 0.5)"},children:r?"MISSION CLEAR":"MISSION FAILED"}),a&&t.jsxs("div",{className:"bg-black/30 backdrop-blur-sm p-4 rounded-lg my-4 space-y-3 border border-gray-700/50",children:[t.jsx("h2",{className:"font-bold text-lg text-gray-200",children:""}),t.jsxs("div",{className:"flex justify-center items-center gap-6 text-lg",children:[a.xp&&a.xp.change>0&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-400",children:" "}),t.jsxs("p",{className:"font-bold text-green-400 sparkle-animation",children:["+",a.xp.change," XP"]})]}),a.gold&&a.gold>0&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-8 h-8"}),t.jsxs("span",{className:"font-bold text-yellow-400 sparkle-animation",children:["+",a.gold.toLocaleString()]})]})]}),a.items&&a.items.length>0&&t.jsxs("div",{className:"pt-3 border-t border-gray-700/50",children:[t.jsx("h3",{className:"text-sm text-gray-400 mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-5 gap-2",children:a.items.map(b=>t.jsx(db,{item:b},b.id))})]}),!r&&(!a||a.gold===0&&((h=a.xp)==null?void 0:h.change)===0&&((y=a.items)==null?void 0:y.length)===0)&&t.jsx("p",{className:"text-gray-500",children:"  ."})]}),t.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[t.jsx(U,{onClick:p,colorScheme:"gray",className:"w-full",children:""}),t.jsx(U,{onClick:d,colorScheme:"yellow",className:"w-full",children:""}),t.jsxs(U,{onClick:u,colorScheme:"blue",className:"w-full",disabled:!c,children:[" ",o?`: ${o.name.replace(" ","")}`:""]}),t.jsx(U,{onClick:l,colorScheme:"green",className:"w-full",children:""})]})]})})},Lu=e=>{const{session:n,currentUser:s,onAction:l,confirmModalType:r,onHideConfirmModal:a,showResultModal:i,onCloseResults:o,isSpectator:c,activeNegotiation:d,onlineUsers:u,onViewUser:p}=e,{gameStatus:m,mode:h,id:y}=n,b=()=>{if(d)return t.jsx(Mx,{negotiation:d,currentUser:s,onAction:l,onlineUsers:u});if(n.isSinglePlayer&&i)return t.jsx(ub,{session:n,currentUser:s,onAction:l,onClose:o});if(c&&["nigiri_choosing","nigiri_guessing","base_placement","komi_bidding","capture_bidding","dice_rps","thief_rps","alkkagi_rps","curling_rps","omok_rps","ttamok_rps","turn_preference_selection","thief_role_selection","alkkagi_simultaneous_placement","dice_turn_rolling"].includes(m))return null;const v=["dice_rps","dice_rps_reveal","thief_rps","thief_rps_reveal","alkkagi_rps","alkkagi_rps_reveal","curling_rps","curling_rps_reveal","omok_rps","omok_rps_reveal","ttamok_rps","ttamok_rps_reveal"];if(m==="dice_turn_rolling"||m==="dice_turn_rolling_animating"||m==="dice_turn_choice")return t.jsx(sb,{session:n,currentUser:s,onAction:l});if(m==="dice_start_confirmation")return t.jsx(ib,{session:n,currentUser:s,onAction:l});if(m==="turn_preference_selection")return t.jsx(Fy,{session:n,currentUser:s,onAction:l,tiebreaker:n.turnSelectionTiebreaker});if(["nigiri_choosing","nigiri_guessing","nigiri_reveal"].includes(m))return t.jsx($y,{session:n,currentUser:s,onAction:l});if(m==="capture_bidding")return t.jsx(By,{session:n,currentUser:s,onAction:l});if(["capture_tiebreaker","capture_reveal"].includes(m))return t.jsx(Oy,{session:n,currentUser:s,onAction:l});if(m==="base_placement")return t.jsx(Ky,{session:n,currentUser:s,onAction:l});if(["komi_bidding","komi_bid_reveal"].includes(m))return t.jsx(Jy,{session:n,currentUser:s,onAction:l});if(m==="base_game_start_confirmation")return t.jsx(rb,{session:n,currentUser:s,onAction:l});if(v.includes(m))return t.jsx(qy,{session:n,currentUser:s,onAction:l});if(m==="alkkagi_start_confirmation")return t.jsx(cb,{session:n,currentUser:s,onAction:l});if(m==="curling_start_confirmation")return t.jsx(ob,{session:n,currentUser:s,onAction:l});if(m==="thief_role_selection")return t.jsx(zy,{session:n,currentUser:s,onAction:l});if(m==="thief_role_confirmed")return t.jsx(Uy,{session:n,currentUser:s,onAction:l});if(m==="thief_round_end")return t.jsx(Wy,{session:n,currentUser:s,onAction:l});if(m==="curling_round_end")return t.jsx(Hy,{session:n,currentUser:s,onAction:l});if(m==="alkkagi_round_end")return t.jsx(ab,{session:n,currentUser:s,onAction:l});if(m==="dice_round_end")return t.jsx(Vy,{session:n,currentUser:s,onAction:l});if(m==="alkkagi_simultaneous_placement")return t.jsx(Yy,{session:n,currentUser:s});if(i){if(m==="ended")return t.jsx(Ly,{session:n,currentUser:s,onConfirm:o});if(m==="no_contest")return t.jsx(Gy,{session:n,currentUser:s,onConfirm:o})}return null},g=r?{resign:{title:" ",message:" ?  .",confirmText:"",onConfirm:()=>l({type:"RESIGN_GAME",payload:{gameId:y}})}}[r]:null;return t.jsxs(t.Fragment,{children:[b(),g&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm p-6 border border-gray-700",children:[t.jsx("h2",{className:"text-xl font-bold text-center mb-4",children:g.title}),t.jsx("p",{className:"text-center text-gray-300 mb-6",children:g.message}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsx(U,{onClick:a,colorScheme:"gray",className:"w-full",children:""}),t.jsx(U,{onClick:()=>{a(),g.onConfirm()},colorScheme:"red",className:"w-full",children:g.confirmText})]})]})})]})};function $u(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const mb=e=>{const{gameStatus:n,currentPlayer:s,blackPlayerId:l,whitePlayerId:r,player1:a,player2:i,mode:o,settings:c,passCount:d,moveHistory:u,alkkagiRound:p}=e,m=b=>{const j=b===B.Black?l:r;return j?a.id===j?a:i:null},h=m(s);if(e.mode===T.Dice&&e.lastWhiteGroupInfo&&e.lastWhiteGroupInfo.liberties<=6){const b=e.settings.diceGoRounds??1;let j=` !  ${e.lastWhiteGroupInfo.liberties}`;if(e.round===b&&b>0){const g=a0[b-1];g&&(j+=` (   +${g})`)}return j}const y=u.length>0?u[u.length-1]:null;if(d>=2&&(y==null?void 0:y.x)===-1)return"    .";if(n!=="ended"&&d===1&&(y==null?void 0:y.x)===-1){const b=s===B.Black?B.White:B.Black,j=m(b);if(j)return`${j.nickname} .`}switch(n){case"playing":return h?`${h.nickname} .`:"  ";case"nigiri_choosing":case"nigiri_guessing":case"nigiri_reveal":return"   ...";case"base_placement":return`  ... (${c.baseStones})`;case"komi_bidding":return"  ...";case"ended":return" ";case"no_contest":return" ";case"rematch_pending":return"  ...";case"hidden_placing":case"scanning":case"missile_selecting":return"  ...";case"hidden_final_reveal":return"    .";case"alkkagi_placement":{const b=p||1,j=c.alkkagiRounds||1;return b>1?`  . (${b} / ${j} )`:` . (${b} / ${j} )`}case"alkkagi_playing":{const b=p||1,j=c.alkkagiRounds||1;return`${h==null?void 0:h.nickname} . (${b} / ${j} )`}case"alkkagi_round_end":return" !  .";case"dice_rolling":return h?`${h.nickname}   .`:"  ";case"thief_rolling":return h?`${h.nickname}   .`:"  ";case"curling_tiebreaker_preference_selection":case"curling_tiebreaker_rps":case"curling_tiebreaker_rps_reveal":return"   ...";case"curling_tiebreaker_playing":return`  ... (${h==null?void 0:h.nickname} )`;default:return o===T.Dice?`  (${e.round} / ${e.settings.diceGoRounds} )`:o===T.Thief?`  (${e.round} )`:h?`${h.nickname} .`:"  ..."}},Bu=({session:e})=>{var j;const[n,s]=f.useState(30),[l,r]=f.useState(100),[a,i]=f.useState(null),o=$u(e.lastTimeoutPlayerId),c=$u((j=e.foulInfo)==null?void 0:j.message),d=f.useMemo(()=>nt.some(g=>g.mode===e.mode)&&e.turnDeadline&&e.turnStartTime&&["dice_rolling","dice_placing","thief_rolling","thief_placing"].includes(e.gameStatus),[e.mode,e.turnDeadline,e.turnStartTime,e.gameStatus]);f.useEffect(()=>{if(!d){r(100);return}const g=e.turnDeadline-e.turnStartTime;if(g<=0)return;const x=()=>{const w=e.turnDeadline-Date.now(),k=Math.max(0,w/g*100);r(k)};x();const v=setInterval(x,100);return()=>clearInterval(v)},[d,e.turnDeadline,e.turnStartTime]),f.useEffect(()=>{if(e.foulInfo&&e.foulInfo.message!==c){i(e.foulInfo.message),Pe.timeoutFoul();const g=setTimeout(()=>i(null),5e3);return()=>clearTimeout(g)}},[e.foulInfo,c]),f.useEffect(()=>{if(e.lastTimeoutPlayerId&&e.lastTimeoutPlayerId!==o&&nt.some(x=>x.mode===e.mode)){const x=e.player1.id===e.lastTimeoutPlayerId?e.player1:e.player2;i(`${x.nickname}  !`);const v=setTimeout(()=>i(null),5e3);return()=>clearTimeout(v)}},[e.lastTimeoutPlayerId,o,e.mode,e.player1,e.player2]),f.useEffect(()=>{["playing","ended","no_contest","alkkagi_playing","curling_playing","dice_rolling","dice_placing","thief_rolling","thief_placing"].includes(e.gameStatus)&&i(null)},[e.gameStatus]);const u=["hidden_placing","scanning","missile_selecting"].includes(e.gameStatus);f.useEffect(()=>{if(!u||!e.itemUseDeadline)return;const g=()=>{const v=Math.max(0,Math.ceil((e.itemUseDeadline-Date.now())/1e3));s(v)};g();const x=setInterval(g,500);return()=>clearInterval(x)},[u,e.itemUseDeadline]);const p=e.isSinglePlayer,m="flex-shrink-0 rounded-lg flex flex-col items-center justify-center shadow-inner py-1 h-12 border",h=p?"bg-stone-800/70 backdrop-blur-sm border-stone-700/50":"bg-secondary border-color",y=p?"text-amber-300":"text-highlight";if(a)return t.jsx("div",{className:"flex-shrink-0 bg-danger rounded-lg flex items-center justify-center shadow-inner animate-pulse py-1 h-12 border-2 border-red-500",children:t.jsx("p",{className:"font-bold text-white tracking-wider text-[clamp(0.875rem,3vmin,1.125rem)]",children:a})});if(e.mode===T.Dice&&e.gameStatus==="dice_placing"&&e.dice)return t.jsxs("div",{className:`${m} ${h} px-4 gap-1`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[": ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:e.dice.dice1})]}),t.jsx("div",{className:`w-px h-5 ${p?"bg-stone-600":"bg-border-color"}`}),t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[" : ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:e.stonesToPlace})]})]}),d&&t.jsx("div",{className:"w-full h-1 bg-tertiary rounded-full mt-1",children:t.jsx("div",{className:"h-1 bg-red-500 rounded-full",style:{width:`${l}%`}})})]});if(e.mode===T.Thief&&e.gameStatus==="thief_placing"&&e.dice){const{dice1:g,dice2:x}=e.dice,v=x>0?`${g}, ${x}`:`${g}`;return t.jsxs("div",{className:`${m} ${h} px-4 gap-2`,children:[t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[": ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:v})]}),t.jsx("div",{className:`w-px h-5 ${p?"bg-stone-600":"bg-border-color"}`}),t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[" : ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:e.stonesToPlace})]})]})}if(u){let g=" ";e.gameStatus==="hidden_placing"&&(g=" "),e.gameStatus==="scanning"&&(g=" "),e.gameStatus==="missile_selecting"&&(g=" ");const x=n/30*100;return t.jsxs("div",{className:`${m} ${h} px-4 gap-2`,children:[t.jsx("span",{className:`font-bold ${y} tracking-wider flex-shrink-0 text-[clamp(0.8rem,2.5vmin,1rem)]`,children:g}),t.jsx("div",{className:`w-full bg-tertiary rounded-full h-[clamp(0.5rem,1.5vh,0.75rem)] relative overflow-hidden border-2 ${p?"border-black/20":"border-tertiary"}`,children:t.jsx("div",{className:"absolute inset-0 bg-highlight rounded-full",style:{width:`${x}%`,transition:"width 0.5s linear"}})}),t.jsxs("span",{className:"font-mono font-bold text-primary w-[clamp(2rem,8vmin,2.5rem)] text-center text-[clamp(0.9rem,3vmin,1.1rem)]",children:[n,""]})]})}const b=mb(e);return t.jsxs("div",{className:`${m} ${h}`,children:[t.jsx("p",{className:`font-bold ${y} tracking-wider text-[clamp(0.8rem,2.5vmin,1rem)] text-center px-2`,children:b}),d&&t.jsx("div",{className:"w-11/12 h-1 bg-tertiary rounded-full mt-1",children:t.jsx("div",{className:"h-1 bg-red-500 rounded-full",style:{width:`${l}%`}})})]})},fb=({session:e,result:n,onClose:s})=>{var x,v,w;if(!n||!n.scoreDetails||!n.areaScore)return t.jsx(be,{title:"",onClose:s,initialWidth:380,windowId:"analysis-territory",modal:!1,children:t.jsx("p",{className:"text-center text-gray-400",children:"   ..."})});const{scoreDetails:l,winRateChange:r,scoreLead:a}=n,{mode:i,settings:o}=e,c=a??n.areaScore.black-n.areaScore.white,d=c>0?"":"",u=Math.abs(c).toFixed(1),p=n.winRateBlack,m=100-p,h=`rgba(220, 38, 38, ${Math.max(0,(p-50)/50*.7)})`,y=`rgba(59, 130, 246, ${Math.max(0,(m-50)/50*.7)})`,b=i===T.Speed||i===T.Mix&&((x=o.mixedModes)==null?void 0:x.includes(T.Speed)),j=i===T.Base||i===T.Mix&&((v=o.mixedModes)==null?void 0:v.includes(T.Base)),g=i===T.Hidden||i===T.Mix&&((w=o.mixedModes)==null?void 0:w.includes(T.Hidden));return t.jsx(be,{title:"",onClose:s,initialWidth:380,windowId:"analysis-territory",modal:!1,children:t.jsx("div",{className:"text-sm text-white",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-1 text-xs",children:[t.jsxs("span",{className:"font-semibold text-gray-300",children:[" ",p.toFixed(1),"%"]}),r!==void 0&&t.jsxs("span",{className:`font-bold text-xs ${r>0?"text-green-400":"text-red-400"}`,children:[r>0?"":""," ",Math.abs(r).toFixed(1),"%"]}),t.jsxs("span",{className:"font-semibold text-gray-300",children:[" ",m.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex w-full h-4 bg-gray-700 rounded-full overflow-hidden border-2 border-gray-900",children:[t.jsx("div",{className:"bg-black relative",style:{width:`${p}%`},children:t.jsx("div",{className:"absolute inset-0",style:{backgroundColor:h}})}),t.jsx("div",{className:"bg-white relative",style:{width:`${m}%`},children:t.jsx("div",{className:"absolute inset-0",style:{backgroundColor:y}})})]})]}),t.jsxs("div",{className:"flex justify-between pt-1",children:[t.jsx("span",{className:"font-medium text-gray-300",children:"  "}),t.jsxs("span",{className:"font-mono font-bold text-yellow-300",children:[d," ",u," "]})]}),t.jsx("div",{className:"bg-gray-900/50 p-3 rounded-lg my-2 text-xs",children:t.jsxs("div",{className:"grid grid-cols-2 gap-x-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("h4",{className:"font-bold text-center border-b border-gray-600 pb-1 mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.territory})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{className:"font-mono",children:l.black.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.deadStones??0})]}),j&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.baseStoneBonus})]}),g&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.hiddenStoneBonus})]}),b&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.timeBonus})]}),l.black.itemBonus>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.itemBonus})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-500 mt-1 pt-1 font-bold",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:n.areaScore.black.toFixed(1)})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("h4",{className:"font-bold text-center border-b border-gray-600 pb-1 mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.territory})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{className:"font-mono",children:l.white.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.deadStones??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.komi})]}),j&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.baseStoneBonus})]}),g&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.hiddenStoneBonus})]}),b&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.timeBonus})]}),l.white.itemBonus>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.itemBonus})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-500 mt-1 pt-1 font-bold",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:n.areaScore.white.toFixed(1)})]})]})]})})]})})})},xb=e=>{if(e<=0)return"READY";const n=Math.ceil(e/1e3),s=Math.floor(n/60),l=n%60;return`${String(s).padStart(2,"0")}:${String(l).padStart(2,"0")}`},Tx=["playing","alkkagi_playing","curling_playing","dice_rolling","dice_placing","thief_rolling","thief_placing"],pb=({session:e,isSpectator:n,onAction:s,currentUser:l})=>{var j,g;const[r,a]=f.useState("00:00"),{id:i,mode:o,gameStatus:c}=e;f.useEffect(()=>{var k;const x=(k=e.actionButtonCooldownDeadline)==null?void 0:k[l.id];if(!x){a("READY");return}const v=()=>{const P=x-Date.now();a(xb(P))};v();const w=setInterval(v,1e3);return()=>clearInterval(w)},[e.actionButtonCooldownDeadline,l.id]);const d=["ended","no_contest","rematch_pending"].includes(c),u=Qe.some(x=>x.mode===o)||nt.some(x=>x.mode===o);if(d||n||!u)return null;const p=(j=e.currentActionButtons)==null?void 0:j[l.id],m=p&&p.length>0,h=Tx.includes(c),y=(g=e.actionButtonUsedThisCycle)==null?void 0:g[l.id],b=r==="READY";return t.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[m&&!y?p.map(x=>t.jsx(U,{onClick:()=>s({type:"USE_ACTION_BUTTON",payload:{gameId:i,buttonName:x.name}}),colorScheme:x.type==="manner"?"green":"orange",className:"whitespace-nowrap text-[clamp(0.5rem,1.8vmin,0.75rem)] px-[clamp(0.3rem,1.5vmin,0.5rem)] py-[clamp(0.15rem,1vmin,0.25rem)]",title:x.message,disabled:n||!h,children:x.name},x.name)):t.jsx("span",{className:"text-xs text-gray-400",children:"  ..."}),t.jsx("span",{className:`text-xs font-mono ${b&&!y?"text-green-400":"text-gray-400"}`,children:r})]})},gb=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{var h,y;const{id:r,gameStatus:a}=e,i=a==="dice_rolling_animating",o=b=>{n&&a==="dice_rolling"&&(Pe.rollDice(1),s({type:"DICE_ROLL",payload:{gameId:r,itemType:b}}))},c=(h=e.diceGoItemUses)==null?void 0:h[l.id],d=(c==null?void 0:c.odd)??0,u=(c==null?void 0:c.even)??0,p=n&&a==="dice_rolling",m=i?null:(y=e.dice)==null?void 0:y.dice1;return t.jsxs("div",{className:`flex flex-row items-center justify-center gap-3 transition-all ${p?"animate-pulse-border-yellow":"border-2 border-transparent p-2 rounded-lg"}`,children:[t.jsx("div",{className:"flex flex-col items-center",children:t.jsx(Xn,{value:m??null,isRolling:i,size:48,onClick:()=>o(),disabled:!p})}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(Xn,{displayText:"",color:"blue",value:null,isRolling:i,size:48,onClick:()=>o("odd"),disabled:!p||d<=0}),t.jsxs("span",{className:"text-xs mt-1 font-bold",children:[d,""]})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(Xn,{displayText:"",color:"yellow",value:null,isRolling:i,size:48,onClick:()=>o("even"),disabled:!p||u<=0}),t.jsxs("span",{className:"text-xs mt-1 font-bold",children:[u,""]})]})]})},hb=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{var w,k;const{id:r,gameStatus:a,activeAlkkagiItems:i}=e,o=(w=e.alkkagiItemUses)==null?void 0:w[l.id],c=(o==null?void 0:o.slow)??e.settings.alkkagiSlowItemCount??0,d=(o==null?void 0:o.aimingLine)??e.settings.alkkagiAimingLineItemCount??0,u=(i==null?void 0:i[l.id])||[],p=P=>{s({type:"USE_ALKKAGI_ITEM",payload:{gameId:r,itemType:P}})},m=u.includes("slow"),h=u.includes("aimingLine"),y=n&&a==="alkkagi_playing",b="whitespace-nowrap text-[clamp(0.6rem,2.2vmin,0.875rem)] px-[clamp(0.4rem,1.8vmin,0.75rem)] py-[clamp(0.3rem,1.2vmin,0.625rem)]",j=e.settings.alkkagiRounds||1;if(j<=1)return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(U,{onClick:()=>p("slow"),disabled:!y||c<=0||m,colorScheme:m?"green":"blue",className:b,title:`   50% .  : ${c}`,children:[" (",c,")"]}),t.jsxs(U,{onClick:()=>p("aimingLine"),disabled:!y||d<=0||h,colorScheme:h?"green":"purple",className:b,title:`  1000% .  : ${d}`,children:[" (",d,")"]})]});const g=j-1,x=((k=e.alkkagiRefillsUsed)==null?void 0:k[l.id])||0,v=g-x;return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"flex flex-col text-center text-xs font-semibold",children:t.jsxs("span",{className:"text-yellow-300",children:[": ",v," / ",g]})}),t.jsx("div",{className:"h-8 w-px bg-gray-600 mx-2"}),t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(U,{onClick:()=>p("slow"),disabled:!y||c<=0||m,colorScheme:m?"green":"blue",className:b,title:`   50% .  : ${c}`,children:[" (",c,")"]}),t.jsxs(U,{onClick:()=>p("aimingLine"),disabled:!y||d<=0||h,colorScheme:h?"green":"purple",className:b,title:`  1000% .  : ${d}`,children:[" (",d,")"]})]})]})},yb=({session:e,currentUser:n})=>null,bb=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{const{id:r,gameStatus:a,animation:i,currentPlayer:o,blackPlayerId:c,whitePlayerId:d,thiefPlayerId:u}=e,p=(i==null?void 0:i.type)==="dice_roll_main"?i:null,m=!!p&&Date.now()<p.startTime+p.duration,b=((o===B.Black?c:d)===u?"thief":"police")==="thief"?1:2,j=()=>{n&&a==="thief_rolling"&&(Pe.rollDice(b),s({type:"THIEF_ROLL_DICE",payload:{gameId:r}}))};return t.jsx("div",{className:"flex items-center justify-center gap-2",children:Array.from({length:b}).map((g,x)=>{var k;const v=x===0?"dice1":"dice2",w=p?p.dice[v]:(k=e.dice)==null?void 0:k[v];return t.jsx(Xn,{value:w??null,isRolling:m,size:48,onClick:j,disabled:!n||a!=="thief_rolling"},x)})})},vb=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{var j;const{id:r,gameStatus:a,activeCurlingItems:i}=e,o=(j=e.curlingItemUses)==null?void 0:j[l.id],c=(o==null?void 0:o.slow)??e.settings.curlingSlowItemCount??0,d=(o==null?void 0:o.aimingLine)??e.settings.curlingAimingLineItemCount??0,u=(i==null?void 0:i[l.id])||[],p=g=>{s({type:"USE_CURLING_ITEM",payload:{gameId:r,itemType:g}})},m=u.includes("slow"),h=u.includes("aimingLine"),y=n&&a==="curling_playing",b="whitespace-nowrap text-[clamp(0.6rem,2.2vmin,0.875rem)] px-[clamp(0.4rem,1.8vmin,0.75rem)] py-[clamp(0.3rem,1.2vmin,0.625rem)]";return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(U,{onClick:()=>p("slow"),disabled:!y||c<=0||m,colorScheme:m?"green":"blue",className:b,title:`   50% .  : ${c}`,children:[" (",c,")"]}),t.jsxs(U,{onClick:()=>p("aimingLine"),disabled:!y||d<=0||h,colorScheme:h?"green":"purple",className:b,title:`  1000% .  : ${d}`,children:[" (",d,")"]})]})},jb=e=>{var W;const{session:n,isMyTurn:s,isSpectator:l,onAction:r,setShowResultModal:a,setConfirmModalType:i,currentUser:o,onlineUsers:c,pendingMove:d,onConfirmMove:u,onCancelMove:p,isMobile:m,settings:h}=e,{id:y,mode:b,gameStatus:j,blackPlayerId:g,whitePlayerId:x,player1:v,player2:w}=n;T.Mix;const k=["ended","no_contest","rematch_pending"].includes(j),P=Tx.includes(j),S=!P&&!k,E=Qe.some(H=>H.mode===b),_=()=>{s&&!l&&j==="playing"&&r({type:"PASS_TURN",payload:{gameId:y}})},C=()=>{!l&&!n.isAiGame&&P&&i("resign")},I=H=>{if(j!=="playing")return;r({type:H==="hidden"?"START_HIDDEN_PLACEMENT":H==="scan"?"START_SCANNING":"START_MISSILE_SELECTION",payload:{gameId:y}})},A=(o.id===g?B.Black:B.White)===B.Black?B.White:B.Black,O=f.useMemo(()=>!n.hiddenMoves||!n.moveHistory?!1:Object.entries(n.hiddenMoves).some(([H,ne])=>{var X,ee;if(!ne)return!1;const re=n.moveHistory[parseInt(H)];if(!re||re.player!==A)return!1;const{x:ce,y:ve}=re;return((X=n.boardState[ve])==null?void 0:X[ce])!==A?!1:!((ee=n.permanentlyRevealedStones)==null?void 0:ee.some(xe=>xe.x===ce&&xe.y===ve))}),[n.hiddenMoves,n.moveHistory,n.boardState,n.permanentlyRevealedStones,A]),L="whitespace-nowrap text-[clamp(0.6rem,2.2vmin,0.875rem)] px-[clamp(0.4rem,1.8vmin,0.75rem)] py-[clamp(0.2rem,0.8vmin,0.4rem)]",Q=()=>{const H=b===T.Hidden||b===T.Mix&&(n.settings.mixedModes||[]).includes(T.Hidden),ne=b===T.Missile||b===T.Mix&&(n.settings.mixedModes||[]).includes(T.Missile),re=n.player1.id,ce=o.id===re?n.hidden_stones_used_p1??0:n.hidden_stones_used_p2??0,ve=o.id===re?n.scans_p1:n.scans_p2,F=o.id===re?n.missiles_p1:n.missiles_p2,X=(n.settings.hiddenStoneCount||0)-ce;return t.jsxs(t.Fragment,{children:[" ",H&&t.jsxs(U,{onClick:()=>I("hidden"),disabled:!s||l||j!=="playing"||X<=0,colorScheme:"purple",className:L,children:[" (",X,")"]})," ",H&&t.jsxs(U,{onClick:()=>I("scan"),disabled:!s||l||j!=="playing"||(ve??0)<=0||!O,colorScheme:"purple",className:L,children:[" (",ve??0,")"]})," ",ne&&t.jsxs(U,{onClick:()=>I("missile"),disabled:!s||l||j!=="playing"||(F??0)<=0,colorScheme:"orange",className:L,children:[" (",F??0,")"]})," "]})},D=b===T.Hidden||b===T.Missile||b===T.Mix&&(n.settings.mixedModes||[]).some(H=>[T.Hidden,T.Missile].includes(H));if(l&&!o.isAdmin)return null;const $=(n.maxActionButtonUses??0)-(((W=n.actionButtonUses)==null?void 0:W[o.id])??0),q=n.maxActionButtonUses,z=typeof $=="number"&&typeof q=="number"?`(${$})`:"";return n.isAnalyzing,t.jsxs("footer",{className:"responsive-controls flex-shrink-0 bg-gray-800 rounded-lg p-1 flex flex-col items-stretch justify-center gap-1 w-full",children:[m&&h.features.mobileConfirm&&d&&t.jsxs("div",{className:"flex gap-4 p-2 justify-center",children:[t.jsx(U,{onClick:p,colorScheme:"red",className:"!py-3 !px-6",children:""}),t.jsx(U,{onClick:u,colorScheme:"green",className:"!py-3 !px-6 animate-pulse",children:""})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-md p-2 flex flex-row items-center gap-4 w-full",children:[t.jsxs("h3",{className:"text-xs font-bold text-gray-300 whitespace-nowrap",children:["  ",z]}),t.jsx("div",{className:"flex-grow flex items-center justify-center",children:t.jsx(pb,{session:n,isSpectator:l,onAction:r,currentUser:o})})]}),t.jsxs("div",{className:"flex flex-col lg:flex-row gap-1 w-full",children:[t.jsxs("div",{className:"bg-gray-900/50 rounded-md p-2 flex flex-row items-center gap-4 flex-1 min-w-0",children:[t.jsx("h3",{className:"text-xs font-bold text-gray-300 whitespace-nowrap",children:" "}),t.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap flex-grow",children:k?t.jsx(U,{onClick:()=>a(!0),colorScheme:"yellow",className:L,children:" "}):t.jsxs(t.Fragment,{children:[E&&b!==T.Capture&&t.jsx(U,{onClick:_,disabled:!s||l||S,colorScheme:"blue",className:L,children:""}),t.jsx(U,{onClick:C,disabled:l||n.isAiGame||S,colorScheme:"red",className:L,children:""})]})})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-md p-2 flex flex-row items-center gap-4 flex-1 min-w-0",children:[t.jsx("h3",{className:"text-xs font-bold text-gray-300 whitespace-nowrap",children:E?" ":" "}),t.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap flex-grow",children:E?t.jsx(t.Fragment,{children:!k&&D&&Q()}):b===T.Dice?t.jsx(gb,{session:n,isMyTurn:s,onAction:r,currentUser:o}):b===T.Thief?t.jsx(bb,{session:n,isMyTurn:s,onAction:r,currentUser:o}):b===T.Curling?t.jsx(vb,{session:n,isMyTurn:s,onAction:r,currentUser:o}):b===T.Alkkagi?t.jsx(hb,{session:n,isMyTurn:s,onAction:r,currentUser:o}):t.jsx(yb,{session:n,currentUser:o})})]})]}),l&&o.isAdmin&&P&&t.jsxs("div",{className:"bg-purple-900/50 rounded-md p-2 flex flex-row items-center gap-4 w-full mt-1",children:[t.jsx("h3",{className:"text-xs font-bold text-purple-300 whitespace-nowrap",children:" "}),t.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap flex-grow",children:[t.jsxs(U,{onClick:()=>{window.confirm(`${v.nickname}  ?`)&&r({type:"ADMIN_FORCE_WIN",payload:{gameId:y,winnerId:v.id}})},colorScheme:"purple",className:L,children:[v.nickname," "]}),t.jsxs(U,{onClick:()=>{window.confirm(`${w.nickname}  ?`)&&r({type:"ADMIN_FORCE_WIN",payload:{gameId:y,winnerId:w.id}})},colorScheme:"purple",className:L,children:[w.nickname," "]})]})]})]})},wb=({session:e,currentUser:n})=>{const{disconnectionState:s,player1:l,player2:r,disconnectionCounts:a}=e,[i,o]=f.useState(90);if(!s)return null;const c=s.disconnectedPlayerId===l.id?l:r,d=c.id===n.id,u=(a==null?void 0:a[c.id])||1;return f.useEffect(()=>{const p=()=>{const h=(Date.now()-s.timerStartedAt)/1e3,y=Math.max(0,90-Math.floor(h));o(y)},m=setInterval(p,1e3);return p(),()=>clearInterval(m)},[s.timerStartedAt]),t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-md p-8 border border-gray-700 text-center",children:[t.jsxs("h2",{className:"text-2xl font-bold text-yellow-400 mb-4",children:["   (",u,"/3)"]}),t.jsx("div",{className:"flex justify-center items-center my-6",children:t.jsx("div",{className:"animate-pulse rounded-full h-16 w-16 border-4 border-yellow-400 flex items-center justify-center",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),t.jsxs("p",{className:"text-lg text-white mb-2",children:[t.jsx("span",{className:"font-bold",children:c.nickname}),"   ."]}),t.jsx("p",{className:"text-gray-300",children:"  ..."}),t.jsxs("p",{className:"text-4xl font-mono font-bold my-4 text-white",children:[i,""]}),d&&t.jsx("p",{className:"text-sm text-red-400 bg-red-900/50 p-2 rounded-md",children:"  ."})]})})},Nb=({session:e,onAction:n,currentUser:s})=>{if(e.gameStatus==="ended"||e.gameStatus==="no_contest"){const u=e.winner===B.Black,p=Jl.findIndex(g=>g.id===e.stageId),m=Jl[p+1],h=u&&m&&(s.singlePlayerProgress??0)>p,y=()=>{n({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:e.stageId}})},b=()=>{h&&n({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:m.id}})},j=()=>{sessionStorage.setItem("postGameRedirect","#/singleplayer"),n({type:"LEAVE_AI_GAME",payload:{gameId:e.id}})};return t.jsxs("div",{className:"bg-stone-800/60 backdrop-blur-sm rounded-lg p-2 flex items-center justify-center gap-2 w-full border border-stone-700/50",children:[t.jsx(U,{onClick:j,colorScheme:"gray",className:"flex-1 !text-sm",children:""}),t.jsx(U,{onClick:y,colorScheme:"yellow",className:"flex-1 !text-sm",children:""}),t.jsxs(U,{onClick:b,colorScheme:"accent",disabled:!h,className:"flex-1 !text-sm",children:[" ",m?`: ${m.name.replace(" ","")}`:""]})]})}const l=e.singlePlayerPlacementRefreshesUsed||0,r=e.moveHistory.length===0&&l<5,i=[0,50,100,200,300][l]||0,o=s.gold>=i,c=()=>{r&&o&&n({type:"SINGLE_PLAYER_REFRESH_PLACEMENT",payload:{gameId:e.id}})},d=()=>{window.confirm("    ?")&&(window.location.hash="#/singleplayer")};return t.jsxs("div",{className:"bg-stone-800/60 backdrop-blur-sm rounded-lg p-2 flex items-center justify-between gap-4 w-full h-full border border-stone-700/50",children:[t.jsx(U,{onClick:d,colorScheme:"red",className:"!text-sm",children:""}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"text-xs text-stone-400",children:[" : ",r?i:"-"]}),t.jsxs(U,{onClick:c,colorScheme:"accent",className:"!text-sm",disabled:!r||!o,title:o?"":" .",children:["  (",5-l,"/5)"]})]})]})},Ou=[{term:"()",meaning:"   ."},{term:"()",meaning:"    ,   ."},{term:"()",meaning:"        ."},{term:"()",meaning:"        ."},{term:"()",meaning:"     ."},{term:"()",meaning:"      ."},{term:"()",meaning:",    ."},{term:"()",meaning:"      ."},{term:"()",meaning:"      ."},{term:"()",meaning:"       ."},{term:"()",meaning:"        ."},{term:"   ",meaning:"       ."}],kb=({session:e})=>{const{settings:n}=e;return t.jsxs("div",{className:"h-full bg-stone-800/60 backdrop-blur-sm p-3 rounded-md flex-shrink-0 border border-stone-700/50 text-stone-300",children:[t.jsx("h3",{className:"text-base font-bold border-b border-stone-600/50 pb-1 mb-2 text-amber-300 text-center",children:" "}),t.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-0.5 text-xs",children:[t.jsx("div",{className:"font-semibold text-stone-400",children:" :"}),t.jsxs("div",{children:[n.boardSize,"x",n.boardSize]}),t.jsx("div",{className:"font-semibold text-stone-400",children:"AI :"}),t.jsx("div",{children:n.aiDifficulty}),t.jsx("div",{className:"font-semibold text-stone-400",children:" :"}),t.jsxs("div",{children:[n.captureTarget,""]})]})]})},Sb=()=>{const[e,n]=f.useState(0);f.useEffect(()=>{const l=setInterval(()=>{n(r=>(r+1)%Ou.length)},15e3);return()=>clearInterval(l)},[]);const s=Ou[e];return t.jsxs("div",{className:"bg-stone-800/60 backdrop-blur-sm p-3 rounded-md flex-1 border border-stone-700/50 text-stone-300 flex flex-col items-center justify-center text-center",children:[t.jsx("h3",{className:"text-base font-bold border-b border-stone-600/50 pb-1 mb-2 text-amber-300",children:" "}),t.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center",children:[t.jsx("p",{className:"text-2xl font-semibold text-stone-100",children:s.term}),t.jsx("p",{className:"text-sm text-stone-300 mt-2",children:s.meaning})]})]})},Cb=({session:e})=>t.jsxs("div",{className:"flex flex-col md:flex-row h-full gap-2",children:[t.jsx(kb,{session:e}),t.jsx(Sb,{})]}),Ib=e=>{const[n,s]=f.useState({black:e.blackTimeLeft,white:e.whiteTimeLeft});return f.useEffect(()=>{if(["ended","no_contest","scoring"].includes(e.gameStatus)){s({black:e.blackTimeLeft,white:e.whiteTimeLeft});return}const r=e.turnDeadline||e.alkkagiTurnDeadline||e.curlingTurnDeadline||e.alkkagiPlacementDeadline||e.turnChoiceDeadline||e.guessDeadline||e.basePlacementDeadline||e.captureBidDeadline||e.itemUseDeadline;if(!r){s({black:e.blackTimeLeft,white:e.whiteTimeLeft});return}const a=["base_placement","komi_bidding","capture_bidding","alkkagi_simultaneous_placement"].includes(e.gameStatus);let i;const o=()=>{const c=Math.max(0,(r-Date.now())/1e3);a?s({black:c,white:c}):e.currentPlayer===B.Black?s({black:c,white:e.whiteTimeLeft}):e.currentPlayer===B.White?s({black:e.blackTimeLeft,white:c}):s({black:e.blackTimeLeft,white:e.whiteTimeLeft}),i=requestAnimationFrame(o)};return i=requestAnimationFrame(o),()=>cancelAnimationFrame(i)},[e.turnDeadline,e.alkkagiTurnDeadline,e.curlingTurnDeadline,e.alkkagiPlacementDeadline,e.turnChoiceDeadline,e.guessDeadline,e.basePlacementDeadline,e.captureBidDeadline,e.itemUseDeadline,e.currentPlayer,e.blackTimeLeft,e.whiteTimeLeft,e.gameStatus]),{clientTimes:n}};function $n(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const Pb=({session:e})=>{var ke,Ue,Le,He;const{currentUser:n,currentUserWithStatus:s,handlers:l,onlineUsers:r,waitingRoomChats:a,gameChats:i,negotiations:o,activeNegotiation:c,settings:d}=De(),{id:u,currentPlayer:p,gameStatus:m,player1:h,player2:y,mode:b,blackPlayerId:j,whitePlayerId:g}=e;if(!(h!=null&&h.id)||!(y!=null&&y.id)||!n||!s)return t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"   ..."});const[x,v]=f.useState(null),w=Ib(e),[k,P]=f.useState(!1),[S,E]=f.useState(!1),[_,C]=f.useState(!1),[I,R]=f.useState(null),[A,O]=f.useState(!1),L=$n(m);$n(p);const Q=$n(e.captures),D=$n((ke=e.animation)==null?void 0:ke.type),$=f.useRef(!1),q=$n((Ue=e.moveHistory)==null?void 0:Ue.length),z=f.useMemo(()=>(s==null?void 0:s.status)==="spectating",[s]),W=e.isSinglePlayer,[H,ne]=f.useState(window.innerWidth<1024),[re,ce]=f.useState(!1),[ve,F]=f.useState(!1),X=f.useMemo(()=>i[e.id]||[],[i,e.id]),ee=$n(X.length);f.useEffect(()=>{const ae=()=>ne(window.innerWidth<1024);return window.addEventListener("resize",ae),()=>window.removeEventListener("resize",ae)},[]),f.useEffect(()=>{!re&&ee!==void 0&&X.length>ee&&F(!0)},[X.length,ee,re]);const xe=()=>{ce(!0),F(!1)};f.useEffect(()=>{(m==="ended"||m==="no_contest")&&L!=="ended"&&L!=="no_contest"&&L!=="rematch_pending"&&(P(!0),E(!0))},[m,L]);const J=f.useMemo(()=>{var ae;return z?B.None:j===n.id?B.Black:g===n.id?B.White:(b===T.Base||b===T.Mix&&((ae=e.settings.mixedModes)!=null&&ae.includes(T.Base)))&&m==="base_placement"?n.id===h.id?B.Black:B.White:B.None},[n.id,j,g,z,b,m,h.id,y.id,e.settings.mixedModes]),G=f.useMemo(()=>{var ae,Me;if(z)return!1;if(m==="alkkagi_simultaneous_placement"&&e.settings.alkkagiPlacementType===" "){const Te=(e.alkkagiStones||[]).filter(it=>it.player===J).length,We=((ae=n.id===h.id?e.alkkagiStones_p1:e.alkkagiStones_p2)==null?void 0:ae.length)||0;return Te+We<(e.settings.alkkagiStoneCount||5)}switch(m){case"dice_turn_rolling":return((Me=e.turnOrderRolls)==null?void 0:Me[n.id])===null;case"dice_turn_choice":return e.turnChooserId===n.id;case"playing":case"hidden_placing":case"scanning":case"missile_selecting":case"alkkagi_placement":case"alkkagi_playing":case"curling_playing":case"dice_rolling":case"dice_placing":case"thief_rolling":case"thief_placing":return J!==B.None&&J===p;case"base_placement":{const Te=n.id===h.id?e.baseStones_p1:e.baseStones_p2;return((Te==null?void 0:Te.length)||0)<(e.settings.baseStones||4)}default:return!1}},[J,p,m,z,e,n.id,h.id,e.settings]),K=$n(G);f.useEffect(()=>{G&&!K&&[T.Dice,T.Thief,T.Alkkagi,T.Curling].includes(e.mode)&&Pe.myTurn()},[G,K,e.mode]);const Z=$n(e.lastMove);f.useEffect(()=>{e.lastMove&&e.lastMove.x!==-1&&JSON.stringify(e.lastMove)!==JSON.stringify(Z)&&(Qe.some(Me=>Me.mode===e.mode)||[T.Omok,T.Ttamok,T.Dice,T.Thief].includes(e.mode))&&Pe.placeStone()},[e.lastMove,Z,e.mode]),f.useEffect(()=>{},[e.captures,Q,e.justCaptured,e.blackPlayerId,n.id]),f.useEffect(()=>(m==="scanning"&&L!=="scanning"?Pe.playScanBgm():m!=="scanning"&&L==="scanning"&&Pe.stopScanBgm(),()=>{m==="scanning"&&Pe.stopScanBgm()}),[m,L]),f.useEffect(()=>{const ae=e.animation;if(ae&&ae.type!==D)switch(ae.type){case"missile":case"hidden_missile":Pe.launchMissile();break;case"hidden_reveal":_||Pe.revealHiddenStone();break;case"scan":C(!0),setTimeout(()=>C(!1),1e3),ae.success?Pe.scanSuccess():Pe.scanFail();break}},[e.animation,D,_]),f.useEffect(()=>{const ae=["playing","alkkagi_placement","alkkagi_simultaneous_placement","curling_playing","dice_rolling","thief_rolling"];ae.includes(m)&&(L===void 0||!ae.includes(L))&&Pe.gameStart()},[m,L]),f.useEffect(()=>()=>Pe.stopScanBgm(),[]),f.useEffect(()=>{const ae=["ended","no_contest","scoring"].includes(m),Me=q!==void 0&&e.moveHistory&&e.moveHistory.length>q;if((!G||Me||ae)&&$.current&&(Pe.stopTimerWarning(),$.current=!1),G&&!ae){const Te=J===B.Black?w.clientTimes.black:w.clientTimes.white;Te<=10&&Te>0&&!$.current&&(Pe.timerWarning(),$.current=!0)}},[G,w.clientTimes,J,e.moveHistory,q,m]);const fe=["hidden_placing","scanning","missile_selecting","missile_animating","scanning_animating"].includes(m),we=f.useCallback((ae,Me)=>{if(Pe.stopTimerWarning(),z||m==="missile_animating")return;if(H&&d.features.mobileConfirm&&G&&!fe){if(I&&I.x===ae&&I.y===Me)return;R({x:ae,y:Me});return}let Te=null,We={gameId:u,x:ae,y:Me};if((b===T.Omok||b===T.Ttamok)&&m==="playing"&&G)Te="OMOK_PLACE_STONE";else if(m==="scanning"&&G)Pe.stopScanBgm(),Te="SCAN_BOARD";else if(m==="base_placement"){const it=n.id===h.id?e.baseStones_p1:e.baseStones_p2;((it==null?void 0:it.length)||0)<(e.settings.baseStones||4)&&(Te="PLACE_BASE_STONE")}else["playing","hidden_placing"].includes(m)&&G&&(Te="PLACE_STONE",We.isHidden=m==="hidden_placing",We.isHidden&&Pe.stopScanBgm());Te&&l.handleAction({type:Te,payload:We})},[z,m,G,u,l.handleAction,n.id,h.id,e.baseStones_p1,e.baseStones_p2,e.settings.baseStones,b,H,d.features.mobileConfirm,I,fe]),M=f.useCallback(()=>{if(Pe.stopTimerWarning(),!I)return;let ae=null,Me={gameId:u,x:I.x,y:I.y};(b===T.Omok||b===T.Ttamok)&&m==="playing"&&G?ae="OMOK_PLACE_STONE":["playing","hidden_placing"].includes(m)&&G&&(ae="PLACE_STONE",Me.isHidden=m==="hidden_placing"),ae&&l.handleAction({type:ae,payload:Me}),R(null)},[I,u,l,m,G,b]),Y=f.useCallback(()=>R(null),[]),ie=f.useMemo(()=>{var ae,Me;return((ae=e.analysisResult)==null?void 0:ae[n.id])??(["ended","no_contest"].includes(m)?(Me=e.analysisResult)==null?void 0:Me.system:null)},[e.analysisResult,n.id,m]),oe=f.useMemo(()=>{var ae;return z||e.isAiGame?!1:!!((ae=e.canRequestNoContest)!=null&&ae[n.id])},[e.canRequestNoContest,n.id,z,e.isAiGame]),ue=f.useCallback(()=>{if(z){l.handleAction({type:"LEAVE_SPECTATING"});return}if(["ended","no_contest","rematch_pending"].includes(m)){const ae=e.isAiGame?"LEAVE_AI_GAME":"LEAVE_GAME_ROOM";l.handleAction({type:ae,payload:{gameId:u}});return}oe?window.confirm("       ?")&&l.handleAction({type:"REQUEST_NO_CONTEST_LEAVE",payload:{gameId:u}}):v("resign")},[z,l.handleAction,e.isAiGame,u,m,oe]),le=f.useMemo(()=>a.global||[],[a]),ge=f.useCallback(()=>{P(!1),E(!1)},[]),je={session:e,onAction:l.handleAction,currentUser:s,waitingRoomChat:le,gameChat:X,isSpectator:z,onlineUsers:r,activeNegotiation:c,negotiations:Object.values(o),onViewUser:l.openViewingUser},me={session:e,isMyTurn:G,isSpectator:z,onAction:l.handleAction,setShowResultModal:P,setConfirmModalType:v,currentUser:s,onlineUsers:r,pendingMove:I,onConfirmMove:M,onCancelMove:Y,settings:d,isMobile:H};return W?t.jsxs("div",{className:"w-full h-dvh flex flex-col p-1 lg:p-4 bg-wood-pattern text-stone-200",children:[t.jsx("button",{onClick:l.openSettingsModal,className:"absolute top-2 right-2 z-30 p-2 rounded-lg text-xl hover:bg-black/20 transition-colors",title:"",children:""}),t.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center gap-2 lg:gap-4 max-w-5xl w-full mx-auto min-h-0",children:[t.jsx("div",{className:"w-full flex-shrink-0",children:t.jsx(_u,{...je,clientTimes:w.clientTimes,isSinglePlayer:!0})}),t.jsx("div",{className:"flex-1 w-full relative",children:t.jsx("div",{className:"absolute inset-0",children:t.jsx(Eu,{...je,isMyTurn:G,myPlayerEnum:J,handleBoardClick:we,isItemModeActive:fe,showTerritoryOverlay:S,isMobile:H,myRevealedMoves:((Le=e.revealedHiddenMoves)==null?void 0:Le[n.id])||[],showLastMoveMarker:d.features.lastMoveMarker})})}),t.jsxs("div",{className:"w-full flex flex-col-reverse md:flex-row gap-2 lg:gap-4 items-stretch flex-shrink-0",children:[t.jsx("div",{className:"flex-1",children:t.jsx(Cb,{session:e})}),t.jsxs("div",{className:"flex flex-col gap-2 flex-shrink-0 w-full md:w-auto",children:[t.jsx(Bu,{session:e}),t.jsx(Nb,{...je,currentUser:s})]})]})]}),t.jsx(Lu,{...je,confirmModalType:x,onHideConfirmModal:()=>v(null),showResultModal:k,onCloseResults:ge})]}):t.jsxs("div",{className:"w-full h-dvh flex flex-col p-1 lg:p-2 relative max-w-full bg-tertiary",children:[e.disconnectionState&&t.jsx(wb,{session:e,currentUser:n}),e.gameStatus==="scoring"&&t.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center z-30",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-gray-100 mb-4"}),t.jsx("p",{className:"text-xl font-bold text-white",children:" ..."})]}),t.jsx("button",{onClick:l.openSettingsModal,className:"absolute top-2 right-2 z-30 p-2 rounded-lg text-xl hover:bg-secondary/50 transition-colors",title:"",children:""}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-2 min-h-0",children:[t.jsx("main",{className:"flex-1 flex items-center justify-center min-w-0 min-h-0",children:t.jsxs("div",{className:"w-full h-full max-h-full max-w-full lg:max-w-[calc(100vh-8rem)] flex flex-col items-center gap-1 lg:gap-2",children:[t.jsx("div",{className:"flex-shrink-0 w-full",children:t.jsx(_u,{...je,clientTimes:w.clientTimes})}),t.jsx("div",{className:"flex-1 w-full relative",children:t.jsx("div",{className:"absolute inset-0",children:t.jsx(Eu,{...je,isMyTurn:G,myPlayerEnum:J,handleBoardClick:we,isItemModeActive:fe,showTerritoryOverlay:S,isMobile:H,myRevealedMoves:((He=e.revealedHiddenMoves)==null?void 0:He[n.id])||[],showLastMoveMarker:d.features.lastMoveMarker})})}),t.jsxs("div",{className:"flex-shrink-0 w-full flex flex-col gap-1",children:[t.jsx(Bu,{session:e}),t.jsx(jb,{...me})]})]})}),!H&&t.jsx("div",{className:"w-full lg:w-[320px] xl:w-[360px] flex-shrink-0",children:t.jsx(Mu,{...je,onLeaveOrResign:ue,isNoContestLeaveAvailable:oe})}),H&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",children:t.jsx("button",{onClick:xe,className:"w-8 h-12 bg-secondary/80 backdrop-blur-sm rounded-l-lg flex items-center justify-center text-primary shadow-lg","aria-label":" ",children:t.jsxs("span",{className:"relative font-bold text-lg",children:["<",ve&&t.jsx("div",{className:"absolute -top-1 -right-1.5 w-2.5 h-2.5 bg-danger rounded-full border-2 border-secondary"})]})})}),t.jsx("div",{className:`fixed top-0 right-0 h-full w-[280px] bg-secondary shadow-2xl z-50 transition-transform duration-300 ease-in-out ${re?"translate-x-0":"translate-x-full"}`,children:t.jsx(Mu,{...je,onLeaveOrResign:ue,isNoContestLeaveAvailable:oe,onClose:()=>ce(!1)})}),re&&t.jsx("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:()=>ce(!1)})]})]}),A&&ie&&t.jsx(fb,{session:e,result:ie,onClose:()=>O(!1)}),t.jsx(Lu,{...je,confirmModalType:x,onHideConfirmModal:()=>v(null),showResultModal:k,onCloseResults:ge})]})},Eb=({onNavigate:e,onBackToProfile:n,liveGames:s,onAction:l})=>{const r=a=>{window.confirm(`[${a.player1.nickname} vs ${a.player2.nickname}]   ?`)&&l({type:"ADMIN_FORCE_DELETE_GAME",payload:{gameId:a.id}})};return t.jsxs("div",{className:"bg-primary text-primary",children:[t.jsxs("header",{className:"flex justify-between items-center mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold",children:" "}),t.jsx("button",{onClick:n,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{onClick:()=>e("userManagement"),className:"bg-blue-800/50 hover:bg-blue-700/50 p-6 rounded-lg shadow-lg cursor-pointer transition-all transform hover:-translate-y-1 border border-color",children:[t.jsx("h2",{className:"text-2xl font-bold text-blue-300",children:" "}),t.jsx("p",{className:"mt-2 text-gray-400",children:"  ,  ,    ."})]}),t.jsxs("div",{onClick:()=>e("mailSystem"),className:"bg-green-800/50 hover:bg-green-700/50 p-6 rounded-lg shadow-lg cursor-pointer transition-all transform hover:-translate-y-1 border border-color",children:[t.jsx("h2",{className:"text-2xl font-bold text-green-300",children:"  "}),t.jsx("p",{className:"mt-2 text-gray-400",children:"      ."})]}),t.jsxs("div",{onClick:()=>e("serverSettings"),className:"bg-yellow-800/50 hover:bg-yellow-700/50 p-6 rounded-lg shadow-lg cursor-pointer transition-all transform hover:-translate-y-1 border border-color",children:[t.jsx("h2",{className:"text-2xl font-bold text-yellow-300",children:" "}),t.jsx("p",{className:"mt-2 text-gray-400",children:",        ."})]})]}),t.jsxs("div",{className:"mt-8 bg-panel border border-color p-6 rounded-lg shadow-lg",children:[t.jsxs("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2 text-on-panel",children:["  (",s.length,")"]}),t.jsx("div",{className:"max-h-[40vh] overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm text-left text-secondary",children:[t.jsx("thead",{className:"text-xs text-secondary uppercase bg-secondary sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"px-4 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:" "}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:" "}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:""})]})}),t.jsx("tbody",{children:s.map(a=>t.jsxs("tr",{className:"bg-primary border-b border-color hover:bg-secondary/50",children:[t.jsxs("td",{className:"px-4 py-4 font-medium text-primary whitespace-nowrap",children:[a.player1.nickname," vs ",a.player2.nickname]}),t.jsx("td",{className:"px-4 py-4",children:a.mode}),t.jsx("td",{className:"px-4 py-4",children:a.gameStatus}),t.jsx("td",{className:"px-4 py-4",children:new Date(a.createdAt).toLocaleString()}),t.jsx("td",{className:"px-4 py-4",children:t.jsx("button",{onClick:()=>r(a),className:"font-medium text-red-500 hover:underline",children:" "})})]},a.id))})]})})]})]})},Mb=({user:e,currentUser:n,onClose:s,onAction:l})=>{var w,k,P;const[r,a]=f.useState(JSON.parse(JSON.stringify(e))),[i,o]=f.useState("general"),c=S=>{const{name:E,value:_}=S.target;a(C=>({...C,[E]:Number(_)}))},d=S=>{const{name:E,value:_}=S.target;a(C=>({...C,[E]:_}))},u=S=>{const{name:E,checked:_}=S.target;a(C=>({...C,[E]:_}))},p=(S,E)=>{a(_=>{const C={..._.stats||{}};return C[S]||(C[S]={wins:0,losses:0,rankingScore:1200}),C[S].rankingScore=Number(E),{..._,stats:C}})},m=(S,E,_,C)=>{a(I=>{const R=JSON.parse(JSON.stringify(I.quests||{}));if(R[S]&&R[S].quests){const A=R[S].quests.find(O=>O.id===E);A&&(A[_]=C)}return{...I,quests:R}})},h=(S,E)=>{a(_=>{const C=JSON.parse(JSON.stringify(_.quests||{}));return C[S]?C[S].activityProgress=E:C[S]||(C[S]={quests:[],activityProgress:E,claimedMilestones:[!1,!1,!1,!1,!1],lastReset:0}),{..._,quests:C}})},y=(S,E,_)=>{a(C=>{const I=JSON.parse(JSON.stringify(C.quests||{}));return I[S]&&I[S].claimedMilestones&&(I[S].claimedMilestones[E]=_),{...C,quests:I}})},b=()=>{l({type:"ADMIN_UPDATE_USER_DETAILS",payload:{targetUserId:e.id,updatedDetails:r}}),s()},j=S=>{const E=S==="full"?` [${e.nickname}]     ?`:` [${e.nickname}]    ?`;window.confirm(E)&&l({type:"ADMIN_RESET_USER_DATA",payload:{targetUserId:e.id,resetType:S}})},g=()=>{window.confirm(` [${e.nickname}]   ?`)&&(l({type:"ADMIN_DELETE_USER",payload:{targetUserId:e.id}}),s())},x=S=>t.jsx("div",{className:"space-y-2",children:S.map(({mode:E})=>{var _,C;return t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[t.jsx("label",{className:"text-secondary col-span-1",children:E}),t.jsx("input",{type:"number",value:((C=(_=r.stats)==null?void 0:_[E])==null?void 0:C.rankingScore)??1200,onChange:I=>p(E,I.target.value),className:"bg-tertiary p-1 rounded col-span-1"})]},E)})}),v=({title:S,questType:E,questData:_})=>t.jsxs("div",{className:"bg-tertiary/50 p-3 rounded-lg",children:[t.jsx("h3",{className:"font-bold text-lg text-highlight mb-2",children:S}),t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("label",{className:"text-sm font-medium text-secondary whitespace-nowrap",children:":"}),t.jsx("input",{type:"number",value:(_==null?void 0:_.activityProgress)||0,onChange:C=>h(E,parseInt(C.target.value,10)||0),className:"bg-secondary p-1 rounded w-full"})]}),t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("label",{className:"text-sm font-medium text-secondary whitespace-nowrap",children:":"}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:Array.from({length:5}).map((C,I)=>{var R;return t.jsxs("label",{className:"flex items-center gap-1 text-xs",children:[t.jsx("input",{type:"checkbox",checked:((R=_==null?void 0:_.claimedMilestones)==null?void 0:R[I])||!1,onChange:A=>y(E,I,A.target.checked),className:"w-4 h-4"}),I+1]},I)})})]}),t.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2 border-t border-color pt-2",children:((_==null?void 0:_.quests)||[]).map(C=>t.jsxs("div",{className:"bg-primary/50 p-2 rounded-md text-xs",children:[t.jsx("p",{className:"font-semibold truncate",title:C.title,children:C.title}),t.jsxs("div",{className:"flex items-center justify-between gap-2 mt-1",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{children:":"}),t.jsx("input",{type:"number",value:C.progress,onChange:I=>m(E,C.id,"progress",parseInt(I.target.value,10)||0),className:"w-16 bg-secondary p-0.5 rounded text-center"}),t.jsxs("span",{children:["/ ",C.target]})]}),t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"checkbox",checked:C.isClaimed,onChange:I=>m(E,C.id,"isClaimed",I.target.checked),className:"w-4 h-4"}),t.jsx("span",{children:""})]})]})]},C.id))})]});return t.jsx(be,{title:`  : ${e.nickname}`,onClose:s,windowId:`user-edit-${e.id}`,initialWidth:600,children:t.jsxs("div",{className:"flex flex-col h-[60vh]",children:[t.jsxs("div",{className:"flex border-b border-color mb-4",children:[t.jsx("button",{onClick:()=>o("general"),className:`px-4 py-2 ${i==="general"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:" "}),t.jsx("button",{onClick:()=>o("strategic"),className:`px-4 py-2 ${i==="strategic"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:" "}),t.jsx("button",{onClick:()=>o("playful"),className:`px-4 py-2 ${i==="playful"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:" "}),t.jsx("button",{onClick:()=>o("quests"),className:`px-4 py-2 ${i==="quests"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:""}),t.jsx("button",{onClick:()=>o("danger"),className:`px-4 py-2 ${i==="danger"?"border-b-2 border-danger text-danger":"text-tertiary"}`,children:" "})]}),t.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[i==="general"&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:""}),t.jsx("input",{type:"text",name:"nickname",value:r.nickname,onChange:d,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"number",name:"strategyLevel",value:r.strategyLevel,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" XP"}),t.jsx("input",{type:"number",name:"strategyXp",value:r.strategyXp,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"number",name:"playfulLevel",value:r.playfulLevel,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" XP"}),t.jsx("input",{type:"number",name:"playfulXp",value:r.playfulXp,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:""}),t.jsx("input",{type:"number",name:"gold",value:r.gold,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:""}),t.jsx("input",{type:"number",name:"diamonds",value:r.diamonds,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"number",name:"mannerScore",value:r.mannerScore,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"checkbox",name:"isAdmin",checked:!!r.isAdmin,onChange:u,className:"w-5 h-5",disabled:e.id===n.id,title:e.id===n.id?"     .":""})]})]}),i==="strategic"&&t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center font-bold text-sm mb-2 px-1",children:[t.jsx("span",{className:"col-span-1",children:" "}),t.jsx("span",{children:" "})]}),i==="strategic"&&x(Qe),i==="playful"&&t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center font-bold text-sm mb-2 px-1",children:[t.jsx("span",{className:"col-span-1",children:" "}),t.jsx("span",{children:" "})]}),i==="playful"&&x(nt),i==="quests"&&t.jsxs("div",{className:"space-y-4",children:[t.jsx(v,{title:" ",questType:"daily",questData:(w=r.quests)==null?void 0:w.daily}),t.jsx(v,{title:" ",questType:"weekly",questData:(k=r.quests)==null?void 0:k.weekly}),t.jsx(v,{title:" ",questType:"monthly",questData:(P=r.quests)==null?void 0:P.monthly})]}),i==="danger"&&t.jsxs("div",{className:"space-y-4 p-4 border border-danger/50 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-bold text-danger",children:":    ."}),t.jsx(U,{onClick:()=>j("stats"),colorScheme:"yellow",className:"w-full",children:"  "}),t.jsx(U,{onClick:()=>j("full"),colorScheme:"orange",className:"w-full",children:"   "}),t.jsx(U,{onClick:g,colorScheme:"red",className:"w-full",children:" "})]})]}),t.jsxs("div",{className:"flex justify-end gap-4 mt-4 pt-4 border-t border-color",children:[t.jsx(U,{onClick:s,colorScheme:"gray",children:""}),t.jsx(U,{onClick:b,colorScheme:"green",children:""})]})]})})},Tb=({allUsers:e,onAction:n,onBack:s,currentUser:l})=>{const{handlers:r}=De(),[a,i]=f.useState(""),[o,c]=f.useState(null),[d,u]=f.useState(""),[p,m]=f.useState(""),[h,y]=f.useState(""),b=g=>{if(g.preventDefault(),!d||!p||!h){alert("  .");return}n({type:"ADMIN_CREATE_USER",payload:{username:d,password:p,nickname:h}}),u(""),m(""),y("")},j=f.useMemo(()=>{if(!a.trim())return e;const g=a.toLowerCase();return e.filter(x=>x.nickname.toLowerCase().includes(g)||x.username.toLowerCase().includes(g))},[e,a]);return t.jsxs("div",{className:"space-y-8 bg-primary text-primary",children:[o&&t.jsx(Mb,{user:o,currentUser:l,onClose:()=>c(null),onAction:n}),t.jsxs("header",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-3xl font-bold",children:" "}),t.jsx("button",{onClick:s,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsxs("div",{className:"lg:col-span-2 bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("h2",{className:"text-xl font-semibold",children:["  (",j.length,")"]}),t.jsx("input",{type:"text",placeholder:"   ...",value:a,onChange:g=>i(g.target.value),className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent w-1/3 p-2.5"})]}),t.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm text-left text-secondary",children:[t.jsx("thead",{className:"text-xs text-secondary uppercase bg-secondary sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"px-6 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-6 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-6 py-3",children:" (/)"}),t.jsx("th",{scope:"col",className:"px-6 py-3",children:""})]})}),t.jsx("tbody",{children:j.map(g=>t.jsxs("tr",{className:"bg-primary border-b border-color hover:bg-secondary/50",children:[t.jsxs("th",{scope:"row",className:"px-6 py-4 font-medium text-primary whitespace-nowrap cursor-pointer hover:text-accent",onClick:()=>r.openViewingUser(g.id),title:`${g.nickname}  `,children:[g.nickname," ",g.isAdmin&&t.jsx("span",{className:"text-xs text-purple-400 ml-2",children:"[]"})]}),t.jsx("td",{className:"px-6 py-4",children:g.username}),t.jsxs("td",{className:"px-6 py-4",children:["S.",g.strategyLevel," / P.",g.playfulLevel]}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("button",{onClick:x=>{x.stopPropagation(),c(g)},className:"font-medium text-blue-500 hover:underline",children:""})})]},g.id))})]})})]}),t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:"  "}),t.jsxs("form",{onSubmit:b,className:"space-y-4",children:[t.jsx("input",{type:"text",name:"username",value:d,onChange:g=>u(g.target.value),placeholder:"",className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5"}),t.jsx("input",{type:"password",name:"password",value:p,onChange:g=>m(g.target.value),placeholder:"",className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5"}),t.jsx("input",{type:"text",name:"nickname",value:h,onChange:g=>y(g.target.value),placeholder:"",className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5"}),t.jsx(U,{type:"submit",className:"w-full",children:""})]})]})]})]})},_b=({onAddItem:e,onClose:n})=>{const[s,l]=f.useState("equipment"),[r,a]=f.useState(null),[i,o]=f.useState(1),c=f.useMemo(()=>{switch(s){case"equipment":return kc;case"consumable":return ws;case"material":return Object.values(tn);default:return[]}},[s]),d=()=>{r&&i>0&&(e({...r,quantity:i}),a(null),o(1))};return t.jsx(be,{title:" ",onClose:n,windowId:"mail-item-selection",initialWidth:600,children:t.jsxs("div",{className:"h-[60vh] flex flex-col",children:[t.jsxs("div",{className:"flex bg-tertiary/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>l("equipment"),className:`flex-1 py-2 text-sm font-semibold rounded-md ${s==="equipment"?"bg-accent":"text-tertiary"}`,children:""}),t.jsx("button",{onClick:()=>l("consumable"),className:`flex-1 py-2 text-sm font-semibold rounded-md ${s==="consumable"?"bg-accent":"text-tertiary"}`,children:""}),t.jsx("button",{onClick:()=>l("material"),className:`flex-1 py-2 text-sm font-semibold rounded-md ${s==="material"?"bg-accent":"text-tertiary"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 grid grid-cols-4 gap-2",children:c.map(u=>t.jsxs("div",{onClick:()=>a({name:u.name,type:u.type}),className:`p-2 rounded-lg border-2 ${(r==null?void 0:r.name)===u.name?"border-accent ring-2 ring-accent":"border-color bg-secondary/50"} cursor-pointer flex flex-col items-center`,children:[t.jsx("img",{src:u.image,alt:u.name,className:"w-16 h-16 object-contain"}),t.jsx("span",{className:"text-xs text-center mt-1",children:u.name})]},u.name))}),t.jsxs("div",{className:"flex-shrink-0 mt-4 pt-4 border-t border-color flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{children:": "}),t.jsx("input",{type:"number",value:i,onChange:u=>o(Math.max(1,parseInt(u.target.value,10)||1)),className:"bg-tertiary w-20 p-1 rounded"})]}),t.jsx(U,{onClick:d,disabled:!r,children:"  "})]})]})})},Ab=({allUsers:e,onAction:n,onBack:s})=>{const[l,r]=f.useState("all"),[a,i]=f.useState(""),[o,c]=f.useState(""),[d,u]=f.useState(""),[p,m]=f.useState(0),[h,y]=f.useState(0),[b,j]=f.useState(0),[g,x]=f.useState(7),[v,w]=f.useState([]),[k,P]=f.useState(!1),[S,E]=f.useState([]),_=I=>{const R=I.target.value;if(i(R),R.length>1){const A=e.filter(O=>O.nickname.toLowerCase().includes(R.toLowerCase())||O.username.toLowerCase().includes(R.toLowerCase())).map(O=>O.nickname).slice(0,5);w(A)}else w([])},C=I=>{if(I.preventDefault(),!o.trim()||!d.trim()){alert("   .");return}if(l==="specific"&&!a.trim()){alert("       .");return}n({type:"ADMIN_SEND_MAIL",payload:{targetSpecifier:l==="all"?"all":a,title:o,message:d,expiresInDays:g,attachments:{gold:p,diamonds:h,actionPoints:b,items:S}}}),c(""),u(""),m(0),y(0),j(0),x(7),i(""),E([])};return t.jsxs("div",{className:"max-w-4xl mx-auto bg-primary text-primary",children:[k&&t.jsx(_b,{onClose:()=>P(!1),onAddItem:I=>E(R=>[...R,I])}),t.jsxs("header",{className:"flex justify-between items-center mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"  "}),t.jsx("button",{onClick:s,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsx("div",{className:"bg-panel border border-color p-6 rounded-lg shadow-lg text-on-panel",children:t.jsxs("form",{onSubmit:C,className:"space-y-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"targetType",value:"all",checked:l==="all",onChange:()=>r("all"),className:"mr-2"})," "]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"targetType",value:"specific",checked:l==="specific",onChange:()=>r("specific"),className:"mr-2"})," "]})]})]}),l==="specific"&&t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:"  "}),t.jsx("input",{type:"text",value:a,onChange:_,className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5",required:!0}),v.length>0&&t.jsx("ul",{className:"absolute z-10 w-full bg-secondary border border-color rounded-lg mt-1",children:v.map(I=>t.jsx("li",{onClick:()=>{i(I),w([])},className:"px-4 py-2 hover:bg-accent cursor-pointer",children:I},I))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:""}),t.jsx("input",{type:"text",value:o,onChange:I=>c(I.target.value),required:!0,className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:""}),t.jsx("textarea",{value:d,onChange:I=>u(I.target.value),rows:4,required:!0,className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:"  (0 = )"}),t.jsx("input",{type:"number",min:"0",value:g,onChange:I=>x(parseInt(I.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsx("input",{type:"number",min:"0",value:b,onChange:I=>j(parseInt(I.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsx("input",{type:"number",min:"0",value:p,onChange:I=>m(parseInt(I.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsx("input",{type:"number",min:"0",value:h,onChange:I=>y(parseInt(I.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]})]}),t.jsxs("div",{className:"pt-2 border-t border-color",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("label",{className:"block font-medium text-secondary",children:["  (",S.length,")"]}),t.jsx(U,{type:"button",onClick:()=>P(!0),colorScheme:"blue",className:"!py-1 !text-xs",children:" "})]}),t.jsxs("div",{className:"bg-tertiary/50 p-2 rounded-md min-h-[50px] space-y-1",children:[S.map((I,R)=>t.jsxs("div",{className:"flex justify-between items-center bg-primary/50 p-1 rounded",children:[t.jsxs("span",{children:[I.name," x ",I.quantity]}),t.jsx("button",{type:"button",onClick:()=>E(A=>A.filter((O,L)=>L!==R)),className:"text-red-500 hover:text-red-400 font-bold px-2",children:"X"})]},R)),S.length===0&&t.jsx("p",{className:"text-tertiary text-center text-xs py-2",children:"  ."})]})]}),t.jsx(U,{type:"submit",className:"w-full py-3",colorScheme:"green",children:""})]})})]})},Rb=e=>{const{gameModeAvailability:n,announcements:s,globalOverrideAnnouncement:l,announcementInterval:r,onAction:a,onBack:i}=e,[o,c]=f.useState(""),[d,u]=f.useState((l==null?void 0:l.message)||""),[p,m]=f.useState(s),[h,y]=f.useState(r),b=f.useRef(null),j=f.useRef(null);f.useEffect(()=>{m(s)},[s]),f.useEffect(()=>{y(r)},[r]),f.useEffect(()=>{u((l==null?void 0:l.message)||"")},[l]);const g=()=>{if(b.current===null||j.current===null||b.current===j.current){b.current=null,j.current=null;return}const k=[...p],P=k.splice(b.current,1)[0];k.splice(j.current,0,P),b.current=null,j.current=null,m(k),a({type:"ADMIN_REORDER_ANNOUNCEMENTS",payload:{announcements:k}})},x=k=>{k.preventDefault(),o.trim()&&(a({type:"ADMIN_ADD_ANNOUNCEMENT",payload:{message:o}}),c(""))},v=k=>{k.preventDefault(),d.trim()&&a({type:"ADMIN_SET_OVERRIDE_ANNOUNCEMENT",payload:{message:d}})},w=f.useMemo(()=>[...Qe,...nt],[]);return t.jsxs("div",{className:"space-y-8 bg-primary text-primary",children:[t.jsxs("header",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-3xl font-bold",children:" "}),t.jsx("button",{onClick:i,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsx("div",{className:"space-y-8",children:t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:"  "}),t.jsx("div",{className:"grid grid-cols-2 gap-3 text-sm",children:w.map(k=>t.jsxs("label",{className:"flex items-center gap-2 p-2 bg-secondary/50 rounded-md",children:[t.jsx("input",{type:"checkbox",checked:n[k.mode]??k.available,onChange:P=>a({type:"ADMIN_TOGGLE_GAME_MODE",payload:{mode:k.mode,isAvailable:P.target.checked}}),className:"w-4 h-4"}),t.jsx("span",{children:k.mode})]},k.mode))})]})}),t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:" "}),t.jsx("div",{className:"space-y-3 mb-4 max-h-60 overflow-y-auto",children:p.map((k,P)=>t.jsxs("div",{draggable:!0,onDragStart:()=>b.current=P,onDragEnter:()=>j.current=P,onDragEnd:g,onDragOver:S=>S.preventDefault(),className:"flex items-center justify-between p-2 bg-secondary/50 rounded-md cursor-grab",children:[t.jsx("span",{className:"text-sm",children:k.message}),t.jsx("button",{onClick:()=>a({type:"ADMIN_REMOVE_ANNOUNCEMENT",payload:{id:k.id}}),className:"text-red-500 hover:text-red-400 font-bold",children:"X"})]},k.id))}),t.jsxs("form",{onSubmit:x,className:"flex gap-2",children:[t.jsx("input",{type:"text",value:o,onChange:k=>c(k.target.value),placeholder:" ...",className:"flex-grow bg-secondary border border-color rounded-lg p-2 text-sm"}),t.jsx(U,{type:"submit",colorScheme:"green",className:"!text-sm",children:""})]}),t.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[t.jsx("label",{className:"text-sm",children:"():"}),t.jsx("input",{type:"number",min:"1",max:"60",value:h,onChange:k=>y(parseInt(k.target.value,10)),className:"w-20 bg-secondary border border-color rounded-lg p-1 text-sm"}),t.jsx(U,{onClick:()=>a({type:"ADMIN_SET_ANNOUNCEMENT_INTERVAL",payload:{interval:h}}),className:"!text-xs",children:""})]})]}),t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:"  "}),t.jsxs("form",{onSubmit:v,className:"flex gap-2",children:[t.jsx("input",{type:"text",value:d,onChange:k=>u(k.target.value),placeholder:"  ...",className:"flex-grow bg-secondary border border-color rounded-lg p-2 text-sm"}),t.jsx(U,{type:"submit",colorScheme:"yellow",className:"!text-sm",children:""})]}),l&&t.jsx(U,{onClick:()=>a({type:"ADMIN_CLEAR_OVERRIDE_ANNOUNCEMENT"}),colorScheme:"red",className:"mt-2 w-full !text-sm",children:"  "})]})]})]})]})},Lb=()=>{const[e,n]=f.useState("dashboard"),{currentUserWithStatus:s,allUsers:l,liveGames:r,adminLogs:a,gameModeAvailability:i,announcements:o,globalOverrideAnnouncement:c,announcementInterval:d,handlers:u}=De(),p=()=>{e==="dashboard"?window.location.hash="#/profile":n("dashboard")},m={currentUser:s,allUsers:l,liveGames:Object.values(r),adminLogs:a,onAction:u.handleAction,onBack:p,gameModeAvailability:i,announcements:o,globalOverrideAnnouncement:c,announcementInterval:d},h=()=>{switch(e){case"userManagement":return t.jsx(Tb,{...m});case"mailSystem":return t.jsx(Ab,{...m});case"serverSettings":return t.jsx(Rb,{...m});case"dashboard":default:return t.jsx(Eb,{onNavigate:n,onBackToProfile:p,...m})}};return t.jsx("div",{className:"p-4 lg:p-8",children:h()})},$b=({onClose:e,isTopmost:n})=>{const s=l=>{const r=l.rankStart===l.rankEnd?`${l.rankStart}`:`${l.rankStart}-${l.rankEnd}`;let a="",i="";switch(l.outcome){case"promote":a="",i="text-green-400";break;case"maintain":a="",i="text-gray-400";break;case"demote":a="",i="text-red-400";break}return t.jsxs("li",{className:"flex justify-between items-center bg-gray-700/50 px-3 py-1.5 rounded-md",children:[t.jsx("span",{className:"font-semibold",children:r}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"flex items-center gap-1 text-yellow-300",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"}),l.diamonds]}),t.jsx("span",{className:`font-bold w-12 text-center ${i}`,children:a})]})]},l.rankStart)};return t.jsx(be,{title:"  ",onClose:e,windowId:"league-tier-info-modal",initialWidth:550,isTopmost:n,children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-300 text-center",children:" 16   // ,       ."}),t.jsx("ul",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-2",children:tl.map(l=>{const r=P0[l.tier];return t.jsxs("li",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("img",{src:l.icon,alt:l.name,className:"w-12 h-12 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold",children:l.name}),t.jsxs("p",{className:"text-xs text-gray-400",children:["  ",l.scoreThreshold.toLocaleString()," "]})]})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700/50",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-1.5",children:" "}),t.jsx("ul",{className:"space-y-1 text-xs",children:r.map(s)})]})]},l.tier)})})]})})},Bb=()=>{const e=[{arena:"",rank:1,points:32},{arena:"",rank:2,points:28},{arena:"",rank:3,points:24},{arena:"",rank:1,points:46},{arena:"",rank:2,points:40},{arena:"",rank:3,points:34},{arena:"",rank:1,points:58},{arena:"",rank:2,points:50},{arena:"",rank:3,points:42}];return t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full flex flex-col",children:[t.jsx("h3",{className:"text-lg font-bold text-center mb-4 flex-shrink-0",children:"   "}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 space-y-4",children:[{arena:"",title:""},{arena:"",title:""},{arena:"",title:""}].map(n=>t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-md shadow-inner",children:[t.jsx("h4",{className:"text-md font-bold text-accent mb-2 border-b border-accent/50 pb-1",children:n.title}),t.jsx("div",{className:"space-y-1",children:e.filter(s=>s.arena===n.arena).map((s,l)=>{const r=s.rank===1?"text-yellow-400":s.rank===2?"text-gray-400":s.rank===3?"text-amber-600":"";return t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsxs("span",{className:"font-semibold",children:[s.rank,""]}),t.jsxs("span",{className:`font-bold ${r}`,children:[s.points,""]})]},l)})})]},n.arena))})]})},Er=e=>{let n=0;if(e.length===0)return n;for(let s=0;s<e.length;s++){const l=e.charCodeAt(s);n=(n<<5)-n+l,n|=0}return n},Is=e=>{const n=Math.sin(e)*1e4;return n-Math.floor(n)},Ob=({setHasRankChanged:e})=>{const{currentUserWithStatus:n,allUsers:s,handlers:l}=De(),r=f.useRef(null),[a,i]=f.useState(""),[o,c]=f.useState(()=>{const p=Date.now(),m=new Date(p+324e5);return new Date(m.getFullYear(),m.getMonth(),m.getDate()).getTime()});f.useEffect(()=>{const p=setInterval(()=>{const m=Date.now(),h=new Date(m+324e5),y=new Date(h.getFullYear(),h.getMonth(),h.getDate()).getTime();y!==o&&c(y)},6e4);return()=>clearInterval(p)},[o]),f.useEffect(()=>{const u=()=>{const m=new Date,h=m.getDay(),y=h===0?1:8-h,b=new Date(m.getFullYear(),m.getMonth(),m.getDate()+y);b.setHours(0,0,0,0);const j=b.getTime()-m.getTime(),g=Math.floor(j/(1e3*60*60*24)),x=Math.floor(j%(1e3*60*60*24)/(1e3*60*60)),v=Math.floor(j%(1e3*60*60)/(1e3*60)),w=Math.floor(j%(1e3*60)/1e3);i(`${g}D ${String(x).padStart(2,"0")}:${String(v).padStart(2,"0")}:${String(w).padStart(2,"0")}`)};u();const p=setInterval(u,1e3);return()=>clearInterval(p)},[]);const d=f.useMemo(()=>{if(!(n!=null&&n.weeklyCompetitors))return[];const u=9*60*60*1e3,p=n.lastWeeklyCompetitorsUpdate||o,m=new Date(p+u);m.setHours(0,0,0,0);const h=Math.max(0,o-m.getTime()),y=Math.floor(h/(1e3*60*60*24));let b=n.weeklyCompetitors.map(g=>{if(g.id.startsWith("bot-")){let x=0;for(let k=1;k<=y;k++){const P=`${g.id}-${new Date(m.getTime()+k*24*60*60*1e3).toISOString().slice(0,10)}`,S=Er(P),E=Is(S),_=Math.floor(E*26);x+=_}const v=g.initialScore+x,w=v-g.initialScore;return{...g,liveScore:v,scoreChange:w}}else{const x=s.find(k=>k.id===g.id),v=x?x.tournamentScore:g.initialScore,w=v-g.initialScore;return{...g,liveScore:v,scoreChange:w}}});const j=16;if(b.length<j){const g=j-b.length;for(let x=0;x<g;x++){const v=`bot-${o}-${x}`,w=Er(v),k=1e3+Math.floor(Is(w)*500),P=Ee[Math.floor(Is(w+1)*Ee.length)],S=Re[Math.floor(Is(w+2)*Re.length)];let E=0;for(let L=1;L<=y;L++){const Q=`${v}-${new Date(m.getTime()+L*24*60*60*1e3).toISOString().slice(0,10)}`,D=Er(Q),$=Is(D),q=Math.floor($*26);E+=q}const _=k+E,C=_-k,I=["","","","","","","","","","","","","","100%","","","","",""];let R=`Bot ${x+1}`;const A=b.filter(L=>L.id.startsWith("bot-")).map(L=>L.nickname),O=I.filter(L=>!A.includes(L));if(O.length>0){const L=Er(v+"nickname");R=O[Math.floor(Is(L)*O.length)]}else I.length>0&&(R=`${I[x%I.length]} ${Math.floor(Math.random()*100)}`);b.push({id:v,nickname:R,avatarId:P.id,borderId:S.id,initialScore:k,liveScore:_,scoreChange:C,league:n.league})}}return b.sort((g,x)=>x.liveScore-g.liveScore)},[n==null?void 0:n.weeklyCompetitors,n==null?void 0:n.lastWeeklyCompetitorsUpdate,s,o]);return f.useEffect(()=>{if(!n)return;const u=d.findIndex(p=>p.id===n.id)+1;u>0&&(r.current!==null&&r.current!==u&&e(!0),r.current=u)},[d,n,e]),!n||!n.weeklyCompetitors||n.weeklyCompetitors.length===0?t.jsx("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0 items-center justify-center text-gray-500",children:"     ..."}):t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0",children:[t.jsxs("div",{className:"flex-shrink-0 text-center mb-3 border-b border-gray-700 pb-2",children:[t.jsx("h2",{className:"text-xl font-bold",children:"  "}),t.jsx("p",{className:"text-sm text-yellow-300 font-mono",children:a})]}),t.jsx("ul",{className:"space-y-1.5 overflow-y-auto pr-2 flex-grow min-h-0",children:d.map((u,p)=>{var v,w;const m=p+1,h=u.id===n.id,y=u.scoreChange>0?"text-green-400":u.scoreChange<0?"text-red-400":"text-gray-400",b=u.scoreChange>0?"":u.scoreChange<0?"":"-",j=(v=Ee.find(k=>k.id===u.avatarId))==null?void 0:v.url,g=(w=Re.find(k=>k.id===u.borderId))==null?void 0:w.url,x=!h&&!u.id.startsWith("bot-");return t.jsxs("li",{className:`flex items-center gap-3 p-1.5 rounded-md ${h?"bg-blue-900/50":"bg-gray-900/50"} ${x?"transition-colors cursor-pointer hover:bg-gray-700/50":""}`,onClick:x?()=>l.openViewingUser(u.id):void 0,title:x?`${u.nickname}  `:"",children:[t.jsx("span",{className:"font-bold text-lg w-6 text-center flex-shrink-0",children:m}),t.jsx(Ce,{userId:u.id,userName:u.nickname,avatarUrl:j,borderUrl:g,size:28}),t.jsx("span",{className:"flex-grow font-semibold text-sm truncate",children:u.nickname}),t.jsxs("div",{className:"flex items-baseline gap-1 text-xs",children:[t.jsx("span",{className:"font-mono text-yellow-300",children:u.liveScore.toLocaleString()}),t.jsxs("span",{className:y,children:["(",b,Math.abs(u.scoreChange),")"]})]})]},u.id)})})]})},Du=({user:e,rank:n,isMyRankDisplay:s})=>{var x,v;const{currentUserWithStatus:l,handlers:r}=De();if(!l)return null;const a=e.tournamentScore||0,i=f.useMemo(()=>n===1?t.jsx("span",{className:"text-3xl",role:"img","aria-label":"Gold Trophy",children:""}):n===2?t.jsx("span",{className:"text-3xl",role:"img","aria-label":"Silver Trophy",children:""}):n===3?t.jsx("span",{className:"text-3xl",role:"img","aria-label":"Bronze Trophy",children:""}):t.jsx("span",{className:"text-2xl font-bold text-gray-300",children:n}),[n]),o=!s&&e.id===l.id,c="flex items-center rounded-lg",d="bg-yellow-900/40 border border-yellow-700",u="bg-blue-900/60 border border-blue-600",p="bg-gray-900/50",m=!s&&e.id!==l.id,h=`${c} ${s?d:o?u:p} p-1.5 lg:p-2 ${m?"cursor-pointer hover:bg-gray-700/50":""}`,y=(x=Ee.find(w=>w.id===e.avatarId))==null?void 0:x.url,b=(v=Re.find(w=>w.id===e.borderId))==null?void 0:v.url,j=tl.find(w=>w.tier===e.league),g=j==null?void 0:j.icon;return t.jsxs("li",{className:h,onClick:m?()=>r.openViewingUser(e.id):void 0,title:m?`${e.nickname}  `:"",children:[t.jsx("div",{className:"w-12 text-center flex-shrink-0 flex flex-col items-center justify-center",children:i}),g&&t.jsx("img",{src:g,alt:e.league,className:"w-8 h-8 mr-2 flex-shrink-0",title:e.league}),t.jsx(Ce,{userId:e.id,userName:e.nickname,size:32,avatarUrl:y,borderUrl:b}),t.jsxs("div",{className:"ml-2 lg:ml-3 flex-grow overflow-hidden",children:[t.jsx("p",{className:"font-semibold text-sm truncate",children:e.nickname}),t.jsxs("p",{className:"text-xs text-yellow-400 font-mono",children:[a.toLocaleString(),""]})]})]})},Db=()=>{const{currentUserWithStatus:e,allUsers:n,handlers:s}=De(),[l,r]=f.useState(tl[0].tier),[a,i]=f.useState(!1);f.useEffect(()=>{e!=null&&e.league&&r(e.league)},[e==null?void 0:e.league]);const o=f.useMemo(()=>e?[...n].filter(u=>u.league===l&&typeof u.tournamentScore=="number").sort((u,p)=>p.tournamentScore-u.tournamentScore):[],[n,l,e]),c=f.useMemo(()=>{if(!e)return{rank:-1,user:null};const u=[...n].filter(m=>m.league===e.league&&typeof m.tournamentScore=="number").sort((m,h)=>h.tournamentScore-m.tournamentScore),p=u.findIndex(m=>m.id===e.id);return{rank:p!==-1?p+1:-1,user:p!==-1?u[p]:null}},[n,e]);if(!e)return t.jsx("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0 items-center justify-center text-gray-500",children:"   ..."});const d=o.slice(0,100);return t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0",children:[a&&t.jsx($b,{onClose:()=>i(!1)}),t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-gray-700 pb-2 flex-shrink-0",children:[t.jsx("h2",{className:"text-xl font-bold",children:" "}),t.jsx("button",{onClick:()=>i(!0),className:"text-xs bg-gray-600 hover:bg-gray-500 text-white font-bold px-2 py-1 rounded-md transition-colors",children:" "})]}),t.jsx("div",{className:"flex flex-nowrap justify-start bg-gray-900/50 p-1 rounded-lg mb-3 flex-shrink-0 gap-1 tier-tabs-container overflow-x-auto",children:tl.map(u=>t.jsx("button",{onClick:()=>r(u.tier),className:`p-1 rounded-md transition-all duration-200 flex-shrink-0 ${l===u.tier?"bg-purple-600 ring-2 ring-purple-400":"hover:bg-gray-600"}`,title:u.name,children:t.jsx("img",{src:u.icon,alt:u.name,className:"w-10 h-10"})},u.tier))}),c.user&&t.jsx("div",{className:"flex-shrink-0 mb-3",children:t.jsx(Du,{user:c.user,rank:c.rank,isMyRankDisplay:!0})}),t.jsx("ul",{className:"space-y-2 overflow-y-auto pr-2 flex-grow min-h-0",children:d.length>0?d.map((u,p)=>t.jsx(Du,{user:u,rank:p+1,isMyRankDisplay:!1},u.id)):t.jsxs("p",{className:"text-center text-gray-500 pt-8",children:[l,"    ."]})},l)]})},Si=({type:e,onClick:n,onContinue:s,inProgress:l})=>{const r=Ml[e],a=l&&l.status==="round_in_progress",i=l&&(l.status==="complete"||l.status==="eliminated"),o=l&&(l.status==="bracket_ready"||l.status==="round_complete");let c="",d=n;return l&&(a?c=" ":i?c=" ":o&&(c=""),d=s),t.jsxs("div",{className:"group bg-gray-800 rounded-lg p-3 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-purple-500/30 cursor-pointer h-full",onClick:d,children:[t.jsx("h2",{className:"text-lg font-bold mb-2",children:r.name}),t.jsx("div",{className:"w-full aspect-video bg-gray-700 rounded-md flex items-center justify-center text-gray-500 overflow-hidden relative flex-grow",children:t.jsx("img",{src:r.image,alt:r.name,className:"w-full h-full object-cover"})}),t.jsxs("span",{className:"font-bold text-sm mt-2 text-yellow-300",children:[c," "]})]})},Ci=e=>e||null,qb=()=>{const{currentUserWithStatus:e,allUsers:n,handlers:s,waitingRoomChats:l}=De(),[r,a]=f.useState(null),[i,o]=f.useState(window.innerWidth<1024),[c,d]=f.useState(!1),[u,p]=f.useState(!1),[m,h]=f.useState(null);if(!e)return t.jsx("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)] relative text-gray-500 items-center justify-center",children:"   ..."});const y=Ci(e.lastNeighborhoodTournament),b=Ci(e.lastNationalTournament),j=Ci(e.lastWorldTournament),g=f.useCallback(async v=>{await s.handleAction({type:"START_TOURNAMENT_SESSION",payload:{type:v}}),window.location.hash=`#/tournament/${v}`},[s]),x=f.useCallback(async v=>{await s.handleAction({type:"START_TOURNAMENT_ROUND",payload:{type:v}}),window.location.hash=`#/tournament/${v}`},[s]);return t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)] relative",children:[t.jsxs("header",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[t.jsx("button",{onClick:()=>window.location.hash="#/profile",className:"transition-transform active:scale-90 filter hover:drop-shadow-lg",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-10 h-10"})}),t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:""}),t.jsx("div",{className:"w-10"})," "]}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-6 min-h-0",children:[t.jsxs("main",{className:"flex-grow grid grid-cols-12 gap-6 min-h-0",children:[t.jsxs("div",{className:"col-span-12 grid grid-cols-3 gap-4 flex-shrink-0",children:[t.jsx(Si,{type:"neighborhood",onClick:()=>g("neighborhood"),onContinue:()=>x("neighborhood"),inProgress:y||null}),t.jsx(Si,{type:"national",onClick:()=>g("national"),onContinue:()=>x("national"),inProgress:b||null}),t.jsx(Si,{type:"world",onClick:()=>g("world"),onContinue:()=>x("world"),inProgress:j||null})]}),t.jsx("div",{className:"col-span-8 bg-gray-800/50 rounded-lg shadow-lg min-h-0",children:t.jsx(Zl,{messages:l.global||[],mode:"global",onAction:s.handleAction,onViewUser:s.openViewingUser,locationPrefix:"[]"})}),t.jsx("div",{className:"col-span-4",children:t.jsx(Bb,{})})]}),t.jsxs("aside",{className:"hidden lg:flex flex-col lg:w-[480px] flex-shrink-0 gap-6",children:[t.jsxs("div",{className:"flex-1 flex flex-row gap-4 items-stretch min-h-0",children:[t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(Ob,{setHasRankChanged:p})}),t.jsx("div",{className:"w-24 flex-shrink-0",children:t.jsx(Xl,{fillHeight:!0})})]}),t.jsx("div",{className:"flex-1 min-h-0",children:t.jsx(Db,{})})]})]})]})},_x=({datasets:e,maxStatValue:n=200,size:s=250})=>{const l=s/2,r=Object.values(N),a=r.length,i=Math.PI*2/a,o=(m,h)=>{const y=i*h-Math.PI/2,b=Math.min(m,n)/n*(l*.8);return{x:l+b*Math.cos(y),y:l+b*Math.sin(y)}},c=[],d=[],u=[],p=s<150?8:10;for(let m=0;m<a;m++){const h=o(n,m);c.push(t.jsx("line",{x1:l,y1:l,x2:h.x,y2:h.y,stroke:"rgba(255, 255, 255, 0.2)",strokeWidth:"1"},`axis-${m}`));const y=o(n*1.15,m);d.push(t.jsx("text",{x:y.x,y:y.y,fontSize:p,fill:"rgba(255, 255, 255, 0.7)",textAnchor:"middle",dy:".3em",children:r[m]},`label-${m}`))}for(let m=1;m<=4;m++){const h=m*.25,y=r.map((b,j)=>o(n*h,j));u.push(t.jsx("polygon",{points:y.map(b=>`${b.x},${b.y}`).join(" "),fill:"none",stroke:"rgba(255, 255, 255, 0.2)",strokeWidth:"0.5"},`grid-${m}`))}return t.jsxs("svg",{viewBox:`0 0 ${s} ${s}`,width:"100%",height:"100%",children:[t.jsxs("g",{children:[u,c,d]}),e.map((m,h)=>{const b=r.map((j,g)=>o(m.stats[j]||0,g)).map(j=>`${j.x},${j.y}`).join(" ");return t.jsx("polygon",{points:b,fill:m.fill,stroke:m.color,strokeWidth:"2"},`dataset-${h}`)})]})},zb=e=>{try{const n=e.match(/SZ\[(\d+)\]/),s=n?parseInt(n[1],10):19,l=[],r=/;([BW])\[([a-s]{2})\]/g;let a;for(;(a=r.exec(e))!==null;){const i=a[1]==="B"?B.Black:B.White,o=a[2],c=o.charCodeAt(0)-97,d=o.charCodeAt(1)-97;l.push({player:i,x:c,y:d})}return{boardSize:s,moves:l}}catch(n){return console.error("Failed to parse SGF:",n),null}},Ax=(e,n,s)=>{const l=[];return e>0&&l.push({x:e-1,y:n}),e<s-1&&l.push({x:e+1,y:n}),n>0&&l.push({x:e,y:n-1}),n<s-1&&l.push({x:e,y:n+1}),l},Ub=(e,n,s,l,r)=>{var d;if(n<0||n>=r||e<0||e>=r||((d=l[n])==null?void 0:d[e])!==s)return null;const a=[{x:e,y:n}],i=new Set([`${e},${n}`]);let o=0;const c=[{x:e,y:n}];for(;a.length>0;){const{x:u,y:p}=a.shift();for(const m of Ax(u,p,r)){const h=`${m.x},${m.y}`,y=l[m.y][m.x];y===B.None?o++:y===s&&(i.has(h)||(i.add(h),a.push(m),c.push(m)))}}return{stones:c,liberties:o}},Fb=({timeElapsed:e=0,fileIndex:n,showLastMoveOnly:s})=>{const[l,r]=f.useState(null),[a,i]=f.useState(!0),[o,c]=f.useState(null),d=140;f.useEffect(()=>{(async()=>{if(i(!0),c(null),n==null){r({boardSize:19,moves:[]}),i(!1);return}const P=`/sgf/Gibo${n}.sgf`;try{const S=await fetch(P);if(!S.ok)throw new Error(`Failed to fetch SGF file: ${S.statusText}`);const E=await S.text(),_=zb(E);if(!_)throw new Error("Failed to parse SGF data.");r(_)}catch(S){c(S.message)}finally{i(!1)}})()},[n]);const u=f.useMemo(()=>{if(!l)return 0;if(s)return l.moves.length;if(e===0)return 0;const k=e/d,P=Math.floor(k*l.moves.length);return Math.min(P,l.moves.length)},[e,l,d,s]),p=f.useMemo(()=>{if(!l)return[];const{boardSize:k,moves:P}=l,S=Array(k).fill(null).map(()=>Array(k).fill(B.None));for(let E=0;E<u;E++){const _=P[E];S[_.y]&&S[_.y][_.x]!==void 0&&(S[_.y][_.x]=_.player);const C=_.player===B.Black?B.White:B.Black,I=Ax(_.x,_.y,k);for(const R of I)if(S[R.y][R.x]===C){const A=Ub(R.x,R.y,C,S,k);if(A&&A.liberties===0)for(const O of A.stones)S[O.y][O.x]=B.None}}return S},[u,l]),m=f.useMemo(()=>{const k=l==null?void 0:l.boardSize;return k?k===19?[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}]:k===13?[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9},{x:6,y:6}]:k===11?[{x:2,y:2},{x:8,y:2},{x:5,y:5},{x:2,y:8},{x:8,y:8}]:k===9?[{x:2,y:2},{x:6,y:2},{x:4,y:4},{x:2,y:6},{x:6,y:6}]:[]:[]},[l]);if(a)return t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"  ..."});if(o)return t.jsxs("div",{className:"flex items-center justify-center h-full text-red-400",children:[": ",o]});if(!l)return null;const{boardSize:h,moves:y}=l,b=300,j=b/h,g=j/2,x=j*.45,v=k=>({cx:g+k.x*j,cy:g+k.y*j}),w=y.slice(0,u);return t.jsx("div",{className:"w-full h-full bg-gray-900 rounded-lg overflow-hidden border-2 border-gray-700 relative",children:t.jsxs("svg",{viewBox:`0 0 ${b} ${b}`,className:"w-full h-full",children:[t.jsx("rect",{width:b,height:b,fill:"#DDAA77"}),Array.from({length:h}).map((k,P)=>t.jsxs("g",{children:[t.jsx("line",{x1:g+P*j,y1:g,x2:g+P*j,y2:b-g,stroke:"#54432a",strokeWidth:"0.5"}),t.jsx("line",{x1:g,y1:g+P*j,x2:b-g,y2:g+P*j,stroke:"#54432a",strokeWidth:"0.5"})]},P)),m.map((k,P)=>t.jsx("circle",{...v(k),r:h>9?3:2,fill:"#54432a"},`star-${P}`)),p.map((k,P)=>k.map((S,E)=>{if(S===B.None)return null;const{cx:_,cy:C}=v({x:E,y:P});let I=-1;for(let A=w.length-1;A>=0;A--)if(w[A].x===E&&w[A].y===P){I=A;break}const R=I===u-1;return t.jsxs("g",{children:[t.jsx("circle",{cx:_,cy:C,r:x,fill:S===B.Black?"black":"white"}),s&&I!==-1&&t.jsx("text",{x:_,y:C,textAnchor:"middle",dy:".35em",fontSize:x*1.2,fontWeight:"bold",fill:S===B.Black?"white":"black",children:I+1}),R&&t.jsx("circle",{cx:_,cy:C,r:x*.4,fill:"rgba(239, 68, 68, 0.8)",className:"animate-pulse"})]},`${E}-${P}`)}))]})})},Gb={early:[N.CombatPower,N.ThinkingSpeed,N.Concentration],mid:[N.CombatPower,N.Judgment,N.Concentration,N.Stability],end:[N.Calculation,N.Stability,N.Concentration]},qu=({player:e,initialPlayer:n,allUsers:s,currentUserId:l,onViewUser:r,highlightPhase:a})=>{var m,h;if(!e)return t.jsx("div",{className:"p-2 text-center text-gray-500 flex items-center justify-center h-full bg-gray-900/50 rounded-lg",children:"  ..."});const i=f.useMemo(()=>s.find(y=>y.id===e.id),[s,e.id]),o=f.useMemo(()=>{const y={wins:0,losses:0};return i!=null&&i.stats&&Object.values(i.stats).forEach(b=>{y.wins+=b.wins,y.losses+=b.losses}),y},[i]),c=!e.id.startsWith("bot-")&&e.id!==l,d=(m=Ee.find(y=>y.id===e.avatarId))==null?void 0:m.url,u=(h=Re.find(y=>y.id===e.borderId))==null?void 0:h.url,p=y=>a==="none"?!1:Gb[a].includes(y);return t.jsxs("div",{className:`bg-gray-900/50 p-3 rounded-lg flex flex-col items-center gap-2 h-full ${c?"cursor-pointer hover:bg-gray-700/50":""}`,onClick:c?()=>r(e.id):void 0,title:c?`${e.nickname}  `:"",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:d,borderUrl:u,size:40}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-bold text-base truncate",children:e.nickname}),t.jsxs("p",{className:"text-xs text-gray-400",children:["(",o.wins," ",o.losses,")"]})]})]}),t.jsxs("div",{className:"font-bold text-sm mt-1 relative",children:[": ",t.jsx("span",{className:"text-yellow-300",children:e.condition===1e3?"-":e.condition})]}),t.jsx("div",{className:"w-full grid grid-cols-2 gap-x-1 sm:gap-x-3 gap-y-0.5 text-xs mt-2 border-t border-gray-600 pt-2",children:Object.values(N).map(y=>{var x;const b=((x=n==null?void 0:n.stats)==null?void 0:x[y])??e.stats[y],g=e.stats[y]-b;return t.jsxs(Mn.Fragment,{children:[t.jsx("span",{className:`text-gray-400 ${p(y)?"text-yellow-400 font-bold":""}`,children:y}),t.jsxs("div",{className:"flex justify-end items-baseline relative",children:[t.jsx("span",{className:`font-mono text-white ${p(y)?"text-yellow-400 font-bold":""}`,children:e.stats[y]}),n&&g!==0&&t.jsxs("span",{className:`ml-1 font-bold ${g>0?"text-green-400":"text-red-400"}`,children:["(",g>0?"+":"",g,")"]})]})]},y)})})]})},Wb=({timeElapsed:e,totalDuration:n})=>{const s=e/n*100,l=Math.min(s,40/140*100),r=Math.min(Math.max(0,s-40/140*100),60/140*100),a=Math.min(Math.max(0,s-100/140*100),40/140*100);return t.jsxs("div",{children:[t.jsxs("div",{className:"w-full bg-gray-900 rounded-full h-2 flex border border-gray-600",children:[t.jsx("div",{className:"bg-green-500 h-full rounded-l-full",style:{width:`${l}%`},title:""}),t.jsx("div",{className:"bg-yellow-500 h-full",style:{width:`${r}%`},title:""}),t.jsx("div",{className:"bg-red-500 h-full rounded-r-full",style:{width:`${a}%`},title:""})]}),t.jsxs("div",{className:"flex text-xs text-gray-400 mt-1",children:[t.jsx("div",{style:{width:`${40/140*100}%`},children:""}),t.jsx("div",{style:{width:`${60/140*100}%`},className:"text-center",children:""}),t.jsx("div",{style:{width:`${40/140*100}%`},className:"text-right",children:""})]})]})},Hb=({p1Percent:e,p2Percent:n,p1Nickname:s,p2Nickname:l})=>t.jsxs("div",{children:[s&&l&&t.jsxs("div",{className:"flex justify-between text-xs px-1 mb-1 font-bold",children:[t.jsxs("span",{className:"truncate max-w-[45%]",children:[": ",s]}),t.jsxs("span",{className:"truncate max-w-[45%] text-right",children:[": ",l]})]}),t.jsxs("div",{className:"flex w-full h-3 bg-gray-700 rounded-full overflow-hidden border-2 border-black/30 relative",children:[t.jsx("div",{className:"bg-black transition-all duration-500 ease-in-out",style:{width:`${e}%`}}),t.jsx("div",{className:"bg-white transition-all duration-500 ease-in-out",style:{width:`${n}%`}}),t.jsx("div",{className:"absolute top-0 bottom-0 left-1/2 -translate-x-1/2 w-0.5 bg-gray-400/50",title:""})]})]}),Vb=e=>{const{text:n,isRandomEvent:s}=e;if(n.startsWith("  !")||n.startsWith("[]"))return t.jsx("strong",{className:"text-yellow-400",children:n});const l=/(\d+\.\d+|\d+\.5)/g,r=n.split(l);return t.jsx("span",{className:s?"text-cyan-400":"",children:r.map((a,i)=>l.test(a)?t.jsx("strong",{className:"text-yellow-400",children:a},i):a)})},Kb=({commentary:e,isSimulating:n})=>{const s=f.useRef(null);return f.useEffect(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[e]),t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsxs("h4",{className:"text-center font-bold text-sm mb-2 text-gray-400 py-1 flex-shrink-0",children:[" ",n&&t.jsx("span",{className:"ml-2 text-yellow-400 animate-pulse",children:"  ..."})]}),t.jsx("div",{ref:s,className:"flex-grow overflow-y-auto space-y-2 text-sm text-gray-300 p-2 bg-gray-900/40 rounded-md min-h-0",children:e.length>0?e.map((l,r)=>t.jsx("p",{className:"animate-fade-in break-words",children:Vb(l)},r)):t.jsx("p",{className:"text-gray-500 text-center h-full flex items-center justify-center",children:"   ..."})})]})},Qb=({tournamentState:e,currentUser:n,onAction:s})=>{var b;const l=e.status==="complete",r=e.status==="eliminated";if(!l)return r?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("h4",{className:"font-bold text-gray-400 mb-2",children:" "}),t.jsx("p",{className:"text-xs text-gray-500 mt-2 animate-pulse",children:"    ..."})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("h4",{className:"font-bold text-gray-400 mb-2",children:" "}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"   ."})]});const{type:a,rounds:i}=e,o=Ml[a],c=R0[a];let d=-1;if(a==="neighborhood"){const j={};e.players.forEach(v=>{j[v.id]=0}),i[0].matches.forEach(v=>{v.winner&&(j[v.winner.id]=(j[v.winner.id]||0)+1)});const g=[...e.players].sort((v,w)=>j[w.id]-j[v.id]);let x=-1;for(let v=0;v<g.length;v++)if(v===0?x=1:j[g[v].id]<j[g[v-1].id]&&(x=v+1),g[v].id===n.id){d=x;break}}else{const j=i.length;let g=-1;for(let x=0;x<j;x++){const w=i[x].matches.find(k=>k.isUserMatch);if(w&&((b=w.winner)==null?void 0:b.id)!==n.id){g=x;break}}if(g===-1)d=1;else{const x=o.players/Math.pow(2,g);if(j===3&&g===1){const v=i.find(w=>w.name==="3,4");v&&v.matches.some(k=>k.isUserMatch)?d=v.matches.some(P=>{var S;return P.isUserMatch&&((S=P.winner)==null?void 0:S.id)===n.id})?3:4:d=4}else d=x}}let u;a==="neighborhood"?u=d<=3?d:4:a==="national"?u=d<=4?d:5:d<=4?u=d:d<=8?u=5:u=9;const p=c==null?void 0:c.rewards[u];if(!p)return t.jsx("p",{className:"text-gray-500 flex items-center justify-center h-full",children:"  ."});const m=`${a}RewardClaimed`,h=!!n[m],y=()=>{!h&&l&&(Pe.claimReward(),s({type:"CLAIM_TOURNAMENT_REWARD",payload:{tournamentType:a}}))};return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("h4",{className:"font-bold text-gray-400 mb-2",children:" "}),t.jsx("div",{className:"flex flex-row items-center justify-center gap-4",children:(p.items||[]).map((j,g)=>{const x="itemId"in j?j.itemId:j.name,v=ws.find(k=>k.name===x),w=(v==null?void 0:v.image)||"";return t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsxs("button",{onClick:y,disabled:h||!l,className:"relative w-16 h-16 transition-transform hover:scale-105 disabled:cursor-not-allowed",title:h?" ":l?" ":"      .",children:[t.jsx("img",{src:w,alt:x,className:`w-full h-full object-contain ${h||!l?"filter grayscale":""}`}),h&&t.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center text-3xl text-green-400",children:""})]}),t.jsxs("span",{className:"text-xs text-center",children:[x," x",j.quantity]})]},g)})}),!l&&!h&&t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"    "}),h&&t.jsx("p",{className:"text-xs text-green-400 mt-2",children:" ."})]})},Rx=({match:e,currentUser:n})=>{var c,d;const s=e.players[0],l=e.players[1],r=({player:u,isWinner:p})=>{var j,g;if(!u)return t.jsx("div",{className:"h-8 flex items-center",children:t.jsx("span",{className:"text-gray-600 truncate",children:"..."})});const m=!p&&e.isFinished?"opacity-60":"",h=p?"text-yellow-300":"",y=(j=Ee.find(x=>x.id===u.avatarId))==null?void 0:j.url,b=(g=Re.find(x=>x.id===u.borderId))==null?void 0:g.url;return t.jsxs("div",{className:`flex items-center gap-2 ${m}`,children:[t.jsx(Ce,{userId:u.id,userName:u.nickname,avatarUrl:y,borderUrl:b,size:28}),t.jsx("span",{className:`truncate font-semibold ${h}`,children:u.nickname})]})},a=e.isFinished&&((c=e.winner)==null?void 0:c.id)===(s==null?void 0:s.id),i=e.isFinished&&((d=e.winner)==null?void 0:d.id)===(l==null?void 0:l.id),o=(s==null?void 0:s.id)===n.id||(l==null?void 0:l.id)===n.id;return t.jsxs("div",{className:`p-1.5 rounded-lg text-sm space-y-1 ${o?"bg-blue-900/40 border border-blue-700":"bg-gray-700/50"}`,children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(r,{player:s,isWinner:a}),a&&t.jsx("span",{className:"font-bold text-green-400",children:"W"})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(r,{player:l,isWinner:i}),i&&t.jsx("span",{className:"font-bold text-green-400",children:"W"})]})]})},Mr=({name:e,matches:n,currentUser:s})=>t.jsxs("div",{className:"flex flex-col justify-around h-full gap-4 flex-shrink-0 w-44",children:[t.jsx("h5",{className:"text-center font-bold text-sm text-gray-400",children:e}),t.jsx("div",{className:"flex flex-col justify-around h-full gap-6",children:n==null?void 0:n.map(l=>t.jsx(Rx,{match:l,currentUser:s},l.id))})]}),Jb=({tournamentState:e,currentUser:n})=>{var b;const[s,l]=f.useState("matches"),{players:r,rounds:a,status:i,currentRoundRobinRound:o}=e,c=((b=a[0])==null?void 0:b.matches)||[],d=f.useMemo(()=>{const j={};return r.forEach(g=>{j[g.id]={wins:0,losses:0}}),c.forEach(g=>{if(g.isFinished&&g.winner){const x=g.winner.id;j[x]&&j[x].wins++;const v=g.players.find(w=>w&&w.id!==x);v&&j[v.id]&&j[v.id].losses++}}),j},[r,c]),u=f.useMemo(()=>[...r].sort((j,g)=>{var x,v;return(((x=d[g.id])==null?void 0:x.wins)||0)-(((v=d[j.id])==null?void 0:v.wins)||0)}),[r,d]),p=[[[0,5],[1,4],[2,3]],[[0,4],[5,3],[1,2]],[[0,3],[4,2],[5,1]],[[0,2],[3,1],[4,5]],[[0,1],[2,5],[3,4]]],m=i==="bracket_ready"?1:o||1,h=p[m-1],y=f.useMemo(()=>h?h.map(j=>{const g=r[j[0]].id,x=r[j[1]].id;return c.find(v=>{var w,k,P,S;return((w=v.players[0])==null?void 0:w.id)===g&&((k=v.players[1])==null?void 0:k.id)===x||((P=v.players[0])==null?void 0:P.id)===x&&((S=v.players[1])==null?void 0:S.id)===g})}).filter(j=>!!j):[],[h,r,c]);return t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsx("h4",{className:"font-bold text-center mb-2 flex-shrink-0 text-gray-300",children:" "}),t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-2 flex-shrink-0",children:[t.jsxs("button",{onClick:()=>l("matches"),className:`flex-1 py-1 text-xs font-semibold rounded-md transition-all ${s==="matches"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:[m,""]}),t.jsx("button",{onClick:()=>l("ranking"),className:`flex-1 py-1 text-xs font-semibold rounded-md transition-all ${s==="ranking"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "})]}),t.jsx("div",{className:"overflow-y-auto pr-2 flex-grow min-h-0",children:s==="matches"?t.jsx("div",{className:"flex flex-col items-center justify-around h-full gap-4",children:y.map(j=>t.jsx(Rx,{match:j,currentUser:n},j.id))}):t.jsx("ul",{className:"space-y-1.5",children:u.map((j,g)=>{const x=d[j.id],v=j.id===n.id;return t.jsxs("li",{className:`flex items-center gap-3 p-1.5 rounded-md ${v?"bg-blue-900/50":"bg-gray-700/50"}`,children:[t.jsx("span",{className:"font-bold text-lg w-6 text-center flex-shrink-0",children:g+1}),t.jsx("span",{className:"flex-grow font-semibold text-sm truncate",children:j.nickname}),t.jsx("div",{className:"flex items-baseline gap-2 text-xs",children:t.jsxs("span",{className:"font-mono",children:[x.wins," ",x.losses,""]})})]},j.id)})})})]})},Yb=({rounds:e,currentUser:n,tournamentType:s})=>{const l=f.useMemo(()=>{const d=new Map;e.forEach(m=>d.set(m.name,m.matches));let u=[];if(s==="world")u=["16","8","4","  3/4"];else if(s==="national")u=["8","4","  3/4"];else return null;return u.map(m=>{let h=[];return m==="  3/4"?h=(d.get("")||[]).concat(d.get("3,4")||[]):h=d.get(m)||[],{name:m,matches:h,isInProgress:h.length>0&&h.some(y=>!y.isFinished)}}).filter(m=>m.matches.length>0)},[e,s]),r=f.useMemo(()=>{if(!l)return 0;const d=l.findIndex(u=>u.isInProgress);return d!==-1?d:Math.max(0,l.length-1)},[l]),[a,i]=f.useState(r);if(f.useEffect(()=>{i(r)},[r]),!l){const d=["16","8","4","3,4",""],u=[...e].sort((p,m)=>d.indexOf(p.name)-d.indexOf(m.name));return t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsx("h4",{className:"font-bold text-center mb-2 flex-shrink-0 text-gray-300",children:""}),t.jsx("div",{className:"flex-grow overflow-auto flex items-center justify-center p-2 space-x-4",children:u.map(p=>t.jsx(Mr,{name:p.name,matches:p.matches,currentUser:n},p.id))})]})}const o=l[a],c=d=>{if(d.name==="  3/4"){const u=d.matches.filter(m=>{var h;return((h=e.find(y=>y.matches.includes(m)))==null?void 0:h.name)===""}),p=d.matches.filter(m=>{var h;return((h=e.find(y=>y.matches.includes(m)))==null?void 0:h.name)==="3,4"});return t.jsxs("div",{className:"flex flex-col justify-center items-center h-full gap-12 p-4",children:[t.jsx(Mr,{name:"",matches:u,currentUser:n}),p.length>0&&t.jsx(Mr,{name:"3,4",matches:p,currentUser:n})]})}return t.jsx("div",{className:"flex justify-center items-center h-full gap-4 p-4",children:t.jsx(Mr,{name:d.name,matches:d.matches,currentUser:n})})};return t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsx("h4",{className:"font-bold text-center mb-2 flex-shrink-0 text-gray-300",children:""}),t.jsx("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-2 flex-shrink-0",children:l.map((d,u)=>t.jsx("button",{onClick:()=>i(u),className:`flex-1 py-1 text-xs font-semibold rounded-md transition-all ${a===u?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:d.name},d.name))}),t.jsx("div",{className:"flex-grow overflow-auto",children:o&&c(o)})]})},Xb=e=>{var re,ce,ve;const{tournament:n,currentUser:s,onBack:l,allUsersForRanking:r,onViewUser:a,onAction:i,onStartNextRound:o,onReset:c,onSkip:d,isMobile:u}=e,[p,m]=f.useState(null),[h,y]=f.useState({p1:null,p2:null}),b=f.useRef(n.status),j=f.useMemo(()=>Array.isArray(n.rounds)?n.rounds:[],[n.rounds]);f.useEffect(()=>(i({type:"ENTER_TOURNAMENT_VIEW"}),()=>{i({type:"LEAVE_TOURNAMENT_VIEW"})}),[i]),f.useEffect(()=>{const F=n.status,X=b.current;if((F==="round_complete"||F==="eliminated"||F==="complete")&&X==="round_in_progress"){const ee=[...j].reverse().flatMap(xe=>xe.matches).find(xe=>xe.isUserMatch&&xe.isFinished);ee&&ee.sgfFileIndex&&m(ee.sgfFileIndex)}else if(F==="bracket_ready")m(null);else if(F==="round_in_progress"&&n.timeElapsed===1){const ee=n.currentSimulatingMatch;if(ee){const xe=j[ee.roundIndex].matches[ee.matchIndex],J=n.players.find(K=>{var Z;return K.id===((Z=xe.players[0])==null?void 0:Z.id)})||null,G=n.players.find(K=>{var Z;return K.id===((Z=xe.players[1])==null?void 0:Z.id)})||null;y({p1:J?JSON.parse(JSON.stringify(J)):null,p2:G?JSON.parse(JSON.stringify(G)):null})}}else F!=="round_in_progress"&&y({p1:null,p2:null});b.current=F},[n,j]);const g=f.useCallback(()=>{n.status==="round_in_progress"?window.confirm(" .  ?     .")&&i({type:"FORFEIT_TOURNAMENT",payload:{type:n.type}}):l()},[l,i,n.status,n.type]),x=f.useCallback(()=>{window.confirm("  ?    .")&&i({type:"FORFEIT_TOURNAMENT",payload:{type:n.type}})},[i,n.type]),v=n.status==="round_in_progress",w=v&&n.currentSimulatingMatch?j[n.currentSimulatingMatch.roundIndex].matches[n.currentSimulatingMatch.matchIndex]:null,k=f.useMemo(()=>[...j].reverse().flatMap(F=>F.matches).find(F=>F.isUserMatch&&F.isFinished),[j]),P=v?w:k||j.flatMap(F=>F.matches).find(F=>F.isUserMatch)||((re=j[0])==null?void 0:re.matches[0]),S=f.useMemo(()=>{var F;if(n.status!=="complete")return null;if(n.type==="neighborhood"){const X={};return n.players.forEach(ee=>X[ee.id]=0),j[0].matches.forEach(ee=>{ee.winner&&X[ee.winner.id]++}),[...n.players].sort((ee,xe)=>X[xe.id]-X[ee.id])[0]}else{const X=j.find(ee=>ee.name==="");return(F=X==null?void 0:X.matches[0])==null?void 0:F.winner}},[n.status,n.type,n.players,j]),E=f.useMemo(()=>{var X,ee;if(n.status==="complete"||n.status==="eliminated"){if(n.type==="neighborhood"){const J=j.flatMap(Y=>Y.matches).filter(Y=>Y.isUserMatch&&Y.isFinished),G=J.filter(Y=>{var ie;return((ie=Y.winner)==null?void 0:ie.id)===s.id}).length,K=J.length-G,Z={};n.players.forEach(Y=>{Z[Y.id]=0}),j[0].matches.forEach(Y=>{Y.winner&&(Z[Y.winner.id]=(Z[Y.winner.id]||0)+1)});const fe=[...n.players].sort((Y,ie)=>Z[ie.id]-Z[Y.id]);let we=-1,M=1;for(let Y=0;Y<fe.length;Y++)if(Y>0&&Z[fe[Y].id]<Z[fe[Y-1].id]&&(M=Y+1),fe[Y].id===s.id){we=M;break}return`${G} ${K}! ${we}`}if((S==null?void 0:S.id)===s.id)return" !";const xe=[...j].reverse().flatMap(J=>J.matches).find(J=>J.isUserMatch&&J.isFinished);if(xe){const J=j.find(G=>G.matches.some(K=>K.id===xe.id));if((J==null?void 0:J.name)==="")return"!";if((J==null?void 0:J.name)==="4"){const G=j.flatMap(K=>K.matches).find(K=>{const Z=j.find(fe=>fe.matches.some(we=>we.id===K.id));return K.isUserMatch&&(Z==null?void 0:Z.name)==="3,4"});if(G)return((X=G.winner)==null?void 0:X.id)===s.id?"3":"4"}return`${(J==null?void 0:J.name)||""} `}return" "}if(n.status==="round_complete"||n.status==="bracket_ready"){const xe=[...j].reverse().flatMap(J=>J.matches).find(J=>J.isUserMatch&&J.isFinished);if(xe){const J=((ee=xe.winner)==null?void 0:ee.id)===s.id;if(n.type==="neighborhood"){const G=j.flatMap(fe=>fe.matches).filter(fe=>fe.isUserMatch&&fe.isFinished),K=G.filter(fe=>{var we;return((we=fe.winner)==null?void 0:we.id)===s.id}).length,Z=G.length-K;return`${G.length} ${J?"":""}! (${K} ${Z})`}else if(J){const G=j.find(K=>K.matches.some(Z=>!Z.isFinished&&Z.players.some(fe=>(fe==null?void 0:fe.id)===s.id)));if(G)return`${G.name} !`}}}const F=j.find(xe=>xe.matches.some(J=>J.isUserMatch&&!J.isFinished));return F?`${F.name}  `:"  "},[s.id,n,S,j]),_=(P==null?void 0:P.players[0])||null,C=(P==null?void 0:P.players[1])||null,I=_?n.players.find(F=>F.id===_.id)||_:null,R=C?n.players.find(F=>F.id===C.id)||C:null,A=f.useMemo(()=>[{stats:(I==null?void 0:I.stats)||{},color:"#60a5fa",fill:"rgba(59, 130, 246, 0.4)"},{stats:(R==null?void 0:R.stats)||{},color:"#f87171",fill:"rgba(239, 68, 68, 0.4)"}],[I,R]),O=f.useMemo(()=>{if(!I||!R)return 200;const F=[...Object.values(I.stats),...Object.values(R.stats)],X=Math.max(...F,0);return Math.ceil((X+50)/50)*50},[I,R]),L=f.useMemo(()=>{if(n.status!=="round_in_progress")return"none";const F=n.timeElapsed;return F<=40?"early":F<=100?"mid":F<=140?"end":"none"},[n.timeElapsed,n.status]),Q=((ce=n.currentMatchScores)==null?void 0:ce.player1)||0,D=((ve=n.currentMatchScores)==null?void 0:ve.player2)||0,$=Q+D,q=$>0?Q/$*100:50,z=$>0?D/$*100:50,W=()=>{const{status:F}=n;if(F==="round_in_progress")return t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(U,{disabled:!0,colorScheme:"green",children:"  ..."}),t.jsx(U,{onClick:x,colorScheme:"red",children:""})]});if(F==="complete")return t.jsx("button",{onClick:l,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})});if(F==="eliminated")return t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx("button",{onClick:l,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx(U,{onClick:d,colorScheme:"yellow",children:" "})]});const X=j.some(ee=>ee.matches.some(xe=>xe.isUserMatch&&!xe.isFinished));return(F==="round_complete"||F==="bracket_ready")&&X?t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(U,{onClick:o,colorScheme:"green",className:"animate-pulse",children:" "}),t.jsx(U,{onClick:x,colorScheme:"red",children:""})]}):t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(U,{disabled:!0,colorScheme:"gray",children:" "}),t.jsx(U,{onClick:d,colorScheme:"yellow",children:" "})]})},H=t.jsxs("main",{className:"flex-1 flex flex-col lg:flex-row gap-4 min-h-0",children:[t.jsxs("aside",{className:"w-full lg:w-[35%] xl:w-[25%] flex-shrink-0 flex flex-col gap-2",children:[t.jsx("div",{className:"flex-1 bg-gray-800/50 rounded-lg p-2 min-h-0",children:n.type==="neighborhood"?t.jsx(Jb,{tournamentState:n,currentUser:s}):t.jsx(Yb,{rounds:j,currentUser:s,tournamentType:n.type})}),t.jsxs("div",{className:"h-48 flex-shrink-0 bg-gray-800/50 rounded-lg p-3 text-center flex flex-col items-center justify-center",children:[t.jsx("img",{src:"/images/Ranking.png",alt:"Trophy",className:"w-20 h-20 mb-2"}),t.jsx("h4",{className:"font-bold text-gray-400",children:""}),S?t.jsx("p",{className:"text-xl font-semibold text-yellow-300",children:S.nickname}):t.jsx("p",{className:"text-sm text-gray-500",children:" ..."})]})]}),t.jsxs("div",{className:"flex-grow flex flex-col gap-2 min-h-0 min-w-0",children:[t.jsxs("section",{className:"flex flex-row gap-1 md:gap-2 items-stretch p-2 bg-gray-800/50 rounded-lg",children:[t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(qu,{player:I,initialPlayer:h.p1,allUsers:r,currentUserId:s.id,onViewUser:a,highlightPhase:L})}),t.jsxs("div",{className:"flex-shrink-0 w-44 sm:w-52 flex flex-col items-center justify-center min-w-0",children:[t.jsx(_x,{datasets:A,maxStatValue:O,size:u?140:void 0}),t.jsxs("div",{className:"flex justify-center gap-2 sm:gap-4 text-[10px] sm:text-xs mt-1",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 rounded-sm",style:{backgroundColor:"rgba(59, 130, 246, 0.6)"}}),(I==null?void 0:I.nickname)||" 1"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 rounded-sm",style:{backgroundColor:"rgba(239, 68, 68, 0.6)"}}),(R==null?void 0:R.nickname)||" 2"]})]})]}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(qu,{player:R,initialPlayer:h.p2,allUsers:r,currentUserId:s.id,onViewUser:a,highlightPhase:L})})]}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-2 min-h-0",children:[t.jsx("div",{className:"w-full h-80 lg:h-full lg:w-2/5 bg-gray-800/50 rounded-lg p-2 flex items-center justify-center",children:t.jsx(Fb,{timeElapsed:v?n.timeElapsed:0,fileIndex:v?w==null?void 0:w.sgfFileIndex:p,showLastMoveOnly:!v})}),t.jsxs("div",{className:"w-full lg:w-3/5 flex-1 flex flex-col gap-2 min-h-0",children:[t.jsxs("section",{className:"flex-shrink-0 bg-gray-800/50 rounded-lg p-3",children:[t.jsx(Hb,{p1Percent:q,p2Percent:z,p1Nickname:I==null?void 0:I.nickname,p2Nickname:R==null?void 0:R.nickname}),t.jsx("div",{className:"mt-2",children:t.jsx(Wb,{timeElapsed:n.timeElapsed,totalDuration:140})})]}),t.jsx("div",{className:"h-64 lg:h-auto lg:flex-1 min-h-0 bg-gray-800/50 rounded-lg p-2 flex flex-col",children:t.jsx(Kb,{commentary:n.currentMatchCommentary,isSimulating:n.status==="round_in_progress"})})]})]})]})]}),ne=()=>t.jsxs("footer",{className:"flex-shrink-0 bg-gray-800/50 rounded-lg p-3 grid grid-cols-1 md:grid-cols-3 items-center gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ce,{userId:s.id,userName:s.nickname,size:40}),t.jsxs("div",{className:"text-left",children:[t.jsx("h4",{className:"font-bold",children:s.nickname}),t.jsx("p",{className:"text-xs text-yellow-300",children:E})]})]}),t.jsx("div",{className:"text-center order-first md:order-none",children:W()}),t.jsx("div",{className:"text-right",children:t.jsx(Qb,{tournamentState:n,currentUser:s,onAction:i})})]});return t.jsxs("div",{className:"w-full p-2 flex flex-col gap-2 bg-gray-900 text-white min-h-full",children:[t.jsxs("header",{className:"flex items-center justify-between flex-shrink-0",children:[t.jsx("button",{onClick:g,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:n.title}),t.jsx("div",{className:"w-28"})]}),u?t.jsxs("div",{className:"flex-1 flex flex-col gap-4 min-h-0",children:[t.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:H}),ne()]}):t.jsxs(t.Fragment,{children:[H,ne()]})]})},Zb=({type:e})=>{const{currentUserWithStatus:n,handlers:s,allUsers:l}=De();let r;switch(e){case"neighborhood":r="lastNeighborhoodTournament";break;case"national":r="lastNationalTournament";break;case"world":r="lastWorldTournament";break;default:return t.jsx("div",{children:"Invalid tournament type"})}const a=n==null?void 0:n[r];return!a||!n?t.jsxs("div",{className:"p-4 text-center",children:[t.jsx("p",{children:"   ..."}),t.jsx(U,{onClick:()=>window.location.hash="#/tournament",className:"mt-4",children:" "})]}):t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)] relative",children:[t.jsxs("header",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[t.jsx(U,{onClick:()=>window.location.hash="#/tournament",colorScheme:"gray",className:"p-0 flex items-center justify-center w-10 h-10 rounded-full",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:a.title}),t.jsx("div",{className:"w-10"})]}),t.jsx("main",{className:"flex-1 flex flex-col items-center justify-center",children:t.jsx(Xb,{tournament:a,currentUser:n,onBack:()=>window.location.hash="#/tournament",allUsersForRanking:l,onViewUser:s.openViewingUser,onAction:s.handleAction,onStartNextRound:()=>s.handleAction({type:"START_TOURNAMENT_ROUND",payload:{type:e}}),onReset:()=>s.handleAction({type:"CLEAR_TOURNAMENT_SESSION",payload:{type:e}}),onSkip:()=>s.handleAction({type:"SKIP_TOURNAMENT_END",payload:{type:e}}),isMobile:!1})})]})},ev=()=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full flex flex-col items-center justify-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:""}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{className:"text-2xl",children:""}),t.jsx("img",{src:"/images/championship/Champ1.png",alt:"Beginner Class",className:"w-48 h-32"}),t.jsx("button",{className:"text-2xl",children:""})]})]}),tv=()=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:" "}),t.jsx("div",{className:"grid grid-cols-5 gap-4",children:Array.from({length:20},(e,n)=>t.jsx("div",{className:"aspect-square bg-gray-700 rounded-md flex items-center justify-center",children:n+1},n))})]}),nv=()=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:" "}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"bg-gray-700 p-2 rounded-md",children:" 1"}),t.jsx("div",{className:"bg-gray-700 p-2 rounded-md",children:" 2"}),t.jsx("div",{className:"bg-gray-700 p-2 rounded-md",children:" 3"})]})]}),sv=()=>{const e=()=>window.location.hash="#/profile";return t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)]",children:[t.jsxs("header",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[t.jsx(U,{onClick:e,colorScheme:"gray",className:"p-0 flex items-center justify-center w-10 h-10 rounded-full",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:""}),t.jsx("div",{className:"w-10"})," "]}),t.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-6 min-h-0",children:[t.jsx("div",{className:"col-span-3",children:t.jsx(ev,{})}),t.jsx("div",{className:"col-span-6",children:t.jsx(tv,{})}),t.jsx("div",{className:"col-span-3",children:t.jsx(nv,{})})]})]})},lv=()=>t.jsxs("div",{className:"p-4",children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Guild Page"}),t.jsx("p",{children:"Welcome to the Guild page. This feature is under construction."})]}),zu=()=>{const{currentRoute:e,currentUser:n,activeGame:s}=De();if(!n)return e.view==="register"?t.jsx(U0,{}):t.jsx(q0,{});if(s&&e.view!=="game")return t.jsx("div",{className:"flex items-center justify-center h-full",children:" ..."});switch(e.view){case"profile":return t.jsx(K0,{});case"lobby":const l=e.params.type==="playful"?"playful":"strategic";return t.jsx(J0,{lobbyType:l});case"waiting":return e.params.mode?t.jsx(iy,{mode:e.params.mode}):(window.location.hash="#/profile",null);case"game":return e.params.id&&s&&s.id===e.params.id?t.jsx(Pb,{session:s}):(console.warn("Router: Mismatch between route and active game. Redirecting to profile."),window.location.hash="#/profile",null);case"admin":return t.jsx(Lb,{});case"tournament":return e.params.type?t.jsx(Zb,{type:e.params.type}):t.jsx(qb,{});case"singleplayer":return t.jsx(sv,{});case"guild":return t.jsx(lv,{});default:return window.location.hash="#/profile",null}},Lx=({item:e,currentUser:n,onClose:s,onConfirm:l})=>{const[r,a]=f.useState(1),i=!!e.price.gold,o=e.price.gold||e.price.diamonds||0,c=o*r,d=f.useMemo(()=>{var y,b,j;const p=i?n.gold:n.diamonds,m=o>0?Math.floor(p/o):1/0;let h=1/0;if(e.type==="equipment"){const g=n.inventory.filter(w=>w.type==="equipment").length,v=(((y=n.inventorySlots)==null?void 0:y.equipment)||ms+(((b=n.inventoryExpansions)==null?void 0:b.equipment)||0)*Sc)-g;h=v>0?v:0}else{const g=n.inventory.filter(w=>w.id===e.itemId).length,v=(((j=n.inventorySlots)==null?void 0:j[e.type])||ms)-g;h=v>0?v:0}return Math.max(1,Math.min(e.limit||1/0,m,h,999))},[e,n,i,o]),u=()=>{r>0&&l(e.itemId,r),s()};return t.jsx(be,{title:" ",onClose:s,windowId:"purchase-quantity",initialWidth:400,zIndex:60,children:t.jsxs("div",{className:"text-center flex flex-col items-center",children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:e.name}),t.jsxs("div",{className:"w-full space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(U,{onClick:()=>a(p=>Math.max(1,p-1)),disabled:r<=1,children:"-"}),t.jsx("input",{type:"number",value:r,onChange:p=>a(Math.max(1,Math.min(d,Number(p.target.value)))),className:"w-24 text-center text-2xl font-bold bg-tertiary rounded-md p-2"}),t.jsx(U,{onClick:()=>a(p=>Math.min(d,p+1)),disabled:r>=d,children:"+"}),t.jsx(U,{onClick:()=>a(d),disabled:d<=0,colorScheme:"blue",className:"!py-2 !px-3",children:"Max"})]}),t.jsx("input",{type:"range",min:"1",max:d,value:r,onChange:p=>a(Number(p.target.value)),className:"w-full"})]}),t.jsxs("div",{className:"mt-6 text-lg",children:[t.jsx("p",{children:" :"}),t.jsxs("div",{className:"flex items-center justify-center gap-2 font-bold text-2xl text-yellow-300",children:[t.jsx("img",{src:i?"/images/icon/Gold.png":"/images/icon/Zem.png",alt:i?"":"",className:"w-6 h-6"}),t.jsx("span",{children:c.toLocaleString()})]})]}),t.jsxs("div",{className:"flex w-full gap-4 mt-6",children:[t.jsx(U,{onClick:s,colorScheme:"gray",className:"w-full",children:""}),t.jsx(U,{onClick:u,disabled:r===0||r>d,className:"w-full",children:""})]})]})})},rv=e=>100+Math.max(0,(e-ms)/Sc)*20,Uu={normal:0,uncommon:1,rare:2,epic:3,legendary:4,mythic:5},av=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-purple-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},iv=({slot:e,item:n})=>{const s=l=>{if(l===0)return null;let r="",a="";return l>=10?(r="/images/equipments/Star4.png",a="prism-text-effect"):l>=7?(r="/images/equipments/Star3.png",a="text-purple-400"):l>=4?(r="/images/equipments/Star2.png",a="text-amber-400"):l>=1&&(r="/images/equipments/Star1.png",a="text-white"),t.jsxs("div",{className:"absolute top-0.5 right-0.5 flex items-center gap-0.5 bg-black/40 rounded-bl-md px-0.5 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:r,alt:"star",className:"w-2.5 h-2.5"}),t.jsx("span",{className:`font-bold text-[10px] leading-none ${a}`,children:l})]})};return n?t.jsxs("div",{className:"relative w-full aspect-square rounded-lg border-2 border-color/50 bg-tertiary/50",title:n.name,children:[t.jsx("img",{src:Ba[n.grade],alt:n.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),n.image&&t.jsx("img",{src:n.image,alt:n.name,className:"relative w-full h-full object-contain p-1.5"}),s(n.stars)]}):t.jsx("img",{src:$a[e],alt:`${e} empty slot`,className:"w-full aspect-square rounded-lg bg-tertiary/50 border-2 border-color/50"})},Fu=({item:e,title:n,comparisonItem:s})=>{var m;if(!e)return t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:n});const l=Pl[e.grade],r=h=>{if(h===0)return null;let y="",b="";return h>=10?(y="/images/equipments/Star4.png",b="prism-text-effect"):h>=7?(y="/images/equipments/Star3.png",b="text-purple-400"):h>=4?(y="/images/equipments/Star2.png",b="text-amber-400"):h>=1&&(y="/images/equipments/Star1.png",b="text-white"),t.jsxs("div",{className:"absolute top-0.5 right-0.5 flex items-center gap-0.5 bg-black/40 rounded-bl-md px-0.5 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:y,alt:"star",className:"w-2.5 h-2.5"}),t.jsx("span",{className:`font-bold text-[10px] leading-none ${b}`,children:h})]})},a=En[e.grade],i=h=>!h||!h.options?[]:[...h.options.main?[h.options.main]:[],...h.options.combatSubs||[],...h.options.specialSubs||[],...h.options.mythicSubs||[]].filter(Boolean),o=(h,y)=>{if(!h||!h.options)return 0;const j=i(h).find(g=>g.type===y);return j?j.value:0},c=i(e),d=i(s),u=new Map;c.forEach(h=>{u.set(h.type,{current:h})}),d.forEach(h=>{const y=u.get(h.type);y?y.comparison=h:u.set(h.type,{comparison:h})});const p=Array.from(u.keys()).sort();return t.jsxs("div",{className:"flex flex-col h-full text-xs",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:l.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),r(e.stars)]}),t.jsxs("div",{className:"flex-grow text-right ml-2",children:[t.jsx("div",{className:"flex items-baseline justify-end gap-0.5",children:t.jsx("h3",{className:`text-lg font-bold ${l.color}`,children:e.name})}),t.jsxs("p",{className:"text-gray-400 text-xs",children:["[",l.name,"]"]}),t.jsxs("p",{className:"text-[10px] text-gray-500",children:[" (: ",a,")"]}),((m=e.options)==null?void 0:m.main)&&t.jsxs("p",{className:"font-semibold text-yellow-300 text-xs flex justify-between items-center",children:[t.jsxs("span",{children:[e.options.main.display,e.options.main.range&&` [${e.options.main.range[0]}~${e.options.main.range[1]}]`]}),s&&e.options.main.type&&(()=>{const h=o(s,e.options.main.type),y=e.options.main.value-h,b=y>0?` (+${y})`:y<0?` (${y})`:"",j=y>0?"text-green-400":y<0?"text-red-400":"";return y!==0&&t.jsx("span",{className:`font-bold ${j} text-right`,children:b})})()]})]})]}),t.jsx("div",{className:"w-full text-xs text-left space-y-1 bg-gray-900/50 p-2 rounded-lg flex-grow overflow-y-auto",children:p.map(h=>{var j,g;const{current:y,comparison:b}=u.get(h);if(((g=(j=e.options)==null?void 0:j.main)==null?void 0:g.type)===h)return null;if(y&&b){const x=y.value-b.value,v=x>0?` (+${x})`:x<0?` (${x})`:"",w=x>0?"text-green-400":x<0?"text-red-400":"";let k="text-blue-300";return y.type in Fe&&(k="text-green-300"),y.type in ct&&(k="text-red-400"),t.jsxs("p",{className:`${k} flex justify-between items-center`,children:[t.jsx("span",{children:y.display}),x!==0&&t.jsx("span",{className:`font-bold ${w} text-right`,children:v})]},h)}else if(y&&!b){let x="text-green-400";return y.type in Fe&&(x="text-green-300"),y.type in ct&&(x="text-red-400"),t.jsxs("p",{className:`${x} flex justify-between items-center`,children:[t.jsx("span",{children:y.display})," ",t.jsx("span",{className:"font-bold text-right",children:"(New)"})]},h)}else if(!y&&b){let x="text-red-400";return b.type in Fe&&(x="text-green-300"),b.type in ct&&(x="text-red-400"),t.jsx("p",{className:`${x} line-through flex justify-between items-center`,children:t.jsx("span",{children:b.display})},h)}return null})})]})},ov=["fan","board","top","bottom","bowl","stones"],cv=({currentUser:e,onClose:n,onAction:s,onStartEnhance:l,enhancementAnimationTarget:r,onAnimationComplete:a,isTopmost:i})=>{const{presets:o,handlers:c}=De(),{inventorySlots:d={equipment:30,consumable:10,material:10}}=e,[u,p]=f.useState(null),[m,h]=f.useState("all"),[y,b]=f.useState("createdAt"),[j,g]=f.useState(0),[x,v]=f.useState(!1),[w,k]=f.useState(""),[P,S]=f.useState(!1),[E,_]=f.useState(null),C=F=>{g(F);const X=o[F];X&&c.applyPreset(X)},I=f.useMemo(()=>u&&e.inventory.find(F=>F.id===u)||null,[u,e.inventory]),R=f.useMemo(()=>m==="all"?0:rv(d[m]),[m,d]),{coreStatBonuses:A}=f.useMemo(()=>vx(e),[e]),O=f.useMemo(()=>{if(!I||I.type!=="material")return[];const F={normal:[],uncommon:[],rare:[],epic:[],legendary:[],mythic:[]};for(const ee in ha)ha[ee].forEach((J,G)=>{J.forEach(K=>{K.name===I.name&&(F[ee]||(F[ee]=[]),F[ee].push(G+1))})});const X=[];for(const ee in F){const xe=F[ee].sort((J,G)=>J-G);xe.length>0&&X.push(`${Pl[ee].name}   : +${xe.join("/+")}`)}return X},[I]),L=()=>{m!=="all"&&window.confirm(` ${R}  ${m}  ${Sc} ?`)&&s({type:"EXPAND_INVENTORY",payload:{category:m}})},Q=()=>{k(o[j].name),v(!0)},D=()=>{const F={...o[j],name:w,equipment:e.equipment};s({type:"SAVE_PRESET",payload:{preset:F,index:j}}),v(!1),alert(" .")},$=F=>{const X=e.inventory.find(ee=>ee.id===F);if(X){if(!X.isEquipped){const ee=En[X.grade],xe=e.strategyLevel+e.playfulLevel;if(xe<ee){alert(`   . (: ${ee}, : ${xe})`);return}}s({type:"TOGGLE_EQUIP_ITEM",payload:{itemId:F}})}},q=f.useMemo(()=>{let F=[...e.inventory];return m!=="all"&&(F=F.filter(X=>X.type===m)),m==="material"&&console.log("Filtered materials:",F),F.sort((X,ee)=>{if(y==="createdAt")return ee.createdAt-X.createdAt;if(y==="grade"){const xe=Uu[X.grade],J=Uu[ee.grade];return xe!==J?J-xe:ee.stars-X.stars}if(y==="type"){const xe={equipment:1,consumable:2,material:3};return xe[X.type]-xe[ee.type]}return 0}),F},[e.inventory,m,y]),z=f.useMemo(()=>{const F=d||{};return m==="all"?(F.equipment||ms)+(F.consumable||ms)+(F.material||ms):F[m]||ms},[d,m]),W=f.useMemo(()=>{let F=y0;return m==="consumable"?F=b0:m==="material"&&(F=v0),F},[m]),H=f.useMemo(()=>m==="all"?!1:d[m]<W,[m,d,W]),ne=f.useCallback(F=>o.some(X=>Object.values(X.equipment).includes(F)),[o]),re=f.useCallback(F=>{const X=e.equipment[F];if(X)return e.inventory.find(ee=>ee.id===X)},[e.equipment,e.inventory]),ce=f.useMemo(()=>!I||!I.slot?null:re(I.slot),[I,re]),ve=f.useMemo(()=>{if(!I||I.type!=="equipment")return!1;const F=En[I.grade];return e.strategyLevel+e.playfulLevel>=F},[I,e.strategyLevel,e.playfulLevel]);return t.jsxs(be,{title:"",onClose:n,windowId:"inventory",isTopmost:i,children:[t.jsxs("div",{className:"flex flex-col h-full w-full max-w-[900px]",children:[t.jsxs("div",{className:"h-96 bg-gray-800 p-4 mb-2 rounded-md shadow-inner flex",children:[t.jsxs("div",{className:"w-1/3 pr-4 border-r border-gray-700",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:ov.map(F=>t.jsx("div",{className:"w-full",children:t.jsx(iv,{slot:F,item:re(F)})},F))}),t.jsxs("div",{className:"mt-4",children:[t.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mb-2",children:Object.values(N).map(F=>{var J;const X=(e.baseStats[F]||0)+(((J=e.spentStatPoints)==null?void 0:J[F])||0),ee=Math.floor(X*(A[F].percent/100))+A[F].flat,xe=X+ee;return t.jsxs("div",{className:"bg-tertiary/40 p-1 rounded-md flex items-center justify-between text-xs",children:[t.jsx("span",{className:"font-semibold text-secondary whitespace-nowrap",children:F}),t.jsxs("span",{className:"font-mono font-bold whitespace-nowrap",title:`: ${X}, : ${ee}`,children:[xe,ee>0&&t.jsxs("span",{className:"text-green-400 text-xs ml-0.5",children:["(+",ee,")"]})]})]},F)})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("select",{value:j,onChange:F=>C(Number(F.target.value)),className:"bg-secondary border border-color text-xs rounded-md p-1 focus:ring-accent focus:border-accent flex-grow",children:o.map((F,X)=>t.jsx("option",{value:X,children:F.name},X))}),t.jsx(U,{onClick:Q,colorScheme:"blue",className:"!text-xs !py-1",children:""})]})]})]}),I&&I.type==="equipment"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col w-1/3 h-full bg-panel-secondary rounded-lg p-3 relative overflow-hidden ml-4 border-r border-gray-700",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:"  "}),ce?t.jsx(Fu,{item:ce,title:"  ",comparisonItem:I}):t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:"  "})]}),t.jsxs("div",{className:"flex flex-col w-1/3 h-full bg-panel-secondary rounded-lg p-3 relative overflow-hidden ml-4",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:" "}),t.jsx(Fu,{item:I,title:"  ",comparisonItem:ce}),t.jsxs("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center gap-2 px-4",children:[I.id===(ce==null?void 0:ce.id)?t.jsx(U,{onClick:()=>$(I.id),colorScheme:"red",className:"w-full !text-xs !py-1",children:""}):t.jsx(U,{onClick:()=>$(I.id),colorScheme:"green",className:"w-full !text-xs !py-1",disabled:!ve,children:""}),t.jsx(U,{onClick:()=>l(I),disabled:I.stars>=10,colorScheme:"yellow",className:"w-full !text-xs !py-1",children:I.stars>=10?" ":""}),t.jsx(U,{onClick:()=>s({type:"SELL_ITEM",payload:{itemId:I.id,quantity:1}}),colorScheme:"red",className:"w-full !text-xs !py-1",children:""})]})]})]}):t.jsx("div",{className:"flex flex-col w-2/3 h-full bg-panel-secondary rounded-lg p-3 relative overflow-hidden ml-4",children:I?I.type==="consumable"||I.type==="material"?t.jsxs(t.Fragment,{children:[t.jsxs("h3",{className:"text-lg font-bold text-on-panel mb-2",children:[" ",I.type==="consumable"?"":""]}),t.jsxs("div",{className:"flex flex-col h-full text-xs",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:Ba[I.grade],alt:I.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),I.image&&t.jsx("img",{src:I.image,alt:I.name,className:"relative w-full h-full object-contain p-1"})]}),t.jsxs("div",{className:"flex-grow text-right ml-2",children:[t.jsx("h3",{className:`text-lg font-bold ${Pl[I.grade].color}`,children:I.name}),t.jsxs("p",{className:"text-gray-400 text-xs",children:["[",Pl[I.grade].name,"]"]}),t.jsx("p",{className:"text-gray-300 text-xs mt-1",children:I.description}),t.jsxs("p",{className:"text-gray-300 text-xs mt-1",children:[" : ",I.quantity]})]})]}),I.type==="material"&&t.jsxs("div",{className:"mt-2 p-2 bg-gray-800/50 rounded-lg flex-grow",style:{maxHeight:"4em"},children:[" ",t.jsx("p",{className:"font-semibold text-secondary mb-1",children:"  :"}),O.length>0?O.slice(0,2).map((F,X)=>t.jsx("p",{className:"text-gray-300 text-xs",children:F},X)):t.jsx("p",{className:"text-gray-300 text-xs",children:"       ."}),O.length>2&&t.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"..."})]}),"                                        "]}),t.jsxs("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center gap-2 px-4",children:[I.type==="consumable"&&t.jsxs(t.Fragment,{children:[t.jsx(U,{onClick:()=>s({type:"USE_ITEM",payload:{itemId:I.id}}),colorScheme:"blue",className:"w-full !text-xs !py-1",children:""}),I.quantity&&I.quantity>1&&t.jsx(U,{onClick:()=>{_(I),S(!0)},colorScheme:"purple",className:"w-full !text-xs !py-1",children:" "})]}),t.jsx(U,{onClick:()=>s({type:"SELL_ITEM",payload:{itemId:I.id}}),colorScheme:"red",className:"w-full !text-xs !py-1",children:""})]})]}):t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:"  "}):t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:" "})})]}),t.jsxs("div",{className:"flex-grow flex-shrink-0 bg-gray-900 p-4 rounded-b-md overflow-y-auto",children:[t.jsx("div",{className:"flex-shrink-0 p-2 bg-gray-900/50 rounded-md mb-2",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(U,{onClick:()=>h("all"),colorScheme:m==="all"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""}),t.jsx(U,{onClick:()=>h("equipment"),colorScheme:m==="equipment"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""}),t.jsx(U,{onClick:()=>h("consumable"),colorScheme:m==="consumable"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""}),t.jsx(U,{onClick:()=>h("material"),colorScheme:m==="material"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-sm",children:":"}),t.jsxs("select",{onChange:F=>b(F.target.value),value:y,className:"bg-gray-700 text-white text-sm rounded-md p-1",children:[t.jsx("option",{value:"createdAt",children:""}),t.jsx("option",{value:"grade",children:""}),t.jsx("option",{value:"type",children:""})]}),t.jsx("div",{className:"text-sm text-gray-400",children:`${q.length} / ${z}`})]})]})}),t.jsx("div",{className:"overflow-y-auto pr-2",style:{height:"116px"},children:t.jsxs("div",{className:"grid grid-cols-5 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2",children:[Array.from({length:z}).map((F,X)=>{const ee=q[X];return ee?t.jsx(dv,{item:ee,onClick:()=>p(ee.id),isSelected:u===ee.id,isEquipped:ee.isEquipped||!1,enhancementStars:(r==null?void 0:r.itemId)===ee.id?r.stars:void 0,isPresetEquipped:ne(ee.id)},ee.id):t.jsx("div",{className:"w-full aspect-square rounded-lg bg-gray-800/50 border-2 border-gray-700/50"},`empty-${X}`)}),H&&t.jsx("button",{onClick:L,className:"w-full aspect-square rounded-lg bg-gray-800/50 border-2 border-gray-700/50 flex items-center justify-center text-gray-400 text-4xl hover:bg-gray-700/50 hover:border-accent transition-all duration-200",title:`  (${R} )`,children:"+"},"expand-slot")]})})]})]}),P&&E&&t.jsx(Lx,{onClose:()=>S(!1),onConfirm:F=>{s({type:"USE_ITEM",payload:{itemId:E.id,quantity:F}}),S(!1),_(null)},maxQuantity:E.quantity||1,itemName:E.name,initialQuantity:1}),x&&t.jsx(be,{title:"  ",onClose:()=>v(!1),windowId:"renamePreset",isTopmost:!0,children:t.jsxs("div",{className:"p-4 flex flex-col items-center",children:[t.jsx("p",{className:"mb-4 text-on-panel",children:"   :"}),t.jsx("input",{type:"text",value:w,onChange:F=>k(F.target.value),className:"bg-secondary border border-color text-on-panel text-sm rounded-md p-2 mb-4 w-full max-w-xs",maxLength:20}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(U,{onClick:D,colorScheme:"blue",children:""}),t.jsx(U,{onClick:()=>v(!1),colorScheme:"gray",children:""})]})]})})]})},dv=({item:e,onClick:n,isSelected:s,isEquipped:l,enhancementStars:r,isPresetEquipped:a})=>{const i=av(r||e.stars||0);return t.jsxs("div",{onClick:n,className:`relative w-full aspect-square rounded-lg cursor-pointer transition-all duration-200 ${s?"ring-2 ring-accent":"ring-1 ring-transparent"} hover:ring-2 hover:ring-accent/70`,title:e.name,children:[t.jsx("img",{src:Ba[e.grade],alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1.5"}),l&&t.jsx("div",{className:"absolute top-0.5 left-0.5 w-4 h-4 bg-green-500 text-white text-xs flex items-center justify-center rounded-full border-2 border-gray-800",children:"E"}),!l&&a&&t.jsx("div",{className:"absolute top-0.5 left-0.5 w-4 h-4 bg-blue-500 text-white text-xs flex items-center justify-center rounded-full border-2 border-gray-800",children:"P"}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 text-center text-xs font-bold text-white bg-black/50 py-0.5",children:t.jsx("span",{className:i.colorClass,children:i.text})})]})},uv=e=>{const n=Math.max(0,(e-Date.now())/1e3);if(n===0)return"";const s=Math.floor(n/(24*3600)),l=Math.floor(n%(24*3600)/3600),r=Math.floor(n%3600/60);return s>0?`${s} ${l}`:l>0?`${l} ${r}`:`${r}`},mv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{var b,j,g,x;const{mail:r}=e,[a,i]=f.useState(r.length>0?r[0]:null),[o,c]=f.useState(null);f.useEffect(()=>{if(a){const v=r.find(w=>w.id===a.id);v?JSON.stringify(v)!==JSON.stringify(a)&&i(v):i(r.length>0?r[0]:null)}else r.length>0&&i(r[0])},[r,a]),f.useEffect(()=>{a&&!a.isRead&&s({type:"MARK_MAIL_AS_READ",payload:{mailId:a.id}})},[a,s]),f.useEffect(()=>{if(a!=null&&a.expiresAt){const v=()=>{c(uv(a.expiresAt))};v();const w=setInterval(v,6e4);return()=>clearInterval(w)}else c(null)},[a]);const d=()=>{a&&a.attachments&&!a.attachmentsClaimed&&(Pe.claimReward(),s({type:"CLAIM_MAIL_ATTACHMENTS",payload:{mailId:a.id}}))},u=()=>{if(a){const v=r.findIndex(w=>w.id===a.id)-1;s({type:"DELETE_MAIL",payload:{mailId:a.id}}),i(r.length>1?r[Math.max(0,v)]:null)}},p=r.some(v=>v.attachments&&!v.attachmentsClaimed),m=r.some(v=>v.attachmentsClaimed),h=()=>{Pe.claimReward(),s({type:"CLAIM_ALL_MAIL_ATTACHMENTS"})},y=()=>{if(window.confirm("    ?")){s({type:"DELETE_ALL_CLAIMED_MAIL"});const v=r.filter(w=>!w.attachmentsClaimed);i(v.length>0?v[0]:null)}};return t.jsx(be,{title:"",onClose:n,windowId:"mailbox",initialWidth:800,isTopmost:l,children:t.jsxs("div",{className:"flex gap-6 h-[65vh]",children:[t.jsxs("div",{className:"w-1/3 bg-gray-900/50 rounded-lg p-3 flex flex-col",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-2 flex-shrink-0",children:["  (",r.length,")"]}),t.jsxs("div",{className:"flex flex-col gap-2 mb-2 flex-shrink-0",children:[t.jsx(U,{onClick:h,disabled:!p,colorScheme:"green",className:"!text-sm !py-2",children:" "}),t.jsx(U,{onClick:y,disabled:!m,colorScheme:"red",className:"!text-sm !py-2",children:"   "})]}),t.jsx("ul",{className:"space-y-1 overflow-y-auto flex-grow pr-2",children:r.map(v=>t.jsx("li",{children:t.jsxs("button",{onClick:()=>i(v),className:`w-full text-left p-2 rounded-md transition-colors ${(a==null?void 0:a.id)===v.id?"bg-blue-600":"hover:bg-gray-700/50"}`,children:[t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[t.jsxs("span",{children:["From: ",v.from]}),!v.isRead&&t.jsx("span",{className:"text-yellow-400 font-bold",children:" New"})]}),t.jsx("p",{className:"font-semibold truncate",children:v.title})]})},v.id))})]}),t.jsx("div",{className:"w-2/3 flex flex-col",children:a?t.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4 flex flex-col h-full",children:[t.jsxs("div",{className:"flex-grow flex flex-col mb-4",children:[t.jsx("h2",{className:"text-xl font-bold mb-2 pb-2 border-b border-gray-700",children:a.title}),t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400 mb-4",children:[t.jsxs("span",{children:[" : ",a.from]}),o&&t.jsxs("span",{children:[" : ",t.jsx("span",{className:"text-yellow-400 font-semibold",children:o})]})]}),t.jsx("div",{className:"text-sm text-gray-300 flex-grow bg-gray-800/50 p-3 rounded-md overflow-y-auto",children:a.message})]}),t.jsxs("div",{className:"flex-shrink-0 pt-4 border-t border-gray-700",children:[a.attachments&&t.jsxs("div",{className:"bg-gray-800 p-3 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:" "}),a.attachmentsClaimed?t.jsx("p",{className:"text-gray-400 text-center",children:"[ ]"}):t.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm",children:[(((b=a.attachments)==null?void 0:b.actionPoints)??0)>0&&t.jsxs("span",{children:[" ",a.attachments.actionPoints.toLocaleString()," "]}),(((j=a.attachments)==null?void 0:j.gold)??0)>0&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4"})," ",a.attachments.gold.toLocaleString()," "]}),(((g=a.attachments)==null?void 0:g.diamonds)??0)>0&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",a.attachments.diamonds.toLocaleString()," "]}),(x=a.attachments.items)==null?void 0:x.map((v,w)=>{const k=v;return t.jsxs("span",{className:"flex items-center gap-1",children:[k.image&&t.jsx("img",{src:k.image,alt:k.name,className:"w-4 h-4 object-contain"}),k.name," ",k.quantity&&k.quantity>1?`x${k.quantity}`:""]},w)})]})]}),t.jsxs("div",{className:"flex justify-between items-center gap-3",children:[t.jsx(U,{onClick:u,colorScheme:"red",children:""}),t.jsx(U,{onClick:d,colorScheme:"green",disabled:!a.attachments||a.attachmentsClaimed,children:a.attachmentsClaimed?" ":" "})]})]})]}):t.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900/50 rounded-lg",children:t.jsx("p",{className:"text-gray-400",children:"  ."})})})]})})},fv=({quest:e,onClaim:n})=>{const s=e.progress>=e.target,l=Math.min(e.progress/e.target*100,100),r=()=>{s&&!e.isClaimed&&(Pe.claimReward(),n(e.id))};return t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-md flex items-center justify-center text-gray-500 text-3xl flex-shrink-0",children:""}),t.jsxs("div",{className:"flex-grow min-w-0",children:[t.jsx("h4",{className:"font-bold truncate",children:e.title}),t.jsx("p",{className:"text-xs text-gray-400 mb-1 truncate",children:e.description}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:t.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${l}%`}})}),t.jsxs("p",{className:"text-xs text-right text-gray-300 mt-1",children:[e.progress," / ",e.target]})]}),t.jsxs("div",{className:"w-28 text-center flex-shrink-0 flex flex-col items-center gap-1 relative",children:[t.jsx(U,{onClick:r,disabled:!s||e.isClaimed,colorScheme:s&&!e.isClaimed?"green":"gray",className:"w-full !text-sm !py-2",children:e.isClaimed?"":s?" ":" "}),t.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs flex-wrap",children:[t.jsxs("span",{className:"text-yellow-300 font-semibold flex items-center gap-1",children:[" +",e.activityPoints]}),e.reward.gold&&t.jsxs("span",{className:"text-yellow-300 font-semibold flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-3 h-3"})," +",e.reward.gold]})]})]})]})},Ii=({title:e,questData:n,thresholds:s,rewards:l,questType:r,onClaim:a})=>{if(!n)return null;const{activityProgress:i,claimedMilestones:o}=n,c=s[s.length-1],d=u=>{if(!u.items||u.items.length===0)return"/images/Box/box.png";const p=u.items[0],m="itemId"in p?p.itemId:p.name,h=ws.find(y=>y.name===m);return(h==null?void 0:h.image)??"/images/Box/box.png"};return t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold text-center mb-2",children:e}),t.jsx("div",{className:"flex items-center gap-3 mb-3",children:t.jsxs("div",{className:"w-full bg-gray-700 rounded-full h-4 relative border border-gray-600",children:[t.jsx("div",{className:"bg-green-500 h-full rounded-full",style:{width:`${Math.min(100,i/c*100)}%`}}),t.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-white",children:[i," / ",c]})]})}),t.jsx("div",{className:"flex justify-around items-end",children:s.map((u,p)=>{if(!l[p])return null;const m=i>=u,h=o[p],y=m&&!h,b=l[p],j=d(b);return t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("button",{onClick:()=>{y&&(Pe.claimReward(),a(p,r))},disabled:!y,className:`relative w-8 h-8 transition-transform hover:scale-110 disabled:cursor-not-allowed ${y?"animate-pulse":""}`,title:h?" ":m?" ":`${u}  `,children:[t.jsx("img",{src:j,alt:` ${p+1}`,className:`w-full h-full object-contain ${!m&&!h?"filter grayscale":""}`}),h&&t.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center text-xl text-green-400",children:""})]}),t.jsx("span",{className:`text-sm font-bold mt-1 ${m?"text-yellow-300":"text-gray-500"}`,children:u})]},u)})})]})},xv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{var u,p,m;const[r,a]=f.useState("daily"),{quests:i}=e,o=h=>{s({type:"CLAIM_QUEST_REWARD",payload:{questId:h}})},c=r==="daily"?((u=i.daily)==null?void 0:u.quests)||[]:r==="weekly"?((p=i.weekly)==null?void 0:p.quests)||[]:((m=i.monthly)==null?void 0:m.quests)||[],d=()=>r==="daily"?t.jsx(Ii,{title:" ",questData:i.daily,thresholds:xx,rewards:S0,questType:"daily",onClaim:(h,y)=>s({type:"CLAIM_ACTIVITY_MILESTONE",payload:{milestoneIndex:h,questType:y}})}):r==="weekly"?t.jsx(Ii,{title:" ",questData:i.weekly,thresholds:px,rewards:C0,questType:"weekly",onClaim:(h,y)=>s({type:"CLAIM_ACTIVITY_MILESTONE",payload:{milestoneIndex:h,questType:y}})}):r==="monthly"?t.jsx(Ii,{title:" ",questData:i.monthly,thresholds:gx,rewards:I0,questType:"monthly",onClaim:(h,y)=>s({type:"CLAIM_ACTIVITY_MILESTONE",payload:{milestoneIndex:h,questType:y}})}):null;return t.jsx(be,{title:"",onClose:n,windowId:"quests",initialWidth:750,isTopmost:l,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*70)] flex flex-col",children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>a("daily"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="daily"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("weekly"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="weekly"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("monthly"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="monthly"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),r==="monthly"&&t.jsx("div",{className:"flex-shrink-0 text-center text-sm text-yellow-300 mb-4 bg-gray-900/50 p-2 rounded-md",children:t.jsx("p",{children:"   100       50%  ."})}),t.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[d(),c.length>0?t.jsx("ul",{className:"space-y-3",children:c.map(h=>t.jsx("li",{children:t.jsx(fv,{quest:h,onClaim:o})},h.id))}):t.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:t.jsx("p",{children:"   ."})})]})]})})},pv=9*60*60*1e3,Gu=(e=Date.now())=>{const n=typeof e=="number"?e:e.getTime();return new Date(n+pv)},gv=(e,n)=>{if(!e||e===0)return!0;const s=Gu(e),l=Gu(n);if(s.getUTCFullYear()!==l.getUTCFullYear())return!0;const r=s.getUTCDay(),a=s.getUTCDate()-r+(r===0?-6:1),i=new Date(s);i.setUTCDate(a),i.setUTCHours(0,0,0,0);const o=l.getUTCDay(),c=l.getUTCDate()-o+(o===0?-6:1),d=new Date(l);return d.setUTCDate(c),d.setUTCHours(0,0,0,0),i.getTime()!==d.getTime()},$x=(e,n)=>{if(!e||!n)return!1;const s=9*60*60*1e3,l=new Date(e+s),r=new Date(n+s);return l.getUTCFullYear()===r.getUTCFullYear()&&l.getUTCMonth()===r.getUTCMonth()&&l.getUTCDate()===r.getUTCDate()},hv=({currentUser:e,onBuy:n})=>{const s=Date.now(),l=$x(e.lastActionPointPurchaseDate||0,s)&&e.actionPointPurchasesToday||0,r=l<iu,a=r?_0[l]:0,i=()=>{if(!r)return;if(!(e.diamonds>=a)){alert(" .");return}n()};return t.jsxs("div",{className:"bg-gray-800/60 rounded-lg p-4 flex flex-col items-center text-center border-2 border-gray-700",children:[t.jsx("div",{className:"w-24 h-24 bg-gray-900/50 rounded-md mb-3 flex items-center justify-center text-6xl",children:""}),t.jsx("h3",{className:"text-lg font-bold text-white",children:" "}),t.jsxs("p",{className:"text-xs text-gray-400 mt-1 flex-grow h-10",children:[" ",A0,"  . (  )"]}),t.jsx("div",{className:"flex flex-col items-center justify-center gap-2 my-3 w-full",children:t.jsx(U,{onClick:i,disabled:!r,colorScheme:"green",className:"w-full",children:r?t.jsxs("span",{className:"flex items-center justify-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",a.toLocaleString()]}):"   "})}),t.jsxs("p",{className:"text-xs text-gray-400",children:["  : ",l,"/",iu]})]})},Wu=({item:e,onBuy:n,currentUser:s})=>{var v;const{name:l,description:r,price:a,image:i,dailyLimit:o,weeklyLimit:c}=e,d=!!a.gold,u=a.gold||a.diamonds||0,p=d?t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4"}):t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"}),m=Date.now(),h=(v=s.dailyShopPurchases)==null?void 0:v[e.itemId];let y=0,b=0,j="";c?(y=h&&!gv(h.date,m)?h.quantity:0,b=c,j=""):o&&(y=h&&$x(h.date,m)?h.quantity:0,b=o,j="");const g=b>0?b-y:e.type==="equipment"?100:void 0,x=()=>{n({...e,limit:g})};return t.jsxs("div",{className:"bg-gray-800/60 rounded-lg p-4 flex flex-col items-center text-center border-2 border-gray-700",children:[t.jsx("div",{className:"w-24 h-24 bg-gray-900/50 rounded-md mb-3 flex items-center justify-center",children:t.jsx("img",{src:i,alt:l,className:"w-full h-full object-contain p-2"})}),t.jsx("h3",{className:"text-lg font-bold text-white",children:l}),t.jsx("p",{className:"text-xs text-gray-400 mt-1 flex-grow h-10",children:r}),t.jsx("div",{className:"flex flex-col items-stretch justify-center gap-2 my-3 w-full",children:t.jsx(U,{onClick:x,disabled:g===0,colorScheme:"green",className:"w-full",children:t.jsxs("div",{className:"flex items-center justify-center gap-1.5 whitespace-nowrap",children:[t.jsx("span",{children:""}),t.jsxs("div",{className:"flex items-center gap-1",children:["(",p," ",u.toLocaleString(),")"]})]})})}),b>0&&t.jsxs("p",{className:"text-xs text-gray-400",children:[j,"  : ",g,"/",b]})]})},yv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{const[r,a]=f.useState("equipment"),[i,o]=f.useState(null),[c,d]=f.useState(null);f.useEffect(()=>{if(i){const y=setTimeout(()=>o(null),3e3);return()=>clearTimeout(y)}},[i]);const u=y=>{d(y)},p=(y,b)=>{const j=c;if(!j)return;const g=j.type==="equipment"?"BUY_SHOP_ITEM":"BUY_MATERIAL_BOX";s({type:g,payload:{itemId:y,quantity:b}}),o(" !  .")},m=()=>{s({type:"PURCHASE_ACTION_POINTS"}),o("  !")},h=()=>{const y=[{itemId:"equipment_box_1",name:"  I",description:"~   ",price:{gold:500},image:"/images/Box/EquipmentBox1.png",type:"equipment"},{itemId:"equipment_box_2",name:"  II",description:"~   ",price:{gold:1500},image:"/images/Box/EquipmentBox2.png",type:"equipment"},{itemId:"equipment_box_3",name:"  III",description:"~   ",price:{gold:5e3},image:"/images/Box/EquipmentBox3.png",type:"equipment"},{itemId:"equipment_box_4",name:"  IV",description:"~   ",price:{gold:1e4},image:"/images/Box/EquipmentBox4.png",type:"equipment"},{itemId:"equipment_box_5",name:"  V",description:"~   ",price:{diamonds:100},image:"/images/Box/EquipmentBox5.png",type:"equipment"},{itemId:"equipment_box_6",name:"  VI",description:"~   ",price:{diamonds:500},image:"/images/Box/EquipmentBox6.png",type:"equipment"}],b=[{itemId:"material_box_1",name:"  I",description:" ~   5 ",price:{gold:500},image:"/images/Box/ResourceBox1.png",dailyLimit:10,type:"material"},{itemId:"material_box_2",name:"  II",description:" ~   5 ",price:{gold:1e3},image:"/images/Box/ResourceBox2.png",dailyLimit:10,type:"material"},{itemId:"material_box_3",name:"  III",description:" ~   5 ",price:{gold:3e3},image:"/images/Box/ResourceBox3.png",dailyLimit:10,type:"material"},{itemId:"material_box_4",name:"  IV",description:" ~   5 ",price:{gold:5e3},image:"/images/Box/ResourceBox4.png",dailyLimit:10,type:"material"},{itemId:"material_box_5",name:"  V",description:" ~   5 ",price:{gold:1e4},image:"/images/Box/ResourceBox5.png",dailyLimit:10,type:"material"},{itemId:"material_box_6",name:"  VI",description:" ~   5 ",price:{diamonds:100},image:"/images/Box/ResourceBox6.png",dailyLimit:10,type:"material"}];switch(r){case"equipment":return t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:y.map(j=>t.jsx(Wu,{item:j,onBuy:u,currentUser:e},j.itemId))});case"materials":return t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:b.map(j=>t.jsx(Wu,{item:j,onBuy:u,currentUser:e},j.itemId))});case"misc":return t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:t.jsx(hv,{currentUser:e,onBuy:m})});case"consumables":default:return t.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:t.jsx("p",{children:"    ."})})}};return t.jsxs(t.Fragment,{children:[c&&t.jsx(Lx,{item:c,currentUser:e,onClose:()=>d(null),onConfirm:p}),t.jsx(be,{title:"",onClose:n,windowId:"shop",initialWidth:700,isTopmost:l&&!c,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*60)] flex flex-col relative",children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>a("equipment"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="equipment"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("materials"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="materials"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("consumables"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="consumables"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("misc"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="misc"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:h()}),i&&t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg animate-fade-in z-10",children:i})]})})]})},Tr=[{id:"EI",question:"  ?",options:[{text:"   .",value:"E"},{text:"    .",value:"I"}]},{id:"SN",question:"  ?",options:[{text:"    .",value:"S"},{text:"    .",value:"N"}]},{id:"TF",question:"     ?",options:[{text:"    .",value:"T"},{text:"  ,  .",value:"F"}]},{id:"JP",question:"   ?",options:[{text:"    .",value:"J"},{text:"    .",value:"P"}]}],bv={ISTJ:", , ",ISFJ:", , ",INFJ:", ,  ",INTJ:", , ",ISTP:", ,  ",ISFP:", , ",INFP:",  , ",INTP:" , , ",ESTP:", , ",ESFP:", , ",ENFP:",  , ",ENTP:", , ",ESTJ:", , ",ESFJ:", , ",ENFJ:", , ",ENTJ:", , "},Io=({onClose:e,isTopmost:n})=>{const{currentUser:s,handlers:l}=De(),[r,a]=f.useState(!1),[i,o]=f.useState(0),[c,d]=f.useState({}),[u,p]=f.useState(!1),[m,h]=f.useState(null),y=f.useMemo(()=>!!(s!=null&&s.mbti),[s]),b=()=>{a(!0),o(0),d({}),p(!1),h(null)},j=(w,k)=>{d(P=>({...P,[w]:k}))},g=()=>{if(i<Tr.length-1)o(w=>w+1);else{const w=x();h(w),p(!0),l.handleAction({type:"UPDATE_MBTI",payload:{mbti:w,isMbtiPublic:!0}}),l.handleAction({type:"CLAIM_MBTI_REWARD"}),console.log("MBTI set:",w,"100 diamonds rewarded!")}},x=()=>{let w="";return Tr.forEach(k=>{w+=c[k.id]||"?"}),w},v=Tr[i];return t.jsx(be,{title:"MBTI  ",onClose:e,windowId:"mbti-info",initialWidth:400,isTopmost:n,children:t.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2",children:[!r&&!y&&t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("p",{className:"text-lg font-bold text-white mb-2",children:"MBTI ?"}),t.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"MBTI(Myers-Briggs Type Indicator)       .             ."}),t.jsx("button",{onClick:b,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200",children:"MBTI "}),t.jsx("p",{className:"text-sm text-yellow-400 mt-2",children:"  100  !"})]}),r&&!u&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-lg font-bold text-white",children:v.question}),t.jsx("div",{className:"space-y-2",children:v.options.map(w=>t.jsx("button",{onClick:()=>j(v.id,w.value),className:`block w-full text-left p-3 rounded-md transition-colors duration-200
                                        ${c[v.id]===w.value?"bg-blue-700 text-white":"bg-gray-800 hover:bg-gray-700 text-gray-200"}`,children:w.text},w.value))}),t.jsx("div",{className:"flex justify-end mt-4",children:t.jsx("button",{onClick:g,disabled:!c[v.id],className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:i<Tr.length-1?"":""})})]}),u&&m&&t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-2xl font-bold text-yellow-300 mb-4",children:[" MBTI ",m," !"]}),t.jsx("p",{className:"text-lg text-green-400 mb-4",children:"100  !"}),t.jsx("button",{onClick:e,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200",children:""})]}),!r&&(y||u)&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-lg font-bold text-white mb-2",children:[" MBTI: ",s==null?void 0:s.mbti]}),t.jsx("div",{className:"text-center mb-4",children:t.jsx("button",{onClick:b,className:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200",children:"MBTI  "})}),t.jsx("ul",{className:"space-y-2 mt-4",children:Object.entries(bv).map(([w,k])=>t.jsxs("li",{className:"flex items-center gap-4 bg-gray-900/50 p-2 rounded-md",children:[t.jsx("span",{className:"font-bold text-lg text-yellow-300 w-16",children:w}),t.jsx("span",{className:"text-sm text-gray-300",children:k})]},w))})]})]})})},Hu=({level:e,currentXp:n,label:s,colorClass:l})=>{const r=1e3+(e-1)*200,a=Math.min(n/r*100,100);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-1 text-sm",children:[t.jsxs("span",{className:"font-semibold",children:[s," ",t.jsxs("span",{className:"text-lg font-bold",children:["Lv.",e]})]}),t.jsxs("span",{className:"text-xs font-mono text-gray-400",children:[n," / ",r]})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4 border border-gray-900",children:t.jsx("div",{className:`${l} h-full rounded-full transition-width duration-500`,style:{width:`${a}%`}})})]})},vv={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},jv=e=>{let n="",s="";if(e>=10)n="/images/equipments/Star4.png",s="prism-text-effect";else if(e>=7)n="/images/equipments/Star3.png",s="text-purple-400";else if(e>=4)n="/images/equipments/Star2.png",s="text-amber-400";else if(e>=1)n="/images/equipments/Star1.png",s="text-white";else return t.jsx("img",{src:"/images/equipments/Star1.png",alt:"star",className:"w-4 h-4 inline-block opacity-30",title:""});return t.jsxs("span",{className:"flex items-center gap-0.5",style:{textShadow:"1px 1px 2px black, 0 0 5px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-4 h-4"}),t.jsx("span",{className:`font-bold ${s}`,children:e})]})},Ps=({slot:e,item:n,onClick:s})=>{const l=n&&s?"cursor-pointer hover:scale-105 transition-transform":"";return n?t.jsxs("div",{className:`relative w-full aspect-square rounded-lg border-2 border-gray-700/50 bg-gray-900/50 ${l}`,title:n.name,onClick:s,children:[t.jsx("img",{src:vv[n.grade],alt:n.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),t.jsx("div",{className:"absolute top-1 right-1 text-sm font-bold z-10",children:jv(n.stars)}),n.image&&t.jsx("img",{src:n.image,alt:n.name,className:"relative w-full h-full object-contain p-3"})]}):t.jsx("img",{src:$a[e],alt:`${e} empty slot`,className:"w-full aspect-square rounded-lg bg-gray-900/50 border-2 border-gray-700/50"})},Vu=({user:e,type:n})=>{const s=n==="strategic"?Qe:nt,l=e.stats||{};let r=0,a=0;const i=s.map(d=>{const u=l[d.mode];return u?(r+=u.wins,a+=u.losses,{mode:d.mode,...u}):{mode:d.mode,wins:0,losses:0,rankingScore:1200}}),o=r+a,c=o>0?Math.round(r/o*100):0;return t.jsxs("div",{className:"space-y-3 text-xs",children:[t.jsx("div",{className:"bg-gray-700/50 p-2 rounded-md text-center",children:t.jsxs("span",{className:"font-bold",children:[" : ",r," ",a," (",c,"%)"]})}),i.map(d=>{if(d.wins===0&&d.losses===0)return null;const u=d.wins+d.losses,p=u>0?Math.round(d.wins/u*100):0;return t.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-900/30 rounded",children:[t.jsx("span",{className:"font-semibold w-28",children:d.mode}),t.jsxs("span",{className:"w-24 text-center",children:[d.wins," ",d.losses," (",p,"%)"]}),t.jsxs("span",{className:"w-16 text-right font-mono text-yellow-300",children:[d.rankingScore,""]})]},d.mode)})]})},wv=({user:e,onClose:n,onViewItem:s,isTopmost:l})=>{const{inventory:r,stats:a,nickname:i,avatarId:o,borderId:c}=e,[d,u]=f.useState("strategic"),[p,m]=f.useState(!1),h=f.useMemo(()=>{var k;return(k=Ee.find(P=>P.id===o))==null?void 0:k.url},[o]),y=f.useMemo(()=>{var k;return(k=Re.find(P=>P.id===c))==null?void 0:k.url},[c]),b=f.useMemo(()=>tl.find(k=>k.tier===e.league),[e.league]),j=f.useMemo(()=>(r||[]).filter(k=>k.isEquipped),[r]),g=k=>j.find(P=>P.slot===k),x=Ix(e),v=Ec(x),w=Px(x);return t.jsxs(be,{title:`${i} `,onClose:n,windowId:`user-profile-${e.id}`,initialWidth:750,isTopmost:l,children:[p&&t.jsx(Io,{onClose:()=>m(!1),isTopmost:!0}),t.jsxs("div",{className:"flex flex-col md:flex-row gap-4 max-h-[calc(var(--vh,1vh)*70)]",children:[t.jsxs("div",{className:"w-full md:w-1/3 flex-shrink-0 flex flex-col gap-4",children:[t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:e.id,userName:i,size:80,avatarUrl:h,borderUrl:y}),t.jsx("h2",{className:"text-xl font-bold mt-2",children:i}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mt-1",children:[t.jsx("span",{children:": "}),t.jsxs("span",{className:`font-semibold ${v.color}`,children:[x," (",v.rank,")"]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mt-1",children:[t.jsx("span",{children:"MBTI:"}),t.jsxs("span",{className:"font-semibold text-gray-200 flex items-center gap-1",children:[e.mbti?e.mbti:"",!e.mbti&&t.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"})]}),e.mbti&&t.jsx("button",{onClick:()=>m(!0),className:"w-4 h-4 text-xs bg-gray-600 rounded-full text-white flex items-center justify-center hover:bg-gray-500",children:"?"})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mt-2 border border-gray-900",children:t.jsx("div",{className:`${w.colorClass} h-full rounded-full`,style:{width:`${w.percentage}%`}})})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 space-y-3",children:[t.jsx(Hu,{level:e.strategyLevel,currentXp:e.strategyXp,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-400"}),t.jsx(Hu,{level:e.playfulLevel,currentXp:e.playfulXp,label:"",colorClass:"bg-gradient-to-r from-yellow-500 to-orange-400"})]}),b&&t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex flex-col items-center text-center",children:[t.jsx("img",{src:b.icon,alt:b.name,className:"w-16 h-16"}),t.jsx("h3",{className:"font-bold text-purple-300 mt-1",children:b.name}),t.jsxs("p",{className:"text-sm text-gray-300",children:[e.tournamentScore.toLocaleString()," "]})]})]}),t.jsxs("div",{className:"w-full md:w-2/3 flex flex-col gap-4",children:[t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex-grow flex flex-col min-h-0",children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-3 flex-shrink-0",children:[t.jsx("button",{onClick:()=>u("strategic"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md transition-all ${d==="strategic"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "}),t.jsx("button",{onClick:()=>u("playful"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md transition-all ${d==="playful"?"bg-yellow-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:d==="strategic"?t.jsx(Vu,{user:e,type:"strategic"}):t.jsx(Vu,{user:e,type:"playful"})})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex-shrink-0",children:[t.jsx("h3",{className:"text-center font-semibold mb-3 text-gray-300",children:" "}),t.jsxs("div",{className:"grid grid-cols-3 gap-3 w-full max-w-xs mx-auto",children:[t.jsx(Ps,{slot:"fan",item:g("fan"),onClick:()=>g("fan")&&s(g("fan"),!1)}),t.jsx(Ps,{slot:"board",item:g("board"),onClick:()=>g("board")&&s(g("board"),!1)}),t.jsx(Ps,{slot:"top",item:g("top"),onClick:()=>g("top")&&s(g("top"),!1)}),t.jsx(Ps,{slot:"bottom",item:g("bottom"),onClick:()=>g("bottom")&&s(g("bottom"),!1)}),t.jsx(Ps,{slot:"bowl",item:g("bowl"),onClick:()=>g("bowl")&&s(g("bowl"),!1)}),t.jsx(Ps,{slot:"stones",item:g("stones"),onClick:()=>g("stones")&&s(g("stones"),!1)})]})]})]})]})]})},Nv=({onClose:e,isTopmost:n})=>{const[s,l]=f.useState("game"),r=[{id:"game",label:""},{id:"level",label:""},{id:"ranking",label:""},{id:"equipment",label:""},{id:"manner",label:""}],a=()=>{switch(s){case"game":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-blue-300",children:" "}),t.jsx("p",{className:"text-sm",children:" ,        .     .      '?'     ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-yellow-300",children:" "}),t.jsx("p",{className:"text-sm",children:" ,       .     .      '?'     ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-purple-300",children:""}),t.jsx("p",{className:"text-sm",children:"AI    .        ,      .       ."})]})]});case"level":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:" "}),t.jsx("p",{className:"text-sm",children:"/     (XP) .  100%   ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-green-300",children:" "}),t.jsx("p",{className:"text-sm",children:"       2    .   ' '   6   ,     ."})]})]});case"ranking":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:" "}),t.jsx("p",{className:"text-sm",children:"     ,    .     ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-purple-300",children:" "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1 pl-2",children:[t.jsx("li",{children:" 3   (1, 2, 3, 4)."}),t.jsxs("li",{children:["     ",t.jsx("strong",{className:"text-yellow-300",children:" 20"}),"        . ( )"]}),t.jsx("li",{children:"20       ''  ."}),t.jsx("li",{children:"  ,             ."}),t.jsx("li",{children:"      (/)   ,  20   ."})]})]})]});case"equipment":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:" "}),t.jsx("p",{className:"text-sm",children:", ,   6        .  , , , , ,   .      ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-cyan-300",children:""}),t.jsx("p",{className:"text-sm",children:"    ()  5   .      ,        ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-orange-300",children:""}),t.jsx("p",{className:"text-sm",children:"          .   ''  2    ."})]})]});case"manner":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:"  "}),t.jsx("p",{className:"text-sm",children:"      . ''  ,       ( ,   )   .       ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:"   "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-2 pl-2",children:[t.jsxs("li",{children:[t.jsx("span",{className:"text-purple-400 font-semibold",children:" (2000 ):"}),"    +20 (   )"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-blue-400 font-semibold",children:" (1600 ~ 1999):"}),"     +10%"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-cyan-400 font-semibold",children:" (1200 ~ 1599):"}),"        +10%"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-teal-400 font-semibold",children:"  (800 ~ 1199):"}),"      +10%"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-green-400 font-semibold",children:" (400 ~ 799):"}),"   +10"]}),t.jsxs("li",{className:"border-t border-gray-600 pt-2",children:[t.jsx("span",{className:"text-gray-300 font-semibold",children:" (200 ~ 399):"}),"  "]}),t.jsxs("li",{className:"border-t border-gray-600 pt-2",children:[t.jsx("span",{className:"text-yellow-400 font-semibold",children:" (100 ~ 199):"}),"        +1  "]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-orange-400 font-semibold",children:" (50 ~ 99):"}),"   50% "]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-500 font-semibold",children:"  (1 ~ 49):"}),"     (20 1)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-700 font-semibold",children:" (0):"}),"   10% "]})]})]})]});default:return null}};return t.jsx(be,{title:"",onClose:e,windowId:"info-modal",initialWidth:600,isTopmost:n,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*60)] flex flex-col",children:[t.jsx("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:r.map(i=>t.jsx("button",{onClick:()=>l(i.id),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s===i.id?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:i.label},i.id))}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 bg-gray-900/30 p-4 rounded-md",children:a()})]})})},Bx=({isOpen:e,onClose:n,result:s})=>!e||!s?null:t.jsx(be,{title:" ",onClose:n,windowId:"disassemblyResult",isTopmost:!0,children:t.jsxs("div",{className:"p-4 text-on-panel flex flex-col items-center",children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:"  !"}),s.jackpot&&t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("p",{className:"text-yellow-400 text-2xl font-bold animate-pulse",children:"!"}),t.jsx("p",{className:"text-lg text-green-400",children:"   2 !"})]}),t.jsxs("div",{className:"w-full max-h-60 overflow-y-auto bg-gray-800/50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"font-semibold text-secondary mb-2",children:" :"}),s.gained.length>0?s.gained.map((l,r)=>{const a=tn[l.name];return t.jsxs("div",{className:"flex items-center justify-between text-sm py-1 border-b border-gray-700 last:border-b-0",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[(a==null?void 0:a.image)&&t.jsx("img",{src:a.image,alt:l.name,className:"w-6 h-6"}),l.name]}),t.jsxs("span",{className:"font-mono text-primary",children:["x ",l.amount.toLocaleString()]})]},r)}):t.jsx("p",{className:"text-sm text-tertiary",children:"  ."})]}),t.jsx(U,{onClick:n,colorScheme:"blue",className:"w-full max-w-xs",children:""})]})}),kv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{const[r,a]=f.useState(!e.spentStatPoints||Object.keys(e.spentStatPoints).length===0),[i,o]=f.useState(()=>e.spentStatPoints&&Object.keys(e.spentStatPoints).length>0?e.spentStatPoints:{[N.Concentration]:0,[N.ThinkingSpeed]:0,[N.Judgment]:0,[N.Calculation]:0,[N.CombatPower]:0,[N.Stability]:0}),c=1e3,d=2,u=new Date().toDateString(),p=e.lastStatResetDate,m=e.statResetCountToday||0,h=f.useMemo(()=>!(e.gold<c||p===u&&m>=d),[e.diamonds,p,m,u]),y=(e.strategyLevel-1)*2+(e.playfulLevel-1)*2,b=e.mannerMasteryApplied?20:0,j=y+b,g=f.useMemo(()=>Object.values(i).reduce((_,C)=>_+C,0),[i]),x=f.useMemo(()=>r?j-g:0,[r,j,g]),v=(_,C)=>{const I=Number(C)||0;o(R=>{const A=Object.entries(R).filter(([Q])=>Q!==_).reduce((Q,[,D])=>Q+D,0),O=j-A,L=Math.max(0,Math.min(I,O));return{...R,[_]:L}})},w=()=>{if(!h){alert("    .      .");return}window.confirm(` ${c}     ? ( ${d-m} )`)&&(s({type:"RESET_STAT_POINTS"}),o({[N.Concentration]:0,[N.ThinkingSpeed]:0,[N.Judgment]:0,[N.Calculation]:0,[N.CombatPower]:0,[N.Stability]:0}),a(!0))},k=f.useMemo(()=>e.spentStatPoints?Object.values(N).some(_=>i[_]!==e.spentStatPoints[_]):g>0,[i,e.spentStatPoints,g]),P=()=>{s({type:"CONFIRM_STAT_ALLOCATION",payload:{newStatPoints:i}}),n()},S=f.useMemo(()=>{const _={};for(const C of Object.values(N))_[C]=(e.baseStats[C]||0)+(i[C]||0);return _},[e.baseStats,i]),E=f.useMemo(()=>[{stats:S,color:"#60a5fa",fill:"rgba(59, 130, 246, 0.4)"}],[S]);return t.jsx(be,{title:"  ",onClose:n,windowId:"stat-allocation",initialWidth:700,isTopmost:l,children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-6 h-[calc(var(--vh,1vh)*70)]",children:[t.jsxs("div",{className:"w-full md:w-1/2 flex flex-col items-center justify-center bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-bold mb-4",children:" "}),t.jsx(_x,{datasets:E,maxStatValue:300})]}),t.jsxs("div",{className:"w-full md:w-1/2 flex flex-col",children:[t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg mb-4 text-center",children:[t.jsx("p",{className:"text-gray-300",children:"   "}),t.jsx("p",{className:"text-3xl font-bold text-green-400",children:x})]}),t.jsx("div",{className:"flex-grow space-y-2 overflow-y-auto pr-2",children:Object.values(N).map(_=>{const C=i[_]||0,I=C+x;return t.jsxs("div",{className:"bg-gray-900/40 p-2 md:p-3 rounded-md",children:[t.jsxs("div",{className:"flex justify-between items-center mb-1",children:[t.jsx("span",{className:"font-bold text-gray-200 text-sm md:text-base",children:_}),t.jsx("span",{className:"font-mono font-bold text-lg",title:`: ${e.baseStats[_]}, : ${C}`,children:S[_]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"range",min:"0",max:I,value:C,onChange:R=>v(_,R.target.value),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer",disabled:!r}),t.jsx("input",{type:"number",value:C,onChange:R=>v(_,R.target.value),className:"w-16 bg-gray-700 border border-gray-600 rounded-md p-1 text-center",disabled:!r})]}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:j0[_].description})]},_)})}),t.jsxs("div",{className:"flex justify-between mt-4 pt-4 border-t border-gray-700",children:[t.jsxs("div",{className:"flex flex-col items-start",children:[t.jsxs(U,{onClick:w,colorScheme:"red",disabled:!h,children:[" (",t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4 inline-block"}),c,")"]}),t.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[" : ",d-m,"/",d]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(U,{onClick:n,colorScheme:"gray",children:""}),t.jsx(U,{onClick:P,colorScheme:"green",disabled:!r||!k,children:""})]})]})]})]})})},Sv={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},Cv=e=>{if(e===0)return null;let n="",s="";return e>=10?(n="/images/equipments/Star4.png",s="prism-text-effect"):e>=7?(n="/images/equipments/Star3.png",s="text-purple-400"):e>=4?(n="/images/equipments/Star2.png",s="text-amber-400"):e>=1&&(n="/images/equipments/Star1.png",s="text-white"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:`font-bold text-xs leading-none ${s}`,children:e})]})},Iv=({item:e,isOwnedByCurrentUser:n,onClose:s,onStartEnhance:l,isTopmost:r})=>{var u,p,m,h;const{currentUserWithStatus:a}=De(),i=Sv[e.grade],o=En[e.grade],d=((a==null?void 0:a.strategyLevel)||0)+((a==null?void 0:a.playfulLevel)||0)>=o;return t.jsx(be,{title:"  ",onClose:s,windowId:`item-detail-${e.id}`,initialWidth:350,isTopmost:r,children:t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"relative w-24 h-24 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:i.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-2"}),Cv(e.stars)]}),t.jsxs("div",{className:"flex-grow text-right ml-4",children:[t.jsx("div",{className:"flex items-baseline justify-end gap-1",children:t.jsx("h3",{className:`text-xl font-bold ${i.color}`,children:e.name})}),t.jsxs("p",{className:"text-gray-400 text-sm",children:["[",i.name,"]"]}),t.jsxs("p",{className:`text-xs ${d?"text-gray-500":"text-red-500"}`,children:["(: ",o,")"]}),((u=e.options)==null?void 0:u.main)&&t.jsx("p",{className:"font-semibold text-yellow-300 text-sm",children:e.options.main.display})]})]}),t.jsxs("div",{className:"w-full text-sm text-left space-y-2 bg-gray-900/50 p-3 rounded-lg flex-grow overflow-y-auto",children:[((p=e.options)==null?void 0:p.combatSubs)&&e.options.combatSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.combatSubs.map((y,b)=>t.jsx("p",{className:"text-blue-300",children:y.display},b))}),((m=e.options)==null?void 0:m.specialSubs)&&e.options.specialSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.specialSubs.map((y,b)=>t.jsx("p",{className:"text-green-300",children:y.display},b))}),((h=e.options)==null?void 0:h.mythicSubs)&&e.options.mythicSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.mythicSubs.map((y,b)=>t.jsx("p",{className:"text-red-400",children:y.display},b))})]}),n&&e.type==="equipment"&&t.jsx("div",{className:"w-full mt-6 pt-4 border-t border-gray-700",children:t.jsx(U,{onClick:()=>l(e),disabled:e.stars>=10,colorScheme:"yellow",className:"w-full",children:e.stars>=10?" ":""})})]})})},Bn=({checked:e,onChange:n,label:s,disabled:l=!1})=>{const r=Mn.useId();return t.jsxs("label",{htmlFor:r,className:`flex items-center ${l?"cursor-not-allowed opacity-60":"cursor-pointer"}`,children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{id:r,type:"checkbox",className:"sr-only",checked:e,onChange:a=>!l&&n(a.target.checked),disabled:l}),t.jsx("div",{className:`block w-12 h-6 rounded-full transition-colors ${e?"bg-accent":"bg-secondary"}`}),t.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${e?"transform translate-x-6":""}`})]}),s&&t.jsx("span",{className:"ml-3 text-secondary font-medium",children:s})]})},Pi={E:{name:" (E)",general:" .       .",goStyle:"     .        ."},I:{name:" (I)",general:" ,    .         .",goStyle:"     .     ,    ."},S:{name:" (S)",general:" ,    .     .",goStyle:"     .    ,   ."},N:{name:" (N)",general:"  .   ,     .",goStyle:"    .  ,       ."},T:{name:" (T)",general:" ,     .    .",goStyle:"       .      ."},F:{name:" (F)",general:"     .     ,   .",goStyle:"      .       ."},J:{name:" (J)",general:" ,     .       .",goStyle:"      .      ,    ."},P:{name:" (P)",general:"   ,    .     .",goStyle:"       .       ."}},Pv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{const{handlers:r}=De(),[a,i]=f.useState("border"),[o,c]=f.useState(e.avatarId),[d,u]=f.useState(e.borderId),[p,m]=f.useState(e.nickname),[h,y]=f.useState(e.isMbtiPublic||!1),b=C=>C&&C.length===4?{ei:C[0],sn:C[1],tf:C[2],jp:C[3]}:{ei:"E",sn:"S",tf:"T",jp:"J"},[j,g]=f.useState(b(e.mbti)),x=150,v=e.diamonds>=x,w=f.useMemo(()=>{var C;return(C=Ee.find(I=>I.id===e.avatarId))==null?void 0:C.url},[e.avatarId]),k=()=>{switch(a){case"avatar":o!==e.avatarId&&s({type:"UPDATE_AVATAR",payload:{avatarId:o}});break;case"border":d!==e.borderId&&s({type:"UPDATE_BORDER",payload:{borderId:d}});break;case"nickname":if(p!==e.nickname){if(Yl(p)){alert("    .");return}window.confirm(` ${x}   '${p}'() ?`)&&s({type:"CHANGE_NICKNAME",payload:{newNickname:p}})}break;case"mbti":const C=`${j.ei}${j.sn}${j.tf}${j.jp}`;s({type:"UPDATE_MBTI",payload:{mbti:C,isMbtiPublic:!0}});break}},P=f.useMemo(()=>{switch(a){case"avatar":return o===e.avatarId;case"border":return d===e.borderId;case"nickname":return p===e.nickname||!v||p.trim().length<2||p.trim().length>12;case"mbti":return`${j.ei}${j.sn}${j.tf}${j.jp}`===(e.mbti||"");default:return!0}},[a,o,d,p,e,v,j]),S=f.useMemo(()=>{const C=R=>cu.some(A=>A.id===R.id),I={:[],:[],:[],:[]};return Re.forEach(R=>{R.unlockTier?I..push(R):R.requiredLevelSum?I..push(R):C(R)?I..push(R):I..push(R)}),I},[]),E=()=>{switch(a){case"avatar":return t.jsx("div",{className:"flex flex-wrap justify-center gap-4",children:Ee.map(C=>{const I=C.type==="any"||C.type==="strategy"&&e.strategyLevel>=C.requiredLevel||C.type==="playful"&&e.playfulLevel>=C.requiredLevel;return t.jsxs("div",{onClick:()=>I&&c(C.id),className:`relative p-2 rounded-lg border-2 ${o===C.id?"border-blue-500 ring-2 ring-blue-500":"border-gray-700"} ${I?"cursor-pointer hover:bg-gray-700/50":"opacity-50 cursor-not-allowed"}`,children:[t.jsx(Ce,{userId:"preview",userName:C.name,avatarUrl:C.url,size:80}),t.jsx("p",{className:"text-xs text-center mt-1",children:C.name}),!I&&t.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center text-center text-xs p-1 rounded-full",children:[t.jsx("span",{className:"font-bold",children:""}),t.jsxs("span",{children:[C.type==="strategy"?"":""," Lv.",C.requiredLevel]})]})]},C.id)})});case"border":{const{ownedBorders:C,strategyLevel:I,playfulLevel:R,previousSeasonTier:A}=e,O=I+R,L=At.map(Q=>Q.name);return t.jsx("div",{className:"space-y-6",children:Object.keys(S).map(Q=>{const D=S[Q];return D.length===0?null:t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-yellow-300 mb-3 border-b border-gray-700 pb-2",children:Q}),t.jsx("div",{className:"flex flex-wrap justify-start gap-4",children:D.map($=>{var xe,J;const q=(C==null?void 0:C.includes($.id))||$.id==="default"||$.id==="simple_black";let z=!1,W=$.description;if($.unlockTier){if(W=`  ${$.unlockTier}  `,A){const G=L.indexOf($.unlockTier),K=L.indexOf(A);G!==-1&&K!==-1&&K<=G&&(z=!0)}}else $.requiredLevelSum&&(W=`  ${$.requiredLevelSum} `,O>=$.requiredLevelSum&&(z=!0));const H=q||z,ne=cu.find(G=>G.id===$.id),re=ne&&!q,ce=()=>{var G;if(H)u($.id);else if(re){const K=ne.price.gold?`${ne.price.gold.toLocaleString()} `:`${(G=ne.price.diamonds)==null?void 0:G.toLocaleString()} `;window.confirm(`'${$.name}'  ${K} ?`)&&s({type:"BUY_BORDER",payload:{borderId:$.id}})}},F=H||re?"cursor-pointer":"cursor-not-allowed",X=!H&&!re?"opacity-50":"",ee=H?$.description:re?` : ${$.description}`:W;return t.jsxs("div",{onClick:ce,className:`relative flex flex-col items-center gap-1 p-1 rounded-lg ${F}`,title:ee,children:[t.jsxs("div",{className:`p-1 rounded-full relative ${d===$.id?"border-2 border-blue-500 ring-2 ring-blue-500":"border-2 border-transparent"}`,children:[t.jsx("div",{className:X,children:t.jsx(Ce,{userId:"preview",userName:$.name,avatarUrl:w,borderUrl:$.url,size:80})}),!H&&!re&&t.jsx("div",{className:"absolute top-1 right-1 bg-gray-900/80 rounded-full p-1",children:t.jsx("span",{className:"text-base",role:"img","aria-label":"Locked",children:""})}),re&&t.jsxs("div",{className:"absolute bottom-0 inset-x-0 bg-black/70 rounded-b-md text-xs py-0.5 text-center flex items-center justify-center gap-1",children:[ne.price.gold?t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-3 h-3"}):t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-3 h-3"}),t.jsx("span",{children:((xe=ne.price.gold)==null?void 0:xe.toLocaleString())||((J=ne.price.diamonds)==null?void 0:J.toLocaleString())})]})]}),t.jsx("p",{className:"text-xs text-center truncate w-24",children:$.name}),!H&&!re&&t.jsx("p",{className:"text-[10px] text-center text-red-400",children:$.requiredLevelSum?` ${$.requiredLevelSum}`:$.unlockTier?`${$.unlockTier} `:""})]},$.id)})})]},Q)})})}case"nickname":return t.jsxs("div",{className:"space-y-4 max-w-sm mx-auto p-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"nickname-input",className:"block text-sm font-medium text-gray-300 mb-1",children:"  (2-12)"}),t.jsx("input",{id:"nickname-input",type:"text",value:p,onChange:C=>m(C.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-md p-3 focus:ring-blue-500 focus:border-blue-500",maxLength:12,minLength:2})]}),t.jsxs("div",{className:"text-sm p-3 rounded-md bg-gray-900/50",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"}),t.jsxs("span",{className:`font-bold flex items-center gap-1 ${v?"text-cyan-300":"text-red-400"}`,children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",x]})]}),t.jsxs("div",{className:"flex justify-between mt-1",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",e.diamonds.toLocaleString()]})]})]})]});case"mbti":{const C=({title:R,options:A,selected:O,onSelect:L})=>t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg flex-1",children:[t.jsx("h4",{className:"font-semibold text-lg text-center mb-2",children:R}),t.jsx("div",{className:"flex justify-center gap-2 mb-3",children:A.map(Q=>t.jsx(U,{onClick:()=>L(Q),colorScheme:O===Q?"blue":"gray",className:"w-24",children:Pi[Q].name},Q))}),t.jsxs("div",{className:"bg-gray-800/60 p-2 rounded-md text-xs min-h-[120px]",children:[t.jsx("h5",{className:"font-bold text-yellow-300",children:" "}),t.jsx("p",{className:"text-gray-300",children:Pi[O].general}),t.jsx("h5",{className:"font-bold text-cyan-300 mt-2",children:" "}),t.jsx("p",{className:"text-gray-300",children:Pi[O].goStyle})]})]}),I=`${j.ei}${j.sn}${j.tf}${j.jp}`;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg text-center",children:[t.jsx("h3",{className:"text-lg font-bold text-yellow-300",children:"MBTI?"}),t.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"MBTI 4    16       .      !"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(C,{title:" ",options:["E","I"],selected:j.ei,onSelect:R=>g(A=>({...A,ei:R}))}),t.jsx(C,{title:" ",options:["S","N"],selected:j.sn,onSelect:R=>g(A=>({...A,sn:R}))}),t.jsx(C,{title:" ",options:["T","F"],selected:j.tf,onSelect:R=>g(A=>({...A,tf:R}))}),t.jsx(C,{title:" ",options:["J","P"],selected:j.jp,onSelect:R=>g(A=>({...A,jp:R}))})]}),t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold text-lg",children:" MBTI:"}),t.jsx("span",{className:"font-bold text-2xl text-green-400",children:I})]}),t.jsx(Bn,{label:" MBTI  ",checked:h,onChange:y})]})]})}default:return null}},_=[{id:"avatar",label:""},{id:"border",label:""},{id:"nickname",label:""},{id:"mbti",label:"MBTI"}];return t.jsx(be,{title:"",onClose:n,windowId:"profile-edit",initialWidth:750,isTopmost:l,children:t.jsxs("div",{className:"flex flex-col h-[70vh]",children:[t.jsx("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:_.map(C=>t.jsxs("button",{onClick:()=>i(C.id),className:`relative flex-1 py-2 text-sm font-semibold rounded-md transition-all ${a===C.id?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:[C.label,C.id==="mbti"&&!e.mbti&&t.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]},C.id))}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:E()}),t.jsxs("div",{className:"flex justify-end gap-4 mt-4 pt-4 border-t border-gray-700 flex-shrink-0",children:[t.jsx(U,{onClick:n,colorScheme:"gray",children:""}),t.jsx(U,{onClick:k,colorScheme:"green",disabled:P,children:a==="nickname"&&!v?" ":""})]})]})})},Ev={normal:{bg:"bg-gray-700",text:"text-white",shadow:"shadow-gray-900/50",name:"",background:"/images/equipments/normalbgi.png"},uncommon:{bg:"bg-green-700",text:"text-green-200",shadow:"shadow-green-500/50",name:"",background:"/images/equipments/uncommonbgi.png"},rare:{bg:"bg-blue-700",text:"text-blue-200",shadow:"shadow-blue-500/50",name:"",background:"/images/equipments/rarebgi.png"},epic:{bg:"bg-purple-700",text:"text-purple-200",shadow:"shadow-purple-500/50",name:"",background:"/images/equipments/epicbgi.png"},legendary:{bg:"bg-red-800",text:"text-red-200",shadow:"shadow-red-500/50",name:"",background:"/images/equipments/legendarybgi.png"},mythic:{bg:"bg-orange-700",text:"text-orange-200",shadow:"shadow-orange-500/50",name:"",background:"/images/equipments/mythicbgi.png"}},Mv={rare:"spinning-border-rare",epic:"spinning-border-epic",legendary:"spinning-border-legendary",mythic:"spinning-border-mythic"},Tv=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-blue-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},_r=({title:e,options:n,color:s})=>n.length===0?null:t.jsxs("div",{children:[t.jsx("h5",{className:`font-semibold ${s} border-b border-gray-600 pb-1 mb-1 text-sm`,children:e}),t.jsx("ul",{className:"list-disc list-inside space-y-0.5 text-gray-300 text-xs",children:n.map((l,r)=>t.jsx("li",{children:l.display},r))})]}),_v=e=>{if(!e.options)return null;const{main:n,combatSubs:s,specialSubs:l,mythicSubs:r}=e.options;return t.jsxs("div",{className:"w-full text-xs text-left space-y-2",children:[t.jsx(_r,{title:"",options:[n],color:"text-yellow-300"}),t.jsx(_r,{title:" ",options:s,color:"text-blue-300"}),t.jsx(_r,{title:" ",options:l,color:"text-green-300"}),t.jsx(_r,{title:" ",options:r,color:"text-red-400"})]})},Av=({item:e,onClose:n,isTopmost:s})=>{var c;const l=Ev[e.grade],r=e.type==="equipment"?En[e.grade]:null,a=Tv(e.stars),i=Mv[e.grade],o=e.image==="/images/icon/Gold.png"||e.image==="/images/icon/Zem.png";return f.useEffect(()=>{["epic","legendary","mythic"].includes(e.grade)&&Pe.gachaEpicOrHigher()},[e.grade]),t.jsx(be,{title:" ",onClose:n,windowId:"item-obtained",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"p-6 rounded-lg",children:[t.jsxs("div",{className:"relative w-48 h-48 mx-auto rounded-lg mb-4 overflow-hidden",children:[i&&t.jsx("div",{className:`absolute -inset-1 rounded-lg ${i}`}),t.jsxs("div",{className:"relative w-full h-full rounded-lg flex items-center justify-center border-2 border-black/50 overflow-hidden",children:[t.jsx("img",{src:l.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-4"}),o&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-sm p-1",children:t.jsxs("span",{className:"text-white text-3xl font-bold text-center break-words",style:{textShadow:"1px 1px 2px black"},children:["+",(c=e.quantity)==null?void 0:c.toLocaleString()]})})]})]}),t.jsxs("p",{className:`font-bold text-lg ${l.text}`,children:["[",l.name,"]"]}),t.jsxs("div",{className:"flex items-baseline justify-center gap-2",children:[t.jsx("h2",{className:`text-3xl font-bold ${a.colorClass}`,children:e.name}),e.stars>0&&t.jsx("span",{className:`text-2xl font-bold ${a.colorClass}`,children:a.text})]}),r&&t.jsxs("p",{className:"text-xs text-yellow-300",children:["(  : ",r,")"]}),e.type==="equipment"&&t.jsx("div",{className:"w-full text-xs text-left space-y-2 mt-4 max-h-48 overflow-y-auto bg-black/20 p-2 rounded-md",children:_v(e)})]}),t.jsx(U,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},Rv={normal:{bg:"bg-gray-700",text:"text-white",shadow:"shadow-gray-900/50",name:"",background:"/images/equipments/normalbgi.png"},uncommon:{bg:"bg-green-700",text:"text-green-200",shadow:"shadow-green-500/50",name:"",background:"/images/equipments/uncommonbgi.png"},rare:{bg:"bg-blue-700",text:"text-blue-200",shadow:"shadow-blue-500/50",name:"",background:"/images/equipments/rarebgi.png"},epic:{bg:"bg-purple-700",text:"text-purple-200",shadow:"shadow-purple-500/50",name:"",background:"/images/equipments/epicbgi.png"},legendary:{bg:"bg-red-800",text:"text-red-200",shadow:"shadow-red-500/50",name:"",background:"/images/equipments/legendarybgi.png"},mythic:{bg:"bg-orange-700",text:"text-orange-200",shadow:"shadow-orange-500/50",name:"",background:"/images/equipments/mythicbgi.png"}},Lv={rare:"spinning-border-rare",epic:"spinning-border-epic",legendary:"spinning-border-legendary",mythic:"spinning-border-mythic"},$v=({items:e,onClose:n,isTopmost:s})=>{f.useEffect(()=>{if(e&&e.length>0){const r=["normal","uncommon","rare","epic","legendary","mythic"],a=e.reduce((i,o)=>{const c=i.grade||"normal",d=o.grade||"normal";return r.indexOf(d)>r.indexOf(c)?o:i});["epic","legendary","mythic"].includes(a.grade)&&Pe.gachaEpicOrHigher()}},[e]);const l=f.useMemo(()=>e.reduce((r,a)=>r+(a.quantity||1),0),[e]);return t.jsx(be,{title:"  ",onClose:n,windowId:"bulk-item-obtained",initialWidth:600,closeOnOutsideClick:!1,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsxs("h2",{className:"text-xl font-bold mb-4",children:[" ",l," !"]}),t.jsx("div",{className:"grid grid-cols-5 gap-2 max-h-[60vh] overflow-y-auto p-2 bg-gray-900/50 rounded-lg",children:e.map((r,a)=>{var p;const i=Rv[r.grade],o=Lv[r.grade],c=r.type==="equipment"?En[r.grade]:null,d=`${r.name}${c?` (  : ${c})`:""}`,u=r.image==="/images/icon/Gold.png"||r.image==="/images/icon/Zem.png";return t.jsxs("div",{className:"relative aspect-square rounded-md overflow-hidden",title:d,children:[o&&t.jsx("div",{className:`absolute -inset-0.5 rounded-md ${o}`}),t.jsxs("div",{className:`relative w-full h-full rounded-md flex items-center justify-center border-2 border-black/20 ${i.bg}`,children:[t.jsx("img",{src:i.background,alt:r.grade,className:"absolute inset-0 w-full h-full object-cover rounded-sm"}),r.image&&t.jsx("img",{src:r.image,alt:r.name,className:"relative w-full h-full object-contain p-1"}),u?t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-sm p-1",children:t.jsxs("span",{className:"text-white text-lg font-bold text-center break-words",style:{textShadow:"1px 1px 2px black"},children:["+",(p=r.quantity)==null?void 0:p.toLocaleString()]})}):r.quantity&&r.quantity>1&&t.jsx("span",{className:"absolute bottom-0 right-0 text-xs font-bold text-white bg-black/60 px-1 rounded-tl-md",children:r.quantity})]})]},a)})}),t.jsx(U,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},Ku={normal:"images/equipments/normalbgi.png",uncommon:"images/equipments/uncommonbgi.png",rare:"images/equipments/rarebgi.png",epic:"images/equipments/epicbgi.png",legendary:"images/equipments/legendarybgi.png",mythic:"images/equipments/mythicbgi.png"},Ar={normal:0,uncommon:1,rare:2,epic:3,legendary:4,mythic:5},Bv=({onClose:e,isTopmost:n})=>{const[s,l]=f.useState("equipment"),r=["fan","board","top","bottom","bowl","stones"],a={fan:"",board:"",top:"",bottom:"",bowl:"",stones:""},i=[{id:"",name:""},{id:"",name:""},{id:"",name:""},{id:"",name:""}],o={normal:{name:"",color:"text-gray-300"},uncommon:{name:"",color:"text-green-400"},rare:{name:"",color:"text-blue-400"},epic:{name:"",color:"text-purple-400"},legendary:{name:"",color:"text-red-500"},mythic:{name:"",color:"text-orange-400"}},[c,d]=f.useState("fan"),[u,p]=f.useState(null),[m,h]=f.useState(""),y=f.useMemo(()=>{if(s==="equipment")return kc.filter(x=>x.slot===c).sort((x,v)=>Ar[x.grade]-Ar[v.grade]);if(s==="material")return Object.values(tn).sort((x,v)=>Ar[x.grade]-Ar[v.grade]);if(s==="consumable"){const v={:" ",:" ",:" ",:" "}[m];return[...ws].filter(k=>k.name.includes(v)).sort((k,P)=>k.name.localeCompare(P.name))}return[]},[s,c,m]);f.useEffect(()=>{y.length>0?(!u||!y.some(x=>x.name===u.name))&&p(y[0]):u&&p(null)},[y,u]);const b=()=>{var I;if(!u||u.type!=="equipment"||!u.slot)return null;const x=N0[u.grade],v=R=>R[0]===R[1]?`${R[0]}`:`${R[0]}~${R[1]}`,w=x.mythicCount[0]>0,k=((I=k0[u.slot])==null?void 0:I[x.combatTier])||[],P=w0[u.slot],S=P.options[u.grade],E=S.value,_=P.isPercentage,C=S.stats.join("  ");return t.jsxs(t.Fragment,{children:[t.jsx("h5",{className:"text-sm md:text-base font-semibold text-yellow-300 mt-3 border-b border-gray-600 pb-1",children:""}),t.jsxs("p",{className:"text-xs md:text-sm text-gray-300 py-1",children:[t.jsx("strong",{className:"text-yellow-400",children:C}),": +",E,_?"%":""]}),t.jsxs("h5",{className:"text-sm md:text-base font-semibold text-blue-300 mt-3 border-b border-gray-600 pb-1",children:[" ( ",v(x.combatCount),")"]}),t.jsx("ul",{className:"space-y-1 text-[10px] md:text-xs text-gray-300 pt-1",children:k.map((R,A)=>t.jsxs("li",{children:[t.jsx("strong",{className:"text-blue-400",children:R.type}),": +",R.range[0],"~",R.range[1],R.isPercentage?"%":""]},`${R.type}-${A}`))}),t.jsxs("h5",{className:"text-sm md:text-base font-semibold text-green-300 mt-3 border-b border-gray-600 pb-1",children:["  ( ",v(x.specialCount),")"]}),t.jsx("ul",{className:"space-y-1 text-[10px] md:text-xs text-gray-300 pt-1",children:Object.entries(mx).map(([R,A])=>t.jsxs("li",{children:[t.jsx("strong",{className:"text-green-400",children:A.name}),": +",A.range[0],"~",A.range[1],A.isPercentage?"%":""]},R))}),w&&t.jsxs(t.Fragment,{children:[t.jsxs("h5",{className:"text-sm md:text-base font-semibold text-red-400 mt-3 border-b border-gray-600 pb-1",children:["  ( ",v(x.mythicCount),")"]}),t.jsx("ul",{className:"space-y-1 text-[10px] md:text-xs text-gray-300 pt-1",children:Object.values(ct).map(R=>{const A=fx[R];return t.jsxs("li",{children:[t.jsx("strong",{className:"text-red-400",children:A.name}),": ",A.description]},R)})})]})]})},j=()=>t.jsxs("div",{className:"text-left text-gray-300 space-y-6 overflow-y-auto pr-2 h-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-center text-yellow-300",children:"    "}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-green-400 border-b-2 border-green-400/50 pb-1 mb-2",children:" "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1",children:[t.jsx("li",{children:"     . (+4, +7, +10   2 )"}),t.jsx("li",{children:"      ."})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-blue-400 border-b-2 border-blue-400/50 pb-1 mb-2",children:" "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-2",children:[t.jsx("li",{children:"     , ,      ."}),t.jsxs("li",{children:[t.jsx("strong",{className:"text-yellow-400",children:" :"}),"             .       ."]}),t.jsxs("li",{children:[t.jsx("strong",{className:"text-yellow-400",children:"/ :"}),"       ."]}),t.jsxs("li",{children:[t.jsx("strong",{className:"text-yellow-400",children:" :"}),"         ."]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-purple-400 border-b-2 border-purple-400/50 pb-1 mb-2",children:"  "}),t.jsxs("div",{className:"space-y-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-yellow-300",children:""}),t.jsx("p",{className:"text-xs text-gray-400 pl-4",children:"1     .    (+4),  (+7),  (+10)    2 ."})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-blue-300",children:""}),t.jsx("p",{className:"text-xs text-gray-400 pl-4",children:" 4 . 1  4     , 4        ."})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-green-300",children:"  &  "}),t.jsx("p",{className:"text-xs text-gray-400 pl-4",children:"    .      ."})]})]})]})]});return t.jsxs(be,{title:"",onClose:e,windowId:"encyclopedia",initialWidth:900,isTopmost:n,children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>l("equipment"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="equipment"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>l("material"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="material"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>l("consumable"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="consumable"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>l("help"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="help"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),s==="help"?t.jsx("div",{className:"h-[calc(var(--vh,1vh)*65)] bg-gray-900/50 rounded-lg p-4",children:j()}):t.jsxs("div",{className:"flex gap-4 h-[calc(var(--vh,1vh)*65)] flex-row",children:[t.jsxs("div",{className:"flex flex-col gap-4 w-1/2 h-full",children:[s==="consumable"&&t.jsxs("div",{className:"w-full bg-gray-900/50 rounded-lg p-2 flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold mb-2 hidden md:block",children:""}),t.jsx("div",{className:"flex flex-row md:flex-col gap-2 overflow-x-auto md:overflow-y-auto md:overflow-x-hidden pb-1 md:pb-0 scrollbar-thin",children:i.map(x=>t.jsx("button",{onClick:()=>h(x.id),className:`flex-shrink-0 whitespace-nowrap text-center rounded-md transition-colors px-3 py-1.5 text-xs md:text-left md:w-full md:px-4 md:py-2 md:text-sm ${m===x.id?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:x.name},x.id))})]}),s==="equipment"&&t.jsxs("div",{className:"w-full bg-gray-900/50 rounded-lg p-2 flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold mb-2 hidden md:block",children:""}),t.jsx("div",{className:"flex flex-row md:flex-col gap-2 overflow-x-auto md:overflow-y-auto md:overflow-x-hidden pb-1 md:pb-0 scrollbar-thin",children:r.map(x=>t.jsx("button",{onClick:()=>d(x),className:`flex-shrink-0 whitespace-nowrap text-center rounded-md transition-colors px-3 py-1.5 text-xs md:text-left md:w-full md:px-4 md:py-2 md:text-sm ${c===x?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:a[x]},x))})]}),t.jsxs("div",{className:"w-full bg-gray-900/50 rounded-lg p-2 flex flex-col min-h-0 flex-grow",children:[t.jsx("h3",{className:"text-lg font-bold mb-2 flex-shrink-0",children:" "}),t.jsx("div",{className:"flex flex-col space-y-1 overflow-y-auto pr-2 flex-grow",children:y.map(x=>t.jsxs("button",{onClick:()=>p(x),className:`w-full text-left p-2 rounded-md text-sm flex items-center gap-2 ${(u==null?void 0:u.name)===x.name?"bg-blue-800/80":"hover:bg-gray-700/50"}`,children:[t.jsxs("div",{className:"relative w-8 h-8 flex-shrink-0",children:[t.jsx("img",{src:Ku[x.grade],alt:x.grade,className:"absolute inset-0 w-full h-full object-cover rounded-sm"}),x.image&&t.jsx("img",{src:x.image,alt:x.name,className:"relative w-full h-full object-contain p-0.5"})]}),t.jsx("span",{className:`${o[x.grade].color} truncate`,children:x.name})]},x.name))})]})]}),t.jsx("div",{className:"bg-gray-900/50 rounded-lg flex flex-col items-center min-h-0 w-1/2 h-full p-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:`relative flex-shrink-0 ${s==="equipment"?"w-20 h-20 md:w-40 md:h-40":"w-24 h-24 md:w-40 md:h-40"}`,children:[t.jsx("img",{src:Ku[u.grade],alt:u.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),u.image&&t.jsx("img",{src:u.image,alt:u.name,className:"relative w-full h-full object-contain p-[15%]"})]}),t.jsx("h3",{className:`font-bold mt-2 md:mt-4 ${o[u.grade].color} text-center ${s==="equipment"?"text-lg md:text-2xl":"text-xl md:text-2xl"}`,children:u.name}),t.jsx("p",{className:"text-xs md:text-sm text-gray-400 text-center",children:u.type==="equipment"?`[${o[u.grade].name}] ${u.slot?a[u.slot]:""}`:s==="material"?"":""}),u.type==="equipment"&&t.jsx("p",{className:"text-[10px] md:text-xs text-gray-400 mt-1",children:`  : ${En[u.grade]}`}),t.jsxs("div",{className:"w-full flex-grow overflow-y-auto mt-2 pt-2 border-t border-gray-700 min-h-0 pr-2",children:[u.type==="equipment"&&b(),u.type!=="equipment"&&t.jsx("p",{className:"text-xs md:text-sm text-gray-300 py-1 text-center",children:u.description})]})]}):t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:t.jsx("p",{children:" ."})})})]})]})},Ov=({info:e,onClose:n,isTopmost:s})=>{const{user:l,mode:r}=e,a=l.seasonHistory||{},i=Object.keys(a).sort((o,c)=>c.localeCompare(o));return t.jsx(be,{title:"  ",onClose:n,windowId:"past-rankings",initialWidth:450,isTopmost:s,children:t.jsxs("div",{className:"max-h-[calc(var(--vh,1vh)*60)] overflow-y-auto pr-2",children:[t.jsx("h3",{className:"text-lg font-bold text-center mb-4",children:r}),i.length>0?t.jsx("ul",{className:"space-y-2",children:i.map(o=>{var u;const c=(u=a[o])==null?void 0:u[r],d=At.find(p=>p.name===c);return t.jsxs("li",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg",children:[t.jsx("span",{className:"font-semibold text-gray-300",children:o}),c&&d?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:d.icon,alt:c,className:"w-8 h-8"}),t.jsx("span",{className:`font-bold ${d.color}`,children:c})]}):t.jsx("span",{className:"text-gray-500",children:" "})]},o)})}):t.jsx("p",{className:"text-center text-gray-500",children:"    ."})]})})},Dv=({user:e,currentUser:n,onClose:s,onAction:l,isTopmost:r})=>{const a=Date.now(),i=e.chatBanUntil&&e.chatBanUntil>a,o=e.connectionBanUntil&&e.connectionBanUntil>a,c=i?Math.ceil((e.chatBanUntil-a)/1e3/60):0,d=o?Math.ceil((e.connectionBanUntil-a)/1e3/60):0,u=(j,g)=>{l({type:"ADMIN_APPLY_SANCTION",payload:{targetUserId:e.id,sanctionType:j,durationMinutes:g}})},p=j=>{l({type:"ADMIN_LIFT_SANCTION",payload:{targetUserId:e.id,sanctionType:j}})},m=f.useMemo(()=>{var j;return(j=Ee.find(g=>g.id===e.avatarId))==null?void 0:j.url},[e.avatarId]),h=f.useMemo(()=>{var j;return(j=Re.find(g=>g.id===e.borderId))==null?void 0:j.url},[e.borderId]),y=[{label:"1",minutes:1},{label:"5",minutes:5},{label:"10",minutes:10},{label:"30",minutes:30},{label:"1",minutes:60}],b=[{label:"10",minutes:10},{label:"1",minutes:60},{label:"6",minutes:360},{label:"1",minutes:1440},{label:"3",minutes:4320},{label:"",minutes:999999}];return t.jsx(be,{title:` : ${e.nickname}`,onClose:s,windowId:`admin-mod-${e.id}`,isTopmost:r,children:t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4 bg-gray-900/50 p-3 rounded-lg",children:[t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:m,borderUrl:h,size:64}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold",children:e.nickname}),t.jsxs("p",{className:"text-sm text-gray-400",children:["ID: ",e.username]})]})]}),t.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg space-y-3",children:[t.jsx("h4",{className:"font-bold text-lg border-b border-gray-600 pb-2",children:" "}),i?t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-red-400",children:["  (",c," )"]}),t.jsx(U,{onClick:()=>p("chat"),colorScheme:"yellow",className:"!text-xs !py-1",children:""})]}):t.jsx("div",{className:"grid grid-cols-5 gap-2",children:y.map(j=>t.jsx(U,{onClick:()=>u("chat",j.minutes),className:"!text-xs",children:j.label},j.minutes))})]}),t.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg space-y-3",children:[t.jsx("h4",{className:"font-bold text-lg border-b border-gray-600 pb-2",children:" "}),o?t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-red-400",children:["  (",d," )"]}),t.jsx(U,{onClick:()=>p("connection"),colorScheme:"yellow",className:"!text-xs !py-1",children:""})]}):t.jsx("div",{className:"grid grid-cols-3 gap-2",children:b.map(j=>t.jsx(U,{onClick:()=>u("connection",j.minutes),colorScheme:"orange",className:"!text-xs",children:j.label},j.minutes))})]})]})})},qv=({summary:e,onClose:n,isTopmost:s})=>{var i,o;const{reward:l,items:r,title:a}=e;return t.jsx(be,{title:a,onClose:n,windowId:"quest-reward-summary",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:" !"}),t.jsxs("div",{className:"space-y-3 bg-gray-900/50 p-4 rounded-lg text-lg",children:[(l.gold??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-yellow-300",children:["+",l.gold.toLocaleString()]})]}),(l.diamonds??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-cyan-300",children:["+",l.diamonds.toLocaleString()]})]}),(l.actionPoints??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold text-green-300",children:["+",l.actionPoints.toLocaleString()]})]}),((i=l.xp)==null?void 0:i.type)==="blacksmith"&&(((o=l.xp)==null?void 0:o.amount)??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/equipments/moru.png",alt:" ",className:"w-5 h-5"}),"  :"]}),t.jsxs("span",{className:"font-bold text-orange-400",children:["+",l.xp.amount.toLocaleString()]})]})]}),r.length>0&&t.jsxs("div",{className:"mt-4 bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"font-semibold mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-4 gap-2",children:r.map((c,d)=>t.jsxs("div",{className:"flex flex-col items-center",title:c.name,children:[t.jsx("img",{src:c.image,alt:c.name,className:"w-12 h-12 object-contain"}),t.jsxs("span",{className:"text-xs",children:[c.name,c.quantity&&c.quantity>1?` x${c.quantity}`:""]})]},d))})]}),t.jsx(U,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},zv={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},Uv=["/images/equipments/Star1.png","/images/equipments/Star2.png","/images/equipments/Star3.png","/images/equipments/Star4.png"],Fv=["/images/icon/Gold.png","/images/icon/Zem.png","/images/quest.png","/images/gibo.png","/images/mail.png","/images/store.png","/images/bag.png","/images/BlankEquipmentsSlot.png"],Ox=new Set,Tt=e=>{for(const n of e)n&&typeof n=="string"&&n.startsWith("/")&&Ox.add(n)};Tt(Object.values($a));Tt([Ml.neighborhood.image,Ml.national.image,Ml.world.image]);Tt(Qe.map(e=>e.image));Tt(nt.map(e=>e.image));Tt(tl.map(e=>e.icon));Tt(Ee.map(e=>e.url));Tt(Re.map(e=>e.url));Tt(At.map(e=>e.icon));Tt(kc.map(e=>e.image));Tt(ws.map(e=>e.image));Tt(Object.values(tn).map(e=>e.image));Tt([Oa,Da,Ic,Pc,wx,Nx,kx,Sx,Cx]);Tt(Object.values(zv));Tt(Uv);Tt(Fv);const Gv=Array.from(Ox),Wv=e=>{const n=e.map(s=>new Promise(l=>{const r=new Image;r.src=s,r.onload=l,r.onerror=a=>l(`Failed to load ${s}: ${a.toString()}`)}));return Promise.all(n)},Hv=({result:e,onClose:n,isTopmost:s})=>{const{gained:l,used:r,craftType:a}=e,i=a==="upgrade"?" ":" ",o=l[0],c=r[0],d=tn[o.name],u=tn[c.name];return t.jsx(be,{title:i,onClose:n,windowId:"crafting-result",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"   ."}),t.jsxs("div",{className:"flex items-center justify-around text-center mb-4 bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[(u==null?void 0:u.image)&&t.jsx("img",{src:u.image,alt:c.name,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:c.name}),t.jsxs("span",{className:"text-sm text-red-400 mt-1",children:["-",c.amount.toLocaleString(),""]})]}),t.jsx("div",{className:"text-4xl font-bold text-yellow-400 mx-4",children:""}),t.jsxs("div",{className:"flex flex-col items-center",children:[(d==null?void 0:d.image)&&t.jsx("img",{src:d.image,alt:o.name,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:o.name}),t.jsxs("span",{className:"text-sm text-green-400 mt-1",children:["+",o.amount.toLocaleString(),""]})]})]}),t.jsx(U,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},Vv=({value:e,min:n,max:s,step:l=1,onChange:r,disabled:a=!1})=>t.jsx("input",{type:"range",min:n,max:s,step:l,value:e,onChange:i=>r(Number(i.target.value)),disabled:a,className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer disabled:opacity-50"}),Kv=[{id:"black",name:"",colors:["#0f172a","#1e293b","#e2e8f0","#eab308"]},{id:"white",name:"",colors:["#f8fafc","#f1f5f9","#0f172a","#ca8a04"]},{id:"sky",name:"",colors:["#f0f9ff","#e0f2fe","#1e3a8a","#f97316"]},{id:"blue",name:" ",colors:["#eff6ff","#dbeafe","#1e40af","#3b82f6"]},{id:"green",name:" ",colors:["#f0fdf4","#dcfce7","#14532d","#d946ef"]}],Qv=({onClose:e,isTopmost:n})=>{const{settings:s,updateTheme:l,updateSoundSetting:r,updateFeatureSetting:a,updatePanelColor:i,updateTextColor:o,resetGraphicsToDefault:c}=De(),[d,u]=f.useState("graphics"),p=[{id:"graphics",label:""},{id:"sound",label:""},{id:"features",label:""}],m=[{key:"stone",label:"// "},{key:"notification",label:"/ "},{key:"item",label:"  "},{key:"countdown",label:"/ "},{key:"turn",label:"   "}],h=()=>{switch(d){case"graphics":return t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary",children:"UI "}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2",children:Kv.map(y=>t.jsxs("label",{className:"flex items-center p-3 bg-tertiary/50 rounded-lg cursor-pointer border-2 border-transparent has-[:checked]:border-accent has-[:checked]:ring-2 has-[:checked]:ring-accent",children:[t.jsx("input",{type:"radio",name:"theme",value:y.id,checked:s.graphics.theme===y.id,onChange:()=>l(y.id),className:"w-5 h-5 text-accent bg-secondary border-color focus:ring-accent"}),t.jsx("span",{className:"ml-3 text-text-primary",children:y.name}),t.jsx("div",{className:"ml-auto flex -space-x-2",children:y.colors.map((b,j)=>t.jsx("div",{style:{backgroundColor:b},className:"w-6 h-6 rounded-full border-2 border-primary"},j))})]},y.id))})]})});case"sound":return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-2",children:" "}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"w-12 text-center font-mono text-text-primary text-lg",children:(s.sound.masterVolume*10).toFixed(0)}),t.jsx(Vv,{min:0,max:1,step:.1,value:s.sound.masterVolume,onChange:y=>r("masterVolume",y),disabled:s.sound.masterMuted})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary",children:" "}),t.jsx(Bn,{checked:!s.sound.masterMuted,onChange:y=>r("masterMuted",!y)})]}),t.jsxs("div",{className:"space-y-3 pt-4 border-t border-color",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-2",children:"  "}),m.map(({key:y,label:b})=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:b}),t.jsx(Bn,{checked:!s.sound.categoryMuted[y],onChange:j=>r("categoryMuted",{...s.sound.categoryMuted,[y]:!j}),disabled:s.sound.masterMuted})]},y))]})]});case"features":return t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-4",children:" "}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"   []  "}),t.jsx(Bn,{checked:s.features.mobileConfirm,onChange:y=>a("mobileConfirm",y)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"  ( )"}),t.jsx(Bn,{checked:s.features.stonePreview,onChange:y=>a("stonePreview",y)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"   "}),t.jsx(Bn,{checked:s.features.lastMoveMarker,onChange:y=>a("lastMoveMarker",y)})]}),t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-4 pt-4 border-t border-color",children:""}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"  "}),t.jsx(Bn,{checked:s.features.questNotifications,onChange:y=>a("questNotifications",y)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"   ( )"}),t.jsx(Bn,{checked:s.features.chatNotifications,onChange:y=>a("chatNotifications",y)})]})]})}};return t.jsx(be,{title:"",onClose:e,windowId:"settings",initialWidth:600,isTopmost:n,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*60)] flex flex-col",children:[t.jsx("div",{className:"flex bg-tertiary/70 p-1 rounded-lg mb-4 flex-shrink-0",children:p.map(y=>t.jsx("button",{onClick:()=>u(y.id),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${d===y.id?"bg-accent":"text-tertiary hover:bg-secondary/50"}`,children:y.label},y.id))}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 p-2",children:h()}),t.jsx("div",{className:"flex justify-end gap-4 mt-4 pt-4 border-t border-color flex-shrink-0",children:t.jsx(U,{onClick:e,colorScheme:"gray",children:""})})]})})},Qu=({summary:e,onClose:n,isTopmost:s})=>t.jsx(be,{title:"  ",onClose:n,windowId:"claim-all-summary",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"   !"}),t.jsxs("div",{className:"space-y-3 bg-gray-900/50 p-4 rounded-lg text-lg",children:[e.gold>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-yellow-300",children:["+",e.gold.toLocaleString()]})]}),e.diamonds>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-cyan-300",children:["+",e.diamonds.toLocaleString()]})]}),e.actionPoints>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold text-green-300",children:["+",e.actionPoints.toLocaleString()]})]})]}),t.jsx(U,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})}),Jv={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},Yv=e=>{if(e===0)return null;let n="",s="";return e>=10?(n="/images/equipments/Star4.png",s="prism-text-effect"):e>=7?(n="/images/equipments/Star3.png",s="text-purple-400"):e>=4?(n="/images/equipments/Star2.png",s="text-amber-400"):e>=1&&(n="/images/equipments/Star1.png",s="text-white"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:`font-bold text-xs leading-none ${s}`,children:e})]})},Xv=({item:e})=>{var i,o,c,d;const{currentUserWithStatus:n}=De(),s=Jv[e.grade],l=En[e.grade],a=((n==null?void 0:n.strategyLevel)||0)+((n==null?void 0:n.playfulLevel)||0)>=l;return t.jsxs("div",{className:"flex flex-col w-full h-full p-1",children:[t.jsxs("div",{className:"flex mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0 mr-3",children:[t.jsx("img",{src:s.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),Yv(e.stars)]}),t.jsxs("div",{className:"flex-grow overflow-hidden pt-2",children:[t.jsx("h3",{className:`text-lg font-bold truncate ${s.color}`,children:e.name}),t.jsxs("p",{className:`text-xs ${a?"text-gray-500":"text-red-500"}`,children:["(: ",l,")"]}),((i=e.options)==null?void 0:i.main)&&t.jsx("p",{className:"font-semibold text-yellow-300 text-sm truncate",children:e.options.main.display})]})]}),t.jsxs("div",{className:"w-full text-sm text-left space-y-1 bg-black/30 p-2 rounded-lg flex-grow overflow-y-auto",children:[((o=e.options)==null?void 0:o.combatSubs)&&e.options.combatSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.combatSubs.map((u,p)=>t.jsx("p",{className:"text-blue-300",children:u.display},`c-${p}`))}),((c=e.options)==null?void 0:c.specialSubs)&&e.options.specialSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.specialSubs.map((u,p)=>t.jsx("p",{className:"text-green-300",children:u.display},`s-${p}`))}),((d=e.options)==null?void 0:d.mythicSubs)&&e.options.mythicSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.mythicSubs.map((u,p)=>t.jsx("p",{className:"text-red-400",children:u.display},`m-${p}`))})]})]})},ba=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-purple-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},Zv=({outcome:e,onConfirm:n})=>{if(!e)return null;const{success:s,message:l,itemBefore:r,itemAfter:a}=e,i=f.useMemo(()=>{if(!s||!r.options||!a.options)return null;if(a.options.combatSubs.length>r.options.combatSubs.length){const d=a.options.combatSubs.find(u=>!r.options.combatSubs.some(p=>p.type===u.type&&p.isPercentage===u.isPercentage));return d?{type:"new",option:d}:null}for(const d of a.options.combatSubs){const u=r.options.combatSubs.find(p=>p.type===d.type&&p.isPercentage===d.isPercentage);if(!u||u.value!==d.value)return{type:"upgraded",before:u,after:d}}return null},[s,r,a]),o=ba(r.stars),c=ba(a.stars);return t.jsxs("div",{className:"absolute inset-0 bg-gray-900/80 rounded-lg flex flex-col items-center justify-center z-20 animate-fade-in p-4",children:[t.jsx("div",{className:`text-6xl mb-4 ${s?"animate-bounce":""}`,children:s?"":""}),t.jsx("h2",{className:`text-3xl font-bold ${s?"text-green-400":"text-red-400"}`,children:s?" !":" ..."}),t.jsx("p",{className:"text-gray-300 mt-2 text-center",children:l}),s&&t.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg mt-4 w-full max-w-sm text-xs space-y-1",children:[t.jsx("h4",{className:"font-bold text-center text-yellow-300 mb-2",children:" "}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"}),t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("span",{className:o.colorClass,children:o.text||"()"}),"",t.jsx("span",{className:c.colorClass,children:c.text})]})]}),r.options&&a.options&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsxs("span",{className:"truncate",children:[r.options.main.display,"  ",a.options.main.display]})]}),(i==null?void 0:i.type)==="new"&&i.option&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{className:"truncate",children:i.option.display})]}),(i==null?void 0:i.type)==="upgraded"&&i.before&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"truncate",children:[i.before.display,"  ",i.after.display]})]})]}),t.jsx(U,{onClick:n,colorScheme:"green",className:"mt-6 w-full max-w-sm",children:""})]})},ej=({selectedItem:e,currentUser:n,onAction:s,enhancementOutcome:l,onOutcomeConfirm:r})=>{const[a,i]=f.useState(!1),o=f.useMemo(()=>{var E;return e?(E=ha[e.grade])==null?void 0:E[e.stars]:null},[e]),c=n?n.strategyLevel+n.playfulLevel:0,d=f.useMemo(()=>{if(!e)return 0;const E=e.stars+1;return E===4?3:E===7?8:E===10?15:0},[e]),u=c>=d,p=f.useMemo(()=>{if(!n)return{};const E={};for(const _ of Object.keys(tn))E[_]=n.inventory.filter(C=>C.name===_).reduce((C,I)=>C+(I.quantity||0),0);return E},[n]),m=f.useMemo(()=>e?g0(e.grade,e.stars):0,[e]),h=f.useMemo(()=>n?n.gold>=m:!1,[n,m]),y=f.useMemo(()=>!e||!o||d>0&&!u||!h?!1:o.every(E=>p[E.name]>=E.amount),[o,p,d,u,e,h]),{mainOptionPreview:b,subOptionPreview:j}=f.useMemo(()=>{if(!e)return{mainOptionPreview:"",subOptionPreview:""};if(!e.options||e.stars>=10)return{mainOptionPreview:" ",subOptionPreview:""};const{main:E,combatSubs:_}=e.options,C=E.baseValue;if(!C)return{mainOptionPreview:"N/A",subOptionPreview:"N/A"};let I=1;[3,6,9].includes(e.stars)&&(I=2);const R=C*I,A=E.value+R,O=`${E.type} +${E.value.toFixed(2).replace(/\.00$/,"")}${E.isPercentage?"%":""}`,L=`+${A.toFixed(2).replace(/\.00$/,"")}${E.isPercentage?"%":""}`,Q=`${O}  ${L}`,D=_.length<4?"   1 ":"   1 ";return{mainOptionPreview:Q,subOptionPreview:D}},[e]),g=f.useMemo(()=>e?ba(e.stars):{text:"",colorClass:"text-white"},[e]),x=f.useMemo(()=>!e||e.stars>=10?null:ba(e.stars+1),[e]),v=f.useMemo(()=>e?a?" ...":e.stars>=10?" ":d>0&&!u?`  ( ${d} )`:o?h?y?` (+${e.stars+1})`:" ":`  (: ${m.toLocaleString()})`:"  ":"  .",[a,e,d,u,o,y,h,m]);if(f.useEffect(()=>{i(!1)},[e]),!e)return t.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:t.jsx("p",{children:"  ."})});const w=f0[e.stars],k=x0[e.grade]||.5,P=(e.enhancementFails||0)*k,S=()=>{!y||a||(i(!0),s({type:"ENHANCE_ITEM",payload:{itemId:e.id}}))};return t.jsxs("div",{className:"relative h-full",children:[t.jsx(Zv,{outcome:l,onConfirm:r}),t.jsxs("div",{className:"flex flex-row gap-6 h-full",children:[t.jsx("div",{className:"w-1/2 flex flex-col bg-gray-900/40 p-2 rounded-lg h-full",children:t.jsx(Xv,{item:e})}),t.jsxs("div",{className:"w-1/2 space-y-3 flex flex-col",children:[t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-center mb-2 text-green-300",children:"  "}),t.jsxs("div",{className:"space-y-1 text-xs sm:text-sm text-left",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsxs("div",{className:"font-mono text-white flex items-center gap-2",children:[t.jsx("span",{className:g.colorClass,children:g.text||"(0)"}),"",x?t.jsx("span",{className:x.colorClass,children:x.text}):"-"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsx("span",{className:"font-mono text-white",children:b})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsx("span",{className:"font-mono text-white",children:e.stars<10?j:""})]})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:" "}),t.jsxs("div",{className:"space-y-1 text-sm",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-yellow-400 text-lg",children:""}),""]}),t.jsxs("span",{className:`font-mono ${h?"text-green-400":"text-red-400"}`,children:[((n==null?void 0:n.gold)||0).toLocaleString()," / ",m.toLocaleString()]})]}),o==null?void 0:o.map(E=>{const _=p[E.name]||0,C=_>=E.amount;return t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("img",{src:tn[E.name].image,alt:E.name,className:"w-6 h-6"}),E.name]}),t.jsxs("span",{className:`font-mono ${C?"text-green-400":"text-red-400"}`,children:[_.toLocaleString()," / ",E.amount.toLocaleString()]})]},E.name)})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg text-center flex-grow flex flex-col justify-center",children:[t.jsx("h4",{className:"font-semibold mb-1",children:"  "}),t.jsxs("p",{className:"text-3xl font-bold text-yellow-300",children:[w,"%",P>0&&t.jsxs("span",{className:"text-xl text-green-400 ml-2",children:["(+",P.toFixed(1).replace(/\.0$/,""),"%)"]})]})]}),t.jsx(U,{onClick:S,disabled:!y||a||e.stars>=10,colorScheme:"yellow",className:"w-full py-3 mt-auto",children:v})]})]})]})},tj={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},Ju=["fan","board","top","bottom","bowl","stones"],Dx={fan:"",board:"",top:"",bottom:"",bowl:"",stones:""},nj=({item:e,onRemove:n})=>{if(!e)return t.jsx("div",{className:"w-1/3 h-32 border-2 border-dashed border-gray-500 rounded-lg flex items-center justify-center bg-black/20",children:t.jsx("span",{className:"text-gray-400",children:""})});const s=tj[e.grade];return t.jsxs("div",{className:"w-1/3 h-32 rounded-lg bg-black/20 p-2 flex flex-col items-center justify-center text-center relative",children:[t.jsx("button",{onClick:n,className:"absolute top-1 right-1 text-red-500 hover:text-red-400 z-10",children:""}),t.jsxs("div",{className:"relative w-16 h-16 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:s.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"})]}),t.jsx("p",{className:`text-sm font-bold ${s.color} truncate w-full`,children:e.name}),t.jsx("p",{className:"text-xs text-gray-400",children:Dx[e.slot]||""})]})},sj=({items:e,isRandom:n})=>{const s=f.useMemo(()=>{const l=e.filter(a=>a!==null);if(l.length!==3)return[];const r=new Map;if(n){const a=1/Ju.length;for(const i of Ju)r.set(i,a)}else{const a=new Map;for(const i of l)i.slot&&a.set(i.slot,(a.get(i.slot)||0)+1);for(const[i,o]of a.entries())r.set(i,o/3)}return Array.from(r.entries()).sort((a,i)=>i[1]-a[1])},[e,n]);return s.length===0?null:t.jsxs("div",{className:"w-full bg-black/20 p-3 rounded-lg mt-4",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:"  "}),t.jsx("div",{className:"grid grid-cols-3 gap-x-4 gap-y-1 text-sm",children:s.map(([l,r])=>t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-gray-400",children:[Dx[l],":"]}),t.jsxs("span",{className:"font-bold text-white",children:[(r*100).toFixed(1),"%"]})]},l))})]})},lj=({items:e,currentUser:n})=>{const{blacksmithLevel:s}=n,l=f.useMemo(()=>{var d;const r=e.filter(u=>u!==null);if(r.length!==3||new Set(r.map(u=>u.grade)).size!==1)return null;const a=r[0].grade,i=(s??1)-1,o=((d=Ql[i])==null?void 0:d[a])??0;return{successRate:100-o,greatSuccessRate:o}},[e,s]);return l?t.jsxs("div",{className:"w-full bg-black/20 p-3 rounded-lg mt-2",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:"  "}),t.jsxs("div",{className:"grid grid-cols-2 gap-x-4 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsxs("span",{className:"font-bold text-white",children:[l.successRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-yellow-400",children:":"}),t.jsxs("span",{className:"font-bold text-yellow-300",children:[l.greatSuccessRate.toFixed(1),"%"]})]})]})]}):null},rj=({items:e,onRemoveItem:n,onAction:s,currentUser:l})=>{const[r,a]=f.useState(!1),i=()=>{const c=e.map(d=>d==null?void 0:d.id).filter(d=>!!d);c.length===3&&s({type:"COMBINE_ITEMS",payload:{itemIds:c,isRandom:r}})},o=e.every(c=>c!==null)&&new Set(e.map(c=>c==null?void 0:c.grade)).size===1;return t.jsxs("div",{className:"h-full flex flex-col items-center justify-between",children:[t.jsx("div",{className:"w-full flex justify-around items-stretch gap-2",children:e.map((c,d)=>t.jsx(nj,{item:c,onRemove:()=>n(d)},d))}),t.jsxs("div",{className:"w-full",children:[t.jsx(sj,{items:e,isRandom:r}),t.jsx(lj,{items:e,currentUser:l})]}),t.jsxs("div",{className:"w-full space-y-4 mt-4",children:[t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("input",{type:"checkbox",id:"random-combine",checked:r,onChange:c=>a(c.target.checked),className:"h-4 w-4 rounded text-accent bg-gray-700 border-gray-600 focus:ring-accent"}),t.jsx("label",{htmlFor:"random-combine",className:"ml-2 text-sm text-gray-300",children:"   "})]}),t.jsx(U,{onClick:i,disabled:!o,colorScheme:"blue",className:"w-full",children:""})]})]})},aj=e=>{if(e.type==="equipment"){const n=h0[e.grade]||0,s=Math.pow(1.2,e.stars);return Math.floor(n*s)}return 0},ij=({selectedIds:e,inventory:n})=>{const{totalMaterials:s,totalSellPrice:l,itemCount:r}=f.useMemo(()=>{var c;const a=n.filter(d=>e.has(d.id)),i={};let o=0;for(const d of a){o+=aj(d);const u=Math.min(d.stars,9),p=(c=ha[d.grade])==null?void 0:c[u];if(p)for(const m of p){const h=Math.floor(m.amount*.25);h>0&&(i[m.name]=(i[m.name]||0)+h)}}return{totalMaterials:Object.entries(i).map(([d,u])=>({name:d,amount:u})),totalSellPrice:o,itemCount:a.length}},[e,n]);return t.jsxs("div",{className:"w-full h-full bg-secondary/50 rounded-lg p-4 flex flex-col text-center",children:[t.jsx("h3",{className:"font-bold text-lg text-tertiary mb-2",children:" "}),t.jsxs("p",{className:"text-sm text-tertiary mb-4",children:[" : ",r,""]}),t.jsxs("div",{className:"flex-grow w-full bg-tertiary/30 p-3 rounded-md overflow-y-auto space-y-2",children:[t.jsx("h4",{className:"font-semibold text-highlight text-left border-b border-color pb-1",children:"  "}),s.length>0?s.map(({name:a,amount:i})=>{const o=tn[a];return t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[(o==null?void 0:o.image)&&t.jsx("img",{src:o.image,alt:a,className:"w-6 h-6"}),a]}),t.jsxs("span",{className:"font-mono text-primary",children:["x ",i.toLocaleString()]})]},a)}):t.jsx("p",{className:"text-sm text-tertiary pt-4",children:"  ."}),t.jsx("p",{className:"text-xs text-cyan-300 text-center pt-4",children:"  30%  ''     2 !"})]}),t.jsx("div",{className:"mt-4 text-sm text-tertiary",children:t.jsxs("p",{children:["   : ",t.jsxs("span",{className:"font-bold text-yellow-300",children:[l.toLocaleString()," "]})]})})]})},oj=["normal","uncommon","rare","epic","legendary"],cj={normal:"",uncommon:"",rare:"",epic:"",legendary:"",mythic:""},dj=({onClose:e,onConfirm:n})=>{const[s,l]=f.useState([]),r=i=>{l(o=>o.includes(i)?o.filter(c=>c!==i):[...o,i])},a=()=>{n(s),e()};return t.jsx(be,{title:"  ",onClose:e,windowId:"disassembly-auto-select",initialWidth:400,isTopmost:!0,children:t.jsxs("div",{className:"text-on-panel",children:[t.jsx("p",{className:"text-sm text-tertiary mb-4 text-center",children:"   .   ."}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:oj.map(i=>t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-tertiary/50 rounded-lg cursor-pointer border-2 border-transparent has-[:checked]:border-accent",children:[t.jsx("input",{type:"checkbox",checked:s.includes(i),onChange:()=>r(i),className:"w-5 h-5 text-accent bg-secondary border-color rounded focus:ring-accent"}),t.jsx("span",{className:"font-semibold",children:cj[i]})]},i))}),t.jsxs("div",{className:"flex justify-end gap-4 mt-6 pt-4 border-t border-color",children:[t.jsx(U,{onClick:e,colorScheme:"gray",children:""}),t.jsx(U,{onClick:a,colorScheme:"blue",children:" "})]})]})})},uj=({onAction:e,selectedForDisassembly:n=new Set,onToggleDisassemblySelection:s})=>{const{currentUserWithStatus:l}=De(),[r,a]=f.useState(!1);if(!l)return null;const{inventory:i}=l,o=()=>{n.size===0||Array.from(n).some(u=>{const p=i.find(m=>m.id===u);return p&&(p.grade==="legendary"||p.grade==="mythic")})&&!window.confirm("    .  ?")||window.confirm(`${n.size}  ?`)&&e({type:"DISASSEMBLE_ITEM",payload:{itemIds:Array.from(n)}})},c=d=>{i.filter(p=>p.type==="equipment"&&!p.isEquipped&&d.includes(p.grade)).map(p=>p.id).forEach(p=>s(p)),a(!1)};return t.jsxs("div",{className:"h-full flex flex-col",children:[r&&t.jsx(dj,{onClose:()=>a(!1),onConfirm:c}),t.jsx("div",{className:"flex-grow",children:t.jsx(ij,{selectedIds:n,inventory:i})}),t.jsxs("div",{className:"flex-shrink-0 border-t border-color py-3 px-2 my-2 flex flex-wrap justify-center items-center gap-2",children:[t.jsx(U,{onClick:()=>a(!0),colorScheme:"blue",children:" "}),t.jsxs(U,{onClick:o,colorScheme:"red",disabled:n.size===0,children:["   (",n.size,")"]})]})]})},mj=({details:e,inventory:n,onClose:s,onAction:l})=>{const{materialName:r,craftType:a}=e,i=a==="upgrade",o=[" "," "," "," "," "],c=o.indexOf(r),d=r,u=i?o[c+1]:o[c-1],p=tn[d],m=tn[u],h=i?10:1,y=i?1:5,b=f.useMemo(()=>n.filter(k=>k.name===d).reduce((k,P)=>k+(P.quantity||0),0),[n,d]),j=Math.floor(b/h),[g,x]=f.useState(j>0?1:0),v=k=>{const P=parseInt(k.target.value,10);isNaN(P)?x(0):x(Math.max(0,Math.min(j,P)))},w=()=>{g>0&&l({type:"CRAFT_MATERIAL",payload:{materialName:r,craftType:a,quantity:g}}),s()};return t.jsx("div",{className:"absolute inset-0 bg-black/80 z-50 flex items-center justify-center",onClick:s,children:t.jsxs("div",{className:"bg-panel rounded-lg shadow-xl p-6 w-full max-w-md border border-color text-on-panel",onClick:k=>k.stopPropagation(),children:[t.jsx("h2",{className:"text-xl font-bold text-center mb-4",children:i?" ":" "}),t.jsxs("div",{className:"flex items-center justify-around text-center mb-4",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("img",{src:p.image,alt:d,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:d}),t.jsxs("span",{className:"text-xs text-tertiary mt-1",children:[": ",b.toLocaleString(),""]})]}),t.jsx("div",{className:"text-4xl font-bold text-highlight mx-4",children:""}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("img",{src:m.image,alt:u,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:u}),t.jsxs("span",{className:"text-sm text-green-400 mt-1",children:[": ",(g*y).toLocaleString(),""]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"quantity-slider",className:"block text-sm font-medium text-secondary text-center",children:[i?"":""," ",d,": ",t.jsxs("span",{className:"font-bold text-highlight",children:[(g*h).toLocaleString()," / ",b.toLocaleString()]}),""]}),t.jsx("input",{id:"quantity-slider",type:"range",min:"0",max:j,value:g,onChange:v,disabled:j===0,className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer"}),t.jsxs("div",{className:"flex justify-between text-xs text-tertiary",children:[t.jsx("span",{children:"0"}),t.jsxs("span",{children:[j,""]})]}),t.jsxs("p",{className:"text-center text-sm text-tertiary",children:[i?"":""," : ",g.toLocaleString(),""]})]}),t.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[t.jsx(U,{onClick:s,colorScheme:"gray",children:""}),t.jsxs(U,{onClick:w,colorScheme:i?"blue":"orange",disabled:g===0,children:[g," ",i?"":""]})]})]})})},fj=({onAction:e})=>{const{currentUserWithStatus:n}=De(),[s,l]=f.useState(null);if(!n)return null;const{inventory:r}=n,a=f.useMemo(()=>{const o={};return r.filter(c=>c.type==="material").forEach(c=>{o[c.name]||(o[c.name]=[]),o[c.name].push(c)}),o},[r]),i=[" "," "," "," "," "];return t.jsxs("div",{className:"h-full flex flex-col",children:[s&&t.jsx(mj,{details:s,inventory:r,onClose:()=>l(null),onAction:e}),t.jsxs("div",{className:"flex-grow p-4 overflow-y-auto",children:[t.jsx("h3",{className:"text-xl font-bold text-on-panel mb-4",children:" "}),t.jsx("p",{className:"text-sm text-tertiary mb-4",children:"         ."}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map((o,c)=>{const d=a[o]&&a[o].length>0,u=a[o]?a[o].reduce((y,b)=>y+(b.quantity||0),0):0,p=c<i.length-1,m=c>0,h=tn[o];return t.jsxs("div",{className:"bg-panel-secondary rounded-lg p-4 flex items-start space-x-4",children:[t.jsxs("div",{className:"flex flex-col items-center flex-shrink-0",children:[t.jsx("img",{src:h.image,alt:o,className:"w-16 h-16 mb-2"}),t.jsx("h4",{className:"font-bold text-secondary text-sm text-center leading-tight mb-1 w-full",children:o}),t.jsxs("p",{className:"text-xs text-tertiary text-center w-full",children:[": ",u.toLocaleString(),""]})]}),t.jsx("div",{className:"flex-grow flex flex-col justify-center",children:t.jsxs("div",{className:"flex flex-col space-y-2",children:[p&&t.jsx(U,{onClick:()=>l({materialName:o,craftType:"upgrade"}),colorScheme:"blue",className:"!text-xs !py-1 w-full",disabled:!d||u<10,children:""}),m&&t.jsx(U,{onClick:()=>l({materialName:o,craftType:"downgrade"}),colorScheme:"purple",className:"!text-xs !py-1 w-full",disabled:!d||u<1,children:""})]})})]},o)})})]})]})},xj={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},pj=e=>{if(e===0)return null;let n="",s="";return e>=10?(n="/images/equipments/Star4.png",s="prism-text-effect"):e>=7?(n="/images/equipments/Star3.png",s="text-purple-400"):e>=4?(n="/images/equipments/Star2.png",s="text-amber-400"):e>=1&&(n="/images/equipments/Star1.png",s="text-white"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:`font-bold text-xs leading-none ${s}`,children:e})]})},gj=({inventory:e,inventorySlots:n,onSelectItem:s,selectedItemId:l,disabledItemIds:r=[],selectedItemIdsForDisassembly:a,onToggleDisassemblySelection:i})=>{const o=Array.from({length:n},(c,d)=>e[d]||null);return t.jsx("div",{className:"grid grid-cols-10 gap-1 flex-grow pr-2 bg-tertiary/30 p-2 rounded-md",children:o.map((c,d)=>{const u=c?r.includes(c.id):!1;return t.jsx("div",{onClick:()=>{!c||u||(a&&i?i(c.id):s(c))},className:`relative aspect-square rounded-md transition-all duration-200 ${c?"hover:scale-105":"bg-tertiary/50"} ${u?"filter grayscale opacity-50 pointer-events-none":"cursor-pointer"}`,children:c?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`absolute inset-0 rounded-md border-2 ${l===c.id?"border-accent ring-2 ring-accent":"border-black/20"} ${a!=null&&a.has(c.id)?"bg-gray-700/70":""}`}),t.jsx("img",{src:xj[c.grade],alt:c.grade,className:"absolute inset-0 w-full h-full object-cover rounded-sm"}),c.image&&t.jsx("img",{src:c.image,alt:c.name,className:"relative w-full h-full object-contain p-1"}),pj(c.stars),c.isEquipped&&t.jsx("div",{className:"absolute top-0.5 right-0.5 text-xs font-bold text-white bg-blue-600/80 px-1 rounded-bl-md",children:"E"}),c.quantity&&c.quantity>1&&t.jsx("span",{className:"absolute bottom-0 right-0 text-xs font-bold text-white bg-black/60 px-1 rounded-tl-md",children:c.quantity}),(a==null?void 0:a.has(c.id))&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-800/70 rounded-md",children:t.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})]}):t.jsx("div",{className:"bg-tertiary/50 w-full h-full rounded-md"})},c?c.id:`empty-${d}`)})})},Ei=["normal","uncommon","rare","epic","legendary","mythic"],hj=({onClose:e,isTopmost:n,selectedItemForEnhancement:s,activeTab:l,onSetActiveTab:r,enhancementOutcome:a})=>{const{currentUserWithStatus:i,handlers:o,modals:c}=De(),[d,u]=f.useState(s),[p,m]=f.useState([null,null,null]),[h,y]=f.useState(new Set);if(!i)return null;f.useEffect(()=>{s&&(u(s),r("enhance"))},[s,r]),f.useEffect(()=>{m([null,null,null])},[l]),f.useEffect(()=>{l==="combine"&&m($=>$.map(z=>z&&i.inventory.find(W=>W.id===z.id)||null))},[i.inventory,l]);const b=f.useCallback($=>{if(l==="combine"){const q=p.findIndex(z=>z===null);if(q!==-1){const z=[...p];z[q]=$,m(z)}}else u($)},[l,p]),j=f.useCallback($=>{y(q=>{const z=new Set(q);return z.has($)?z.delete($):z.add($),z})},[]),{blacksmithLevel:g,blacksmithXp:x,inventory:v,inventorySlots:w}=i,k={normal:"",uncommon:"",rare:"",epic:"",legendary:"",mythic:""},P=g??1,S=P>=Cc,E=P-1,_=S?E:P,C=El[E],I=Ei.indexOf(C),R=f.useMemo(()=>{var z;if(l!=="combine")return[];const $=(z=p[0])==null?void 0:z.grade,q=p.map(W=>W==null?void 0:W.id).filter(Boolean);return v.filter(W=>!!(q.includes(W.id)||W.isEquipped||Ei.indexOf(W.grade)>I||$&&W.grade!==$)).map(W=>W.id)},[l,v,p,I]),A=[{id:"enhance",label:" "},{id:"combine",label:" "},{id:"disassemble",label:" "},{id:"convert",label:" "}],O=()=>{switch(l){case"enhance":return t.jsx(ej,{selectedItem:d,currentUser:i,onAction:o.handleAction,enhancementOutcome:a,onOutcomeConfirm:o.clearEnhancementOutcome});case"combine":return t.jsx(rj,{items:p,onRemoveItem:$=>{const q=[...p];q[$]=null,m(q)},onAction:o.handleAction,currentUser:i});case"disassemble":return t.jsx(uj,{onAction:o.handleAction,selectedForDisassembly:h,onToggleDisassemblySelection:j});case"convert":return t.jsx(fj,{onAction:o.handleAction});default:return null}},L=f.useMemo(()=>l==="enhance"||l==="combine"||l==="disassemble"?v.filter($=>$.type==="equipment"):l==="convert"?v.filter($=>$.type==="material"):v,[v,l]),Q=(()=>{const $=w||{};return l==="enhance"||l==="combine"||l==="disassemble"?$.equipment||30:l==="convert"&&$.material||30})(),D=f.useMemo(()=>l==="enhance"||l==="combine"||l==="disassemble"?"":l==="convert"?"":"",[l]);return t.jsxs(t.Fragment,{children:[t.jsx(be,{title:"",onClose:e,isTopmost:n&&!c.isBlacksmithHelpOpen,initialWidth:950,windowId:"blacksmith",children:t.jsxs("div",{className:"flex h-[700px]",children:[t.jsxs("div",{className:"w-1/3 bg-tertiary/30 p-4 flex flex-col items-center gap-4",children:[t.jsxs("div",{className:"w-full aspect-w-3 aspect-h-2 prism-border rounded-lg overflow-hidden relative",children:[t.jsx("img",{src:"/images/equipments/moru.png",alt:"Blacksmith",className:"w-full h-full object-cover"}),t.jsx("button",{onClick:o.openBlacksmithHelp,className:"absolute top-2 right-2 text-lg font-bold text-yellow-400 hover:text-yellow-300 bg-black/50 rounded-full w-8 h-8 flex items-center justify-center",children:"?"})]}),t.jsx("div",{className:"text-center",children:t.jsxs("h2",{className:"text-2xl font-bold",children:[" ",t.jsxs("span",{className:"text-yellow-400",children:["Lv.",g??1]})]})}),t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[t.jsx("span",{children:""}),t.jsxs("span",{children:[x??0," / ",ou(g??1)]})]}),t.jsx("div",{className:"w-full bg-black/50 rounded-full h-4 border-2 border-color",children:t.jsx("div",{className:"bg-yellow-500 h-full rounded-full",style:{width:`${(x??0)/ou(g??1)*100}%`}})})]}),t.jsxs("div",{className:"w-full text-left",children:[t.jsx("h3",{className:"font-bold mb-2 text-center",children:" "}),t.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400 px-2 pb-1 border-b border-gray-600 mb-1",children:[t.jsx("span",{children:""}),t.jsxs("span",{children:["Lv.",P,!S&&t.jsxs("span",{className:"text-yellow-400",children:["  Lv.",P+1]})]})]}),t.jsxs("div",{className:"text-xs text-secondary space-y-2",children:[t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[k[El[E]],!S&&t.jsxs("span",{className:"text-yellow-400",children:["  ",k[El[_]]]})]})]})}),t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[ya[E],"%",!S&&t.jsxs("span",{className:"text-yellow-400",children:["  ",ya[_],"%"]})]})]})}),t.jsxs("div",{className:"bg-black/20 p-2 rounded-md",children:[t.jsx("p",{className:"font-semibold",children:"  :"}),Ei.map($=>{var W,H;const q=((W=Ql[E])==null?void 0:W[$])??0,z=(H=Ql[_])==null?void 0:H[$];return t.jsxs("div",{className:"flex justify-between pl-2",children:[t.jsx("span",{children:k[$]}),t.jsxs("span",{children:[q,"%",!S&&z!==void 0&&t.jsxs("span",{className:"text-yellow-400",children:["  ",z,"%"]})]})]},$)})]})]})]})]}),t.jsxs("div",{className:"w-2/3 bg-primary p-4 flex flex-col",children:[t.jsx("div",{className:"flex border-b border-color mb-4",children:A.map($=>t.jsx("button",{onClick:()=>r($.id),className:`px-4 py-2 text-sm font-semibold ${l===$.id?"border-b-2 border-accent text-accent":"text-secondary hover:bg-secondary/20"}`,children:$.label},$.id))}),t.jsx("div",{className:"p-4 bg-tertiary/20 rounded-lg flex-1",children:O()}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:D}),t.jsx("div",{className:"h-[140px] overflow-y-auto pr-1",children:t.jsx(gj,{inventory:L,inventorySlots:Q,onSelectItem:b,selectedItemId:(d==null?void 0:d.id)||null,disabledItemIds:R,selectedItemIdsForDisassembly:l==="disassemble"?h:void 0,onToggleDisassemblySelection:l==="disassemble"?j:void 0})})]})]})]})}),t.jsx(Bx,{isOpen:!!c.disassemblyResult,onClose:o.closeDisassemblyResult,result:c.disassemblyResult})]})},Mi={normal:"",uncommon:"",rare:"",epic:"",legendary:"",mythic:""},yj=["normal","uncommon","rare","epic","legendary","mythic"],bj=({onClose:e,currentUser:n})=>{const{blacksmithLevel:s}=n,l=s??1,r=l>=Cc,a=l-1,i=r?a:l,o=()=>t.jsxs("div",{className:"w-full text-left",children:[t.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400 px-2 pb-1 border-b border-gray-600 mb-1",children:[t.jsx("span",{children:""}),t.jsxs("span",{children:["Lv.",l,!r&&t.jsxs("span",{className:"text-yellow-400",children:["  Lv.",l+1]})]})]}),t.jsxs("div",{className:"text-xs text-secondary space-y-2",children:[t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[Mi[El[a]],!r&&t.jsxs("span",{className:"text-yellow-400",children:["  ",Mi[El[i]]]})]})]})}),t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[ya[a],"%",!r&&t.jsxs("span",{className:"text-yellow-400",children:["  ",ya[i],"%"]})]})]})}),t.jsxs("div",{className:"bg-black/20 p-2 rounded-md",children:[t.jsx("p",{className:"font-semibold",children:"  :"}),yj.map(c=>{var p,m;const d=((p=Ql[a])==null?void 0:p[c])??0,u=(m=Ql[i])==null?void 0:m[c];return t.jsxs("div",{className:"flex justify-between pl-2",children:[t.jsx("span",{children:Mi[c]}),t.jsxs("span",{children:[d,"%",!r&&u!==void 0&&t.jsxs("span",{className:"text-yellow-400",children:["  ",u,"%"]})]})]},c)})]})]})]});return t.jsx(be,{title:" ",onClose:e,windowId:"blacksmith-help",initialWidth:500,zIndex:60,children:t.jsxs("div",{className:"space-y-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-accent mb-2",children:" "}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:[t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"    () .    ,     ."]}),t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"    3    .        ''   ."]}),t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"      ."]}),t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"       ."]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-accent mb-2",children:" "}),t.jsx("p",{className:"text-gray-300",children:"  (, , , )      ,    ."}),t.jsxs("div",{className:"text-xs text-gray-400 mt-2 space-y-1 bg-black/20 p-2 rounded-md",children:[t.jsxs("p",{children:[t.jsx("strong",{children:":"})," /    "]}),t.jsxs("p",{children:[t.jsx("strong",{children:":"}),"    "]}),t.jsxs("p",{children:[t.jsx("strong",{children:":"}),"    "]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-accent mb-2",children:"  "}),o()]})]})})},vj={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},jj=e=>{if(e===0)return null;let n="";return e>=10?n="/images/equipments/Star4.png":e>=7?n="/images/equipments/Star3.png":e>=4?n="/images/equipments/Star2.png":e>=1&&(n="/images/equipments/Star1.png"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:"font-bold text-xs leading-none",children:e})]})},wj=({item:e})=>{var s,l,r,a;const n=vj[e.grade];return t.jsxs("div",{className:"flex flex-col w-full h-full p-1 bg-black/20 rounded-lg",children:[t.jsxs("div",{className:"flex mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0 mr-3",children:[t.jsx("img",{src:n.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),jj(e.stars)]}),t.jsxs("div",{className:"flex-grow overflow-hidden pt-2",children:[t.jsx("h3",{className:`text-lg font-bold truncate ${n.color}`,children:e.name}),((s=e.options)==null?void 0:s.main)&&t.jsx("p",{className:"font-semibold text-yellow-300 text-sm truncate",children:e.options.main.display})]})]}),t.jsxs("div",{className:"w-full text-sm text-left space-y-1 bg-black/30 p-2 rounded-lg flex-grow overflow-y-auto",children:[((l=e.options)==null?void 0:l.combatSubs)&&e.options.combatSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.combatSubs.map((i,o)=>t.jsx("p",{className:"text-blue-300",children:i.display},`c-${o}`))}),((r=e.options)==null?void 0:r.specialSubs)&&e.options.specialSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.specialSubs.map((i,o)=>t.jsx("p",{className:"text-green-300",children:i.display},`s-${o}`))}),((a=e.options)==null?void 0:a.mythicSubs)&&e.options.mythicSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.mythicSubs.map((i,o)=>t.jsx("p",{className:"text-red-400",children:i.display},`m-${o}`))})]})]})},Nj=({result:e,onClose:n})=>{const{item:s,xpGained:l,isGreatSuccess:r}=e;return t.jsx(be,{title:r?" !":" ",onClose:n,windowId:"combination-result",initialWidth:400,children:t.jsxs("div",{className:"text-center flex flex-col items-center",children:[t.jsx("div",{className:"w-full max-w-xs",children:t.jsx(wj,{item:s})}),t.jsx("div",{className:"mt-4 bg-gray-900/50 p-4 rounded-lg text-lg w-full max-w-xs",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/equipments/moru.png",alt:" ",className:"w-5 h-5"}),"  :"]}),t.jsxs("span",{className:"font-bold text-orange-400",children:["+",l.toLocaleString()]})]})}),t.jsx(U,{onClick:n,className:"w-full mt-6 py-2.5 max-w-xs",children:""})]})})},Yu=({item:e})=>t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("div",{className:"relative w-20 h-20 mb-2",children:[t.jsx("img",{src:Ba[e.grade],alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 text-center text-xs font-bold text-white bg-black/50 py-0.5",children:t.jsxs("span",{className:"text-white",children:["",e.stars]})})]}),t.jsx("p",{className:`font-bold ${Pl[e.grade].color}`,children:e.name})]}),kj=({result:e,onClose:n,isTopmost:s})=>{const l=e.success?" !":" !",r=e.success?"text-green-400":"text-red-400";return t.jsx(be,{title:l,onClose:n,windowId:"enhancementResult",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"p-4 text-center",children:[t.jsx("h3",{className:`text-xl font-bold mb-4 ${r}`,children:e.message}),t.jsxs("div",{className:"flex justify-around items-center mb-4",children:[t.jsx(Yu,{item:e.itemBefore}),t.jsx("span",{className:"text-2xl font-bold mx-4",children:e.success?"->":"X"}),t.jsx(Yu,{item:e.itemAfter})]}),t.jsx("button",{onClick:n,className:"mt-4 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-md",children:""})]})})},Rr=({title:e,color:n,children:s})=>{const l=Mn.Children.toArray(s).filter(Boolean);return t.jsxs("div",{className:"flex-1 bg-gray-800/30 p-2 rounded-md flex flex-col min-h-0",children:[t.jsx("h4",{className:`text-center font-semibold mb-1 text-sm flex-shrink-0 ${n}`,children:e}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-1 space-y-1 text-xs",children:l.length>0?l:t.jsx("p",{className:"text-xs text-gray-400 text-center",children:" "})})]})},Sj=(e,n)=>{const s=fx[e].description;switch(e){case ct.StrategicGoldBonus:case ct.PlayfulGoldBonus:{const l=20*n.count;return t.jsx("span",{className:"w-full",children:s.replace(/20%/,`${l}%`)})}case ct.MannerActionCooldown:return t.jsxs("div",{className:"flex justify-between items-center w-full",children:[t.jsx("span",{children:s}),t.jsxs("span",{className:"font-mono font-semibold",children:["+",n.totalValue]})]});case ct.DiceGoOddBonus:case ct.AlkkagiSlowBonus:case ct.AlkkagiAimingBonus:return t.jsx("span",{className:"w-full",children:s.replace(/1/g,`${n.totalValue}`)});default:return t.jsx("span",{className:"w-full",children:s})}},Cj=({onClose:e,isTopmost:n,mainOptionBonuses:s,combatSubOptionBonuses:l,specialStatBonuses:r,aggregatedMythicStats:a})=>{const i={[N.Concentration]:"",[N.ThinkingSpeed]:"",[N.Judgment]:"",[N.Calculation]:"",[N.CombatPower]:"",[N.Stability]:""},o={[Fe.ActionPointMax]:" AP",[Fe.ActionPointRegen]:"AP ",[Fe.StrategyXpBonus]:" XP",[Fe.PlayfulXpBonus]:" XP",[Fe.GoldBonus]:" ",[Fe.ItemDropRate]:" ",[Fe.MaterialDropRate]:" "};return t.jsx(be,{title:"  ",onClose:e,windowId:"equipment-effects",initialWidth:600,isTopmost:n,children:t.jsxs("div",{className:"flex flex-col gap-4 p-2",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsx(Rr,{title:" ",color:"text-yellow-300",children:Object.values(N).map(c=>{const d=s[c],u=d?`+${d.value.toFixed(d.isPercentage?1:0).replace(/\.0$/,"")}${d.isPercentage?"%":""}`:"+0";return t.jsxs("div",{className:"flex justify-between items-baseline",children:[t.jsx("span",{className:"text-gray-300",children:i[c]||c}),t.jsx("span",{className:`font-mono font-semibold text-right ${d?"":"text-gray-400"}`,children:u})]},c)})}),t.jsx(Rr,{title:"  ",color:"text-blue-300",children:Object.values(N).map(c=>{const d=l[c],u=d?`+${d.value.toFixed(d.isPercentage?1:0).replace(/\.0$/,"")}${d.isPercentage?"%":""}`:"+0";return t.jsxs("div",{className:"flex justify-between items-baseline",children:[t.jsx("span",{className:"text-gray-300",children:i[c]||c}),t.jsx("span",{className:`font-mono font-semibold text-right ${d?"":"text-gray-400"}`,children:u})]},c)})})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsx(Rr,{title:"  ",color:"text-green-300",children:Object.entries(r).map(([c,d])=>{if(d.flat===0&&d.percent===0)return null;const u=c,p=mx[u].name,m=o[u];return t.jsxs("div",{className:"flex justify-between items-baseline",title:p,children:[t.jsx("span",{className:"text-gray-300 truncate",children:m}),t.jsxs("span",{className:"font-mono font-semibold text-right text-green-300",children:[d.flat>0&&`+${d.flat.toFixed(0)}`,d.percent>0&&(d.flat>0?", ":"")+`+${d.percent.toFixed(1)}%`]})]},c)})}),t.jsx(Rr,{title:"  ",color:"text-red-400",children:Object.entries(a).map(([c,d])=>d.count===0?null:t.jsx("div",{className:"text-red-300 text-[10px] leading-tight",children:Sj(c,d)},c))})]})]})})};function Ij(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const Pj=()=>{const{currentUser:e,currentUserWithStatus:n,currentRoute:s,error:l,activeNegotiation:r,modals:a,showExitToast:i,enhancementResult:o,enhancementOutcome:c,handlers:d,onlineUsers:u,hasClaimableQuest:p,settings:m,mainOptionBonuses:h,combatSubOptionBonuses:y,specialStatBonuses:b,aggregatedMythicStats:j}=De(),[g,x]=f.useState(!0),[v,w]=f.useState(!1),k=Ij(p);f.useEffect(()=>{if(m.features.questNotifications&&p&&!k){w(!0);const C=setTimeout(()=>w(!1),3e3);return()=>clearTimeout(C)}},[p,k,m.features.questNotifications]),f.useEffect(()=>{if(v){const C=setTimeout(()=>w(!1),3e3);return()=>clearTimeout(C)}},[v]),f.useEffect(()=>{const C=()=>{Pe.initialize(),document.removeEventListener("pointerdown",C)};return document.addEventListener("pointerdown",C),()=>{document.removeEventListener("pointerdown",C)}},[]),f.useEffect(()=>{e?Wv(Gv).then(()=>{x(!1)}):x(!1)},[e]);const P=f.useMemo(()=>{const C=[];return r&&C.push("negotiation"),a.isSettingsModalOpen&&C.push("settings"),a.isInventoryOpen&&C.push("inventory"),a.isMailboxOpen&&C.push("mailbox"),a.isQuestsOpen&&C.push("quests"),a.rewardSummary&&C.push("rewardSummary"),a.isClaimAllSummaryOpen&&C.push("claimAllSummary"),a.isShopOpen&&C.push("shop"),a.lastUsedItemResult&&C.push("itemObtained"),a.disassemblyResult&&C.push("disassemblyResult"),a.craftResult&&C.push("craftResult"),a.viewingUser&&C.push("viewingUser"),a.isInfoModalOpen&&C.push("infoModal"),a.isEncyclopediaOpen&&C.push("encyclopedia"),a.isStatAllocationModalOpen&&C.push("statAllocation"),a.isProfileEditModalOpen&&C.push("profileEdit"),a.pastRankingsInfo&&C.push("pastRankings"),a.moderatingUser&&C.push("moderatingUser"),a.viewingItem&&C.push("viewingItem"),a.enhancingItem&&C.push("enhancingItem"),a.isBlacksmithModalOpen&&C.push("blacksmith"),a.combinationResult&&C.push("combinationResult"),C},[a,r]),S=P.length>0?P[P.length-1]:null,E=s.view==="game",_=e?"bg-primary":"bg-login-background";return t.jsxs("div",{className:`font-sans ${_} text-primary h-full flex flex-col`,children:[g&&t.jsxs("div",{className:"fixed inset-0 bg-tertiary z-[100] flex flex-col items-center justify-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-primary"}),t.jsx("p",{className:"mt-4 text-primary",children:"  ..."})]}),l&&t.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 w-full max-w-md z-50 animate-slide-down",children:t.jsx("div",{className:"bg-danger border-2 border-red-500 rounded-lg shadow-2xl p-4 text-white font-bold text-center",children:l})}),v&&t.jsx("div",{onClick:()=>{d.openQuests(),w(!1)},className:"fixed top-20 right-4 w-full max-w-xs z-50 animate-slide-in-right cursor-pointer",children:t.jsx("div",{className:"bg-success border-2 border-green-400 rounded-lg shadow-2xl p-4 text-white font-bold text-center",children:"   !"})}),o&&!a.enhancingItem&&t.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 w-full max-w-md z-50 animate-slide-down",children:t.jsx("div",{className:`${o.success?"bg-accent border-accent":"bg-danger border-red-500"} border-2 rounded-lg shadow-2xl p-4 text-white font-bold text-center`,children:o.message})}),i&&t.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 w-full max-w-md z-50 animate-slide-down-fast",children:t.jsx("div",{className:"bg-primary border-2 border-color rounded-lg shadow-2xl p-3 text-primary font-semibold text-center",children:"     ."})}),e&&!E&&t.jsx(D0,{}),e?t.jsx("main",{className:"flex-1 flex flex-col min-h-0",children:t.jsx(zu,{})}):t.jsxs("div",{className:"relative h-full w-full flex flex-col items-center justify-center p-4 sm:p-8 bg-tertiary bg-[url('/images/bg/loginbg.png')] bg-cover bg-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60"}),t.jsxs("header",{className:"relative text-center z-10 pt-8 md:pt-16 mb-8",children:[t.jsx("h1",{className:"text-4xl sm:text-5xl md:text-6xl font-black text-white tracking-widest uppercase title-glow-secondary",style:{fontFamily:"serif"},children:"SUDAM"}),t.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white tracking-wider mt-2 title-glow-secondary",style:{fontFamily:"serif"},children:"The Ascending Masters"}),t.jsxs("p",{className:"mt-4 text-xs sm:text-sm text-gray-300",children:["Supreme Universe of Dueling Ascending Masters (S.U.D.A.M)",t.jsx("br",{}),"(    )"]})]}),t.jsx("main",{className:"relative flex-1 flex flex-col min-h-0 z-10",children:t.jsx(zu,{})})]}),n&&t.jsxs(t.Fragment,{children:[a.isSettingsModalOpen&&t.jsx(Qv,{onClose:d.closeSettingsModal,isTopmost:S==="settings"}),a.isInventoryOpen&&t.jsx(cv,{currentUser:n,onClose:d.closeInventory,onAction:d.handleAction,onStartEnhance:d.openEnhancingItem,enhancementAnimationTarget:a.enhancementAnimationTarget,onAnimationComplete:d.clearEnhancementAnimation,isTopmost:S==="inventory"}),a.isMailboxOpen&&t.jsx(mv,{currentUser:n,onClose:d.closeMailbox,onAction:d.handleAction,isTopmost:S==="mailbox"}),a.isQuestsOpen&&t.jsx(xv,{currentUser:n,onClose:d.closeQuests,onAction:d.handleAction,isTopmost:S==="quests"}),a.rewardSummary&&t.jsx(qv,{summary:a.rewardSummary,onClose:d.closeRewardSummary,isTopmost:S==="rewardSummary"}),a.isClaimAllSummaryOpen&&a.claimAllSummary&&t.jsx(Qu,{summary:a.claimAllSummary,onClose:d.closeClaimAllSummary,isTopmost:S==="claimAllSummary"}),a.isShopOpen&&t.jsx(yv,{currentUser:n,onClose:d.closeShop,onAction:d.handleAction,isTopmost:S==="shop"}),a.lastUsedItemResult&&a.lastUsedItemResult.length===1&&t.jsx(Av,{item:a.lastUsedItemResult[0],onClose:d.closeItemObtained,isTopmost:S==="itemObtained"}),a.lastUsedItemResult&&a.lastUsedItemResult.length>1&&t.jsx($v,{items:a.lastUsedItemResult,onClose:d.closeItemObtained,isTopmost:S==="itemObtained"}),a.disassemblyResult&&t.jsx(Bx,{result:a.disassemblyResult,onClose:d.closeDisassemblyResult,isTopmost:S==="disassemblyResult"}),a.craftResult&&t.jsx(Hv,{result:a.craftResult,onClose:d.closeCraftResult,isTopmost:S==="craftResult"}),a.viewingUser&&t.jsx(wv,{user:a.viewingUser,onClose:d.closeViewingUser,onViewItem:d.openViewingItem,isTopmost:S==="viewingUser"}),a.isInfoModalOpen&&t.jsx(Nv,{onClose:d.closeInfoModal,isTopmost:S==="infoModal"}),a.isEncyclopediaOpen&&t.jsx(Bv,{onClose:d.closeEncyclopedia,isTopmost:S==="encyclopedia"}),a.isStatAllocationModalOpen&&t.jsx(kv,{currentUser:n,onClose:d.closeStatAllocationModal,onAction:d.handleAction,isTopmost:S==="statAllocation"}),a.isProfileEditModalOpen&&t.jsx(Pv,{currentUser:n,onClose:d.closeProfileEditModal,onAction:d.handleAction,isTopmost:S==="profileEdit"}),a.pastRankingsInfo&&t.jsx(Ov,{info:a.pastRankingsInfo,onClose:d.closePastRankings,isTopmost:S==="pastRankings"}),a.moderatingUser&&t.jsx(Dv,{user:a.moderatingUser,currentUser:n,onClose:d.closeModerationModal,onAction:d.handleAction,isTopmost:S==="moderatingUser"}),a.viewingItem&&t.jsx(Iv,{item:a.viewingItem.item,isOwnedByCurrentUser:a.viewingItem.isOwnedByCurrentUser,onClose:d.closeViewingItem,onStartEnhance:d.openEnhancementFromDetail,isTopmost:S==="viewingItem"}),r&&t.jsx(Mx,{negotiation:r,currentUser:n,onAction:d.handleAction,onlineUsers:u,isTopmost:S==="negotiation"}),a.isMbtiInfoModalOpen&&t.jsx(Io,{onClose:d.closeMbtiInfoModal,isTopmost:S==="mbtiInfo"}),a.isBlacksmithModalOpen&&t.jsx(hj,{onClose:d.closeBlacksmithModal,isTopmost:S==="blacksmith",selectedItemForEnhancement:a.blacksmithSelectedItemForEnhancement,activeTab:a.blacksmithActiveTab,onSetActiveTab:d.setBlacksmithActiveTab,enhancementOutcome:c}),a.combinationResult&&t.jsx(Nj,{result:a.combinationResult,onClose:d.closeCombinationResult,isTopmost:S==="combinationResult"}),a.isBlacksmithHelpOpen&&t.jsx(bj,{onClose:d.closeBlacksmithHelp,isTopmost:S==="blacksmithHelp",currentUser:n}),a.isEnhancementResultModalOpen&&c&&t.jsx(kj,{result:c,onClose:d.closeEnhancementModal,isTopmost:S==="enhancementResult"}),a.isClaimAllSummaryOpen&&a.claimAllSummary&&t.jsx(Qu,{summary:a.claimAllSummary,onClose:d.closeClaimAllSummary,isTopmost:S==="claimAllSummary"}),a.isMbtiInfoModalOpen&&t.jsx(Io,{onClose:d.closeMbtiInfoModal,isTopmost:S==="mbtiInfo"}),a.isEquipmentEffectsModalOpen&&t.jsx(Cj,{onClose:d.closeEquipmentEffectsModal,isTopmost:S==="equipmentEffects",mainOptionBonuses:h,combatSubOptionBonuses:y,specialStatBonuses:b,aggregatedMythicStats:j})]})]})},Ej=()=>t.jsx("div",{className:"app-container",children:t.jsx(B0,{children:t.jsx(Pj,{})})}),qx=document.getElementById("root");if(!qx)throw new Error("Could not find root element to mount to");const Mj=Ti.createRoot(qx);Mj.render(t.jsx(Mn.StrictMode,{children:t.jsx(Ej,{})}));
