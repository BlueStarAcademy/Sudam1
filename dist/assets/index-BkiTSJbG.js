var mp=Object.defineProperty;var fp=(e,n,s)=>n in e?mp(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s;var Tn=(e,n,s)=>fp(e,typeof n!="symbol"?n+"":n,s);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();function xp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ku={exports:{}},va={},Ju={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zl=Symbol.for("react.element"),pp=Symbol.for("react.portal"),gp=Symbol.for("react.fragment"),hp=Symbol.for("react.strict_mode"),yp=Symbol.for("react.profiler"),bp=Symbol.for("react.provider"),vp=Symbol.for("react.context"),jp=Symbol.for("react.forward_ref"),wp=Symbol.for("react.suspense"),Np=Symbol.for("react.memo"),Sp=Symbol.for("react.lazy"),Ic=Symbol.iterator;function kp(e){return e===null||typeof e!="object"?null:(e=Ic&&e[Ic]||e["@@iterator"],typeof e=="function"?e:null)}var Qu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yu=Object.assign,Xu={};function nl(e,n,s){this.props=e,this.context=n,this.refs=Xu,this.updater=s||Qu}nl.prototype.isReactComponent={};nl.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};nl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Zu(){}Zu.prototype=nl.prototype;function Co(e,n,s){this.props=e,this.context=n,this.refs=Xu,this.updater=s||Qu}var Io=Co.prototype=new Zu;Io.constructor=Co;Yu(Io,nl.prototype);Io.isPureReactComponent=!0;var Ec=Array.isArray,em=Object.prototype.hasOwnProperty,Eo={current:null},tm={key:!0,ref:!0,__self:!0,__source:!0};function nm(e,n,s){var l,r={},a=null,i=null;if(n!=null)for(l in n.ref!==void 0&&(i=n.ref),n.key!==void 0&&(a=""+n.key),n)em.call(n,l)&&!tm.hasOwnProperty(l)&&(r[l]=n[l]);var o=arguments.length-2;if(o===1)r.children=s;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(l in o=e.defaultProps,o)r[l]===void 0&&(r[l]=o[l]);return{$$typeof:Zl,type:e,key:a,ref:i,props:r,_owner:Eo.current}}function Cp(e,n){return{$$typeof:Zl,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function Po(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zl}function Ip(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return n[s]})}var Pc=/\/+/g;function Va(e,n){return typeof e=="object"&&e!==null&&e.key!=null?Ip(""+e.key):n.toString(36)}function Ar(e,n,s,l,r){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Zl:case pp:i=!0}}if(i)return i=e,r=r(i),e=l===""?"."+Va(i,0):l,Ec(r)?(s="",e!=null&&(s=e.replace(Pc,"$&/")+"/"),Ar(r,n,s,"",function(d){return d})):r!=null&&(Po(r)&&(r=Cp(r,s+(!r.key||i&&i.key===r.key?"":(""+r.key).replace(Pc,"$&/")+"/")+e)),n.push(r)),1;if(i=0,l=l===""?".":l+":",Ec(e))for(var o=0;o<e.length;o++){a=e[o];var c=l+Va(a,o);i+=Ar(a,n,s,c,r)}else if(c=kp(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=l+Va(a,o++),i+=Ar(a,n,s,c,r);else if(a==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return i}function ir(e,n,s){if(e==null)return e;var l=[],r=0;return Ar(e,l,"","",function(a){return n.call(s,a,r++)}),l}function Ep(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var Pt={current:null},Rr={transition:null},Pp={ReactCurrentDispatcher:Pt,ReactCurrentBatchConfig:Rr,ReactCurrentOwner:Eo};function sm(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:ir,forEach:function(e,n,s){ir(e,function(){n.apply(this,arguments)},s)},count:function(e){var n=0;return ir(e,function(){n++}),n},toArray:function(e){return ir(e,function(n){return n})||[]},only:function(e){if(!Po(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Le.Component=nl;Le.Fragment=gp;Le.Profiler=yp;Le.PureComponent=Co;Le.StrictMode=hp;Le.Suspense=wp;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pp;Le.act=sm;Le.cloneElement=function(e,n,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=Yu({},e.props),r=e.key,a=e.ref,i=e._owner;if(n!=null){if(n.ref!==void 0&&(a=n.ref,i=Eo.current),n.key!==void 0&&(r=""+n.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in n)em.call(n,c)&&!tm.hasOwnProperty(c)&&(l[c]=n[c]===void 0&&o!==void 0?o[c]:n[c])}var c=arguments.length-2;if(c===1)l.children=s;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];l.children=o}return{$$typeof:Zl,type:e.type,key:r,ref:a,props:l,_owner:i}};Le.createContext=function(e){return e={$$typeof:vp,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:bp,_context:e},e.Consumer=e};Le.createElement=nm;Le.createFactory=function(e){var n=nm.bind(null,e);return n.type=e,n};Le.createRef=function(){return{current:null}};Le.forwardRef=function(e){return{$$typeof:jp,render:e}};Le.isValidElement=Po;Le.lazy=function(e){return{$$typeof:Sp,_payload:{_status:-1,_result:e},_init:Ep}};Le.memo=function(e,n){return{$$typeof:Np,type:e,compare:n===void 0?null:n}};Le.startTransition=function(e){var n=Rr.transition;Rr.transition={};try{e()}finally{Rr.transition=n}};Le.unstable_act=sm;Le.useCallback=function(e,n){return Pt.current.useCallback(e,n)};Le.useContext=function(e){return Pt.current.useContext(e)};Le.useDebugValue=function(){};Le.useDeferredValue=function(e){return Pt.current.useDeferredValue(e)};Le.useEffect=function(e,n){return Pt.current.useEffect(e,n)};Le.useId=function(){return Pt.current.useId()};Le.useImperativeHandle=function(e,n,s){return Pt.current.useImperativeHandle(e,n,s)};Le.useInsertionEffect=function(e,n){return Pt.current.useInsertionEffect(e,n)};Le.useLayoutEffect=function(e,n){return Pt.current.useLayoutEffect(e,n)};Le.useMemo=function(e,n){return Pt.current.useMemo(e,n)};Le.useReducer=function(e,n,s){return Pt.current.useReducer(e,n,s)};Le.useRef=function(e){return Pt.current.useRef(e)};Le.useState=function(e){return Pt.current.useState(e)};Le.useSyncExternalStore=function(e,n,s){return Pt.current.useSyncExternalStore(e,n,s)};Le.useTransition=function(){return Pt.current.useTransition()};Le.version="18.3.1";Ju.exports=Le;var f=Ju.exports;const Pn=xp(f);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mp=f,Tp=Symbol.for("react.element"),_p=Symbol.for("react.fragment"),Ap=Object.prototype.hasOwnProperty,Rp=Mp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Bp={key:!0,ref:!0,__self:!0,__source:!0};function lm(e,n,s){var l,r={},a=null,i=null;s!==void 0&&(a=""+s),n.key!==void 0&&(a=""+n.key),n.ref!==void 0&&(i=n.ref);for(l in n)Ap.call(n,l)&&!Bp.hasOwnProperty(l)&&(r[l]=n[l]);if(e&&e.defaultProps)for(l in n=e.defaultProps,n)r[l]===void 0&&(r[l]=n[l]);return{$$typeof:Tp,type:e,key:a,ref:i,props:r,_owner:Rp.current}}va.Fragment=_p;va.jsx=lm;va.jsxs=lm;Ku.exports=va;var t=Ku.exports,Pi={},rm={exports:{}},zt={},am={exports:{}},im={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(L,q){var U=L.length;L.push(q);e:for(;0<U;){var W=U-1>>>1,H=L[W];if(0<r(H,q))L[W]=q,L[U]=H,U=W;else break e}}function s(L){return L.length===0?null:L[0]}function l(L){if(L.length===0)return null;var q=L[0],U=L.pop();if(U!==q){L[0]=U;e:for(var W=0,H=L.length,te=H>>>1;W<te;){var le=2*(W+1)-1,ce=L[le],ve=le+1,F=L[ve];if(0>r(ce,U))ve<H&&0>r(F,ce)?(L[W]=F,L[ve]=U,W=ve):(L[W]=ce,L[le]=U,W=le);else if(ve<H&&0>r(F,U))L[W]=F,L[ve]=U,W=ve;else break e}}return q}function r(L,q){var U=L.sortIndex-q.sortIndex;return U!==0?U:L.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],d=[],u=1,p=null,m=3,h=!1,y=!1,b=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(L){for(var q=s(d);q!==null;){if(q.callback===null)l(d);else if(q.startTime<=L)l(d),q.sortIndex=q.expirationTime,n(c,q);else break;q=s(d)}}function w(L){if(b=!1,j(L),!y)if(s(c)!==null)y=!0,V(S);else{var q=s(d);q!==null&&D(w,q.startTime-L)}}function S(L,q){y=!1,b&&(b=!1,g(M),M=-1),h=!0;var U=m;try{for(j(q),p=s(c);p!==null&&(!(p.expirationTime>q)||L&&!I());){var W=p.callback;if(typeof W=="function"){p.callback=null,m=p.priorityLevel;var H=W(p.expirationTime<=q);q=e.unstable_now(),typeof H=="function"?p.callback=H:p===s(c)&&l(c),j(q)}else l(c);p=s(c)}if(p!==null)var te=!0;else{var le=s(d);le!==null&&D(w,le.startTime-q),te=!1}return te}finally{p=null,m=U,h=!1}}var C=!1,k=null,M=-1,_=5,E=-1;function I(){return!(e.unstable_now()-E<_)}function R(){if(k!==null){var L=e.unstable_now();E=L;var q=!0;try{q=k(!0,L)}finally{q?A():(C=!1,k=null)}}else C=!1}var A;if(typeof x=="function")A=function(){x(R)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,B=O.port2;O.port1.onmessage=R,A=function(){B.postMessage(null)}}else A=function(){v(R,0)};function V(L){k=L,C||(C=!0,A())}function D(L,q){M=v(function(){L(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,V(S))},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return s(c)},e.unstable_next=function(L){switch(m){case 1:case 2:case 3:var q=3;break;default:q=m}var U=m;m=q;try{return L()}finally{m=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(L,q){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var U=m;m=L;try{return q()}finally{m=U}},e.unstable_scheduleCallback=function(L,q,U){var W=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?W+U:W):U=W,L){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=U+H,L={id:u++,callback:q,priorityLevel:L,startTime:U,expirationTime:H,sortIndex:-1},U>W?(L.sortIndex=U,n(d,L),s(c)===null&&L===s(d)&&(b?(g(M),M=-1):b=!0,D(w,U-W))):(L.sortIndex=H,n(c,L),y||h||(y=!0,V(S))),L},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(L){var q=m;return function(){var U=m;m=q;try{return L.apply(this,arguments)}finally{m=U}}}})(im);am.exports=im;var Lp=am.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $p=f,Ut=Lp;function ne(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var om=new Set,Tl={};function bs(e,n){Hs(e,n),Hs(e+"Capture",n)}function Hs(e,n){for(Tl[e]=n,e=0;e<n.length;e++)om.add(n[e])}var Sn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mi=Object.prototype.hasOwnProperty,Op=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mc={},Tc={};function Dp(e){return Mi.call(Tc,e)?!0:Mi.call(Mc,e)?!1:Op.test(e)?Tc[e]=!0:(Mc[e]=!0,!1)}function qp(e,n,s,l){if(s!==null&&s.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return l?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Up(e,n,s,l){if(n===null||typeof n>"u"||qp(e,n,s,l))return!0;if(l)return!1;if(s!==null)switch(s.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Mt(e,n,s,l,r,a,i){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=l,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=n,this.sanitizeURL=a,this.removeEmptyString=i}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){bt[e]=new Mt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];bt[n]=new Mt(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){bt[e]=new Mt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){bt[e]=new Mt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){bt[e]=new Mt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){bt[e]=new Mt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){bt[e]=new Mt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){bt[e]=new Mt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){bt[e]=new Mt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Mo=/[\-:]([a-z])/g;function To(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(Mo,To);bt[n]=new Mt(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(Mo,To);bt[n]=new Mt(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(Mo,To);bt[n]=new Mt(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){bt[e]=new Mt(e,1,!1,e.toLowerCase(),null,!1,!1)});bt.xlinkHref=new Mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){bt[e]=new Mt(e,1,!1,e.toLowerCase(),null,!0,!0)});function _o(e,n,s,l){var r=bt.hasOwnProperty(n)?bt[n]:null;(r!==null?r.type!==0:l||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(Up(n,s,r,l)&&(s=null),l||r===null?Dp(n)&&(s===null?e.removeAttribute(n):e.setAttribute(n,""+s)):r.mustUseProperty?e[r.propertyName]=s===null?r.type===3?!1:"":s:(n=r.attributeName,l=r.attributeNamespace,s===null?e.removeAttribute(n):(r=r.type,s=r===3||r===4&&s===!0?"":""+s,l?e.setAttributeNS(l,n,s):e.setAttribute(n,s))))}var Mn=$p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,or=Symbol.for("react.element"),Es=Symbol.for("react.portal"),Ps=Symbol.for("react.fragment"),Ao=Symbol.for("react.strict_mode"),Ti=Symbol.for("react.profiler"),cm=Symbol.for("react.provider"),dm=Symbol.for("react.context"),Ro=Symbol.for("react.forward_ref"),_i=Symbol.for("react.suspense"),Ai=Symbol.for("react.suspense_list"),Bo=Symbol.for("react.memo"),$n=Symbol.for("react.lazy"),um=Symbol.for("react.offscreen"),_c=Symbol.iterator;function il(e){return e===null||typeof e!="object"?null:(e=_c&&e[_c]||e["@@iterator"],typeof e=="function"?e:null)}var st=Object.assign,Ka;function pl(e){if(Ka===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);Ka=n&&n[1]||""}return`
`+Ka+e}var Ja=!1;function Qa(e,n){if(!e||Ja)return"";Ja=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(d){var l=d}Reflect.construct(e,[],n)}else{try{n.call()}catch(d){l=d}e.call(n.prototype)}else{try{throw Error()}catch(d){l=d}e()}}catch(d){if(d&&l&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),a=l.stack.split(`
`),i=r.length-1,o=a.length-1;1<=i&&0<=o&&r[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(r[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||r[i]!==a[o]){var c=`
`+r[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{Ja=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?pl(e):""}function zp(e){switch(e.tag){case 5:return pl(e.type);case 16:return pl("Lazy");case 13:return pl("Suspense");case 19:return pl("SuspenseList");case 0:case 2:case 15:return e=Qa(e.type,!1),e;case 11:return e=Qa(e.type.render,!1),e;case 1:return e=Qa(e.type,!0),e;default:return""}}function Ri(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ps:return"Fragment";case Es:return"Portal";case Ti:return"Profiler";case Ao:return"StrictMode";case _i:return"Suspense";case Ai:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dm:return(e.displayName||"Context")+".Consumer";case cm:return(e._context.displayName||"Context")+".Provider";case Ro:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Bo:return n=e.displayName||null,n!==null?n:Ri(e.type)||"Memo";case $n:n=e._payload,e=e._init;try{return Ri(e(n))}catch{}}return null}function Fp(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ri(n);case 8:return n===Ao?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Xn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function mm(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Gp(e){var n=mm(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),l=""+e[n];if(!e.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var r=s.get,a=s.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return r.call(this)},set:function(i){l=""+i,a.call(this,i)}}),Object.defineProperty(e,n,{enumerable:s.enumerable}),{getValue:function(){return l},setValue:function(i){l=""+i},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function cr(e){e._valueTracker||(e._valueTracker=Gp(e))}function fm(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var s=n.getValue(),l="";return e&&(l=mm(e)?e.checked?"true":"false":e.value),e=l,e!==s?(n.setValue(e),!0):!1}function Wr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Bi(e,n){var s=n.checked;return st({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Ac(e,n){var s=n.defaultValue==null?"":n.defaultValue,l=n.checked!=null?n.checked:n.defaultChecked;s=Xn(n.value!=null?n.value:s),e._wrapperState={initialChecked:l,initialValue:s,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function xm(e,n){n=n.checked,n!=null&&_o(e,"checked",n,!1)}function Li(e,n){xm(e,n);var s=Xn(n.value),l=n.type;if(s!=null)l==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?$i(e,n.type,s):n.hasOwnProperty("defaultValue")&&$i(e,n.type,Xn(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function Rc(e,n,s){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var l=n.type;if(!(l!=="submit"&&l!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,s||n===e.value||(e.value=n),e.defaultValue=n}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function $i(e,n,s){(n!=="number"||Wr(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var gl=Array.isArray;function qs(e,n,s,l){if(e=e.options,n){n={};for(var r=0;r<s.length;r++)n["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=n.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&l&&(e[s].defaultSelected=!0)}else{for(s=""+Xn(s),n=null,r=0;r<e.length;r++){if(e[r].value===s){e[r].selected=!0,l&&(e[r].defaultSelected=!0);return}n!==null||e[r].disabled||(n=e[r])}n!==null&&(n.selected=!0)}}function Oi(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(ne(91));return st({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Bc(e,n){var s=n.value;if(s==null){if(s=n.children,n=n.defaultValue,s!=null){if(n!=null)throw Error(ne(92));if(gl(s)){if(1<s.length)throw Error(ne(93));s=s[0]}n=s}n==null&&(n=""),s=n}e._wrapperState={initialValue:Xn(s)}}function pm(e,n){var s=Xn(n.value),l=Xn(n.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),n.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),l!=null&&(e.defaultValue=""+l)}function Lc(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function gm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Di(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?gm(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var dr,hm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,s,l,r){MSApp.execUnsafeLocalFunction(function(){return e(n,s,l,r)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(dr=dr||document.createElement("div"),dr.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=dr.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function _l(e,n){if(n){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=n;return}}e.textContent=n}var bl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wp=["Webkit","ms","Moz","O"];Object.keys(bl).forEach(function(e){Wp.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),bl[n]=bl[e]})});function ym(e,n,s){return n==null||typeof n=="boolean"||n===""?"":s||typeof n!="number"||n===0||bl.hasOwnProperty(e)&&bl[e]?(""+n).trim():n+"px"}function bm(e,n){e=e.style;for(var s in n)if(n.hasOwnProperty(s)){var l=s.indexOf("--")===0,r=ym(s,n[s],l);s==="float"&&(s="cssFloat"),l?e.setProperty(s,r):e[s]=r}}var Hp=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qi(e,n){if(n){if(Hp[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(ne(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(ne(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(ne(61))}if(n.style!=null&&typeof n.style!="object")throw Error(ne(62))}}function Ui(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zi=null;function Lo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Fi=null,Us=null,zs=null;function $c(e){if(e=nr(e)){if(typeof Fi!="function")throw Error(ne(280));var n=e.stateNode;n&&(n=ka(n),Fi(e.stateNode,e.type,n))}}function vm(e){Us?zs?zs.push(e):zs=[e]:Us=e}function jm(){if(Us){var e=Us,n=zs;if(zs=Us=null,$c(e),n)for(e=0;e<n.length;e++)$c(n[e])}}function wm(e,n){return e(n)}function Nm(){}var Ya=!1;function Sm(e,n,s){if(Ya)return e(n,s);Ya=!0;try{return wm(e,n,s)}finally{Ya=!1,(Us!==null||zs!==null)&&(Nm(),jm())}}function Al(e,n){var s=e.stateNode;if(s===null)return null;var l=ka(s);if(l===null)return null;s=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(ne(231,n,typeof s));return s}var Gi=!1;if(Sn)try{var ol={};Object.defineProperty(ol,"passive",{get:function(){Gi=!0}}),window.addEventListener("test",ol,ol),window.removeEventListener("test",ol,ol)}catch{Gi=!1}function Vp(e,n,s,l,r,a,i,o,c){var d=Array.prototype.slice.call(arguments,3);try{n.apply(s,d)}catch(u){this.onError(u)}}var vl=!1,Hr=null,Vr=!1,Wi=null,Kp={onError:function(e){vl=!0,Hr=e}};function Jp(e,n,s,l,r,a,i,o,c){vl=!1,Hr=null,Vp.apply(Kp,arguments)}function Qp(e,n,s,l,r,a,i,o,c){if(Jp.apply(this,arguments),vl){if(vl){var d=Hr;vl=!1,Hr=null}else throw Error(ne(198));Vr||(Vr=!0,Wi=d)}}function vs(e){var n=e,s=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(s=n.return),e=n.return;while(e)}return n.tag===3?s:null}function km(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function Oc(e){if(vs(e)!==e)throw Error(ne(188))}function Yp(e){var n=e.alternate;if(!n){if(n=vs(e),n===null)throw Error(ne(188));return n!==e?null:e}for(var s=e,l=n;;){var r=s.return;if(r===null)break;var a=r.alternate;if(a===null){if(l=r.return,l!==null){s=l;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===s)return Oc(r),e;if(a===l)return Oc(r),n;a=a.sibling}throw Error(ne(188))}if(s.return!==l.return)s=r,l=a;else{for(var i=!1,o=r.child;o;){if(o===s){i=!0,s=r,l=a;break}if(o===l){i=!0,l=r,s=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===s){i=!0,s=a,l=r;break}if(o===l){i=!0,l=a,s=r;break}o=o.sibling}if(!i)throw Error(ne(189))}}if(s.alternate!==l)throw Error(ne(190))}if(s.tag!==3)throw Error(ne(188));return s.stateNode.current===s?e:n}function Cm(e){return e=Yp(e),e!==null?Im(e):null}function Im(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Im(e);if(n!==null)return n;e=e.sibling}return null}var Em=Ut.unstable_scheduleCallback,Dc=Ut.unstable_cancelCallback,Xp=Ut.unstable_shouldYield,Zp=Ut.unstable_requestPaint,at=Ut.unstable_now,eg=Ut.unstable_getCurrentPriorityLevel,$o=Ut.unstable_ImmediatePriority,Pm=Ut.unstable_UserBlockingPriority,Kr=Ut.unstable_NormalPriority,tg=Ut.unstable_LowPriority,Mm=Ut.unstable_IdlePriority,ja=null,gn=null;function ng(e){if(gn&&typeof gn.onCommitFiberRoot=="function")try{gn.onCommitFiberRoot(ja,e,void 0,(e.current.flags&128)===128)}catch{}}var an=Math.clz32?Math.clz32:rg,sg=Math.log,lg=Math.LN2;function rg(e){return e>>>=0,e===0?32:31-(sg(e)/lg|0)|0}var ur=64,mr=4194304;function hl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Jr(e,n){var s=e.pendingLanes;if(s===0)return 0;var l=0,r=e.suspendedLanes,a=e.pingedLanes,i=s&268435455;if(i!==0){var o=i&~r;o!==0?l=hl(o):(a&=i,a!==0&&(l=hl(a)))}else i=s&~r,i!==0?l=hl(i):a!==0&&(l=hl(a));if(l===0)return 0;if(n!==0&&n!==l&&!(n&r)&&(r=l&-l,a=n&-n,r>=a||r===16&&(a&4194240)!==0))return n;if(l&4&&(l|=s&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=l;0<n;)s=31-an(n),r=1<<s,l|=e[s],n&=~r;return l}function ag(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ig(e,n){for(var s=e.suspendedLanes,l=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-an(a),o=1<<i,c=r[i];c===-1?(!(o&s)||o&l)&&(r[i]=ag(o,n)):c<=n&&(e.expiredLanes|=o),a&=~o}}function Hi(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Tm(){var e=ur;return ur<<=1,!(ur&4194240)&&(ur=64),e}function Xa(e){for(var n=[],s=0;31>s;s++)n.push(e);return n}function er(e,n,s){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-an(n),e[n]=s}function og(e,n){var s=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-an(s),a=1<<r;n[r]=0,l[r]=-1,e[r]=-1,s&=~a}}function Oo(e,n){var s=e.entangledLanes|=n;for(e=e.entanglements;s;){var l=31-an(s),r=1<<l;r&n|e[l]&n&&(e[l]|=n),s&=~r}}var Ge=0;function _m(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Am,Do,Rm,Bm,Lm,Vi=!1,fr=[],Fn=null,Gn=null,Wn=null,Rl=new Map,Bl=new Map,Dn=[],cg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qc(e,n){switch(e){case"focusin":case"focusout":Fn=null;break;case"dragenter":case"dragleave":Gn=null;break;case"mouseover":case"mouseout":Wn=null;break;case"pointerover":case"pointerout":Rl.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bl.delete(n.pointerId)}}function cl(e,n,s,l,r,a){return e===null||e.nativeEvent!==a?(e={blockedOn:n,domEventName:s,eventSystemFlags:l,nativeEvent:a,targetContainers:[r]},n!==null&&(n=nr(n),n!==null&&Do(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,r!==null&&n.indexOf(r)===-1&&n.push(r),e)}function dg(e,n,s,l,r){switch(n){case"focusin":return Fn=cl(Fn,e,n,s,l,r),!0;case"dragenter":return Gn=cl(Gn,e,n,s,l,r),!0;case"mouseover":return Wn=cl(Wn,e,n,s,l,r),!0;case"pointerover":var a=r.pointerId;return Rl.set(a,cl(Rl.get(a)||null,e,n,s,l,r)),!0;case"gotpointercapture":return a=r.pointerId,Bl.set(a,cl(Bl.get(a)||null,e,n,s,l,r)),!0}return!1}function $m(e){var n=os(e.target);if(n!==null){var s=vs(n);if(s!==null){if(n=s.tag,n===13){if(n=km(s),n!==null){e.blockedOn=n,Lm(e.priority,function(){Rm(s)});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Br(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var s=Ki(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var l=new s.constructor(s.type,s);zi=l,s.target.dispatchEvent(l),zi=null}else return n=nr(s),n!==null&&Do(n),e.blockedOn=s,!1;n.shift()}return!0}function Uc(e,n,s){Br(e)&&s.delete(n)}function ug(){Vi=!1,Fn!==null&&Br(Fn)&&(Fn=null),Gn!==null&&Br(Gn)&&(Gn=null),Wn!==null&&Br(Wn)&&(Wn=null),Rl.forEach(Uc),Bl.forEach(Uc)}function dl(e,n){e.blockedOn===n&&(e.blockedOn=null,Vi||(Vi=!0,Ut.unstable_scheduleCallback(Ut.unstable_NormalPriority,ug)))}function Ll(e){function n(r){return dl(r,e)}if(0<fr.length){dl(fr[0],e);for(var s=1;s<fr.length;s++){var l=fr[s];l.blockedOn===e&&(l.blockedOn=null)}}for(Fn!==null&&dl(Fn,e),Gn!==null&&dl(Gn,e),Wn!==null&&dl(Wn,e),Rl.forEach(n),Bl.forEach(n),s=0;s<Dn.length;s++)l=Dn[s],l.blockedOn===e&&(l.blockedOn=null);for(;0<Dn.length&&(s=Dn[0],s.blockedOn===null);)$m(s),s.blockedOn===null&&Dn.shift()}var Fs=Mn.ReactCurrentBatchConfig,Qr=!0;function mg(e,n,s,l){var r=Ge,a=Fs.transition;Fs.transition=null;try{Ge=1,qo(e,n,s,l)}finally{Ge=r,Fs.transition=a}}function fg(e,n,s,l){var r=Ge,a=Fs.transition;Fs.transition=null;try{Ge=4,qo(e,n,s,l)}finally{Ge=r,Fs.transition=a}}function qo(e,n,s,l){if(Qr){var r=Ki(e,n,s,l);if(r===null)oi(e,n,l,Yr,s),qc(e,l);else if(dg(r,e,n,s,l))l.stopPropagation();else if(qc(e,l),n&4&&-1<cg.indexOf(e)){for(;r!==null;){var a=nr(r);if(a!==null&&Am(a),a=Ki(e,n,s,l),a===null&&oi(e,n,l,Yr,s),a===r)break;r=a}r!==null&&l.stopPropagation()}else oi(e,n,l,null,s)}}var Yr=null;function Ki(e,n,s,l){if(Yr=null,e=Lo(l),e=os(e),e!==null)if(n=vs(e),n===null)e=null;else if(s=n.tag,s===13){if(e=km(n),e!==null)return e;e=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Yr=e,null}function Om(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(eg()){case $o:return 1;case Pm:return 4;case Kr:case tg:return 16;case Mm:return 536870912;default:return 16}default:return 16}}var Un=null,Uo=null,Lr=null;function Dm(){if(Lr)return Lr;var e,n=Uo,s=n.length,l,r="value"in Un?Un.value:Un.textContent,a=r.length;for(e=0;e<s&&n[e]===r[e];e++);var i=s-e;for(l=1;l<=i&&n[s-l]===r[a-l];l++);return Lr=r.slice(e,1<l?1-l:void 0)}function $r(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function xr(){return!0}function zc(){return!1}function Ft(e){function n(s,l,r,a,i){this._reactName=s,this._targetInst=r,this.type=l,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(s=e[o],this[o]=s?s(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?xr:zc,this.isPropagationStopped=zc,this}return st(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=xr)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=xr)},persist:function(){},isPersistent:xr}),n}var sl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zo=Ft(sl),tr=st({},sl,{view:0,detail:0}),xg=Ft(tr),Za,ei,ul,wa=st({},tr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ul&&(ul&&e.type==="mousemove"?(Za=e.screenX-ul.screenX,ei=e.screenY-ul.screenY):ei=Za=0,ul=e),Za)},movementY:function(e){return"movementY"in e?e.movementY:ei}}),Fc=Ft(wa),pg=st({},wa,{dataTransfer:0}),gg=Ft(pg),hg=st({},tr,{relatedTarget:0}),ti=Ft(hg),yg=st({},sl,{animationName:0,elapsedTime:0,pseudoElement:0}),bg=Ft(yg),vg=st({},sl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),jg=Ft(vg),wg=st({},sl,{data:0}),Gc=Ft(wg),Ng={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cg(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=kg[e])?!!n[e]:!1}function Fo(){return Cg}var Ig=st({},tr,{key:function(e){if(e.key){var n=Ng[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=$r(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Sg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fo,charCode:function(e){return e.type==="keypress"?$r(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?$r(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Eg=Ft(Ig),Pg=st({},wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wc=Ft(Pg),Mg=st({},tr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fo}),Tg=Ft(Mg),_g=st({},sl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ag=Ft(_g),Rg=st({},wa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Bg=Ft(Rg),Lg=[9,13,27,32],Go=Sn&&"CompositionEvent"in window,jl=null;Sn&&"documentMode"in document&&(jl=document.documentMode);var $g=Sn&&"TextEvent"in window&&!jl,qm=Sn&&(!Go||jl&&8<jl&&11>=jl),Hc=" ",Vc=!1;function Um(e,n){switch(e){case"keyup":return Lg.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ms=!1;function Og(e,n){switch(e){case"compositionend":return zm(n);case"keypress":return n.which!==32?null:(Vc=!0,Hc);case"textInput":return e=n.data,e===Hc&&Vc?null:e;default:return null}}function Dg(e,n){if(Ms)return e==="compositionend"||!Go&&Um(e,n)?(e=Dm(),Lr=Uo=Un=null,Ms=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return qm&&n.locale!=="ko"?null:n.data;default:return null}}var qg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kc(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!qg[e.type]:n==="textarea"}function Fm(e,n,s,l){vm(l),n=Xr(n,"onChange"),0<n.length&&(s=new zo("onChange","change",null,s,l),e.push({event:s,listeners:n}))}var wl=null,$l=null;function Ug(e){ef(e,0)}function Na(e){var n=As(e);if(fm(n))return e}function zg(e,n){if(e==="change")return n}var Gm=!1;if(Sn){var ni;if(Sn){var si="oninput"in document;if(!si){var Jc=document.createElement("div");Jc.setAttribute("oninput","return;"),si=typeof Jc.oninput=="function"}ni=si}else ni=!1;Gm=ni&&(!document.documentMode||9<document.documentMode)}function Qc(){wl&&(wl.detachEvent("onpropertychange",Wm),$l=wl=null)}function Wm(e){if(e.propertyName==="value"&&Na($l)){var n=[];Fm(n,$l,e,Lo(e)),Sm(Ug,n)}}function Fg(e,n,s){e==="focusin"?(Qc(),wl=n,$l=s,wl.attachEvent("onpropertychange",Wm)):e==="focusout"&&Qc()}function Gg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Na($l)}function Wg(e,n){if(e==="click")return Na(n)}function Hg(e,n){if(e==="input"||e==="change")return Na(n)}function Vg(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var cn=typeof Object.is=="function"?Object.is:Vg;function Ol(e,n){if(cn(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var s=Object.keys(e),l=Object.keys(n);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var r=s[l];if(!Mi.call(n,r)||!cn(e[r],n[r]))return!1}return!0}function Yc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xc(e,n){var s=Yc(e);e=0;for(var l;s;){if(s.nodeType===3){if(l=e+s.textContent.length,e<=n&&l>=n)return{node:s,offset:n-e};e=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Yc(s)}}function Hm(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Hm(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Vm(){for(var e=window,n=Wr();n instanceof e.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)e=n.contentWindow;else break;n=Wr(e.document)}return n}function Wo(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function Kg(e){var n=Vm(),s=e.focusedElem,l=e.selectionRange;if(n!==s&&s&&s.ownerDocument&&Hm(s.ownerDocument.documentElement,s)){if(l!==null&&Wo(s)){if(n=l.start,e=l.end,e===void 0&&(e=n),"selectionStart"in s)s.selectionStart=n,s.selectionEnd=Math.min(e,s.value.length);else if(e=(n=s.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var r=s.textContent.length,a=Math.min(l.start,r);l=l.end===void 0?a:Math.min(l.end,r),!e.extend&&a>l&&(r=l,l=a,a=r),r=Xc(s,a);var i=Xc(s,l);r&&i&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(n=n.createRange(),n.setStart(r.node,r.offset),e.removeAllRanges(),a>l?(e.addRange(n),e.extend(i.node,i.offset)):(n.setEnd(i.node,i.offset),e.addRange(n)))}}for(n=[],e=s;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<n.length;s++)e=n[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Jg=Sn&&"documentMode"in document&&11>=document.documentMode,Ts=null,Ji=null,Nl=null,Qi=!1;function Zc(e,n,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Qi||Ts==null||Ts!==Wr(l)||(l=Ts,"selectionStart"in l&&Wo(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Nl&&Ol(Nl,l)||(Nl=l,l=Xr(Ji,"onSelect"),0<l.length&&(n=new zo("onSelect","select",null,n,s),e.push({event:n,listeners:l}),n.target=Ts)))}function pr(e,n){var s={};return s[e.toLowerCase()]=n.toLowerCase(),s["Webkit"+e]="webkit"+n,s["Moz"+e]="moz"+n,s}var _s={animationend:pr("Animation","AnimationEnd"),animationiteration:pr("Animation","AnimationIteration"),animationstart:pr("Animation","AnimationStart"),transitionend:pr("Transition","TransitionEnd")},li={},Km={};Sn&&(Km=document.createElement("div").style,"AnimationEvent"in window||(delete _s.animationend.animation,delete _s.animationiteration.animation,delete _s.animationstart.animation),"TransitionEvent"in window||delete _s.transitionend.transition);function Sa(e){if(li[e])return li[e];if(!_s[e])return e;var n=_s[e],s;for(s in n)if(n.hasOwnProperty(s)&&s in Km)return li[e]=n[s];return e}var Jm=Sa("animationend"),Qm=Sa("animationiteration"),Ym=Sa("animationstart"),Xm=Sa("transitionend"),Zm=new Map,ed="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function es(e,n){Zm.set(e,n),bs(n,[e])}for(var ri=0;ri<ed.length;ri++){var ai=ed[ri],Qg=ai.toLowerCase(),Yg=ai[0].toUpperCase()+ai.slice(1);es(Qg,"on"+Yg)}es(Jm,"onAnimationEnd");es(Qm,"onAnimationIteration");es(Ym,"onAnimationStart");es("dblclick","onDoubleClick");es("focusin","onFocus");es("focusout","onBlur");es(Xm,"onTransitionEnd");Hs("onMouseEnter",["mouseout","mouseover"]);Hs("onMouseLeave",["mouseout","mouseover"]);Hs("onPointerEnter",["pointerout","pointerover"]);Hs("onPointerLeave",["pointerout","pointerover"]);bs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bs("onBeforeInput",["compositionend","keypress","textInput","paste"]);bs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xg=new Set("cancel close invalid load scroll toggle".split(" ").concat(yl));function td(e,n,s){var l=e.type||"unknown-event";e.currentTarget=s,Qp(l,n,void 0,e),e.currentTarget=null}function ef(e,n){n=(n&4)!==0;for(var s=0;s<e.length;s++){var l=e[s],r=l.event;l=l.listeners;e:{var a=void 0;if(n)for(var i=l.length-1;0<=i;i--){var o=l[i],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==a&&r.isPropagationStopped())break e;td(r,o,d),a=c}else for(i=0;i<l.length;i++){if(o=l[i],c=o.instance,d=o.currentTarget,o=o.listener,c!==a&&r.isPropagationStopped())break e;td(r,o,d),a=c}}}if(Vr)throw e=Wi,Vr=!1,Wi=null,e}function Xe(e,n){var s=n[to];s===void 0&&(s=n[to]=new Set);var l=e+"__bubble";s.has(l)||(tf(n,e,2,!1),s.add(l))}function ii(e,n,s){var l=0;n&&(l|=4),tf(s,e,l,n)}var gr="_reactListening"+Math.random().toString(36).slice(2);function Dl(e){if(!e[gr]){e[gr]=!0,om.forEach(function(s){s!=="selectionchange"&&(Xg.has(s)||ii(s,!1,e),ii(s,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[gr]||(n[gr]=!0,ii("selectionchange",!1,n))}}function tf(e,n,s,l){switch(Om(n)){case 1:var r=mg;break;case 4:r=fg;break;default:r=qo}s=r.bind(null,n,s,e),r=void 0,!Gi||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(r=!0),l?r!==void 0?e.addEventListener(n,s,{capture:!0,passive:r}):e.addEventListener(n,s,!0):r!==void 0?e.addEventListener(n,s,{passive:r}):e.addEventListener(n,s,!1)}function oi(e,n,s,l,r){var a=l;if(!(n&1)&&!(n&2)&&l!==null)e:for(;;){if(l===null)return;var i=l.tag;if(i===3||i===4){var o=l.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(i===4)for(i=l.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;i=i.return}for(;o!==null;){if(i=os(o),i===null)return;if(c=i.tag,c===5||c===6){l=a=i;continue e}o=o.parentNode}}l=l.return}Sm(function(){var d=a,u=Lo(s),p=[];e:{var m=Zm.get(e);if(m!==void 0){var h=zo,y=e;switch(e){case"keypress":if($r(s)===0)break e;case"keydown":case"keyup":h=Eg;break;case"focusin":y="focus",h=ti;break;case"focusout":y="blur",h=ti;break;case"beforeblur":case"afterblur":h=ti;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Fc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=gg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Tg;break;case Jm:case Qm:case Ym:h=bg;break;case Xm:h=Ag;break;case"scroll":h=xg;break;case"wheel":h=Bg;break;case"copy":case"cut":case"paste":h=jg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Wc}var b=(n&4)!==0,v=!b&&e==="scroll",g=b?m!==null?m+"Capture":null:m;b=[];for(var x=d,j;x!==null;){j=x;var w=j.stateNode;if(j.tag===5&&w!==null&&(j=w,g!==null&&(w=Al(x,g),w!=null&&b.push(ql(x,w,j)))),v)break;x=x.return}0<b.length&&(m=new h(m,y,null,s,u),p.push({event:m,listeners:b}))}}if(!(n&7)){e:{if(m=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",m&&s!==zi&&(y=s.relatedTarget||s.fromElement)&&(os(y)||y[kn]))break e;if((h||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,h?(y=s.relatedTarget||s.toElement,h=d,y=y?os(y):null,y!==null&&(v=vs(y),y!==v||y.tag!==5&&y.tag!==6)&&(y=null)):(h=null,y=d),h!==y)){if(b=Fc,w="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(b=Wc,w="onPointerLeave",g="onPointerEnter",x="pointer"),v=h==null?m:As(h),j=y==null?m:As(y),m=new b(w,x+"leave",h,s,u),m.target=v,m.relatedTarget=j,w=null,os(u)===d&&(b=new b(g,x+"enter",y,s,u),b.target=j,b.relatedTarget=v,w=b),v=w,h&&y)t:{for(b=h,g=y,x=0,j=b;j;j=Ss(j))x++;for(j=0,w=g;w;w=Ss(w))j++;for(;0<x-j;)b=Ss(b),x--;for(;0<j-x;)g=Ss(g),j--;for(;x--;){if(b===g||g!==null&&b===g.alternate)break t;b=Ss(b),g=Ss(g)}b=null}else b=null;h!==null&&nd(p,m,h,b,!1),y!==null&&v!==null&&nd(p,v,y,b,!0)}}e:{if(m=d?As(d):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var S=zg;else if(Kc(m))if(Gm)S=Hg;else{S=Gg;var C=Fg}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(S=Wg);if(S&&(S=S(e,d))){Fm(p,S,s,u);break e}C&&C(e,m,d),e==="focusout"&&(C=m._wrapperState)&&C.controlled&&m.type==="number"&&$i(m,"number",m.value)}switch(C=d?As(d):window,e){case"focusin":(Kc(C)||C.contentEditable==="true")&&(Ts=C,Ji=d,Nl=null);break;case"focusout":Nl=Ji=Ts=null;break;case"mousedown":Qi=!0;break;case"contextmenu":case"mouseup":case"dragend":Qi=!1,Zc(p,s,u);break;case"selectionchange":if(Jg)break;case"keydown":case"keyup":Zc(p,s,u)}var k;if(Go)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Ms?Um(e,s)&&(M="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(M="onCompositionStart");M&&(qm&&s.locale!=="ko"&&(Ms||M!=="onCompositionStart"?M==="onCompositionEnd"&&Ms&&(k=Dm()):(Un=u,Uo="value"in Un?Un.value:Un.textContent,Ms=!0)),C=Xr(d,M),0<C.length&&(M=new Gc(M,e,null,s,u),p.push({event:M,listeners:C}),k?M.data=k:(k=zm(s),k!==null&&(M.data=k)))),(k=$g?Og(e,s):Dg(e,s))&&(d=Xr(d,"onBeforeInput"),0<d.length&&(u=new Gc("onBeforeInput","beforeinput",null,s,u),p.push({event:u,listeners:d}),u.data=k))}ef(p,n)})}function ql(e,n,s){return{instance:e,listener:n,currentTarget:s}}function Xr(e,n){for(var s=n+"Capture",l=[];e!==null;){var r=e,a=r.stateNode;r.tag===5&&a!==null&&(r=a,a=Al(e,s),a!=null&&l.unshift(ql(e,a,r)),a=Al(e,n),a!=null&&l.push(ql(e,a,r))),e=e.return}return l}function Ss(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function nd(e,n,s,l,r){for(var a=n._reactName,i=[];s!==null&&s!==l;){var o=s,c=o.alternate,d=o.stateNode;if(c!==null&&c===l)break;o.tag===5&&d!==null&&(o=d,r?(c=Al(s,a),c!=null&&i.unshift(ql(s,c,o))):r||(c=Al(s,a),c!=null&&i.push(ql(s,c,o)))),s=s.return}i.length!==0&&e.push({event:n,listeners:i})}var Zg=/\r\n?/g,eh=/\u0000|\uFFFD/g;function sd(e){return(typeof e=="string"?e:""+e).replace(Zg,`
`).replace(eh,"")}function hr(e,n,s){if(n=sd(n),sd(e)!==n&&s)throw Error(ne(425))}function Zr(){}var Yi=null,Xi=null;function Zi(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var eo=typeof setTimeout=="function"?setTimeout:void 0,th=typeof clearTimeout=="function"?clearTimeout:void 0,ld=typeof Promise=="function"?Promise:void 0,nh=typeof queueMicrotask=="function"?queueMicrotask:typeof ld<"u"?function(e){return ld.resolve(null).then(e).catch(sh)}:eo;function sh(e){setTimeout(function(){throw e})}function ci(e,n){var s=n,l=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&r.nodeType===8)if(s=r.data,s==="/$"){if(l===0){e.removeChild(r),Ll(n);return}l--}else s!=="$"&&s!=="$?"&&s!=="$!"||l++;s=r}while(s);Ll(n)}function Hn(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function rd(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return e;n--}else s==="/$"&&n++}e=e.previousSibling}return null}var ll=Math.random().toString(36).slice(2),pn="__reactFiber$"+ll,Ul="__reactProps$"+ll,kn="__reactContainer$"+ll,to="__reactEvents$"+ll,lh="__reactListeners$"+ll,rh="__reactHandles$"+ll;function os(e){var n=e[pn];if(n)return n;for(var s=e.parentNode;s;){if(n=s[kn]||s[pn]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(e=rd(e);e!==null;){if(s=e[pn])return s;e=rd(e)}return n}e=s,s=e.parentNode}return null}function nr(e){return e=e[pn]||e[kn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function As(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ne(33))}function ka(e){return e[Ul]||null}var no=[],Rs=-1;function ts(e){return{current:e}}function Ze(e){0>Rs||(e.current=no[Rs],no[Rs]=null,Rs--)}function Qe(e,n){Rs++,no[Rs]=e.current,e.current=n}var Zn={},kt=ts(Zn),Bt=ts(!1),xs=Zn;function Vs(e,n){var s=e.type.contextTypes;if(!s)return Zn;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===n)return l.__reactInternalMemoizedMaskedChildContext;var r={},a;for(a in s)r[a]=n[a];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=r),r}function Lt(e){return e=e.childContextTypes,e!=null}function ea(){Ze(Bt),Ze(kt)}function ad(e,n,s){if(kt.current!==Zn)throw Error(ne(168));Qe(kt,n),Qe(Bt,s)}function nf(e,n,s){var l=e.stateNode;if(n=n.childContextTypes,typeof l.getChildContext!="function")return s;l=l.getChildContext();for(var r in l)if(!(r in n))throw Error(ne(108,Fp(e)||"Unknown",r));return st({},s,l)}function ta(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Zn,xs=kt.current,Qe(kt,e),Qe(Bt,Bt.current),!0}function id(e,n,s){var l=e.stateNode;if(!l)throw Error(ne(169));s?(e=nf(e,n,xs),l.__reactInternalMemoizedMergedChildContext=e,Ze(Bt),Ze(kt),Qe(kt,e)):Ze(Bt),Qe(Bt,s)}var vn=null,Ca=!1,di=!1;function sf(e){vn===null?vn=[e]:vn.push(e)}function ah(e){Ca=!0,sf(e)}function ns(){if(!di&&vn!==null){di=!0;var e=0,n=Ge;try{var s=vn;for(Ge=1;e<s.length;e++){var l=s[e];do l=l(!0);while(l!==null)}vn=null,Ca=!1}catch(r){throw vn!==null&&(vn=vn.slice(e+1)),Em($o,ns),r}finally{Ge=n,di=!1}}return null}var Bs=[],Ls=0,na=null,sa=0,Kt=[],Jt=0,ps=null,jn=1,wn="";function as(e,n){Bs[Ls++]=sa,Bs[Ls++]=na,na=e,sa=n}function lf(e,n,s){Kt[Jt++]=jn,Kt[Jt++]=wn,Kt[Jt++]=ps,ps=e;var l=jn;e=wn;var r=32-an(l)-1;l&=~(1<<r),s+=1;var a=32-an(n)+r;if(30<a){var i=r-r%5;a=(l&(1<<i)-1).toString(32),l>>=i,r-=i,jn=1<<32-an(n)+r|s<<r|l,wn=a+e}else jn=1<<a|s<<r|l,wn=e}function Ho(e){e.return!==null&&(as(e,1),lf(e,1,0))}function Vo(e){for(;e===na;)na=Bs[--Ls],Bs[Ls]=null,sa=Bs[--Ls],Bs[Ls]=null;for(;e===ps;)ps=Kt[--Jt],Kt[Jt]=null,wn=Kt[--Jt],Kt[Jt]=null,jn=Kt[--Jt],Kt[Jt]=null}var qt=null,Dt=null,et=!1,rn=null;function rf(e,n){var s=Qt(5,null,null,0);s.elementType="DELETED",s.stateNode=n,s.return=e,n=e.deletions,n===null?(e.deletions=[s],e.flags|=16):n.push(s)}function od(e,n){switch(e.tag){case 5:var s=e.type;return n=n.nodeType!==1||s.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,qt=e,Dt=Hn(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,qt=e,Dt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(s=ps!==null?{id:jn,overflow:wn}:null,e.memoizedState={dehydrated:n,treeContext:s,retryLane:1073741824},s=Qt(18,null,null,0),s.stateNode=n,s.return=e,e.child=s,qt=e,Dt=null,!0):!1;default:return!1}}function so(e){return(e.mode&1)!==0&&(e.flags&128)===0}function lo(e){if(et){var n=Dt;if(n){var s=n;if(!od(e,n)){if(so(e))throw Error(ne(418));n=Hn(s.nextSibling);var l=qt;n&&od(e,n)?rf(l,s):(e.flags=e.flags&-4097|2,et=!1,qt=e)}}else{if(so(e))throw Error(ne(418));e.flags=e.flags&-4097|2,et=!1,qt=e}}}function cd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qt=e}function yr(e){if(e!==qt)return!1;if(!et)return cd(e),et=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!Zi(e.type,e.memoizedProps)),n&&(n=Dt)){if(so(e))throw af(),Error(ne(418));for(;n;)rf(e,n),n=Hn(n.nextSibling)}if(cd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ne(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(n===0){Dt=Hn(e.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++}e=e.nextSibling}Dt=null}}else Dt=qt?Hn(e.stateNode.nextSibling):null;return!0}function af(){for(var e=Dt;e;)e=Hn(e.nextSibling)}function Ks(){Dt=qt=null,et=!1}function Ko(e){rn===null?rn=[e]:rn.push(e)}var ih=Mn.ReactCurrentBatchConfig;function ml(e,n,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(ne(309));var l=s.stateNode}if(!l)throw Error(ne(147,e));var r=l,a=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===a?n.ref:(n=function(i){var o=r.refs;i===null?delete o[a]:o[a]=i},n._stringRef=a,n)}if(typeof e!="string")throw Error(ne(284));if(!s._owner)throw Error(ne(290,e))}return e}function br(e,n){throw e=Object.prototype.toString.call(n),Error(ne(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function dd(e){var n=e._init;return n(e._payload)}function of(e){function n(g,x){if(e){var j=g.deletions;j===null?(g.deletions=[x],g.flags|=16):j.push(x)}}function s(g,x){if(!e)return null;for(;x!==null;)n(g,x),x=x.sibling;return null}function l(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function r(g,x){return g=Qn(g,x),g.index=0,g.sibling=null,g}function a(g,x,j){return g.index=j,e?(j=g.alternate,j!==null?(j=j.index,j<x?(g.flags|=2,x):j):(g.flags|=2,x)):(g.flags|=1048576,x)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,x,j,w){return x===null||x.tag!==6?(x=hi(j,g.mode,w),x.return=g,x):(x=r(x,j),x.return=g,x)}function c(g,x,j,w){var S=j.type;return S===Ps?u(g,x,j.props.children,w,j.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===$n&&dd(S)===x.type)?(w=r(x,j.props),w.ref=ml(g,x,j),w.return=g,w):(w=Gr(j.type,j.key,j.props,null,g.mode,w),w.ref=ml(g,x,j),w.return=g,w)}function d(g,x,j,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==j.containerInfo||x.stateNode.implementation!==j.implementation?(x=yi(j,g.mode,w),x.return=g,x):(x=r(x,j.children||[]),x.return=g,x)}function u(g,x,j,w,S){return x===null||x.tag!==7?(x=fs(j,g.mode,w,S),x.return=g,x):(x=r(x,j),x.return=g,x)}function p(g,x,j){if(typeof x=="string"&&x!==""||typeof x=="number")return x=hi(""+x,g.mode,j),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case or:return j=Gr(x.type,x.key,x.props,null,g.mode,j),j.ref=ml(g,null,x),j.return=g,j;case Es:return x=yi(x,g.mode,j),x.return=g,x;case $n:var w=x._init;return p(g,w(x._payload),j)}if(gl(x)||il(x))return x=fs(x,g.mode,j,null),x.return=g,x;br(g,x)}return null}function m(g,x,j,w){var S=x!==null?x.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return S!==null?null:o(g,x,""+j,w);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case or:return j.key===S?c(g,x,j,w):null;case Es:return j.key===S?d(g,x,j,w):null;case $n:return S=j._init,m(g,x,S(j._payload),w)}if(gl(j)||il(j))return S!==null?null:u(g,x,j,w,null);br(g,j)}return null}function h(g,x,j,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(j)||null,o(x,g,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case or:return g=g.get(w.key===null?j:w.key)||null,c(x,g,w,S);case Es:return g=g.get(w.key===null?j:w.key)||null,d(x,g,w,S);case $n:var C=w._init;return h(g,x,j,C(w._payload),S)}if(gl(w)||il(w))return g=g.get(j)||null,u(x,g,w,S,null);br(x,w)}return null}function y(g,x,j,w){for(var S=null,C=null,k=x,M=x=0,_=null;k!==null&&M<j.length;M++){k.index>M?(_=k,k=null):_=k.sibling;var E=m(g,k,j[M],w);if(E===null){k===null&&(k=_);break}e&&k&&E.alternate===null&&n(g,k),x=a(E,x,M),C===null?S=E:C.sibling=E,C=E,k=_}if(M===j.length)return s(g,k),et&&as(g,M),S;if(k===null){for(;M<j.length;M++)k=p(g,j[M],w),k!==null&&(x=a(k,x,M),C===null?S=k:C.sibling=k,C=k);return et&&as(g,M),S}for(k=l(g,k);M<j.length;M++)_=h(k,g,M,j[M],w),_!==null&&(e&&_.alternate!==null&&k.delete(_.key===null?M:_.key),x=a(_,x,M),C===null?S=_:C.sibling=_,C=_);return e&&k.forEach(function(I){return n(g,I)}),et&&as(g,M),S}function b(g,x,j,w){var S=il(j);if(typeof S!="function")throw Error(ne(150));if(j=S.call(j),j==null)throw Error(ne(151));for(var C=S=null,k=x,M=x=0,_=null,E=j.next();k!==null&&!E.done;M++,E=j.next()){k.index>M?(_=k,k=null):_=k.sibling;var I=m(g,k,E.value,w);if(I===null){k===null&&(k=_);break}e&&k&&I.alternate===null&&n(g,k),x=a(I,x,M),C===null?S=I:C.sibling=I,C=I,k=_}if(E.done)return s(g,k),et&&as(g,M),S;if(k===null){for(;!E.done;M++,E=j.next())E=p(g,E.value,w),E!==null&&(x=a(E,x,M),C===null?S=E:C.sibling=E,C=E);return et&&as(g,M),S}for(k=l(g,k);!E.done;M++,E=j.next())E=h(k,g,M,E.value,w),E!==null&&(e&&E.alternate!==null&&k.delete(E.key===null?M:E.key),x=a(E,x,M),C===null?S=E:C.sibling=E,C=E);return e&&k.forEach(function(R){return n(g,R)}),et&&as(g,M),S}function v(g,x,j,w){if(typeof j=="object"&&j!==null&&j.type===Ps&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case or:e:{for(var S=j.key,C=x;C!==null;){if(C.key===S){if(S=j.type,S===Ps){if(C.tag===7){s(g,C.sibling),x=r(C,j.props.children),x.return=g,g=x;break e}}else if(C.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===$n&&dd(S)===C.type){s(g,C.sibling),x=r(C,j.props),x.ref=ml(g,C,j),x.return=g,g=x;break e}s(g,C);break}else n(g,C);C=C.sibling}j.type===Ps?(x=fs(j.props.children,g.mode,w,j.key),x.return=g,g=x):(w=Gr(j.type,j.key,j.props,null,g.mode,w),w.ref=ml(g,x,j),w.return=g,g=w)}return i(g);case Es:e:{for(C=j.key;x!==null;){if(x.key===C)if(x.tag===4&&x.stateNode.containerInfo===j.containerInfo&&x.stateNode.implementation===j.implementation){s(g,x.sibling),x=r(x,j.children||[]),x.return=g,g=x;break e}else{s(g,x);break}else n(g,x);x=x.sibling}x=yi(j,g.mode,w),x.return=g,g=x}return i(g);case $n:return C=j._init,v(g,x,C(j._payload),w)}if(gl(j))return y(g,x,j,w);if(il(j))return b(g,x,j,w);br(g,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,x!==null&&x.tag===6?(s(g,x.sibling),x=r(x,j),x.return=g,g=x):(s(g,x),x=hi(j,g.mode,w),x.return=g,g=x),i(g)):s(g,x)}return v}var Js=of(!0),cf=of(!1),la=ts(null),ra=null,$s=null,Jo=null;function Qo(){Jo=$s=ra=null}function Yo(e){var n=la.current;Ze(la),e._currentValue=n}function ro(e,n,s){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===s)break;e=e.return}}function Gs(e,n){ra=e,Jo=$s=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(Rt=!0),e.firstContext=null)}function Xt(e){var n=e._currentValue;if(Jo!==e)if(e={context:e,memoizedValue:n,next:null},$s===null){if(ra===null)throw Error(ne(308));$s=e,ra.dependencies={lanes:0,firstContext:e}}else $s=$s.next=e;return n}var cs=null;function Xo(e){cs===null?cs=[e]:cs.push(e)}function df(e,n,s,l){var r=n.interleaved;return r===null?(s.next=s,Xo(n)):(s.next=r.next,r.next=s),n.interleaved=s,Cn(e,l)}function Cn(e,n){e.lanes|=n;var s=e.alternate;for(s!==null&&(s.lanes|=n),s=e,e=e.return;e!==null;)e.childLanes|=n,s=e.alternate,s!==null&&(s.childLanes|=n),s=e,e=e.return;return s.tag===3?s.stateNode:null}var On=!1;function Zo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uf(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nn(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Vn(e,n,s){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,Oe&2){var r=l.pending;return r===null?n.next=n:(n.next=r.next,r.next=n),l.pending=n,Cn(e,s)}return r=l.interleaved,r===null?(n.next=n,Xo(l)):(n.next=r.next,r.next=n),l.interleaved=n,Cn(e,s)}function Or(e,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194240)!==0)){var l=n.lanes;l&=e.pendingLanes,s|=l,n.lanes=s,Oo(e,s)}}function ud(e,n){var s=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var r=null,a=null;if(s=s.firstBaseUpdate,s!==null){do{var i={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};a===null?r=a=i:a=a.next=i,s=s.next}while(s!==null);a===null?r=a=n:a=a.next=n}else r=a=n;s={baseState:l.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:l.shared,effects:l.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=n:e.next=n,s.lastBaseUpdate=n}function aa(e,n,s,l){var r=e.updateQueue;On=!1;var a=r.firstBaseUpdate,i=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var c=o,d=c.next;c.next=null,i===null?a=d:i.next=d,i=c;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=d:o.next=d,u.lastBaseUpdate=c))}if(a!==null){var p=r.baseState;i=0,u=d=c=null,o=a;do{var m=o.lane,h=o.eventTime;if((l&m)===m){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=e,b=o;switch(m=n,h=s,b.tag){case 1:if(y=b.payload,typeof y=="function"){p=y.call(h,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=b.payload,m=typeof y=="function"?y.call(h,p,m):y,m==null)break e;p=st({},p,m);break e;case 2:On=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=r.effects,m===null?r.effects=[o]:m.push(o))}else h={eventTime:h,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(d=u=h,c=p):u=u.next=h,i|=m;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;m=o,o=m.next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}while(!0);if(u===null&&(c=p),r.baseState=c,r.firstBaseUpdate=d,r.lastBaseUpdate=u,n=r.shared.interleaved,n!==null){r=n;do i|=r.lane,r=r.next;while(r!==n)}else a===null&&(r.shared.lanes=0);hs|=i,e.lanes=i,e.memoizedState=p}}function md(e,n,s){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var l=e[n],r=l.callback;if(r!==null){if(l.callback=null,l=s,typeof r!="function")throw Error(ne(191,r));r.call(l)}}}var sr={},hn=ts(sr),zl=ts(sr),Fl=ts(sr);function ds(e){if(e===sr)throw Error(ne(174));return e}function ec(e,n){switch(Qe(Fl,n),Qe(zl,e),Qe(hn,sr),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:Di(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=Di(n,e)}Ze(hn),Qe(hn,n)}function Qs(){Ze(hn),Ze(zl),Ze(Fl)}function mf(e){ds(Fl.current);var n=ds(hn.current),s=Di(n,e.type);n!==s&&(Qe(zl,e),Qe(hn,s))}function tc(e){zl.current===e&&(Ze(hn),Ze(zl))}var tt=ts(0);function ia(e){for(var n=e;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var ui=[];function nc(){for(var e=0;e<ui.length;e++)ui[e]._workInProgressVersionPrimary=null;ui.length=0}var Dr=Mn.ReactCurrentDispatcher,mi=Mn.ReactCurrentBatchConfig,gs=0,nt=null,ut=null,xt=null,oa=!1,Sl=!1,Gl=0,oh=0;function wt(){throw Error(ne(321))}function sc(e,n){if(n===null)return!1;for(var s=0;s<n.length&&s<e.length;s++)if(!cn(e[s],n[s]))return!1;return!0}function lc(e,n,s,l,r,a){if(gs=a,nt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Dr.current=e===null||e.memoizedState===null?mh:fh,e=s(l,r),Sl){a=0;do{if(Sl=!1,Gl=0,25<=a)throw Error(ne(301));a+=1,xt=ut=null,n.updateQueue=null,Dr.current=xh,e=s(l,r)}while(Sl)}if(Dr.current=ca,n=ut!==null&&ut.next!==null,gs=0,xt=ut=nt=null,oa=!1,n)throw Error(ne(300));return e}function rc(){var e=Gl!==0;return Gl=0,e}function xn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?nt.memoizedState=xt=e:xt=xt.next=e,xt}function Zt(){if(ut===null){var e=nt.alternate;e=e!==null?e.memoizedState:null}else e=ut.next;var n=xt===null?nt.memoizedState:xt.next;if(n!==null)xt=n,ut=e;else{if(e===null)throw Error(ne(310));ut=e,e={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},xt===null?nt.memoizedState=xt=e:xt=xt.next=e}return xt}function Wl(e,n){return typeof n=="function"?n(e):n}function fi(e){var n=Zt(),s=n.queue;if(s===null)throw Error(ne(311));s.lastRenderedReducer=e;var l=ut,r=l.baseQueue,a=s.pending;if(a!==null){if(r!==null){var i=r.next;r.next=a.next,a.next=i}l.baseQueue=r=a,s.pending=null}if(r!==null){a=r.next,l=l.baseState;var o=i=null,c=null,d=a;do{var u=d.lane;if((gs&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),l=d.hasEagerState?d.eagerState:e(l,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=p,i=l):c=c.next=p,nt.lanes|=u,hs|=u}d=d.next}while(d!==null&&d!==a);c===null?i=l:c.next=o,cn(l,n.memoizedState)||(Rt=!0),n.memoizedState=l,n.baseState=i,n.baseQueue=c,s.lastRenderedState=l}if(e=s.interleaved,e!==null){r=e;do a=r.lane,nt.lanes|=a,hs|=a,r=r.next;while(r!==e)}else r===null&&(s.lanes=0);return[n.memoizedState,s.dispatch]}function xi(e){var n=Zt(),s=n.queue;if(s===null)throw Error(ne(311));s.lastRenderedReducer=e;var l=s.dispatch,r=s.pending,a=n.memoizedState;if(r!==null){s.pending=null;var i=r=r.next;do a=e(a,i.action),i=i.next;while(i!==r);cn(a,n.memoizedState)||(Rt=!0),n.memoizedState=a,n.baseQueue===null&&(n.baseState=a),s.lastRenderedState=a}return[a,l]}function ff(){}function xf(e,n){var s=nt,l=Zt(),r=n(),a=!cn(l.memoizedState,r);if(a&&(l.memoizedState=r,Rt=!0),l=l.queue,ac(hf.bind(null,s,l,e),[e]),l.getSnapshot!==n||a||xt!==null&&xt.memoizedState.tag&1){if(s.flags|=2048,Hl(9,gf.bind(null,s,l,r,n),void 0,null),gt===null)throw Error(ne(349));gs&30||pf(s,n,r)}return r}function pf(e,n,s){e.flags|=16384,e={getSnapshot:n,value:s},n=nt.updateQueue,n===null?(n={lastEffect:null,stores:null},nt.updateQueue=n,n.stores=[e]):(s=n.stores,s===null?n.stores=[e]:s.push(e))}function gf(e,n,s,l){n.value=s,n.getSnapshot=l,yf(n)&&bf(e)}function hf(e,n,s){return s(function(){yf(n)&&bf(e)})}function yf(e){var n=e.getSnapshot;e=e.value;try{var s=n();return!cn(e,s)}catch{return!0}}function bf(e){var n=Cn(e,1);n!==null&&on(n,e,1,-1)}function fd(e){var n=xn();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wl,lastRenderedState:e},n.queue=e,e=e.dispatch=uh.bind(null,nt,e),[n.memoizedState,e]}function Hl(e,n,s,l){return e={tag:e,create:n,destroy:s,deps:l,next:null},n=nt.updateQueue,n===null?(n={lastEffect:null,stores:null},nt.updateQueue=n,n.lastEffect=e.next=e):(s=n.lastEffect,s===null?n.lastEffect=e.next=e:(l=s.next,s.next=e,e.next=l,n.lastEffect=e)),e}function vf(){return Zt().memoizedState}function qr(e,n,s,l){var r=xn();nt.flags|=e,r.memoizedState=Hl(1|n,s,void 0,l===void 0?null:l)}function Ia(e,n,s,l){var r=Zt();l=l===void 0?null:l;var a=void 0;if(ut!==null){var i=ut.memoizedState;if(a=i.destroy,l!==null&&sc(l,i.deps)){r.memoizedState=Hl(n,s,a,l);return}}nt.flags|=e,r.memoizedState=Hl(1|n,s,a,l)}function xd(e,n){return qr(8390656,8,e,n)}function ac(e,n){return Ia(2048,8,e,n)}function jf(e,n){return Ia(4,2,e,n)}function wf(e,n){return Ia(4,4,e,n)}function Nf(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Sf(e,n,s){return s=s!=null?s.concat([e]):null,Ia(4,4,Nf.bind(null,n,e),s)}function ic(){}function kf(e,n){var s=Zt();n=n===void 0?null:n;var l=s.memoizedState;return l!==null&&n!==null&&sc(n,l[1])?l[0]:(s.memoizedState=[e,n],e)}function Cf(e,n){var s=Zt();n=n===void 0?null:n;var l=s.memoizedState;return l!==null&&n!==null&&sc(n,l[1])?l[0]:(e=e(),s.memoizedState=[e,n],e)}function If(e,n,s){return gs&21?(cn(s,n)||(s=Tm(),nt.lanes|=s,hs|=s,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,Rt=!0),e.memoizedState=s)}function ch(e,n){var s=Ge;Ge=s!==0&&4>s?s:4,e(!0);var l=mi.transition;mi.transition={};try{e(!1),n()}finally{Ge=s,mi.transition=l}}function Ef(){return Zt().memoizedState}function dh(e,n,s){var l=Jn(e);if(s={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null},Pf(e))Mf(n,s);else if(s=df(e,n,s,l),s!==null){var r=Et();on(s,e,l,r),Tf(s,n,l)}}function uh(e,n,s){var l=Jn(e),r={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null};if(Pf(e))Mf(n,r);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=n.lastRenderedReducer,a!==null))try{var i=n.lastRenderedState,o=a(i,s);if(r.hasEagerState=!0,r.eagerState=o,cn(o,i)){var c=n.interleaved;c===null?(r.next=r,Xo(n)):(r.next=c.next,c.next=r),n.interleaved=r;return}}catch{}finally{}s=df(e,n,r,l),s!==null&&(r=Et(),on(s,e,l,r),Tf(s,n,l))}}function Pf(e){var n=e.alternate;return e===nt||n!==null&&n===nt}function Mf(e,n){Sl=oa=!0;var s=e.pending;s===null?n.next=n:(n.next=s.next,s.next=n),e.pending=n}function Tf(e,n,s){if(s&4194240){var l=n.lanes;l&=e.pendingLanes,s|=l,n.lanes=s,Oo(e,s)}}var ca={readContext:Xt,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useInsertionEffect:wt,useLayoutEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useMutableSource:wt,useSyncExternalStore:wt,useId:wt,unstable_isNewReconciler:!1},mh={readContext:Xt,useCallback:function(e,n){return xn().memoizedState=[e,n===void 0?null:n],e},useContext:Xt,useEffect:xd,useImperativeHandle:function(e,n,s){return s=s!=null?s.concat([e]):null,qr(4194308,4,Nf.bind(null,n,e),s)},useLayoutEffect:function(e,n){return qr(4194308,4,e,n)},useInsertionEffect:function(e,n){return qr(4,2,e,n)},useMemo:function(e,n){var s=xn();return n=n===void 0?null:n,e=e(),s.memoizedState=[e,n],e},useReducer:function(e,n,s){var l=xn();return n=s!==void 0?s(n):n,l.memoizedState=l.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},l.queue=e,e=e.dispatch=dh.bind(null,nt,e),[l.memoizedState,e]},useRef:function(e){var n=xn();return e={current:e},n.memoizedState=e},useState:fd,useDebugValue:ic,useDeferredValue:function(e){return xn().memoizedState=e},useTransition:function(){var e=fd(!1),n=e[0];return e=ch.bind(null,e[1]),xn().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,s){var l=nt,r=xn();if(et){if(s===void 0)throw Error(ne(407));s=s()}else{if(s=n(),gt===null)throw Error(ne(349));gs&30||pf(l,n,s)}r.memoizedState=s;var a={value:s,getSnapshot:n};return r.queue=a,xd(hf.bind(null,l,a,e),[e]),l.flags|=2048,Hl(9,gf.bind(null,l,a,s,n),void 0,null),s},useId:function(){var e=xn(),n=gt.identifierPrefix;if(et){var s=wn,l=jn;s=(l&~(1<<32-an(l)-1)).toString(32)+s,n=":"+n+"R"+s,s=Gl++,0<s&&(n+="H"+s.toString(32)),n+=":"}else s=oh++,n=":"+n+"r"+s.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},fh={readContext:Xt,useCallback:kf,useContext:Xt,useEffect:ac,useImperativeHandle:Sf,useInsertionEffect:jf,useLayoutEffect:wf,useMemo:Cf,useReducer:fi,useRef:vf,useState:function(){return fi(Wl)},useDebugValue:ic,useDeferredValue:function(e){var n=Zt();return If(n,ut.memoizedState,e)},useTransition:function(){var e=fi(Wl)[0],n=Zt().memoizedState;return[e,n]},useMutableSource:ff,useSyncExternalStore:xf,useId:Ef,unstable_isNewReconciler:!1},xh={readContext:Xt,useCallback:kf,useContext:Xt,useEffect:ac,useImperativeHandle:Sf,useInsertionEffect:jf,useLayoutEffect:wf,useMemo:Cf,useReducer:xi,useRef:vf,useState:function(){return xi(Wl)},useDebugValue:ic,useDeferredValue:function(e){var n=Zt();return ut===null?n.memoizedState=e:If(n,ut.memoizedState,e)},useTransition:function(){var e=xi(Wl)[0],n=Zt().memoizedState;return[e,n]},useMutableSource:ff,useSyncExternalStore:xf,useId:Ef,unstable_isNewReconciler:!1};function sn(e,n){if(e&&e.defaultProps){n=st({},n),e=e.defaultProps;for(var s in e)n[s]===void 0&&(n[s]=e[s]);return n}return n}function ao(e,n,s,l){n=e.memoizedState,s=s(l,n),s=s==null?n:st({},n,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Ea={isMounted:function(e){return(e=e._reactInternals)?vs(e)===e:!1},enqueueSetState:function(e,n,s){e=e._reactInternals;var l=Et(),r=Jn(e),a=Nn(l,r);a.payload=n,s!=null&&(a.callback=s),n=Vn(e,a,r),n!==null&&(on(n,e,r,l),Or(n,e,r))},enqueueReplaceState:function(e,n,s){e=e._reactInternals;var l=Et(),r=Jn(e),a=Nn(l,r);a.tag=1,a.payload=n,s!=null&&(a.callback=s),n=Vn(e,a,r),n!==null&&(on(n,e,r,l),Or(n,e,r))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var s=Et(),l=Jn(e),r=Nn(s,l);r.tag=2,n!=null&&(r.callback=n),n=Vn(e,r,l),n!==null&&(on(n,e,l,s),Or(n,e,l))}};function pd(e,n,s,l,r,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,a,i):n.prototype&&n.prototype.isPureReactComponent?!Ol(s,l)||!Ol(r,a):!0}function _f(e,n,s){var l=!1,r=Zn,a=n.contextType;return typeof a=="object"&&a!==null?a=Xt(a):(r=Lt(n)?xs:kt.current,l=n.contextTypes,a=(l=l!=null)?Vs(e,r):Zn),n=new n(s,a),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Ea,e.stateNode=n,n._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),n}function gd(e,n,s,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,l),n.state!==e&&Ea.enqueueReplaceState(n,n.state,null)}function io(e,n,s,l){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},Zo(e);var a=n.contextType;typeof a=="object"&&a!==null?r.context=Xt(a):(a=Lt(n)?xs:kt.current,r.context=Vs(e,a)),r.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(ao(e,n,a,s),r.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(n=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),n!==r.state&&Ea.enqueueReplaceState(r,r.state,null),aa(e,s,r,l),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Ys(e,n){try{var s="",l=n;do s+=zp(l),l=l.return;while(l);var r=s}catch(a){r=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:n,stack:r,digest:null}}function pi(e,n,s){return{value:e,source:null,stack:s??null,digest:n??null}}function oo(e,n){try{console.error(n.value)}catch(s){setTimeout(function(){throw s})}}var ph=typeof WeakMap=="function"?WeakMap:Map;function Af(e,n,s){s=Nn(-1,s),s.tag=3,s.payload={element:null};var l=n.value;return s.callback=function(){ua||(ua=!0,bo=l),oo(e,n)},s}function Rf(e,n,s){s=Nn(-1,s),s.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var r=n.value;s.payload=function(){return l(r)},s.callback=function(){oo(e,n)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(s.callback=function(){oo(e,n),typeof l!="function"&&(Kn===null?Kn=new Set([this]):Kn.add(this));var i=n.stack;this.componentDidCatch(n.value,{componentStack:i!==null?i:""})}),s}function hd(e,n,s){var l=e.pingCache;if(l===null){l=e.pingCache=new ph;var r=new Set;l.set(n,r)}else r=l.get(n),r===void 0&&(r=new Set,l.set(n,r));r.has(s)||(r.add(s),e=Ph.bind(null,e,n,s),n.then(e,e))}function yd(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function bd(e,n,s,l,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===n?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(n=Nn(-1,1),n.tag=2,Vn(s,n,1))),s.lanes|=1),e)}var gh=Mn.ReactCurrentOwner,Rt=!1;function It(e,n,s,l){n.child=e===null?cf(n,null,s,l):Js(n,e.child,s,l)}function vd(e,n,s,l,r){s=s.render;var a=n.ref;return Gs(n,r),l=lc(e,n,s,l,a,r),s=rc(),e!==null&&!Rt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r,In(e,n,r)):(et&&s&&Ho(n),n.flags|=1,It(e,n,l,r),n.child)}function jd(e,n,s,l,r){if(e===null){var a=s.type;return typeof a=="function"&&!pc(a)&&a.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(n.tag=15,n.type=a,Bf(e,n,a,l,r)):(e=Gr(s.type,null,l,n,n.mode,r),e.ref=n.ref,e.return=n,n.child=e)}if(a=e.child,!(e.lanes&r)){var i=a.memoizedProps;if(s=s.compare,s=s!==null?s:Ol,s(i,l)&&e.ref===n.ref)return In(e,n,r)}return n.flags|=1,e=Qn(a,l),e.ref=n.ref,e.return=n,n.child=e}function Bf(e,n,s,l,r){if(e!==null){var a=e.memoizedProps;if(Ol(a,l)&&e.ref===n.ref)if(Rt=!1,n.pendingProps=l=a,(e.lanes&r)!==0)e.flags&131072&&(Rt=!0);else return n.lanes=e.lanes,In(e,n,r)}return co(e,n,s,l,r)}function Lf(e,n,s){var l=n.pendingProps,r=l.children,a=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(Ds,Ot),Ot|=s;else{if(!(s&1073741824))return e=a!==null?a.baseLanes|s:s,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Qe(Ds,Ot),Ot|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=a!==null?a.baseLanes:s,Qe(Ds,Ot),Ot|=l}else a!==null?(l=a.baseLanes|s,n.memoizedState=null):l=s,Qe(Ds,Ot),Ot|=l;return It(e,n,r,s),n.child}function $f(e,n){var s=n.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(n.flags|=512,n.flags|=2097152)}function co(e,n,s,l,r){var a=Lt(s)?xs:kt.current;return a=Vs(n,a),Gs(n,r),s=lc(e,n,s,l,a,r),l=rc(),e!==null&&!Rt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r,In(e,n,r)):(et&&l&&Ho(n),n.flags|=1,It(e,n,s,r),n.child)}function wd(e,n,s,l,r){if(Lt(s)){var a=!0;ta(n)}else a=!1;if(Gs(n,r),n.stateNode===null)Ur(e,n),_f(n,s,l),io(n,s,l,r),l=!0;else if(e===null){var i=n.stateNode,o=n.memoizedProps;i.props=o;var c=i.context,d=s.contextType;typeof d=="object"&&d!==null?d=Xt(d):(d=Lt(s)?xs:kt.current,d=Vs(n,d));var u=s.getDerivedStateFromProps,p=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";p||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==l||c!==d)&&gd(n,i,l,d),On=!1;var m=n.memoizedState;i.state=m,aa(n,l,i,r),c=n.memoizedState,o!==l||m!==c||Bt.current||On?(typeof u=="function"&&(ao(n,s,u,l),c=n.memoizedState),(o=On||pd(n,s,o,l,m,c,d))?(p||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(n.flags|=4194308)):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=c),i.props=l,i.state=c,i.context=d,l=o):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{i=n.stateNode,uf(e,n),o=n.memoizedProps,d=n.type===n.elementType?o:sn(n.type,o),i.props=d,p=n.pendingProps,m=i.context,c=s.contextType,typeof c=="object"&&c!==null?c=Xt(c):(c=Lt(s)?xs:kt.current,c=Vs(n,c));var h=s.getDerivedStateFromProps;(u=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==p||m!==c)&&gd(n,i,l,c),On=!1,m=n.memoizedState,i.state=m,aa(n,l,i,r);var y=n.memoizedState;o!==p||m!==y||Bt.current||On?(typeof h=="function"&&(ao(n,s,h,l),y=n.memoizedState),(d=On||pd(n,s,d,l,m,y,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(l,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(l,y,c)),typeof i.componentDidUpdate=="function"&&(n.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=y),i.props=l,i.state=y,i.context=c,l=d):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=1024),l=!1)}return uo(e,n,s,l,a,r)}function uo(e,n,s,l,r,a){$f(e,n);var i=(n.flags&128)!==0;if(!l&&!i)return r&&id(n,s,!1),In(e,n,a);l=n.stateNode,gh.current=n;var o=i&&typeof s.getDerivedStateFromError!="function"?null:l.render();return n.flags|=1,e!==null&&i?(n.child=Js(n,e.child,null,a),n.child=Js(n,null,o,a)):It(e,n,o,a),n.memoizedState=l.state,r&&id(n,s,!0),n.child}function Of(e){var n=e.stateNode;n.pendingContext?ad(e,n.pendingContext,n.pendingContext!==n.context):n.context&&ad(e,n.context,!1),ec(e,n.containerInfo)}function Nd(e,n,s,l,r){return Ks(),Ko(r),n.flags|=256,It(e,n,s,l),n.child}var mo={dehydrated:null,treeContext:null,retryLane:0};function fo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Df(e,n,s){var l=n.pendingProps,r=tt.current,a=!1,i=(n.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(r&2)!==0),o?(a=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),Qe(tt,r&1),e===null)return lo(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(i=l.children,e=l.fallback,a?(l=n.mode,a=n.child,i={mode:"hidden",children:i},!(l&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Ta(i,l,0,null),e=fs(e,l,s,null),a.return=n,e.return=n,a.sibling=e,n.child=a,n.child.memoizedState=fo(s),n.memoizedState=mo,e):oc(n,i));if(r=e.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return hh(e,n,i,l,o,r,s);if(a){a=l.fallback,i=n.mode,r=e.child,o=r.sibling;var c={mode:"hidden",children:l.children};return!(i&1)&&n.child!==r?(l=n.child,l.childLanes=0,l.pendingProps=c,n.deletions=null):(l=Qn(r,c),l.subtreeFlags=r.subtreeFlags&14680064),o!==null?a=Qn(o,a):(a=fs(a,i,s,null),a.flags|=2),a.return=n,l.return=n,l.sibling=a,n.child=l,l=a,a=n.child,i=e.child.memoizedState,i=i===null?fo(s):{baseLanes:i.baseLanes|s,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~s,n.memoizedState=mo,l}return a=e.child,e=a.sibling,l=Qn(a,{mode:"visible",children:l.children}),!(n.mode&1)&&(l.lanes=s),l.return=n,l.sibling=null,e!==null&&(s=n.deletions,s===null?(n.deletions=[e],n.flags|=16):s.push(e)),n.child=l,n.memoizedState=null,l}function oc(e,n){return n=Ta({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function vr(e,n,s,l){return l!==null&&Ko(l),Js(n,e.child,null,s),e=oc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function hh(e,n,s,l,r,a,i){if(s)return n.flags&256?(n.flags&=-257,l=pi(Error(ne(422))),vr(e,n,i,l)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(a=l.fallback,r=n.mode,l=Ta({mode:"visible",children:l.children},r,0,null),a=fs(a,r,i,null),a.flags|=2,l.return=n,a.return=n,l.sibling=a,n.child=l,n.mode&1&&Js(n,e.child,null,i),n.child.memoizedState=fo(i),n.memoizedState=mo,a);if(!(n.mode&1))return vr(e,n,i,null);if(r.data==="$!"){if(l=r.nextSibling&&r.nextSibling.dataset,l)var o=l.dgst;return l=o,a=Error(ne(419)),l=pi(a,l,void 0),vr(e,n,i,l)}if(o=(i&e.childLanes)!==0,Rt||o){if(l=gt,l!==null){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(l.suspendedLanes|i)?0:r,r!==0&&r!==a.retryLane&&(a.retryLane=r,Cn(e,r),on(l,e,r,-1))}return xc(),l=pi(Error(ne(421))),vr(e,n,i,l)}return r.data==="$?"?(n.flags|=128,n.child=e.child,n=Mh.bind(null,e),r._reactRetry=n,null):(e=a.treeContext,Dt=Hn(r.nextSibling),qt=n,et=!0,rn=null,e!==null&&(Kt[Jt++]=jn,Kt[Jt++]=wn,Kt[Jt++]=ps,jn=e.id,wn=e.overflow,ps=n),n=oc(n,l.children),n.flags|=4096,n)}function Sd(e,n,s){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),ro(e.return,n,s)}function gi(e,n,s,l,r){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:r}:(a.isBackwards=n,a.rendering=null,a.renderingStartTime=0,a.last=l,a.tail=s,a.tailMode=r)}function qf(e,n,s){var l=n.pendingProps,r=l.revealOrder,a=l.tail;if(It(e,n,l.children,s),l=tt.current,l&2)l=l&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Sd(e,s,n);else if(e.tag===19)Sd(e,s,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Qe(tt,l),!(n.mode&1))n.memoizedState=null;else switch(r){case"forwards":for(s=n.child,r=null;s!==null;)e=s.alternate,e!==null&&ia(e)===null&&(r=s),s=s.sibling;s=r,s===null?(r=n.child,n.child=null):(r=s.sibling,s.sibling=null),gi(n,!1,r,s,a);break;case"backwards":for(s=null,r=n.child,n.child=null;r!==null;){if(e=r.alternate,e!==null&&ia(e)===null){n.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}gi(n,!0,s,null,a);break;case"together":gi(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Ur(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function In(e,n,s){if(e!==null&&(n.dependencies=e.dependencies),hs|=n.lanes,!(s&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(ne(153));if(n.child!==null){for(e=n.child,s=Qn(e,e.pendingProps),n.child=s,s.return=n;e.sibling!==null;)e=e.sibling,s=s.sibling=Qn(e,e.pendingProps),s.return=n;s.sibling=null}return n.child}function yh(e,n,s){switch(n.tag){case 3:Of(n),Ks();break;case 5:mf(n);break;case 1:Lt(n.type)&&ta(n);break;case 4:ec(n,n.stateNode.containerInfo);break;case 10:var l=n.type._context,r=n.memoizedProps.value;Qe(la,l._currentValue),l._currentValue=r;break;case 13:if(l=n.memoizedState,l!==null)return l.dehydrated!==null?(Qe(tt,tt.current&1),n.flags|=128,null):s&n.child.childLanes?Df(e,n,s):(Qe(tt,tt.current&1),e=In(e,n,s),e!==null?e.sibling:null);Qe(tt,tt.current&1);break;case 19:if(l=(s&n.childLanes)!==0,e.flags&128){if(l)return qf(e,n,s);n.flags|=128}if(r=n.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Qe(tt,tt.current),l)break;return null;case 22:case 23:return n.lanes=0,Lf(e,n,s)}return In(e,n,s)}var Uf,xo,zf,Ff;Uf=function(e,n){for(var s=n.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};xo=function(){};zf=function(e,n,s,l){var r=e.memoizedProps;if(r!==l){e=n.stateNode,ds(hn.current);var a=null;switch(s){case"input":r=Bi(e,r),l=Bi(e,l),a=[];break;case"select":r=st({},r,{value:void 0}),l=st({},l,{value:void 0}),a=[];break;case"textarea":r=Oi(e,r),l=Oi(e,l),a=[];break;default:typeof r.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=Zr)}qi(s,l);var i;s=null;for(d in r)if(!l.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var o=r[d];for(i in o)o.hasOwnProperty(i)&&(s||(s={}),s[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Tl.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in l){var c=l[d];if(o=r!=null?r[d]:void 0,l.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(s||(s={}),s[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(s||(s={}),s[i]=c[i])}else s||(a||(a=[]),a.push(d,s)),s=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Tl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Xe("scroll",e),a||o===c||(a=[])):(a=a||[]).push(d,c))}s&&(a=a||[]).push("style",s);var d=a;(n.updateQueue=d)&&(n.flags|=4)}};Ff=function(e,n,s,l){s!==l&&(n.flags|=4)};function fl(e,n){if(!et)switch(e.tailMode){case"hidden":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function Nt(e){var n=e.alternate!==null&&e.alternate.child===e.child,s=0,l=0;if(n)for(var r=e.child;r!==null;)s|=r.lanes|r.childLanes,l|=r.subtreeFlags&14680064,l|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)s|=r.lanes|r.childLanes,l|=r.subtreeFlags,l|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=l,e.childLanes=s,n}function bh(e,n,s){var l=n.pendingProps;switch(Vo(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(n),null;case 1:return Lt(n.type)&&ea(),Nt(n),null;case 3:return l=n.stateNode,Qs(),Ze(Bt),Ze(kt),nc(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(yr(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,rn!==null&&(wo(rn),rn=null))),xo(e,n),Nt(n),null;case 5:tc(n);var r=ds(Fl.current);if(s=n.type,e!==null&&n.stateNode!=null)zf(e,n,s,l,r),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!l){if(n.stateNode===null)throw Error(ne(166));return Nt(n),null}if(e=ds(hn.current),yr(n)){l=n.stateNode,s=n.type;var a=n.memoizedProps;switch(l[pn]=n,l[Ul]=a,e=(n.mode&1)!==0,s){case"dialog":Xe("cancel",l),Xe("close",l);break;case"iframe":case"object":case"embed":Xe("load",l);break;case"video":case"audio":for(r=0;r<yl.length;r++)Xe(yl[r],l);break;case"source":Xe("error",l);break;case"img":case"image":case"link":Xe("error",l),Xe("load",l);break;case"details":Xe("toggle",l);break;case"input":Ac(l,a),Xe("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!a.multiple},Xe("invalid",l);break;case"textarea":Bc(l,a),Xe("invalid",l)}qi(s,a),r=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?l.textContent!==o&&(a.suppressHydrationWarning!==!0&&hr(l.textContent,o,e),r=["children",o]):typeof o=="number"&&l.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&hr(l.textContent,o,e),r=["children",""+o]):Tl.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Xe("scroll",l)}switch(s){case"input":cr(l),Rc(l,a,!0);break;case"textarea":cr(l),Lc(l);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(l.onclick=Zr)}l=r,n.updateQueue=l,l!==null&&(n.flags|=4)}else{i=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=gm(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=i.createElement(s,{is:l.is}):(e=i.createElement(s),s==="select"&&(i=e,l.multiple?i.multiple=!0:l.size&&(i.size=l.size))):e=i.createElementNS(e,s),e[pn]=n,e[Ul]=l,Uf(e,n,!1,!1),n.stateNode=e;e:{switch(i=Ui(s,l),s){case"dialog":Xe("cancel",e),Xe("close",e),r=l;break;case"iframe":case"object":case"embed":Xe("load",e),r=l;break;case"video":case"audio":for(r=0;r<yl.length;r++)Xe(yl[r],e);r=l;break;case"source":Xe("error",e),r=l;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),r=l;break;case"details":Xe("toggle",e),r=l;break;case"input":Ac(e,l),r=Bi(e,l),Xe("invalid",e);break;case"option":r=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},r=st({},l,{value:void 0}),Xe("invalid",e);break;case"textarea":Bc(e,l),r=Oi(e,l),Xe("invalid",e);break;default:r=l}qi(s,r),o=r;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?bm(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&hm(e,c)):a==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&_l(e,c):typeof c=="number"&&_l(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Tl.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Xe("scroll",e):c!=null&&_o(e,a,c,i))}switch(s){case"input":cr(e),Rc(e,l,!1);break;case"textarea":cr(e),Lc(e);break;case"option":l.value!=null&&e.setAttribute("value",""+Xn(l.value));break;case"select":e.multiple=!!l.multiple,a=l.value,a!=null?qs(e,!!l.multiple,a,!1):l.defaultValue!=null&&qs(e,!!l.multiple,l.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=Zr)}switch(s){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Nt(n),null;case 6:if(e&&n.stateNode!=null)Ff(e,n,e.memoizedProps,l);else{if(typeof l!="string"&&n.stateNode===null)throw Error(ne(166));if(s=ds(Fl.current),ds(hn.current),yr(n)){if(l=n.stateNode,s=n.memoizedProps,l[pn]=n,(a=l.nodeValue!==s)&&(e=qt,e!==null))switch(e.tag){case 3:hr(l.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hr(l.nodeValue,s,(e.mode&1)!==0)}a&&(n.flags|=4)}else l=(s.nodeType===9?s:s.ownerDocument).createTextNode(l),l[pn]=n,n.stateNode=l}return Nt(n),null;case 13:if(Ze(tt),l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(et&&Dt!==null&&n.mode&1&&!(n.flags&128))af(),Ks(),n.flags|=98560,a=!1;else if(a=yr(n),l!==null&&l.dehydrated!==null){if(e===null){if(!a)throw Error(ne(318));if(a=n.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ne(317));a[pn]=n}else Ks(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Nt(n),a=!1}else rn!==null&&(wo(rn),rn=null),a=!0;if(!a)return n.flags&65536?n:null}return n.flags&128?(n.lanes=s,n):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(n.child.flags|=8192,n.mode&1&&(e===null||tt.current&1?mt===0&&(mt=3):xc())),n.updateQueue!==null&&(n.flags|=4),Nt(n),null);case 4:return Qs(),xo(e,n),e===null&&Dl(n.stateNode.containerInfo),Nt(n),null;case 10:return Yo(n.type._context),Nt(n),null;case 17:return Lt(n.type)&&ea(),Nt(n),null;case 19:if(Ze(tt),a=n.memoizedState,a===null)return Nt(n),null;if(l=(n.flags&128)!==0,i=a.rendering,i===null)if(l)fl(a,!1);else{if(mt!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(i=ia(e),i!==null){for(n.flags|=128,fl(a,!1),l=i.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),n.subtreeFlags=0,l=s,s=n.child;s!==null;)a=s,e=l,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Qe(tt,tt.current&1|2),n.child}e=e.sibling}a.tail!==null&&at()>Xs&&(n.flags|=128,l=!0,fl(a,!1),n.lanes=4194304)}else{if(!l)if(e=ia(i),e!==null){if(n.flags|=128,l=!0,s=e.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),fl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!et)return Nt(n),null}else 2*at()-a.renderingStartTime>Xs&&s!==1073741824&&(n.flags|=128,l=!0,fl(a,!1),n.lanes=4194304);a.isBackwards?(i.sibling=n.child,n.child=i):(s=a.last,s!==null?s.sibling=i:n.child=i,a.last=i)}return a.tail!==null?(n=a.tail,a.rendering=n,a.tail=n.sibling,a.renderingStartTime=at(),n.sibling=null,s=tt.current,Qe(tt,l?s&1|2:s&1),n):(Nt(n),null);case 22:case 23:return fc(),l=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(n.flags|=8192),l&&n.mode&1?Ot&1073741824&&(Nt(n),n.subtreeFlags&6&&(n.flags|=8192)):Nt(n),null;case 24:return null;case 25:return null}throw Error(ne(156,n.tag))}function vh(e,n){switch(Vo(n),n.tag){case 1:return Lt(n.type)&&ea(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Qs(),Ze(Bt),Ze(kt),nc(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return tc(n),null;case 13:if(Ze(tt),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(ne(340));Ks()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Ze(tt),null;case 4:return Qs(),null;case 10:return Yo(n.type._context),null;case 22:case 23:return fc(),null;case 24:return null;default:return null}}var jr=!1,St=!1,jh=typeof WeakSet=="function"?WeakSet:Set,ye=null;function Os(e,n){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(l){lt(e,n,l)}else s.current=null}function po(e,n,s){try{s()}catch(l){lt(e,n,l)}}var kd=!1;function wh(e,n){if(Yi=Qr,e=Vm(),Wo(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var r=l.anchorOffset,a=l.focusNode;l=l.focusOffset;try{s.nodeType,a.nodeType}catch{s=null;break e}var i=0,o=-1,c=-1,d=0,u=0,p=e,m=null;t:for(;;){for(var h;p!==s||r!==0&&p.nodeType!==3||(o=i+r),p!==a||l!==0&&p.nodeType!==3||(c=i+l),p.nodeType===3&&(i+=p.nodeValue.length),(h=p.firstChild)!==null;)m=p,p=h;for(;;){if(p===e)break t;if(m===s&&++d===r&&(o=i),m===a&&++u===l&&(c=i),(h=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=h}s=o===-1||c===-1?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(Xi={focusedElem:e,selectionRange:s},Qr=!1,ye=n;ye!==null;)if(n=ye,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,ye=e;else for(;ye!==null;){n=ye;try{var y=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var b=y.memoizedProps,v=y.memoizedState,g=n.stateNode,x=g.getSnapshotBeforeUpdate(n.elementType===n.type?b:sn(n.type,b),v);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var j=n.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(w){lt(n,n.return,w)}if(e=n.sibling,e!==null){e.return=n.return,ye=e;break}ye=n.return}return y=kd,kd=!1,y}function kl(e,n,s){var l=n.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var r=l=l.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,a!==void 0&&po(n,s,a)}r=r.next}while(r!==l)}}function Pa(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var l=s.create;s.destroy=l()}s=s.next}while(s!==n)}}function go(e){var n=e.ref;if(n!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof n=="function"?n(e):n.current=e}}function Gf(e){var n=e.alternate;n!==null&&(e.alternate=null,Gf(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[pn],delete n[Ul],delete n[to],delete n[lh],delete n[rh])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Wf(e){return e.tag===5||e.tag===3||e.tag===4}function Cd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Wf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ho(e,n,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?s.nodeType===8?s.parentNode.insertBefore(e,n):s.insertBefore(e,n):(s.nodeType===8?(n=s.parentNode,n.insertBefore(e,s)):(n=s,n.appendChild(e)),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=Zr));else if(l!==4&&(e=e.child,e!==null))for(ho(e,n,s),e=e.sibling;e!==null;)ho(e,n,s),e=e.sibling}function yo(e,n,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?s.insertBefore(e,n):s.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(yo(e,n,s),e=e.sibling;e!==null;)yo(e,n,s),e=e.sibling}var ht=null,ln=!1;function _n(e,n,s){for(s=s.child;s!==null;)Hf(e,n,s),s=s.sibling}function Hf(e,n,s){if(gn&&typeof gn.onCommitFiberUnmount=="function")try{gn.onCommitFiberUnmount(ja,s)}catch{}switch(s.tag){case 5:St||Os(s,n);case 6:var l=ht,r=ln;ht=null,_n(e,n,s),ht=l,ln=r,ht!==null&&(ln?(e=ht,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):ht.removeChild(s.stateNode));break;case 18:ht!==null&&(ln?(e=ht,s=s.stateNode,e.nodeType===8?ci(e.parentNode,s):e.nodeType===1&&ci(e,s),Ll(e)):ci(ht,s.stateNode));break;case 4:l=ht,r=ln,ht=s.stateNode.containerInfo,ln=!0,_n(e,n,s),ht=l,ln=r;break;case 0:case 11:case 14:case 15:if(!St&&(l=s.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){r=l=l.next;do{var a=r,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&po(s,n,i),r=r.next}while(r!==l)}_n(e,n,s);break;case 1:if(!St&&(Os(s,n),l=s.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=s.memoizedProps,l.state=s.memoizedState,l.componentWillUnmount()}catch(o){lt(s,n,o)}_n(e,n,s);break;case 21:_n(e,n,s);break;case 22:s.mode&1?(St=(l=St)||s.memoizedState!==null,_n(e,n,s),St=l):_n(e,n,s);break;default:_n(e,n,s)}}function Id(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new jh),n.forEach(function(l){var r=Th.bind(null,e,l);s.has(l)||(s.add(l),l.then(r,r))})}}function nn(e,n){var s=n.deletions;if(s!==null)for(var l=0;l<s.length;l++){var r=s[l];try{var a=e,i=n,o=i;e:for(;o!==null;){switch(o.tag){case 5:ht=o.stateNode,ln=!1;break e;case 3:ht=o.stateNode.containerInfo,ln=!0;break e;case 4:ht=o.stateNode.containerInfo,ln=!0;break e}o=o.return}if(ht===null)throw Error(ne(160));Hf(a,i,r),ht=null,ln=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(d){lt(r,n,d)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Vf(n,e),n=n.sibling}function Vf(e,n){var s=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(nn(n,e),fn(e),l&4){try{kl(3,e,e.return),Pa(3,e)}catch(b){lt(e,e.return,b)}try{kl(5,e,e.return)}catch(b){lt(e,e.return,b)}}break;case 1:nn(n,e),fn(e),l&512&&s!==null&&Os(s,s.return);break;case 5:if(nn(n,e),fn(e),l&512&&s!==null&&Os(s,s.return),e.flags&32){var r=e.stateNode;try{_l(r,"")}catch(b){lt(e,e.return,b)}}if(l&4&&(r=e.stateNode,r!=null)){var a=e.memoizedProps,i=s!==null?s.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&xm(r,a),Ui(o,i);var d=Ui(o,a);for(i=0;i<c.length;i+=2){var u=c[i],p=c[i+1];u==="style"?bm(r,p):u==="dangerouslySetInnerHTML"?hm(r,p):u==="children"?_l(r,p):_o(r,u,p,d)}switch(o){case"input":Li(r,a);break;case"textarea":pm(r,a);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?qs(r,!!a.multiple,h,!1):m!==!!a.multiple&&(a.defaultValue!=null?qs(r,!!a.multiple,a.defaultValue,!0):qs(r,!!a.multiple,a.multiple?[]:"",!1))}r[Ul]=a}catch(b){lt(e,e.return,b)}}break;case 6:if(nn(n,e),fn(e),l&4){if(e.stateNode===null)throw Error(ne(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(b){lt(e,e.return,b)}}break;case 3:if(nn(n,e),fn(e),l&4&&s!==null&&s.memoizedState.isDehydrated)try{Ll(n.containerInfo)}catch(b){lt(e,e.return,b)}break;case 4:nn(n,e),fn(e);break;case 13:nn(n,e),fn(e),r=e.child,r.flags&8192&&(a=r.memoizedState!==null,r.stateNode.isHidden=a,!a||r.alternate!==null&&r.alternate.memoizedState!==null||(uc=at())),l&4&&Id(e);break;case 22:if(u=s!==null&&s.memoizedState!==null,e.mode&1?(St=(d=St)||u,nn(n,e),St=d):nn(n,e),fn(e),l&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(ye=e,u=e.child;u!==null;){for(p=ye=u;ye!==null;){switch(m=ye,h=m.child,m.tag){case 0:case 11:case 14:case 15:kl(4,m,m.return);break;case 1:Os(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){l=m,s=m.return;try{n=l,y.props=n.memoizedProps,y.state=n.memoizedState,y.componentWillUnmount()}catch(b){lt(l,s,b)}}break;case 5:Os(m,m.return);break;case 22:if(m.memoizedState!==null){Pd(p);continue}}h!==null?(h.return=m,ye=h):Pd(p)}u=u.sibling}e:for(u=null,p=e;;){if(p.tag===5){if(u===null){u=p;try{r=p.stateNode,d?(a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,c=p.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=ym("display",i))}catch(b){lt(e,e.return,b)}}}else if(p.tag===6){if(u===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(b){lt(e,e.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:nn(n,e),fn(e),l&4&&Id(e);break;case 21:break;default:nn(n,e),fn(e)}}function fn(e){var n=e.flags;if(n&2){try{e:{for(var s=e.return;s!==null;){if(Wf(s)){var l=s;break e}s=s.return}throw Error(ne(160))}switch(l.tag){case 5:var r=l.stateNode;l.flags&32&&(_l(r,""),l.flags&=-33);var a=Cd(e);yo(e,a,r);break;case 3:case 4:var i=l.stateNode.containerInfo,o=Cd(e);ho(e,o,i);break;default:throw Error(ne(161))}}catch(c){lt(e,e.return,c)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function Nh(e,n,s){ye=e,Kf(e)}function Kf(e,n,s){for(var l=(e.mode&1)!==0;ye!==null;){var r=ye,a=r.child;if(r.tag===22&&l){var i=r.memoizedState!==null||jr;if(!i){var o=r.alternate,c=o!==null&&o.memoizedState!==null||St;o=jr;var d=St;if(jr=i,(St=c)&&!d)for(ye=r;ye!==null;)i=ye,c=i.child,i.tag===22&&i.memoizedState!==null?Md(r):c!==null?(c.return=i,ye=c):Md(r);for(;a!==null;)ye=a,Kf(a),a=a.sibling;ye=r,jr=o,St=d}Ed(e)}else r.subtreeFlags&8772&&a!==null?(a.return=r,ye=a):Ed(e)}}function Ed(e){for(;ye!==null;){var n=ye;if(n.flags&8772){var s=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:St||Pa(5,n);break;case 1:var l=n.stateNode;if(n.flags&4&&!St)if(s===null)l.componentDidMount();else{var r=n.elementType===n.type?s.memoizedProps:sn(n.type,s.memoizedProps);l.componentDidUpdate(r,s.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var a=n.updateQueue;a!==null&&md(n,a,l);break;case 3:var i=n.updateQueue;if(i!==null){if(s=null,n.child!==null)switch(n.child.tag){case 5:s=n.child.stateNode;break;case 1:s=n.child.stateNode}md(n,i,s)}break;case 5:var o=n.stateNode;if(s===null&&n.flags&4){s=o;var c=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var d=n.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var p=u.dehydrated;p!==null&&Ll(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}St||n.flags&512&&go(n)}catch(m){lt(n,n.return,m)}}if(n===e){ye=null;break}if(s=n.sibling,s!==null){s.return=n.return,ye=s;break}ye=n.return}}function Pd(e){for(;ye!==null;){var n=ye;if(n===e){ye=null;break}var s=n.sibling;if(s!==null){s.return=n.return,ye=s;break}ye=n.return}}function Md(e){for(;ye!==null;){var n=ye;try{switch(n.tag){case 0:case 11:case 15:var s=n.return;try{Pa(4,n)}catch(c){lt(n,s,c)}break;case 1:var l=n.stateNode;if(typeof l.componentDidMount=="function"){var r=n.return;try{l.componentDidMount()}catch(c){lt(n,r,c)}}var a=n.return;try{go(n)}catch(c){lt(n,a,c)}break;case 5:var i=n.return;try{go(n)}catch(c){lt(n,i,c)}}}catch(c){lt(n,n.return,c)}if(n===e){ye=null;break}var o=n.sibling;if(o!==null){o.return=n.return,ye=o;break}ye=n.return}}var Sh=Math.ceil,da=Mn.ReactCurrentDispatcher,cc=Mn.ReactCurrentOwner,Yt=Mn.ReactCurrentBatchConfig,Oe=0,gt=null,dt=null,yt=0,Ot=0,Ds=ts(0),mt=0,Vl=null,hs=0,Ma=0,dc=0,Cl=null,_t=null,uc=0,Xs=1/0,bn=null,ua=!1,bo=null,Kn=null,wr=!1,zn=null,ma=0,Il=0,vo=null,zr=-1,Fr=0;function Et(){return Oe&6?at():zr!==-1?zr:zr=at()}function Jn(e){return e.mode&1?Oe&2&&yt!==0?yt&-yt:ih.transition!==null?(Fr===0&&(Fr=Tm()),Fr):(e=Ge,e!==0||(e=window.event,e=e===void 0?16:Om(e.type)),e):1}function on(e,n,s,l){if(50<Il)throw Il=0,vo=null,Error(ne(185));er(e,s,l),(!(Oe&2)||e!==gt)&&(e===gt&&(!(Oe&2)&&(Ma|=s),mt===4&&qn(e,yt)),$t(e,l),s===1&&Oe===0&&!(n.mode&1)&&(Xs=at()+500,Ca&&ns()))}function $t(e,n){var s=e.callbackNode;ig(e,n);var l=Jr(e,e===gt?yt:0);if(l===0)s!==null&&Dc(s),e.callbackNode=null,e.callbackPriority=0;else if(n=l&-l,e.callbackPriority!==n){if(s!=null&&Dc(s),n===1)e.tag===0?ah(Td.bind(null,e)):sf(Td.bind(null,e)),nh(function(){!(Oe&6)&&ns()}),s=null;else{switch(_m(l)){case 1:s=$o;break;case 4:s=Pm;break;case 16:s=Kr;break;case 536870912:s=Mm;break;default:s=Kr}s=nx(s,Jf.bind(null,e))}e.callbackPriority=n,e.callbackNode=s}}function Jf(e,n){if(zr=-1,Fr=0,Oe&6)throw Error(ne(327));var s=e.callbackNode;if(Ws()&&e.callbackNode!==s)return null;var l=Jr(e,e===gt?yt:0);if(l===0)return null;if(l&30||l&e.expiredLanes||n)n=fa(e,l);else{n=l;var r=Oe;Oe|=2;var a=Yf();(gt!==e||yt!==n)&&(bn=null,Xs=at()+500,ms(e,n));do try{Ih();break}catch(o){Qf(e,o)}while(!0);Qo(),da.current=a,Oe=r,dt!==null?n=0:(gt=null,yt=0,n=mt)}if(n!==0){if(n===2&&(r=Hi(e),r!==0&&(l=r,n=jo(e,r))),n===1)throw s=Vl,ms(e,0),qn(e,l),$t(e,at()),s;if(n===6)qn(e,l);else{if(r=e.current.alternate,!(l&30)&&!kh(r)&&(n=fa(e,l),n===2&&(a=Hi(e),a!==0&&(l=a,n=jo(e,a))),n===1))throw s=Vl,ms(e,0),qn(e,l),$t(e,at()),s;switch(e.finishedWork=r,e.finishedLanes=l,n){case 0:case 1:throw Error(ne(345));case 2:is(e,_t,bn);break;case 3:if(qn(e,l),(l&130023424)===l&&(n=uc+500-at(),10<n)){if(Jr(e,0)!==0)break;if(r=e.suspendedLanes,(r&l)!==l){Et(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=eo(is.bind(null,e,_t,bn),n);break}is(e,_t,bn);break;case 4:if(qn(e,l),(l&4194240)===l)break;for(n=e.eventTimes,r=-1;0<l;){var i=31-an(l);a=1<<i,i=n[i],i>r&&(r=i),l&=~a}if(l=r,l=at()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*Sh(l/1960))-l,10<l){e.timeoutHandle=eo(is.bind(null,e,_t,bn),l);break}is(e,_t,bn);break;case 5:is(e,_t,bn);break;default:throw Error(ne(329))}}}return $t(e,at()),e.callbackNode===s?Jf.bind(null,e):null}function jo(e,n){var s=Cl;return e.current.memoizedState.isDehydrated&&(ms(e,n).flags|=256),e=fa(e,n),e!==2&&(n=_t,_t=s,n!==null&&wo(n)),e}function wo(e){_t===null?_t=e:_t.push.apply(_t,e)}function kh(e){for(var n=e;;){if(n.flags&16384){var s=n.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var l=0;l<s.length;l++){var r=s[l],a=r.getSnapshot;r=r.value;try{if(!cn(a(),r))return!1}catch{return!1}}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function qn(e,n){for(n&=~dc,n&=~Ma,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var s=31-an(n),l=1<<s;e[s]=-1,n&=~l}}function Td(e){if(Oe&6)throw Error(ne(327));Ws();var n=Jr(e,0);if(!(n&1))return $t(e,at()),null;var s=fa(e,n);if(e.tag!==0&&s===2){var l=Hi(e);l!==0&&(n=l,s=jo(e,l))}if(s===1)throw s=Vl,ms(e,0),qn(e,n),$t(e,at()),s;if(s===6)throw Error(ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,is(e,_t,bn),$t(e,at()),null}function mc(e,n){var s=Oe;Oe|=1;try{return e(n)}finally{Oe=s,Oe===0&&(Xs=at()+500,Ca&&ns())}}function ys(e){zn!==null&&zn.tag===0&&!(Oe&6)&&Ws();var n=Oe;Oe|=1;var s=Yt.transition,l=Ge;try{if(Yt.transition=null,Ge=1,e)return e()}finally{Ge=l,Yt.transition=s,Oe=n,!(Oe&6)&&ns()}}function fc(){Ot=Ds.current,Ze(Ds)}function ms(e,n){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,th(s)),dt!==null)for(s=dt.return;s!==null;){var l=s;switch(Vo(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&ea();break;case 3:Qs(),Ze(Bt),Ze(kt),nc();break;case 5:tc(l);break;case 4:Qs();break;case 13:Ze(tt);break;case 19:Ze(tt);break;case 10:Yo(l.type._context);break;case 22:case 23:fc()}s=s.return}if(gt=e,dt=e=Qn(e.current,null),yt=Ot=n,mt=0,Vl=null,dc=Ma=hs=0,_t=Cl=null,cs!==null){for(n=0;n<cs.length;n++)if(s=cs[n],l=s.interleaved,l!==null){s.interleaved=null;var r=l.next,a=s.pending;if(a!==null){var i=a.next;a.next=r,l.next=i}s.pending=l}cs=null}return e}function Qf(e,n){do{var s=dt;try{if(Qo(),Dr.current=ca,oa){for(var l=nt.memoizedState;l!==null;){var r=l.queue;r!==null&&(r.pending=null),l=l.next}oa=!1}if(gs=0,xt=ut=nt=null,Sl=!1,Gl=0,cc.current=null,s===null||s.return===null){mt=1,Vl=n,dt=null;break}e:{var a=e,i=s.return,o=s,c=n;if(n=yt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=o,p=u.tag;if(!(u.mode&1)&&(p===0||p===11||p===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=yd(i);if(h!==null){h.flags&=-257,bd(h,i,o,a,n),h.mode&1&&hd(a,d,n),n=h,c=d;var y=n.updateQueue;if(y===null){var b=new Set;b.add(c),n.updateQueue=b}else y.add(c);break e}else{if(!(n&1)){hd(a,d,n),xc();break e}c=Error(ne(426))}}else if(et&&o.mode&1){var v=yd(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),bd(v,i,o,a,n),Ko(Ys(c,o));break e}}a=c=Ys(c,o),mt!==4&&(mt=2),Cl===null?Cl=[a]:Cl.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,n&=-n,a.lanes|=n;var g=Af(a,c,n);ud(a,g);break e;case 1:o=c;var x=a.type,j=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Kn===null||!Kn.has(j)))){a.flags|=65536,n&=-n,a.lanes|=n;var w=Rf(a,o,n);ud(a,w);break e}}a=a.return}while(a!==null)}Zf(s)}catch(S){n=S,dt===s&&s!==null&&(dt=s=s.return);continue}break}while(!0)}function Yf(){var e=da.current;return da.current=ca,e===null?ca:e}function xc(){(mt===0||mt===3||mt===2)&&(mt=4),gt===null||!(hs&268435455)&&!(Ma&268435455)||qn(gt,yt)}function fa(e,n){var s=Oe;Oe|=2;var l=Yf();(gt!==e||yt!==n)&&(bn=null,ms(e,n));do try{Ch();break}catch(r){Qf(e,r)}while(!0);if(Qo(),Oe=s,da.current=l,dt!==null)throw Error(ne(261));return gt=null,yt=0,mt}function Ch(){for(;dt!==null;)Xf(dt)}function Ih(){for(;dt!==null&&!Xp();)Xf(dt)}function Xf(e){var n=tx(e.alternate,e,Ot);e.memoizedProps=e.pendingProps,n===null?Zf(e):dt=n,cc.current=null}function Zf(e){var n=e;do{var s=n.alternate;if(e=n.return,n.flags&32768){if(s=vh(s,n),s!==null){s.flags&=32767,dt=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mt=6,dt=null;return}}else if(s=bh(s,n,Ot),s!==null){dt=s;return}if(n=n.sibling,n!==null){dt=n;return}dt=n=e}while(n!==null);mt===0&&(mt=5)}function is(e,n,s){var l=Ge,r=Yt.transition;try{Yt.transition=null,Ge=1,Eh(e,n,s,l)}finally{Yt.transition=r,Ge=l}return null}function Eh(e,n,s,l){do Ws();while(zn!==null);if(Oe&6)throw Error(ne(327));s=e.finishedWork;var r=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(ne(177));e.callbackNode=null,e.callbackPriority=0;var a=s.lanes|s.childLanes;if(og(e,a),e===gt&&(dt=gt=null,yt=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||wr||(wr=!0,nx(Kr,function(){return Ws(),null})),a=(s.flags&15990)!==0,s.subtreeFlags&15990||a){a=Yt.transition,Yt.transition=null;var i=Ge;Ge=1;var o=Oe;Oe|=4,cc.current=null,wh(e,s),Vf(s,e),Kg(Xi),Qr=!!Yi,Xi=Yi=null,e.current=s,Nh(s),Zp(),Oe=o,Ge=i,Yt.transition=a}else e.current=s;if(wr&&(wr=!1,zn=e,ma=r),a=e.pendingLanes,a===0&&(Kn=null),ng(s.stateNode),$t(e,at()),n!==null)for(l=e.onRecoverableError,s=0;s<n.length;s++)r=n[s],l(r.value,{componentStack:r.stack,digest:r.digest});if(ua)throw ua=!1,e=bo,bo=null,e;return ma&1&&e.tag!==0&&Ws(),a=e.pendingLanes,a&1?e===vo?Il++:(Il=0,vo=e):Il=0,ns(),null}function Ws(){if(zn!==null){var e=_m(ma),n=Yt.transition,s=Ge;try{if(Yt.transition=null,Ge=16>e?16:e,zn===null)var l=!1;else{if(e=zn,zn=null,ma=0,Oe&6)throw Error(ne(331));var r=Oe;for(Oe|=4,ye=e.current;ye!==null;){var a=ye,i=a.child;if(ye.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(ye=d;ye!==null;){var u=ye;switch(u.tag){case 0:case 11:case 15:kl(8,u,a)}var p=u.child;if(p!==null)p.return=u,ye=p;else for(;ye!==null;){u=ye;var m=u.sibling,h=u.return;if(Gf(u),u===d){ye=null;break}if(m!==null){m.return=h,ye=m;break}ye=h}}}var y=a.alternate;if(y!==null){var b=y.child;if(b!==null){y.child=null;do{var v=b.sibling;b.sibling=null,b=v}while(b!==null)}}ye=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,ye=i;else e:for(;ye!==null;){if(a=ye,a.flags&2048)switch(a.tag){case 0:case 11:case 15:kl(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,ye=g;break e}ye=a.return}}var x=e.current;for(ye=x;ye!==null;){i=ye;var j=i.child;if(i.subtreeFlags&2064&&j!==null)j.return=i,ye=j;else e:for(i=x;ye!==null;){if(o=ye,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Pa(9,o)}}catch(S){lt(o,o.return,S)}if(o===i){ye=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,ye=w;break e}ye=o.return}}if(Oe=r,ns(),gn&&typeof gn.onPostCommitFiberRoot=="function")try{gn.onPostCommitFiberRoot(ja,e)}catch{}l=!0}return l}finally{Ge=s,Yt.transition=n}}return!1}function _d(e,n,s){n=Ys(s,n),n=Af(e,n,1),e=Vn(e,n,1),n=Et(),e!==null&&(er(e,1,n),$t(e,n))}function lt(e,n,s){if(e.tag===3)_d(e,e,s);else for(;n!==null;){if(n.tag===3){_d(n,e,s);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Kn===null||!Kn.has(l))){e=Ys(s,e),e=Rf(n,e,1),n=Vn(n,e,1),e=Et(),n!==null&&(er(n,1,e),$t(n,e));break}}n=n.return}}function Ph(e,n,s){var l=e.pingCache;l!==null&&l.delete(n),n=Et(),e.pingedLanes|=e.suspendedLanes&s,gt===e&&(yt&s)===s&&(mt===4||mt===3&&(yt&130023424)===yt&&500>at()-uc?ms(e,0):dc|=s),$t(e,n)}function ex(e,n){n===0&&(e.mode&1?(n=mr,mr<<=1,!(mr&130023424)&&(mr=4194304)):n=1);var s=Et();e=Cn(e,n),e!==null&&(er(e,n,s),$t(e,s))}function Mh(e){var n=e.memoizedState,s=0;n!==null&&(s=n.retryLane),ex(e,s)}function Th(e,n){var s=0;switch(e.tag){case 13:var l=e.stateNode,r=e.memoizedState;r!==null&&(s=r.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(ne(314))}l!==null&&l.delete(n),ex(e,s)}var tx;tx=function(e,n,s){if(e!==null)if(e.memoizedProps!==n.pendingProps||Bt.current)Rt=!0;else{if(!(e.lanes&s)&&!(n.flags&128))return Rt=!1,yh(e,n,s);Rt=!!(e.flags&131072)}else Rt=!1,et&&n.flags&1048576&&lf(n,sa,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;Ur(e,n),e=n.pendingProps;var r=Vs(n,kt.current);Gs(n,s),r=lc(null,n,l,e,r,s);var a=rc();return n.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Lt(l)?(a=!0,ta(n)):a=!1,n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Zo(n),r.updater=Ea,n.stateNode=r,r._reactInternals=n,io(n,l,e,s),n=uo(null,n,l,!0,a,s)):(n.tag=0,et&&a&&Ho(n),It(null,n,r,s),n=n.child),n;case 16:l=n.elementType;e:{switch(Ur(e,n),e=n.pendingProps,r=l._init,l=r(l._payload),n.type=l,r=n.tag=Ah(l),e=sn(l,e),r){case 0:n=co(null,n,l,e,s);break e;case 1:n=wd(null,n,l,e,s);break e;case 11:n=vd(null,n,l,e,s);break e;case 14:n=jd(null,n,l,sn(l.type,e),s);break e}throw Error(ne(306,l,""))}return n;case 0:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:sn(l,r),co(e,n,l,r,s);case 1:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:sn(l,r),wd(e,n,l,r,s);case 3:e:{if(Of(n),e===null)throw Error(ne(387));l=n.pendingProps,a=n.memoizedState,r=a.element,uf(e,n),aa(n,l,null,s);var i=n.memoizedState;if(l=i.element,a.isDehydrated)if(a={element:l,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},n.updateQueue.baseState=a,n.memoizedState=a,n.flags&256){r=Ys(Error(ne(423)),n),n=Nd(e,n,l,s,r);break e}else if(l!==r){r=Ys(Error(ne(424)),n),n=Nd(e,n,l,s,r);break e}else for(Dt=Hn(n.stateNode.containerInfo.firstChild),qt=n,et=!0,rn=null,s=cf(n,null,l,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ks(),l===r){n=In(e,n,s);break e}It(e,n,l,s)}n=n.child}return n;case 5:return mf(n),e===null&&lo(n),l=n.type,r=n.pendingProps,a=e!==null?e.memoizedProps:null,i=r.children,Zi(l,r)?i=null:a!==null&&Zi(l,a)&&(n.flags|=32),$f(e,n),It(e,n,i,s),n.child;case 6:return e===null&&lo(n),null;case 13:return Df(e,n,s);case 4:return ec(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Js(n,null,l,s):It(e,n,l,s),n.child;case 11:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:sn(l,r),vd(e,n,l,r,s);case 7:return It(e,n,n.pendingProps,s),n.child;case 8:return It(e,n,n.pendingProps.children,s),n.child;case 12:return It(e,n,n.pendingProps.children,s),n.child;case 10:e:{if(l=n.type._context,r=n.pendingProps,a=n.memoizedProps,i=r.value,Qe(la,l._currentValue),l._currentValue=i,a!==null)if(cn(a.value,i)){if(a.children===r.children&&!Bt.current){n=In(e,n,s);break e}}else for(a=n.child,a!==null&&(a.return=n);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===l){if(a.tag===1){c=Nn(-1,s&-s),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}a.lanes|=s,c=a.alternate,c!==null&&(c.lanes|=s),ro(a.return,s,n),o.lanes|=s;break}c=c.next}}else if(a.tag===10)i=a.type===n.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ne(341));i.lanes|=s,o=i.alternate,o!==null&&(o.lanes|=s),ro(i,s,n),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===n){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}It(e,n,r.children,s),n=n.child}return n;case 9:return r=n.type,l=n.pendingProps.children,Gs(n,s),r=Xt(r),l=l(r),n.flags|=1,It(e,n,l,s),n.child;case 14:return l=n.type,r=sn(l,n.pendingProps),r=sn(l.type,r),jd(e,n,l,r,s);case 15:return Bf(e,n,n.type,n.pendingProps,s);case 17:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:sn(l,r),Ur(e,n),n.tag=1,Lt(l)?(e=!0,ta(n)):e=!1,Gs(n,s),_f(n,l,r),io(n,l,r,s),uo(null,n,l,!0,e,s);case 19:return qf(e,n,s);case 22:return Lf(e,n,s)}throw Error(ne(156,n.tag))};function nx(e,n){return Em(e,n)}function _h(e,n,s,l){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(e,n,s,l){return new _h(e,n,s,l)}function pc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ah(e){if(typeof e=="function")return pc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ro)return 11;if(e===Bo)return 14}return 2}function Qn(e,n){var s=e.alternate;return s===null?(s=Qt(e.tag,n,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=n,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,n=e.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Gr(e,n,s,l,r,a){var i=2;if(l=e,typeof e=="function")pc(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ps:return fs(s.children,r,a,n);case Ao:i=8,r|=8;break;case Ti:return e=Qt(12,s,n,r|2),e.elementType=Ti,e.lanes=a,e;case _i:return e=Qt(13,s,n,r),e.elementType=_i,e.lanes=a,e;case Ai:return e=Qt(19,s,n,r),e.elementType=Ai,e.lanes=a,e;case um:return Ta(s,r,a,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case cm:i=10;break e;case dm:i=9;break e;case Ro:i=11;break e;case Bo:i=14;break e;case $n:i=16,l=null;break e}throw Error(ne(130,e==null?e:typeof e,""))}return n=Qt(i,s,n,r),n.elementType=e,n.type=l,n.lanes=a,n}function fs(e,n,s,l){return e=Qt(7,e,l,n),e.lanes=s,e}function Ta(e,n,s,l){return e=Qt(22,e,l,n),e.elementType=um,e.lanes=s,e.stateNode={isHidden:!1},e}function hi(e,n,s){return e=Qt(6,e,null,n),e.lanes=s,e}function yi(e,n,s){return n=Qt(4,e.children!==null?e.children:[],e.key,n),n.lanes=s,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Rh(e,n,s,l,r){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xa(0),this.expirationTimes=Xa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xa(0),this.identifierPrefix=l,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function gc(e,n,s,l,r,a,i,o,c){return e=new Rh(e,n,s,o,c),n===1?(n=1,a===!0&&(n|=8)):n=0,a=Qt(3,null,null,n),e.current=a,a.stateNode=e,a.memoizedState={element:l,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zo(a),e}function Bh(e,n,s){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Es,key:l==null?null:""+l,children:e,containerInfo:n,implementation:s}}function sx(e){if(!e)return Zn;e=e._reactInternals;e:{if(vs(e)!==e||e.tag!==1)throw Error(ne(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Lt(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(ne(171))}if(e.tag===1){var s=e.type;if(Lt(s))return nf(e,s,n)}return n}function lx(e,n,s,l,r,a,i,o,c){return e=gc(s,l,!0,e,r,a,i,o,c),e.context=sx(null),s=e.current,l=Et(),r=Jn(s),a=Nn(l,r),a.callback=n??null,Vn(s,a,r),e.current.lanes=r,er(e,r,l),$t(e,l),e}function _a(e,n,s,l){var r=n.current,a=Et(),i=Jn(r);return s=sx(s),n.context===null?n.context=s:n.pendingContext=s,n=Nn(a,i),n.payload={element:e},l=l===void 0?null:l,l!==null&&(n.callback=l),e=Vn(r,n,i),e!==null&&(on(e,r,i,a),Or(e,r,i)),i}function xa(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ad(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<n?s:n}}function hc(e,n){Ad(e,n),(e=e.alternate)&&Ad(e,n)}function Lh(){return null}var rx=typeof reportError=="function"?reportError:function(e){console.error(e)};function yc(e){this._internalRoot=e}Aa.prototype.render=yc.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(ne(409));_a(e,n,null,null)};Aa.prototype.unmount=yc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;ys(function(){_a(null,e,null,null)}),n[kn]=null}};function Aa(e){this._internalRoot=e}Aa.prototype.unstable_scheduleHydration=function(e){if(e){var n=Bm();e={blockedOn:null,target:e,priority:n};for(var s=0;s<Dn.length&&n!==0&&n<Dn[s].priority;s++);Dn.splice(s,0,e),s===0&&$m(e)}};function bc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ra(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Rd(){}function $h(e,n,s,l,r){if(r){if(typeof l=="function"){var a=l;l=function(){var d=xa(i);a.call(d)}}var i=lx(n,l,e,0,null,!1,!1,"",Rd);return e._reactRootContainer=i,e[kn]=i.current,Dl(e.nodeType===8?e.parentNode:e),ys(),i}for(;r=e.lastChild;)e.removeChild(r);if(typeof l=="function"){var o=l;l=function(){var d=xa(c);o.call(d)}}var c=gc(e,0,!1,null,null,!1,!1,"",Rd);return e._reactRootContainer=c,e[kn]=c.current,Dl(e.nodeType===8?e.parentNode:e),ys(function(){_a(n,c,s,l)}),c}function Ba(e,n,s,l,r){var a=s._reactRootContainer;if(a){var i=a;if(typeof r=="function"){var o=r;r=function(){var c=xa(i);o.call(c)}}_a(n,i,e,r)}else i=$h(s,n,e,r,l);return xa(i)}Am=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var s=hl(n.pendingLanes);s!==0&&(Oo(n,s|1),$t(n,at()),!(Oe&6)&&(Xs=at()+500,ns()))}break;case 13:ys(function(){var l=Cn(e,1);if(l!==null){var r=Et();on(l,e,1,r)}}),hc(e,1)}};Do=function(e){if(e.tag===13){var n=Cn(e,134217728);if(n!==null){var s=Et();on(n,e,134217728,s)}hc(e,134217728)}};Rm=function(e){if(e.tag===13){var n=Jn(e),s=Cn(e,n);if(s!==null){var l=Et();on(s,e,n,l)}hc(e,n)}};Bm=function(){return Ge};Lm=function(e,n){var s=Ge;try{return Ge=e,n()}finally{Ge=s}};Fi=function(e,n,s){switch(n){case"input":if(Li(e,s),n=s.name,s.type==="radio"&&n!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<s.length;n++){var l=s[n];if(l!==e&&l.form===e.form){var r=ka(l);if(!r)throw Error(ne(90));fm(l),Li(l,r)}}}break;case"textarea":pm(e,s);break;case"select":n=s.value,n!=null&&qs(e,!!s.multiple,n,!1)}};wm=mc;Nm=ys;var Oh={usingClientEntryPoint:!1,Events:[nr,As,ka,vm,jm,mc]},xl={findFiberByHostInstance:os,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Dh={bundleType:xl.bundleType,version:xl.version,rendererPackageName:xl.rendererPackageName,rendererConfig:xl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Cm(e),e===null?null:e.stateNode},findFiberByHostInstance:xl.findFiberByHostInstance||Lh,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nr.isDisabled&&Nr.supportsFiber)try{ja=Nr.inject(Dh),gn=Nr}catch{}}zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Oh;zt.createPortal=function(e,n){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bc(n))throw Error(ne(200));return Bh(e,n,null,s)};zt.createRoot=function(e,n){if(!bc(e))throw Error(ne(299));var s=!1,l="",r=rx;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(r=n.onRecoverableError)),n=gc(e,1,!1,null,null,s,!1,l,r),e[kn]=n.current,Dl(e.nodeType===8?e.parentNode:e),new yc(n)};zt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(ne(188)):(e=Object.keys(e).join(","),Error(ne(268,e)));return e=Cm(n),e=e===null?null:e.stateNode,e};zt.flushSync=function(e){return ys(e)};zt.hydrate=function(e,n,s){if(!Ra(n))throw Error(ne(200));return Ba(null,e,n,!0,s)};zt.hydrateRoot=function(e,n,s){if(!bc(e))throw Error(ne(405));var l=s!=null&&s.hydratedSources||null,r=!1,a="",i=rx;if(s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(i=s.onRecoverableError)),n=lx(n,null,e,1,s??null,r,!1,a,i),e[kn]=n.current,Dl(e),l)for(e=0;e<l.length;e++)s=l[e],r=s._getVersion,r=r(s._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[s,r]:n.mutableSourceEagerHydrationData.push(s,r);return new Aa(n)};zt.render=function(e,n,s){if(!Ra(n))throw Error(ne(200));return Ba(null,e,n,!1,s)};zt.unmountComponentAtNode=function(e){if(!Ra(e))throw Error(ne(40));return e._reactRootContainer?(ys(function(){Ba(null,null,e,!1,function(){e._reactRootContainer=null,e[kn]=null})}),!0):!1};zt.unstable_batchedUpdates=mc;zt.unstable_renderSubtreeIntoContainer=function(e,n,s,l){if(!Ra(s))throw Error(ne(200));if(e==null||e._reactInternals===void 0)throw Error(ne(38));return Ba(e,n,s,!1,l)};zt.version="18.3.1-next-f1338f8080-20240426";function ax(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ax)}catch(e){console.error(e)}}ax(),rm.exports=zt;var qh=rm.exports,Bd=qh;Pi.createRoot=Bd.createRoot,Pi.hydrateRoot=Bd.hydrateRoot;const z=({children:e,onClick:n,colorScheme:s="accent",disabled:l=!1,className:r="",type:a="button",title:i})=>{const o="px-4 py-2 font-bold rounded-lg transition-all duration-150 ease-in-out border border-color shadow-lg active:translate-y-0.5 active:shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-primary disabled:bg-secondary disabled:opacity-70 disabled:cursor-not-allowed",c={accent:"bg-accent hover:bg-accent-hover text-white focus:ring-accent",blue:"bg-blue-600 hover:bg-blue-500 text-white focus:ring-blue-400",red:"bg-danger hover:bg-danger-hover text-white focus:ring-red-400",gray:"bg-secondary hover:bg-tertiary text-secondary focus:ring-color",green:"bg-success hover:opacity-90 text-white focus:ring-green-400",yellow:"bg-yellow-500 hover:bg-yellow-400 text-black focus:ring-yellow-300",purple:"bg-purple-600 hover:bg-purple-500 text-white focus:ring-purple-400",orange:"bg-orange-500 hover:bg-orange-400 text-white focus:ring-orange-300"};return t.jsx("button",{type:a,onClick:n,disabled:l,className:`${o} ${c[s]} ${r}`,title:i,children:e})},Uh=({userId:e,userName:n,avatarUrl:s,borderUrl:l,size:r=40,className:a=""})=>{const i=r/16,o=l&&(l.startsWith("#")||l.startsWith("conic-gradient")),c=l&&!o,d=s||"/images/profiles/profile1.png";if(c){let u=i*1.4;l.includes("Ring")&&(u=i*1.5);const p={width:`${i}rem`,height:`${i}rem`};return l.includes("Ring5.png")&&(p.transform=`translateX(-${i*.2}rem)`),t.jsxs("div",{className:`relative flex-shrink-0 flex items-center justify-center ${a}`,style:{width:`${u}rem`,height:`${u}rem`},children:[t.jsx("div",{className:"rounded-full overflow-hidden bg-gray-700",style:p,children:t.jsx("img",{src:d,alt:n,className:"w-full h-full object-cover"})}),t.jsx("img",{src:l,alt:"",className:"absolute inset-0 w-full h-full pointer-events-none object-contain","aria-hidden":"true"})]})}if(o){const u=i*.85,p=l.startsWith("conic-gradient");return t.jsx("div",{className:`relative flex items-center justify-center rounded-full flex-shrink-0 ${a}`,style:{width:`${i}rem`,height:`${i}rem`,...p?{background:l}:{backgroundColor:l}},children:t.jsx("div",{className:"flex items-center justify-center rounded-full overflow-hidden bg-gray-700",style:{width:`${u}rem`,height:`${u}rem`},children:t.jsx("img",{src:d,alt:n,className:"w-full h-full object-cover"})})})}return t.jsx("div",{className:`rounded-full overflow-hidden bg-gray-700 flex-shrink-0 ${a}`,style:{width:`${i}rem`,height:`${i}rem`},children:t.jsx("img",{src:d,alt:n,className:"w-full h-full object-cover"})})},Ce=Pn.memo(Uh);var $;(function(e){e[e.None=0]="None",e[e.Black=1]="Black",e[e.White=2]="White"})($||($={}));var T;(function(e){e.Standard=" ",e.Capture=" ",e.Speed=" ",e.Base=" ",e.Hidden=" ",e.Missile=" ",e.Mix=" ",e.Dice=" ",e.Omok="",e.Ttamok="",e.Thief=" ",e.Alkkagi="",e.Curling=" "})(T||(T={}));var pt;(function(e){e.Sprout="",e.Rookie="",e.Rising="",e.Ace="",e.Diamond="",e.Master="",e.Grandmaster="",e.Challenger=""})(pt||(pt={}));var Ld;(function(e){e.Online="online",e.Waiting="waiting",e.Resting="resting",e.Negotiating="negotiating",e.InGame="in-game",e.Spectating="spectating"})(Ld||(Ld={}));var pa;(function(e){e.Basic="basic"})(pa||(pa={}));var ga;(function(e){e.TurnByTurn=" ",e.Simultaneous=" "})(ga||(ga={}));var Zs;(function(e){e.Normal="",e.Battle=""})(Zs||(Zs={}));var N;(function(e){e.Concentration="",e.ThinkingSpeed="",e.Judgment="",e.Calculation="",e.CombatPower="",e.Stability=""})(N||(N={}));var Fe;(function(e){e.ActionPointMax=" ",e.ActionPointRegen=" ",e.StrategyXpBonus="  ",e.PlayfulXpBonus="  ",e.GoldBonus="   ",e.ItemDropRate="  ",e.MaterialDropRate="  "})(Fe||(Fe={}));var it;(function(e){e.MannerActionCooldown="    ",e.StrategicGoldBonus="    20% (10~50) 5",e.PlayfulGoldBonus="   60 20% (10~50) 5",e.DiceGoOddBonus=" / ",e.AlkkagiSlowBonus="     1",e.AlkkagiAimingBonus="     1"})(it||(it={}));var Pe;(function(e){e.="",e.="",e.="",e.="",e.=""})(Pe||(Pe={}));const el="ai-player-01",Ye=[{mode:T.Standard,name:" ",description:"  .",available:!0,image:"/images/simbols/simbol1.png"},{mode:T.Capture,name:" ",description:"       .",available:!0,image:"/images/simbols/simbol2.png"},{mode:T.Speed,name:" ",description:"       .       .",available:!0,image:"/images/simbols/simbol3.png"},{mode:T.Base,name:" ",description:"  ''     .   ,    /    .        .",available:!0,image:"/images/simbols/simbol4.png"},{mode:T.Hidden,name:" ",description:"   ''   ,  ''       .        ,      .",available:!0,image:"/images/simbols/simbol5.png"},{mode:T.Missile,name:" ",description:"        .",available:!0,image:"/images/simbols/simbol6.png"},{mode:T.Mix,name:" ",description:", , , ,    2    .",available:!0,image:"/images/simbols/simbol7.png"}],rt=[{mode:T.Dice,name:" ",description:" 3 ,          .     .",available:!0,image:"/images/simbols/simbolp1.png"},{mode:T.Omok,name:"",description:"        .",available:!0,image:"/images/simbols/simbolp2.png"},{mode:T.Ttamok,name:"",description:"       .",available:!0,image:"/images/simbols/simbolp3.png"},{mode:T.Thief,name:"",description:"() ()    5 ,      .",available:!0,image:"/images/simbols/simbolp4.png"},{mode:T.Alkkagi,name:"",description:"        .",available:!0,image:"/images/simbols/simbolp5.png"},{mode:T.Curling,name:"",description:"    ()      .",available:!0,image:"/images/simbols/simbolp6.png"}],$d=[19,13,9],Od=[19,15],Dd=[13,11,9,7],qd=[7,9,11,13,19],Ud=[19,13,11,9,7],zd=[9,13,19],Fd=[19,13,9],Gd=[5,10,15,20,25,30],zh=[10,20,30],Wd=[1,2,3],Hd=[1,2,3,4,5,6,7,8,9,10],Vd=Array.from({length:15},(e,n)=>n+1),Fh=[{value:0,label:""},{value:5,label:"5"},{value:10,label:"10"},{value:15,label:"15"},{value:20,label:"20"},{value:30,label:"30"},{value:40,label:"40"},{value:50,label:"50"},{value:60,label:"1"},{value:120,label:"2"},{value:180,label:"3"}],Gh=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:30,label:"30"}],Wh=[1,2,3,4,5,6,7,8,9,10],Hh=[10,20,30,40,50,60],bi=[3,4,5,6,7,8,9,10],ix=6.5,Vh=5,Kd=[0,1,2,3],Jd=[0,1,2,3],Kh=[1,2,3],Jh=[1,2,3],Qd=[0,1,2,3,4,5],Yd={boardSize:19,timeLimit:10,byoyomiCount:3,byoyomiTime:30,baseStones:4,diceGoVariant:pa.Basic,diceGoRounds:3,oddDiceCount:1,evenDiceCount:1,captureTarget:20,timeIncrement:5,hiddenStoneCount:2,scanCount:5,missileCount:5,mixedModes:[T.Hidden,T.Speed],hasOverlineForbidden:!0,has33Forbidden:!0,alkkagiPlacementType:ga.TurnByTurn,alkkagiLayout:Zs.Normal,alkkagiStoneCount:5,alkkagiGaugeSpeed:700,alkkagiSlowItemCount:2,alkkagiAimingLineItemCount:2,alkkagiRounds:1,curlingStoneCount:5,curlingGaugeSpeed:700,curlingSlowItemCount:2,curlingAimingLineItemCount:2,curlingRounds:3,komi:ix,player1Color:$.Black,aiDifficulty:1},Qh=[5,7,10],Yh=30,Sr=30,Xd=30;pa.Basic+"";const Zd=[3,5,7,9],Xh=30,Zh=30,e0=30,No=[{value:1e3,label:"x1 ()"},{value:700,label:"x2 ()"},{value:400,label:"x3 ()"}],eu={[$.Black]:[{x:7,y:4,width:5,height:2},{x:4,y:7,width:2,height:4},{x:13,y:7,width:2,height:4},{x:7,y:13,width:2,height:2},{x:10,y:13,width:2,height:2}],[$.White]:[{x:4,y:4,width:2,height:2},{x:13,y:4,width:2,height:2},{x:7,y:7,width:5,height:2},{x:7,y:10,width:5,height:2}]},t0=5,tu=[3,5,7],n0=30,So=[{value:1e3,label:"x1 ()"},{value:700,label:"x2 ()"},{value:400,label:"x3 ()"}],La={fan:"images/equipments/EmptyFanSlot.png",board:"images/equipments/EmptyBoardSlot.png",top:"images/equipments/EmptyTopSlot.png",bottom:"images/equipments/EmptyBottomSlot.png",bowl:"images/equipments/EmptyStoneBoxSlot.png",stones:"images/equipments/EmptyStoneSlot.png"},En={normal:1,uncommon:1,rare:5,epic:12,legendary:20,mythic:30},vc=[{name:"  ",slot:"fan",image:"images/equipments/Fan1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:"  ",slot:"fan",image:"images/equipments/Fan2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"fan",image:"images/equipments/Fan3.png",grade:"rare",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"fan",image:"images/equipments/Fan4.png",grade:"epic",stars:0,type:"equipment",description:"        ."},{name:"  ",slot:"fan",image:"images/equipments/Fan5.png",grade:"legendary",stars:0,type:"equipment",description:"      ."},{name:"  ",slot:"fan",image:"images/equipments/Fan6.png",grade:"mythic",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"board",image:"images/equipments/Board1.png",grade:"normal",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"board",image:"images/equipments/Board2.png",grade:"uncommon",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"board",image:"images/equipments/Board3.png",grade:"rare",stars:0,type:"equipment",description:"       ."},{name:" ",slot:"board",image:"images/equipments/Board4.png",grade:"epic",stars:0,type:"equipment",description:"    ."},{name:" ",slot:"board",image:"images/equipments/Board5.png",grade:"legendary",stars:0,type:"equipment",description:"       ."},{name:" ",slot:"board",image:"images/equipments/Board6.png",grade:"mythic",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top1.png",grade:"normal",stars:0,type:"equipment",description:"    ."},{name:"  ",slot:"top",image:"images/equipments/Top2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top3.png",grade:"rare",stars:0,type:"equipment",description:"    ."},{name:"  ",slot:"top",image:"images/equipments/Top4.png",grade:"epic",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top5.png",grade:"legendary",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top6.png",grade:"mythic",stars:0,type:"equipment",description:"       ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom3.png",grade:"rare",stars:0,type:"equipment",description:"      ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom4.png",grade:"epic",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom5.png",grade:"legendary",stars:0,type:"equipment",description:"      ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom6.png",grade:"mythic",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox3.png",grade:"rare",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox4.png",grade:"epic",stars:0,type:"equipment",description:"       ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox5.png",grade:"legendary",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox6.png",grade:"mythic",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"stones",image:"images/equipments/Stone1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:" ",slot:"stones",image:"images/equipments/Stone2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"stones",image:"images/equipments/Stone3.png",grade:"rare",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"stones",image:"images/equipments/Stone4.png",grade:"epic",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"stones",image:"images/equipments/Stone5.png",grade:"legendary",stars:0,type:"equipment",description:" ,      ."},{name:" ",slot:"stones",image:"images/equipments/Stone6.png",grade:"mythic",stars:0,type:"equipment",description:"      ."}],js=[{name:"  I",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox1.png",grade:"normal"},{name:"  II",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox2.png",grade:"uncommon"},{name:"  III",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox3.png",grade:"rare"},{name:"  IV",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox4.png",grade:"epic"},{name:"  V",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox5.png",grade:"legendary"},{name:"  VI",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox6.png",grade:"mythic"},{name:"  I",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox1.png",grade:"normal"},{name:"  II",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox2.png",grade:"uncommon"},{name:"  III",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox3.png",grade:"rare"},{name:"  IV",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox4.png",grade:"epic"},{name:"  V",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox5.png",grade:"legendary"},{name:"  VI",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox6.png",grade:"mythic"},{name:" 1",description:"10 ~ 500  ",type:"consumable",slot:null,image:"/images/Box/GoldBox1.png",grade:"normal"},{name:" 2",description:"100 ~ 1,000  ",type:"consumable",slot:null,image:"/images/Box/GoldBox2.png",grade:"uncommon"},{name:" 3",description:"500 ~ 3,000  ",type:"consumable",slot:null,image:"/images/Box/GoldBox3.png",grade:"rare"},{name:" 4",description:"1,000 ~ 10,000  ",type:"consumable",slot:null,image:"/images/Box/GoldBox4.png",grade:"epic"},{name:" 1",description:"1 ~ 20  ",type:"consumable",slot:null,image:"/images/Box/DiaBox1.png",grade:"rare"},{name:" 2",description:"10 ~ 30  ",type:"consumable",slot:null,image:"/images/Box/DiaBox2.png",grade:"epic"},{name:" 3",description:"20 ~ 50  ",type:"consumable",slot:null,image:"/images/Box/DiaBox3.png",grade:"legendary"},{name:" 4",description:"30 ~ 100  ",type:"consumable",slot:null,image:"/images/Box/DiaBox4.png",grade:"mythic"}],en={" ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials1.png",grade:"normal"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials2.png",grade:"uncommon"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials3.png",grade:"rare"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials4.png",grade:"epic"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials5.png",grade:"legendary"}},$a={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},El={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},s0=[100,90,80,70,60,55,50,45,40,35],l0={normal:5,uncommon:4,rare:3,epic:2,legendary:1,mythic:.5},ha={normal:[[{amount:10,name:" "}],[{amount:15,name:" "}],[{amount:20,name:" "}],[{amount:25,name:" "}],[{amount:30,name:" "}],[{amount:30,name:" "}],[{amount:50,name:" "}],[{amount:5,name:" "}],[{amount:10,name:" "}],[{amount:5,name:" "}]],uncommon:[[{amount:20,name:" "}],[{amount:30,name:" "}],[{amount:40,name:" "}],[{amount:50,name:" "}],[{amount:60,name:" "}],[{amount:50,name:" "}],[{amount:10,name:" "}],[{amount:20,name:" "}],[{amount:10,name:" "}],[{amount:20,name:" "}]],rare:[[{amount:10,name:" "}],[{amount:15,name:" "}],[{amount:20,name:" "}],[{amount:25,name:" "}],[{amount:30,name:" "}],[{amount:100,name:" "}],[{amount:20,name:" "}],[{amount:40,name:" "}],[{amount:15,name:" "}],[{amount:30,name:" "}]],epic:[[{amount:20,name:" "}],[{amount:30,name:" "}],[{amount:40,name:" "}],[{amount:50,name:" "}],[{amount:60,name:" "}],[{amount:30,name:" "}],[{amount:50,name:" "}],[{amount:20,name:" "}],[{amount:45,name:" "}],[{amount:80,name:" "}]],legendary:[[{amount:10,name:" "}],[{amount:15,name:" "}],[{amount:20,name:" "}],[{amount:25,name:" "}],[{amount:30,name:" "}],[{amount:100,name:" "}],[{amount:20,name:" "}],[{amount:50,name:" "}],[{amount:100,name:" "}],[{amount:10,name:" "}]],mythic:[[{amount:20,name:" "}],[{amount:30,name:" "}],[{amount:40,name:" "}],[{amount:50,name:" "}],[{amount:60,name:" "}],[{amount:40,name:" "}],[{amount:80,name:" "}],[{amount:10,name:" "}],[{amount:50,name:" "}],[{amount:100,name:" "}]]},r0={normal:50,uncommon:100,rare:200,epic:300,legendary:500,mythic:1e3},us=30,jc=10,a0=100,i0=50,o0=50,c0={[N.Concentration]:{name:"",description:"    .    ,      ."},[N.ThinkingSpeed]:{name:"",description:"   .            ."},[N.Judgment]:{name:"",description:"     .          ."},[N.Calculation]:{name:"",description:"      .       ."},[N.CombatPower]:{name:"",description:"     .           ."},[N.Stability]:{name:"",description:"    .         ."}},d0={fan:{isPercentage:!0,options:{normal:{stats:[N.ThinkingSpeed,N.Concentration],value:4},uncommon:{stats:[N.ThinkingSpeed,N.Concentration],value:6},rare:{stats:[N.ThinkingSpeed,N.Concentration],value:8},epic:{stats:[N.ThinkingSpeed,N.Concentration],value:10},legendary:{stats:[N.ThinkingSpeed,N.Concentration],value:12},mythic:{stats:[N.ThinkingSpeed,N.Concentration],value:15}}},board:{isPercentage:!0,options:{normal:{stats:[N.Stability,N.Calculation],value:4},uncommon:{stats:[N.Stability,N.Calculation],value:6},rare:{stats:[N.Stability,N.Calculation],value:8},epic:{stats:[N.Stability,N.Calculation],value:10},legendary:{stats:[N.Stability,N.Calculation],value:12},mythic:{stats:[N.Stability,N.Calculation],value:15}}},top:{isPercentage:!0,options:{normal:{stats:[N.CombatPower,N.Judgment],value:4},uncommon:{stats:[N.CombatPower,N.Judgment],value:6},rare:{stats:[N.CombatPower,N.Judgment],value:8},epic:{stats:[N.CombatPower,N.Judgment],value:10},legendary:{stats:[N.CombatPower,N.Judgment],value:12},mythic:{stats:[N.CombatPower,N.Judgment],value:15}}},bottom:{isPercentage:!1,options:{normal:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:8},uncommon:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:12},rare:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:16},epic:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:20},legendary:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:24},mythic:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:30}}},stones:{isPercentage:!1,options:{normal:{stats:[N.CombatPower,N.Calculation],value:8},uncommon:{stats:[N.CombatPower,N.Calculation],value:12},rare:{stats:[N.CombatPower,N.Calculation],value:16},epic:{stats:[N.CombatPower,N.Calculation],value:20},legendary:{stats:[N.CombatPower,N.Calculation],value:24},mythic:{stats:[N.CombatPower,N.Calculation],value:30}}},bowl:{isPercentage:!1,options:{normal:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:8},uncommon:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:12},rare:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:16},epic:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:20},legendary:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:24},mythic:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:30}}}},ox={[Fe.ActionPointMax]:{name:" ",description:"  .",isPercentage:!1,range:[2,5]},[Fe.ActionPointRegen]:{name:" ",description:"   .",isPercentage:!0,range:[1,3]},[Fe.StrategyXpBonus]:{name:"  ",description:"      .",isPercentage:!0,range:[1,3]},[Fe.PlayfulXpBonus]:{name:"  ",description:"      .",isPercentage:!0,range:[1,3]},[Fe.GoldBonus]:{name:" ",description:"      .",isPercentage:!0,range:[1,3]},[Fe.ItemDropRate]:{name:"  ",description:"      .",isPercentage:!0,range:[1,2]},[Fe.MaterialDropRate]:{name:"  ",description:"      .",isPercentage:!0,range:[1,3]}},cx={[it.MannerActionCooldown]:{name:"    ",description:"    .",value:()=>30},[it.StrategicGoldBonus]:{name:"  ",description:"    20% (10~50) 5",value:()=>1},[it.PlayfulGoldBonus]:{name:"  ",description:"   60 20% (10~50) 5",value:()=>1},[it.DiceGoOddBonus]:{name:" / ",description:"  /  1 ",value:()=>1},[it.AlkkagiSlowBonus]:{name:"  ",description:"     1",value:()=>1},[it.AlkkagiAimingBonus]:{name:"  ",description:"     1",value:()=>1}},u0={normal:{combatCount:[1,2],specialCount:[0,0],mythicCount:[0,0],combatTier:1},uncommon:{combatCount:[2,3],specialCount:[1,1],mythicCount:[0,0],combatTier:2},rare:{combatCount:[3,3],specialCount:[1,1],mythicCount:[0,0],combatTier:3},epic:{combatCount:[3,4],specialCount:[1,1],mythicCount:[0,0],combatTier:4},legendary:{combatCount:[4,4],specialCount:[1,2],mythicCount:[0,0],combatTier:5},mythic:{combatCount:[4,4],specialCount:[1,2],mythicCount:[1,1],combatTier:6}},m0={fan:{1:[{type:N.Concentration,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!0,range:[1,2]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!0,range:[2,3]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!0,range:[3,5]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!0,range:[4,6]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!0,range:[5,7]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!1,range:[10,15]},{type:N.Judgment,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!0,range:[8,10]},{type:N.Stability,isPercentage:!1,range:[10,15]},{type:N.Calculation,isPercentage:!1,range:[10,15]}]},board:{1:[{type:N.Concentration,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!0,range:[1,2]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!0,range:[2,3]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!0,range:[3,5]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!0,range:[4,6]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!0,range:[5,7]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!1,range:[10,15]},{type:N.Judgment,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!1,range:[10,15]},{type:N.Stability,isPercentage:!0,range:[8,10]},{type:N.Calculation,isPercentage:!1,range:[10,15]}]},top:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.Concentration,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!0,range:[1,2]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!0,range:[1,2]},{type:N.Calculation,isPercentage:!0,range:[1,2]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.Concentration,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!0,range:[2,3]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!0,range:[2,3]},{type:N.Calculation,isPercentage:!0,range:[2,3]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.Concentration,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!0,range:[3,5]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!0,range:[3,5]},{type:N.Calculation,isPercentage:!0,range:[3,5]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.Concentration,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!0,range:[4,6]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!0,range:[4,6]},{type:N.Calculation,isPercentage:!0,range:[4,6]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.Concentration,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!0,range:[5,7]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!0,range:[5,7]},{type:N.Calculation,isPercentage:!0,range:[5,7]}],6:[{type:N.Concentration,isPercentage:!1,range:[10,15]},{type:N.Concentration,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!1,range:[10,15]},{type:N.Judgment,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!0,range:[8,10]},{type:N.Stability,isPercentage:!1,range:[10,15]},{type:N.Stability,isPercentage:!0,range:[8,10]},{type:N.Calculation,isPercentage:!0,range:[8,10]}]},bottom:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!1,range:[8,12]},{type:N.CombatPower,isPercentage:!1,range:[8,12]},{type:N.Judgment,isPercentage:!1,range:[8,12]},{type:N.ThinkingSpeed,isPercentage:!1,range:[8,12]},{type:N.Stability,isPercentage:!1,range:[8,12]},{type:N.Calculation,isPercentage:!1,range:[8,12]}]},stones:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!1,range:[8,12]},{type:N.CombatPower,isPercentage:!1,range:[8,12]},{type:N.Judgment,isPercentage:!1,range:[8,12]},{type:N.ThinkingSpeed,isPercentage:!1,range:[8,12]},{type:N.Stability,isPercentage:!1,range:[8,12]}]},bowl:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!1,range:[8,12]},{type:N.CombatPower,isPercentage:!1,range:[8,12]},{type:N.Judgment,isPercentage:!1,range:[8,12]},{type:N.Stability,isPercentage:!1,range:[8,12]},{type:N.Calculation,isPercentage:!1,range:[8,12]}]}},dx=[20,40,60,80,100],ux=[20,40,60,80,100],mx=[20,40,60,80,100],f0=[{items:[{itemId:" 1",quantity:1}]},{items:[{itemId:" 2",quantity:1}]},{items:[{itemId:"  I",quantity:1}]},{items:[{itemId:"  I",quantity:1}]},{items:[{itemId:" 1",quantity:1}]}],x0=[{items:[{itemId:" 2",quantity:1}]},{items:[{itemId:" 3",quantity:1}]},{items:[{itemId:"  II",quantity:1}]},{items:[{itemId:"  II",quantity:1}]},{items:[{itemId:" 2",quantity:1}]}],p0=[{items:[{itemId:" 3",quantity:1}]},{items:[{itemId:" 4",quantity:1}]},{items:[{itemId:"  III",quantity:1}]},{items:[{itemId:"  III",quantity:1}]},{items:[{itemId:" 3",quantity:1}]}],tl=[{tier:pt.Sprout,name:" ",scoreThreshold:0,icon:"/images/tire/auto1.png"},{tier:pt.Rookie,name:" ",scoreThreshold:1300,icon:"/images/tire/auto2.png"},{tier:pt.Rising,name:" ",scoreThreshold:1400,icon:"/images/tire/auto3.png"},{tier:pt.Ace,name:" ",scoreThreshold:1500,icon:"/images/tire/auto4.png"},{tier:pt.Diamond,name:" ",scoreThreshold:1600,icon:"/images/tire/auto5.png"},{tier:pt.Master,name:" ",scoreThreshold:1700,icon:"/images/tire/auto6.png"},{tier:pt.Grandmaster,name:" ",scoreThreshold:1800,icon:"/images/tire/auto7.png"},{tier:pt.Challenger,name:" ",scoreThreshold:2e3,icon:"/images/tire/auto8.png"}],g0={[pt.Sprout]:[{rankStart:1,rankEnd:1,diamonds:50,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:30,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:15,outcome:"promote"},{rankStart:4,rankEnd:16,diamonds:5,outcome:"maintain"}],[pt.Rookie]:[{rankStart:1,rankEnd:1,diamonds:65,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:40,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:25,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:15,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:5,outcome:"demote"}],[pt.Rising]:[{rankStart:1,rankEnd:1,diamonds:80,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:50,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:35,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:20,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:10,outcome:"demote"}],[pt.Ace]:[{rankStart:1,rankEnd:1,diamonds:95,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:60,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:45,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:25,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:15,outcome:"demote"}],[pt.Diamond]:[{rankStart:1,rankEnd:1,diamonds:110,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:70,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:55,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:30,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:20,outcome:"demote"}],[pt.Master]:[{rankStart:1,rankEnd:1,diamonds:125,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:80,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:65,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:35,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:25,outcome:"demote"}],[pt.Grandmaster]:[{rankStart:1,rankEnd:1,diamonds:150,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:100,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:80,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:50,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:35,outcome:"demote"}],[pt.Challenger]:[{rankStart:1,rankEnd:1,diamonds:200,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:125,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:100,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:75,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:50,outcome:"demote"}]},At=[{name:"",icon:"/images/tire/tire9.png",color:"text-cyan-400",threshold:(e,n,s)=>e>=3500&&n<=100},{name:"",icon:"/images/tire/tire8.png",color:"text-purple-400",threshold:(e,n,s)=>e>=3e3},{name:"",icon:"/images/tire/tire7.png",color:"text-blue-400",threshold:(e,n,s)=>e>=2400},{name:"",icon:"/images/tire/tire6.png",color:"text-teal-400",threshold:(e,n,s)=>e>=2e3},{name:"",icon:"/images/tire/tire5.png",color:"text-yellow-400",threshold:(e,n,s)=>e>=1700},{name:"",icon:"/images/tire/tire4.png",color:"text-gray-300",threshold:(e,n,s)=>e>=1500},{name:"",icon:"/images/tire/tire3.png",color:"text-orange-400",threshold:(e,n,s)=>e>=1400},{name:"",icon:"/images/tire/tire2.png",color:"text-green-400",threshold:(e,n,s)=>e>=1300},{name:"",icon:"/images/tire/tire1.png",color:"text-green-200",threshold:(e,n,s)=>e<1300||s<50}],h0={:{diamonds:75,items:[{itemId:"  I",quantity:1},{itemId:"  I",quantity:1},{itemId:" 1",quantity:1}]},:{diamonds:100,items:[{itemId:"  I",quantity:1},{itemId:"  II",quantity:1},{itemId:" 2",quantity:1}]},:{diamonds:125,items:[{itemId:"  II",quantity:1},{itemId:"  II",quantity:1},{itemId:" 2",quantity:1}]},:{diamonds:150,items:[{itemId:"  II",quantity:1},{itemId:"  III",quantity:1},{itemId:" 3",quantity:1}]},:{diamonds:200,items:[{itemId:"  III",quantity:1},{itemId:"  III",quantity:1},{itemId:" 3",quantity:1}]},:{diamonds:250,items:[{itemId:"  IV",quantity:1},{itemId:"  IV",quantity:1},{itemId:" 4",quantity:1}]},:{diamonds:300,items:[{itemId:"  V",quantity:1},{itemId:"  V",quantity:1},{itemId:" 4",quantity:1}]},:{diamonds:400,items:[{itemId:"  V",quantity:1},{itemId:"  VI",quantity:1},{itemId:" 4",quantity:1}]},:{diamonds:500,items:[{itemId:"  VI",quantity:1},{itemId:"  VI",quantity:1},{itemId:" 4",quantity:1}]}},nu=5,y0=3,b0=5*60*1e3,v0=[10,20,30,50,80,120,180,250,350,500],su=10,j0=30,wc=20,Pl=["uncommon","rare","epic","legendary","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic"],Kl=[{normal:50,uncommon:30},{normal:50,uncommon:30,rare:20},{normal:50,uncommon:30,rare:20,epic:10},{normal:50,uncommon:30,rare:20,epic:10,legendary:1},{normal:50,uncommon:30,rare:20,epic:10,legendary:1.5,mythic:25},{normal:65,uncommon:40,rare:25,epic:12.5,legendary:2,mythic:30},{normal:80,uncommon:50,rare:30,epic:15,legendary:2.5,mythic:35},{normal:95,uncommon:60,rare:35,epic:17.5,legendary:3,mythic:40},{normal:100,uncommon:70,rare:40,epic:20,legendary:3.5,mythic:45},{normal:100,uncommon:80,rare:45,epic:22.5,legendary:4,mythic:50},{normal:100,uncommon:90,rare:50,epic:25,legendary:4.5,mythic:55},{normal:100,uncommon:100,rare:55,epic:27.5,legendary:5,mythic:60},{normal:100,uncommon:100,rare:60,epic:30,legendary:5.5,mythic:65},{normal:100,uncommon:100,rare:65,epic:32.5,legendary:6,mythic:70},{normal:100,uncommon:100,rare:70,epic:35,legendary:6.5,mythic:75},{normal:100,uncommon:100,rare:75,epic:37.5,legendary:7,mythic:80},{normal:100,uncommon:100,rare:80,epic:40,legendary:7.5,mythic:85},{normal:100,uncommon:100,rare:85,epic:42.5,legendary:8,mythic:90},{normal:100,uncommon:100,rare:90,epic:45,legendary:8.5,mythic:95},{normal:100,uncommon:100,rare:100,epic:50,legendary:10,mythic:100}],ya=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40],lu=e=>e<1?0:e>=wc?1/0:e*2e3,Ml={neighborhood:{id:"neighborhood",name:"",description:"6   .    !",format:"round-robin",players:6,image:"/images/championship/Champ1.png"},national:{id:"national",name:"",description:"  8   .",format:"tournament",players:8,image:"/images/championship/Champ2.png"},world:{id:"world",name:"",description:"    16 .",format:"tournament",players:16,image:"/images/championship/Champ3.png"}},w0={neighborhood:{rewardType:"rank",rewards:{1:{items:[{itemId:" 4",quantity:1},{itemId:" 1",quantity:1}]},2:{items:[{itemId:" 3",quantity:1}]},3:{items:[{itemId:" 2",quantity:1}]},4:{items:[{itemId:" 1",quantity:1}]}}},national:{rewardType:"rank",rewards:{1:{items:[{itemId:" 4",quantity:1},{itemId:" 2",quantity:1}]},2:{items:[{itemId:" 3",quantity:1},{itemId:" 1",quantity:1}]},3:{items:[{itemId:" 2",quantity:1},{itemId:" 1",quantity:1}]},4:{items:[{itemId:" 1",quantity:1},{itemId:" 1",quantity:1}]},5:{items:[{itemId:" 1",quantity:1}]}}},world:{rewardType:"rank",rewards:{1:{items:[{itemId:" 4",quantity:1},{itemId:" 3",quantity:1}]},2:{items:[{itemId:" 3",quantity:1},{itemId:" 2",quantity:1}]},3:{items:[{itemId:" 3",quantity:1},{itemId:" 1",quantity:1}]},4:{items:[{itemId:" 2",quantity:1},{itemId:" 1",quantity:1}]},5:{items:[{itemId:" 1",quantity:1},{itemId:" 1",quantity:1}]},9:{items:[{itemId:" 1",quantity:1}]}}}},Me=[{id:"profile_1",name:"  1",url:"/images/profiles/profile1.png",requiredLevel:1,type:"any"},{id:"profile_2",name:"  2",url:"/images/profiles/profile2.png",requiredLevel:1,type:"any"},{id:"profile_3",name:"  3",url:"/images/profiles/profile3.png",requiredLevel:1,type:"any"},{id:"profile_4",name:"  4",url:"/images/profiles/profile4.png",requiredLevel:1,type:"any"},{id:"profile_5",name:"  5",url:"/images/profiles/profile5.png",requiredLevel:1,type:"any"},{id:"profile_6",name:"  6",url:"/images/profiles/profile6.png",requiredLevel:1,type:"any"},{id:"profile_7",name:"  7",url:"/images/profiles/profile7.png",requiredLevel:1,type:"any"},{id:"profile_8",name:"  8",url:"/images/profiles/profile8.png",requiredLevel:1,type:"any"},{id:"profile_9",name:"  9",url:"/images/profiles/profile9.png",requiredLevel:1,type:"any"},{id:"profile_10",name:"  10",url:"/images/profiles/profile10.png",requiredLevel:1,type:"any"},{id:"profile_11",name:"  11",url:"/images/profiles/profile11.png",requiredLevel:1,type:"any"},{id:"profile_12",name:"  12",url:"/images/profiles/profile12.png",requiredLevel:1,type:"any"},{id:"profile_13",name:"  13",url:"/images/profiles/profile13.png",requiredLevel:1,type:"any"},{id:"profile_14",name:"  14",url:"/images/profiles/profile14.png",requiredLevel:1,type:"any"},{id:"profile_15",name:"  15",url:"/images/profiles/profile15.png",requiredLevel:1,type:"any"},{id:"profile_16",name:"  16",url:"/images/profiles/profile16.png",requiredLevel:1,type:"any"},{id:"profile_17",name:"  17",url:"/images/profiles/profile17.png",requiredLevel:1,type:"any"},{id:"profile_18",name:"  18",url:"/images/profiles/profile18.png",requiredLevel:1,type:"any"},{id:"profile_19",name:"  19",url:"/images/profiles/profile19.png",requiredLevel:1,type:"any"},{id:"profile_20",name:"  20",url:"/images/profiles/profile20.png",requiredLevel:1,type:"any"},{id:"profile_21",name:"  21",url:"/images/profiles/profile21.png",requiredLevel:1,type:"any"},{id:"profile_22",name:"  22",url:"/images/profiles/profile22.png",requiredLevel:1,type:"any"},{id:"profile_23",name:"  23",url:"/images/profiles/profile23.png",requiredLevel:1,type:"any"},{id:"profile_24",name:"  24",url:"/images/profiles/profile24.png",requiredLevel:1,type:"any"},{id:"profile_25",name:"  25",url:"/images/profiles/profile25.png",requiredLevel:1,type:"any"},{id:"profile_26",name:"  26",url:"/images/profiles/profile26.png",requiredLevel:1,type:"any"},{id:"profile_27",name:"  27",url:"/images/profiles/profile27.png",requiredLevel:1,type:"any"},{id:"profile_28",name:"  28",url:"/images/profiles/profile28.png",requiredLevel:1,type:"any"},{id:"profile_29",name:"  29",url:"/images/profiles/profile29.png",requiredLevel:1,type:"any"},{id:"profile_30",name:"  30",url:"/images/profiles/profile30.png",requiredLevel:1,type:"any"},{id:"profile_31",name:"  31",url:"/images/profiles/profile31.png",requiredLevel:1,type:"any"},{id:"profile_32",name:"  32",url:"/images/profiles/profile32.png",requiredLevel:1,type:"any"},{id:"profile_33",name:"  33",url:"/images/profiles/profile33.png",requiredLevel:1,type:"any"},{id:"profile_34",name:"  34",url:"/images/profiles/profile34.png",requiredLevel:1,type:"any"},{id:"profile_35",name:"  35",url:"/images/profiles/profile35.png",requiredLevel:1,type:"any"}],Re=[{id:"default",name:" ",url:"#FFFFFF",description:"   ."},{id:"simple_black",name:" ",url:"#000000",description:"    ."},{id:"red",name:"",url:"#ef4444",description:"/   3   .",requiredLevelSum:3},{id:"orange",name:"",url:"#f97316",description:"/   4   .",requiredLevelSum:4},{id:"yellow",name:"",url:"#eab308",description:"/   5   .",requiredLevelSum:5},{id:"green",name:"",url:"#22c55e",description:"/   6   .",requiredLevelSum:6},{id:"blue",name:"",url:"#3b82f6",description:"/   7   .",requiredLevelSum:7},{id:"indigo",name:"",url:"#6366f1",description:"/   8   .",requiredLevelSum:8},{id:"purple",name:"",url:"#8b5cf6",description:"/   9   .",requiredLevelSum:9},{id:"rainbow",name:"",url:"conic-gradient(red, yellow, lime, aqua, blue, magenta, red)",description:"/   10   .",requiredLevelSum:10},{id:"bronze_reward",name:" ",url:"/images/tire/Round1.png",description:"     .",unlockTier:""},{id:"silver_reward",name:" ",url:"/images/tire/Round2.png",description:"     .",unlockTier:""},{id:"gold_reward",name:" ",url:"/images/tire/Round3.png",description:"     .",unlockTier:""},{id:"platinum_reward",name:" ",url:"/images/tire/Round4.png",description:"     .",unlockTier:""},{id:"diamond_reward",name:" ",url:"/images/tire/Round5.png",description:"     .",unlockTier:""},{id:"master_reward",name:" ",url:"/images/tire/Round6.png",description:"     .",unlockTier:""},{id:"challenger_reward",name:" ",url:"/images/tire/Round7.png",description:"     .",unlockTier:""},{id:"tier_ring_1",name:"",url:"/images/tire/Ring1.png",description:"     ."},{id:"tier_ring_2",name:"",url:"/images/tire/Ring2.png",description:"     ."},{id:"tier_ring_3",name:"",url:"/images/tire/Ring3.png",description:"     ."},{id:"tier_ring_4",name:"",url:"/images/tire/Ring4.png",description:"     ."},{id:"tier_ring_5",name:"1",url:"/images/tire/Ring5.png",description:"     ."},{id:"tier_ring_6",name:"2",url:"/images/tire/Ring6.png",description:"     ."},{id:"tier_ring_7",name:"",url:"/images/tire/Ring7.png",description:"     ."},{id:"tier_ring_8",name:"VIP",url:"/images/tire/Ring8.png",description:"     ."}],ru=[{id:"tier_ring_1",name:"",url:"/images/tire/Ring1.png",description:"     .",price:{gold:1e4}},{id:"tier_ring_2",name:"",url:"/images/tire/Ring2.png",description:"     .",price:{gold:15e3}},{id:"tier_ring_3",name:"",url:"/images/tire/Ring3.png",description:"     .",price:{gold:3e4}},{id:"tier_ring_4",name:"",url:"/images/tire/Ring4.png",description:"     .",price:{diamonds:200}},{id:"tier_ring_5",name:"1",url:"/images/tire/Ring5.png",description:"     .",price:{diamonds:1e3}},{id:"tier_ring_6",name:"2",url:"/images/tire/Ring6.png",description:"     .",price:{diamonds:1e3}},{id:"tier_ring_7",name:"",url:"/images/tire/Ring7.png",description:"     .",price:{diamonds:1e3}},{id:"tier_ring_8",name:"VIP",url:"/images/tire/Ring8.png",description:"     .",price:{diamonds:2e3}}];T.Standard+"",T.Capture+"",T.Speed+"",T.Base+"",T.Hidden+"",T.Missile+"",T.Mix+"",T.Dice+"",T.Omok+"",T.Ttamok+"",T.Thief+"",T.Alkkagi+"",T.Curling+"";const fx=[",  ."," !",". ."," !",",   ."," .","GG!  .","?"],xx=["","","","","","","","",""],Jl=[{id:"-1",name:" 1",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:0,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:10},repeatClear:{gold:10,exp:10}}},{id:"-2",name:" 2",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:0,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:11},repeatClear:{gold:10,exp:10}}},{id:"-3",name:" 3",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:1,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:12},repeatClear:{gold:10,exp:10}}},{id:"-4",name:" 4",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:2,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:13},repeatClear:{gold:10,exp:10}}},{id:"-5",name:" 5",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:2,white:3,blackPattern:2,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:14,items:[{itemId:" 1",quantity:1}]},repeatClear:{gold:10,exp:10}}},{id:"-6",name:" 6",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:5,blackPattern:2,whitePattern:0,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:15},repeatClear:{gold:10,exp:10}}},{id:"-7",name:" 7",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:4,blackPattern:2,whitePattern:2,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:16},repeatClear:{gold:10,exp:10}}},{id:"-8",name:" 8",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:5,blackPattern:3,whitePattern:2,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:17},repeatClear:{gold:10,exp:10}}},{id:"-9",name:" 9",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:4,blackPattern:3,whitePattern:3,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:100,exp:18},repeatClear:{gold:10,exp:10}}},{id:"-10",name:" 10",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:2,whitePattern:3,centerBlackStoneChance:50},timeControl:{type:"fischer",mainTime:5,increment:10},rewards:{firstClear:{gold:150,exp:20,items:[{itemId:"  I",quantity:1}]},repeatClear:{gold:10,exp:15}}},{id:"-11",name:" 11",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:5,blackPattern:2,whitePattern:2,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:21},repeatClear:{gold:10,exp:10}}},{id:"-12",name:" 12",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:2,whitePattern:3,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:22},repeatClear:{gold:10,exp:10}}},{id:"-13",name:" 13",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:3,whitePattern:2,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:23},repeatClear:{gold:10,exp:10}}},{id:"-14",name:" 14",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:3,whitePattern:4,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:24},repeatClear:{gold:10,exp:10}}},{id:"-15",name:" 15",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:6,blackPattern:2,whitePattern:3,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:25,items:[{itemId:"  I",quantity:1}]},repeatClear:{gold:10,exp:10}}},{id:"-16",name:" 16",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:4,blackPattern:3,whitePattern:3,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:26},repeatClear:{gold:10,exp:10}}},{id:"-17",name:" 17",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:4,blackPattern:4,whitePattern:4,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:27},repeatClear:{gold:10,exp:10}}},{id:"-18",name:" 18",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:5,blackPattern:3,whitePattern:4,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:28},repeatClear:{gold:10,exp:10}}},{id:"-19",name:" 19",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:4,blackPattern:2,whitePattern:2,centerBlackStoneChance:80},timeControl:{type:"fischer",mainTime:1,increment:8},rewards:{firstClear:{gold:150,exp:30},repeatClear:{gold:10,exp:10}}},{id:"-20",name:" 20",level:Pe.,actionPointCost:3,boardSize:7,targetScore:{black:9,white:8},katagoLevel:2,placements:{black:5,white:5,blackPattern:2,whitePattern:1,centerBlackStoneChance:50},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:50,items:[{itemId:" 1",quantity:1}],bonus:"10"},repeatClear:{gold:30,exp:20}}},{id:"-1",name:" 1",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:5,blackPattern:2,whitePattern:4,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:30},repeatClear:{gold:30,exp:20}}},{id:"-2",name:" 2",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:5,blackPattern:3,whitePattern:4,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:32},repeatClear:{gold:30,exp:20}}},{id:"-3",name:" 3",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:5,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:34},repeatClear:{gold:30,exp:20}}},{id:"-4",name:" 4",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:6,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:36},repeatClear:{gold:30,exp:20}}},{id:"-5",name:" 5",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:6,blackPattern:4,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:38,items:[{itemId:" 2",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-6",name:" 6",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:3,white:6,blackPattern:4,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:40},repeatClear:{gold:30,exp:20}}},{id:"-7",name:" 7",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:6,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:42},repeatClear:{gold:30,exp:20}}},{id:"-8",name:" 8",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:6,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:44,items:[{itemId:"  I",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-9",name:" 9",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:5,blackPattern:2,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"fischer",mainTime:1,increment:8},rewards:{firstClear:{gold:200,exp:46},repeatClear:{gold:30,exp:20}}},{id:"-10",name:" 10",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:6,blackPattern:2,whitePattern:4,centerBlackStoneChance:50},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:50,items:[{itemId:"  II",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-11",name:" 11",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:6,blackPattern:1,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:52},repeatClear:{gold:30,exp:20}}},{id:"-12",name:" 12",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:6,blackPattern:2,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:54},repeatClear:{gold:30,exp:20}}},{id:"-13",name:" 13",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:7,blackPattern:3,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:56},repeatClear:{gold:30,exp:20}}},{id:"-14",name:" 14",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:7,blackPattern:3,whitePattern:4,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:58},repeatClear:{gold:30,exp:20}}},{id:"-15",name:" 15",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:3,white:6,blackPattern:4,whitePattern:1,centerBlackStoneChance:70},timeControl:{type:"fischer",mainTime:1,increment:7},rewards:{firstClear:{gold:250,exp:60,items:[{itemId:"  II",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-16",name:" 16",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:4,white:8,blackPattern:5,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:62},repeatClear:{gold:30,exp:20}}},{id:"-17",name:" 17",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:6,white:6,blackPattern:1,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:64},repeatClear:{gold:30,exp:20}}},{id:"-18",name:" 18",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:4,white:8,blackPattern:5,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:66},repeatClear:{gold:30,exp:20}}},{id:"-19",name:" 19",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:6,white:6,blackPattern:5,whitePattern:3,centerBlackStoneChance:50},timeControl:{type:"fischer",mainTime:1,increment:7},rewards:{firstClear:{gold:250,exp:100},repeatClear:{gold:30,exp:20}}},{id:"-20",name:" 20",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:15,white:12},katagoLevel:7,placements:{black:5,white:6,blackPattern:5,whitePattern:3,centerBlackStoneChance:50},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:300,exp:120,items:[{itemId:" 2",quantity:1}],bonus:"10"},repeatClear:{gold:50,exp:30}}}],px=e=>{const n=e.mannerScore??200,s={maxActionPoints:30,actionPointRegenInterval:b0,goldBonusPercent:0,itemDropRateBonus:0,mannerActionButtonBonus:0,rewardMultiplier:1,enhancementSuccessRateBonus:0};return n>=400&&(s.maxActionPoints+=10),n>=800&&(s.goldBonusPercent+=10),n>=1200&&(s.itemDropRateBonus+=10),n>=1600&&(s.enhancementSuccessRateBonus+=10),n<=199&&(s.mannerActionButtonBonus+=1),n<=99&&(s.rewardMultiplier*=.5),n<=49&&(s.actionPointRegenInterval=20*60*1e3),n<=0&&(s.maxActionPoints=Math.floor(s.maxActionPoints*.1)),s},gx=e=>{const s={...px(e),coreStatBonuses:{},specialStatBonuses:{},mythicStatBonuses:{}};for(const a of Object.values(N))s.coreStatBonuses[a]={flat:0,percent:0};for(const a of Object.values(Fe))s.specialStatBonuses[a]={flat:0,percent:0};for(const a of Object.values(it))s.mythicStatBonuses[a]={flat:0,percent:0};const l=e.inventory.filter(a=>a.isEquipped&&a.type==="equipment"&&a.options);for(const a of l){const i=[a.options.main,...a.options.combatSubs,...a.options.specialSubs,...a.options.mythicSubs];for(const o of i){if(!o)continue;const{type:c,value:d,isPercentage:u}=o;Object.values(N).includes(c)?u?s.coreStatBonuses[c].percent+=d:s.coreStatBonuses[c].flat+=d:Object.values(Fe).includes(c)?u?s.specialStatBonuses[c].percent+=d:s.specialStatBonuses[c].flat+=d:Object.values(it).includes(c)&&(s.mythicStatBonuses[c].flat+=d)}}s.maxActionPoints+=s.specialStatBonuses[Fe.ActionPointMax].flat;const r=s.specialStatBonuses[Fe.ActionPointRegen].percent;return r>0&&(s.actionPointRegenInterval=Math.floor(s.actionPointRegenInterval/(1+r/100))),s},yn={graphics:{theme:"black",panelColor:void 0,textColor:void 0},sound:{masterVolume:.5,masterMuted:!1,categoryMuted:{stone:!1,notification:!1,item:!1,countdown:!1,turn:!1}},features:{mobileConfirm:!1,stonePreview:!0,lastMoveMarker:!0,questNotifications:!0,chatNotifications:!0}},au="appSettings_v2";class N0{constructor(){Tn(this,"audioContext",null);Tn(this,"isInitializing",!1);Tn(this,"scanBgmSourceNode",null);Tn(this,"timerWarningSourceNode",null);Tn(this,"audioBuffers",new Map);Tn(this,"soundsPath","/sound/");Tn(this,"settings",yn.sound)}isReady(){return!!this.audioContext&&this.audioContext.state==="running"}async initialize(){if(!(this.isReady()||this.isInitializing)){this.isInitializing=!0;try{this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.audioContext.state==="suspended"&&await this.audioContext.resume()}catch(n){console.error("Audio context initialization failed:",n)}finally{this.isInitializing=!1}}}updateSettings(n){this.settings=n}async loadSound(n){if(this.audioContext||await this.initialize(),!this.audioContext)return null;if(this.audioBuffers.has(n))return this.audioBuffers.get(n);try{const s=await fetch(n);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const l=await s.arrayBuffer(),r=await this.audioContext.decodeAudioData(l);return this.audioBuffers.set(n,r),r}catch(s){return console.error(`Failed to load sound: ${n}`,s),null}}playSound(n,s=1,l=!1){if(!this.isReady()||!this.audioContext)return null;const r=this.audioContext.createBufferSource();r.buffer=n,r.loop=l;const a=this.audioContext.createGain();return a.gain.setValueAtTime(s,this.audioContext.currentTime),r.connect(a),a.connect(this.audioContext.destination),r.start(0),r}async play(n,s,l,r=!1){if(this.settings.masterMuted||this.settings.categoryMuted[s])return null;try{const a=await this.loadSound(`${this.soundsPath}${n}.mp3`);if(a)return this.playSound(a,l*this.settings.masterVolume,r)}catch(a){console.error(`Could not play sound ${n}`,a)}return null}placeStone(){this.play("move","stone",.7)}rollDice(n){this.play("dice","item",.6),n>1&&setTimeout(()=>this.play("dice","item",.6),500)}enhancementFail(){this.play("failure","notification",.7)}revealHiddenStone(){this.play("hidden","item",.8)}async playScanBgm(){this.stopScanBgm(),this.scanBgmSourceNode=await this.play("scanbgm","item",.4,!0)}stopScanBgm(){if(this.scanBgmSourceNode){try{this.scanBgmSourceNode.stop()}catch{}this.scanBgmSourceNode=null}}scanSuccess(){this.play("find","item",.7)}stoneCollision(){this.play("hit","stone",.4)}launchMissile(){this.play("rocket","item",.7)}gameLose(){this.play("lose","notification",.6)}gameWin(){this.play("win","notification",.6)}levelUp(){this.play("levelup","notification",.7)}disassemblyJackpot(){this.play("jackpot2","notification",.8)}gachaEpicOrHigher(){this.play("jackpot","notification",.7)}gameStart(){this.play("gamestart","notification",.6)}myTurn(){this.play("myturn","turn",.7)}scanFail(){this.play("scanfail","item",.6)}async timerWarning(){this.stopTimerWarning(),this.timerWarningSourceNode=await this.play("timer10","countdown",.7)}stopTimerWarning(){if(this.timerWarningSourceNode){try{this.timerWarningSourceNode.stop()}catch{}this.timerWarningSourceNode=null}}timeoutFoul(){this.play("bip","notification",.8)}enhancementSuccess(){this.play("success","notification",.7)}combinationGreatSuccess(){this.play("jackpot","notification",.7)}combinationSuccess(){this.play("success","notification",.7)}stoneFallOff(){this.play("fall","stone",.5)}claimReward(){this.play("reward","notification",.7)}}const Ee=new N0;function iu(e){const n=e.replace(/^#\/?/,""),[s,...l]=n.split("/");switch(s){case"lobby":return{view:"lobby",params:{type:l[0]||"strategic"}};case"waiting":return{view:"waiting",params:{mode:l[0]?decodeURIComponent(l[0]):null}};case"game":return{view:"game",params:{id:l[0]}};case"tournament":return{view:"tournament",params:{}};case"singleplayer":return{view:"singleplayer",params:{}};case"admin":return{view:"admin",params:{}};case"register":return{view:"register",params:{}};case"profile":return{view:"profile",params:{}};default:return{view:"login",params:{}}}}const S0=()=>{const[e,n]=f.useState(()=>{try{const J=sessionStorage.getItem("currentUser");if(J)return JSON.parse(J)}catch(J){console.error("Failed to parse user from sessionStorage",J)}return null}),[s,l]=f.useState(()=>iu(window.location.hash)),r=f.useRef(s),[a,i]=f.useState(null),o=f.useRef(!1),[c,d]=f.useState(()=>{try{const J=localStorage.getItem(au);if(J){let ie=JSON.parse(J);return typeof ie.theme=="string"&&(ie={...yn,graphics:{theme:ie.theme,panelColor:void 0,textColor:void 0},sound:ie.sound||yn.sound,features:ie.features||yn.features}),{...yn,...ie,graphics:{...yn.graphics,...ie.graphics||{}},sound:{...yn.sound,...ie.sound||{}},features:{...yn.features,...ie.features||{}}}}}catch(J){console.error("Error reading settings from localStorage",J)}return yn}),[u,p]=f.useState({}),[m,h]=f.useState([]),[y,b]=f.useState({}),[v,g]=f.useState({}),[x,j]=f.useState({}),[w,S]=f.useState({}),[C,k]=f.useState([]),[M,_]=f.useState({}),[E,I]=f.useState([]),[R,A]=f.useState(null),[O,B]=f.useState(3),[V,D]=f.useState(!1),[L,q]=f.useState(!1),[U,W]=f.useState(!1),[H,te]=f.useState(!1),[le,ce]=f.useState(!1),[ve,F]=f.useState(null),[X,ee]=f.useState(null),[xe,Q]=f.useState(null),[G,K]=f.useState(null),[Z,fe]=f.useState(!1),[we,P]=f.useState(null),[Y,ae]=f.useState(null),[oe,ue]=f.useState(!1),[se,ge]=f.useState(!1),[je,me]=f.useState(!1),[Se,ze]=f.useState(null),[Be,He]=f.useState(null),[re,Te]=f.useState(null),[_e,We]=f.useState(null),[ot,Gt]=f.useState(null),[vt,tn]=f.useState(null),[Ct,jt]=f.useState(!1),pe=f.useRef(null),[de,Ae]=f.useState(!1),[Ne,Ie]=f.useState(null),[ft,ct]=f.useState(!1),[Wt,Ht]=f.useState(!1),[dn,un]=f.useState(!1),[mn,ss]=f.useState(null),[lr,ws]=f.useState("enhance"),[Ua,rr]=f.useState(null),[za,ar]=f.useState(!1),[Fa,Ke]=f.useState(!1);f.useEffect(()=>{Ke(!!Be)},[Be]),f.useEffect(()=>{try{localStorage.setItem(au,JSON.stringify(c))}catch(ie){console.error("Error saving settings to localStorage",ie)}const J=document.documentElement;c.graphics.panelColor?J.style.setProperty("--custom-panel-bg",c.graphics.panelColor):J.style.removeProperty("--custom-panel-bg"),c.graphics.textColor?J.style.setProperty("--custom-text-color",c.graphics.textColor):J.style.removeProperty("--custom-text-color")},[c]),f.useEffect(()=>{document.documentElement.setAttribute("data-theme",c.graphics.theme)},[c.graphics.theme]),f.useEffect(()=>{Ee.updateSettings(c.sound)},[c.sound]);const Ga=f.useCallback(J=>{d(ie=>({...ie,graphics:{...ie.graphics,theme:J,panelColor:void 0,textColor:void 0}}))},[]),ls=f.useCallback(J=>{d(ie=>({...ie,graphics:{...ie.graphics,panelColor:J}}))},[]),$x=f.useCallback(J=>{d(ie=>({...ie,graphics:{...ie.graphics,textColor:J}}))},[]),Ox=f.useCallback(()=>{d(J=>({...J,graphics:{...J.graphics,panelColor:void 0,textColor:void 0}}))},[]),Dx=f.useCallback((J,ie)=>{d(he=>({...he,sound:{...he.sound,[J]:ie}}))},[]),qx=f.useCallback((J,ie)=>{d(he=>({...he,features:{...he.features,[J]:ie}}))},[]),rl=f.useMemo(()=>{let J=u;return!u||typeof u!="object"?(console.warn("usersMap is not a valid object, defaulting to empty object.",u),J={}):J=JSON.parse(JSON.stringify(u)),Object.values(J)},[u]),Je=f.useMemo(()=>{if(!e)return null;const J=m.find(ie=>ie.id===e.id);return{...e,...J||{status:"online"}}},[e,m]),rs=f.useMemo(()=>{if(!Je)return null;const J=Je.gameId||Je.spectatingGameId;if(J&&(Je.status==="in-game"||Je.status==="spectating"||Je.status==="negotiating")){const ie=y[J];if(ie)return ie}return null},[Je,y]),Ux=f.useMemo(()=>Je&&Object.values(v).find(J=>J.challenger.id===Je.id&&(J.status==="pending"||J.status==="draft")||J.opponent.id===Je.id&&J.status==="pending")||null,[Je,v]),zx=f.useMemo(()=>(e==null?void 0:e.mail.filter(J=>!J.isRead).length)||0,[e==null?void 0:e.mail]),Fx=f.useMemo(()=>{if(!(e!=null&&e.quests))return!1;const{daily:J,weekly:ie,monthly:he}=e.quests,ke=qe=>qe?qe.quests.some(Ue=>Ue.progress>=Ue.target&&!Ue.isClaimed):!1,Ve=(qe,Ue)=>!qe||!Ue?!1:qe.claimedMilestones.some((al,Vt)=>!al&&qe.activityProgress>=Ue[Vt]);return ke(J)||ke(ie)||ke(he)||Ve(J,dx)||Ve(ie,ux)||Ve(he,mx)},[e==null?void 0:e.quests]),Cc=J=>{let ie=J;J.includes("Invalid move: ko")?ie=" .         .":J.includes("action point")&&(ie="   ."),i(ie),setTimeout(()=>i(null),5e3)};f.useEffect(()=>{e?sessionStorage.setItem("currentUser",JSON.stringify(e)):sessionStorage.removeItem("currentUser")},[e]);const Ns=f.useCallback(async J=>{J.type==="CLEAR_TOURNAMENT_SESSION"&&n(ie=>ie?{...ie,lastNeighborhoodTournament:null,lastNationalTournament:null,lastWorldTournament:null}:null),J.type==="TOGGLE_EQUIP_ITEM"?n(ie=>{if(!ie)return null;const{itemId:he}=J.payload,ke=ie.inventory.find(Vt=>Vt.id===he);if(!ke||ke.type!=="equipment"||!ke.slot)return ie;const Ve=ke.slot,qe=!ke.isEquipped,Ue={...ie.equipment};qe?Ue[Ve]=ke.id:delete Ue[Ve];const al=ie.inventory.map(Vt=>Vt.id===he?{...Vt,isEquipped:qe}:qe&&Vt.slot===Ve&&Vt.id!==he?{...Vt,isEquipped:!1}:Vt);return{...ie,inventory:al,equipment:Ue}}):J.type==="SAVE_PRESET"&&n(ie=>{if(!ie)return null;const{preset:he,index:ke}=J.payload,Ve=[...ie.equipmentPresets];return Ve[ke]=he,{...ie,equipmentPresets:Ve}});try{Ee.initialize();const ie=await fetch("/api/action",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...J,userId:e==null?void 0:e.id})});if(ie.ok){const he=await ie.json();if(he.updatedUser&&n(he.updatedUser),he.obtainedItemsBulk&&F(he.obtainedItemsBulk),he.rewardSummary&&K(he.rewardSummary),he.claimAllSummary&&(P(he.claimAllSummary),fe(!0)),he.disassemblyResult&&(ee(he.disassemblyResult),he.disassemblyResult.jackpot&&Ee.disassemblyJackpot()),he.craftResult&&Q(he.craftResult),he.combinationResult&&(rr(he.combinationResult),he.combinationResult.isGreatSuccess?Ee.combinationGreatSuccess():Ee.combinationSuccess()),he.enhancementOutcome){const{message:ke,success:Ve,itemBefore:qe,itemAfter:Ue}=he.enhancementOutcome;ze({message:ke,success:Ve}),He({message:ke,success:Ve,itemBefore:qe,itemAfter:Ue}),Ve?Ee.enhancementSuccess():Ee.enhancementFail()}he.enhancementAnimationTarget&&Te(he.enhancementAnimationTarget),he.redirectToTournament&&(window.location.hash=`#/tournament/${he.redirectToTournament}`)}else{const he=await ie.json();Cc(he.message||"An unknown error occurred."),(J.type==="TOGGLE_EQUIP_ITEM"||J.type==="USE_ITEM")&&n(ke=>ke?{...ke}:null)}}catch(ie){Cc(ie.message)}},[e==null?void 0:e.id]),Wa=f.useCallback(()=>{e&&(o.current=!0,Ns({type:"LOGOUT"}),n(null),window.location.hash="")},[e,Ns]);f.useEffect(()=>{if(!e)return;const J=new WebSocket(`ws://${window.location.hostname}:4001`);return J.onopen=()=>{console.log("[WebSocket] Connected")},J.onmessage=ie=>{const he=JSON.parse(ie.data);if(he.type==="INITIAL_STATE"){console.log("INITIAL_STATE payload:",he.payload);const{users:ke,onlineUsers:Ve,liveGames:qe,negotiations:Ue,waitingRoomChats:al,gameChats:Vt,adminLogs:ip,announcements:op,globalOverrideAnnouncement:cp,gameModeAvailability:dp,announcementInterval:up}=he.payload;p(ke),h(Ve),b(qe),g(Ue),j(al),S(Vt),k(ip),I(op),A(cp),_(dp),B(up)}else if(he.type==="USER_STATUS_UPDATE"){const ke=Object.entries(he.payload).map(([Ve,qe])=>{const Ue=u[Ve];if(Ue)return{...Ue,...qe}}).filter(Boolean);h(ke)}},J.onclose=()=>{console.log("[WebSocket] Disconnected")},()=>{J.close()}},[e]);const Ha=f.useRef(!1);f.useEffect(()=>{r.current=s},[s]),f.useEffect(()=>{const J=()=>{const ie=r.current,he=iu(window.location.hash);if(ie.view==="profile"&&he.view==="login"&&window.location.hash===""&&e)if(Ct)Wa();else{jt(!0),pe.current=window.setTimeout(()=>jt(!1),2e3),window.history.pushState(null,"","#/profile");return}else pe.current&&clearTimeout(pe.current),Ct&&jt(!1);l(he)};return window.addEventListener("hashchange",J),()=>window.removeEventListener("hashchange",J)},[e,Wa,Ct]),f.useEffect(()=>{if(!e){Ha.current=!1,window.location.hash&&window.location.hash!=="#/register"&&(window.location.hash="");return}const J=window.location.hash;if(!Ha.current&&(Ha.current=!0,J===""||J==="#/")){if(rs){window.location.hash=`#/game/${rs.id}`;return}window.location.hash="#/profile";return}const ie=J.startsWith("#/game/");if(rs&&!ie)window.location.hash=`#/game/${rs.id}`;else if(!rs&&ie){let he="#/profile";(Je==null?void 0:Je.status)==="waiting"&&(Je!=null&&Je.mode)&&(he=`#/waiting/${encodeURIComponent(Je.mode)}`),J!==he&&(window.location.hash=he)}},[e,rs,Je]),f.useEffect(()=>{const J=()=>document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`);return J(),window.addEventListener("resize",J),window.addEventListener("orientationchange",J),()=>{window.removeEventListener("resize",J),window.removeEventListener("orientationchange",J)}},[]),f.useEffect(()=>{if(Se){const J=setTimeout(()=>{ze(null)},5e3);return()=>clearTimeout(J)}},[Se]);const Gx=J=>{Ns({type:"ENTER_WAITING_ROOM",payload:{mode:J}}),window.location.hash=`#/waiting/${encodeURIComponent(J)}`},Wx=f.useCallback(J=>{const ie=m.find(he=>he.id===J)||rl.find(he=>he.id===J);if(ie){const he=m.find(ke=>ke.id===J);ae({...ie,...he||{status:"online"}})}},[m,rl]),Hx=f.useCallback(J=>{const ie=m.find(he=>he.id===J)||rl.find(he=>he.id===J);if(ie){const he=m.find(ke=>ke.id===J);Ie({...ie,...he||{status:"online"}})}},[m,rl]),Vx=f.useCallback(()=>Ie(null),[]),Kx=f.useCallback(J=>{n(J),window.location.hash="#/profile"},[]),Jx=f.useCallback(J=>{ss(J),ws("enhance"),un(!0)},[]),Qx=f.useCallback(J=>{ss(J),ws("enhance"),un(!0)},[]),Yx=f.useCallback((J,ie)=>{tn({item:J,isOwnedByCurrentUser:ie})},[]),Xx=f.useCallback(()=>{if(Be!=null&&Be.success){const J=Be.itemAfter;tn(ie=>ie&&J&&ie.item.id===J.id?{...ie,item:J}:ie),n(ie=>ie?{...ie,inventory:ie.inventory.map(he=>he.id===J.id?J:he)}:null)}He(null)},[Be]),Zx=f.useCallback(()=>{He(null)},[]),ep=f.useCallback(()=>{fe(!1),P(null)},[]),tp=f.useCallback(J=>{Ns({type:"APPLY_PRESET",payload:{presetName:J.name}})},[Ns]),np=f.useMemo(()=>(e==null?void 0:e.equipmentPresets)||[],[e==null?void 0:e.equipmentPresets]),{mainOptionBonuses:sp,combatSubOptionBonuses:lp,specialStatBonuses:rp,aggregatedMythicStats:ap}=f.useMemo(()=>{const J={mainOptionBonuses:{},combatSubOptionBonuses:{},specialStatBonuses:{},aggregatedMythicStats:{}};return!Je||!Je.equipment||!Je.inventory?J:Je.inventory.filter(ke=>Object.values(Je.equipment).includes(ke.id)).reduce((ke,Ve)=>{if(!Ve.options)return ke;if(Ve.options.main){const qe=Ve.options.main.type;ke.mainOptionBonuses[qe]||(ke.mainOptionBonuses[qe]={value:0,isPercentage:Ve.options.main.isPercentage}),ke.mainOptionBonuses[qe].value+=Ve.options.main.value}return Ve.options.combatSubs.forEach(qe=>{const Ue=qe.type;ke.combatSubOptionBonuses[Ue]||(ke.combatSubOptionBonuses[Ue]={value:0,isPercentage:qe.isPercentage}),ke.combatSubOptionBonuses[Ue].value+=qe.value}),Ve.options.specialSubs.forEach(qe=>{const Ue=qe.type;ke.specialStatBonuses[Ue]||(ke.specialStatBonuses[Ue]={flat:0,percent:0}),qe.isPercentage?ke.specialStatBonuses[Ue].percent+=qe.value:ke.specialStatBonuses[Ue].flat+=qe.value}),Ve.options.mythicSubs.forEach(qe=>{const Ue=qe.type;ke.aggregatedMythicStats[Ue]||(ke.aggregatedMythicStats[Ue]={count:0,totalValue:0}),ke.aggregatedMythicStats[Ue].count++,ke.aggregatedMythicStats[Ue].totalValue+=qe.value}),ke},J)},[Je]);return{currentUser:e,presets:np,setCurrentUserAndRoute:Kx,currentUserWithStatus:Je,currentRoute:s,error:a,allUsers:rl,onlineUsers:m,liveGames:y,negotiations:v,waitingRoomChats:x,gameChats:w,adminLogs:C,gameModeAvailability:M,announcements:E,globalOverrideAnnouncement:R,announcementInterval:O,activeGame:rs,activeNegotiation:Ux,showExitToast:Ct,enhancementResult:Se,enhancementOutcome:Be,unreadMailCount:zx,hasClaimableQuest:Fx,settings:c,updateTheme:Ga,updateSoundSetting:Dx,updateFeatureSetting:qx,updatePanelColor:ls,updateTextColor:$x,resetGraphicsToDefault:Ox,mainOptionBonuses:sp,combatSubOptionBonuses:lp,specialStatBonuses:rp,aggregatedMythicStats:ap,modals:{isSettingsModalOpen:V,isInventoryOpen:L,isMailboxOpen:U,isQuestsOpen:H,isShopOpen:le,lastUsedItemResult:ve,disassemblyResult:X,craftResult:xe,rewardSummary:G,viewingUser:Y,isInfoModalOpen:oe,isEncyclopediaOpen:se,isStatAllocationModalOpen:je,enhancementAnimationTarget:re,pastRankingsInfo:_e,viewingItem:vt,isProfileEditModalOpen:de,moderatingUser:Ne,isClaimAllSummaryOpen:Z,claimAllSummary:we,isMbtiInfoModalOpen:ft,isEquipmentEffectsModalOpen:Wt,isBlacksmithModalOpen:dn,blacksmithSelectedItemForEnhancement:mn,blacksmithActiveTab:lr,combinationResult:Ua,isBlacksmithHelpOpen:za,isEnhancementResultModalOpen:Fa,enhancingItem:ot},handlers:{handleAction:Ns,handleLogout:Wa,handleEnterWaitingRoom:Gx,applyPreset:tp,openSettingsModal:()=>D(!0),closeSettingsModal:()=>D(!1),openInventory:()=>q(!0),closeInventory:()=>q(!1),openMailbox:()=>W(!0),closeMailbox:()=>W(!1),openQuests:()=>te(!0),closeQuests:()=>te(!1),openShop:()=>ce(!0),closeShop:()=>ce(!1),closeItemObtained:()=>F(null),closeDisassemblyResult:()=>ee(null),closeCraftResult:()=>Q(null),closeCombinationResult:()=>rr(null),closeRewardSummary:()=>K(null),closeClaimAllSummary:ep,openViewingUser:Wx,closeViewingUser:()=>ae(null),openInfoModal:()=>ue(!0),closeInfoModal:()=>ue(!1),openEncyclopedia:()=>ge(!0),closeEncyclopedia:()=>ge(!1),openStatAllocationModal:()=>me(!0),closeStatAllocationModal:()=>me(!1),openProfileEditModal:()=>Ae(!0),closeProfileEditModal:()=>Ae(!1),openPastRankings:J=>We(J),closePastRankings:()=>We(null),openViewingItem:Yx,closeViewingItem:()=>tn(null),openEnhancingItem:Jx,openEnhancementFromDetail:Qx,clearEnhancementOutcome:Xx,clearEnhancementAnimation:()=>Te(null),openModerationModal:Hx,closeModerationModal:Vx,openMbtiInfoModal:()=>ct(!0),closeMbtiInfoModal:()=>ct(!1),openEquipmentEffectsModal:()=>Ht(!0),closeEquipmentEffectsModal:()=>Ht(!1),openBlacksmithModal:()=>un(!0),closeBlacksmithModal:()=>{un(!1),ss(null),ws("enhance")},openBlacksmithHelp:()=>ar(!0),closeBlacksmithHelp:()=>ar(!1),setBlacksmithActiveTab:ws,closeEnhancementModal:Zx}}},hx=f.createContext(void 0),k0=({children:e})=>{const n=S0();return t.jsx(hx.Provider,{value:n,children:e})},De=()=>{const e=f.useContext(hx);if(e===void 0)throw new Error("useAppContext must be used within an AppProvider");return e},vi=({icon:e,value:n,className:s})=>t.jsxs("div",{className:`flex items-center gap-1 sm:gap-2 bg-tertiary/50 rounded-full py-1 pl-1 pr-2 sm:pr-3 shadow-inner ${s}`,children:[t.jsx("div",{className:"bg-primary w-7 h-7 flex items-center justify-center rounded-full text-lg flex-shrink-0",children:e}),t.jsx("span",{className:"font-bold text-xs sm:text-sm text-primary",children:n})]}),C0=({user:e})=>{const{actionPoints:n,lastActionPointUpdate:s}=e,[l,r]=f.useState(""),a=f.useMemo(()=>px(e).actionPointRegenInterval,[e]);return f.useEffect(()=>{if(n.current>=n.max){r("");return}const i=()=>{const c=s+a,d=Math.max(0,c-Date.now()),u=Math.floor(d/1e3),p=Math.floor(u/60),m=u%60;r(`${String(p).padStart(2,"0")}:${String(m).padStart(2,"0")}`)};i();const o=setInterval(i,1e3);return()=>clearInterval(o)},[n.current,n.max,s,a]),l?t.jsxs("span",{className:"text-xs text-tertiary font-mono text-center",children:["(",l,")"]}):null},I0=()=>{const{currentUserWithStatus:e,handlers:n,unreadMailCount:s}=De();if(!e)return null;const{handleLogout:l,openShop:r,openSettingsModal:a,openProfileEditModal:i,openMailbox:o}=n,{actionPoints:c,gold:d,diamonds:u,isAdmin:p,avatarId:m,borderId:h,mbti:y}=e,b=f.useMemo(()=>{var g;return(g=Me.find(x=>x.id===m))==null?void 0:g.url},[m]),v=f.useMemo(()=>{var g;return(g=Re.find(x=>x.id===h))==null?void 0:g.url},[h]);return t.jsx("header",{className:"flex-shrink-0 bg-primary/80 backdrop-blur-sm shadow-lg",children:t.jsxs("div",{className:"p-2 flex justify-between items-center gap-2 h-[60px]",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink min-w-0 cursor-pointer relative",onClick:i,children:[t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:b,borderUrl:v,size:40}),t.jsxs("div",{className:"hidden sm:block min-w-0",children:[t.jsx("h1",{className:"font-bold text-primary truncate",children:e.nickname}),t.jsxs("p",{className:"text-xs text-tertiary truncate",children:[" Lv.",e.strategyLevel," /  Lv.",e.playfulLevel]})]}),!y&&t.jsx("span",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"})]}),t.jsxs("div",{className:"flex items-center justify-end flex-wrap gap-1 sm:gap-2",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(vi,{icon:"",value:`${c.current}/${c.max}`}),t.jsx(C0,{user:e}),t.jsx("button",{onClick:r,className:"ml-1 w-6 h-6 flex-shrink-0 rounded-full bg-green-600 hover:bg-green-500 text-white font-bold flex items-center justify-center text-lg shadow-md transition-transform hover:scale-110 active:scale-95",title:" ",children:"+"})]}),t.jsx(vi,{icon:t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-5 h-5 object-contain"}),value:d.toLocaleString()}),t.jsx(vi,{icon:t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-5 h-5 object-contain"}),value:u.toLocaleString()}),t.jsx("div",{className:"h-9 w-px bg-border-color mx-1 sm:mx-2"}),p&&t.jsx(z,{onClick:()=>window.location.hash="#/admin",colorScheme:"purple",className:"text-xs sm:text-sm",children:""}),t.jsxs("button",{onClick:o,className:"relative p-2 rounded-lg text-xl hover:bg-secondary transition-colors",title:"",children:[t.jsx("img",{src:"/images/icon/mail.png",alt:"",className:"w-6 h-6"}),s>0&&t.jsx("span",{className:"absolute top-1 right-1 bg-red-500 rounded-full w-2.5 h-2.5 border-2 border-primary"})]}),t.jsx("button",{onClick:a,className:"p-2 rounded-lg text-xl hover:bg-secondary transition-colors",title:"",children:""}),t.jsx(z,{onClick:l,colorScheme:"red",className:"text-xs sm:text-sm",children:""})]})]})})},E0=()=>{const{setCurrentUserAndRoute:e}=De(),[n,s]=f.useState(""),[l,r]=f.useState(""),[a,i]=f.useState(null),[o,c]=f.useState(!1),d=async u=>{if(u.preventDefault(),!n.trim()||!l.trim()){i("   .");return}c(!0),i(null);try{const p=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:l})});if(!p.ok){let h=`  (${p.statusText})`;try{const y=await p.json();y&&y.message&&(h=y.message)}catch(y){console.error("Login failed with a non-JSON response body.",y)}throw new Error(h)}const m=await p.json();e(m.user)}catch(p){i(p.message)}finally{c(!1)}};return t.jsx("div",{className:"flex items-center justify-center",children:t.jsxs("div",{className:"w-full max-w-sm p-6 space-y-6 bg-gray-800 rounded-lg shadow-2xl border border-color",children:[t.jsx("div",{children:t.jsx("p",{className:"mt-2 text-center text-gray-400",children:"   ."})}),t.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d,children:[t.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"username-login",className:"sr-only",children:"Username"}),t.jsx("input",{id:"username-login",name:"username",type:"text",autoComplete:"username",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:n,onChange:u=>s(u.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password-login",className:"sr-only",children:"Password"}),t.jsx("input",{id:"password-login",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:l,onChange:u=>r(u.target.value)})]})]}),a&&t.jsx("p",{className:"text-sm text-red-400 text-center",children:a}),t.jsx("div",{className:"w-full flex justify-center",children:t.jsx(z,{type:"submit",disabled:o,className:"w-full py-3 text-lg",children:o?" ...":""})})]}),t.jsx("div",{className:"text-sm text-center",children:t.jsx("a",{href:"#/register",onClick:u=>{u.preventDefault(),window.location.hash="#/register"},className:"font-medium text-blue-400 hover:text-blue-300",children:" ? "})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 flex items-center",children:t.jsx("div",{className:"w-full border-t border-gray-600"})}),t.jsx("div",{className:"relative flex justify-center text-sm",children:t.jsx("span",{className:"px-2 bg-gray-800 text-gray-400",children:"   "})})]}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(z,{disabled:!0,colorScheme:"yellow",className:"w-full",children:""}),t.jsx(z,{disabled:!0,colorScheme:"gray",className:"w-full",children:""})]})]})})},P0=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Ql=e=>{if(!e)return!1;const n=e.toLowerCase().replace(/\s/g,"");return P0.some(s=>n.includes(s))},M0=()=>{const{setCurrentUserAndRoute:e}=De(),[n,s]=f.useState(""),[l,r]=f.useState(""),[a,i]=f.useState(""),[o,c]=f.useState(""),[d,u]=f.useState(null),[p,m]=f.useState(!1),h=async y=>{if(y.preventDefault(),u(null),!n.trim()||!l.trim()||!a.trim()){u("  .");return}if(n.trim().length<2){u(" 2  .");return}if(a.trim().length<4){u(" 4  .");return}if(a!==o){u("  .");return}if(Ql(n)||Ql(l)){u("      .");return}m(!0);try{const b=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,nickname:l,password:a})});if(!b.ok){let g=`  (${b.statusText})`;try{g=(await b.json()).message||g}catch(x){console.error("Could not parse error response as JSON",x)}throw new Error(g)}const v=await b.json();e(v.user)}catch(b){u(b.message)}finally{m(!1)}};return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-gray-800 rounded-lg shadow-2xl border border-color",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold text-center text-white",children:""}),t.jsx("p",{className:"mt-2 text-center text-gray-400",children:"  ."})]}),t.jsxs("form",{className:"mt-8 space-y-4",onSubmit:h,children:[t.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"username-register",className:"sr-only",children:"Username"}),t.jsx("input",{id:"username-register",name:"username",type:"text",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:n,onChange:y=>s(y.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"nickname-register",className:"sr-only",children:"Nickname"}),t.jsx("input",{id:"nickname-register",name:"nickname",type:"text",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:l,onChange:y=>r(y.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password-register",className:"sr-only",children:"Password"}),t.jsx("input",{id:"password-register",name:"password",type:"password",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:a,onChange:y=>i(y.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password-confirm",className:"sr-only",children:"Confirm Password"}),t.jsx("input",{id:"password-confirm",name:"passwordConfirm",type:"password",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:" ",value:o,onChange:y=>c(y.target.value)})]})]}),d&&t.jsx("p",{className:"text-sm text-red-400 text-center",children:d}),t.jsx("div",{className:"w-full flex justify-center",children:t.jsx(z,{type:"submit",disabled:p,className:"w-full py-3 text-lg",children:p?" ...":""})})]}),t.jsx("div",{className:"text-sm text-center",children:t.jsx("a",{href:"#",onClick:y=>{y.preventDefault(),window.location.hash=""},className:"font-medium text-blue-400 hover:text-blue-300",children:"  ? "})})]})})},Oa="/images/Base.png",Da="/images/Base.png",Nc="/images/Hidden.png",Sc="/images/Hidden.png",yx="/images/RatingArena.png",bx="/images/PlayingArena.png",vx="/images/Championship.png",jx="/images/single/Map.png",wx="/images/tower/Tower.png",ji="draggableWindowSettings",be=({title:e,windowId:n,onClose:s,children:l,initialWidth:r=500,initialHeight:a,modal:i=!0,closeOnOutsideClick:o=!0,isTopmost:c=!0,headerContent:d,zIndex:u=50})=>{const[p,m]=f.useState({x:0,y:0}),[h,y]=f.useState(!1),b=f.useRef({x:0,y:0}),v=f.useRef({x:0,y:0}),[g,x]=f.useState(!1),j=f.useRef(p),[w,S]=f.useState(window.innerWidth<768),[C,k]=f.useState(!0),[M,_]=f.useState(1),E=f.useRef(null),I=f.useCallback(H=>{s&&o&&c&&E.current&&!E.current.contains(H.target)&&s()},[s,o,c]);f.useEffect(()=>{if(i&&s)return document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[i,s,I]),f.useEffect(()=>{const H=()=>S(window.innerWidth<768);return window.addEventListener("resize",H),H(),()=>window.removeEventListener("resize",H)},[]),f.useEffect(()=>{const H=()=>{if(w){_(1);return}const te=window.innerWidth,le=Math.min(1,te/(r+100));_(le)};return window.addEventListener("resize",H),H(),()=>window.removeEventListener("resize",H)},[w,r]),f.useEffect(()=>{j.current=p},[p]),f.useEffect(()=>{try{const te=JSON.parse(localStorage.getItem(ji)||"{}").rememberPosition??!0;if(k(te),te){const le=JSON.parse(localStorage.getItem("draggableWindowPositions")||"{}");le[n]?m(le[n]):m({x:0,y:0})}else m({x:0,y:0})}catch(H){console.error("Failed to load window settings from localStorage",H),m({x:0,y:0})}x(!0)},[n]);const R=f.useCallback((H,te)=>{y(!0),b.current={x:H,y:te},v.current=j.current},[]),A=f.useCallback(H=>{!c||H.button!==0||R(H.clientX,H.clientY)},[R,c]),O=f.useCallback(H=>{if(!c)return;const te=H.touches[0];R(te.clientX,te.clientY)},[R,c]),B=f.useCallback((H,te)=>{if(!h||!E.current)return;const le=H-b.current.x,ce=te-b.current.y;let ve=v.current.x+le,F=v.current.y+ce;const{offsetWidth:X,offsetHeight:ee}=E.current,{innerWidth:xe,innerHeight:Q}=window,G=X/2,K=ee/2,Z=-(xe/2)+G,fe=xe/2-G,we=50;let P,Y;ee<=Q?(P=-(Q/2)+K,Y=Q/2-K):(P=-(Q/2)-K+we,Y=Q/2+K-we),ve=Math.max(Z,Math.min(ve,fe)),F=Math.max(P,Math.min(F,Y)),m({x:ve,y:F})},[h]),V=f.useCallback(H=>{B(H.clientX,H.clientY)},[B]),D=f.useCallback(H=>{if(h){const te=H.touches[0];B(te.clientX,te.clientY)}},[h,B]),L=f.useCallback(()=>{if(h&&(y(!1),C))try{const H=JSON.parse(localStorage.getItem("draggableWindowPositions")||"{}");H[n]=j.current,localStorage.setItem("draggableWindowPositions",JSON.stringify(H))}catch(H){console.error("Failed to save window position to localStorage",H)}},[h,n,C]);f.useEffect(()=>(h&&(window.addEventListener("mousemove",V),window.addEventListener("mouseup",L),window.addEventListener("touchmove",D),window.addEventListener("touchend",L)),()=>{window.removeEventListener("mousemove",V),window.removeEventListener("mouseup",L),window.removeEventListener("touchmove",D),window.removeEventListener("touchend",L)}),[h,V,D,L]);const q=H=>{const te=H.target.checked;k(te);try{const le=JSON.parse(localStorage.getItem(ji)||"{}");if(le.rememberPosition=te,localStorage.setItem(ji,JSON.stringify(le)),!te){m({x:0,y:0});const ce=JSON.parse(localStorage.getItem("draggableWindowPositions")||"{}");delete ce[n],localStorage.setItem("draggableWindowPositions",JSON.stringify(ce))}}catch(le){console.error("Failed to save remember position setting",le)}},U=`translate(calc(-50% + ${p.x}px), calc(-50% + ${p.y}px)) scale(${h?M*1.02:M})`;if(!g)return null;const W=c?"cursor-move":"";return t.jsxs(t.Fragment,{children:[i&&t.jsx("div",{className:`fixed inset-0 z-40 bg-black/50 ${c?"":"backdrop-blur-sm"}`}),t.jsxs("div",{ref:E,className:"fixed top-1/2 left-1/2 bg-primary rounded-xl shadow-2xl border border-color flex flex-col text-on-panel",style:{width:w?"90vw":void 0,minWidth:w?"90vw":`${r}px`,maxWidth:w?"90vw":"calc(100vw - 40px)",height:a?`${a}px`:void 0,maxHeight:"90vh",transform:U,transformOrigin:"center",boxShadow:h?"0 25px 50px -12px rgba(0, 0, 0, 0.5)":"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",zIndex:u},children:["                ",!c&&t.jsx("div",{className:"absolute inset-0 bg-black/30 z-20 rounded-xl cursor-not-allowed"}),t.jsxs("div",{className:`bg-secondary p-3 rounded-t-xl flex justify-between items-center ${W} touch-none`,onMouseDown:A,onTouchStart:O,children:[t.jsx("h2",{className:"text-lg font-bold text-secondary select-none",children:e}),t.jsxs("div",{className:"flex items-center gap-2",children:[d,s&&t.jsx("button",{onClick:c?s:void 0,className:"w-10 h-10 flex items-center justify-center rounded-full bg-tertiary hover:bg-danger transition-colors z-30",children:t.jsx("span",{className:"text-white font-bold text-lg",children:""})})]})]}),t.jsx("div",{className:"p-3 md:p-6 flex-grow h-full",children:l}),t.jsx("div",{className:"flex-shrink-0 p-2 border-t border-color flex justify-end items-center bg-secondary rounded-b-xl",children:t.jsxs("label",{className:"flex items-center text-xs text-tertiary gap-2 cursor-pointer select-none",children:[t.jsx("input",{type:"checkbox",checked:C,onChange:q,className:"w-4 h-4 bg-tertiary border-color rounded focus:ring-accent"}),"  "]})})]})]})},T0=({currentUser:e,statsType:n,onClose:s,onAction:l})=>{const r=n==="strategic",a=r?"   ":"   ",i=r?Ye:rt,{stats:o,diamonds:c}=e,d=300,u=500,p=c>=d,m=c>=u,h=b=>{p&&window.confirm(` ${d}  '${b}'   ?`)&&l({type:"RESET_SINGLE_STAT",payload:{mode:b}})},y=()=>{if(!m)return;const b=r?"":"";window.confirm(` ${u}   '${b}'   ?`)&&l({type:"RESET_STATS_CATEGORY",payload:{category:n}})};return t.jsxs(be,{title:a,onClose:s,windowId:"detailed-stats",initialWidth:600,children:[t.jsx("div",{className:"max-h-[calc(var(--vh,1vh)*60)] overflow-y-auto pr-2",children:t.jsx("ul",{className:"space-y-3",children:i.map(({mode:b})=>{const v=o==null?void 0:o[b];if(!v||v.wins===0&&v.losses===0)return null;const g=v.wins+v.losses,x=g>0?Math.round(v.wins/g*100):0;return t.jsxs("li",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsx("h3",{className:"text-lg font-bold text-yellow-300 mb-2",children:b}),t.jsx(z,{onClick:()=>h(b),disabled:!p,className:"!text-xs !py-1",colorScheme:"orange",title:`:  ${d}`,children:""})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm text-center",children:[t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:"/"}),t.jsxs("p",{className:"font-semibold text-white",children:[v.wins," ",v.losses,""]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:""}),t.jsxs("p",{className:"font-semibold text-white",children:[x,"%"]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[v.rankingScore,""]})]})]})]},b)})})}),t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700 text-center",children:[t.jsxs("p",{className:"text-sm mb-2 text-gray-300",children:[" :",t.jsxs("span",{className:"font-bold text-cyan-300 ml-2 flex items-center justify-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",c.toLocaleString()]})]}),t.jsxs(z,{onClick:y,colorScheme:"red",disabled:!m,title:`:  ${u}`,children:[r?"":"","   "]})]})]})},Nx=e=>e.mannerScore??200,kc=e=>e>=2e3?{rank:"",color:"text-purple-400"}:e>=1600?{rank:"",color:"text-blue-400"}:e>=1100?{rank:"",color:"text-cyan-400"}:e>=800?{rank:" ",color:"text-teal-400"}:e>=400?{rank:"",color:"text-green-400"}:e>=200?{rank:"",color:"text-gray-300"}:e>=100?{rank:"",color:"text-yellow-400"}:e>=50?{rank:"",color:"text-orange-400"}:e>=1?{rank:" ",color:"text-red-500"}:{rank:"",color:"text-red-700"},Sx=e=>{const n=Math.max(0,Math.min(100,e/2e3*100));let s="bg-red-700";return e>=2e3?s="bg-purple-400":e>=1600?s="bg-blue-400":e>=1100?s="bg-cyan-400":e>=800?s="bg-teal-400":e>=400?s="bg-green-400":e>=200?s="bg-gray-300":e>=100?s="bg-yellow-400":e>=50?s="bg-orange-400":e>=1&&(s="bg-red-500"),{percentage:n,colorClass:s}},Yl=({mobile:e=!1,compact:n=!1,showOnlyWhenQuestCompleted:s=!1,fillHeight:l=!0})=>{const{handlers:r,unreadMailCount:a,hasClaimableQuest:i}=De();if(s&&!i)return null;const o=[{label:"",iconUrl:"/images/quickmenu/quest.png",handler:r.openQuests,disabled:!1,notification:i},{label:"",iconUrl:"/images/quickmenu/gibo.png",handler:()=>alert("   ."),disabled:!0,notification:!1},{label:"",iconUrl:"/images/quickmenu/enhance.png",handler:r.openBlacksmithModal,disabled:!1,notification:!1},{label:"",iconUrl:"/images/quickmenu/store.png",handler:r.openShop,disabled:!1,notification:!1},{label:"",iconUrl:"/images/quickmenu/bag.png",handler:r.openInventory,disabled:!1,notification:!1}],c=e?"flex justify-around items-center gap-2":`bg-gray-800/50 rounded-lg p-${n?1:2} flex flex-col justify-around gap-${n?1:2} ${l?"h-full":""}`,d=e?"flex flex-col items-center justify-center p-1 rounded-md w-14 h-14 bg-gray-700/50 hover:bg-gray-600/50":"flex flex-col items-center justify-center p-1 rounded-lg w-full bg-gray-700/50 hover:bg-gray-600/50",u=e?"w-6 h-6 object-contain":n?"w-7 h-7 object-contain":"w-8 h-8 object-contain",p=e||n?"text-[10px] mt-1":"text-xs mt-1",m=e?"absolute top-1 right-1 bg-red-500 rounded-full w-2.5 h-2.5 border-2 border-gray-800":`absolute top-1 right-1 bg-red-500 rounded-full w-2.5 h-2.5 border-2 ${n?"border-gray-800":"border-gray-800/50"}`,h=e?"absolute top-0 right-0 bg-red-500 text-white text-[10px] font-bold rounded-full w-4 h-4 flex items-center justify-center border-2 border-gray-800":`absolute top-0 right-0 bg-red-500 text-white text-[10px] font-bold rounded-full ${n?"w-4 h-4":"w-5 h-5"} flex items-center justify-center border-2 ${n?"border-gray-800":"border-gray-800/50"}`,y=b=>t.jsxs("button",{onClick:b.handler,disabled:b.disabled,className:`relative flex-1 ${d} disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,title:b.label,children:[t.jsx("img",{src:b.iconUrl,alt:b.label,className:u}),t.jsx("span",{className:p,children:b.label}),b.notification&&(b.count&&b.count>0?t.jsx("span",{className:h,children:b.count>9?"9+":b.count}):t.jsx("span",{className:m}))]},b.label);return t.jsx("div",{className:c,children:o.map(y)})},Xl=({messages:e,onAction:n,mode:s,onViewUser:l,locationPrefix:r})=>{const a=f.useRef(null),i=f.useRef(null),[o,c]=f.useState(""),[d,u]=f.useState(!1),[p,m]=f.useState(0),{currentUserWithStatus:h,handlers:y}=De();f.useEffect(()=>{a.current&&(a.current.scrollTop=a.current.scrollHeight)},[e]),f.useEffect(()=>{if(p>0){const C=setTimeout(()=>{m(k=>Math.max(0,k-1))},1e3);return()=>clearTimeout(C)}},[p]),f.useEffect(()=>{const C=k=>{i.current&&!i.current.contains(k.target)&&u(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);const b=C=>{if(p>0)return;const k={channel:"global",...C,location:r};n({type:"SEND_CHAT_MESSAGE",payload:k}),u(!1),c(""),m(5)},v=C=>{if(C.preventDefault(),!!o.trim()){if(Ql(o)){alert("       ."),c("");return}b({text:o})}};if(!h)return null;const g=C=>{h.isAdmin&&C!==h.id?y.openModerationModal(C):C!==h.id&&(l||y.openViewingUser)(C)},x=(h.chatBanUntil??0)>Date.now(),j=x?Math.ceil((h.chatBanUntil-Date.now())/1e3/60):0,w=x||p>0,S=x?`   (${j} )`:w?`(${p})`:"[ ]";return t.jsxs("div",{className:"p-4 flex flex-col h-full min-h-0 text-on-panel",children:[t.jsx("h2",{className:"text-lg font-semibold border-b border-color pb-1 flex-shrink-0",children:""}),t.jsx("p",{className:"text-[10px] text-center text-yellow-400 bg-tertiary/50 rounded-sm p-0.5",children:"AI      . "}),t.jsxs("div",{ref:a,className:"flex-grow space-y-0.5 overflow-y-auto pr-1 bg-tertiary/40 p-1 rounded-md min-h-0",children:[e.map(C=>{const k=C.system&&!C.actionInfo&&C.user.nickname==="AI ";return t.jsxs("div",{className:"text-xs",children:[C.location&&t.jsx("span",{className:"font-semibold text-tertiary pr-1",children:C.location}),t.jsxs("span",{className:`font-semibold pr-2 ${C.system?"text-highlight":"text-tertiary cursor-pointer hover:underline"}`,onClick:()=>!C.system&&g(C.user.id),title:C.system?"":`${C.user.nickname}   / `,children:[C.system?k?"AI ":"":C.user.nickname,":"]}),C.text&&t.jsxs("span",{className:k?"text-highlight":"",children:[C.text,k&&" "]}),C.emoji&&t.jsx("span",{className:"text-xl",children:C.emoji})]},C.id)}),e.length===0&&t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:"  ."})]}),t.jsxs("div",{className:"relative flex-shrink-0",children:[d&&t.jsxs("div",{ref:i,className:"absolute bottom-full mb-2 w-full bg-secondary rounded-lg shadow-xl p-1 z-10 max-h-64 overflow-y-auto",children:[t.jsx("div",{className:"grid grid-cols-5 gap-1 text-xl mb-1 border-b border-color pb-1",children:xx.map(C=>t.jsxs("button",{onClick:()=>b({emoji:C}),className:"w-full p-1 rounded-md hover:bg-accent transition-colors text-center",children:[" ",C," "]},C))}),t.jsx("ul",{className:"space-y-0.5",children:fx.map(C=>t.jsxs("li",{children:[" ",t.jsxs("button",{onClick:()=>b({text:C}),className:"w-full text-left text-xs p-1 rounded-md hover:bg-accent transition-colors",children:[" ",C," "]})," "]},C))})]}),t.jsxs("form",{onSubmit:v,className:"flex gap-1",children:[t.jsx("button",{type:"button",onClick:()=>u(C=>!C),className:"bg-secondary hover:bg-tertiary text-primary font-bold px-2.5 rounded-md transition-colors text-lg flex items-center justify-center",title:" ",disabled:w,children:t.jsx("span",{children:""})}),t.jsx("input",{type:"text",value:o,onChange:C=>c(C.target.value),placeholder:S,className:"flex-grow bg-tertiary border border-color rounded-md p-1 focus:ring-accent focus:border-accent text-xs disabled:bg-secondary disabled:text-tertiary",maxLength:30,disabled:w}),t.jsx(z,{type:"submit",disabled:!o.trim()||w,className:"!px-2 !py-1",title:"",children:""})]})]})]})},ou=e=>{if(!e.inventory)return 0;const n=e.inventory.filter(l=>l.isEquipped);let s=0;return n.forEach(l=>{if(l.options){const{main:r,combatSubs:a,specialSubs:i,mythicSubs:o}=l.options;r&&(s+=r.value),a.forEach(c=>s+=c.value),i.forEach(c=>s+=c.value),o.forEach(c=>s+=c.value)}}),s},cu=({user:e,rank:n,value:s,isCurrentUser:l})=>{const r=f.useMemo(()=>{var i;return(i=Me.find(o=>o.id===e.avatarId))==null?void 0:i.url},[e.avatarId]),a=f.useMemo(()=>{var i;return(i=Re.find(o=>o.id===e.borderId))==null?void 0:i.url},[e.borderId]);return t.jsxs("div",{className:`flex items-center p-1 rounded-md ${l?"bg-blue-500/30":""}`,children:[t.jsx("span",{className:"w-8 text-center font-bold",children:n}),t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:r,borderUrl:a,size:24}),t.jsx("span",{className:"flex-1 truncate font-semibold ml-2",children:e.nickname}),t.jsx("span",{className:"w-16 text-right font-mono",children:s.toLocaleString()})]})},du=({isTopmost:e})=>{const{allUsers:n,currentUserWithStatus:s}=De(),[l,r]=f.useState("combat"),a=f.useMemo(()=>l==="combat"?n.filter(o=>o).map(o=>({user:o,value:ou(o)})).sort((o,c)=>c.value-o.value).slice(0,100):n.filter(o=>o).map(o=>({user:o,value:o.mannerScore})).sort((o,c)=>c.value-o.value).slice(0,100),[n,l]),i=f.useMemo(()=>{if(!s)return null;const o=a.findIndex(d=>d.user&&d.user.id===s.id);if(o!==-1)return{...a[o],rank:o+1};const c=l==="combat"?ou(s):s.mannerScore;return{user:s,value:c,rank:"N/A"}},[a,s,l]);return t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-2 h-full",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0",children:" "}),t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg flex-shrink-0",children:[t.jsx("button",{onClick:()=>r("combat"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="combat"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>r("manner"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="manner"?"bg-yellow-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),t.jsxs("div",{className:"flex-grow overflow-y-auto pr-1 text-xs flex flex-col gap-1 min-h-0 h-48",children:[i&&t.jsx("div",{className:"sticky top-0 bg-panel z-10",children:t.jsx(cu,{user:i.user,rank:i.rank,value:i.value,isCurrentUser:!0})}),t.jsx("div",{className:"flex flex-col gap-1",children:a.filter(o=>o&&o.user).map((o,c)=>t.jsx(cu,{user:o.user,rank:c+1,value:o.value,isCurrentUser:!1},o.user.id))})]})]})},uu=({user:e,rank:n,value:s,isCurrentUser:l})=>{const r=f.useMemo(()=>{var i;return(i=Me.find(o=>o.id===e.avatarId))==null?void 0:i.url},[e.avatarId]),a=f.useMemo(()=>{var i;return(i=Re.find(o=>o.id===e.borderId))==null?void 0:i.url},[e.borderId]);return t.jsxs("div",{className:`flex items-center p-1 rounded-md ${l?"bg-blue-500/30":""}`,children:[t.jsx("span",{className:"w-8 text-center font-bold",children:n}),t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:r,borderUrl:a,size:24}),t.jsx("span",{className:"flex-1 truncate font-semibold ml-2",children:e.nickname}),t.jsx("span",{className:"w-16 text-right font-mono",children:s.toLocaleString()})]})},mu=({isTopmost:e})=>{const{allUsers:n,currentUserWithStatus:s}=De(),[l,r]=f.useState("strategic"),a=f.useMemo(()=>{if(l==="championship")return n.filter(o=>o&&typeof o.tournamentScore=="number").map(o=>({user:o,value:o.tournamentScore})).sort((o,c)=>c.value-o.value).slice(0,100);{const o=l==="strategic"?"standard":"playful";return n.filter(c=>c).map(c=>{var d;return{user:c,value:((d=c.cumulativeRankingScore)==null?void 0:d[o])||0}}).sort((c,d)=>d.value-c.value).slice(0,100)}},[n,l]),i=f.useMemo(()=>{var d;if(!s)return null;let o;if(l==="championship")o=s.tournamentScore;else{const u=l==="strategic"?"standard":"playful";o=((d=s.cumulativeRankingScore)==null?void 0:d[u])||0}const c=a.findIndex(u=>u.user&&u.user.id===s.id);return c!==-1?{...a[c],rank:c+1}:{user:s,value:o,rank:"N/A"}},[a,s,l]);return t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-2 h-full",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0",children:" "}),t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg flex-shrink-0",children:[t.jsx("button",{onClick:()=>r("strategic"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="strategic"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "}),t.jsx("button",{onClick:()=>r("playful"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="playful"?"bg-yellow-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "}),t.jsx("button",{onClick:()=>r("championship"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="championship"?"bg-purple-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-1 text-xs flex flex-col gap-1 min-h-0 h-48",children:t.jsxs(t.Fragment,{children:[i&&t.jsx("div",{className:"sticky top-0 bg-panel z-10",children:t.jsx(uu,{user:i.user,rank:i.rank,value:i.value,isCurrentUser:!0})}),t.jsx("div",{className:"flex flex-col gap-1",children:a.filter(o=>o&&o.user).map((o,c)=>t.jsx(uu,{user:o.user,rank:c+1,value:o.value,isCurrentUser:!1},o.user.id))})]})})]})};function _0(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const fu=({level:e,currentXp:n,label:s,colorClass:l})=>{const r=1e3+(e-1)*200,a=Math.min(n/r*100,100);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-0.5 text-xs",children:[t.jsxs("span",{className:"font-semibold",children:[s," ",t.jsxs("span",{className:"text-base font-bold",children:["Lv.",e]})]}),t.jsxs("span",{className:"font-mono text-tertiary",children:[n," / ",r]})]}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-full h-3 border border-color",children:t.jsx("div",{className:`${l} h-full rounded-full transition-width duration-500`,style:{width:`${a}%`}})})]})},A0={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},R0=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-purple-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},xu=({slot:e,item:n,onClick:s})=>{const l=n&&s?"cursor-pointer hover:scale-105 transition-transform":"";if(n){const r=En[n.grade],a=`${n.name} (  : ${r}) -  `,i=R0(n.stars);return t.jsxs("div",{className:`relative w-full aspect-square rounded-lg border-2 border-color/50 bg-tertiary/50 ${l}`,title:a,onClick:s,children:[t.jsx("img",{src:A0[n.grade],alt:n.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),n.stars>0&&t.jsxs("div",{className:`absolute top-1 right-1.5 text-sm font-bold z-10 ${i.colorClass}`,style:{textShadow:"1px 1px 2px black"},children:["",n.stars]}),n.image&&t.jsx("img",{src:n.image,alt:n.name,className:"relative w-full h-full object-contain p-1.5"})]})}else return t.jsx("img",{src:La[e],alt:`${e} empty slot`,className:"w-full aspect-square rounded-lg bg-tertiary/50 border-2 border-color/50"})},pu=({type:e,stats:n,onEnter:s,onViewStats:l,level:r,title:a,imageUrl:i,tier:o})=>{const d=e==="strategic"?"hover:shadow-blue-500/30":"hover:shadow-yellow-500/30",u=n.wins+n.losses,p=u>0?Math.round(n.wins/u*100):0;return t.jsxs("div",{onClick:s,className:`bg-panel border border-color rounded-lg p-2 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg ${d} cursor-pointer h-full text-on-panel`,children:[t.jsxs("h2",{className:"text-base font-bold flex items-center justify-center gap-1 h-6 mb-1",children:[a,o&&t.jsx("img",{src:o.icon,alt:o.name,className:"w-5 h-5",title:o.name}),t.jsxs("span",{className:"text-sm text-highlight font-normal",children:["Lv.",r]})]}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden",children:t.jsx("img",{src:i,alt:a,className:"w-full h-full object-cover"})}),t.jsxs("div",{onClick:m=>{m.stopPropagation(),l()},className:"w-full bg-tertiary/50 rounded-md p-1 text-xs flex justify-between items-center cursor-pointer hover:bg-tertiary transition-colors mt-2",title:"  ",children:[t.jsxs("span",{children:[" : ",n.wins," ",n.losses," (",p,"%)"]}),t.jsx("span",{className:"text-accent font-semibold",children:""})]})]})},B0=({title:e,imageUrl:n,layout:s,footerContent:l})=>{const r=s==="tall";return t.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 border-2 border-purple-500/50 rounded-lg p-2 flex flex-col text-center shadow-lg shadow-purple-500/20 h-full text-on-panel relative overflow-hidden cursor-not-allowed group",children:[t.jsx("div",{className:"absolute top-2 -right-10 transform rotate-45 bg-purple-600 text-white text-[10px] font-bold px-10 py-0.5 z-10",children:"Coming Soon"}),t.jsx("h2",{className:"text-base font-bold text-purple-300 mt-1 h-6 mb-1",children:e}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden transition-transform duration-300 group-hover:scale-105 bg-black/20",children:t.jsx("img",{src:n,alt:e,className:`w-full h-full object-contain p-2 ${r?"object-contain":"object-cover"}`})}),l&&t.jsx("div",{className:"w-full bg-tertiary/50 rounded-md p-1 text-xs mt-2",children:l})]})},gu=(e,n,s)=>{if(s===0)return At[At.length-1];for(const l of At)if(l.threshold(e,n,s))return l;return At[At.length-1]},L0=()=>{const{currentUserWithStatus:e,allUsers:n,handlers:s,waitingRoomChats:l,hasClaimableQuest:r,presets:a}=De(),[i,o]=f.useState(null),[c,d]=f.useState(!1),[u,p]=f.useState(!1),[m,h]=f.useState(""),[y,b]=f.useState(0);if(f.useEffect(()=>{const G=()=>{const Z=new Date,fe=Z.getFullYear(),we=Z.getMonth(),Y=new Date(fe,we+1,1).getTime()-Z.getTime(),ae=Math.floor(Y/(1e3*60*60*24)),oe=Math.floor(Y%(1e3*60*60*24)/(1e3*60*60));h(`${ae} ${oe} `)};G();const K=setInterval(G,60*60*1e3);return()=>clearInterval(K)},[]),!e)return null;const{inventory:v,stats:g,nickname:x,avatarId:j,borderId:w}=e,S=f.useMemo(()=>l.global||[],[l]),C=_0(S.length),k=u||r;f.useEffect(()=>{!c&&C!==void 0&&S.length>C&&p(!0)},[S.length,C,c]);const M=f.useMemo(()=>{var G;return(G=Me.find(K=>K.id===j))==null?void 0:G.url},[j]),_=f.useMemo(()=>{var G;return(G=Re.find(K=>K.id===w))==null?void 0:G.url},[w]),E=f.useMemo(()=>(v||[]).filter(G=>G.isEquipped),[v]),I=G=>E.find(K=>K.slot===G),R=f.useMemo(()=>{const G={wins:0,losses:0},K={wins:0,losses:0};if(g){for(const Z of Ye){const fe=g[Z.mode];fe&&(G.wins+=fe.wins,G.losses+=fe.losses)}for(const Z of rt){const fe=g[Z.mode];fe&&(K.wins+=fe.wins,K.losses+=fe.losses)}}return{strategic:G,playful:K}},[g]),A=Nx(e),O=kc(A),B=Sx(A),{coreStatBonuses:V,specialStatBonuses:D,mythicStatBonuses:L}=f.useMemo(()=>gx(e),[e]);f.useMemo(()=>Object.values(D).some(G=>G.flat>0||G.percent>0),[D]),f.useMemo(()=>Object.values(L).some(G=>G.flat>0),[L]),f.useMemo(()=>{const G={};for(const K of Object.values(it))G[K]={count:0,totalValue:0};return E.forEach(K=>{var Z;(Z=K.options)==null||Z.mythicSubs.forEach(fe=>{const we=fe.type;G[we]&&(G[we].count++,G[we].totalValue+=fe.value)})}),G},[E]);const q=(e.strategyLevel-1)*2+(e.playfulLevel-1)*2,U=e.mannerMasteryApplied?20:0,W=e.bonusStatPoints||0,H=q+U+W,te=f.useMemo(()=>Object.values(e.spentStatPoints||{}).reduce((G,K)=>G+K,0),[e.spentStatPoints]),le=H-te,ce=G=>window.location.hash=`#/waiting/${G}`,ve=()=>window.location.hash="#/tournament",F=()=>window.location.hash="#/singleplayer",X=G=>{const K=Number(G.target.value);b(K);const Z=a[K];Z&&s.applyPreset(Z)},ee=f.useMemo(()=>{var ue,se;const G=(ge,je)=>{var ze;let me=0,Se=0;for(const Be of je){const He=(ze=ge.stats)==null?void 0:ze[Be.mode];He&&(me+=He.rankingScore,Se++)}return Se>0?me/Se:1200},K=n.map(ge=>({id:ge.id,score:G(ge,Ye)})).sort((ge,je)=>je.score-ge.score),Z=n.map(ge=>({id:ge.id,score:G(ge,rt)})).sort((ge,je)=>je.score-ge.score),fe=K.findIndex(ge=>ge.id===e.id)+1,we=Z.findIndex(ge=>ge.id===e.id)+1,P=((ue=K.find(ge=>ge.id===e.id))==null?void 0:ue.score)||0,Y=((se=Z.find(ge=>ge.id===e.id))==null?void 0:se.score)||0,ae=gu(P,fe,K.length),oe=gu(Y,we,Z.length);return{strategicTier:ae,playfulTier:oe}},[e,n]);N.Concentration+"",N.ThinkingSpeed+"",N.Judgment+"",N.Calculation+"",N.CombatPower+"",N.Stability+"",Fe.ActionPointMax+"",Fe.ActionPointRegen+"",Fe.StrategyXpBonus+"",Fe.PlayfulXpBonus+"",Fe.GoldBonus+"",Fe.ItemDropRate+"",Fe.MaterialDropRate+"",f.useMemo(()=>{const G={};return E.forEach(K=>{var Z;if((Z=K.options)!=null&&Z.main){const fe=K.options.main,we=fe.type;G[we]||(G[we]={value:0,isPercentage:fe.isPercentage}),G[we].value+=fe.value}}),G},[E]),f.useMemo(()=>{const G={};return E.forEach(K=>{var Z;(Z=K.options)!=null&&Z.combatSubs&&K.options.combatSubs.forEach(fe=>{const we=fe.type;G[we]||(G[we]={value:0,isPercentage:fe.isPercentage}),G[we].value+=fe.value})}),G},[E]);const xe=f.useMemo(()=>t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[t.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center gap-1 w-24",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ce,{userId:e.id,userName:x,size:80,avatarUrl:M,borderUrl:_}),t.jsxs("button",{onClick:s.openProfileEditModal,className:"absolute bottom-0 right-0 w-6 h-6 flex items-center justify-center bg-secondary hover:bg-tertiary rounded-full p-1 border-2 border-primary transition-transform hover:scale-110 active:scale-95",title:" ",children:[t.jsx("span",{className:"text-sm",children:""}),!e.mbti&&t.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-red-500 rounded-full"})]})]}),t.jsxs("div",{className:"flex flex-col items-center w-full",children:[t.jsx("div",{className:"flex items-center gap-1 w-full justify-center",children:t.jsx("h2",{className:"text-base font-bold truncate",title:x,children:x})}),t.jsxs("p",{className:"text-xs text-tertiary mt-0.5",children:["MBTI: ",e.mbti?e.mbti:""]})]})]}),t.jsxs("div",{className:"flex-grow space-y-1 bg-tertiary/30 p-2 rounded-md flex flex-col justify-center",children:[t.jsx(fu,{level:e.strategyLevel,currentXp:e.strategyXp,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-400"}),t.jsx(fu,{level:e.playfulLevel,currentXp:e.playfulXp,label:"",colorClass:"bg-gradient-to-r from-yellow-500 to-orange-400"}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-0.5 text-xs",children:[t.jsx("span",{className:"font-semibold",children:" "}),t.jsxs("span",{className:`font-semibold text-xs ${O.color}`,children:[A," (",O.rank,")"]})]}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-full h-2 border border-color",children:t.jsx("div",{className:`${B.colorClass} h-full rounded-full`,style:{width:`${B.percentage}%`}})})]})]})]}),t.jsxs("div",{className:"flex-grow flex flex-col min-h-0 border-t border-color mt-2 pt-2",children:[t.jsx("div",{className:"bg-tertiary/30 p-2 rounded-md text-center mb-2",children:e.guildId?t.jsx(z,{onClick:()=>window.location.hash="#/guild",colorScheme:"green",className:"w-full",children:" "}):t.jsx(z,{onClick:()=>window.location.hash="#/guild",colorScheme:"blue",className:"w-full",children:" "})}),t.jsxs("div",{className:"flex justify-between items-center mb-1 flex-shrink-0",children:[t.jsx("h3",{className:"font-semibold text-secondary text-sm",children:""}),t.jsxs("div",{className:"text-xs flex items-center gap-2",children:[t.jsxs("span",{children:[": ",t.jsx("span",{className:"font-bold text-green-400",children:le}),"P"]}),t.jsx(z,{onClick:s.openStatAllocationModal,colorScheme:"yellow",className:"!text-[10px] !py-0.5",children:""})]})]}),t.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:Object.values(N).map(G=>{var we;const K=(e.baseStats[G]||0)+(((we=e.spentStatPoints)==null?void 0:we[G])||0),Z=Math.floor(K*(V[G].percent/100))+V[G].flat,fe=K+Z;return t.jsxs("div",{className:"bg-tertiary/40 p-1 rounded-md flex items-center justify-between text-xs",children:[t.jsx("span",{className:"font-semibold text-secondary",children:G}),t.jsxs("span",{className:"font-mono font-bold",title:`: ${K}, : ${Z}`,children:[fe,Z>0&&t.jsxs("span",{className:"text-green-400 text-xs ml-0.5",children:["(+",Z,")"]})]})]},G)})})]})]}),[e,s,O,B,A,le,V]),Q=t.jsxs("div",{className:"grid grid-cols-10 grid-rows-2 lg:grid-rows-7 gap-4 h-full",children:[t.jsx("div",{className:"col-span-5 row-span-1 lg:col-span-5 lg:row-span-3",children:t.jsx(pu,{type:"strategic",stats:R.strategic,onEnter:()=>ce("strategic"),onViewStats:()=>o("strategic"),level:e.strategyLevel,title:" ",imageUrl:yx,tier:ee.strategicTier})}),t.jsx("div",{className:"col-span-5 row-span-1 lg:col-span-5 lg:row-span-3",children:t.jsx(pu,{type:"playful",stats:R.playful,onEnter:()=>ce("playful"),onViewStats:()=>o("playful"),level:e.playfulLevel,title:" ",imageUrl:bx,tier:ee.playfulTier})}),t.jsx("div",{className:"col-span-4 row-span-1 lg:col-span-4 lg:row-span-4",children:t.jsxs("div",{onClick:ve,className:"bg-panel border border-color rounded-lg p-2 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-purple-500/30 cursor-pointer h-full text-on-panel",children:[t.jsx("h2",{className:"text-base font-bold h-6 mb-1",children:""}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden",children:t.jsx("img",{src:vx,alt:"",className:"w-full h-full object-cover"})}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-md p-1 text-xs mt-2",title:" ",children:t.jsxs("span",{children:[": ",e.tournamentScore.toLocaleString()," / : ",e.league]})})]})}),t.jsx("div",{className:"col-span-4 row-span-1 lg:col-span-4 lg:row-span-4",children:t.jsxs("div",{onClick:F,className:"bg-panel border border-color rounded-lg p-2 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-green-500/30 cursor-pointer h-full text-on-panel",children:[t.jsx("h2",{className:"text-base font-bold h-6 mb-1",children:""}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden",children:t.jsx("img",{src:jx,alt:"",className:"w-full h-full object-cover"})}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-md p-1 text-xs mt-2",title:" ",children:t.jsxs("span",{children:[": ",e.singlePlayerProgress??0," / ",Jl.length]})})]})}),t.jsx("div",{className:"col-span-2 row-span-1 lg:col-span-2 lg:row-span-4",children:t.jsx(B0,{title:" ",imageUrl:wx,layout:"tall",footerContent:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{children:" : 1"}),t.jsx("span",{className:"text-tertiary",children:m})]})})})]});return t.jsxs("div",{className:"bg-primary text-primary p-2 sm:p-4 lg:p-2 max-w-screen-2xl mx-auto w-full h-full flex flex-col",children:[t.jsxs("header",{className:"flex justify-between items-center mb-2 px-2 flex-shrink-0",children:[t.jsx("h1",{className:"text-2xl font-bold text-primary",children:""}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:s.openEncyclopedia,className:"w-8 h-8 flex items-center justify-center bg-purple-600 hover:bg-purple-500 rounded-full text-white font-bold text-lg flex-shrink-0 transition-transform hover:scale-110",title:"",children:""}),t.jsx("button",{onClick:s.openInfoModal,className:"w-8 h-8 flex items-center justify-center bg-gray-600 hover:bg-gray-500 rounded-full text-white font-bold text-lg flex-shrink-0 transition-transform hover:scale-110",title:"",children:"?"})]})]}),t.jsxs("main",{className:"flex-1 flex flex-col min-h-0",children:[t.jsxs("div",{className:"hidden lg:flex flex-col h-full gap-2",children:[t.jsxs("div",{className:"flex flex-row gap-2",children:[t.jsx("div",{className:"w-[25%] bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-1",children:xe}),t.jsxs("div",{className:"flex-1 flex flex-row gap-2 min-w-0",children:[t.jsxs("div",{className:"w-[240px] bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0 mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:["fan","top","bottom","board","bowl","stones"].map(G=>{const K=I(G);return t.jsx("div",{className:"w-full",children:t.jsx(xu,{slot:G,item:K,onClick:()=>K&&s.openViewingItem(K,!0)})},G)})}),t.jsx(z,{onClick:s.openEquipmentEffectsModal,colorScheme:"blue",className:"mt-2 !text-xs",children:"  "}),t.jsx("div",{className:"mt-2",children:t.jsx("select",{value:y,onChange:X,className:"bg-secondary border border-color text-xs rounded-md p-1 focus:ring-accent focus:border-accent w-full",children:a&&a.map((G,K)=>t.jsx("option",{value:K,children:G.name},K))})})]}),t.jsxs("div",{className:"flex-1 flex flex-row gap-2",children:[t.jsx("div",{className:"flex-1",children:t.jsx(du,{})}),t.jsx("div",{className:"flex-1",children:t.jsx(mu,{})})]}),t.jsx("div",{className:"w-24 flex-shrink-0",children:t.jsx(Yl,{})})]})]}),t.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2 min-h-0",children:[t.jsx("div",{className:"col-span-5 bg-panel border border-color text-on-panel rounded-lg min-h-0 flex flex-col",children:t.jsx(Xl,{messages:S,mode:"global",onAction:s.handleAction,onViewUser:s.openViewingUser,locationPrefix:"[]"})}),t.jsx("div",{className:"col-span-7 min-h-0 flex flex-col justify-end",children:Q})]})]}),t.jsxs("div",{className:"lg:hidden flex flex-col h-full gap-2 relative",children:[t.jsxs("div",{className:"flex flex-col gap-2 flex-1 min-h-0 overflow-y-auto",children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-1",children:xe}),t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0 mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:["fan","top","bottom","board","bowl","stones"].map(G=>{const K=I(G);return t.jsx("div",{className:"w-full",children:t.jsx(xu,{slot:G,item:K,onClick:()=>K&&s.openViewingItem(K,!0)})},G)})}),t.jsx(z,{onClick:s.openEquipmentEffectsModal,colorScheme:"blue",className:"mt-2 !text-xs",children:"  "}),t.jsx("div",{className:"mt-2",children:t.jsx("select",{value:y,onChange:X,className:"bg-secondary border border-color text-xs rounded-md p-1 focus:ring-accent focus:border-accent w-full",children:a&&a.map((G,K)=>t.jsx("option",{value:K,children:G.name},K))})})]})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx(du,{}),t.jsx(mu,{})]}),t.jsx("div",{className:"flex-shrink-0",children:Q})]}),t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",children:t.jsx("button",{onClick:()=>{d(!0),p(!1)},className:"w-8 h-12 bg-secondary/80 backdrop-blur-sm rounded-l-lg flex items-center justify-center text-primary shadow-lg","aria-label":"/ ",children:t.jsxs("span",{className:"relative font-bold text-lg",children:["<",k&&t.jsx("div",{className:"absolute -top-1 -right-1.5 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-secondary"})]})})}),t.jsxs("div",{className:`fixed top-0 right-0 h-full w-[280px] bg-primary shadow-2xl z-50 transition-transform duration-300 ease-in-out ${c?"translate-x-0":"translate-x-full"} flex flex-col`,children:[t.jsxs("div",{className:"flex justify-between items-center p-2 border-b border-color flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold",children:" / "}),t.jsx("button",{onClick:()=>d(!1),className:"text-2xl font-bold text-tertiary hover:text-primary",children:""})]}),t.jsxs("div",{className:"flex flex-col gap-2 p-2 flex-grow min-h-0",children:[t.jsx("div",{className:"flex-shrink-0 p-1 bg-panel rounded-lg border border-color",children:t.jsx(Yl,{mobile:!0})}),t.jsx("div",{className:"flex-1 bg-panel border border-color rounded-lg min-h-0",children:t.jsx(Xl,{messages:S,mode:"global",onAction:s.handleAction,onViewUser:s.openViewingUser,locationPrefix:"[]"})})]})]}),c&&t.jsx("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:()=>d(!1)})]})]}),i&&t.jsx(T0,{currentUser:e,statsType:i,onClose:()=>o(null),onAction:s.handleAction})]})},$0=({mode:e,description:n,image:s,available:l,onSelect:r,hoverColorClass:a})=>{const[i,o]=f.useState(!1);return t.jsxs("div",{className:`bg-panel text-on-panel rounded-lg p-5 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg ${a} ${l?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,onClick:l?r:void 0,children:[t.jsx("div",{className:"w-[200px] h-[150px] mx-auto bg-tertiary rounded-md mb-4 flex items-center justify-center text-tertiary overflow-hidden shadow-inner",children:i?t.jsx("span",{className:"text-xs",children:e}):t.jsx("img",{src:s,alt:e,className:"w-full h-full object-cover",onError:()=>o(!0)})}),t.jsxs("div",{className:"flex-grow flex flex-col",children:[t.jsx("h3",{className:"text-xl font-bold text-primary mb-2",children:e}),t.jsx("p",{className:"text-tertiary text-sm flex-grow",children:n})]})]})},O0=({lobbyType:e})=>{const{gameModeAvailability:n,handlers:s}=De(),l=e==="strategic",r=l?" ":" ",a=l?Ye:rt,i=l?" ":" ",o=l?"border-blue-400":"border-yellow-400",c=l?"hover:shadow-blue-500/20":"hover:shadow-yellow-500/20",d=()=>window.location.hash="#/profile";return t.jsxs("div",{className:"bg-primary text-primary p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto",children:[t.jsxs("header",{className:"flex flex-wrap justify-between items-center mb-8 gap-4",children:[t.jsx("button",{onClick:d,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsxs("div",{className:"text-center flex-grow",children:[t.jsxs("h1",{className:"text-4xl font-bold",children:[r," "]}),t.jsx("p",{className:"text-secondary mt-2",children:"  ."})]}),t.jsx("div",{className:"w-24"})," "]}),t.jsx("main",{children:t.jsxs("section",{children:[t.jsx("h2",{className:`text-2xl font-semibold mb-5 border-l-4 ${o} pl-4`,children:i}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(u=>t.jsx($0,{...u,available:n[u.mode]??u.available,onSelect:()=>s.handleEnterWaitingRoom(u.mode),hoverColorClass:c},u.mode))})]})})]})},D0={[T.Standard]:{title:" ",sections:[{subtitle:" ",content:["   ()    .","            ."]},{subtitle:" ",content:["    .","       .","          ()  .","   ()   ."]},{subtitle:" ",content:["  ,    .","     ( 6.5)   .","     ."]}]},[T.Capture]:{title:" ",sections:[{subtitle:" ",content:["          ."]},{subtitle:" : ",content:["  (: 20)       .","     () ,      .","   ,       ."]},{subtitle:" ",content:["   ,         ."]},{subtitle:" ",content:["         ,   .","   ."]}]},[T.Speed]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" :   ",content:["      .","     ,   (: 5)    .","   ."]},{subtitle:" ",content:["  ,      .","      . (: 5 1)","       ."]}]},[T.Base]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" ",content:["1.  :         .","2.  :   ,    ()  () ,      ( ) .","3.  :       ,     ."]},{subtitle:" ",content:["  ,   1    (5) .","       ."]}]},[T.Hidden]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" ",content:["     ( , )    ."," :     .     .",":           .      ."]},{subtitle:" ",content:["     (4) .","   ,        ."]}]},[T.Missile]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" ",content:["          . (   )"]},{subtitle:" : ",content:["     , , ,      .","       .","       ."]}]},[T.Mix]:{title:" ",sections:[{subtitle:" ",content:["       ."]},{subtitle:" ",content:[", , , ,    2    ."," , + , +     .","        ."]}]},[T.Omok]:{title:"",sections:[{subtitle:" ",content:["  , ,        ."]},{subtitle:"",content:["    .","       .","    3-3 , (6 )     ."]}]},[T.Ttamok]:{title:"",sections:[{subtitle:" ",content:["        .","1.       ()","2.    (: 10) "]},{subtitle:"  ",content:["       ,             .","   ."]},{subtitle:" ",content:["  (3-3 ,   )    ."]}]},[T.Dice]:{title:" ",sections:[{subtitle:" ",content:[" 3 ,    ()  .","        ."]},{subtitle:" ",content:["1.    . (/   )","2.      ( )   .","3.       ."]},{subtitle:" ",content:["   1 1 .","        .","3        .    ."]}]},[T.Thief]:{title:" ",sections:[{subtitle:" ",content:[" 2      ,      ."]},{subtitle:"",content:[" ():         . 1  1 ."," ():     . 1  2 ."]},{subtitle:" ",content:["       .","      ,       .","   5 ."]},{subtitle:" ",content:[":       1 1 ",":      1 1 ","2         .    ."]}]},[T.Alkkagi]:{title:"",sections:[{subtitle:" ",content:["      ."]},{subtitle:" ",content:["1.  :       .","2. :            .","3.       ,           .","       ."]},{subtitle:" ",content:["      .","  ,          .","        ."]},{subtitle:" ",content:[",         .","    ,       ."]}]},[T.Curling]:{title:" ",sections:[{subtitle:" ",content:[" 3       ."]},{subtitle:" ",content:["     ()   .","        .","       ."]},{subtitle:" ",content:[" :   , ()      .  5, 3, 2, 1,      ."," :        1   ."]},{subtitle:"",content:["     ,     1     .    ."]},{subtitle:" ",content:[",         .","    ,       ."]}]}},q0=({mode:e,onClose:n})=>{const s=D0[e];return s?t.jsx(be,{title:`${s.title}  `,onClose:n,windowId:`help-${e}`,initialWidth:550,children:t.jsx("div",{className:"max-h-[70vh] overflow-y-auto pr-2 text-gray-300",children:t.jsx("div",{className:"space-y-4",children:s.sections.map((l,r)=>t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"font-bold text-lg text-yellow-300 mb-2",children:l.subtitle}),t.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm",children:l.content.map((a,i)=>t.jsx("li",{children:a},i))})]},r))})})}):t.jsx(be,{title:"",onClose:n,windowId:`help-${e}`,initialWidth:500,children:t.jsx("p",{className:"text-center text-gray-400",children:"       ."})})},U0=({mode:e,image:n,onChallenge:s})=>{const[l,r]=f.useState(!1);return t.jsxs("div",{className:"bg-panel text-on-panel rounded-lg p-3 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg cursor-pointer",onClick:()=>s(e),children:[t.jsx("div",{className:"w-[120px] h-[90px] mx-auto bg-tertiary rounded-md mb-2 flex items-center justify-center text-tertiary overflow-hidden shadow-inner",children:l?t.jsx("span",{className:"text-xs",children:e}):t.jsx("img",{src:n,alt:e,className:"w-full h-full object-cover",onError:()=>r(!0)})}),t.jsx("div",{className:"flex-grow flex flex-col",children:t.jsx("h3",{className:"text-lg font-bold text-primary mb-1",children:e})})]})},z0=({opponent:e,onChallenge:n,onClose:s,lobbyType:l})=>t.jsx(be,{title:" ",windowId:"challenge-selection",onClose:s,initialWidth:600,children:t.jsxs("div",{onMouseDown:r=>r.stopPropagation(),className:"text-sm",children:[t.jsxs("p",{className:"text-center text-yellow-300 mb-4",children:[e.nickname,"  ."]}),t.jsx("div",{className:"flex flex-col gap-6",children:t.jsx("div",{className:"grid grid-cols-3 gap-4",children:(l==="strategic"?Ye:rt).map(r=>t.jsx(U0,{mode:r.mode,image:r.image,onChallenge:n},r.mode))})}),t.jsx("div",{className:"mt-6 border-t border-gray-700 pt-6 flex justify-end gap-4",children:t.jsx(z,{onClick:s,variant:"secondary",children:""})})]})}),F0=[{mode:T.Omok,name:""},{mode:T.Dice,name:" "},{mode:T.Ttamok,name:""},{mode:T.Thief,name:""},{mode:T.Alkkagi,name:""},{mode:T.Curling,name:""},{mode:T.Standard,name:" "}],G0=({onClose:e})=>{const{currentUserWithStatus:n,handlers:s}=De(),[l,r]=f.useState([]);f.useEffect(()=>{n!=null&&n.rejectedGameModes&&r(n.rejectedGameModes)},[n]);const a=o=>{r(c=>c.includes(o)?c.filter(d=>d!==o):[...c,o])},i=()=>{s.handleAction({type:"UPDATE_REJECTION_SETTINGS",payload:{rejectedGameModes:l}}),e()};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-panel rounded-xl shadow-2xl w-full max-w-md p-6 border border-gray-700 flex flex-col",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-white",children:"  "}),t.jsx("p",{className:"text-gray-300 mb-4",children:"      ."}),t.jsx("div",{className:"flex flex-col gap-2 mb-6",children:F0.map((o,c)=>t.jsxs("label",{className:"flex items-center text-white cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:l.includes(o.mode),onChange:()=>a(o.mode),className:"form-checkbox h-5 w-5 text-accent rounded"}),t.jsx("span",{className:"ml-2",children:o.name})]},c))}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx(z,{onClick:e,colorScheme:"gray",children:""}),t.jsx(z,{onClick:i,colorScheme:"green",children:""})]})]})})},hu={online:{text:"",color:"text-green-500"},waiting:{text:" ",color:"text-green-400"},resting:{text:" ",color:"text-gray-400"},negotiating:{text:" ",color:"text-yellow-400"},"in-game":{text:" ",color:"text-blue-400"},spectating:{text:" ",color:"text-purple-400"}},yu=({users:e,onAction:n,currentUser:s,mode:l,negotiations:r,onViewUser:a,lobbyType:i})=>{const[o,c]=f.useState(!1),[d,u]=f.useState(null),[p,m]=f.useState(!1),h=e.find(g=>g.id===s.id),y=e.filter(g=>g.id!==s.id).sort((g,x)=>g.nickname.localeCompare(x.nickname)),b=g=>s.status!=="waiting"?!1:g.status==="waiting"||g.status==="online",v=(g,x)=>{var _,E;const j=!x&&b(g),w=hu[g.status],S=l===T.Dice,C=x?null:r.find(I=>I.challenger.id===s.id&&I.opponent.id===g.id&&(I.status==="pending"||I.status==="draft")),k=(_=Me.find(I=>I.id===g.avatarId))==null?void 0:_.url,M=(E=Re.find(I=>I.id===g.borderId))==null?void 0:E.url;return t.jsxs("li",{className:`flex items-center justify-between p-1.5 rounded-lg ${x?"bg-blue-900/40 border border-blue-700":"bg-tertiary/50"}`,children:[t.jsxs("div",{className:`flex items-center gap-2 lg:gap-3 overflow-hidden ${x?"":"cursor-pointer"}`,onClick:()=>!x&&a(g.id),title:x?"":`${g.nickname}  `,children:[t.jsx(Ce,{userId:g.id,userName:g.nickname,size:36,className:"border-2 border-color",avatarUrl:k,borderUrl:M}),S&&t.jsx("div",{className:"w-5 h-5 rounded-full bg-black border border-gray-300 flex-shrink-0"}),t.jsxs("div",{className:"overflow-hidden",children:[t.jsx("h3",{className:"font-bold text-sm lg:text-base truncate",children:g.nickname}),t.jsxs("span",{className:`text-xs ${w.color}`,children:[" ",w.text]})]})]}),x?t.jsxs("select",{value:s.status,onChange:I=>n({type:"SET_USER_STATUS",payload:{status:I.target.value}}),disabled:!["waiting","resting"].includes(s.status),className:"px-2 py-1 lg:px-3 lg:py-1.5 bg-secondary border border-color rounded-lg text-xs lg:text-sm transition-colors w-20 lg:w-24 text-center focus:ring-accent focus:border-accent disabled:opacity-50",children:[t.jsx("option",{value:"waiting",children:" "}),t.jsx("option",{value:"resting",children:" "}),!["waiting","resting"].includes(s.status)&&t.jsx("option",{value:s.status,disabled:!0,children:hu[s.status].text})]}):t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[s.isAdmin&&!g.isAdmin&&t.jsx(z,{onClick:()=>{window.confirm(`[${g.nickname}]   ?`)&&n({type:"ADMIN_FORCE_LOGOUT",payload:{targetUserId:g.id}})},colorScheme:"red",className:"!text-xs !py-1 !px-2",children:" "}),C?t.jsx(z,{onClick:()=>n({type:"DECLINE_NEGOTIATION",payload:{negotiationId:C.id}}),colorScheme:"red",className:"!text-xs !py-1 !px-2",children:" "}):t.jsx(z,{onClick:()=>{u(g),c(!0)},disabled:!j,className:"!text-xs !py-1 !px-2",children:" "})]})]},g.id)};return t.jsxs("div",{className:"p-3 flex flex-col min-h-0 text-on-panel",children:[t.jsxs("h2",{className:"text-xl font-semibold mb-2 border-b border-color pb-2 flex-shrink-0 flex justify-between items-center",children:[t.jsx("span",{children:" "}),t.jsx(z,{onClick:()=>m(!0),colorScheme:"none",className:"!text-xs !py-1 !px-2 bg-gradient-to-r from-purple-600 to-blue-500 hover:from-purple-700 hover:to-blue-600 text-white font-bold rounded-lg shadow-lg transition-all duration-200",children:"  "}),"            "]}),h&&t.jsx("div",{className:"flex-shrink-0 mb-2",children:v(h,!0)}),t.jsx("ul",{className:"space-y-2 overflow-y-auto pr-2 max-h-[calc(var(--vh,1vh)*25)] min-h-[96px]",children:y.length>0?y.map(g=>v(g,!1)):t.jsx("p",{className:"text-center text-tertiary pt-8",children:"  ."})}),p&&t.jsx(G0,{onClose:()=>m(!1)}),o&&d&&t.jsx(z0,{opponent:d,onClose:()=>c(!1),onChallenge:g=>{n({type:"CHALLENGE_USER",payload:{opponentId:d.id,mode:g}}),c(!1)},lobbyType:i})]})},W0=(e,n,s)=>{for(const l of At)if(l.threshold(e,n,s))return l;return At[At.length-1]},H0=()=>{const e=new Date,n=e.getFullYear().toString().slice(-2),s=e.getMonth();let l;return s<3?l=1:s<6?l=2:s<9?l=3:l=4,`${n}-${l}`},bu=({currentUser:e,mode:n,onViewUser:s,onShowTierInfo:l,onShowPastRankings:r,lobbyType:a})=>{const{allUsers:i}=De(),o=f.useMemo(()=>{const b=a==="strategic"?Ye:rt;return[...i].map(v=>{var w;let g=0,x=0;for(const S of b){const C=(w=v.stats)==null?void 0:w[S.mode];C&&(g+=C.rankingScore||0,x++)}const j=x>0?g/x:0;return{...v,avgScore:j}}).filter(v=>v.avgScore>0).sort((v,g)=>g.avgScore-v.avgScore)},[i,a]),c=f.useMemo(()=>{const b=a==="strategic"?Ye:rt;return o.filter(v=>{var x;let g=0;for(const j of b){const w=(x=v.stats)==null?void 0:x[j.mode];w&&(g+=(w.wins||0)+(w.losses||0))}return g>=20})},[o,a]);c.length;const d=At[At.length-1],u=o.findIndex(b=>b.id===e.id),p=u!==-1?{user:o[u],rank:u+1,score:o[u].avgScore}:null,m=o.slice(0,100),h=f.useCallback(b=>{var j;const v=c.findIndex(w=>w.id===b.id)+1;if(v===0)return d;const g=a==="strategic"?Ye:rt;let x=0;for(const w of g){const S=(j=b.stats)==null?void 0:j[w.mode];S&&(x+=(S.wins||0)+(S.losses||0))}return W0(b.avgScore,v,x)},[a,c,d]),y=f.useCallback((b,v,g)=>{var D,L,q;const x=a==="strategic"?Ye:rt;let j=0,w=0;for(const U of x){const W=(D=b.stats)==null?void 0:D[U.mode];W&&(j+=W.wins||0,w+=W.losses||0)}const S=j+w>0?Math.round(j/(j+w)*100):0,C=b.avgScore,k=h(b),M=!g&&b.id===e.id,_="flex items-center gap-2 rounded-lg",E="bg-yellow-900/40 border border-yellow-700",I="bg-blue-900/60 border border-blue-600",R="bg-tertiary/50",A=!g&&b.id!==e.id,O=`${_} ${g?E:M?I:R} p-1.5 ${A?"cursor-pointer hover:bg-secondary/50":""}`,B=(L=Me.find(U=>U.id===b.avatarId))==null?void 0:L.url,V=(q=Re.find(U=>U.id===b.borderId))==null?void 0:q.url;return t.jsxs("li",{className:O,onClick:A?()=>s(b.id):void 0,title:A?`${b.nickname}  `:"",children:[t.jsx("span",{className:"w-8 text-center font-mono text-sm",children:v}),t.jsx("img",{src:k.icon,alt:k.name,className:"w-8 h-8 flex-shrink-0",title:k.name}),t.jsx(Ce,{userId:b.id,userName:b.nickname,size:32,avatarUrl:B,borderUrl:V}),t.jsxs("div",{className:"flex-grow overflow-hidden",children:[t.jsx("p",{className:"font-semibold text-sm truncate",children:b.nickname}),t.jsxs("p",{className:"text-xs text-highlight font-mono",children:[Math.round(C),""]})]}),t.jsxs("div",{className:"text-right text-[10px] lg:text-xs flex-shrink-0 w-20 text-tertiary",children:[t.jsxs("p",{children:[j," ",w,""]}),t.jsxs("p",{className:"font-semibold",children:[S,"%"]})]})]},b.id)},[a,e.id,h,s]);return t.jsxs("div",{className:"p-4 flex flex-col text-on-panel",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-color pb-2 flex-shrink-0 flex-wrap gap-2",children:[t.jsxs("h2",{className:"text-xl font-semibold",children:[n,"  (",H0(),")"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(z,{onClick:()=>r({user:e,mode:n}),colorScheme:"none",className:"!text-xs !py-1 bg-gradient-to-r from-purple-600 to-blue-500 hover:from-purple-700 hover:to-blue-600 text-white font-bold rounded-lg shadow-lg transition-all duration-200",children:" "}),t.jsx(z,{onClick:l,colorScheme:"none",className:"!text-xs !py-1 bg-gradient-to-r from-purple-600 to-blue-500 hover:from-purple-700 hover:to-blue-600 text-white font-bold rounded-lg shadow-lg transition-all duration-200",children:" "})]})]}),p&&t.jsx("div",{className:"flex-shrink-0 mb-3",children:y(p.user,p.rank,!0)}),t.jsx("ul",{className:"space-y-2 overflow-y-auto pr-2 h-72",children:m.length>0?m.map((b,v)=>y(b,v+1,!1)):t.jsx("p",{className:"text-center text-tertiary pt-8",children:"  ."})})]})},vu=({games:e,onAction:n,currentUser:s})=>{const[l,r]=f.useState(""),[a,i]=f.useState(null),o=f.useRef(null);f.useEffect(()=>{const m=h=>{o.current&&!o.current.contains(h.target)&&i(null)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const c=()=>{const m=parseInt(l,10);if(isNaN(m)||m<1||m>e.length){alert("   .");return}const h=e[m-1];h&&n({type:"SPECTATE_GAME",payload:{gameId:h.id}}),r("")},d=m=>{i(h=>h===m?null:m)},u=m=>{const h=prompt("   (50 ):",m.description||"");if(h!==null){if(h.length>50){alert("  50   .");return}n({type:"ADMIN_SET_GAME_DESCRIPTION",payload:{gameId:m.id,description:h}})}i(null)},p=m=>{window.confirm(`[${m.player1.nickname} vs ${m.player2.nickname}]   ?`)&&n({type:"ADMIN_FORCE_DELETE_GAME",payload:{gameId:m.id}}),i(null)};return t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg shadow-lg p-4 flex flex-col min-h-0 h-full",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-color pb-2 flex-shrink-0",children:[t.jsx("h2",{className:"text-xl font-semibold",children:" "}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"number",min:"1",placeholder:" ",value:l,onChange:m=>{const h=m.target.value;(h===""||parseInt(h,10)>0)&&r(h)},onKeyDown:m=>{m.key==="Enter"&&c()},className:"w-24 bg-tertiary border border-color rounded-md p-2 focus:ring-accent focus:border-accent text-sm text-center"}),t.jsx("button",{onClick:c,className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg text-sm transition-colors shrink-0",children:""})]})]}),t.jsx("ul",{className:"space-y-3 overflow-y-auto pr-2 flex-grow",children:e.length>0?e.map((m,h)=>!m||!m.player1||!m.player2?null:t.jsxs("li",{className:"relative",children:[t.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-tertiary/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[t.jsx("div",{className:`flex-shrink-0 w-8 h-8 flex items-center justify-center bg-secondary rounded-full font-bold text-sm ${s.isAdmin?"cursor-pointer hover:bg-tertiary transition-colors":""}`,onClick:s.isAdmin?()=>d(m.id):void 0,title:s.isAdmin?"  ":` : ${h+1}`,children:h+1}),t.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[t.jsxs("div",{className:"text-center truncate",children:[t.jsx(Ce,{userId:m.player1.id,userName:m.player1.nickname,size:36,className:"border-2 border-color mx-auto"}),t.jsx("span",{className:"text-xs font-semibold block truncate",children:m.player1.nickname})]}),t.jsx("span",{className:"text-tertiary font-bold",children:"vs"}),t.jsxs("div",{className:"text-center truncate",children:[t.jsx(Ce,{userId:m.player2.id,userName:m.player2.nickname,size:36,className:"border-2 border-color mx-auto"}),t.jsx("span",{className:"text-xs font-semibold block truncate",children:m.player2.nickname})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[m.description&&t.jsx("div",{className:"text-sm text-highlight truncate max-w-xs hidden md:block",title:m.description,children:m.description}),t.jsx("button",{onClick:()=>n({type:"SPECTATE_GAME",payload:{gameId:m.id}}),className:"ml-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg text-sm transition-colors shrink-0",children:""})]})]}),s.isAdmin&&a===m.id&&t.jsxs("div",{ref:o,className:"absolute top-12 left-2 z-10 bg-secondary rounded-md shadow-lg p-2 space-y-2 w-48 border border-color",children:[t.jsx("button",{onClick:()=>u(m),className:"w-full text-left px-3 py-1.5 text-sm rounded hover:bg-accent transition-colors",children:"  /"}),t.jsx("button",{onClick:()=>p(m),className:"w-full text-left px-3 py-1.5 text-sm rounded hover:bg-danger text-red-300 transition-colors",children:"  "})]})]},m.id)):t.jsx("p",{className:"text-center text-tertiary pt-8",children:"  ."})})]})},V0=({onClose:e})=>{const n={:" 0.1%",:" 3%",:" 5%",:" 10%",:" 25%",:" 40%",:" 60%",:" 80%",:" "},s=r=>{if(r.includes(""))return"/images/icon/Zem.png";const a=js.find(i=>i.name===r);return(a==null?void 0:a.image)||null},l=r=>{const a=h0[r];if(!a)return t.jsx("span",{className:"text-gray-500",children:"  "});const i=[];return a.diamonds&&i.push({name:`${a.diamonds.toLocaleString()}`,image:"/images/icon/Zem.png"}),a.items&&a.items.forEach(o=>{const c="itemId"in o?o.itemId:o.name,d=s(c);i.push({name:`${c} x${o.quantity}`,image:d})}),t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:i.map((o,c)=>o.image&&t.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-700/50 px-2 py-1 rounded-md",title:o.name,children:[t.jsx("img",{src:o.image,alt:o.name,className:"w-5 h-5 object-contain"}),t.jsx("span",{className:"text-gray-300 whitespace-nowrap text-xs",children:o.name})]},c))})};return t.jsx(be,{title:"   ",onClose:e,windowId:"ranking-tier-info-modal",initialWidth:600,children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-300",children:"        .        ,  ."}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg",children:[t.jsx("h4",{className:"font-bold text-lg text-yellow-300 mb-2",children:" "}),t.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 1:"})," 1 1 ~ 3 31"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 2:"})," 4 1 ~ 6 30"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 3:"})," 7 1 ~ 9 30"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 4:"})," 10 1 ~ 12 31"]})]}),t.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"       ."})]}),t.jsx("ul",{className:"space-y-2 max-h-[40vh] overflow-y-auto pr-2",children:At.map(r=>t.jsxs("li",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{src:r.icon,alt:r.name,className:"w-12 h-12 mr-4 flex-shrink-0"}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("p",{className:`font-bold text-lg ${r.color}`,children:r.name}),t.jsx("p",{className:"text-sm text-gray-400",children:n[r.name]||"N/A"})]})]}),t.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-700/50",children:[t.jsx("h5",{className:"text-xs font-semibold text-gray-400 mb-1.5",children:"  "}),l(r.name)]})]},r.name))})]})})},K0=[T.Dice,T.Omok,T.Ttamok,T.Thief,T.Alkkagi,T.Curling];function J0(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const ju=({mode:e})=>{const{handlers:n}=De(),s=Ye.some(a=>a.mode===e),l=K0.includes(e);if(!s&&!l)return null;const r=s?`${e}()`:`${e}`;return t.jsxs("div",{className:"bg-panel rounded-lg shadow-lg p-3 flex items-center justify-between flex-shrink-0 text-on-panel",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ce,{userId:el,userName:"AI",size:40,className:"border-2 border-purple-500"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-base font-bold text-purple-300",children:"AI "}),t.jsxs("p",{className:"text-xs text-tertiary",children:[r,"()   ."]})]})]}),t.jsx(z,{onClick:()=>n.handleAction({type:"CHALLENGE_USER",payload:{opponentId:el,mode:e}}),colorScheme:"purple",className:"!text-sm !py-1.5",children:"  "})]})},wu=({mode:e})=>{const{announcements:n,globalOverrideAnnouncement:s,announcementInterval:l}=De(),[r,a]=f.useState(0),i=f.useMemo(()=>n.map(c=>c.id).join(","),[n]);return f.useEffect(()=>{if(!n||n.length<=1){a(0);return}const c=setInterval(()=>{a(d=>(d+1)%n.length)},l*1e3);return()=>clearInterval(c)},[i,n.length,l]),s&&(s.modes==="all"||s.modes.includes(e))?t.jsx("div",{className:"bg-yellow-800/50 border border-yellow-600 rounded-lg shadow-lg p-2 flex items-center justify-center flex-shrink-0 h-10",children:t.jsx("span",{className:"font-bold text-yellow-300 animate-pulse text-center",children:s.message})}):!n||n.length===0?t.jsx("div",{className:"bg-panel rounded-lg shadow-lg p-2 flex items-center justify-center flex-shrink-0 h-10 text-on-panel",children:t.jsx("span",{className:"font-bold text-tertiary text-center",children:"[   .]"})}):t.jsx("div",{className:"bg-panel rounded-lg shadow-lg px-4 relative overflow-hidden flex-shrink-0 h-10",children:t.jsx("div",{className:"w-full absolute top-0 left-0 transition-transform duration-1000 ease-in-out",style:{transform:`translateY(-${r*2.5}rem)`},children:n.map(c=>t.jsx("div",{className:"w-full h-10 flex items-center justify-center",children:t.jsxs("span",{className:"font-bold",children:[t.jsx("span",{className:"text-red-500 mr-2",children:"[]"}),t.jsx("span",{className:"text-highlight",children:c.message})]})},c.id))})})},Q0=({mode:e})=>{const{currentUserWithStatus:n,onlineUsers:s,allUsers:l,liveGames:r,waitingRoomChats:a,negotiations:i,handlers:o}=De(),[c,d]=f.useState(window.innerWidth<1024),[u,p]=f.useState(!1),[m,h]=f.useState(!1),[y,b]=f.useState(!1),[v,g]=f.useState(!1),x=f.useRef(null),j=a.global||[],w=J0(j.length);f.useEffect(()=>{!u&&w!==void 0&&j.length>w&&h(!0)},[j.length,w,u]);const S=()=>{o.handleAction({type:"LEAVE_WAITING_ROOM"}),window.location.hash="#/profile"};if(f.useEffect(()=>{const I=()=>d(window.innerWidth<1024);return window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)},[]),!n)return null;const C=Object.values(r).filter(I=>I.mode===e),k=f.useMemo(()=>{const I=e==="strategic",R=e==="playful",A=s.filter(B=>I?Ye.some(V=>V.mode===B.mode):R?rt.some(V=>V.mode===B.mode):B.mode===e),O=A.find(B=>B.id===n.id);return O?[O,...A.filter(B=>B.id!==n.id)]:A},[s,e,n.id]),M=f.useMemo(()=>Ye.some(I=>I.mode===e),[e]),E=`[${M?"":""}:${e}]`;return t.jsxs("div",{className:"bg-primary text-primary flex flex-col h-full max-w-full",children:[t.jsxs("header",{className:"flex justify-between items-center mb-4 flex-shrink-0 px-2 sm:px-4 lg:px-6 pt-2 sm:pt-4 lg:pt-6",children:[t.jsx("div",{className:"flex-1",children:t.jsx(z,{onClick:S,colorScheme:"gray",children:"  "})}),t.jsxs("div",{className:"flex-1 text-center flex items-center justify-center",children:[t.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:e==="strategic"?" ":e==="playful"?" ":`${e} `}),t.jsx("button",{onClick:()=>g(!0),className:"ml-3 w-8 h-8 flex items-center justify-center bg-secondary hover:bg-tertiary rounded-full text-primary font-bold text-xl flex-shrink-0 transition-transform hover:scale-110","aria-label":"  ",title:"  ",children:"?"})]}),t.jsx("div",{className:"flex-1 text-right",children:t.jsxs("p",{className:"text-secondary text-sm",children:[k.length,"  "]})})]}),t.jsx("div",{className:"flex-1 min-h-0 relative px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6",children:c?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col h-full gap-2",children:[t.jsx("div",{className:"flex-shrink-0",children:e!=="strategic"&&e!=="playful"&&t.jsx(wu,{mode:e})}),t.jsx("div",{className:"flex-shrink-0",children:e!=="strategic"&&e!=="playful"&&t.jsx(ju,{mode:e})}),t.jsx("div",{className:"flex-1 flex flex-row gap-2 items-stretch min-h-0",children:t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(vu,{games:C,onAction:o.handleAction,currentUser:n})})}),t.jsx("div",{className:"flex-1 min-h-0 bg-panel border border-color rounded-lg shadow-lg flex flex-col",children:t.jsx(Xl,{messages:j,mode:"global",onAction:o.handleAction,locationPrefix:E,onViewUser:o.openViewingUser})})]}),t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",children:t.jsx("button",{onClick:()=>{p(!0),h(!1)},className:"w-8 h-12 bg-secondary/80 backdrop-blur-sm rounded-l-lg flex items-center justify-center text-primary shadow-lg","aria-label":"    ",children:t.jsxs("span",{className:"relative font-bold text-lg",children:["<",m&&t.jsx("div",{className:"absolute -top-1 -right-1.5 w-2.5 h-2.5 bg-danger rounded-full border-2 border-secondary"})]})})}),t.jsxs("div",{className:`fixed top-0 right-0 h-full w-[280px] bg-primary shadow-2xl z-50 transition-transform duration-300 ease-in-out ${u?"translate-x-0":"translate-x-full"}`,children:[t.jsx("button",{onClick:()=>p(!1),className:"self-end text-2xl p-2 text-tertiary hover:text-primary",children:""}),t.jsx("div",{className:"flex-shrink-0 p-2 border-b border-color",children:t.jsx(Yl,{mobile:!0})}),t.jsx("div",{className:"flex-1 min-h-0",children:t.jsx(yu,{users:k,mode:e,onAction:o.handleAction,currentUser:n,negotiations:Object.values(i),onViewUser:o.openViewingUser,lobbyType:M?"strategic":"playful"})}),t.jsx("div",{className:"flex-1 min-h-0 border-t border-color",children:t.jsx(bu,{mode:e,onShowTierInfo:()=>b(!0),currentUser:n,onViewUser:o.openViewingUser,onShowPastRankings:I=>o.openPastRankings(I),lobbyType:M?"strategic":"playful"})})]}),u&&t.jsx("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:()=>p(!1)})]}):t.jsxs("div",{ref:x,className:"grid grid-cols-1 lg:grid-cols-5 h-full gap-4",children:[t.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-4 min-h-0",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(wu,{mode:e})}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx(ju,{mode:e})}),t.jsx("div",{className:"h-[350px] min-h-0",children:t.jsx(vu,{games:C,onAction:o.handleAction,currentUser:n})}),t.jsx("div",{className:"flex-1 flex flex-col bg-panel border border-color rounded-lg shadow-lg min-h-0",children:t.jsx(Xl,{messages:j,mode:"global",onAction:o.handleAction,locationPrefix:E,onViewUser:o.openViewingUser})})]}),t.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-4",children:[t.jsxs("div",{className:"flex-1 flex flex-row gap-4 items-stretch min-h-0",children:[t.jsx("div",{className:"flex-1 bg-panel border border-color rounded-lg shadow-lg min-w-0",children:t.jsx(yu,{users:k,mode:e,onAction:o.handleAction,currentUser:n,negotiations:Object.values(i),onViewUser:o.openViewingUser,lobbyType:M?"strategic":"playful"})}),t.jsx("div",{className:"w-24 flex-shrink-0",children:t.jsx(Yl,{})})]}),t.jsx("div",{className:"flex-1 bg-panel border border-color rounded-lg shadow-lg",children:t.jsx(bu,{currentUser:n,mode:e,onViewUser:o.openViewingUser,onShowTierInfo:()=>b(!0),onShowPastRankings:o.openPastRankings,lobbyType:M?"strategic":"playful"})})]})]})}),y&&t.jsx(V0,{onClose:()=>b(!1)}),v&&t.jsx(q0,{mode:e,onClose:()=>g(!1)})]})},Y0=({animation:e,toSvgCoords:n,cellSize:s})=>{const{text:l,point:r}=e,{cx:a,cy:i}=n(r),o=s*1.5;return t.jsx("g",{style:{pointerEvents:"none"},className:"bonus-text-animation",children:t.jsx("text",{x:a,y:i,textAnchor:"middle",dy:".35em",fontSize:o,fontWeight:"bold",fill:"url(#bonus-gradient)",stroke:"black",strokeWidth:"1.5px",paintOrder:"stroke",children:l})})},X0=({ownershipMap:e,toSvgCoords:n,cellSize:s})=>t.jsx("g",{style:{pointerEvents:"none"},className:"animate-fade-in",children:e.map((l,r)=>l.map((a,i)=>{const{cx:o,cy:c}=n({x:i,y:r}),u=Math.abs(a)/10;if(u<.3)return null;const p=s*u*.9,m=u*.7,h=a>0?`rgba(0, 0, 0, ${m})`:`rgba(255, 255, 255, ${m})`;return t.jsx("rect",{x:o-p/2,y:c-p/2,width:p,height:p,fill:h,rx:p*.3},`${i}-${r}`)}))}),Z0=({animation:e,stone_radius:n,toSvgCoords:s})=>{const{from:l,to:r,player:a}=e,i=s(l),o=s(r),c={"--from-x":`${i.cx}px`,"--from-y":`${i.cy}px`,"--to-x":`${o.cx}px`,"--to-y":`${o.cy}px`},d=Math.atan2(o.cy-i.cy,o.cx-i.cx)*180/Math.PI;return t.jsx("g",{style:c,className:"missile-flight-group",children:t.jsxs("g",{transform:"translate(0, 0)",children:[t.jsx("ellipse",{cx:0,cy:0,rx:n*1.5,ry:n*.7,fill:"url(#missile_fire)",className:"missile-fire-trail",transform:`rotate(${d}) translate(${-n}, 0)`}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===$.Black?"#111827":"#f5f2e8"}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===$.Black?"url(#slate_highlight)":"url(#clamshell_highlight)"})]})})},ey=({animation:e,stone_radius:n,toSvgCoords:s})=>{const{from:l,to:r,player:a,duration:i}=e,o=s(l),c=s(r),d={"--from-x":`${o.cx}px`,"--from-y":`${o.cy}px`,"--to-x":`${c.cx}px`,"--to-y":`${c.cy}px`,animationDuration:`${i}ms`,animationFillMode:"forwards"},u=n*2*.7,p=u/2,m=Math.atan2(c.cy-o.cy,c.cx-o.cx)*180/Math.PI,h=t.jsx("g",{style:d,className:"hidden-missile-flight-group",children:t.jsxs("g",{transform:"translate(0, 0)",children:[t.jsx("ellipse",{cx:0,cy:0,rx:n*1.5,ry:n*.7,fill:"url(#missile_fire)",className:"missile-fire-trail",transform:`rotate(${m}) translate(${-n}, 0)`}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===$.Black?"#111827":"#f5f2e8"}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===$.Black?"url(#slate_highlight)":"url(#clamshell_highlight)"}),t.jsx("image",{href:a===$.Black?Sc:Nc,x:-p,y:-p,width:u,height:u})]})});return t.jsx("g",{style:{pointerEvents:"none"},children:h})},ty=({animation:e,toSvgCoords:n,stone_radius:s})=>{const{point:l,success:r}=e,{cx:a,cy:i}=n(l),o=s*2.5;return t.jsx("g",{style:{pointerEvents:"none"},children:r?t.jsxs(t.Fragment,{children:[t.jsx("circle",{cx:a,cy:i,r:o*.2,fill:"none",stroke:"#34d399",className:"scan-success-circle",style:{animationDelay:"0s"}}),t.jsx("circle",{cx:a,cy:i,r:o*.2,fill:"none",stroke:"#34d399",className:"scan-success-circle",style:{animationDelay:"0.2s"}}),t.jsx("circle",{cx:a,cy:i,r:o*.2,fill:"none",stroke:"#34d399",className:"scan-success-circle",style:{animationDelay:"0.4s"}})]}):t.jsxs(t.Fragment,{children:[t.jsx("line",{x1:a-o/2,y1:i-o/2,x2:a+o/2,y2:i+o/2,stroke:"#f87171",strokeWidth:"4",strokeLinecap:"round",className:"scan-fail-line"}),t.jsx("line",{x1:a+o/2,y1:i-o/2,x2:a-o/2,y2:i+o/2,stroke:"#f87171",strokeWidth:"4",strokeLinecap:"round",className:"scan-fail-line",style:{animationDelay:"0.2s"}})]})})},ny=({move:e,toSvgCoords:n,cellSize:s,onClick:l})=>{const{cx:r,cy:a}=n({x:e.x,y:e.y}),i=s*.45,c=["#3b82f6","#16a34a","#f59e0b"][e.order-1]||"#6b7280";return t.jsxs("g",{onClick:d=>{d.stopPropagation(),l(e.x,e.y)},className:"cursor-pointer recommended-move-marker",children:[t.jsx("circle",{cx:r,cy:a,r:i,fill:c,fillOpacity:"0.7",stroke:"white",strokeWidth:"2"}),t.jsx("text",{x:r,y:a,textAnchor:"middle",dy:".35em",fontSize:i*1.2,fontWeight:"bold",fill:"white",style:{pointerEvents:"none",textShadow:"0 0 3px black"},children:e.order})]})},kr=({player:e,cx:n,cy:s,isLastMove:l,isSelectedMissile:r,isHoverSelectableMissile:a,isKnownHidden:i,isNewlyRevealed:o,animationClass:c,isPending:d,isBaseStone:u,isPatternStone:p,radius:m,isFaint:h})=>{const y=m*2*.7,b=y/2,v=d?"rgb(34, 197, 94)":r?"rgb(239, 68, 68)":"none",g=r||d?3.5:0;return t.jsxs("g",{className:`${c||""} ${a?"missile-selectable-stone":""}`,opacity:d?.6:h?.4:1,children:[t.jsx("circle",{cx:n,cy:s,r:m,fill:e===$.Black?"#111827":"#f5f2e8",stroke:v,strokeWidth:g}),e===$.White&&t.jsx("circle",{cx:n,cy:s,r:m,fill:"url(#clam_grain)"}),t.jsx("circle",{cx:n,cy:s,r:m,fill:e===$.Black?"url(#slate_highlight)":"url(#clamshell_highlight)"}),u&&t.jsx("image",{href:e===$.Black?Da:Oa,x:n-b,y:s-b,width:y,height:y}),i&&t.jsx("image",{href:e===$.Black?Sc:Nc,x:n-b,y:s-b,width:y,height:y}),p&&t.jsx("image",{href:e===$.Black?"/images/single/BlackDouble.png":"/images/single/WhiteDouble.png",x:n-b,y:s-b,width:y,height:y}),o&&t.jsx("circle",{cx:n,cy:s,r:m,fill:"none",stroke:"rgba(0, 255, 255, 0.8)",strokeWidth:"4",className:"sparkle-animation",style:{pointerEvents:"none",transformOrigin:"center"}}),l&&t.jsx("circle",{cx:n,cy:s,r:m*.25,fill:"rgba(239, 68, 68, 0.9)",className:"animate-pulse",style:{pointerEvents:"none"}})]})},qa=e=>{var jt;const{boardState:n,boardSize:s,onBoardClick:l,onMissileLaunch:r,lastMove:a,lastTurnStones:i,isBoardDisabled:o,stoneColor:c,winningLine:d,hiddenMoves:u,moveHistory:p,baseStones:m,baseStones_p1:h,baseStones_p2:y,myPlayerEnum:b,gameStatus:v,highlightedPoints:g,highlightStyle:x="circle",myRevealedStones:j,allRevealedStones:w,newlyRevealed:S,isSpectator:C,analysisResult:k,showTerritoryOverlay:M=!1,showHintOverlay:_=!1,currentUser:E,blackPlayerNickname:I,whitePlayerNickname:R,currentPlayer:A,isItemModeActive:O,animation:B,mode:V,mixedModes:D,justCaptured:L,permanentlyRevealedStones:q,onAction:U,gameId:W,showLastMoveMarker:H,blackPatternStones:te,whitePatternStones:le}=e,[ce,ve]=f.useState(null),[F,X]=f.useState(null),[ee,xe]=f.useState(!1),[Q,G]=f.useState(null),[K,Z]=f.useState(null),[fe,we]=f.useState(window.innerWidth<1024),P=f.useRef(null),Y=f.useRef(null),ae=840,oe=s>0?s:19,ue=ae/oe,se=ue/2,ge=ue*.47;f.useEffect(()=>{const pe=()=>we(window.innerWidth<1024);return window.addEventListener("resize",pe),()=>window.removeEventListener("resize",pe)},[]);const je=f.useMemo(()=>{const pe=Ye.map(Ae=>Ae.mode),de=[T.Omok,T.Ttamok,T.Dice,T.Thief];return pe.includes(V)||de.includes(V)||v.startsWith("single_player")},[V,v]);f.useEffect(()=>{v!=="missile_selecting"&&X(null)},[v]);const me=f.useMemo(()=>oe===19?[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}]:oe===15?[{x:3,y:3},{x:11,y:3},{x:7,y:7},{x:3,y:11},{x:11,y:11}]:oe===13?[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9},{x:6,y:6}]:oe===11?[{x:2,y:2},{x:8,y:2},{x:5,y:5},{x:2,y:8},{x:8,y:8}]:oe===9?[{x:2,y:2},{x:6,y:2},{x:4,y:4},{x:2,y:6},{x:6,y:6}]:oe===7?[{x:3,y:3}]:[],[oe]),Se=pe=>({cx:se+pe.x*ue,cy:se+pe.y*ue}),ze=pe=>{const de=Y.current;if(!de)return null;const Ae=de.createSVGPoint();Ae.x=pe.clientX,Ae.y=pe.clientY;const Ne=de.getScreenCTM();if(Ne){const Ie=Ae.matrixTransform(Ne.inverse()),ft=Math.round((Ie.x-se)/ue),ct=Math.round((Ie.y-se)/ue);if(ft>=0&&ft<oe&&ct>=0&&ct<oe)return{x:ft,y:ct}}return null},Be=f.useCallback(pe=>{const de=[];return pe.x>0&&de.push({x:pe.x-1,y:pe.y}),pe.x<oe-1&&de.push({x:pe.x+1,y:pe.y}),pe.y>0&&de.push({x:pe.x,y:pe.y-1}),pe.y<oe-1&&de.push({x:pe.x,y:pe.y+1}),de},[oe]),He=pe=>{const de=ze(pe);de&&(ve(de),v==="missile_selecting"&&!o&&n[de.y][de.x]===b&&Be(de).some(Ie=>n[Ie.y][Ie.x]===$.None)&&(X(de),xe(!0),G({x:pe.clientX,y:pe.clientY}),P.current=de,pe.target.setPointerCapture(pe.pointerId)))},re=pe=>{const de=ze(pe);ve(de),ee&&Z({x:pe.clientX,y:pe.clientY})},Te=pe=>{pe.target.releasePointerCapture(pe.pointerId);const de=ze(pe);if(ee){const Ae=Q&&K?Math.hypot(K.x-Q.x,K.y-Q.y):0,Ne=P.current;if(xe(!1),G(null),Z(null),!fe&&Ae<10)return;if(Ne&&de&&r){const Ie=de.x-Ne.x,ft=de.y-Ne.y;if(Ie!==0||ft!==0){let ct;Math.abs(Ie)>Math.abs(ft)?ct=Ie>0?"right":"left":ct=ft>0?"down":"up",r(Ne,ct),X(null)}}}else!o&&de&&l(de.x,de.y)},_e=f.useMemo(()=>v!=="base_placement"?null:b===$.Black?h:y,[v,b,h,y]),We=pe=>{if(!u||!p||v!=="playing"&&v!=="hidden_placing")return!1;const de=b===$.Black?$.White:$.Black;for(let Ae=p.length-1;Ae>=0;Ae--){const Ne=p[Ae];if(Ne.x===pe.x&&Ne.y===pe.y)return!!u[Ae]&&Ne.player===de}return!1},ot=v==="ended"||v==="no_contest",Gt=ce&&!o&&v!=="scanning"&&v!=="missile_selecting"&&(n[ce.y][ce.x]===$.None||We(ce)),vt=()=>!M||!k||!k.deadStones?null:t.jsx("g",{style:{pointerEvents:"none"},className:"animate-fade-in",children:k.deadStones.map((pe,de)=>{const{cx:Ae,cy:Ne}=Se(pe),Ie=ge*.7;return t.jsxs("g",{children:[t.jsx("line",{x1:Ae-Ie,y1:Ne-Ie,x2:Ae+Ie,y2:Ne+Ie,stroke:"red",strokeWidth:"3",strokeLinecap:"round"}),t.jsx("line",{x1:Ae-Ie,y1:Ne+Ie,x2:Ae+Ie,y2:Ne-Ie,stroke:"red",strokeWidth:"3",strokeLinecap:"round"})]},`ds-${de}`)})}),tn=(pe,de,Ae)=>{const Ne=pe.moveHistory||[];if(!Array.isArray(Ne))return-1;for(let Ie=Ne.length-1;Ie>=0;Ie--)if(Ne[Ie].x===de&&Ne[Ie].y===Ae)return Ie;return-1},Ct=()=>{var Ne;if(v!=="missile_selecting"||!F||!r)return null;if(ee&&Q&&K){const Ie=Y.current;if(!Ie)return null;const ft=(Ne=Ie.getScreenCTM())==null?void 0:Ne.inverse();if(!ft)return null;const ct=Se(F),Wt=Ie.createSVGPoint();Wt.x=K.x,Wt.y=K.y;const Ht=Wt.matrixTransform(ft),dn=Ht.x-ct.cx,un=Ht.y-ct.cy;let mn={cx:ct.cx,cy:ct.cy};return Math.abs(dn)>Math.abs(un)?mn.cx+=Math.sign(dn)*ue*2:mn.cy+=Math.sign(un)*ue*2,t.jsx("g",{style:{pointerEvents:"none"},children:t.jsx("line",{x1:ct.cx,y1:ct.cy,x2:mn.cx,y2:mn.cy,stroke:"rgba(239, 68, 68, 0.7)",strokeWidth:"4",strokeDasharray:"8 4",markerEnd:"url(#arrowhead-missile)"})})}const pe=Be(F).filter(Ie=>n[Ie.y][Ie.x]===$.None);if(pe.length===0)return null;const de=ue*.4,Ae=[{dir:"up",point:{x:F.x,y:F.y-1}},{dir:"down",point:{x:F.x,y:F.y+1}},{dir:"left",point:{x:F.x-1,y:F.y}},{dir:"right",point:{x:F.x+1,y:F.y}}];return t.jsx("g",{children:Ae.map(({dir:Ie,point:ft})=>{if(!pe.some(dn=>dn.x===ft.x&&dn.y===ft.y))return null;const{cx:Wt,cy:Ht}=Se(ft);return t.jsx("polygon",{points:`${Wt},${Ht-de} ${Wt+de},${Ht} ${Wt},${Ht+de} ${Wt-de},${Ht}`,fill:"rgba(239, 68, 68, 0.8)",stroke:"white",strokeWidth:"1",className:"cursor-pointer hover:opacity-100 opacity-80",onClick:()=>r(F,Ie)},Ie)})})};return t.jsx("div",{className:`relative w-full h-full shadow-2xl rounded-lg overflow-hidden p-0 border-4 ${O?"prism-border":"border-gray-800"}`,children:t.jsxs("svg",{ref:Y,viewBox:`0 0 ${ae} ${ae}`,className:"w-full h-full touch-none",onPointerDown:He,onPointerMove:re,onPointerUp:Te,onPointerLeave:()=>{ve(null)},children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"slate_highlight",cx:"35%",cy:"35%",r:"60%",fx:"30%",fy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#6b7280",stopOpacity:"0.8"}),t.jsx("stop",{offset:"100%",stopColor:"#111827",stopOpacity:"0.2"})]}),t.jsxs("radialGradient",{id:"clamshell_highlight",cx:"35%",cy:"35%",r:"60%",fx:"30%",fy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"0.9"}),t.jsx("stop",{offset:"100%",stopColor:"#e5e7eb",stopOpacity:"0.1"})]}),t.jsxs("filter",{id:"clam_grain_filter",children:[t.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.8",numOctaves:"4",stitchTiles:"stitch"}),t.jsx("feColorMatrix",{type:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 0.1 0"})]}),t.jsxs("pattern",{id:"clam_grain",patternUnits:"userSpaceOnUse",width:"100",height:"100",children:[t.jsx("rect",{width:"100",height:"100",fill:"#f5f2e8"}),t.jsx("rect",{width:"100",height:"100",filter:"url(#clam_grain_filter)"})]}),t.jsxs("radialGradient",{id:"missile_fire",cx:"50%",cy:"50%",r:"50%",children:[t.jsx("stop",{offset:"0%",stopColor:"#fca5a5"}),t.jsx("stop",{offset:"50%",stopColor:"#f87171"}),t.jsx("stop",{offset:"100%",stopColor:"#ef4444",stopOpacity:"0"})]}),t.jsxs("linearGradient",{id:"bonus-gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#fef08a"}),t.jsx("stop",{offset:"100%",stopColor:"#f59e0b"})]}),t.jsxs("filter",{id:"blue-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"3.5",result:"blur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"blur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsx("marker",{id:"arrowhead-missile",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"rgba(239, 68, 68, 0.9)"})})]}),t.jsx("rect",{width:ae,height:ae,fill:"#e0b484"}),Array.from({length:oe}).map((pe,de)=>t.jsxs("g",{children:[t.jsx("line",{x1:se+de*ue,y1:se,x2:se+de*ue,y2:ae-se,stroke:"#54432a",strokeWidth:"1.5"}),t.jsx("line",{x1:se,y1:se+de*ue,x2:ae-se,y2:se+de*ue,stroke:"#54432a",strokeWidth:"1.5"})]},de)),me.map((pe,de)=>t.jsx("circle",{...Se(pe),r:oe>9?6:4,fill:"#54432a"},de)),M&&(k==null?void 0:k.ownershipMap)&&t.jsx(X0,{ownershipMap:k.ownershipMap,toSvgCoords:Se,cellSize:ue}),n.map((pe,de)=>pe.map((Ae,Ne)=>{if(Ae===$.None)return null;const{cx:Ie,cy:ft}=Se({x:Ne,y:de}),ct=H&&je&&a&&a.x===Ne&&a.y===de,Wt=H&&je&&i&&i.some(Ke=>Ke.x===Ne&&Ke.y===de),Ht=!!(ct||Wt),dn=p?tn({moveHistory:p},Ne,de):-1,un=u&&dn!==-1&&u[dn],mn=q==null?void 0:q.some(Ke=>Ke.x===Ne&&Ke.y===de);let ss=!0;if(un)if(C)ss=ot||!!mn;else{const Ke=!C&&(j==null?void 0:j.some(ls=>ls.x===Ne&&ls.y===de)),Ga=S==null?void 0:S.some(ls=>ls.point.x===Ne&&ls.point.y===de);ss=ot||!!mn||Ae===b||!!Ke||!!Ga}if(!ss||(B==null?void 0:B.type)==="missile"&&B.from.x===Ne&&B.from.y===de||(B==null?void 0:B.type)==="hidden_missile"&&B.from.x===Ne&&B.from.y===de)return null;const lr=S==null?void 0:S.some(Ke=>Ke.point.x===Ne&&Ke.point.y===de),ws=!C&&(j==null?void 0:j.some(Ke=>Ke.x===Ne&&Ke.y===de))&&!mn,Ua=m==null?void 0:m.some(Ke=>Ke.x===Ne&&Ke.y===de&&Ke.player===Ae),rr=un,za=(F==null?void 0:F.x)===Ne&&(F==null?void 0:F.y)===de,ar=v==="missile_selecting"&&!F&&Ae===b,Fa=Ae===$.Black&&(te==null?void 0:te.some(Ke=>Ke.x===Ne&&Ke.y===de))||Ae===$.White&&(le==null?void 0:le.some(Ke=>Ke.x===Ne&&Ke.y===de));return t.jsx(kr,{player:Ae,cx:Ie,cy:ft,isLastMove:Ht,isKnownHidden:rr,isBaseStone:Ua,isPatternStone:Fa,isNewlyRevealed:lr,animationClass:lr?"sparkle-animation":"",isSelectedMissile:za,isHoverSelectableMissile:ar,radius:ge,isFaint:ws},`${Ne}-${de}`)})),_e==null?void 0:_e.map((pe,de)=>{const{cx:Ae,cy:Ne}=Se(pe);return t.jsx("g",{opacity:.7,className:"animate-fade-in",children:t.jsx(kr,{player:b,cx:Ae,cy:Ne,isBaseStone:!0,radius:ge})},`my-base-${de}`)}),d&&d.length>0&&t.jsx("path",{d:`M ${Se(d[0]).cx} ${Se(d[0]).cy} L ${Se(d[d.length-1]).cx} ${Se(d[d.length-1]).cy}`,stroke:"rgba(239, 68, 68, 0.8)",strokeWidth:"10",strokeLinecap:"round",className:"animate-fade-in"}),g&&g.map((pe,de)=>{const{cx:Ae,cy:Ne}=Se(pe);return x==="ring"?t.jsx("circle",{cx:Ae,cy:Ne,r:ge*.9,fill:"none",stroke:"#0ea5e9",strokeWidth:"3",strokeDasharray:"5 3",className:"animate-pulse",style:{pointerEvents:"none"}},`highlight-ring-${de}`):t.jsx("circle",{cx:Ae,cy:Ne,r:ge*.3,fill:A===$.Black?"black":"white",opacity:"0.3"},`highlight-circle-${de}`)}),Gt&&ce&&t.jsxs("g",{opacity:"0.5",children:[" ",t.jsx(kr,{player:c,cx:Se(ce).cx,cy:Se(ce).cy,radius:ge})," "]}),Ct(),B&&t.jsxs(t.Fragment,{children:[B.type==="missile"&&t.jsx(Z0,{animation:B,stone_radius:ge,toSvgCoords:Se}),B.type==="hidden_missile"&&B.player===b&&!C&&t.jsx(ey,{animation:B,stone_radius:ge,toSvgCoords:Se}),B.type==="scan"&&!C&&B.playerId===E.id&&t.jsx(ty,{animation:B,toSvgCoords:Se,stone_radius:ge}),B.type==="hidden_reveal"&&B.stones.map((pe,de)=>t.jsx(kr,{player:pe.player,cx:Se(pe.point).cx,cy:Se(pe.point).cy,isKnownHidden:!0,animationClass:"sparkle-animation",radius:ge},`reveal-${de}`)),B.type==="bonus_text"&&t.jsx(Y0,{animation:B,toSvgCoords:Se,cellSize:ue})]}),vt(),_&&!o&&((jt=k==null?void 0:k.recommendedMoves)==null?void 0:jt.map(pe=>t.jsx(ny,{move:pe,toSvgCoords:Se,cellSize:ue,onClick:l},`rec-${pe.order}`)))]})})},sy=e=>{var _,E;const{session:n,onAction:s,myPlayerEnum:l,handleBoardClick:r,isItemModeActive:a,showTerritoryOverlay:i,isMyTurn:o,isMobile:c,myRevealedMoves:d,showLastMoveMarker:u}=e,{blackPlayerId:p,whitePlayerId:m,player1:h,player2:y,settings:b,lastMove:v,gameStatus:g,mode:x}=n,j=[h,y],w=j.find(I=>I.id===p)||null,S=j.find(I=>I.id===m)||null,C=f.useMemo(()=>(d||[]).map(I=>{var R;return(R=n.moveHistory)==null?void 0:R[I]}).filter(I=>!!I).map(I=>({x:I.x,y:I.y})),[d,n.moveHistory]),k=f.useMemo(()=>{if(!n.moveHistory||!n.revealedHiddenMoves)return{};const I={};for(const R in n.revealedHiddenMoves)I[R]=n.revealedHiddenMoves[R].map(A=>{var O;return(O=n.moveHistory)==null?void 0:O[A]}).filter(A=>!!A).map(A=>({x:A.x,y:A.y}));return I},[n.revealedHiddenMoves,n.moveHistory]),M=f.useMemo(()=>Ye.some(I=>I.mode===x)?"bg-strategic-background":rt.some(I=>I.mode===x)?"bg-playful-background":"bg-primary",[x]);return t.jsx("div",{className:`w-full h-full flex items-center justify-center ${M}`,children:t.jsx(qa,{boardState:n.boardState,boardSize:b.boardSize,onBoardClick:r,onMissileLaunch:(I,R)=>{s({type:"LAUNCH_MISSILE",payload:{gameId:n.id,from:I,direction:R}})},onAction:s,gameId:n.id,lastMove:v,lastTurnStones:n.lastTurnStones,isBoardDisabled:e.isSpectator||!o&&g!=="base_placement",stoneColor:l,winningLine:n.winningLine,mode:n.mode,mixedModes:n.settings.mixedModes,hiddenMoves:n.hiddenMoves,moveHistory:n.moveHistory,baseStones:n.baseStones,myPlayerEnum:l,gameStatus:g,currentPlayer:n.currentPlayer,highlightedPoints:[],myRevealedStones:C,allRevealedStones:k,newlyRevealed:n.newlyRevealed,justCaptured:n.justCaptured,permanentlyRevealedStones:n.permanentlyRevealedStones,isSpectator:e.isSpectator,analysisResult:((_=n.analysisResult)==null?void 0:_[e.currentUser.id])??(g==="ended"?(E=n.analysisResult)==null?void 0:E.system:null),showTerritoryOverlay:i,showHintOverlay:!1,showLastMoveMarker:u,baseStones_p1:g==="base_placement"?n.baseStones_p1:void 0,baseStones_p2:g==="base_placement"?n.baseStones_p2:void 0,currentUser:e.currentUser,blackPlayerNickname:(w==null?void 0:w.nickname)||"",whitePlayerNickname:(S==null?void 0:S.nickname)||"",isItemModeActive:a,animation:n.animation,isMobile:c})})},ly=f.forwardRef((e,n)=>{const{stones:s,gameStatus:l,myPlayer:r,isMyTurn:a,settings:i,onPlacementClick:o,onStoneInteractionStart:c,isSpectator:d,dragStartPoint:u,dragEndPoint:p,selectedStone:m,myStonesCount:h,maxStones:y,session:b,currentUser:v}=e,[g,x]=f.useState(s),[j,w]=f.useState(null),S=f.useRef(null),C=840,k=i.boardSize>0?i.boardSize:19,M=C/k,_=M/2,E=f.useMemo(()=>k===19?[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}]:k===13?[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9},{x:6,y:6}]:k===11?[{x:2,y:2},{x:8,y:2},{x:2,y:8},{x:8,y:8},{x:5,y:5}]:k===9?[{x:2,y:2},{x:6,y:2},{x:2,y:6},{x:6,y:6},{x:4,y:4}]:[],[k]),I=q=>({cx:_+q.x*M,cy:_+q.y*M});f.useEffect(()=>{l!=="alkkagi_animating"&&x(s)},[s,l]),f.useImperativeHandle(n,()=>({updateLocalStones:q=>{x([...q])},getSvg:()=>S.current}));const R=q=>{const U=S.current;if(!U)return null;const W=U.createSVGPoint();W.x=q.clientX,W.y=q.clientY;const H=U.getScreenCTM();if(H){const te=W.matrixTransform(H.inverse());return{x:te.x,y:te.y}}return null},A=f.useCallback(q=>{if(!q||l!=="alkkagi_placement"&&l!=="alkkagi_simultaneous_placement"||r===$.None)return!1;const U=g&&g.length>0&&g[0].radius?g[0].radius:840/19*.47,{x:W,y:H}=q;if(W<U||W>C-U||H<U||H>C-U)return!1;let te=!1;if(i.alkkagiLayout===Zs.Battle)te=eu[r].some(ce=>{const ve=_+(ce.x-.5)*M,F=_+(ce.y-.5)*M,X=ve+ce.width*M,ee=F+ce.height*M;return W>=ve&&W<=X&&H>=F&&H<=ee});else{const le=C*.15,ce=C*.35,ve=C*.65,F=C*.85;r===$.White?H>=le&&H<=ce&&(te=!0):H>=ve&&H<=F&&(te=!0)}if(!te)return!1;for(const le of g)if(le.player===r&&Math.hypot(W-le.x,H-le.y)<le.radius*2)return!1;return!0},[l,r,g,i.alkkagiLayout,M,_]),O=f.useMemo(()=>A(j),[j,A]),B=q=>{if(l!=="alkkagi_placement"&&l!=="alkkagi_simultaneous_placement"||!a)return;const U=R(q);U&&A(U)&&o({x:U.x,y:U.y})},V=a&&(l==="alkkagi_placement"||l==="alkkagi_simultaneous_placement")&&h<y,D=()=>{if(l!=="alkkagi_placement"&&l!=="alkkagi_simultaneous_placement"||d||r===$.None)return null;const q={strokeWidth:"3",rx:"5",className:V?"animate-pulse-blue":"",style:{pointerEvents:"none"}};if(i.alkkagiLayout===Zs.Battle){const U=eu[r],W=r===$.Black?"rgba(0, 0, 0, 0.25)":"rgba(255, 255, 255, 0.35)",H=r===$.Black?"rgba(50, 50, 50, 0.8)":"rgba(220, 220, 220, 0.8)";return t.jsx("g",{children:U.map((te,le)=>t.jsx("rect",{x:_+(te.x-.5)*M,y:_+(te.y-.5)*M,width:te.width*M,height:te.height*M,fill:W,stroke:H,...q},`zone-${le}`))})}else{const U=C*.15,W=C*.35,H=C*.65,te=r===$.White?U:H,le=W-U,ce=r===$.Black?"rgba(0, 0, 0, 0.25)":"rgba(255, 255, 255, 0.35)",ve=r===$.Black?"rgba(50, 50, 50, 0.8)":"rgba(220, 220, 220, 0.8)";return t.jsx("rect",{x:0,y:te,width:C,height:le,fill:ce,stroke:ve,...q})}},L=f.useMemo(()=>{var we,P;if(!u||!p||!m||!S.current)return null;const q=S.current,U=(we=q.getScreenCTM())==null?void 0:we.inverse();if(!U)return null;const W=q.createSVGPoint();W.x=u.x,W.y=u.y;const H=W.matrixTransform(U);W.x=p.x,W.y=p.y;const te=W.matrixTransform(U),le=te.x-H.x,ce=te.y-H.y,ve=m,F={x:ve.x,y:ve.y};let X={x:F.x-le,y:F.y-ce};const xe=(((P=b.activeAlkkagiItems)==null?void 0:P[v.id])||[]).includes("aimingLine"),Q=80*.2,G=xe?Q*11:Q,K=X.x-F.x,Z=X.y-F.y,fe=Math.hypot(K,Z);return fe>G&&(X.x=F.x+K/fe*G,X.y=F.y+Z/fe*G),{start:F,end:X}},[u,p,m,b.activeAlkkagiItems,v.id]);return t.jsx("div",{className:"relative w-full h-full shadow-2xl rounded-lg overflow-hidden border-4 border-gray-800",children:t.jsxs("svg",{ref:S,viewBox:`0 0 ${C} ${C}`,className:"w-full h-full touch-none",onClick:B,onMouseMove:q=>{const U=R(q);w(U)},onMouseLeave:()=>w(null),children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"gloss-alkkagi-1",children:[t.jsx("stop",{offset:"10%",stopColor:"#333"}),t.jsx("stop",{offset:"95%",stopColor:"#000"})]}),t.jsxs("radialGradient",{id:"gloss-alkkagi-2",children:[t.jsx("stop",{offset:"10%",stopColor:"#fff"}),t.jsx("stop",{offset:"95%",stopColor:"#ccc"})]}),t.jsx("marker",{id:"arrowhead-alkkagi",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"rgba(239, 68, 68, 0.9)"})})]}),t.jsx("rect",{width:C,height:C,fill:"#DDAA77"}),Array.from({length:k}).map((q,U)=>t.jsxs("g",{children:[t.jsx("line",{x1:_+U*M,y1:_,x2:_+U*M,y2:C-_,stroke:"#54432a",strokeWidth:"1.5"}),t.jsx("line",{x1:_,y1:_+U*M,x2:C-_,y2:_+U*M,stroke:"#54432a",strokeWidth:"1.5"})]},U)),E.map((q,U)=>t.jsx("circle",{...I(q),r:k>9?5:4,fill:"#54432a"},U)),D(),g.map(q=>{if(!q.onBoard)return null;const U=q.player===r,W=!d&&a&&l==="alkkagi_playing",H=W&&U?"cursor-pointer":"";return t.jsxs("g",{className:H,onMouseDown:W&&U?te=>c(q,te):void 0,onTouchStart:W&&U?te=>{te.preventDefault(),c(q,te)}:void 0,children:[t.jsx("circle",{cx:q.x,cy:q.y,r:q.radius,fill:q.player===$.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:q.x,cy:q.y,r:q.radius,fill:`url(#gloss-alkkagi-${q.player})`})]},q.id)}),V&&j&&O&&t.jsx("g",{opacity:"0.5",style:{pointerEvents:"none"},children:t.jsx("circle",{cx:j.x,cy:j.y,r:g&&g[0]?g[0].radius:840/19*.47,fill:r===$.Black?"#111827":"#f9fafb"})}),L&&t.jsx("g",{style:{pointerEvents:"none"},children:t.jsx("line",{x1:L.start.x,y1:L.start.y,x2:L.end.x,y2:L.end.y,stroke:"rgba(239, 68, 68, 0.7)",strokeWidth:"4",strokeDasharray:"8 4",markerEnd:"url(#arrowhead-alkkagi)"})})]})})});function Nu(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const ry=e=>{const{session:n,onAction:s,currentUser:l,isSpectator:r}=e,{id:a,settings:i,gameStatus:o,alkkagiStones:c,currentPlayer:d,player1:u,alkkagiStones_p1:p,alkkagiStones_p2:m,activeAlkkagiItems:h}=n,y=f.useRef(null),b=f.useRef(null),v=f.useRef(null),g=f.useRef(null),x=f.useRef(null),j=f.useRef(0),w=f.useRef(!1),S=f.useRef(null),C=f.useRef(null),k=f.useRef(0),[M,_]=f.useState(null),[E,I]=f.useState(null),[R,A]=f.useState(null),[O,B]=f.useState(0),[V,D]=f.useState(null),[L,q]=f.useState(window.innerWidth<1024),U=f.useRef(e);f.useEffect(()=>{U.current=e});const W=Nu(n.turnStartTime),H=Nu(n.gameStatus),te=f.useCallback(()=>{v.current&&(cancelAnimationFrame(v.current),v.current=null),g.current=null},[]),le=f.useCallback(()=>{w.current=!1,S.current=null,C.current=null,te(),_(null),I(null),A(null),B(0),k.current=0},[te]);f.useEffect(()=>{n.turnStartTime!==W&&le()},[n.turnStartTime,W,le]),f.useEffect(()=>{H==="alkkagi_animating"&&n.gameStatus!=="alkkagi_animating"&&D(null)},[n.gameStatus,H]),f.useEffect(()=>{const P=()=>q(window.innerWidth<1024);return window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[]);const ce=f.useMemo(()=>n.blackPlayerId===l.id?$.Black:n.whitePlayerId===l.id?$.White:$.None,[n.blackPlayerId,n.whitePlayerId,l.id]),ve=f.useMemo(()=>r?!1:o==="alkkagi_simultaneous_placement"?!0:d===ce,[o,d,ce,r]),F=ce===$.White,X=f.useMemo(()=>{if(o==="alkkagi_simultaneous_placement"||o==="alkkagi_placement"){const P=l.id===u.id?p:m;return[...c||[],...P||[]]}return c||[]},[o,c,p,m,l.id,u.id]),ee=f.useMemo(()=>{var Y;const P=(n.alkkagiStones||[]).filter(ae=>ae.player===ce).length;if(n.gameStatus==="alkkagi_simultaneous_placement"||n.gameStatus==="alkkagi_placement"){const ae=((Y=l.id===n.player1.id?n.alkkagiStones_p1:n.alkkagiStones_p2)==null?void 0:Y.length)||0;return P+ae}return P},[n,l.id,ce]),xe=f.useCallback(P=>{const{session:Y,onAction:ae}=U.current;ae({type:"ALKKAGI_PLACE_STONE",payload:{gameId:Y.id,point:P}})},[]),Q=f.useCallback(()=>{te(),D(null),g.current=performance.now();const P=Y=>{var He;g.current||(g.current=Y);const{session:ae,currentUser:oe}=U.current,se=(((He=ae.activeAlkkagiItems)==null?void 0:He[oe.id])||[]).includes("slow"),ge=ae.settings.alkkagiGaugeSpeed||900,je=se?ge*2:ge,me=je/2,ze=(Y-g.current)%je/me;let Be;ze<=1?Be=ze*100:Be=(2-ze)*100,x.current&&(x.current.style.width=`${Be}%`),k.current=Be,v.current=requestAnimationFrame(P)};v.current=requestAnimationFrame(P)},[te]),G=f.useCallback((P,Y,ae,oe)=>{b.current&&cancelAnimationFrame(b.current);let ue=JSON.parse(JSON.stringify(P||[])),se=ue.find(Be=>Be.id===Y);if(se)se.vx=ae,se.vy=oe;else return;const ge=840,je=.98;let me=0;const Se=1e3,ze=()=>{var He;let Be=!1;for(const re of ue)re.onBoard&&(re.x+=re.vx,re.y+=re.vy,re.vx*=je,re.vy*=je,Math.abs(re.vx)<.01&&(re.vx=0),Math.abs(re.vy)<.01&&(re.vy=0),(Math.abs(re.vx)>0||Math.abs(re.vy)>0)&&(Be=!0),(re.x<0||re.x>ge||re.y<0||re.y>ge)&&re.onBoard&&(re.onBoard=!1,re.timeOffBoard=Date.now(),Ee.stoneFallOff()));for(let re=0;re<ue.length;re++)for(let Te=re+1;Te<ue.length;Te++){const _e=ue[re],We=ue[Te];if(!_e.onBoard||!We.onBoard)continue;const ot=We.x-_e.x,Gt=We.y-_e.y,vt=Math.hypot(ot,Gt),tn=_e.radius+We.radius;if(vt<tn){Ee.stoneCollision();const Ct=ot/vt,jt=Gt/vt,pe=We.vx-_e.vx,de=We.vy-_e.vy,Ae=pe*Ct+de*jt;if(Ae<0){const Ie=Ae;_e.vx+=Ie*Ct,_e.vy+=Ie*jt,We.vx-=Ie*Ct,We.vy-=Ie*jt}const Ne=(tn-vt)/2;_e.x-=Ne*Ct,_e.y-=Ne*jt,We.x+=Ne*Ct,We.y+=Ne*jt}}(He=y.current)==null||He.updateLocalStones(ue),me++,Be&&me<Se?b.current=requestAnimationFrame(ze):b.current=null};b.current=requestAnimationFrame(ze)},[]),K=f.useCallback((P,Y)=>{Y.preventDefault();const{session:ae,currentUser:oe}=U.current,ue=ae.blackPlayerId===oe.id?$.Black:ae.whitePlayerId===oe.id?$.White:$.None;if(!(ae.currentPlayer===ue)||ae.gameStatus!=="alkkagi_playing")return;const ge="touches"in Y?{x:Y.touches[0].clientX,y:Y.touches[0].clientY}:{x:Y.clientX,y:Y.clientY};w.current=!0,S.current=P,C.current=ge,_(P.id),I(ge),A(ge),Q()},[Q]);f.useEffect(()=>{const P=oe=>{if(!w.current)return;"preventDefault"in oe&&oe.preventDefault();const ue="touches"in oe?{x:oe.touches[0].clientX,y:oe.touches[0].clientY}:{x:oe.clientX,y:oe.clientY};A(ue)},Y=oe=>{var ze,Be;if(!w.current)return;const{session:ue,onAction:se}=U.current,ge=S.current,je=C.current,me="touches"in oe?{x:oe.changedTouches[0].clientX,y:oe.changedTouches[0].clientY}:{x:oe.clientX,y:oe.clientY};te();const Se=k.current;if(D(Se),ge&&je&&me){const He=(ze=y.current)==null?void 0:ze.getSvg();if(!He){le();return}const re=(Be=He.getScreenCTM())==null?void 0:Be.inverse();if(!re){le();return}const Te=He.createSVGPoint();Te.x=je.x,Te.y=je.y;const _e=Te.matrixTransform(re);Te.x=me.x,Te.y=me.y;const We=Te.matrixTransform(re),ot=We.x-_e.x,Gt=We.y-_e.y,vt=-ot,tn=-Gt,Ct=Se/100*25,jt=Math.hypot(vt,tn);if(jt>0){const pe=vt/jt*Ct,de=tn/jt*Ct;se({type:"ALKKAGI_FLICK_STONE",payload:{gameId:ue.id,stoneId:ge.id,vx:pe,vy:de}})}}w.current=!1,S.current=null,C.current=null,_(null),I(null),A(null),B(0),k.current=0,setTimeout(()=>D(null),1500)},ae=oe=>{w.current&&(oe.preventDefault(),le())};return window.addEventListener("mousemove",P,{passive:!1}),window.addEventListener("touchmove",P,{passive:!1}),window.addEventListener("mouseup",Y),window.addEventListener("touchend",Y),window.addEventListener("contextmenu",ae),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("touchmove",P),window.removeEventListener("mouseup",Y),window.removeEventListener("touchend",Y),window.removeEventListener("contextmenu",ae),te(),b.current&&cancelAnimationFrame(b.current)}},[te,le]),f.useEffect(()=>{const{session:P}=U.current,Y=P.animation;if((Y==null?void 0:Y.type)==="alkkagi_flick"&&Y.startTime>j.current){j.current=Y.startTime;const{stoneId:ae,vx:oe,vy:ue}=Y;G(P.alkkagiStones||[],ae,oe,ue)}},[n.animation,G]);const Z=V!==null?V:O,fe=n.settings.alkkagiStoneCount||5,we=f.useMemo(()=>M&&(c==null?void 0:c.find(P=>P.id===M))||null,[M,c]);return t.jsxs("div",{className:"relative w-full h-full flex items-center justify-center px-4 sm:px-6 lg:px-0",children:[t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 w-3/4 max-w-md z-10 pointer-events-none",children:(E||V!==null)&&t.jsxs("div",{className:`bg-gray-900/50 rounded-full h-6 border-2 border-gray-500 ${V!==null?"animate-flick-power-pulse":""}`,children:[t.jsx("div",{ref:x,className:"bg-gradient-to-r from-yellow-400 to-red-500 h-full rounded-full",style:{width:`${Z}%`}}),t.jsx("span",{className:"absolute inset-0 w-full h-full flex items-center justify-center text-white font-bold text-sm drop-shadow-md",children:"POWER"})]})}),t.jsx("div",{className:`w-full h-full transition-transform duration-500 ${F?"rotate-180":""}`,children:t.jsx(ly,{ref:y,stones:X,gameStatus:o,myPlayer:ce,isMyTurn:ve,settings:i,onPlacementClick:xe,onStoneInteractionStart:K,isSpectator:r,dragStartPoint:E,dragEndPoint:R,selectedStone:we,myStonesCount:ee,maxStones:fe,session:n,currentUser:l})})]})},ay=f.forwardRef((e,n)=>{const{stones:s,gameStatus:l,myPlayer:r,currentPlayer:a,onLaunchAreaInteractionStart:i,isSpectator:o,dragStartPoint:c,dragEndPoint:d,selectedStone:u,currentUser:p,session:m}=e,[h,y]=f.useState(s),b=f.useRef(null),v=840,g=19,x=v/g,j=x/2,w={x:v/2,y:v/2};f.useEffect(()=>{y(s)},[s]),f.useImperativeHandle(n,()=>({updateLocalStones:A=>{y([...A])},getSvg:()=>b.current}));const S=f.useMemo(()=>[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}],[g]),C=A=>({cx:j+A.x*x,cy:j+A.y*x}),k=f.useMemo(()=>{var xe,Q;if(!c||!d||!u||!b.current)return null;const A=b.current,O=(xe=A.getScreenCTM())==null?void 0:xe.inverse();if(!O)return null;const B=A.createSVGPoint();B.x=c.x,B.y=c.y;const V=B.matrixTransform(O);B.x=d.x,B.y=d.y;const D=B.matrixTransform(O),L=D.x-V.x,q=D.y-V.y,U=u,W={x:U.x,y:U.y};let H={x:W.x-L,y:W.y-q};const le=(((Q=m.activeCurlingItems)==null?void 0:Q[p.id])||[]).includes("aimingLine"),ce=80*.2,ve=le?ce*11:ce,F=H.x-W.x,X=H.y-W.y,ee=Math.hypot(F,X);return ee>ve&&(H.x=W.x+F/ee*ve,H.y=W.y+X/ee*ve),{start:W,end:H}},[c,d,u,m.activeCurlingItems,p.id]),M=()=>{const A=[x*6,x*4,x*2,x*.5],O=["rgba(0, 100, 255, 0.2)","rgba(255, 255, 255, 0.2)","rgba(255, 0, 0, 0.2)","white"];return t.jsxs("g",{children:[A.map((B,V)=>t.jsx("circle",{cx:w.x,cy:w.y,r:B,fill:O[V]},V)),t.jsx("line",{x1:0,y1:w.y,x2:v,y2:w.y,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1"}),t.jsx("line",{x1:w.x,y1:0,x2:w.x,y2:v,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1"})]})},_=!o&&l==="curling_playing"&&r===a,I=1*x,R=[{x:j,y:j,player:$.White},{x:v-j-I,y:j,player:$.White},{x:j,y:v-j-I,player:$.Black},{x:v-j-I,y:v-j-I,player:$.Black}];return t.jsx("div",{className:"relative w-full h-full shadow-2xl rounded-lg overflow-hidden border-4 border-gray-800",children:t.jsxs("svg",{ref:b,viewBox:`0 0 ${v} ${v}`,className:"w-full h-full",children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"gloss-curling-1",children:[t.jsx("stop",{offset:"10%",stopColor:"#333"}),t.jsx("stop",{offset:"95%",stopColor:"#000"})]}),t.jsxs("radialGradient",{id:"gloss-curling-2",children:[t.jsx("stop",{offset:"10%",stopColor:"#fff"}),t.jsx("stop",{offset:"95%",stopColor:"#ccc"})]}),t.jsx("marker",{id:"arrowhead-curling",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"rgba(239, 68, 68, 0.9)"})})]}),t.jsx("rect",{width:v,height:v,fill:"#DDAA77"}),Array.from({length:g}).map((A,O)=>t.jsxs("g",{children:[t.jsx("line",{x1:j+O*x,y1:j,x2:j+O*x,y2:v-j,stroke:"#54432a",strokeWidth:"1.5"}),t.jsx("line",{x1:j,y1:j+O*x,x2:v-j,y2:j+O*x,stroke:"#54432a",strokeWidth:"1.5"})]},O)),S.map((A,O)=>t.jsx("circle",{...C(A),r:5,fill:"#54432a"},O)),M(),R.map((A,O)=>{const B=_&&A.player===r,V=[B?"cursor-pointer":"cursor-default",B?"animate-pulse-white":""].filter(Boolean).join(" ");return t.jsx("rect",{x:A.x,y:A.y,width:I,height:I,fill:B?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.03)",stroke:B?"rgba(255, 255, 255, 0.8)":"rgba(255, 255, 255, 0.1)",strokeWidth:B?3:2,rx:"5",className:V,onMouseDown:B?D=>i(D,A):void 0,onTouchStart:B?D=>{D.preventDefault(),i(D,A)}:void 0},`launch-area-${O}`)}),h.map(A=>A.onBoard?t.jsxs("g",{children:[t.jsx("circle",{cx:A.x,cy:A.y,r:A.radius,fill:A.player===$.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:A.x,cy:A.y,r:A.radius,fill:`url(#gloss-curling-${A.player})`})]},A.id):null),u&&k&&t.jsxs("g",{opacity:"0.7",children:[t.jsx("circle",{cx:u.x,cy:u.y,r:u.radius,fill:u.player===$.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:u.x,cy:u.y,r:u.radius,fill:`url(#gloss-curling-${u.player})`})]}),k&&t.jsx("g",{style:{pointerEvents:"none"},children:t.jsx("line",{x1:k.start.x,y1:k.start.y,x2:k.end.x,y2:k.end.y,stroke:"rgba(239, 68, 68, 0.7)",strokeWidth:"4",strokeDasharray:"8 4",markerEnd:"url(#arrowhead-curling)"})})]})})});function Su(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const iy=f.forwardRef((e,n)=>{const{session:s,onAction:l,currentUser:r,isSpectator:a}=e,{id:i,settings:o,gameStatus:c,curlingStones:d,currentPlayer:u,activeCurlingItems:p}=s,m=f.useRef(null),h=f.useRef(null),y=f.useRef(null),b=f.useRef(null),v=f.useRef(null),g=f.useRef(0),x=f.useRef(0),j=f.useRef(!1),w=f.useRef(null),S=f.useRef(null),[C,k]=f.useState(null),[M,_]=f.useState(null),[E,I]=f.useState(null),[R,A]=f.useState(0),[O,B]=f.useState(null),[V,D]=f.useState(!1),[L,q]=f.useState(window.innerWidth<1024),U=f.useRef(e);f.useEffect(()=>{U.current=e});const W=f.useMemo(()=>s.blackPlayerId===r.id?$.Black:s.whitePlayerId===r.id?$.White:$.None,[s.blackPlayerId,s.whitePlayerId,r.id]);f.useMemo(()=>a?!1:u===W,[u,W,a]);const H=W===$.White,te=Su(s.gameStatus),le=Su(s.turnStartTime);f.useEffect(()=>{s.turnStartTime!==le&&B(null)},[s.turnStartTime,le]),f.useEffect(()=>{te==="curling_animating"&&s.gameStatus!=="curling_animating"&&(k(null),h.current&&(cancelAnimationFrame(h.current),h.current=null))},[s.gameStatus,te]),f.useEffect(()=>{const Q=()=>q(window.innerWidth<1024);return window.addEventListener("resize",Q),()=>window.removeEventListener("resize",Q)},[]);const ce=f.useCallback(()=>{y.current&&(cancelAnimationFrame(y.current),y.current=null),b.current=null},[]),ve=f.useCallback(()=>{j.current=!1,w.current=null,S.current=null,ce(),_(null),I(null),A(0),B(null),D(!1),x.current=0},[ce]),F=f.useCallback(()=>{ce(),B(null),b.current=performance.now();const Q=G=>{var ge;b.current||(b.current=G);const{session:K,currentUser:Z}=U.current,we=(((ge=K.activeCurlingItems)==null?void 0:ge[Z.id])||[]).includes("slow"),P=K.settings.curlingGaugeSpeed||700,Y=we?P*2:P,ae=Y/2,ue=(G-b.current)%Y/ae;let se;ue<=1?se=ue*100:se=(2-ue)*100,v.current&&(v.current.style.width=`${se}%`),x.current=se,y.current=requestAnimationFrame(Q)};y.current=requestAnimationFrame(Q)},[ce]),X=f.useCallback((Q,G,K)=>{h.current&&cancelAnimationFrame(h.current);let Z=JSON.parse(JSON.stringify(Q||[])),fe={...G,vx:K.x,vy:K.y,onBoard:!0};Z.push(fe),k(Z);const we=840,P=.98;let Y=0;const ae=1e3,oe=()=>{let ue=!1;for(const se of Z)se.onBoard&&(se.x+=se.vx,se.y+=se.vy,se.vx*=P,se.vy*=P,Math.abs(se.vx)<.01&&(se.vx=0),Math.abs(se.vy)<.01&&(se.vy=0),(Math.abs(se.vx)>0||Math.abs(se.vy)>0)&&(ue=!0),(se.x<0||se.x>we||se.y<0||se.y>we)&&se.onBoard&&(se.onBoard=!1,se.timeOffBoard=Date.now(),Ee.stoneFallOff()));for(let se=0;se<Z.length;se++)for(let ge=se+1;ge<Z.length;ge++){const je=Z[se],me=Z[ge];if(!je.onBoard||!me.onBoard)continue;const Se=me.x-je.x,ze=me.y-je.y,Be=Math.hypot(Se,ze),He=je.radius+me.radius;if(Be<He){Ee.stoneCollision();const re=Se/Be,Te=ze/Be,_e=me.vx-je.vx,We=me.vy-je.vy,ot=_e*re+We*Te;if(ot<0){const vt=ot;je.vx+=vt*re,je.vy+=vt*Te,me.vx-=vt*re,me.vy-=vt*Te}const Gt=(He-Be)/2;je.x-=Gt*re,je.y-=Gt*Te,me.x+=Gt*re,me.y+=Gt*Te}}k([...Z]),Y++,ue&&Y<ae?h.current=requestAnimationFrame(oe):h.current=null};h.current=requestAnimationFrame(oe)},[]),ee=f.useCallback((Q,G)=>{const{session:K,currentUser:Z}=U.current,fe=K.blackPlayerId===Z.id?$.Black:K.whitePlayerId===Z.id?$.White:$.None;if(!(K.currentPlayer===fe)||K.gameStatus!=="curling_playing")return;j.current=!0;const P=840/19*.47,Y={id:Date.now(),player:fe,x:G.x+P,y:G.y+P,vx:0,vy:0,radius:P,onBoard:!1};w.current=Y;const ae="touches"in Q?{x:Q.touches[0].clientX,y:Q.touches[0].clientY}:{x:Q.clientX,y:Q.clientY};S.current=ae,_(ae),I(ae),D(!0),F()},[F]);f.useEffect(()=>{const Q=Z=>{if(!j.current)return;"touches"in Z&&Z.preventDefault();const fe="touches"in Z?{x:Z.touches[0].clientX,y:Z.touches[0].clientY}:{x:Z.clientX,y:Z.clientY};I(fe)},G=()=>{if(!j.current)return;const{session:Z,onAction:fe}=U.current,we=w.current,P=S.current;ce();const Y=x.current;B(Y),I(ae=>{var oe,ue;if(we&&P&&ae){const se=(oe=m.current)==null?void 0:oe.getSvg();if(!se)return console.error("SVG element not found for coordinate conversion."),ve(),null;const ge=(ue=se.getScreenCTM())==null?void 0:ue.inverse();if(!ge)return console.error("Could not get CTM for coordinate conversion."),ve(),null;const je=se.createSVGPoint();je.x=P.x,je.y=P.y;const me=je.matrixTransform(ge);je.x=ae.x,je.y=ae.y;const Se=je.matrixTransform(ge),ze=Se.x-me.x,Be=Se.y-me.y,He=-ze,re=-Be,Te=Y/100*25,_e=Math.hypot(He,re);if(_e>0){const We=He/_e*Te,ot=re/_e*Te;fe({type:"CURLING_FLICK_STONE",payload:{gameId:Z.id,launchPosition:{x:we.x,y:we.y},velocity:{x:We,y:ot}}})}}return j.current=!1,w.current=null,S.current=null,_(null),D(!1),null}),A(0),x.current=0,setTimeout(()=>B(null),1500)},K=Z=>{j.current&&(Z.preventDefault(),ve())};return window.addEventListener("mousemove",Q),window.addEventListener("touchmove",Q,{passive:!1}),window.addEventListener("mouseup",G),window.addEventListener("touchend",G),window.addEventListener("contextmenu",K),()=>{window.removeEventListener("mousemove",Q),window.removeEventListener("touchmove",Q),window.removeEventListener("mouseup",G),window.removeEventListener("touchend",G),window.removeEventListener("contextmenu",K),ce(),h.current&&cancelAnimationFrame(h.current)}},[ce,ve]),f.useEffect(()=>{const{session:Q}=U.current,G=Q.animation;if((G==null?void 0:G.type)==="curling_flick"&&G.startTime>g.current){g.current=G.startTime;const{stone:K,velocity:Z}=G;X(Q.curlingStones||[],K,Z)}},[s.animation,X]);const xe=O!==null?O:R;return t.jsxs("div",{className:"relative w-full h-full flex items-center justify-center px-4 sm:px-6 lg:px-0",children:[t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 w-3/4 max-w-md z-10 pointer-events-none",children:(M||O!==null)&&t.jsxs("div",{className:`bg-gray-900/50 rounded-full h-6 border-2 border-gray-500 ${O!==null?"animate-flick-power-pulse":""}`,children:[t.jsx("div",{ref:v,className:"bg-gradient-to-r from-yellow-400 to-red-500 h-full rounded-full",style:{width:`${xe}%`}}),t.jsx("span",{className:"absolute inset-0 w-full h-full flex items-center justify-center text-white font-bold text-sm drop-shadow-md",children:"POWER"})]})}),t.jsx("div",{className:`w-full h-full transition-transform duration-500 ${H?"rotate-180":""}`,children:t.jsx(ay,{ref:m,stones:C??d??[],gameStatus:c,myPlayer:W,currentPlayer:u,onLaunchAreaInteractionStart:ee,isSpectator:a,dragStartPoint:M,dragEndPoint:E,selectedStone:V?w.current:null,activeCurlingItems:s.activeCurlingItems,currentUser:r,session:s})})]})}),oy=(e,n,s,l,r)=>{const{x:a,y:i,player:o}=n,c=e.length,d=o===$.Black?$.White:$.Black;if(i<0||i>=c||a<0||a>=c||e[i][a]!==$.None)return{isValid:!1,reason:"occupied",newBoardState:e,capturedStones:[],newKoInfo:s};if(s&&s.point.x===a&&s.point.y===i&&s.turn===l)return{isValid:!1,reason:"ko",newBoardState:e,capturedStones:[],newKoInfo:s};const u=JSON.parse(JSON.stringify(e));u[i][a]=o;const p=(x,j)=>{const w=[];return x>0&&w.push({x:x-1,y:j}),x<c-1&&w.push({x:x+1,y:j}),j>0&&w.push({x,y:j-1}),j<c-1&&w.push({x,y:j+1}),w},m=(x,j,w,S)=>{var E;if(((E=S[j])==null?void 0:E[x])!==w)return null;const C=[{x,y:j}],k=new Set([`${x},${j}`]),M=new Set,_=[{x,y:j}];for(;C.length>0;){const{x:I,y:R}=C.shift();for(const A of p(I,R)){const O=`${A.x},${A.y}`,B=S[A.y][A.x];B===$.None?M.add(O):B===w&&(k.has(O)||(k.add(O),C.push(A),_.push(A)))}}return{stones:_,liberties:M.size}};let h=[],y=null;const b=new Set;for(const x of p(a,i)){const j=`${x.x},${x.y}`;if(u[x.y][x.x]===d&&!b.has(j)){const w=m(x.x,x.y,d,u);w&&w.liberties===0&&(h.push(...w.stones),w.stones.length===1&&(y=w.stones[0]),w.stones.forEach(S=>b.add(`${S.x},${S.y}`)))}}if(h.length>0)for(const x of h)u[x.y][x.x]=$.None;const v=m(a,i,o,u);if(v&&v.liberties===0)return{isValid:!1,reason:"suicide",newBoardState:e,capturedStones:[],newKoInfo:s};let g=null;return v&&h.length===1&&v.stones.length===1&&v.liberties===1&&(g={point:y,turn:l+1}),{isValid:!0,newBoardState:u,capturedStones:h,newKoInfo:g}},kx=e=>{const{boardState:n,settings:{boardSize:s}}=e,l=(d,u)=>{const p=e.currentPlayer,m=oy(e.boardState,{x:d,y:u,player:p},e.koInfo,e.moveHistory.length);return m.isValid&&(e.boardState=m.newBoardState,e.captures[p]+=m.capturedStones.length,e.koInfo=m.newKoInfo),m},r=(d,u)=>{const p=[];return d>0&&p.push({x:d-1,y:u}),d<s-1&&p.push({x:d+1,y:u}),u>0&&p.push({x:d,y:u-1}),u<s-1&&p.push({x:d,y:u+1}),p},a=(d,u,p,m)=>{var g;if(u<0||u>=s||d<0||d>=s||((g=m[u])==null?void 0:g[d])!==p)return null;const h=[{x:d,y:u}],y=new Set([`${d},${u}`]),b=new Set,v=[{x:d,y:u}];for(;h.length>0;){const{x,y:j}=h.shift();for(const w of r(x,j)){const S=`${w.x},${w.y}`,C=m[w.y][w.x];C===$.None?b.add(S):C===p&&(y.has(S)||(y.add(S),h.push(w),v.push(w)))}}return{stones:v,liberties:b.size,libertyPoints:b,player:p}};return{getScore:()=>{const d={[$.Black]:0,[$.White]:0,[$.None]:0},u=Array(s).fill(0).map(()=>Array(s).fill(!1));for(let p=0;p<s;p++)for(let m=0;m<s;m++)if(n[p][m]!==$.None)d[n[p][m]]++;else if(!u[p][m]){const h=[{x:m,y:p}];u[p][m]=!0;const y=[{x:m,y:p}];let b=!1,v=!1;for(;h.length>0;){const g=h.shift();for(const x of r(g.x,g.y))u[x.y][x.x]||(n[x.y][x.x]===$.None?(u[x.y][x.x]=!0,h.push(x),y.push(x)):n[x.y][x.x]===$.Black?b=!0:v=!0)}b&&!v?d[$.Black]+=y.length:v&&!b&&(d[$.White]+=y.length)}return d[$.Black]+=e.captures[$.Black],d[$.White]+=e.captures[$.White],{score:{black:d[$.Black],white:d[$.White]}}},findGroup:a,getAllLibertiesOfPlayer:(d,u)=>{const p=new Set,m=new Set;for(let h=0;h<s;h++)for(let y=0;y<s;y++){const b=`${y},${h}`;if(u[h][y]===d&&!m.has(b)){const v=a(y,h,d,u);v&&(v.stones.forEach(g=>m.add(`${g.x},${g.y}`)),v.libertyPoints.forEach(g=>p.add(g)))}}return Array.from(p).map(h=>{const[y,b]=h.split(",").map(Number);return{x:y,y:b}})},getNeighbors:r,getAllGroups:(d,u)=>{const p=[],m=new Set;for(let h=0;h<s;h++)for(let y=0;y<s;y++)if(u[h][y]===d&&!m.has(`${y},${h}`)){const b=a(y,h,d,u);b&&(p.push(b),b.stones.forEach(v=>m.add(`${v.x},${v.y}`)))}return p},placeStone:l}},cy=e=>{const{session:n,onAction:s,currentUser:l,isSpectator:r,isMyTurn:a,isMobile:i,showLastMoveMarker:o}=e,{id:c,boardState:d,settings:u,lastMove:p,winningLine:m,gameStatus:h,currentPlayer:y,blackPlayerId:b,whitePlayerId:v,player1:g,player2:x,animation:j,lastTurnStones:w}=n,S=b===l.id?$.Black:$.White,C=[g,x],k=C.find(I=>I.id===b)||null,M=C.find(I=>I.id===v)||null,_=f.useMemo(()=>{if(h!=="dice_placing"||!a)return[];if(!d.flat().some(R=>R===$.White)){const R=[];for(let A=0;A<u.boardSize;A++)for(let O=0;O<u.boardSize;O++)d[A][O]===$.None&&R.push({x:O,y:A});return R}return kx(n).getAllLibertiesOfPlayer($.White,d)},[n,h,a,d,u.boardSize]),E=(I,R)=>{!a||h!=="dice_placing"||!_.some(O=>O.x===I&&O.y===R)||s({type:"DICE_PLACE_STONE",payload:{gameId:c,x:I,y:R}})};return t.jsx("div",{className:"relative w-full h-full flex flex-col items-center justify-center",children:t.jsx(qa,{boardState:d,boardSize:u.boardSize,onBoardClick:E,lastMove:p,lastTurnStones:w,isBoardDisabled:!a||h!=="dice_placing",stoneColor:$.Black,winningLine:m,mode:n.mode,mixedModes:n.settings.mixedModes,myPlayerEnum:S,gameStatus:h,currentPlayer:y,highlightedPoints:_,highlightStyle:"ring",isSpectator:r,currentUser:l,blackPlayerNickname:(k==null?void 0:k.nickname)||"",whitePlayerNickname:(M==null?void 0:M.nickname)||"",isItemModeActive:!1,animation:j,isMobile:i,showLastMoveMarker:o})})},dy=e=>{const{session:n,onAction:s,currentUser:l,isMyTurn:r,isSpectator:a,isMobile:i,showLastMoveMarker:o}=e,{id:c,boardState:d,settings:u,lastMove:p,winningLine:m,gameStatus:h,currentPlayer:y,blackPlayerId:b,whitePlayerId:v,thiefPlayerId:g,player1:x,player2:j,lastTurnStones:w}=n,S=b===l.id?$.Black:v===l.id?$.White:$.None,C=l.id===g?"":"",k=[x,j],M=k.find(R=>R.id===b)||null,_=k.find(R=>R.id===v)||null,E=(R,A)=>{!r||h!=="thief_placing"||s({type:"THIEF_PLACE_STONE",payload:{gameId:c,x:R,y:A}})},I=f.useMemo(()=>{if(h!=="thief_placing"||!r)return[];const R=kx(n),A=()=>{const O=[];for(let B=0;B<u.boardSize;B++)for(let V=0;V<u.boardSize;V++)d[B][V]===$.None&&O.push({x:V,y:B});return O};if(C===""){const O=!d.flat().includes($.Black);if(n.turnInRound===1||O)return A();if(d.flat().includes($.Black)){const D=R.getAllLibertiesOfPlayer($.Black,d);return D.length>0?D:A()}else return A()}else if(d.flat().includes($.Black)){const B=R.getAllLibertiesOfPlayer($.Black,d);return B.length>0?B:A()}else return A()},[h,r,n,d,C,u.boardSize]);return t.jsx("div",{className:"relative w-full h-full",children:t.jsx(qa,{boardState:d,boardSize:u.boardSize,onBoardClick:E,lastMove:p,lastTurnStones:w,isBoardDisabled:!r||h!=="thief_placing",stoneColor:S,winningLine:m,mode:n.mode,mixedModes:n.settings.mixedModes,myPlayerEnum:S,gameStatus:h,currentPlayer:y,highlightedPoints:I,isSpectator:a,currentUser:l,blackPlayerNickname:(M==null?void 0:M.nickname)||"",whitePlayerNickname:(_==null?void 0:_.nickname)||"",isItemModeActive:!1,isMobile:i,showLastMoveMarker:o})})},uy=e=>{const{session:n,currentUser:s,isSpectator:l,isMyTurn:r,myPlayerEnum:a,handleBoardClick:i,isMobile:o,showLastMoveMarker:c}=e,{boardState:d,settings:u,lastMove:p,winningLine:m,gameStatus:h,currentPlayer:y,blackPlayerId:b,whitePlayerId:v,player1:g,player2:x,animation:j,blackPatternStones:w,whitePatternStones:S,lastTurnStones:C}=n,k=g.id===b?g:x,M=g.id===v?x:g;return t.jsx("div",{className:"relative w-full h-full flex flex-col items-center justify-center",children:t.jsx(qa,{boardState:d,boardSize:u.boardSize,onBoardClick:i,lastMove:p,lastTurnStones:C,isBoardDisabled:!r||l,stoneColor:a,winningLine:m,mode:n.mode,myPlayerEnum:a,gameStatus:h,currentPlayer:y,isSpectator:l,currentUser:s,blackPlayerNickname:k.nickname,whitePlayerNickname:M.nickname,animation:j,isMobile:o,showLastMoveMarker:c,blackPatternStones:w,whitePatternStones:S,isItemModeActive:!1})})},ku=e=>{const{session:n}=e,{mode:s,isSinglePlayer:l}=n;if(l)return t.jsx(uy,{...e});switch(s){case T.Alkkagi:return t.jsx(ry,{...e});case T.Curling:return t.jsx(iy,{...e});case T.Dice:return t.jsx(cy,{...e});case T.Thief:return t.jsx(dy,{...e});case T.Standard:case T.Capture:case T.Speed:case T.Base:case T.Hidden:case T.Missile:case T.Mix:case T.Omok:case T.Ttamok:default:return t.jsx(sy,{...e})}},my=({session:e,onClose:n})=>{const{mode:s,settings:l,effectiveCaptureTargets:r}=e,a=(o,c)=>c!=null&&c!==""&&t.jsxs(Pn.Fragment,{children:[t.jsxs("div",{className:"font-semibold text-gray-400",children:[o,":"]}),t.jsx("div",{className:"whitespace-nowrap",children:c})]},o),i=f.useMemo(()=>{var u,p,m,h,y,b,v,g;const o=[],c=[T.Standard,T.Speed,T.Base,T.Hidden,T.Missile,T.Mix],d=[T.Alkkagi,T.Curling,T.Dice,T.Thief];if(o.push(a(" ",s)),[T.Alkkagi,T.Curling,T.Dice].includes(s)||o.push(a(" ",`${l.boardSize}x${l.boardSize}`)),c.includes(s)&&!((u=l.mixedModes)!=null&&u.includes(T.Base))&&o.push(a("",`${e.finalKomi??e.settings.komi??ix}`)),d.includes(s)||(l.timeLimit>0?(o.push(a("",`${l.timeLimit}`)),o.push(a("",s===T.Speed?`${l.timeIncrement} `:`${l.byoyomiTime} ${l.byoyomiCount}`))):o.push(a("",""))),s===T.Mix&&o.push(a(" ",(p=l.mixedModes)==null?void 0:p.join(", "))),(s===T.Omok||s===T.Ttamok)&&(o.push(a(" ",l.has33Forbidden?"":"")),o.push(a(" ",l.hasOverlineForbidden?"":""))),s===T.Ttamok&&o.push(a(" ",`${l.captureTarget}`)),s===T.Capture||s===T.Mix&&((m=l.mixedModes)!=null&&m.includes(T.Capture))){const x=r?`: ${r[$.Black]} / : ${r[$.White]}`:`${l.captureTarget} (/  )`;o.push(a(" ",x))}if((s===T.Base||s===T.Mix&&((h=l.mixedModes)!=null&&h.includes(T.Base)))&&o.push(a("",`${l.baseStones}`)),(s===T.Hidden||s===T.Mix&&((y=l.mixedModes)!=null&&y.includes(T.Hidden)))&&(o.push(a("",`${l.hiddenStoneCount}`)),o.push(a("",`${l.scanCount}`))),(s===T.Missile||s===T.Mix&&((b=l.mixedModes)!=null&&b.includes(T.Missile)))&&o.push(a("",`${l.missileCount}`)),s===T.Dice&&(o.push(a("",`${l.diceGoRounds}R`)),o.push(a(" ",`${l.oddDiceCount}`)),o.push(a(" ",`${l.evenDiceCount}`))),s===T.Alkkagi){const x=((v=No.find(j=>j.value===l.alkkagiGaugeSpeed))==null?void 0:v.label)||"";o.push(a("",`${l.alkkagiRounds}R`)),o.push(a(" ",`${l.alkkagiStoneCount}`)),o.push(a(" ",l.alkkagiPlacementType)),o.push(a(" ",l.alkkagiLayout)),o.push(a(" ",x)),o.push(a(" ",`${l.alkkagiSlowItemCount}`)),o.push(a(" ",`${l.alkkagiAimingLineItemCount}`))}if(s===T.Curling){const x=((g=So.find(j=>j.value===l.curlingGaugeSpeed))==null?void 0:g.label)||"";o.push(a(" ",`${l.curlingStoneCount}`)),o.push(a(" ",x)),o.push(a(" ",`${l.curlingSlowItemCount}`)),o.push(a(" ",`${l.curlingAimingLineItemCount}`))}return o.filter(Boolean)},[e]);return t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md flex-shrink-0 border border-color",children:[t.jsxs("h3",{className:"text-base font-bold border-b border-gray-700 pb-1 mb-2 text-yellow-300 flex justify-between items-center",children:[" ",n&&t.jsx("button",{onClick:n,className:"text-xl font-bold text-gray-400 hover:text-white",children:""})]}),t.jsx("div",{className:"grid grid-cols-2 gap-x-3 gap-y-0.5 text-xs",children:i})]})},fy=({session:e,onlineUsers:n,currentUser:s,onClose:l,onAction:r,onViewUser:a})=>{const{player1:i,player2:o,blackPlayerId:c,whitePlayerId:d,gameStatus:u,isAiGame:p}=e,m=f.useMemo(()=>n.filter(x=>x.status==="in-game"&&x.gameId===e.id).sort((x,j)=>x.id===c?-1:j.id===c?1:0),[n,e.id,c]),h=f.useMemo(()=>n.filter(x=>x.status==="spectating"&&x.spectatingGameId===e.id),[n,e.id]),y=["ended","no_contest","rematch_pending"].includes(u),b=u==="rematch_pending",v=x=>{r({type:"REQUEST_REMATCH",payload:{opponentId:x,originalGameId:e.id}})},g=(x,j)=>{var M,_;const w=x.id===s.id,S=!w&&(x.id===i.id||x.id===o.id),C=(M=Me.find(E=>E.id===x.avatarId))==null?void 0:M.url,k=(_=Re.find(E=>E.id===x.borderId))==null?void 0:_.url;return t.jsxs("div",{className:`flex items-center gap-2 p-1 rounded ${w?"bg-blue-900/50":""}`,children:[t.jsx(Ce,{userId:x.id,userName:x.nickname,size:28,avatarUrl:C,borderUrl:k}),t.jsxs("div",{className:`flex items-center gap-2 flex-grow overflow-hidden ${w?"":"cursor-pointer"}`,onClick:()=>!w&&a(x.id),title:w?"":`${x.nickname}  `,children:[t.jsx("span",{className:"font-semibold truncate text-sm",children:x.nickname}),y&&S&&!p&&t.jsx(z,{onClick:E=>{E==null||E.stopPropagation(),v(x.id)},disabled:b,colorScheme:"yellow",className:"!text-xs !py-0.5 !px-2 flex-shrink-0",children:b?"":""})]}),t.jsx("span",{className:"ml-auto text-xs text-gray-400 flex-shrink-0",children:j})]},x.id)};return t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md flex flex-col border border-color",children:[t.jsxs("h3",{className:"text-base font-bold border-b border-gray-700 pb-1 mb-2 text-yellow-300 flex-shrink-0 flex justify-between items-center",children:[" ",l&&t.jsx("button",{onClick:l,className:"text-xl font-bold text-gray-400 hover:text-white",children:""})]}),t.jsxs("div",{className:"space-y-0.5 overflow-y-auto pr-1 flex-grow",children:[m.map(x=>g(x,x.id===c?"":"")),h.map(x=>g(x,""))]})]})},xy=e=>{const{session:n,isSpectator:s,onAction:l,waitingRoomChat:r,gameChat:a,onClose:i,onViewUser:o}=e,{mode:c}=n,{currentUserWithStatus:d,handlers:u}=De(),p=n.isAiGame,[m,h]=f.useState(p?"global":"game"),[y,b]=f.useState(""),[v,g]=f.useState(!1),[x,j]=f.useState(0),w=f.useRef(null),S=f.useRef(null),C=m==="game"?a:r;f.useEffect(()=>{S.current&&(S.current.scrollTop=S.current.scrollHeight)},[C]),f.useEffect(()=>{if(x>0){const D=setTimeout(()=>{j(L=>Math.max(0,L-1))},1e3);return()=>clearTimeout(D)}},[x]),f.useEffect(()=>{const D=L=>{w.current&&!w.current.contains(L.target)&&g(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]);const _=`[${Ye.some(D=>D.mode===c)?"":""}:${c}]`,E=D=>{if(s||x>0)return;const L=m==="game"?n.id:"global",q={channel:L,...D};L==="global"&&(q.location=_),l({type:"SEND_CHAT_MESSAGE",payload:q}),g(!1),b(""),j(5)},I=D=>{if(D.preventDefault(),y.trim()){if(Ql(y)){alert("       ."),b("");return}E({text:y})}};if(!d)return null;const R=D=>{d.isAdmin&&D!==d.id?u.openModerationModal(D):D!==d.id&&o(D)},A=(d.chatBanUntil??0)>Date.now(),O=A?Math.ceil((d.chatBanUntil-Date.now())/1e3/60):0,B=A||x>0,V=A?`   (${O} )`:B?`(${x})`:"[ ]";return t.jsxs("div",{className:"flex flex-col h-full bg-gray-800 p-2 rounded-md border border-color",children:[p?t.jsx("h3",{className:"text-base font-bold border-b border-gray-700 pb-1 mb-2 text-yellow-300 flex-shrink-0",children:""}):t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-2 flex-shrink-0",children:[t.jsx("button",{onClick:()=>h("game"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md ${m==="game"?"bg-blue-600":"text-gray-400"}`,children:""}),t.jsx("button",{onClick:()=>h("global"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md ${m==="global"?"bg-blue-600":"text-gray-400"}`,children:""})]}),t.jsxs("div",{ref:S,className:"flex-grow space-y-1 overflow-y-auto pr-2 mb-2 bg-gray-900/40 p-1.5 rounded-md min-h-0",children:[C.map(D=>{const L=D.system&&!D.actionInfo&&D.user.nickname==="AI ";return t.jsx("div",{className:"text-sm",children:D.actionInfo?t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"font-semibold text-gray-400 pr-2",children:[D.user.nickname,":"]}),t.jsx("span",{className:"text-yellow-400",children:D.actionInfo.message}),t.jsx("span",{className:"text-gray-400",children:" ( "}),t.jsx("span",{className:D.actionInfo.scoreChange>0?"text-blue-400 font-bold":"text-red-400 font-bold",children:D.actionInfo.scoreChange>0?`+${D.actionInfo.scoreChange}`:D.actionInfo.scoreChange}),t.jsx("span",{className:"text-gray-400",children:")"})]}):t.jsxs(t.Fragment,{children:[D.location&&t.jsx("span",{className:"font-semibold text-gray-500 pr-1",children:D.location}),t.jsxs("span",{className:`font-semibold pr-2 ${D.system?"text-yellow-400":"text-gray-400 cursor-pointer hover:underline"}`,onClick:()=>!D.system&&R(D.user.id),title:D.system?"":`${D.user.nickname}   / `,children:[D.system?L?"AI ":"":D.user.nickname,":"]}),D.text&&t.jsxs("span",{className:L?"text-yellow-400":"",children:[D.text,L&&" "]}),D.emoji&&t.jsx("span",{className:"text-xl",children:D.emoji})]})},D.id)}),C.length===0&&t.jsx("div",{className:"h-full flex items-center justify-center text-gray-500 text-sm",children:"  ."})]}),!s&&t.jsxs("div",{className:"relative flex-shrink-0",children:[v&&t.jsxs("div",{ref:w,className:"absolute bottom-full mb-2 w-full bg-gray-600 rounded-lg shadow-xl p-2 z-10 max-h-64 overflow-y-auto",children:[t.jsx("div",{className:"grid grid-cols-5 gap-2 text-2xl mb-2 border-b border-gray-500 pb-2",children:xx.map(D=>t.jsxs("button",{onClick:()=>E({emoji:D}),className:"w-full p-2 rounded-md hover:bg-blue-600 transition-colors text-center",children:[" ",D," "]},D))}),t.jsx("ul",{className:"space-y-1",children:fx.map(D=>t.jsxs("li",{children:[" ",t.jsxs("button",{onClick:()=>E({text:D}),className:"w-full text-left text-sm p-2 rounded-md hover:bg-blue-600 transition-colors",children:[" ",D," "]})," "]},D))})]}),t.jsxs("form",{onSubmit:I,className:"flex gap-2",children:[t.jsx("button",{type:"button",onClick:()=>g(D=>!D),className:"bg-gray-700 hover:bg-gray-600 text-white font-bold px-2.5 rounded-md transition-colors text-lg flex items-center justify-center",title:" ",disabled:B,children:t.jsx("span",{children:""})}),t.jsx("input",{type:"text",value:y,onChange:D=>b(D.target.value),placeholder:V,className:"flex-grow bg-gray-900 border border-gray-600 rounded-md p-1.5 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-800 disabled:text-gray-500",maxLength:30,disabled:B}),t.jsx(z,{type:"submit",disabled:!y.trim()||B,className:"!px-2.5 !py-1.5",title:"",children:""})]})]})]})},Cu=e=>{const{session:n,onLeaveOrResign:s,isNoContestLeaveAvailable:l,isSpectator:r}=e,{gameStatus:a}=n,i=["ended","no_contest","rematch_pending"].includes(a),o=l?"":i?"":r?"":"",c=l?"yellow":"red";return t.jsxs("div",{className:"flex flex-col h-full gap-1.5 bg-gray-900/80 rounded-lg p-2 border border-color",children:[t.jsxs("div",{className:"flex-shrink-0 space-y-2",children:[t.jsx(my,{session:n,onClose:e.onClose}),t.jsx(fy,{...e})]}),t.jsx("div",{className:"flex-1 mt-2 min-h-0",children:t.jsx(xy,{...e})}),t.jsx("div",{className:"flex-shrink-0 pt-2",children:t.jsx(z,{onClick:s,colorScheme:c,className:"w-full",children:o})})]})},py=e=>{e<0&&(e=0);const n=Math.floor(e/60),s=Math.floor(e%60);return`${String(n).padStart(2,"0")}:${String(s).padStart(2,"0")}`},gy=({count:e,target:n,panelType:s,mode:l})=>{const r=typeof n=="number"&&n>0?`${e}/${n}`:`${e}`,a=l===T.Dice;let i=" ";a?i=" ":[T.Thief,T.Curling].includes(l)&&(i="");const o="flex flex-col items-center justify-center w-[clamp(4.5rem,16vmin,6rem)] rounded-lg shadow-lg border-2 p-1 text-center h-full";let c="",d="text-gray-300",u="text-white";return s==="white"?(c="bg-gradient-to-br from-gray-50 to-gray-200 border-gray-400",d="text-gray-700",u="text-black"):c="bg-gradient-to-br from-gray-800 to-black border-gray-600",t.jsxs("div",{className:`${o} ${c}`,children:[t.jsx("span",{className:`${d} text-[clamp(0.6rem,2vmin,0.75rem)] font-semibold whitespace-nowrap`,children:i}),a?t.jsxs("div",{className:`font-mono font-bold text-[clamp(1rem,5vmin,2rem)] tracking-tighter my-1 ${u} flex items-center justify-center gap-1`,children:[t.jsx("div",{className:"w-[clamp(0.8rem,3vmin,1rem)] h-[clamp(0.8rem,3vmin,1rem)] rounded-full bg-white border border-black inline-block flex-shrink-0"}),t.jsx("span",{children:r})]}):t.jsx("span",{className:`font-mono font-bold text-[clamp(1rem,5vmin,2rem)] tracking-tighter my-1 ${u}`,children:r})]})},hy=({timeLeft:e,totalTime:n,byoyomiTime:s,byoyomiPeriods:l,totalByoyomi:r,isActive:a,isInByoyomi:i,isFoulMode:o=!1,isLeft:c})=>{const d=f.useMemo(()=>{if(o){const m=n>0?n:s;return m>0?e/m*100:0}return i?s>0?e/s*100:0:n>0?e/n*100:0},[e,n,s,i,o]),u=c?"right-1":"left-1",p=c?"justify-end":"justify-start";return t.jsxs("div",{className:"w-full relative",children:[t.jsx("div",{className:`w-full h-1.5 rounded-full transition-colors ${i||o?"bg-red-900/70":"bg-gray-700"}`,children:t.jsx("div",{className:`h-1.5 rounded-full ${i||o?"bg-red-500":"bg-blue-500"} ${a&&e<5?"animate-pulse":""}`,style:{width:`${Math.min(100,d)}%`,transition:"width 0.2s linear"}})}),(r>0||o)&&t.jsx("div",{className:`absolute ${u} top-1/2 -translate-y-1/2 flex items-center ${p} gap-1 sm:gap-1.5`,children:o?t.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:l}).map((m,h)=>t.jsx("span",{className:"text-base leading-none",title:`${l} fouls remaining`,children:""},h))}):t.jsxs("div",{className:"flex items-center gap-1 text-yellow-300",children:[t.jsx("span",{className:"text-base",children:""}),t.jsx("span",{className:"text-sm font-bold",children:l})]})})]})},Iu=e=>{var ae,oe;const{user:n,playerEnum:s,score:l,isActive:r,timeLeft:a,totalTime:i,mainTimeLeft:o,byoyomiPeriodsLeft:c,totalByoyomi:d,byoyomiTime:u,isLeft:p,session:m,captureTarget:h,role:y,isAiPlayer:b,mode:v,isSinglePlayer:g}=e,{gameStatus:x,winner:j,blackPlayerId:w,whitePlayerId:S}=m,C=f.useMemo(()=>{var ue;return(ue=Me.find(se=>se.id===n.avatarId))==null?void 0:ue.url},[n.avatarId]),k=f.useMemo(()=>{var ue;return(ue=Re.find(se=>se.id===n.borderId))==null?void 0:ue.url},[n.borderId]),M=Ye.some(ue=>ue.mode===v),_=rt.some(ue=>ue.mode===v)&&![T.Omok,T.Ttamok].includes(v),E=v===T.Curling,I=_?i:u,R=M?n.strategyLevel:n.playfulLevel,O=`${M?"":""} Lv.${R}`,B=p?"flex-row":"flex-row-reverse",V=p?"text-left":"text-right",D=p?"justify-start":"justify-end",L=["ended","no_contest","rematch_pending"].includes(x),q=j===$.Black&&w===n.id||j===$.White&&S===n.id,U=(j===$.Black||j===$.White)&&!q,W=!_&&o<=0&&d>0,H=t0,te=_?H:d,le=_?H-(((ae=m.timeoutFouls)==null?void 0:ae[n.id])||0):c,ce=v===T.Dice,ve=ce||s===$.Black,F=!ce&&s===$.White,X=ve?"black":F?"white":"neutral";let ee="",xe="",Q="",G="";g?(ee=r&&!L?"bg-stone-800 ring-2 ring-amber-400 border-stone-600":"bg-stone-900/50 border-stone-700",xe="text-stone-100",Q="text-stone-400",G="text-stone-200"):X==="black"?(ee=r&&!L?"bg-gray-800 ring-2 ring-blue-400 border-gray-600":"bg-black/50 border-gray-700",xe="text-white",Q="text-gray-400",G="text-gray-200"):X==="white"?(ee=r&&!L?"bg-gray-300 ring-2 ring-blue-500 border-blue-500":"bg-gray-200 border-gray-400",xe="text-black",Q="text-gray-600",G="text-gray-800"):(ee=r&&!L?"bg-blue-900/50 ring-2 ring-blue-400":"bg-gray-800/30",xe="text-white",Q="text-gray-400",G="text-gray-200");const fe=q?g?"text-amber-300":ve?"text-yellow-300":"text-yellow-600":U?g?"text-stone-500":"text-gray-500":xe,we=m.settings.curlingStoneCount||5,P=((oe=m.stonesThrownThisRound)==null?void 0:oe[n.id])||0,Y=we-P;return t.jsxs("div",{className:`flex items-stretch gap-2 flex-1 ${B} p-1 rounded-lg transition-all duration-300 border ${ee}`,children:[t.jsxs("div",{className:`flex flex-col ${V} flex-grow justify-between min-w-0`,children:[t.jsxs("div",{className:`flex items-center gap-2 ${p?"":"flex-row-reverse"}`,children:[t.jsx(Ce,{userId:n.id,userName:n.nickname,size:48,avatarUrl:C,borderUrl:k}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs("div",{className:`flex items-baseline gap-2 ${D}`,children:[!p&&L&&q&&t.jsx("span",{className:"text-2xl font-black text-blue-400",children:""}),!p&&L&&U&&t.jsx("span",{className:"text-2xl font-black text-red-400",children:""}),t.jsxs("h2",{className:`font-bold text-[clamp(0.8rem,3vmin,1.125rem)] leading-tight whitespace-nowrap ${fe}`,children:[n.nickname," ",b&&""," ",y&&`(${y})`]}),p&&L&&q&&t.jsx("span",{className:"text-2xl font-black text-blue-400",children:""}),p&&L&&U&&t.jsx("span",{className:"text-2xl font-black text-red-400",children:""})]}),t.jsx("p",{className:`text-[clamp(0.6rem,2vmin,0.75rem)] ${Q}`,children:O}),E&&t.jsxs("div",{className:`flex items-center gap-3 text-xs mt-1 ${D} ${Q}`,children:[t.jsxs("span",{children:[m.curlingRound||1,"/",m.settings.curlingRounds||3,"R"]}),t.jsxs("span",{className:"font-semibold",children:[" : ",Y]})]})]})]}),t.jsxs("div",{className:"mt-1",children:[t.jsx(hy,{timeLeft:a,totalTime:i,byoyomiTime:I,byoyomiPeriods:le,totalByoyomi:te,isActive:r&&!L,isInByoyomi:W,isFoulMode:_,isLeft:p}),t.jsx("div",{className:`flex items-center mt-0.5 ${D}`,children:t.jsx("span",{className:`font-mono font-bold ${W||_&&a<10?"text-red-400":G} text-[clamp(1rem,3.5vmin,1.25rem)]`,children:py(a)})})]})]}),t.jsx(gy,{count:l,target:h,panelType:X,mode:v})]})},yy=(e,n,s)=>{if(!(rt.some(r=>r.mode===e)&&![T.Omok,T.Ttamok].includes(e)))return s.timeLimit*60;switch(e){case T.Alkkagi:return n==="alkkagi_placement"?Zh:n==="alkkagi_simultaneous_placement"?e0:Xh;case T.Curling:return n0;case T.Dice:return n==="dice_rolling"?Sr:n==="dice_placing"?Xd:Sr;case T.Thief:return n==="thief_rolling"?Sr:n==="thief_placing"?Xd:Sr;default:return s.timeLimit*60}},Eu=e=>{var q,U;const{session:n,clientTimes:s,isSinglePlayer:l}=e,{player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,captures:c,mode:d,settings:u,effectiveCaptureTargets:p,scores:m,currentPlayer:h}=n,y=[T.Dice,T.Thief,T.Curling].includes(d),b=r,v=a,g=b.id===i?$.Black:b.id===o?$.White:$.None,x=v.id===i?$.Black:v.id===o?$.White:$.None,j=h===g&&g!==$.None,w=h===x&&x!==$.None,S=d===T.Curling?((q=n.curlingScores)==null?void 0:q[g])??0:y?(m==null?void 0:m[b.id])??0:c[g],C=d===T.Curling?((U=n.curlingScores)==null?void 0:U[x])??0:y?(m==null?void 0:m[v.id])??0:c[x],k=g===$.Black?s.black:g===$.White?s.white:u.timeLimit*60,M=x===$.Black?s.black:x===$.White?s.white:u.timeLimit*60,_=g===$.Black?n.blackTimeLeft:g===$.White?n.whiteTimeLeft:u.timeLimit*60,E=x===$.Black?n.blackTimeLeft:x===$.White?n.whiteTimeLeft:u.timeLimit*60,I=g===$.Black?n.blackByoyomiPeriodsLeft:g===$.White?n.whiteByoyomiPeriodsLeft:u.byoyomiCount,R=x===$.Black?n.blackByoyomiPeriodsLeft:x===$.White?n.whiteByoyomiPeriodsLeft:u.byoyomiCount,A=d===T.Thief?b.id===n.thiefPlayerId?"":"":void 0,O=d===T.Thief?v.id===n.thiefPlayerId?"":"":void 0,B=W=>{if(n.isSinglePlayer||d===T.Capture)return p==null?void 0:p[W];if(d===T.Ttamok)return u.captureTarget},V=n.isAiGame&&b.id===el,D=n.isAiGame&&v.id===el,L=yy(d,n.gameStatus,u);return t.jsxs("div",{className:"flex justify-between items-start gap-2 flex-shrink-0 h-full",children:[t.jsx(Iu,{user:b,playerEnum:g,score:S,isActive:j,timeLeft:k,totalTime:L,mainTimeLeft:_,byoyomiPeriodsLeft:I,totalByoyomi:u.byoyomiCount,byoyomiTime:u.byoyomiTime,isLeft:!0,session:n,captureTarget:B(g),role:A,isAiPlayer:V,mode:d,isSinglePlayer:l}),t.jsx(Iu,{user:v,playerEnum:x,score:C,isActive:w,timeLeft:M,totalTime:L,mainTimeLeft:E,byoyomiPeriodsLeft:R,totalByoyomi:u.byoyomiCount,byoyomiTime:u.byoyomiTime,isLeft:!1,session:n,captureTarget:B(x),role:O,isAiPlayer:D,mode:d,isSinglePlayer:l})]})},by=(e,n)=>{const{winner:s,blackPlayerId:l,whitePlayerId:r,player1:a,player2:i}=e;return s===null||s===$.None||!(n.id===a.id||n.id===i.id)?null:s===$.Black&&n.id===l||s===$.White&&n.id===r},Cr=e=>kc(e).rank,vy=({initial:e,final:n,max:s,levelUp:l,xpGain:r,finalLevel:a})=>{const[i,o]=f.useState(0),[c,d]=f.useState(0),[u,p]=f.useState(!1),m=s>0?e/s*100:0,h=s>0?l?100:n/s*100:0,y=h-m;f.useEffect(()=>{o(m),d(0),p(!1);const v=setTimeout(()=>{p(!0),d(1),o(h);const g=setTimeout(()=>{d(0)},500);return()=>clearTimeout(g)},500);return()=>clearTimeout(v)},[e,n,s,l,m,h]);const b=`${r}-${e}`;return t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-sm font-bold w-16 text-right",children:["Lv.",a]}),t.jsxs("div",{className:"w-full bg-gray-700/50 rounded-full h-4 relative border border-gray-900/50 overflow-hidden",children:[t.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-full transition-all duration-1000 ease-out",style:{width:`${i}%`}}),t.jsx("div",{className:"absolute top-0 h-full bg-gradient-to-r from-green-400 to-green-500 rounded-r-full transition-opacity duration-500 ease-out pointer-events-none",style:{left:`${m}%`,width:`${y}%`,opacity:c}}),t.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-black/80 drop-shadow-sm",children:[n," / ",s]}),l&&t.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-white animate-pulse",style:{textShadow:"0 0 5px black"},children:"LEVEL UP!"})]}),u&&r>0&&t.jsxs("span",{className:"text-sm font-bold text-green-400 whitespace-nowrap animate-fade-in-xp w-20",children:["+",r," XP"]},b),t.jsx("style",{children:`
                @keyframes fadeInXp {
                    from { opacity: 0; transform: scale(0.8); }
                    to { opacity: 1; transform: scale(1); }
                }
                .animate-fade-in-xp {
                    animation: fadeInXp 0.5s ease-out forwards;
                }
            `})]})},jy=({analysis:e,session:n})=>{var c,d,u;const{scoreDetails:s}=e,{mode:l,settings:r}=n;if(!s)return t.jsx("p",{className:"text-center text-gray-400",children:"  ."});const a=l===T.Speed||l===T.Mix&&((c=r.mixedModes)==null?void 0:c.includes(T.Speed)),i=l===T.Base||l===T.Mix&&((d=r.mixedModes)==null?void 0:d.includes(T.Base)),o=l===T.Hidden||l===T.Mix&&((u=r.mixedModes)==null?void 0:u.includes(T.Hidden));return t.jsx("div",{className:"space-y-3 text-xs md:text-sm",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.black.territory.toFixed(0)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.black.deadStones??0})]}),i&&t.jsxs("div",{className:"flex justify-between text-blue-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.baseStoneBonus})]}),o&&t.jsxs("div",{className:"flex justify-between text-purple-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.hiddenStoneBonus})]}),a&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.timeBonus.toFixed(1)})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:s.black.total.toFixed(1)})]})]}),t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.white.territory.toFixed(0)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.white.deadStones??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.white.komi})]}),i&&t.jsxs("div",{className:"flex justify-between text-blue-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.baseStoneBonus})]}),o&&t.jsxs("div",{className:"flex justify-between text-purple-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.hiddenStoneBonus})]}),a&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.timeBonus.toFixed(1)})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:s.white.total.toFixed(1)})]})]})]})})},wy=({gameSession:e})=>{const{scores:n,player1:s,player2:l,diceGoBonuses:r}=e,a=s.id,i=l.id,o=n[a]||0,c=n[i]||0,d=(r==null?void 0:r[a])||0,u=(r==null?void 0:r[i])||0,p=o-d,m=c-u;return d>0||u>0?t.jsx("div",{className:"space-y-3 text-xs md:text-sm",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:s.nickname}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:p})]}),d>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  :"})," ",t.jsxs("span",{className:"text-green-400",children:["+",d]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:o})]})]}),t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:l.nickname}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:m})]}),u>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  :"})," ",t.jsxs("span",{className:"text-green-400",children:["+",u]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:c})]})]})]})}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300",children:" "}),t.jsxs("p",{className:"text-5xl font-mono my-2",children:[o," : ",c]})]})},Ny=({gameSession:e})=>{var y,b,v,g;const{curlingScores:n,player1:s,player2:l,blackPlayerId:r,whitePlayerId:a}=e;if(!n)return t.jsx("p",{className:"text-center text-gray-400",children:"  ."});const i=r===s.id?s:l,o=a===s.id?s:l,c=n[$.Black]||0,d=n[$.White]||0,u=(y=Me.find(x=>x.id===i.avatarId))==null?void 0:y.url,p=(b=Re.find(x=>x.id===i.borderId))==null?void 0:b.url,m=(v=Me.find(x=>x.id===o.avatarId))==null?void 0:v.url,h=(g=Re.find(x=>x.id===o.borderId))==null?void 0:g.url;return t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-4",children:" "}),t.jsxs("div",{className:"flex items-center justify-center my-2",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2 w-32 flex-shrink-0",children:[t.jsx(Ce,{userId:i.id,userName:i.nickname,size:64,avatarUrl:u,borderUrl:p}),t.jsxs("span",{className:"font-bold mt-1 w-full truncate",children:[i.nickname," ()"]})]}),t.jsxs("p",{className:"text-5xl font-mono text-center flex-grow px-2",children:[c," : ",d]}),t.jsxs("div",{className:"flex flex-col items-center gap-2 w-32 flex-shrink-0",children:[t.jsx(Ce,{userId:o.id,userName:o.nickname,size:64,avatarUrl:m,borderUrl:h}),t.jsxs("span",{className:"font-bold mt-1 w-full truncate",children:[o.nickname," ()"]})]})]})]})},Sy=({session:e,currentUser:n,onConfirm:s})=>{var _,E,I,R,A;const{winner:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,winReason:c}=e,d=f.useRef(!1),u=by(e,n),p=(_=e.summary)==null?void 0:_[n.id],m=rt.some(O=>O.mode===e.mode),h=f.useMemo(()=>{var O;return(O=Me.find(B=>B.id===n.avatarId))==null?void 0:O.url},[n.avatarId]),y=f.useMemo(()=>{var O;return(O=Re.find(B=>B.id===n.borderId))==null?void 0:O.url},[n.borderId]),b=(E=p==null?void 0:p.items)==null?void 0:E[0],v=b?js.find(O=>O.name===b.name):null;f.useEffect(()=>{d.current||(u===!0?Ee.gameWin():u===!1&&Ee.gameLose(),p&&(p.level&&p.level.initial<p.level.final&&setTimeout(()=>Ee.levelUp(),800),p.manner&&Cr(p.manner.initial)!==Cr(p.manner.final)&&setTimeout(()=>Ee.levelUp(),900)),d.current=!0)},[u,p]);const g=l===$.None,x=l===$.Black?r.id===i?r:a:l===$.White?r.id===o?r:a:null,{title:j,color:w}=f.useMemo(()=>{if(g)return{title:"",color:"text-yellow-400"};if(u===null)return x?{title:`${x.nickname} `,color:"text-gray-300"}:{title:" ",color:"text-gray-300"};if(u){let O="";return c==="resign"&&(O=""),c==="timeout"&&(O=""),{title:O,color:"text-green-400"}}else{let O="";return c==="resign"&&(O=""),c==="timeout"&&(O=""),{title:O,color:"text-red-400"}}},[u,g,c,x]),S=(I=e.analysisResult)==null?void 0:I.system,C=()=>{if(m&&c==="resign"){const O=u?"  .":" .";return t.jsx("p",{className:"text-center text-lg",children:O})}if(c==="score")return S?t.jsx("div",{className:"w-full",children:t.jsx(jy,{analysis:S,session:e})}):t.jsx("p",{className:"text-center text-gray-400 animate-pulse",children:"  ..."});if(e.mode===T.Dice||e.mode===T.Thief)return t.jsx(wy,{gameSession:e});if(e.mode===T.Curling)return t.jsx(Ny,{gameSession:e});if(e.mode===T.Omok||e.mode===T.Ttamok){let O="";if(c==="omok_win"?O=u?" ":"  ":c==="capture_limit"&&(O=u?"  ":"   "),O)return t.jsx("p",{className:"text-center text-2xl font-bold",children:O})}if(e.mode===T.Alkkagi){const O=n.id===i?$.Black:$.White,B=(e.alkkagiStones||[]).filter(D=>D.player===O&&D.onBoard).length,V=(e.alkkagiStones||[]).filter(D=>D.player!==O&&D.onBoard).length;return u?B>0?t.jsxs("p",{className:"text-center text-lg",children:[B,"   ."]}):t.jsx("p",{className:"text-center text-lg",children:"    ."}):V>0?t.jsxs("p",{className:"text-center text-lg",children:["     . (  ",V," )"]}):t.jsx("p",{className:"text-center text-lg",children:" ."})}return t.jsx("p",{className:"text-center text-gray-400",children:"   ."})},k=p?Cr(p.manner.initial):"",M=p?Cr(p.manner.final):"";return t.jsx(be,{title:" ",onClose:s,initialWidth:600,windowId:"game-summary",children:t.jsxs("div",{className:"text-white text-[clamp(0.75rem,2.5vw,1rem)]",children:[t.jsx("h1",{className:`text-[clamp(2.25rem,10vw,3rem)] font-black text-center mb-4 tracking-widest ${w}`,children:j}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsxs("div",{className:"w-full bg-gray-900/50 p-2 sm:p-4 rounded-lg",children:[t.jsx("h2",{className:"text-lg font-bold text-center text-gray-200 mb-3 border-b border-gray-700 pb-2",children:" "}),C()]}),p&&t.jsxs("div",{className:"w-full flex flex-col gap-2 sm:gap-4",children:[t.jsxs("div",{className:"bg-gray-900/50 p-2 sm:p-4 rounded-lg space-y-4",children:[t.jsx("h2",{className:"text-lg font-bold text-center text-gray-200 mb-3 border-b border-gray-700 pb-2",children:"  "}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ce,{userId:n.id,userName:n.nickname,size:48,avatarUrl:h,borderUrl:y}),t.jsxs("div",{children:[t.jsx("p",{className:"font-bold",children:n.nickname}),t.jsxs("p",{className:"text-xs text-gray-400",children:[m?"":""," Lv.",p.level?p.level.final:m?n.playfulLevel:n.strategyLevel]})]})]}),p.level&&t.jsx(vy,{initial:p.level.progress.initial,final:p.level.progress.final,max:p.level.progress.max,levelUp:p.level.initial<p.level.final,xpGain:p.xp.change,finalLevel:p.level.final}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-center",children:[t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[p.rating.final," (",t.jsxs("span",{className:p.rating.change>=0?"text-green-400":"text-red-400",children:[p.rating.change>0?"+":"",p.rating.change]}),")"]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:"  "}),t.jsxs("p",{className:`font-semibold ${p.manner.change===0?"text-white":p.manner.change>0?"text-green-400":"text-red-400"}`,children:[p.manner.change>0?"+":"",p.manner.change]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[(R=p.overallRecord)==null?void 0:R.wins," ",(A=p.overallRecord)==null?void 0:A.losses,""]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[k,"  ",M]})]})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-2 sm:p-4 rounded-lg space-y-3",children:[t.jsx("h2",{className:"text-lg font-bold text-center text-gray-200 border-b border-gray-700 pb-2",children:" "}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-center",children:[t.jsx("div",{className:"bg-gray-800 p-2 rounded-md",children:t.jsxs("p",{className:"font-semibold flex items-center justify-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4"})," ",(p.gold??0).toLocaleString()," "]})}),t.jsx("div",{className:"bg-gray-800 p-2 rounded-md flex items-center justify-center",children:b&&v?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[v.image&&t.jsx("img",{src:v.image,alt:b.name,className:"w-6 h-6 object-contain"}),t.jsx("p",{className:"font-semibold text-xs",children:b.name})]}):t.jsx("p",{className:"font-semibold text-xs",children:"   "})})]})]})]})]}),t.jsx(z,{onClick:s,className:"w-full py-3 mt-6",children:""})]})})},ky=({session:e,currentUser:n,onAction:s})=>{const[l,r]=f.useState(15),a=f.useRef(!1),{id:i,nigiri:o,player1:c,player2:d,gameStatus:u}=e;if(!o)return null;const{holderId:p,guesserId:m,result:h,stones:y,guess:b}=o,v=n.id===m;f.useEffect(()=>{u==="nigiri_choosing"&&!a.current&&(a.current=!0)},[u]);const g=f.useCallback(w=>{var S;n.id!==((S=e.nigiri)==null?void 0:S.guesserId)||e.gameStatus!=="nigiri_guessing"||s({type:"NIGIRI_GUESS",payload:{gameId:e.id,guess:w}})},[e,n,s]);f.useEffect(()=>{if(u!=="nigiri_guessing"||!v)return;const w=e.guessDeadline||Date.now()+15*1e3,S=setInterval(()=>{const C=Math.max(0,Math.ceil((w-Date.now())/1e3));r(C),C<=0&&clearInterval(S)},1e3);return()=>clearInterval(S)},[u,v,e.guessDeadline]);const x=()=>{switch(u){case"nigiri_reveal":return" ";case"nigiri_guessing":return"  ";case"nigiri_choosing":default:return"/  ()"}},j=()=>{const w=c.id===p?c:d,S=c.id===m?c:d;if(u==="nigiri_reveal"){if(!h||!S||!w||typeof y!="number"||!b)return t.jsxs("div",{className:"text-center animate-pulse",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2",children:"  ..."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]});const C=h==="correct",k=C?S:w,M=n.id===k.id,_=M?"  .":"  .",E=M?"bg-black border-gray-300":"bg-white border-gray-800",I=C?`${S.nickname} !`:`${S.nickname} .`,R=C?"text-green-400":"text-red-400",A=`${k.nickname} ()  .`;return t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg space-y-3 mb-6",children:[t.jsxs("div",{className:"flex justify-between items-center text-lg",children:[t.jsx("span",{className:"text-gray-400",children:"  :"}),t.jsxs("span",{className:"font-semibold",children:[y,""]})]}),t.jsxs("div",{className:"flex justify-between items-center text-lg",children:[t.jsxs("span",{className:"text-gray-400",children:[S.nickname," :"]}),t.jsx("span",{className:"font-semibold",children:b===1?"":""})]}),t.jsx("div",{className:`mt-2 text-lg font-bold ${R}`,children:I})]}),t.jsx("p",{className:"text-lg font-semibold mb-4",children:A}),t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[t.jsx("div",{className:`w-24 h-24 rounded-full flex items-center justify-center border-4 ${E}`}),t.jsx("p",{className:"text-xl font-bold",children:_})]}),t.jsx("p",{className:"mt-6 text-sm text-gray-400 animate-pulse",children:"   ..."})]})}return u==="nigiri_guessing"?v?t.jsxs("div",{className:"text-center",children:[t.jsxs("h2",{className:"text-xl font-bold mb-2",children:[w.nickname,"  ."]}),t.jsx("p",{className:"text-gray-300 mb-4",children:"     ."}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${l/15*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:l})]}),t.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[t.jsx(z,{onClick:()=>g(1),colorScheme:"gray",className:"w-40 py-4 text-lg",children:""}),t.jsx(z,{onClick:()=>g(2),colorScheme:"gray",className:"w-40 py-4 text-lg",children:""})]})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2",children:"  "}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[S.nickname,"    ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6 animate-pulse",children:v?`${w.nickname}   ...`:"   ..."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]})};return t.jsx(be,{title:x(),windowId:"nigiri",children:j()})},An=Pn.memo(({amount:e,onAdjust:n,disabled:s})=>t.jsx(z,{onClick:()=>n(e),disabled:s,colorScheme:"gray",className:"w-full",children:e>0?`+${e}`:`${e}`})),Cy=e=>{const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,bids:o,biddingRound:c,captureBidDeadline:d,settings:u}=n,[p,m]=f.useState(1),[h,y]=f.useState(30),[b,v]=f.useState(!1),g=f.useRef(c),x=f.useRef(e);f.useEffect(()=>{x.current=e}),f.useEffect(()=>{c!==g.current&&(m(1),v(!1),g.current=c)},[c]);const j=s.id===a.id?i:a,w=o==null?void 0:o[s.id],S=o==null?void 0:o[j.id],C=typeof w=="number"&&typeof S=="number",k=f.useCallback(()=>{var O;const{onAction:E,session:I,currentUser:R}=x.current;typeof((O=I.bids)==null?void 0:O[R.id])=="number"||b||(v(!0),E({type:"UPDATE_CAPTURE_BID",payload:{gameId:r,bid:p}}),setTimeout(()=>v(!1),5e3))},[b,r,p]);f.useEffect(()=>{if(typeof w=="number"||!d){y(0);return}const E=setInterval(()=>{const I=Math.max(0,Math.ceil((d-Date.now())/1e3));y(I),I<=0&&clearInterval(E)},1e3);return()=>clearInterval(E)},[w,d]);const M=f.useCallback(E=>{typeof w!="number"&&m(I=>Math.max(1,Math.min(50,I+E)))},[w]),_=()=>{const E=u.captureTarget||20;if(C){const R=o[a.id],A=o[i.id];let O="";const B=R===A;let V,D;R>A?(V=a,D=R):A>R&&(V=i,D=A),V?O=`${V.nickname} ${D}   () .`:O=c===2?"  ,  .":", !";const L=B&&c===1?"   ...":"   ...";return t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-lg mb-6",children:[t.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[t.jsxs("p",{className:"text-gray-400 text-sm mb-1",children:[a.nickname," "]}),t.jsxs("p",{className:"text-3xl font-bold",children:[R,""]})]}),t.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[t.jsxs("p",{className:"text-gray-400 text-sm mb-1",children:[i.nickname," "]}),t.jsxs("p",{className:"text-3xl font-bold",children:[A,""]})]})]}),t.jsx("p",{className:"mt-4 text-xl",children:t.jsx("span",{className:"font-bold text-yellow-300",children:O})}),t.jsx("p",{className:"mt-6 text-sm text-gray-400 animate-pulse",children:L})]})}if(typeof w=="number")return t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[j.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]});const I=typeof w=="number";return t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-gray-300 mb-6",children:["  ",t.jsxs("span",{className:"font-bold text-yellow-300",children:[E,""]}),". ()         .       ."]}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${h/30*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:h})]}),t.jsxs("div",{className:"my-4",children:[t.jsxs("div",{className:"bg-gray-900/70 p-2 rounded-lg text-4xl font-bold text-yellow-300 mb-4 text-center",children:[E," + ",p,""]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-2",children:[t.jsx(An,{amount:10,onAdjust:M,disabled:I}),t.jsx(An,{amount:5,onAdjust:M,disabled:I}),t.jsx(An,{amount:3,onAdjust:M,disabled:I}),t.jsx(An,{amount:1,onAdjust:M,disabled:I})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsx(An,{amount:-10,onAdjust:M,disabled:I}),t.jsx(An,{amount:-5,onAdjust:M,disabled:I}),t.jsx(An,{amount:-3,onAdjust:M,disabled:I}),t.jsx(An,{amount:-1,onAdjust:M,disabled:I})]})]}),t.jsx(z,{onClick:k,disabled:b||I,className:"w-full py-3",children:b?" ...":""})]})};return t.jsx(be,{title:`  ${c===2?"()":""}`,windowId:"capture-bid",children:_()})},Iy=({session:e,currentUser:n,onAction:s})=>{const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,effectiveCaptureTargets:c,gameStatus:d,settings:u,preGameConfirmations:p,revealEndTime:m}=e,h=p==null?void 0:p[n.id],[y,b]=f.useState(10);if(f.useEffect(()=>{const _=m||Date.now()+1e4,E=setInterval(()=>{const I=Math.max(0,Math.ceil((_-Date.now())/1e3));b(I)},1e3);return()=>{clearInterval(E)}},[m]),!i||!o||!c)return null;const v=r.id===i?r:a,g=r.id===o?r:a,x=c[$.Black],j=c[$.White],w=d==="capture_tiebreaker",S=()=>{if(w)return{title:"   ()",description:"    , /  ."};const _=c[$.Black]-u.captureTarget;return{title:"  ",description:`${v.nickname} ${_}  () .`}},{title:C,description:k}=S(),M=({user:_,color:E,target:I})=>t.jsxs("div",{className:"flex flex-col items-center text-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:_.id,userName:_.nickname,size:80,className:`border-4 ${E===""?"border-gray-500":"border-gray-400"}`}),t.jsx("p",{className:"mt-3 text-xl font-bold",children:_.nickname}),t.jsxs("p",{className:"text-lg font-semibold text-gray-300",children:[E,E===""&&" ()"]}),t.jsxs("div",{className:"mt-2 text-sm bg-gray-800 px-3 py-1 rounded-full",children:[t.jsx("span",{className:"text-gray-400",children:" : "}),t.jsxs("span",{className:"font-bold text-yellow-300",children:[I,""]}),t.jsx("span",{className:"text-gray-400",children:" "})]})]});return t.jsx(be,{title:C,initialWidth:550,windowId:"capture-tiebreaker",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-6",children:k}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 my-6",children:[t.jsx(M,{user:v,color:"",target:x}),t.jsx(M,{user:g,color:"",target:j})]}),t.jsx(z,{onClick:()=>s({type:"CONFIRM_CAPTURE_REVEAL",payload:{gameId:l}}),disabled:!!h,className:"w-full py-3",children:h?"   ...":`  (${y})`})]})})},wi=["rock","paper","scissors"],ks={rock:{emoji:"",name:""},paper:{emoji:"",name:""},scissors:{emoji:"",name:""}},Ey=(e,n)=>e===n?"draw":e==="rock"&&n==="scissors"||e==="scissors"&&n==="paper"||e==="paper"&&n==="rock"?"p1":"p2",Py=e=>{const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,rpsState:o,gameStatus:c,mode:d,rpsRound:u}=n,[p,m]=f.useState(null),[h,y]=f.useState(30),b=f.useRef(e);f.useEffect(()=>{b.current=e});const v=s.id,g=v===a.id?i:a,x=o==null?void 0:o[v],j=f.useCallback(k=>{const{session:M,onAction:_,currentUser:E}=b.current,{id:I,rpsState:R}=M;R!=null&&R[E.id]||(m(k),_({type:"SUBMIT_RPS_CHOICE",payload:{gameId:I,choice:k}}))},[]);f.useEffect(()=>{(c==="dice_rps"||c==="thief_rps"||c==="alkkagi_rps"||c==="curling_rps"||c==="omok_rps"||c==="ttamok_rps")&&(m(null),y(30))},[c]),f.useEffect(()=>{if(!(!x&&!p&&(c==="dice_rps"||c==="thief_rps"||c==="alkkagi_rps"||c==="curling_rps"||c==="omok_rps"||c==="ttamok_rps")))return;const M=setInterval(()=>{y(_=>{if(_<=1){clearInterval(M);const E=wi[Math.floor(Math.random()*wi.length)];return j(E),0}return _-1})},1e3);return()=>clearInterval(M)},[x,p,c,j]);const w=()=>{switch(d){case T.Thief:return" !    .";case T.Alkkagi:case T.Curling:case T.Omok:case T.Ttamok:return" !     .";case T.Dice:default:return"    ."}},S=()=>` ${u?`(${u}/3)`:""}`,C=()=>{if(c.endsWith("_rps_reveal")){const M=o==null?void 0:o[a.id],_=o==null?void 0:o[i.id];if(M&&_){const E=Ey(M,_);let I="",R="";if(E==="draw")I=(u||1)>=3?"!  ...":"!  !",R="text-yellow-400";else if(v===a.id&&E==="p1"||v===i.id&&E==="p2"){let O="!";d===T.Dice&&(O="! ."),d===T.Thief&&(O="!   ."),(d===T.Alkkagi||d===T.Curling||d===T.Omok||d===T.Ttamok)&&n.turnChoices&&(O=`! ${n.turnChoices[v]==="first"?"":""} .`),I=O,R="text-green-400"}else{let O="!";d===T.Dice&&(O="! ."),d===T.Thief&&(O="!   ."),(d===T.Alkkagi||d===T.Curling||d===T.Omok||d===T.Ttamok)&&n.turnChoices&&(O=`!  ${n.turnChoices[g.id]==="first"?"":""} .`),I=O,R="text-red-400"}return t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"flex justify-around items-center mb-6",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-lg font-semibold",children:a.nickname}),t.jsx("span",{className:"text-7xl my-2",children:ks[M].emoji}),t.jsx("span",{className:"text-gray-300",children:ks[M].name})]}),t.jsx("span",{className:"text-4xl font-bold text-gray-500",children:"VS"}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-lg font-semibold",children:i.nickname}),t.jsx("span",{className:"text-7xl my-2",children:ks[_].emoji}),t.jsx("span",{className:"text-gray-300",children:ks[_].name})]})]}),t.jsx("h2",{className:`text-3xl font-bold animate-pulse ${R}`,children:I})]})}}return x||p?t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[g.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-4",children:w()}),u===3&&t.jsx("p",{className:"text-sm text-yellow-300 mb-4",children:"   !"}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${h/30*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:h})]}),t.jsx("div",{className:"flex justify-center gap-4 mt-4",children:wi.map(M=>t.jsx(z,{onClick:()=>j(M),colorScheme:"gray",className:"w-32 h-20 text-lg",children:t.jsxs("div",{className:"flex flex-col items-center justify-center",children:[t.jsx("span",{className:"text-3xl",children:ks[M].emoji}),t.jsx("span",{children:ks[M].name})]})},M))})]})};return t.jsx(be,{title:S(),windowId:"rps-minigame",children:C()})},My=e=>{const{session:n,currentUser:s}=e,{player1:l,player2:r,roleChoices:a}=n,[i,o]=f.useState(null),[c,d]=f.useState(10),u=f.useRef(e);f.useEffect(()=>{u.current=e});const p=s.id,m=p===l.id?r:l,h=a==null?void 0:a[p],y=f.useCallback(v=>{var S;const{session:g,onAction:x,currentUser:j}=u.current;(S=g.roleChoices)!=null&&S[j.id]||(o(v),x({type:"THIEF_UPDATE_ROLE_CHOICE",payload:{gameId:g.id,choice:v}}))},[]);f.useEffect(()=>{if(h||i)return;const v=setInterval(()=>{d(g=>g<=1?(clearInterval(v),0):g-1)},1e3);return()=>clearInterval(v)},[h,i,y]);const b=()=>h||i?t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[m.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6",children:"  .    ."}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${c*10}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:c})]}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsx(z,{onClick:()=>y("thief"),colorScheme:"yellow",className:"w-full py-4 text-lg",children:" "}),t.jsx(z,{onClick:()=>y("police"),colorScheme:"blue",className:"w-full py-4 text-lg",children:" "})]})]});return t.jsx(be,{title:" ",windowId:"thief-role-selection",children:b()})},Ty=({session:e,currentUser:n,onAction:s})=>{var _,E,I,R,A,O;const{id:l,player1:r,player2:a,thiefPlayerId:i,policePlayerId:o,preGameConfirmations:c,revealEndTime:d,rpsState:u,turnChoices:p}=e,m=!!(c!=null&&c[n.id]),[h,y]=f.useState(10);if(f.useEffect(()=>{const B=d||Date.now()+1e4,V=setInterval(()=>{const D=Math.max(0,Math.ceil((B-Date.now())/1e3));y(D)},1e3);return()=>clearInterval(V)},[d]),!i||!o)return null;const b=r.id===i?r:a,v=r.id===o?r:a,g=(_=Me.find(B=>B.id===b.avatarId))==null?void 0:_.url,x=(E=Re.find(B=>B.id===b.borderId))==null?void 0:E.url,j=(I=Me.find(B=>B.id===v.avatarId))==null?void 0:I.url,w=(R=Re.find(B=>B.id===v.borderId))==null?void 0:R.url;let S=" .";const C=(A=e.roleChoices)==null?void 0:A[n.id],k=n.id===r.id?a.id:r.id,M=(O=e.roleChoices)==null?void 0:O[k];return C===M&&(S=` , ${b.id===n.id?"":""}  .`),t.jsx(be,{title:"  ",initialWidth:600,windowId:"thief-role-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:S}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,size:64,avatarUrl:g,borderUrl:x}),t.jsx("p",{className:"mt-2 font-bold",children:b.nickname}),t.jsx("p",{className:"font-semibold px-2 py-0.5 rounded-full text-sm my-1 bg-yellow-600 text-black",children:"  ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:v.id,userName:v.nickname,size:64,avatarUrl:j,borderUrl:w}),t.jsx("p",{className:"mt-2 font-bold",children:v.nickname}),t.jsx("p",{className:"font-semibold px-2 py-0.5 rounded-full text-sm my-1 bg-blue-600 text-white",children:"  ()"})]})]}),t.jsx(z,{onClick:()=>s({type:"CONFIRM_THIEF_ROLE",payload:{gameId:l}}),disabled:!!m,className:"w-full py-3 mt-6",children:m?"   ...":`  (${h})`})]})})},_y=e=>{const{session:n,currentUser:s}=e,{player1:l,player2:r,turnChoices:a,turnChoiceDeadline:i}=n,[o,c]=f.useState(null),[d,u]=f.useState(30),p=f.useRef(e);f.useEffect(()=>{p.current=e});const m=s.id,h=m===l.id?r:l,y=a==null?void 0:a[m],b=f.useCallback(g=>{var C;const{session:x,onAction:j,currentUser:w}=p.current;(C=x.turnChoices)!=null&&C[w.id]||(c(g),j({type:"CHOOSE_TURN_PREFERENCE",payload:{gameId:x.id,choice:g}}))},[]);f.useEffect(()=>{if(y||o||!i)return;const g=setInterval(()=>{const x=Math.max(0,Math.ceil((i-Date.now())/1e3));u(x),x<=0&&clearInterval(g)},1e3);return()=>clearInterval(g)},[y,o,i]);const v=()=>y||o?t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[h.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6",children:"  .    ."}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${d/30*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:d})]}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsx(z,{onClick:()=>b("first"),colorScheme:"blue",className:"w-full py-4 text-lg",children:" ()"}),t.jsx(z,{onClick:()=>b("second"),colorScheme:"gray",className:"w-full py-4 text-lg",children:" ()"})]})]});return t.jsx(be,{title:" ",windowId:"turn-preference-selection",children:v()})},Ay=({session:e,currentUser:n,onConfirm:s})=>{var r;const l=(r=e.noContestInitiatorIds)==null?void 0:r.includes(n.id);return t.jsx(be,{title:" ",onClose:s,initialWidth:450,windowId:"no-contest",children:t.jsxs("div",{className:"text-white",children:[t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg mb-6 text-center",children:[t.jsxs("p",{className:"text-lg",children:["10       ",t.jsx("br",{}),"   ."]}),l&&t.jsx("p",{className:"text-sm text-red-400 mt-3",children:":     ,    ."})]}),t.jsx(z,{onClick:s,className:"w-full py-3",children:""})]})})},Pu=(e,n)=>{var r,a;const s=(r=Me.find(i=>i.id===n.avatarId))==null?void 0:r.url,l=(a=Re.find(i=>i.id===n.borderId))==null?void 0:a.url;return t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:n.id,userName:n.nickname,size:80,avatarUrl:s,borderUrl:l}),t.jsx("p",{className:"mt-2 font-bold text-lg",children:n.nickname}),t.jsx("p",{className:`px-2 py-0.5 rounded-full text-sm font-semibold my-2 ${e.role==="thief"?"bg-yellow-600 text-black":"bg-blue-600 text-white"}`,children:e.role==="thief"?" ":" "}),t.jsxs("div",{className:"text-left text-sm space-y-1 w-full",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold",children:[e.roundScore," ",e.role==="thief"?" ":" "]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-mono text-xl text-yellow-300",children:[e.cumulativeScore,""]})]})]})]})},Ry=({session:e,currentUser:n,onAction:s})=>{const{id:l,player1:r,player2:a,thiefRoundSummary:i,roundEndConfirmations:o,revealEndTime:c}=e,[d,u]=f.useState(20),p=!!(o!=null&&o[n.id]);if(f.useEffect(()=>{const x=c||Date.now()+2e4,j=setInterval(()=>{const w=Math.max(0,Math.ceil((x-Date.now())/1e3));u(w)},1e3);return()=>{clearInterval(j)}},[c]),!i)return null;const{round:m,isDeathmatch:h,player1:y,player2:b}=i,v=h?` ${m-2} `:`${m}  `;let g="";return h?g="  ,     .":m<2?g="     .":g="2  .     .",t.jsx(be,{title:v,initialWidth:550,windowId:"thief-round-summary",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-6",children:g}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 my-6",children:[Pu(y,r),Pu(b,a)]}),t.jsx(z,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:p,className:"w-full py-3",children:p?"   ...":`   (${d})`})]})})},By=({session:e,currentUser:n,onAction:s})=>{var D,L,q,U;const{id:l,curlingRoundSummary:r,player1:a,player2:i,blackPlayerId:o,whitePlayerId:c,roundEndConfirmations:d}=e,[u,p]=f.useState(20),m=!!(d!=null&&d[n.id]);if(f.useEffect(()=>{const W=e.revealEndTime||Date.now()+2e4,H=setInterval(()=>{const te=Math.max(0,Math.ceil((W-Date.now())/1e3));p(te)},1e3);return()=>clearInterval(H)},[e.revealEndTime]),!r)return null;const h=o===a.id?a:i,y=c===a.id?a:i,b=(D=Me.find(W=>W.id===h.avatarId))==null?void 0:D.url,v=(L=Re.find(W=>W.id===h.borderId))==null?void 0:L.url,g=(q=Me.find(W=>W.id===y.avatarId))==null?void 0:q.url,x=(U=Re.find(W=>W.id===y.borderId))==null?void 0:U.url,{round:j,black:w,white:S,cumulativeScores:C,stonesState:k,scoredStones:M}=r,E=(n.id===o?$.Black:$.White)===$.White,I=e.settings.curlingRounds||3,R=840,A={x:R/2,y:R/2},O=R/19,B=[O*6,O*4,O*2,O*.5],V=["rgba(0, 100, 255, 0.2)","rgba(255, 255, 255, 0.2)","rgba(255, 0, 0, 0.2)","white"];return t.jsx(be,{title:`${j}  `,initialWidth:900,windowId:"curling-round-summary",children:t.jsxs("div",{className:"text-white flex flex-col md:flex-row gap-4",children:[t.jsxs("div",{className:"w-full md:w-1/2 flex flex-col items-center flex-shrink-0",children:[t.jsx("h3",{className:"text-xl font-bold mb-2",children:"  "}),t.jsx("div",{className:`w-full aspect-square bg-gray-700 rounded-lg overflow-hidden border-2 border-gray-600 transition-transform duration-500 ${E?"rotate-180":""}`,children:t.jsxs("svg",{viewBox:`0 0 ${R} ${R}`,className:"w-full h-full bg-[#DDAA77]",children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"gloss-curling-summary-1",children:[t.jsx("stop",{offset:"10%",stopColor:"#333"}),t.jsx("stop",{offset:"95%",stopColor:"#000"})]}),t.jsxs("radialGradient",{id:"gloss-curling-summary-2",children:[t.jsx("stop",{offset:"10%",stopColor:"#fff"}),t.jsx("stop",{offset:"95%",stopColor:"#ccc"})]}),t.jsxs("filter",{id:"glow-effect",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),B.map((W,H)=>t.jsx("circle",{cx:A.x,cy:A.y,r:W,fill:V[H]},H)),k.map(W=>{if(!W.onBoard)return null;const H=M[W.id];return t.jsxs("g",{children:[t.jsx("circle",{cx:W.x,cy:W.y,r:W.radius,fill:W.player===$.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:W.x,cy:W.y,r:W.radius,fill:`url(#gloss-curling-summary-${W.player})`}),H&&t.jsxs("g",{style:{pointerEvents:"none"},transform:E?`rotate(180, ${W.x}, ${W.y})`:void 0,children:[t.jsx("circle",{cx:W.x,cy:W.y,r:W.radius,fill:"none",stroke:W.player===$.Black?"#67e8f9":"#facc15",strokeWidth:"5",filter:"url(#glow-effect)"}),t.jsxs("text",{x:W.x,y:W.y,textAnchor:"middle",dy:".35em",fontSize:W.radius*.9,fontWeight:"bold",fill:W.player===$.Black?"white":"black",stroke:"rgba(0,0,0,0.5)",strokeWidth:"0.5px",children:["+",H]})]})]},W.id)})]})})]}),t.jsxs("div",{className:"w-full md:w-1/2 flex-grow flex flex-col justify-center",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-2 my-2",children:[t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(Ce,{userId:h.id,userName:h.nickname,size:48,avatarUrl:b,borderUrl:v}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold",children:h.nickname}),t.jsx("p",{className:"text-sm text-gray-400",children:""})]})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[w.houseScore,""]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[w.knockoutScore,""]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-2 mt-2 text-base",children:[t.jsx("strong",{children:" :"})," ",t.jsxs("strong",{className:"text-yellow-300",children:[w.total,""]})]})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:48,avatarUrl:g,borderUrl:x}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold",children:y.nickname}),t.jsx("p",{className:"text-sm text-gray-400",children:""})]})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[S.houseScore,""]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[S.knockoutScore,""]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-2 mt-2 text-base",children:[t.jsx("strong",{children:" :"})," ",t.jsxs("strong",{className:"text-yellow-300",children:[S.total,""]})]})]})]})]}),t.jsxs("div",{className:"text-center bg-gray-700/50 p-3 rounded-lg mt-4",children:[t.jsx("p",{className:"text-lg font-bold",children:" "}),t.jsxs("p",{className:"text-2xl font-mono",children:[t.jsxs("span",{children:[" ",C[$.Black]]}),t.jsx("span",{className:"mx-4 text-gray-400",children:":"}),t.jsxs("span",{children:[" ",C[$.White]]})]})]}),t.jsx(z,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:!!m,className:"w-full mt-6 py-3",children:m?"   ...":`${j>=I?"  ":"  "} (${u})`})]})]})})},Ly=({session:e,currentUser:n,onAction:s})=>{var _,E,I,R;const{id:l,player1:r,player2:a,diceRoundSummary:i,roundEndConfirmations:o,revealEndTime:c}=e,[d,u]=f.useState(20),p=!!(o!=null&&o[n.id]);if(f.useEffect(()=>{const A=c||Date.now()+2e4,O=setInterval(()=>{const B=Math.max(0,Math.ceil((A-Date.now())/1e3));u(B)},1e3);return()=>{clearInterval(O)}},[c]),!i)return null;const{round:m,scores:h,diceStats:y}=i,b=h[r.id]||0,v=h[a.id]||0,g=(_=Me.find(A=>A.id===r.avatarId))==null?void 0:_.url,x=(E=Re.find(A=>A.id===r.borderId))==null?void 0:E.url,j=(I=Me.find(A=>A.id===a.avatarId))==null?void 0:I.url,w=(R=Re.find(A=>A.id===a.borderId))==null?void 0:R.url,S=A=>{if(!y||!y[A])return null;const O=y[A];return O.totalRolls===0?t.jsx("p",{className:"text-sm text-gray-400",children:"  ."}):t.jsx("div",{className:"grid grid-cols-3 gap-x-4 gap-y-1 text-xs",children:Array.from({length:6},(B,V)=>V+1).map(B=>{const V=O.rolls[B]||0,D=(V/O.totalRolls*100).toFixed(0);return t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:[B,":"]}),t.jsxs("span",{className:"font-mono",children:[V," (",D,"%)"]})]},B)})})},C=i.round>=(e.settings.diceGoRounds??3),k=b===v;let M=`   (${d})`;return C&&(k?M=`  (${d})`:M=`   (${d})`),p&&(M="   ..."),t.jsx(be,{title:`${m}   `,initialWidth:650,windowId:"dice-round-summary",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-6",children:"    ."}),t.jsxs("div",{className:"flex justify-around items-center my-6",children:[t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:r.id,userName:r.nickname,size:96,avatarUrl:g,borderUrl:x}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:r.nickname})]}),t.jsxs("span",{className:"text-4xl font-mono text-gray-300",children:[b," : ",v]}),t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:a.id,userName:a.nickname,size:96,avatarUrl:j,borderUrl:w}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:a.nickname})]})]}),y&&t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg my-6",children:[t.jsx("h3",{className:"text-lg font-bold text-center text-gray-200 mb-3",children:"1  "}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-gray-800/60 p-3 rounded",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:r.nickname}),S(r.id)]}),t.jsxs("div",{className:"bg-gray-800/60 p-3 rounded",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:a.nickname}),S(a.id)]})]})]}),t.jsx(z,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:!!p,className:"w-full py-3",children:M})]})})},$y=({session:e,currentUser:n,onAction:s})=>{const{basePlacementDeadline:l,settings:r,player1:a,baseStones_p1:i,baseStones_p2:o}=e,c=r.baseStones||4,d=n.id===a.id?i:o,u=(d==null?void 0:d.length)||0,p=u>=c,[m,h]=f.useState(30);return f.useEffect(()=>{if(!l)return;const y=setInterval(()=>{const b=Math.max(0,Math.ceil((l-Date.now())/1e3));h(b)},1e3);return()=>clearInterval(y)},[l]),t.jsx(be,{title:" ",windowId:"base-placement",initialWidth:300,modal:!1,children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-200",children:"    ."}),t.jsxs("p",{className:"text-lg font-bold my-2",children:["(",u,"/",c,")"]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 my-3 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${m/30*100}%`,transition:"width 0.5s linear"}})}),t.jsx("div",{className:"text-5xl font-mono font-bold mt-1 text-white",children:m}),!p&&t.jsx(z,{onClick:()=>s({type:"PLACE_REMAINING_BASE_STONES_RANDOMLY"}),colorScheme:"yellow",className:"w-full mt-4 !text-sm !py-2",children:"   "}),p&&t.jsx("p",{className:"text-sm text-green-400 animate-pulse mt-4",children:" !  ..."})]})})},Oy=({session:e})=>{const{baseStones_p1:n,baseStones_p2:s,settings:{boardSize:l}}=e,r=[...(n||[]).map(m=>({...m,player:$.Black})),...(s||[]).map(m=>({...m,player:$.White}))],a=250,i=a/l,o=i/2,c=i*.47,d=c*2*.7,u=d/2,p=m=>({cx:o+m.x*i,cy:o+m.y*i});return t.jsxs("svg",{viewBox:`0 0 ${a} ${a}`,className:"w-full h-full bg-[#e0b484] rounded-md shadow-inner",children:[Array.from({length:l}).map((m,h)=>t.jsxs("g",{children:[t.jsx("line",{x1:o+h*i,y1:o,x2:o+h*i,y2:a-o,stroke:"#54432a",strokeWidth:"1"}),t.jsx("line",{x1:o,y1:o+h*i,x2:a-o,y2:o+h*i,stroke:"#54432a",strokeWidth:"1"})]},h)),r.map((m,h)=>{const{cx:y,cy:b}=p(m);return t.jsxs("g",{children:[t.jsx("circle",{cx:y,cy:b,r:c,fill:m.player===$.Black?"#111827":"#f5f2e8"}),t.jsx("image",{href:m.player===$.Black?Da:Oa,x:y-u,y:b-u,width:d,height:d})]},`base-stone-${h}`)})]})},Rn=Pn.memo(({amount:e,onAdjust:n,disabled:s})=>t.jsx(z,{onClick:()=>n(e),disabled:s,colorScheme:"gray",className:"w-full !py-1",children:e>0?`+${e}`:`${e}`})),Dy=e=>{const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,komiBids:o,komiBiddingDeadline:c,gameStatus:d,komiBiddingRound:u}=n,[p,m]=f.useState($.Black),[h,y]=f.useState(0),[b,v]=f.useState(30),[g,x]=f.useState(!1),j=f.useRef(e);f.useEffect(()=>{j.current=e});const w=s.id===a.id?i:a,S=o==null?void 0:o[s.id],C=w?o==null?void 0:o[w.id]:void 0,k=f.useCallback(()=>{var L;const{session:A,onAction:O,currentUser:B}=j.current;if(((L=A.komiBids)==null?void 0:L[B.id])||g||p===$.None)return;x(!0);const D={color:p,komi:h};O({type:"UPDATE_KOMI_BID",payload:{gameId:A.id,bid:D}}),setTimeout(()=>x(!1),5e3)},[g,p,h]);f.useEffect(()=>{m($.Black),y(0)},[u]),f.useEffect(()=>{if(S||!c){v(S?0:30);return}const A=setInterval(()=>{const O=Math.max(0,Math.ceil((c-Date.now())/1e3));v(O),O<=0&&k()},1e3);return()=>clearInterval(A)},[S,c,k]);const M=A=>{y(O=>Math.max(0,Math.min(100,O+A)))},_=()=>{if(!S||!C||!w)return t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:"  ..."}),t.jsx("p",{className:"text-gray-400 animate-pulse",children:"  ."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-gray-100"})})]});let A="";const O=S.color===C.color&&S.komi===C.komi;S.color!==C.color?A="   ,    . ( 0.5)":S.komi!==C.komi?A="  ,      .":u===1?A="   , 2   .":A="2    , /  .";const B=O&&u===1?"   ...":"   ...";return t.jsxs("div",{className:"text-center",children:[t.jsxs("h3",{className:"text-lg font-bold mb-2",children:["   ",u===2&&"()"]}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-md space-y-2 text-sm",children:[t.jsxs("div",{children:[s.nickname,": ",t.jsxs("span",{className:"font-bold",children:[S.color===$.Black?"":"",", ",S.komi,""]})]}),t.jsxs("div",{children:[w.nickname,": ",t.jsxs("span",{className:"font-bold",children:[C.color===$.Black?"":"",", ",C.komi,""]})]})]}),t.jsx("p",{className:"mt-4 text-xs text-yellow-300",children:A}),t.jsx("p",{className:"mt-4 text-sm text-gray-400 animate-pulse",children:B})]})};if(d==="komi_bid_reveal")return t.jsx(be,{title:"  ",windowId:"komi-bidding",children:_()});if(S)return t.jsx(be,{title:" ",windowId:"komi-bidding",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:" !"}),t.jsx("p",{className:"text-gray-400 animate-pulse",children:"   ..."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-gray-100"})})]})});const E=.5,I=()=>{if(p===$.Black)return` ,   ${h+E} .`;{const A=E-h;return A>=0?` ,   ${A} .`:` ,    ${Math.abs(A)} .`}},R=!!S;return t.jsx(be,{title:`  ${u===2?"()":""}`,windowId:"komi-bidding",initialWidth:650,children:t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col",children:[t.jsx("p",{className:"text-center text-sm text-gray-400 mb-2",children:" "}),t.jsx("div",{className:"aspect-square",children:t.jsx(Oy,{session:n})}),t.jsx("p",{className:"text-center text-xs text-gray-400 mt-1",children:"(P1: , P2:  )"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col justify-between",children:[t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:["       . ( :  ",E,")"]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5 my-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-1.5 rounded-full",style:{width:`${b/30*100}%`,transition:"width 0.5s linear"}})}),t.jsx("div",{className:"text-3xl font-mono font-bold text-center text-white",children:b}),t.jsxs("div",{className:"flex justify-center gap-4 my-4",children:[t.jsx(z,{onClick:()=>m($.Black),disabled:R,colorScheme:p===$.Black?"blue":"gray",className:"w-24",children:""}),t.jsx(z,{onClick:()=>m($.White),disabled:R,colorScheme:p===$.White?"blue":"gray",className:"w-24",children:""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"   (0~100)"}),t.jsxs("div",{className:"bg-gray-900/70 p-2 rounded-lg text-2xl font-bold text-yellow-300 mb-2",children:[h,""]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-2",children:[t.jsx(Rn,{amount:10,onAdjust:M,disabled:R}),t.jsx(Rn,{amount:5,onAdjust:M,disabled:R}),t.jsx(Rn,{amount:3,onAdjust:M,disabled:R}),t.jsx(Rn,{amount:1,onAdjust:M,disabled:R})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsx(Rn,{amount:-10,onAdjust:M,disabled:R}),t.jsx(Rn,{amount:-5,onAdjust:M,disabled:R}),t.jsx(Rn,{amount:-3,onAdjust:M,disabled:R}),t.jsx(Rn,{amount:-1,onAdjust:M,disabled:R})]})]}),t.jsx("p",{className:"text-xs text-gray-400 text-center mt-3 h-8",children:I()})]}),t.jsx(z,{onClick:k,disabled:R||g,className:"w-full mt-auto",children:R?" ":"  "})]})]})})},qy=({session:e,currentUser:n})=>{const{alkkagiPlacementDeadline:s,settings:l,player1:r,alkkagiStones:a,alkkagiStones_p1:i,alkkagiStones_p2:o,alkkagiStonesPlacedThisRound:c,blackPlayerId:d}=e,u=l.alkkagiStoneCount||5,p=(c==null?void 0:c[n.id])||0,m=u,h=(e.alkkagiRound||1)>1?`  (${e.alkkagiRound} )`:"  ",y=p>=m,[b,v]=f.useState(30);return f.useEffect(()=>{if(!s)return;const g=setInterval(()=>{const x=Math.max(0,Math.ceil((s-Date.now())/1e3));v(x)},1e3);return()=>clearInterval(g)},[s]),t.jsx(be,{title:h,windowId:"alkkagi-placement",initialWidth:300,modal:!1,children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-200",children:(e.alkkagiRound||1)>1?"  .":"    ."}),t.jsxs("p",{className:"text-lg font-bold my-2",children:["(",p,"/",m,")"]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 my-3 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${b/30*100}%`,transition:"width 0.5s linear"}})}),t.jsx("div",{className:"text-5xl font-mono font-bold mt-1 text-white",children:b}),y&&t.jsx("p",{className:"text-sm text-green-400 animate-pulse mt-4",children:" !  ..."})]})})},Mu="preferredGameSettings",$e=({label:e,children:n,className:s})=>t.jsxs("div",{className:`grid grid-cols-2 gap-4 items-center ${s}`,children:[t.jsx("label",{className:"font-semibold text-gray-300",children:e}),n]}),Uy=({deadline:e})=>{const[n,s]=f.useState(()=>Math.max(0,Math.ceil((e-Date.now())/1e3)));return f.useEffect(()=>{s(Math.max(0,Math.ceil((e-Date.now())/1e3)));const l=setInterval(()=>{s(r=>{const a=Math.max(0,Math.ceil((e-Date.now())/1e3));return r!==a?a:r})},1e3);return()=>clearInterval(l)},[e]),t.jsxs("span",{children:["(",n,")"]})},zy=e=>{var we;const{negotiation:n,currentUser:s,onAction:l,onlineUsers:r,isTopmost:a}=e,[i,o]=f.useState(n.settings),c=f.useRef(!1),d=n.proposerId===s.id,u=n.status==="pending",m=n.status==="draft"&&d,h=u&&d,y=u&&!d,b=f.useMemo(()=>{const P=n.challenger.id===s.id?n.opponent:n.challenger;return P.id===el?P:r.find(ae=>ae.id===P.id)||P},[n.challenger,n.opponent,s.id,r]),v=b.id===el,g=f.useCallback(()=>{l({type:"DECLINE_NEGOTIATION",payload:{negotiationId:n.id}})},[l,n.id]);f.useEffect(()=>{let P;if(m){P={...Yd,...n.settings};try{const oe=`${Mu}_${n.mode}`,ue=localStorage.getItem(oe);if(ue){const se=JSON.parse(ue);if(n.mode===T.Alkkagi){const ge=No.map(je=>je.value);se.alkkagiGaugeSpeed&&!ge.includes(se.alkkagiGaugeSpeed)&&delete se.alkkagiGaugeSpeed,se.alkkagiStoneCount&&!Zd.includes(se.alkkagiStoneCount)&&delete se.alkkagiStoneCount}if(n.mode===T.Curling){const ge=So.map(je=>je.value);se.curlingGaugeSpeed&&!ge.includes(se.curlingGaugeSpeed)&&delete se.curlingGaugeSpeed,se.curlingStoneCount&&!tu.includes(se.curlingStoneCount)&&delete se.curlingStoneCount}se.baseStones&&!bi.includes(se.baseStones)&&delete se.baseStones,P={...P,...se}}}catch(oe){console.error("Failed to load or parse preferred settings",oe)}}else P={...Yd,...n.settings};n.mode===T.Base&&(P.komi=.5),v&&!P.player1Color&&(P.player1Color=$.Black);const ae=(oe=>{switch(oe){case T.Omok:case T.Ttamok:return Od;case T.Capture:return Dd;case T.Speed:return qd;case T.Hidden:return Ud;case T.Thief:return zd;case T.Missile:return Fd;case T.Alkkagi:case T.Curling:case T.Dice:return[19];default:return $d}})(n.mode);if(ae.includes(P.boardSize)||(P.boardSize=ae[0]),P.mixedModes){const oe=P.mixedModes.includes(T.Base),ue=P.mixedModes.includes(T.Capture);oe&&ue&&(P.mixedModes=P.mixedModes.filter(se=>se!==T.Base))}o(P),c.current=!1},[n.id,n.turnCount]),f.useEffect(()=>{h&&!c.current&&(Ee.myTurn(),c.current=!0)},[h]);const x=f.useMemo(()=>{var me;const P=Ye.some(Se=>Se.mode===n.mode),Y=P?b.strategyLevel:b.playfulLevel,ae=(me=b.stats)==null?void 0:me[n.mode],oe=(ae==null?void 0:ae.wins)??0,ue=(ae==null?void 0:ae.losses)??0,se=b.mannerScore??200,ge=oe+ue,je=ge>0?Math.round(oe/ge*100):0;return{level:Y,levelLabel:P?"":"",wins:oe,losses:ue,mannerScore:se,winRate:je}},[b,n.mode]),j=f.useMemo(()=>{var P;return(P=Me.find(Y=>Y.id===b.avatarId))==null?void 0:P.url},[b.avatarId]),w=f.useMemo(()=>{var P;return(P=Re.find(Y=>Y.id===b.borderId))==null?void 0:P.url},[b.borderId]),S=f.useMemo(()=>Ye.some(P=>P.mode===n.mode)?nu:rt.some(P=>P.mode===n.mode)?y0:nu,[n.mode]),C=f.useMemo(()=>JSON.stringify(i)!==JSON.stringify(n.settings),[i,n.settings]),k=f.useCallback((P,Y)=>o(ae=>({...ae,[P]:Y})),[]),M=(P,Y)=>o(ae=>({...ae,mixedModes:Y?[...ae.mixedModes||[],P]:(ae.mixedModes||[]).filter(oe=>oe!==P)})),_=f.useCallback(P=>{try{const Y=`${Mu}_${n.mode}`;localStorage.setItem(Y,JSON.stringify(i))}catch(Y){console.error("Failed to save preferred settings",Y)}l(P)},[l,i,n.mode]),E=()=>l({type:"ACCEPT_NEGOTIATION",payload:{negotiationId:n.id,settings:i}}),I=()=>l({type:"UPDATE_NEGOTIATION",payload:{negotiationId:n.id,settings:i}}),R=()=>_({type:"SEND_CHALLENGE",payload:{negotiationId:n.id,settings:i}}),A=()=>_({type:"START_AI_GAME",payload:{mode:n.mode,settings:i}}),O=f.useMemo(()=>v?`${n.mode} AI  `:n.rematchOfGameId?`  (${n.mode})`:`  (${n.mode})`,[n.mode,n.rematchOfGameId,v]),B=s.actionPoints.current>=S,V=()=>{const P="flex-1";if(v)return t.jsxs("div",{className:"flex justify-end gap-4",children:[t.jsx(z,{onClick:g,colorScheme:"red",className:P,children:""}),t.jsxs(z,{onClick:A,colorScheme:"green",className:P,disabled:!B,children:[" ",B?`(${S})`:"()"]})]});if(m){const Y=n.mode===T.Mix&&(!i.mixedModes||i.mixedModes.length<2);return t.jsxs("div",{className:"flex justify-between items-center gap-4",children:[t.jsx(z,{onClick:g,colorScheme:"red",className:P,children:""}),t.jsxs(z,{onClick:R,disabled:Y||!B,colorScheme:"green",className:P,children:["  ",B?`(${S})`:"()"]})]})}return h?t.jsxs("div",{className:"flex justify-between items-center gap-4",children:[t.jsx(z,{onClick:g,colorScheme:"red",className:P,children:""}),t.jsx(z,{onClick:I,disabled:!C,colorScheme:"yellow",className:P,children:" "}),t.jsxs(z,{onClick:E,disabled:C||!B,colorScheme:"green",className:P,children:[" ",B?`(${S})`:"()"]})]}):null},D=y||!d,L=()=>v?"AI   .":m?"   [ ]  .":h?"  []  [ ].":y?`(${b.nickname})   ...`:"  ...",q=({value:P,onChange:Y,children:ae,disabled:oe})=>t.jsx("select",{value:P,onChange:ue=>Y(ue.target.value),disabled:oe,className:"w-full bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5",children:ae}),{mode:U}=n,W=![T.Alkkagi,T.Curling,T.Dice].includes(U),H=![T.Capture,T.Omok,T.Ttamok,T.Alkkagi,T.Curling,T.Dice,T.Thief,T.Base].includes(U),te=![T.Alkkagi,T.Curling,T.Dice,T.Thief].includes(U),le=U===T.Speed||U===T.Mix&&!!((we=i.mixedModes)!=null&&we.includes(T.Speed)),ce=U===T.Capture,ve=U===T.Ttamok,F=U===T.Omok||U===T.Ttamok,X=U===T.Base,ee=U===T.Hidden,xe=U===T.Missile,Q=U===T.Mix,G=U===T.Dice,K=U===T.Alkkagi,Z=U===T.Curling,fe=v;return t.jsx(be,{title:O,windowId:"negotiation",onClose:g,initialWidth:600,closeOnOutsideClick:!1,isTopmost:a,children:t.jsxs("div",{onMouseDown:P=>P.stopPropagation(),className:"text-sm",children:[t.jsxs("p",{className:"text-center text-yellow-300 mb-4",children:[L()," ",t.jsx(Uy,{deadline:n.deadline})]}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx("div",{className:"bg-gray-900/50 p-2 md:p-4 rounded-lg border border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,avatarUrl:j,borderUrl:w,size:48}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("h3",{className:"text-xl font-bold",children:b.nickname}),t.jsxs("p",{className:"text-sm text-gray-400",children:[x.levelLabel," Lv.",x.level]})]}),t.jsxs("div",{className:"text-right text-sm",children:[t.jsxs("p",{className:"font-semibold",children:[x.wins," ",x.losses," (",x.winRate,"%)"]}),t.jsxs("p",{className:"text-gray-300",children:[": ",x.mannerScore,""]})]})]})}),t.jsxs("div",{className:"space-y-3 max-h-[calc(60vh - 12rem)] overflow-y-auto pr-2",children:[W&&t.jsx($e,{label:" ",children:t.jsx(q,{value:i.boardSize,onChange:P=>k("boardSize",parseInt(P,10)),disabled:D,children:(n.mode===T.Omok||n.mode===T.Ttamok?Od:n.mode===T.Capture?Dd:n.mode===T.Speed?qd:n.mode===T.Hidden?Ud:n.mode===T.Thief?zd:n.mode===T.Missile?Fd:$d).map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),H&&t.jsx($e,{label:" ()",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"number",step:"1",value:Math.floor(i.komi),onChange:P=>k("komi",parseInt(P.target.value,10)+.5),disabled:D,className:"w-full bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5"}),t.jsx("span",{className:"font-bold text-lg text-gray-300 whitespace-nowrap",children:".5 "})]})}),fe&&(n.mode===T.Thief?t.jsx($e,{label:" ",children:t.jsxs(q,{value:i.player1Color,onChange:P=>k("player1Color",parseInt(P,10)),disabled:D,children:[t.jsx("option",{value:$.Black,children:"()"}),t.jsx("option",{value:$.White,children:"()"})]})}):t.jsx($e,{label:"  ",children:t.jsxs(q,{value:i.player1Color,onChange:P=>k("player1Color",parseInt(P,10)),disabled:D,children:[t.jsx("option",{value:$.Black,children:""}),t.jsx("option",{value:$.White,children:""})]})})),te&&(le?t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx(q,{value:i.timeLimit,onChange:P=>k("timeLimit",parseInt(P)),disabled:D,children:Gh.map(P=>t.jsx("option",{value:P.value,children:P.label},P.value))})}),t.jsxs($e,{label:" ",children:[" ",t.jsxs("p",{className:"text-sm text-gray-300",children:[Vh," ( )"]})," "]})]}):t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx(q,{value:i.timeLimit,onChange:P=>k("timeLimit",parseInt(P)),disabled:D,children:Fh.map(P=>t.jsx("option",{value:P.value,children:P.label},P.value))})}),t.jsx($e,{label:"",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(q,{value:i.byoyomiTime,onChange:P=>k("byoyomiTime",parseInt(P)),disabled:D,children:Hh.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))}),t.jsx(q,{value:i.byoyomiCount,onChange:P=>k("byoyomiCount",parseInt(P)),disabled:D,children:Wh.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})]})})]})),G&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx(q,{value:i.diceGoRounds??3,onChange:P=>k("diceGoRounds",parseInt(P,10)),disabled:D,children:[1,2,3].map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.oddDiceCount??1,onChange:P=>k("oddDiceCount",parseInt(P,10)),disabled:D,children:Kd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.evenDiceCount??1,onChange:P=>k("evenDiceCount",parseInt(P,10)),disabled:D,children:Kd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})})]}),ce&&t.jsx($e,{label:" ",children:t.jsx(q,{value:i.captureTarget,onChange:P=>k("captureTarget",parseInt(P)),disabled:D,children:Gd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),ve&&t.jsx($e,{label:" ",children:t.jsx(q,{value:i.captureTarget,onChange:P=>k("captureTarget",parseInt(P)),disabled:D,children:zh.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),F&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx("input",{type:"checkbox",checked:i.has33Forbidden,onChange:P=>k("has33Forbidden",P.target.checked),disabled:D,className:"w-5 h-5"})}),t.jsx($e,{label:" ",children:t.jsx("input",{type:"checkbox",checked:i.hasOverlineForbidden,onChange:P=>k("hasOverlineForbidden",P.target.checked),disabled:D,className:"w-5 h-5"})})]}),X&&t.jsx($e,{label:" ",children:t.jsx(q,{value:i.baseStones,onChange:P=>k("baseStones",parseInt(P)),disabled:D,children:bi.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),ee&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx(q,{value:i.hiddenStoneCount,onChange:P=>k("hiddenStoneCount",parseInt(P)),disabled:D,children:Wd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.scanCount,onChange:P=>k("scanCount",parseInt(P)),disabled:D,children:Hd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})})]}),xe&&t.jsx($e,{label:" ",children:t.jsx(q,{value:i.missileCount,onChange:P=>k("missileCount",parseInt(P)),disabled:D,children:Vd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),Q&&(()=>{var ae,oe,ue,se,ge,je;const P=(ae=i.mixedModes)==null?void 0:ae.includes(T.Base),Y=(oe=i.mixedModes)==null?void 0:oe.includes(T.Capture);return t.jsxs("div",{className:"col-span-2 pt-2 border-t border-gray-700",children:[t.jsx("h3",{className:"font-semibold text-gray-300 mb-2",children:"  (2  )"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Ye.filter(me=>me.mode!==T.Standard&&me.mode!==T.Mix).map(me=>{var ze;const Se=me.mode===T.Base&&Y||me.mode===T.Capture&&P;return t.jsxs("label",{className:`flex items-center gap-2 p-2 bg-gray-700/50 rounded-md ${D||Se?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[t.jsx("input",{type:"checkbox",checked:(ze=i.mixedModes)==null?void 0:ze.includes(me.mode),onChange:Be=>M(me.mode,Be.target.checked),disabled:D||Se,className:"w-4 h-4"}),t.jsx("span",{children:me.mode})]},me.mode)})}),((ue=i.mixedModes)==null?void 0:ue.includes(T.Base))&&t.jsx($e,{label:" ",className:"mt-4",children:t.jsx(q,{value:i.baseStones,onChange:me=>k("baseStones",parseInt(me)),disabled:D,children:bi.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})}),((se=i.mixedModes)==null?void 0:se.includes(T.Hidden))&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",className:"mt-2",children:t.jsx(q,{value:i.hiddenStoneCount,onChange:me=>k("hiddenStoneCount",parseInt(me)),disabled:D,children:Wd.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})}),t.jsx($e,{label:" ",className:"mt-2",children:t.jsx(q,{value:i.scanCount,onChange:me=>k("scanCount",parseInt(me)),disabled:D,children:Hd.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})})]}),((ge=i.mixedModes)==null?void 0:ge.includes(T.Missile))&&t.jsx($e,{label:" ",className:"mt-2",children:t.jsx(q,{value:i.missileCount,onChange:me=>k("missileCount",parseInt(me)),disabled:D,children:Vd.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})}),((je=i.mixedModes)==null?void 0:je.includes(T.Capture))&&t.jsx($e,{label:" ",className:"mt-2",children:t.jsx(q,{value:i.captureTarget,onChange:me=>k("captureTarget",parseInt(me)),disabled:D,children:Gd.map(me=>t.jsxs("option",{value:me,children:[me,""]},me))})})]})})(),K&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:"",children:t.jsx(q,{value:i.alkkagiRounds,onChange:P=>k("alkkagiRounds",parseInt(P)),disabled:D,children:Kh.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.alkkagiPlacementType,onChange:P=>k("alkkagiPlacementType",P),disabled:D,children:Object.values(ga).map(P=>t.jsx("option",{value:P,children:P},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.alkkagiLayout,onChange:P=>k("alkkagiLayout",P),disabled:D,children:Object.values(Zs).map(P=>t.jsx("option",{value:P,children:P},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.alkkagiStoneCount,onChange:P=>k("alkkagiStoneCount",parseInt(P)),disabled:D,children:Zd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.alkkagiGaugeSpeed,onChange:P=>k("alkkagiGaugeSpeed",parseInt(P)),disabled:D,children:No.map(P=>t.jsx("option",{value:P.value,children:P.label},P.value))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.alkkagiSlowItemCount,onChange:P=>k("alkkagiSlowItemCount",parseInt(P)),disabled:D,children:Jd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.alkkagiAimingLineItemCount,onChange:P=>k("alkkagiAimingLineItemCount",parseInt(P)),disabled:D,children:Jd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})})]}),Z&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:"",children:t.jsx(q,{value:i.curlingRounds,onChange:P=>k("curlingRounds",parseInt(P)),disabled:D,children:Jh.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.curlingStoneCount,onChange:P=>k("curlingStoneCount",parseInt(P)),disabled:D,children:tu.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.curlingGaugeSpeed,onChange:P=>k("curlingGaugeSpeed",parseInt(P)),disabled:D,children:So.map(P=>t.jsx("option",{value:P.value,children:P.label},P.value))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.curlingSlowItemCount,onChange:P=>k("curlingSlowItemCount",parseInt(P)),disabled:D,children:Qd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})}),t.jsx($e,{label:" ",children:t.jsx(q,{value:i.curlingAimingLineItemCount,onChange:P=>k("curlingAimingLineItemCount",parseInt(P)),disabled:D,children:Qd.map(P=>t.jsxs("option",{value:P,children:[P,""]},P))})})]})]})]}),t.jsx("div",{className:"mt-6 border-t border-gray-700 pt-6",children:V()})]})})},Fy=(e,n)=>{if(e.isTopmost!==n.isTopmost||JSON.stringify(e.negotiation)!==JSON.stringify(n.negotiation)||JSON.stringify(e.currentUser)!==JSON.stringify(n.currentUser))return!1;const l=(i=>(i.negotiation.challenger.id===i.currentUser.id?i.negotiation.opponent:i.negotiation.challenger).id)(e),r=e.onlineUsers.find(i=>i.id===l),a=n.onlineUsers.find(i=>i.id===l);return JSON.stringify(r)===JSON.stringify(a)},Cx=Pn.memo(zy,Fy),Gy=({pos:e})=>t.jsx("div",{className:`w-[22%] h-[22%] bg-black rounded-full absolute ${e}`}),Wy=({value:e})=>{var s;const n={1:["top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"],2:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],3:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],4:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/4 right-1/4 translate-x-1/2 -translate-y-1/2","bottom-1/4 left-1/4 -translate-x-1/2 translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],5:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/4 right-1/4 translate-x-1/2 -translate-y-1/2","top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","bottom-1/4 left-1/4 -translate-x-1/2 translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],6:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/4 right-1/4 translate-x-1/2 -translate-y-1/2","top-1/2 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/2 right-1/4 translate-x-1/2 -translate-y-1/2","bottom-1/4 left-1/4 -translate-x-1/2 translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"]};return t.jsx("div",{className:"w-full h-full relative",children:(s=n[e])==null?void 0:s.map((l,r)=>t.jsx(Gy,{pos:l},r))})},Yn=({value:e,isRolling:n,sides:s=6,size:l=60,onClick:r,disabled:a=!1,displayText:i,color:o="gray"})=>{const[c,d]=f.useState(e||1),u=!a&&!n&&r;f.useEffect(()=>{let m;return n?m=window.setInterval(()=>{d(Math.floor(Math.random()*s)+1)},50):d(e||1),()=>{m&&clearInterval(m)}},[n,e,s]);const p={gray:"bg-gray-100 hover:bg-white text-black",blue:"bg-blue-400 hover:bg-blue-300 text-white",yellow:"bg-yellow-400 hover:bg-yellow-300 text-black"};return t.jsx("div",{onClick:u?r:void 0,className:`flex items-center justify-center rounded-lg shadow-md transition-all duration-200 p-1
                ${u?`cursor-pointer hover:shadow-lg hover:-translate-y-1 ${p[o]}`:`${p[o]}`}
                ${a?"opacity-60 cursor-not-allowed":""}
                ${n?"animate-dice-flicker":""}`,style:{width:l,height:l},children:i?t.jsx("span",{className:"select-none font-bold",style:{fontSize:l*.5},children:i}):t.jsx(Wy,{value:c})})},Hy=e=>{var E,I,R,A,O,B;const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,gameStatus:o,turnOrderRollReady:c,animation:d}=n,[u,p]=f.useState(Yh),m=s.id===a.id?i:a;f.useEffect(()=>{let V;const D=o==="dice_turn_rolling"?n.turnOrderRollDeadline:o==="dice_turn_choice"?n.turnChoiceDeadline:null;if(D){const L=()=>{const q=Math.max(0,Math.ceil((D-Date.now())/1e3));p(q)};L(),V=window.setInterval(L,1e3)}return()=>{V&&clearInterval(V)}},[o,n.turnOrderRollDeadline,n.turnChoiceDeadline]);const h=c==null?void 0:c[s.id],y=(d==null?void 0:d.type)==="dice_roll_turn"?d:null,b=o==="dice_turn_rolling_animating",v=!!(n.turnOrderRolls&&n.turnOrderRolls[s.id]!=null),g=o==="dice_turn_choice"||!!y&&!b,x=y?s.id===a.id?y.p1Roll:y.p2Roll:(E=n.turnOrderRolls)==null?void 0:E[s.id],j=y?m.id===a.id?y.p1Roll:y.p2Roll:(I=n.turnOrderRolls)==null?void 0:I[m.id];let w="",S="";g&&x!=null&&j!=null&&(x>j?(w="!",S="text-green-400"):x<j?(w="!",S="text-red-400"):(w="!",S="text-yellow-400"));const C=(R=Me.find(V=>V.id===s.avatarId))==null?void 0:R.url,k=(A=Re.find(V=>V.id===s.borderId))==null?void 0:A.url,M=(O=Me.find(V=>V.id===m.avatarId))==null?void 0:O.url,_=(B=Re.find(V=>V.id===m.borderId))==null?void 0:B.url;return t.jsx(be,{title:"/ ",windowId:"dice-go-turn-selection",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6",children:"    .     / ."}),n.turnOrderRollResult==="tie"&&t.jsx("p",{className:"text-yellow-400 font-bold text-lg mb-4 animate-pulse",children:"!    ."}),t.jsxs("div",{className:"flex justify-around w-full items-center my-4",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2 w-24",children:[t.jsx(Ce,{userId:s.id,userName:s.nickname,size:64,avatarUrl:C,borderUrl:k}),t.jsx("span",{className:"font-semibold",children:s.nickname}),(h||y||v)&&t.jsx(Yn,{value:g?x??null:null,isRolling:b,sides:6,size:64})]}),g&&x!=null&&j!=null?t.jsxs("div",{className:"text-4xl font-bold",children:[x," : ",j]}):t.jsx("span",{className:"text-3xl font-bold",children:"VS"}),t.jsxs("div",{className:"flex flex-col items-center gap-2 w-24",children:[t.jsx(Ce,{userId:m.id,userName:m.nickname,size:64,avatarUrl:M,borderUrl:_}),t.jsx("span",{className:"font-semibold",children:m.nickname}),((c==null?void 0:c[m.id])||y||v)&&t.jsx(Yn,{value:g?j??null:null,isRolling:b,sides:6,size:64})]})]}),t.jsx("div",{className:"min-h-[6rem] mt-6 text-xl font-bold flex items-center justify-center",children:o==="dice_turn_choice"?n.turnChooserId===s.id?t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsxs("p",{className:"text-base font-normal text-gray-300 mb-2",children:["   . (",u,")"]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx(z,{onClick:()=>l({type:"DICE_CHOOSE_TURN",payload:{gameId:r,choice:"first"}}),colorScheme:"blue",children:" ()"}),t.jsx(z,{onClick:()=>l({type:"DICE_CHOOSE_TURN",payload:{gameId:r,choice:"second"}}),colorScheme:"gray",children:" ()"})]})]}):t.jsx("p",{className:"text-base text-green-400 animate-pulse",children:" /  ..."}):g&&w?t.jsx("p",{className:S,children:w}):!h&&!y?t.jsxs(z,{onClick:()=>l({type:"DICE_READY_FOR_TURN_ROLL",payload:{gameId:r}}),colorScheme:"blue",children:[" (",u,")"]}):h&&!y?t.jsx("p",{className:"text-base text-green-400 animate-pulse",children:"  ..."}):b?t.jsx("p",{className:"text-base text-gray-400 animate-pulse",children:" ..."}):null})]})})},Vy=({session:e})=>{const{boardState:n,baseStones:s,settings:{boardSize:l}}=e,r=300,a=r/l,i=a/2,o=a*.47,c=o*2*.7,d=c/2,u=p=>({cx:i+p.x*a,cy:i+p.y*a});return t.jsxs("svg",{viewBox:`0 0 ${r} ${r}`,className:"w-full h-full bg-[#e0b484] rounded-md shadow-inner",children:[Array.from({length:l}).map((p,m)=>t.jsxs("g",{children:[t.jsx("line",{x1:i+m*a,y1:i,x2:i+m*a,y2:r-i,stroke:"#54432a",strokeWidth:"1"}),t.jsx("line",{x1:i,y1:i+m*a,x2:r-i,y2:i+m*a,stroke:"#54432a",strokeWidth:"1"})]},m)),s==null?void 0:s.map((p,m)=>{const{cx:h,cy:y}=u(p);return t.jsxs("g",{children:[t.jsx("circle",{cx:h,cy:y,r:o,fill:p.player===$.Black?"#111827":"#f5f2e8"}),t.jsx("image",{href:p.player===$.Black?Da:Oa,x:h-d,y:y-d,width:c,height:c})]},`base-stone-${m}`)})]})},Ky=({session:e,currentUser:n,onAction:s})=>{var w,S,C,k;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d,finalKomi:u}=e,p=c==null?void 0:c[n.id],[m,h]=f.useState(20);if(f.useEffect(()=>{const M=d||Date.now()+2e4,_=setInterval(()=>{const E=Math.max(0,Math.ceil((M-Date.now())/1e3));h(E)},1e3);return()=>clearInterval(_)},[d]),!i||!o)return null;const y=r.id===i?r:a,b=r.id===o?r:a,v=(w=Me.find(M=>M.id===y.avatarId))==null?void 0:w.url,g=(S=Re.find(M=>M.id===y.borderId))==null?void 0:S.url,x=(C=Me.find(M=>M.id===b.avatarId))==null?void 0:C.url,j=(k=Re.find(M=>M.id===b.borderId))==null?void 0:k.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"base-start-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:"/ .     20   ."}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:v,borderUrl:g}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,size:64,avatarUrl:x,borderUrl:j}),t.jsx("p",{className:"mt-2 font-bold",children:b.nickname}),t.jsxs("p",{className:"font-semibold",children:[" (: ",u,")"]})]})]}),t.jsx("div",{className:"my-4 mx-auto w-full max-w-xs",children:t.jsx(Vy,{session:e})}),t.jsx(z,{onClick:()=>s({type:"CONFIRM_BASE_REVEAL",payload:{gameId:l}}),disabled:!!p,className:"w-full py-3",children:p?"   ...":`  (${m})`})]})})},Jy=({session:e,currentUser:n,onAction:s})=>{var I,R,A,O;const{id:l,alkkagiRoundSummary:r,player1:a,player2:i,roundEndConfirmations:o,revealEndTime:c,alkkagiStones:d}=e,[u,p]=f.useState(30),m=!!(o!=null&&o[n.id]);if(f.useEffect(()=>{const B=c||Date.now()+3e4,V=setInterval(()=>{const D=Math.max(0,Math.ceil((B-Date.now())/1e3));p(D)},1e3);return()=>clearInterval(V)},[c]),!r)return null;const{round:h,winnerId:y}=r,b=a.id===y?a:i,v=a.id===e.blackPlayerId?$.Black:$.White,g=i.id===e.blackPlayerId?$.Black:$.White,x=(d==null?void 0:d.filter(B=>B.player===v&&B.onBoard).length)??0,j=(d==null?void 0:d.filter(B=>B.player===g&&B.onBoard).length)??0,w=(I=Me.find(B=>B.id===a.avatarId))==null?void 0:I.url,S=(R=Re.find(B=>B.id===a.borderId))==null?void 0:R.url,C=(A=Me.find(B=>B.id===i.avatarId))==null?void 0:A.url,k=(O=Re.find(B=>B.id===i.borderId))==null?void 0:O.url,M=h+1,_=e.settings.alkkagiRounds||1;let E="        .";return M>_&&(E="  .   ."),t.jsx(be,{title:`${h}  `,initialWidth:550,windowId:"alkkari-round-summary",children:t.jsxs("div",{className:"text-white text-center",children:[t.jsxs("h2",{className:"text-2xl font-bold mb-2",children:[b.nickname,"  !"]}),t.jsx("p",{className:"text-gray-300 mb-6",children:E}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 my-6",children:[t.jsxs("div",{className:"flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border-2 border-gray-600",children:[t.jsx(Ce,{userId:a.id,userName:a.nickname,size:80,avatarUrl:w,borderUrl:S}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:a.nickname}),t.jsxs("p",{className:"text-lg font-semibold",children:[" : ",x,""]})]}),t.jsxs("div",{className:"flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border-2 border-gray-600",children:[t.jsx(Ce,{userId:i.id,userName:i.nickname,size:80,avatarUrl:C,borderUrl:k}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:i.nickname}),t.jsxs("p",{className:"text-lg font-semibold",children:[" : ",j,""]})]})]}),t.jsx(z,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:!!m,className:"w-full py-3",children:m?"   ...":`${M>_?"  ":"  "} (${u})`})]})})},Qy=({session:e,currentUser:n,onAction:s})=>{var k,M,_,E;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d,turnOrderRolls:u}=e,p=c==null?void 0:c[n.id],[m,h]=f.useState(10);if(f.useEffect(()=>{const I=d||Date.now()+1e4,R=setInterval(()=>{const A=Math.max(0,Math.ceil((I-Date.now())/1e3));h(A)},1e3);return()=>clearInterval(R)},[d]),!i||!o)return null;const y=r.id===i?r:a,b=r.id===o?r:a;n.id;const v=(u==null?void 0:u[r.id])??null,g=(u==null?void 0:u[a.id])??null,x=v!==null&&g!==null&&v>g?r:a,j=(k=Me.find(I=>I.id===y.avatarId))==null?void 0:k.url,w=(M=Re.find(I=>I.id===y.borderId))==null?void 0:M.url,S=(_=Me.find(I=>I.id===b.avatarId))==null?void 0:_.url,C=(E=Re.find(I=>I.id===b.borderId))==null?void 0:E.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"dice-go-start-confirm",children:t.jsxs("div",{className:"text-white",children:[v!==null&&g!==null&&t.jsxs("p",{className:"text-center text-gray-300 mb-2",children:["  ",t.jsx("span",{className:"font-bold text-yellow-300",children:x.nickname}),"  / ."]}),t.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm",children:"    10    ."}),v!==null&&g!==null&&t.jsxs("div",{className:"flex justify-around items-center my-4 bg-gray-900/50 p-3 rounded-lg",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(Ce,{userId:r.id,userName:r.nickname,size:48}),t.jsx("span",{className:"font-semibold text-sm",children:r.nickname}),t.jsx(Yn,{value:v,isRolling:!1,size:48})]}),t.jsx("span",{className:"text-2xl font-bold",children:"VS"}),t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(Ce,{userId:a.id,userName:a.nickname,size:48}),t.jsx("span",{className:"font-semibold text-sm",children:a.nickname}),t.jsx(Yn,{value:g,isRolling:!1,size:48})]})]}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:j,borderUrl:w}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,size:64,avatarUrl:S,borderUrl:C}),t.jsx("p",{className:"mt-2 font-bold",children:b.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]})]}),t.jsx(z,{onClick:()=>s({type:"DICE_CONFIRM_START",payload:{gameId:l}}),disabled:!!p,className:"w-full py-3 mt-6",children:p?"   ...":`  (${m})`})]})})},Yy=({session:e,currentUser:n,onAction:s})=>{var _,E,I,R,A;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d}=e,u=c==null?void 0:c[n.id],[p,m]=f.useState(30);if(f.useEffect(()=>{const O=d||Date.now()+3e4,B=setInterval(()=>{const V=Math.max(0,Math.ceil((O-Date.now())/1e3));m(V)},1e3);return()=>clearInterval(B)},[d]),!i||!o)return null;const h=r.id===i?r:a,y=r.id===o?r:a,b=e.rpsState&&Object.values(e.rpsState).every(O=>O!==null),v=i===r.id?r.id:a.id,g=r.id===v?r:a,j=((_=e.turnChoices)==null?void 0:_[g.id])==="first"?"()":"()",w=b?`${g.nickname}   ${j}() .`:"/  .",S=(E=Me.find(O=>O.id===h.avatarId))==null?void 0:E.url,C=(I=Re.find(O=>O.id===h.borderId))==null?void 0:I.url,k=(R=Me.find(O=>O.id===y.avatarId))==null?void 0:R.url,M=(A=Re.find(O=>O.id===y.borderId))==null?void 0:A.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"curling-start-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:w}),t.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm",children:"    30    ."}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:h.id,userName:h.nickname,size:64,avatarUrl:S,borderUrl:C}),t.jsx("p",{className:"mt-2 font-bold",children:h.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:k,borderUrl:M}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]})]}),t.jsx(z,{onClick:()=>s({type:"CONFIRM_CURLING_START",payload:{gameId:l}}),disabled:!!u,className:"w-full py-3 mt-6",children:u?"   ...":`  (${p})`})]})})},Xy=({session:e,currentUser:n,onAction:s})=>{var C,k,M,_;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d}=e,u=c==null?void 0:c[n.id],[p,m]=f.useState(30);if(f.useEffect(()=>{const E=d||Date.now()+3e4,I=setInterval(()=>{const R=Math.max(0,Math.ceil((E-Date.now())/1e3));m(R)},1e3);return()=>clearInterval(I)},[d]),!i||!o)return null;const h=r.id===i?r:a,y=r.id===o?r:a,b=e.rpsState&&Object.values(e.rpsState).every(E=>E!==null),v=i===r.id?r:a,g=b?`${v.nickname}   () .`:"/  .",x=(C=Me.find(E=>E.id===h.avatarId))==null?void 0:C.url,j=(k=Re.find(E=>E.id===h.borderId))==null?void 0:k.url,w=(M=Me.find(E=>E.id===y.avatarId))==null?void 0:M.url,S=(_=Re.find(E=>E.id===y.borderId))==null?void 0:_.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"alkkagi-start-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:g}),t.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm",children:"    30    ."}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:h.id,userName:h.nickname,size:64,avatarUrl:x,borderUrl:j}),t.jsx("p",{className:"mt-2 font-bold",children:h.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:w,borderUrl:S}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]})]}),t.jsx(z,{onClick:()=>s({type:"CONFIRM_ALKKAGI_START",payload:{gameId:l}}),disabled:!!u,className:"w-full py-3 mt-6",children:u?"   ...":`  (${p})`})]})})},Zy=({item:e})=>t.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-1 bg-gray-900/50 rounded-md",title:e.name,children:[t.jsx("img",{src:e.image,alt:e.name,className:"w-12 h-12 object-contain"}),t.jsxs("span",{className:"text-xs mt-1 text-gray-300 truncate w-full",children:[e.name,e.quantity>1?` x${e.quantity}`:""]})]}),eb=({session:e,currentUser:n,onAction:s,onClose:l})=>{var m,h,y;const r=e.winner===$.Black,a=(m=e.summary)==null?void 0:m[n.id],i=Jl.findIndex(b=>b.id===e.stageId),o=Jl[i+1],c=r&&o&&(n.singlePlayerProgress??0)>i,d=()=>{s({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:e.stageId}}),l()},u=()=>{c&&(s({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:o.id}}),l())},p=()=>{sessionStorage.setItem("postGameRedirect","#/singleplayer"),s({type:"LEAVE_AI_GAME",payload:{gameId:e.id}}),l()};return t.jsx(be,{title:r?" ":" ",onClose:l,windowId:"sp-summary-redesigned",initialWidth:500,children:t.jsxs("div",{className:`relative text-center p-4 rounded-lg overflow-hidden ${r?"bg-gradient-to-br from-blue-900/50 to-gray-900":"bg-gradient-to-br from-red-900/50 to-gray-900"}`,children:[r&&t.jsx("div",{className:"absolute -top-1/2 -left-1/4 w-full h-full bg-yellow-400/20 rounded-full blur-3xl animate-pulse"}),t.jsx("h1",{className:`text-5xl font-black mb-4 tracking-widest ${r?"text-yellow-300":"text-red-400"}`,style:{textShadow:r?"0 0 15px rgba(250, 204, 21, 0.5)":"0 0 10px rgba(220, 38, 38, 0.5)"},children:r?"MISSION CLEAR":"MISSION FAILED"}),a&&t.jsxs("div",{className:"bg-black/30 backdrop-blur-sm p-4 rounded-lg my-4 space-y-3 border border-gray-700/50",children:[t.jsx("h2",{className:"font-bold text-lg text-gray-200",children:""}),t.jsxs("div",{className:"flex justify-center items-center gap-6 text-lg",children:[a.xp&&a.xp.change>0&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-400",children:" "}),t.jsxs("p",{className:"font-bold text-green-400 sparkle-animation",children:["+",a.xp.change," XP"]})]}),a.gold&&a.gold>0&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-8 h-8"}),t.jsxs("span",{className:"font-bold text-yellow-400 sparkle-animation",children:["+",a.gold.toLocaleString()]})]})]}),a.items&&a.items.length>0&&t.jsxs("div",{className:"pt-3 border-t border-gray-700/50",children:[t.jsx("h3",{className:"text-sm text-gray-400 mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-5 gap-2",children:a.items.map(b=>t.jsx(Zy,{item:b},b.id))})]}),!r&&(!a||a.gold===0&&((h=a.xp)==null?void 0:h.change)===0&&((y=a.items)==null?void 0:y.length)===0)&&t.jsx("p",{className:"text-gray-500",children:"  ."})]}),t.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[t.jsx(z,{onClick:p,colorScheme:"gray",className:"w-full",children:""}),t.jsx(z,{onClick:d,colorScheme:"yellow",className:"w-full",children:""}),t.jsxs(z,{onClick:u,colorScheme:"blue",className:"w-full",disabled:!c,children:[" ",o?`: ${o.name.replace(" ","")}`:""]}),t.jsx(z,{onClick:l,colorScheme:"green",className:"w-full",children:""})]})]})})},Tu=e=>{const{session:n,currentUser:s,onAction:l,confirmModalType:r,onHideConfirmModal:a,showResultModal:i,onCloseResults:o,isSpectator:c,activeNegotiation:d,onlineUsers:u,onViewUser:p}=e,{gameStatus:m,mode:h,id:y}=n,b=()=>{if(d)return t.jsx(Cx,{negotiation:d,currentUser:s,onAction:l,onlineUsers:u});if(n.isSinglePlayer&&i)return t.jsx(eb,{session:n,currentUser:s,onAction:l,onClose:o});if(c&&["nigiri_choosing","nigiri_guessing","base_placement","komi_bidding","capture_bidding","dice_rps","thief_rps","alkkagi_rps","curling_rps","omok_rps","ttamok_rps","turn_preference_selection","thief_role_selection","alkkagi_simultaneous_placement","dice_turn_rolling"].includes(m))return null;const j=["dice_rps","dice_rps_reveal","thief_rps","thief_rps_reveal","alkkagi_rps","alkkagi_rps_reveal","curling_rps","curling_rps_reveal","omok_rps","omok_rps_reveal","ttamok_rps","ttamok_rps_reveal"];if(m==="dice_turn_rolling"||m==="dice_turn_rolling_animating"||m==="dice_turn_choice")return t.jsx(Hy,{session:n,currentUser:s,onAction:l});if(m==="dice_start_confirmation")return t.jsx(Qy,{session:n,currentUser:s,onAction:l});if(m==="turn_preference_selection")return t.jsx(_y,{session:n,currentUser:s,onAction:l,tiebreaker:n.turnSelectionTiebreaker});if(["nigiri_choosing","nigiri_guessing","nigiri_reveal"].includes(m))return t.jsx(ky,{session:n,currentUser:s,onAction:l});if(m==="capture_bidding")return t.jsx(Cy,{session:n,currentUser:s,onAction:l});if(["capture_tiebreaker","capture_reveal"].includes(m))return t.jsx(Iy,{session:n,currentUser:s,onAction:l});if(m==="base_placement")return t.jsx($y,{session:n,currentUser:s,onAction:l});if(["komi_bidding","komi_bid_reveal"].includes(m))return t.jsx(Dy,{session:n,currentUser:s,onAction:l});if(m==="base_game_start_confirmation")return t.jsx(Ky,{session:n,currentUser:s,onAction:l});if(j.includes(m))return t.jsx(Py,{session:n,currentUser:s,onAction:l});if(m==="alkkagi_start_confirmation")return t.jsx(Xy,{session:n,currentUser:s,onAction:l});if(m==="curling_start_confirmation")return t.jsx(Yy,{session:n,currentUser:s,onAction:l});if(m==="thief_role_selection")return t.jsx(My,{session:n,currentUser:s,onAction:l});if(m==="thief_role_confirmed")return t.jsx(Ty,{session:n,currentUser:s,onAction:l});if(m==="thief_round_end")return t.jsx(Ry,{session:n,currentUser:s,onAction:l});if(m==="curling_round_end")return t.jsx(By,{session:n,currentUser:s,onAction:l});if(m==="alkkagi_round_end")return t.jsx(Jy,{session:n,currentUser:s,onAction:l});if(m==="dice_round_end")return t.jsx(Ly,{session:n,currentUser:s,onAction:l});if(m==="alkkagi_simultaneous_placement")return t.jsx(qy,{session:n,currentUser:s});if(i){if(m==="ended")return t.jsx(Sy,{session:n,currentUser:s,onConfirm:o});if(m==="no_contest")return t.jsx(Ay,{session:n,currentUser:s,onConfirm:o})}return null},g=r?{resign:{title:" ",message:" ?  .",confirmText:"",onConfirm:()=>l({type:"RESIGN_GAME",payload:{gameId:y}})}}[r]:null;return t.jsxs(t.Fragment,{children:[b(),g&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm p-6 border border-gray-700",children:[t.jsx("h2",{className:"text-xl font-bold text-center mb-4",children:g.title}),t.jsx("p",{className:"text-center text-gray-300 mb-6",children:g.message}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsx(z,{onClick:a,colorScheme:"gray",className:"w-full",children:""}),t.jsx(z,{onClick:()=>{a(),g.onConfirm()},colorScheme:"red",className:"w-full",children:g.confirmText})]})]})})]})};function _u(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const tb=e=>{const{gameStatus:n,currentPlayer:s,blackPlayerId:l,whitePlayerId:r,player1:a,player2:i,mode:o,settings:c,passCount:d,moveHistory:u,alkkagiRound:p}=e,m=b=>{const v=b===$.Black?l:r;return v?a.id===v?a:i:null},h=m(s);if(e.mode===T.Dice&&e.lastWhiteGroupInfo&&e.lastWhiteGroupInfo.liberties<=6){const b=e.settings.diceGoRounds??1;let v=` !  ${e.lastWhiteGroupInfo.liberties}`;if(e.round===b&&b>0){const g=Qh[b-1];g&&(v+=` (   +${g})`)}return v}const y=u.length>0?u[u.length-1]:null;if(d>=2&&(y==null?void 0:y.x)===-1)return"    .";if(n!=="ended"&&d===1&&(y==null?void 0:y.x)===-1){const b=s===$.Black?$.White:$.Black,v=m(b);if(v)return`${v.nickname} .`}switch(n){case"playing":return h?`${h.nickname} .`:"  ";case"nigiri_choosing":case"nigiri_guessing":case"nigiri_reveal":return"   ...";case"base_placement":return`  ... (${c.baseStones})`;case"komi_bidding":return"  ...";case"ended":return" ";case"no_contest":return" ";case"rematch_pending":return"  ...";case"hidden_placing":case"scanning":case"missile_selecting":return"  ...";case"hidden_final_reveal":return"    .";case"alkkagi_placement":{const b=p||1,v=c.alkkagiRounds||1;return b>1?`  . (${b} / ${v} )`:` . (${b} / ${v} )`}case"alkkagi_playing":{const b=p||1,v=c.alkkagiRounds||1;return`${h==null?void 0:h.nickname} . (${b} / ${v} )`}case"alkkagi_round_end":return" !  .";case"dice_rolling":return h?`${h.nickname}   .`:"  ";case"thief_rolling":return h?`${h.nickname}   .`:"  ";case"curling_tiebreaker_preference_selection":case"curling_tiebreaker_rps":case"curling_tiebreaker_rps_reveal":return"   ...";case"curling_tiebreaker_playing":return`  ... (${h==null?void 0:h.nickname} )`;default:return o===T.Dice?`  (${e.round} / ${e.settings.diceGoRounds} )`:o===T.Thief?`  (${e.round} )`:h?`${h.nickname} .`:"  ..."}},Au=({session:e})=>{var v;const[n,s]=f.useState(30),[l,r]=f.useState(100),[a,i]=f.useState(null),o=_u(e.lastTimeoutPlayerId),c=_u((v=e.foulInfo)==null?void 0:v.message),d=f.useMemo(()=>rt.some(g=>g.mode===e.mode)&&e.turnDeadline&&e.turnStartTime&&["dice_rolling","dice_placing","thief_rolling","thief_placing"].includes(e.gameStatus),[e.mode,e.turnDeadline,e.turnStartTime,e.gameStatus]);f.useEffect(()=>{if(!d){r(100);return}const g=e.turnDeadline-e.turnStartTime;if(g<=0)return;const x=()=>{const w=e.turnDeadline-Date.now(),S=Math.max(0,w/g*100);r(S)};x();const j=setInterval(x,100);return()=>clearInterval(j)},[d,e.turnDeadline,e.turnStartTime]),f.useEffect(()=>{if(e.foulInfo&&e.foulInfo.message!==c){i(e.foulInfo.message),Ee.timeoutFoul();const g=setTimeout(()=>i(null),5e3);return()=>clearTimeout(g)}},[e.foulInfo,c]),f.useEffect(()=>{if(e.lastTimeoutPlayerId&&e.lastTimeoutPlayerId!==o&&rt.some(x=>x.mode===e.mode)){const x=e.player1.id===e.lastTimeoutPlayerId?e.player1:e.player2;i(`${x.nickname}  !`);const j=setTimeout(()=>i(null),5e3);return()=>clearTimeout(j)}},[e.lastTimeoutPlayerId,o,e.mode,e.player1,e.player2]),f.useEffect(()=>{["playing","ended","no_contest","alkkagi_playing","curling_playing","dice_rolling","dice_placing","thief_rolling","thief_placing"].includes(e.gameStatus)&&i(null)},[e.gameStatus]);const u=["hidden_placing","scanning","missile_selecting"].includes(e.gameStatus);f.useEffect(()=>{if(!u||!e.itemUseDeadline)return;const g=()=>{const j=Math.max(0,Math.ceil((e.itemUseDeadline-Date.now())/1e3));s(j)};g();const x=setInterval(g,500);return()=>clearInterval(x)},[u,e.itemUseDeadline]);const p=e.isSinglePlayer,m="flex-shrink-0 rounded-lg flex flex-col items-center justify-center shadow-inner py-1 h-12 border",h=p?"bg-stone-800/70 backdrop-blur-sm border-stone-700/50":"bg-secondary border-color",y=p?"text-amber-300":"text-highlight";if(a)return t.jsx("div",{className:"flex-shrink-0 bg-danger rounded-lg flex items-center justify-center shadow-inner animate-pulse py-1 h-12 border-2 border-red-500",children:t.jsx("p",{className:"font-bold text-white tracking-wider text-[clamp(0.875rem,3vmin,1.125rem)]",children:a})});if(e.mode===T.Dice&&e.gameStatus==="dice_placing"&&e.dice)return t.jsxs("div",{className:`${m} ${h} px-4 gap-1`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[": ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:e.dice.dice1})]}),t.jsx("div",{className:`w-px h-5 ${p?"bg-stone-600":"bg-border-color"}`}),t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[" : ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:e.stonesToPlace})]})]}),d&&t.jsx("div",{className:"w-full h-1 bg-tertiary rounded-full mt-1",children:t.jsx("div",{className:"h-1 bg-red-500 rounded-full",style:{width:`${l}%`}})})]});if(e.mode===T.Thief&&e.gameStatus==="thief_placing"&&e.dice){const{dice1:g,dice2:x}=e.dice,j=x>0?`${g}, ${x}`:`${g}`;return t.jsxs("div",{className:`${m} ${h} px-4 gap-2`,children:[t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[": ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:j})]}),t.jsx("div",{className:`w-px h-5 ${p?"bg-stone-600":"bg-border-color"}`}),t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[" : ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:e.stonesToPlace})]})]})}if(u){let g=" ";e.gameStatus==="hidden_placing"&&(g=" "),e.gameStatus==="scanning"&&(g=" "),e.gameStatus==="missile_selecting"&&(g=" ");const x=n/30*100;return t.jsxs("div",{className:`${m} ${h} px-4 gap-2`,children:[t.jsx("span",{className:`font-bold ${y} tracking-wider flex-shrink-0 text-[clamp(0.8rem,2.5vmin,1rem)]`,children:g}),t.jsx("div",{className:`w-full bg-tertiary rounded-full h-[clamp(0.5rem,1.5vh,0.75rem)] relative overflow-hidden border-2 ${p?"border-black/20":"border-tertiary"}`,children:t.jsx("div",{className:"absolute inset-0 bg-highlight rounded-full",style:{width:`${x}%`,transition:"width 0.5s linear"}})}),t.jsxs("span",{className:"font-mono font-bold text-primary w-[clamp(2rem,8vmin,2.5rem)] text-center text-[clamp(0.9rem,3vmin,1.1rem)]",children:[n,""]})]})}const b=tb(e);return t.jsxs("div",{className:`${m} ${h}`,children:[t.jsx("p",{className:`font-bold ${y} tracking-wider text-[clamp(0.8rem,2.5vmin,1rem)] text-center px-2`,children:b}),d&&t.jsx("div",{className:"w-11/12 h-1 bg-tertiary rounded-full mt-1",children:t.jsx("div",{className:"h-1 bg-red-500 rounded-full",style:{width:`${l}%`}})})]})},nb=({session:e,result:n,onClose:s})=>{var x,j,w;if(!n||!n.scoreDetails||!n.areaScore)return t.jsx(be,{title:"",onClose:s,initialWidth:380,windowId:"analysis-territory",modal:!1,children:t.jsx("p",{className:"text-center text-gray-400",children:"   ..."})});const{scoreDetails:l,winRateChange:r,scoreLead:a}=n,{mode:i,settings:o}=e,c=a??n.areaScore.black-n.areaScore.white,d=c>0?"":"",u=Math.abs(c).toFixed(1),p=n.winRateBlack,m=100-p,h=`rgba(220, 38, 38, ${Math.max(0,(p-50)/50*.7)})`,y=`rgba(59, 130, 246, ${Math.max(0,(m-50)/50*.7)})`,b=i===T.Speed||i===T.Mix&&((x=o.mixedModes)==null?void 0:x.includes(T.Speed)),v=i===T.Base||i===T.Mix&&((j=o.mixedModes)==null?void 0:j.includes(T.Base)),g=i===T.Hidden||i===T.Mix&&((w=o.mixedModes)==null?void 0:w.includes(T.Hidden));return t.jsx(be,{title:"",onClose:s,initialWidth:380,windowId:"analysis-territory",modal:!1,children:t.jsx("div",{className:"text-sm text-white",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-1 text-xs",children:[t.jsxs("span",{className:"font-semibold text-gray-300",children:[" ",p.toFixed(1),"%"]}),r!==void 0&&t.jsxs("span",{className:`font-bold text-xs ${r>0?"text-green-400":"text-red-400"}`,children:[r>0?"":""," ",Math.abs(r).toFixed(1),"%"]}),t.jsxs("span",{className:"font-semibold text-gray-300",children:[" ",m.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex w-full h-4 bg-gray-700 rounded-full overflow-hidden border-2 border-gray-900",children:[t.jsx("div",{className:"bg-black relative",style:{width:`${p}%`},children:t.jsx("div",{className:"absolute inset-0",style:{backgroundColor:h}})}),t.jsx("div",{className:"bg-white relative",style:{width:`${m}%`},children:t.jsx("div",{className:"absolute inset-0",style:{backgroundColor:y}})})]})]}),t.jsxs("div",{className:"flex justify-between pt-1",children:[t.jsx("span",{className:"font-medium text-gray-300",children:"  "}),t.jsxs("span",{className:"font-mono font-bold text-yellow-300",children:[d," ",u," "]})]}),t.jsx("div",{className:"bg-gray-900/50 p-3 rounded-lg my-2 text-xs",children:t.jsxs("div",{className:"grid grid-cols-2 gap-x-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("h4",{className:"font-bold text-center border-b border-gray-600 pb-1 mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.territory})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{className:"font-mono",children:l.black.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.deadStones??0})]}),v&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.baseStoneBonus})]}),g&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.hiddenStoneBonus})]}),b&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.timeBonus})]}),l.black.itemBonus>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.itemBonus})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-500 mt-1 pt-1 font-bold",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:n.areaScore.black.toFixed(1)})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("h4",{className:"font-bold text-center border-b border-gray-600 pb-1 mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.territory})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{className:"font-mono",children:l.white.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.deadStones??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.komi})]}),v&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.baseStoneBonus})]}),g&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.hiddenStoneBonus})]}),b&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.timeBonus})]}),l.white.itemBonus>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.itemBonus})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-500 mt-1 pt-1 font-bold",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:n.areaScore.white.toFixed(1)})]})]})]})})]})})})},sb=e=>{if(e<=0)return"READY";const n=Math.ceil(e/1e3),s=Math.floor(n/60),l=n%60;return`${String(s).padStart(2,"0")}:${String(l).padStart(2,"0")}`},Ix=["playing","alkkagi_playing","curling_playing","dice_rolling","dice_placing","thief_rolling","thief_placing"],lb=({session:e,isSpectator:n,onAction:s,currentUser:l})=>{var v,g;const[r,a]=f.useState("00:00"),{id:i,mode:o,gameStatus:c}=e;f.useEffect(()=>{var S;const x=(S=e.actionButtonCooldownDeadline)==null?void 0:S[l.id];if(!x){a("READY");return}const j=()=>{const C=x-Date.now();a(sb(C))};j();const w=setInterval(j,1e3);return()=>clearInterval(w)},[e.actionButtonCooldownDeadline,l.id]);const d=["ended","no_contest","rematch_pending"].includes(c),u=Ye.some(x=>x.mode===o)||rt.some(x=>x.mode===o);if(d||n||!u)return null;const p=(v=e.currentActionButtons)==null?void 0:v[l.id],m=p&&p.length>0,h=Ix.includes(c),y=(g=e.actionButtonUsedThisCycle)==null?void 0:g[l.id],b=r==="READY";return t.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[m&&!y?p.map(x=>t.jsx(z,{onClick:()=>s({type:"USE_ACTION_BUTTON",payload:{gameId:i,buttonName:x.name}}),colorScheme:x.type==="manner"?"green":"orange",className:"whitespace-nowrap text-[clamp(0.5rem,1.8vmin,0.75rem)] px-[clamp(0.3rem,1.5vmin,0.5rem)] py-[clamp(0.15rem,1vmin,0.25rem)]",title:x.message,disabled:n||!h,children:x.name},x.name)):t.jsx("span",{className:"text-xs text-gray-400",children:"  ..."}),t.jsx("span",{className:`text-xs font-mono ${b&&!y?"text-green-400":"text-gray-400"}`,children:r})]})},rb=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{var h,y;const{id:r,gameStatus:a}=e,i=a==="dice_rolling_animating",o=b=>{n&&a==="dice_rolling"&&(Ee.rollDice(1),s({type:"DICE_ROLL",payload:{gameId:r,itemType:b}}))},c=(h=e.diceGoItemUses)==null?void 0:h[l.id],d=(c==null?void 0:c.odd)??0,u=(c==null?void 0:c.even)??0,p=n&&a==="dice_rolling",m=i?null:(y=e.dice)==null?void 0:y.dice1;return t.jsxs("div",{className:`flex flex-row items-center justify-center gap-3 transition-all ${p?"animate-pulse-border-yellow":"border-2 border-transparent p-2 rounded-lg"}`,children:[t.jsx("div",{className:"flex flex-col items-center",children:t.jsx(Yn,{value:m??null,isRolling:i,size:48,onClick:()=>o(),disabled:!p})}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(Yn,{displayText:"",color:"blue",value:null,isRolling:i,size:48,onClick:()=>o("odd"),disabled:!p||d<=0}),t.jsxs("span",{className:"text-xs mt-1 font-bold",children:[d,""]})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(Yn,{displayText:"",color:"yellow",value:null,isRolling:i,size:48,onClick:()=>o("even"),disabled:!p||u<=0}),t.jsxs("span",{className:"text-xs mt-1 font-bold",children:[u,""]})]})]})},ab=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{var w,S;const{id:r,gameStatus:a,activeAlkkagiItems:i}=e,o=(w=e.alkkagiItemUses)==null?void 0:w[l.id],c=(o==null?void 0:o.slow)??e.settings.alkkagiSlowItemCount??0,d=(o==null?void 0:o.aimingLine)??e.settings.alkkagiAimingLineItemCount??0,u=(i==null?void 0:i[l.id])||[],p=C=>{s({type:"USE_ALKKAGI_ITEM",payload:{gameId:r,itemType:C}})},m=u.includes("slow"),h=u.includes("aimingLine"),y=n&&a==="alkkagi_playing",b="whitespace-nowrap text-[clamp(0.6rem,2.2vmin,0.875rem)] px-[clamp(0.4rem,1.8vmin,0.75rem)] py-[clamp(0.3rem,1.2vmin,0.625rem)]",v=e.settings.alkkagiRounds||1;if(v<=1)return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(z,{onClick:()=>p("slow"),disabled:!y||c<=0||m,colorScheme:m?"green":"blue",className:b,title:`   50% .  : ${c}`,children:[" (",c,")"]}),t.jsxs(z,{onClick:()=>p("aimingLine"),disabled:!y||d<=0||h,colorScheme:h?"green":"purple",className:b,title:`  1000% .  : ${d}`,children:[" (",d,")"]})]});const g=v-1,x=((S=e.alkkagiRefillsUsed)==null?void 0:S[l.id])||0,j=g-x;return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"flex flex-col text-center text-xs font-semibold",children:t.jsxs("span",{className:"text-yellow-300",children:[": ",j," / ",g]})}),t.jsx("div",{className:"h-8 w-px bg-gray-600 mx-2"}),t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(z,{onClick:()=>p("slow"),disabled:!y||c<=0||m,colorScheme:m?"green":"blue",className:b,title:`   50% .  : ${c}`,children:[" (",c,")"]}),t.jsxs(z,{onClick:()=>p("aimingLine"),disabled:!y||d<=0||h,colorScheme:h?"green":"purple",className:b,title:`  1000% .  : ${d}`,children:[" (",d,")"]})]})]})},ib=({session:e,currentUser:n})=>null,ob=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{const{id:r,gameStatus:a,animation:i,currentPlayer:o,blackPlayerId:c,whitePlayerId:d,thiefPlayerId:u}=e,p=(i==null?void 0:i.type)==="dice_roll_main"?i:null,m=!!p&&Date.now()<p.startTime+p.duration,b=((o===$.Black?c:d)===u?"thief":"police")==="thief"?1:2,v=()=>{n&&a==="thief_rolling"&&(Ee.rollDice(b),s({type:"THIEF_ROLL_DICE",payload:{gameId:r}}))};return t.jsx("div",{className:"flex items-center justify-center gap-2",children:Array.from({length:b}).map((g,x)=>{var S;const j=x===0?"dice1":"dice2",w=p?p.dice[j]:(S=e.dice)==null?void 0:S[j];return t.jsx(Yn,{value:w??null,isRolling:m,size:48,onClick:v,disabled:!n||a!=="thief_rolling"},x)})})},cb=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{var v;const{id:r,gameStatus:a,activeCurlingItems:i}=e,o=(v=e.curlingItemUses)==null?void 0:v[l.id],c=(o==null?void 0:o.slow)??e.settings.curlingSlowItemCount??0,d=(o==null?void 0:o.aimingLine)??e.settings.curlingAimingLineItemCount??0,u=(i==null?void 0:i[l.id])||[],p=g=>{s({type:"USE_CURLING_ITEM",payload:{gameId:r,itemType:g}})},m=u.includes("slow"),h=u.includes("aimingLine"),y=n&&a==="curling_playing",b="whitespace-nowrap text-[clamp(0.6rem,2.2vmin,0.875rem)] px-[clamp(0.4rem,1.8vmin,0.75rem)] py-[clamp(0.3rem,1.2vmin,0.625rem)]";return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(z,{onClick:()=>p("slow"),disabled:!y||c<=0||m,colorScheme:m?"green":"blue",className:b,title:`   50% .  : ${c}`,children:[" (",c,")"]}),t.jsxs(z,{onClick:()=>p("aimingLine"),disabled:!y||d<=0||h,colorScheme:h?"green":"purple",className:b,title:`  1000% .  : ${d}`,children:[" (",d,")"]})]})},db=e=>{var W;const{session:n,isMyTurn:s,isSpectator:l,onAction:r,setShowResultModal:a,setConfirmModalType:i,currentUser:o,onlineUsers:c,pendingMove:d,onConfirmMove:u,onCancelMove:p,isMobile:m,settings:h}=e,{id:y,mode:b,gameStatus:v,blackPlayerId:g,whitePlayerId:x,player1:j,player2:w}=n;T.Mix;const S=["ended","no_contest","rematch_pending"].includes(v),C=Ix.includes(v),k=!C&&!S,M=Ye.some(H=>H.mode===b),_=()=>{s&&!l&&v==="playing"&&r({type:"PASS_TURN",payload:{gameId:y}})},E=()=>{!l&&!n.isAiGame&&C&&i("resign")},I=H=>{if(v!=="playing")return;r({type:H==="hidden"?"START_HIDDEN_PLACEMENT":H==="scan"?"START_SCANNING":"START_MISSILE_SELECTION",payload:{gameId:y}})},A=(o.id===g?$.Black:$.White)===$.Black?$.White:$.Black,O=f.useMemo(()=>!n.hiddenMoves||!n.moveHistory?!1:Object.entries(n.hiddenMoves).some(([H,te])=>{var X,ee;if(!te)return!1;const le=n.moveHistory[parseInt(H)];if(!le||le.player!==A)return!1;const{x:ce,y:ve}=le;return((X=n.boardState[ve])==null?void 0:X[ce])!==A?!1:!((ee=n.permanentlyRevealedStones)==null?void 0:ee.some(xe=>xe.x===ce&&xe.y===ve))}),[n.hiddenMoves,n.moveHistory,n.boardState,n.permanentlyRevealedStones,A]),B="whitespace-nowrap text-[clamp(0.6rem,2.2vmin,0.875rem)] px-[clamp(0.4rem,1.8vmin,0.75rem)] py-[clamp(0.2rem,0.8vmin,0.4rem)]",V=()=>{const H=b===T.Hidden||b===T.Mix&&(n.settings.mixedModes||[]).includes(T.Hidden),te=b===T.Missile||b===T.Mix&&(n.settings.mixedModes||[]).includes(T.Missile),le=n.player1.id,ce=o.id===le?n.hidden_stones_used_p1??0:n.hidden_stones_used_p2??0,ve=o.id===le?n.scans_p1:n.scans_p2,F=o.id===le?n.missiles_p1:n.missiles_p2,X=(n.settings.hiddenStoneCount||0)-ce;return t.jsxs(t.Fragment,{children:[" ",H&&t.jsxs(z,{onClick:()=>I("hidden"),disabled:!s||l||v!=="playing"||X<=0,colorScheme:"purple",className:B,children:[" (",X,")"]})," ",H&&t.jsxs(z,{onClick:()=>I("scan"),disabled:!s||l||v!=="playing"||(ve??0)<=0||!O,colorScheme:"purple",className:B,children:[" (",ve??0,")"]})," ",te&&t.jsxs(z,{onClick:()=>I("missile"),disabled:!s||l||v!=="playing"||(F??0)<=0,colorScheme:"orange",className:B,children:[" (",F??0,")"]})," "]})},D=b===T.Hidden||b===T.Missile||b===T.Mix&&(n.settings.mixedModes||[]).some(H=>[T.Hidden,T.Missile].includes(H));if(l&&!o.isAdmin)return null;const L=(n.maxActionButtonUses??0)-(((W=n.actionButtonUses)==null?void 0:W[o.id])??0),q=n.maxActionButtonUses,U=typeof L=="number"&&typeof q=="number"?`(${L})`:"";return n.isAnalyzing,t.jsxs("footer",{className:"responsive-controls flex-shrink-0 bg-gray-800 rounded-lg p-1 flex flex-col items-stretch justify-center gap-1 w-full",children:[m&&h.features.mobileConfirm&&d&&t.jsxs("div",{className:"flex gap-4 p-2 justify-center",children:[t.jsx(z,{onClick:p,colorScheme:"red",className:"!py-3 !px-6",children:""}),t.jsx(z,{onClick:u,colorScheme:"green",className:"!py-3 !px-6 animate-pulse",children:""})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-md p-2 flex flex-row items-center gap-4 w-full",children:[t.jsxs("h3",{className:"text-xs font-bold text-gray-300 whitespace-nowrap",children:["  ",U]}),t.jsx("div",{className:"flex-grow flex items-center justify-center",children:t.jsx(lb,{session:n,isSpectator:l,onAction:r,currentUser:o})})]}),t.jsxs("div",{className:"flex flex-col lg:flex-row gap-1 w-full",children:[t.jsxs("div",{className:"bg-gray-900/50 rounded-md p-2 flex flex-row items-center gap-4 flex-1 min-w-0",children:[t.jsx("h3",{className:"text-xs font-bold text-gray-300 whitespace-nowrap",children:" "}),t.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap flex-grow",children:S?t.jsx(z,{onClick:()=>a(!0),colorScheme:"yellow",className:B,children:" "}):t.jsxs(t.Fragment,{children:[M&&b!==T.Capture&&t.jsx(z,{onClick:_,disabled:!s||l||k,colorScheme:"blue",className:B,children:""}),t.jsx(z,{onClick:E,disabled:l||n.isAiGame||k,colorScheme:"red",className:B,children:""})]})})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-md p-2 flex flex-row items-center gap-4 flex-1 min-w-0",children:[t.jsx("h3",{className:"text-xs font-bold text-gray-300 whitespace-nowrap",children:M?" ":" "}),t.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap flex-grow",children:M?t.jsx(t.Fragment,{children:!S&&D&&V()}):b===T.Dice?t.jsx(rb,{session:n,isMyTurn:s,onAction:r,currentUser:o}):b===T.Thief?t.jsx(ob,{session:n,isMyTurn:s,onAction:r,currentUser:o}):b===T.Curling?t.jsx(cb,{session:n,isMyTurn:s,onAction:r,currentUser:o}):b===T.Alkkagi?t.jsx(ab,{session:n,isMyTurn:s,onAction:r,currentUser:o}):t.jsx(ib,{session:n,currentUser:o})})]})]}),l&&o.isAdmin&&C&&t.jsxs("div",{className:"bg-purple-900/50 rounded-md p-2 flex flex-row items-center gap-4 w-full mt-1",children:[t.jsx("h3",{className:"text-xs font-bold text-purple-300 whitespace-nowrap",children:" "}),t.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap flex-grow",children:[t.jsxs(z,{onClick:()=>{window.confirm(`${j.nickname}  ?`)&&r({type:"ADMIN_FORCE_WIN",payload:{gameId:y,winnerId:j.id}})},colorScheme:"purple",className:B,children:[j.nickname," "]}),t.jsxs(z,{onClick:()=>{window.confirm(`${w.nickname}  ?`)&&r({type:"ADMIN_FORCE_WIN",payload:{gameId:y,winnerId:w.id}})},colorScheme:"purple",className:B,children:[w.nickname," "]})]})]})]})},ub=({session:e,currentUser:n})=>{const{disconnectionState:s,player1:l,player2:r,disconnectionCounts:a}=e,[i,o]=f.useState(90);if(!s)return null;const c=s.disconnectedPlayerId===l.id?l:r,d=c.id===n.id,u=(a==null?void 0:a[c.id])||1;return f.useEffect(()=>{const p=()=>{const h=(Date.now()-s.timerStartedAt)/1e3,y=Math.max(0,90-Math.floor(h));o(y)},m=setInterval(p,1e3);return p(),()=>clearInterval(m)},[s.timerStartedAt]),t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-md p-8 border border-gray-700 text-center",children:[t.jsxs("h2",{className:"text-2xl font-bold text-yellow-400 mb-4",children:["   (",u,"/3)"]}),t.jsx("div",{className:"flex justify-center items-center my-6",children:t.jsx("div",{className:"animate-pulse rounded-full h-16 w-16 border-4 border-yellow-400 flex items-center justify-center",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),t.jsxs("p",{className:"text-lg text-white mb-2",children:[t.jsx("span",{className:"font-bold",children:c.nickname}),"   ."]}),t.jsx("p",{className:"text-gray-300",children:"  ..."}),t.jsxs("p",{className:"text-4xl font-mono font-bold my-4 text-white",children:[i,""]}),d&&t.jsx("p",{className:"text-sm text-red-400 bg-red-900/50 p-2 rounded-md",children:"  ."})]})})},mb=({session:e,onAction:n,currentUser:s})=>{if(e.gameStatus==="ended"||e.gameStatus==="no_contest"){const u=e.winner===$.Black,p=Jl.findIndex(g=>g.id===e.stageId),m=Jl[p+1],h=u&&m&&(s.singlePlayerProgress??0)>p,y=()=>{n({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:e.stageId}})},b=()=>{h&&n({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:m.id}})},v=()=>{sessionStorage.setItem("postGameRedirect","#/singleplayer"),n({type:"LEAVE_AI_GAME",payload:{gameId:e.id}})};return t.jsxs("div",{className:"bg-stone-800/60 backdrop-blur-sm rounded-lg p-2 flex items-center justify-center gap-2 w-full border border-stone-700/50",children:[t.jsx(z,{onClick:v,colorScheme:"gray",className:"flex-1 !text-sm",children:""}),t.jsx(z,{onClick:y,colorScheme:"yellow",className:"flex-1 !text-sm",children:""}),t.jsxs(z,{onClick:b,colorScheme:"accent",disabled:!h,className:"flex-1 !text-sm",children:[" ",m?`: ${m.name.replace(" ","")}`:""]})]})}const l=e.singlePlayerPlacementRefreshesUsed||0,r=e.moveHistory.length===0&&l<5,i=[0,50,100,200,300][l]||0,o=s.gold>=i,c=()=>{r&&o&&n({type:"SINGLE_PLAYER_REFRESH_PLACEMENT",payload:{gameId:e.id}})},d=()=>{window.confirm("    ?")&&(window.location.hash="#/singleplayer")};return t.jsxs("div",{className:"bg-stone-800/60 backdrop-blur-sm rounded-lg p-2 flex items-center justify-between gap-4 w-full h-full border border-stone-700/50",children:[t.jsx(z,{onClick:d,colorScheme:"red",className:"!text-sm",children:""}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"text-xs text-stone-400",children:[" : ",r?i:"-"]}),t.jsxs(z,{onClick:c,colorScheme:"accent",className:"!text-sm",disabled:!r||!o,title:o?"":" .",children:["  (",5-l,"/5)"]})]})]})},Ru=[{term:"()",meaning:"   ."},{term:"()",meaning:"    ,   ."},{term:"()",meaning:"        ."},{term:"()",meaning:"        ."},{term:"()",meaning:"     ."},{term:"()",meaning:"      ."},{term:"()",meaning:",    ."},{term:"()",meaning:"      ."},{term:"()",meaning:"      ."},{term:"()",meaning:"       ."},{term:"()",meaning:"        ."},{term:"   ",meaning:"       ."}],fb=({session:e})=>{const{settings:n}=e;return t.jsxs("div",{className:"h-full bg-stone-800/60 backdrop-blur-sm p-3 rounded-md flex-shrink-0 border border-stone-700/50 text-stone-300",children:[t.jsx("h3",{className:"text-base font-bold border-b border-stone-600/50 pb-1 mb-2 text-amber-300 text-center",children:" "}),t.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-0.5 text-xs",children:[t.jsx("div",{className:"font-semibold text-stone-400",children:" :"}),t.jsxs("div",{children:[n.boardSize,"x",n.boardSize]}),t.jsx("div",{className:"font-semibold text-stone-400",children:"AI :"}),t.jsx("div",{children:n.aiDifficulty}),t.jsx("div",{className:"font-semibold text-stone-400",children:" :"}),t.jsxs("div",{children:[n.captureTarget,""]})]})]})},xb=()=>{const[e,n]=f.useState(0);f.useEffect(()=>{const l=setInterval(()=>{n(r=>(r+1)%Ru.length)},15e3);return()=>clearInterval(l)},[]);const s=Ru[e];return t.jsxs("div",{className:"bg-stone-800/60 backdrop-blur-sm p-3 rounded-md flex-1 border border-stone-700/50 text-stone-300 flex flex-col items-center justify-center text-center",children:[t.jsx("h3",{className:"text-base font-bold border-b border-stone-600/50 pb-1 mb-2 text-amber-300",children:" "}),t.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center",children:[t.jsx("p",{className:"text-2xl font-semibold text-stone-100",children:s.term}),t.jsx("p",{className:"text-sm text-stone-300 mt-2",children:s.meaning})]})]})},pb=({session:e})=>t.jsxs("div",{className:"flex flex-col md:flex-row h-full gap-2",children:[t.jsx(fb,{session:e}),t.jsx(xb,{})]}),gb=e=>{const[n,s]=f.useState({black:e.blackTimeLeft,white:e.whiteTimeLeft});return f.useEffect(()=>{if(["ended","no_contest","scoring"].includes(e.gameStatus)){s({black:e.blackTimeLeft,white:e.whiteTimeLeft});return}const r=e.turnDeadline||e.alkkagiTurnDeadline||e.curlingTurnDeadline||e.alkkagiPlacementDeadline||e.turnChoiceDeadline||e.guessDeadline||e.basePlacementDeadline||e.captureBidDeadline||e.itemUseDeadline;if(!r){s({black:e.blackTimeLeft,white:e.whiteTimeLeft});return}const a=["base_placement","komi_bidding","capture_bidding","alkkagi_simultaneous_placement"].includes(e.gameStatus);let i;const o=()=>{const c=Math.max(0,(r-Date.now())/1e3);a?s({black:c,white:c}):e.currentPlayer===$.Black?s({black:c,white:e.whiteTimeLeft}):e.currentPlayer===$.White?s({black:e.blackTimeLeft,white:c}):s({black:e.blackTimeLeft,white:e.whiteTimeLeft}),i=requestAnimationFrame(o)};return i=requestAnimationFrame(o),()=>cancelAnimationFrame(i)},[e.turnDeadline,e.alkkagiTurnDeadline,e.curlingTurnDeadline,e.alkkagiPlacementDeadline,e.turnChoiceDeadline,e.guessDeadline,e.basePlacementDeadline,e.captureBidDeadline,e.itemUseDeadline,e.currentPlayer,e.blackTimeLeft,e.whiteTimeLeft,e.gameStatus]),{clientTimes:n}};function Bn(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const hb=({session:e})=>{var Se,ze,Be,He;const{currentUser:n,currentUserWithStatus:s,handlers:l,onlineUsers:r,waitingRoomChats:a,gameChats:i,negotiations:o,activeNegotiation:c,settings:d}=De(),{id:u,currentPlayer:p,gameStatus:m,player1:h,player2:y,mode:b,blackPlayerId:v,whitePlayerId:g}=e;if(!(h!=null&&h.id)||!(y!=null&&y.id)||!n||!s)return t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"   ..."});const[x,j]=f.useState(null),w=gb(e),[S,C]=f.useState(!1),[k,M]=f.useState(!1),[_,E]=f.useState(!1),[I,R]=f.useState(null),[A,O]=f.useState(!1),B=Bn(m);Bn(p);const V=Bn(e.captures),D=Bn((Se=e.animation)==null?void 0:Se.type),L=f.useRef(!1),q=Bn((ze=e.moveHistory)==null?void 0:ze.length),U=f.useMemo(()=>(s==null?void 0:s.status)==="spectating",[s]),W=e.isSinglePlayer,[H,te]=f.useState(window.innerWidth<1024),[le,ce]=f.useState(!1),[ve,F]=f.useState(!1),X=f.useMemo(()=>i[e.id]||[],[i,e.id]),ee=Bn(X.length);f.useEffect(()=>{const re=()=>te(window.innerWidth<1024);return window.addEventListener("resize",re),()=>window.removeEventListener("resize",re)},[]),f.useEffect(()=>{!le&&ee!==void 0&&X.length>ee&&F(!0)},[X.length,ee,le]);const xe=()=>{ce(!0),F(!1)};f.useEffect(()=>{(m==="ended"||m==="no_contest")&&B!=="ended"&&B!=="no_contest"&&B!=="rematch_pending"&&(C(!0),M(!0))},[m,B]);const Q=f.useMemo(()=>{var re;return U?$.None:v===n.id?$.Black:g===n.id?$.White:(b===T.Base||b===T.Mix&&((re=e.settings.mixedModes)!=null&&re.includes(T.Base)))&&m==="base_placement"?n.id===h.id?$.Black:$.White:$.None},[n.id,v,g,U,b,m,h.id,y.id,e.settings.mixedModes]),G=f.useMemo(()=>{var re,Te;if(U)return!1;if(m==="alkkagi_simultaneous_placement"&&e.settings.alkkagiPlacementType===" "){const _e=(e.alkkagiStones||[]).filter(ot=>ot.player===Q).length,We=((re=n.id===h.id?e.alkkagiStones_p1:e.alkkagiStones_p2)==null?void 0:re.length)||0;return _e+We<(e.settings.alkkagiStoneCount||5)}switch(m){case"dice_turn_rolling":return((Te=e.turnOrderRolls)==null?void 0:Te[n.id])===null;case"dice_turn_choice":return e.turnChooserId===n.id;case"playing":case"hidden_placing":case"scanning":case"missile_selecting":case"alkkagi_placement":case"alkkagi_playing":case"curling_playing":case"dice_rolling":case"dice_placing":case"thief_rolling":case"thief_placing":return Q!==$.None&&Q===p;case"base_placement":{const _e=n.id===h.id?e.baseStones_p1:e.baseStones_p2;return((_e==null?void 0:_e.length)||0)<(e.settings.baseStones||4)}default:return!1}},[Q,p,m,U,e,n.id,h.id,e.settings]),K=Bn(G);f.useEffect(()=>{G&&!K&&[T.Dice,T.Thief,T.Alkkagi,T.Curling].includes(e.mode)&&Ee.myTurn()},[G,K,e.mode]);const Z=Bn(e.lastMove);f.useEffect(()=>{e.lastMove&&e.lastMove.x!==-1&&JSON.stringify(e.lastMove)!==JSON.stringify(Z)&&(Ye.some(Te=>Te.mode===e.mode)||[T.Omok,T.Ttamok,T.Dice,T.Thief].includes(e.mode))&&Ee.placeStone()},[e.lastMove,Z,e.mode]),f.useEffect(()=>{},[e.captures,V,e.justCaptured,e.blackPlayerId,n.id]),f.useEffect(()=>(m==="scanning"&&B!=="scanning"?Ee.playScanBgm():m!=="scanning"&&B==="scanning"&&Ee.stopScanBgm(),()=>{m==="scanning"&&Ee.stopScanBgm()}),[m,B]),f.useEffect(()=>{const re=e.animation;if(re&&re.type!==D)switch(re.type){case"missile":case"hidden_missile":Ee.launchMissile();break;case"hidden_reveal":_||Ee.revealHiddenStone();break;case"scan":E(!0),setTimeout(()=>E(!1),1e3),re.success?Ee.scanSuccess():Ee.scanFail();break}},[e.animation,D,_]),f.useEffect(()=>{const re=["playing","alkkagi_placement","alkkagi_simultaneous_placement","curling_playing","dice_rolling","thief_rolling"];re.includes(m)&&(B===void 0||!re.includes(B))&&Ee.gameStart()},[m,B]),f.useEffect(()=>()=>Ee.stopScanBgm(),[]),f.useEffect(()=>{const re=["ended","no_contest","scoring"].includes(m),Te=q!==void 0&&e.moveHistory&&e.moveHistory.length>q;if((!G||Te||re)&&L.current&&(Ee.stopTimerWarning(),L.current=!1),G&&!re){const _e=Q===$.Black?w.clientTimes.black:w.clientTimes.white;_e<=10&&_e>0&&!L.current&&(Ee.timerWarning(),L.current=!0)}},[G,w.clientTimes,Q,e.moveHistory,q,m]);const fe=["hidden_placing","scanning","missile_selecting","missile_animating","scanning_animating"].includes(m),we=f.useCallback((re,Te)=>{if(Ee.stopTimerWarning(),U||m==="missile_animating")return;if(H&&d.features.mobileConfirm&&G&&!fe){if(I&&I.x===re&&I.y===Te)return;R({x:re,y:Te});return}let _e=null,We={gameId:u,x:re,y:Te};if((b===T.Omok||b===T.Ttamok)&&m==="playing"&&G)_e="OMOK_PLACE_STONE";else if(m==="scanning"&&G)Ee.stopScanBgm(),_e="SCAN_BOARD";else if(m==="base_placement"){const ot=n.id===h.id?e.baseStones_p1:e.baseStones_p2;((ot==null?void 0:ot.length)||0)<(e.settings.baseStones||4)&&(_e="PLACE_BASE_STONE")}else["playing","hidden_placing"].includes(m)&&G&&(_e="PLACE_STONE",We.isHidden=m==="hidden_placing",We.isHidden&&Ee.stopScanBgm());_e&&l.handleAction({type:_e,payload:We})},[U,m,G,u,l.handleAction,n.id,h.id,e.baseStones_p1,e.baseStones_p2,e.settings.baseStones,b,H,d.features.mobileConfirm,I,fe]),P=f.useCallback(()=>{if(Ee.stopTimerWarning(),!I)return;let re=null,Te={gameId:u,x:I.x,y:I.y};(b===T.Omok||b===T.Ttamok)&&m==="playing"&&G?re="OMOK_PLACE_STONE":["playing","hidden_placing"].includes(m)&&G&&(re="PLACE_STONE",Te.isHidden=m==="hidden_placing"),re&&l.handleAction({type:re,payload:Te}),R(null)},[I,u,l,m,G,b]),Y=f.useCallback(()=>R(null),[]),ae=f.useMemo(()=>{var re,Te;return((re=e.analysisResult)==null?void 0:re[n.id])??(["ended","no_contest"].includes(m)?(Te=e.analysisResult)==null?void 0:Te.system:null)},[e.analysisResult,n.id,m]),oe=f.useMemo(()=>{var re;return U||e.isAiGame?!1:!!((re=e.canRequestNoContest)!=null&&re[n.id])},[e.canRequestNoContest,n.id,U,e.isAiGame]),ue=f.useCallback(()=>{if(U){l.handleAction({type:"LEAVE_SPECTATING"});return}if(["ended","no_contest","rematch_pending"].includes(m)){const re=e.isAiGame?"LEAVE_AI_GAME":"LEAVE_GAME_ROOM";l.handleAction({type:re,payload:{gameId:u}});return}oe?window.confirm("       ?")&&l.handleAction({type:"REQUEST_NO_CONTEST_LEAVE",payload:{gameId:u}}):j("resign")},[U,l.handleAction,e.isAiGame,u,m,oe]),se=f.useMemo(()=>a.global||[],[a]),ge=f.useCallback(()=>{C(!1),M(!1)},[]),je={session:e,onAction:l.handleAction,currentUser:s,waitingRoomChat:se,gameChat:X,isSpectator:U,onlineUsers:r,activeNegotiation:c,negotiations:Object.values(o),onViewUser:l.openViewingUser},me={session:e,isMyTurn:G,isSpectator:U,onAction:l.handleAction,setShowResultModal:C,setConfirmModalType:j,currentUser:s,onlineUsers:r,pendingMove:I,onConfirmMove:P,onCancelMove:Y,settings:d,isMobile:H};return W?t.jsxs("div",{className:"w-full h-dvh flex flex-col p-1 lg:p-4 bg-wood-pattern text-stone-200",children:[t.jsx("button",{onClick:l.openSettingsModal,className:"absolute top-2 right-2 z-30 p-2 rounded-lg text-xl hover:bg-black/20 transition-colors",title:"",children:""}),t.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center gap-2 lg:gap-4 max-w-5xl w-full mx-auto min-h-0",children:[t.jsx("div",{className:"w-full flex-shrink-0",children:t.jsx(Eu,{...je,clientTimes:w.clientTimes,isSinglePlayer:!0})}),t.jsx("div",{className:"flex-1 w-full relative",children:t.jsx("div",{className:"absolute inset-0",children:t.jsx(ku,{...je,isMyTurn:G,myPlayerEnum:Q,handleBoardClick:we,isItemModeActive:fe,showTerritoryOverlay:k,isMobile:H,myRevealedMoves:((Be=e.revealedHiddenMoves)==null?void 0:Be[n.id])||[],showLastMoveMarker:d.features.lastMoveMarker})})}),t.jsxs("div",{className:"w-full flex flex-col-reverse md:flex-row gap-2 lg:gap-4 items-stretch flex-shrink-0",children:[t.jsx("div",{className:"flex-1",children:t.jsx(pb,{session:e})}),t.jsxs("div",{className:"flex flex-col gap-2 flex-shrink-0 w-full md:w-auto",children:[t.jsx(Au,{session:e}),t.jsx(mb,{...je,currentUser:s})]})]})]}),t.jsx(Tu,{...je,confirmModalType:x,onHideConfirmModal:()=>j(null),showResultModal:S,onCloseResults:ge})]}):t.jsxs("div",{className:"w-full h-dvh flex flex-col p-1 lg:p-2 relative max-w-full bg-tertiary",children:[e.disconnectionState&&t.jsx(ub,{session:e,currentUser:n}),e.gameStatus==="scoring"&&t.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center z-30",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-gray-100 mb-4"}),t.jsx("p",{className:"text-xl font-bold text-white",children:" ..."})]}),t.jsx("button",{onClick:l.openSettingsModal,className:"absolute top-2 right-2 z-30 p-2 rounded-lg text-xl hover:bg-secondary/50 transition-colors",title:"",children:""}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-2 min-h-0",children:[t.jsx("main",{className:"flex-1 flex items-center justify-center min-w-0 min-h-0",children:t.jsxs("div",{className:"w-full h-full max-h-full max-w-full lg:max-w-[calc(100vh-8rem)] flex flex-col items-center gap-1 lg:gap-2",children:[t.jsx("div",{className:"flex-shrink-0 w-full",children:t.jsx(Eu,{...je,clientTimes:w.clientTimes})}),t.jsx("div",{className:"flex-1 w-full relative",children:t.jsx("div",{className:"absolute inset-0",children:t.jsx(ku,{...je,isMyTurn:G,myPlayerEnum:Q,handleBoardClick:we,isItemModeActive:fe,showTerritoryOverlay:k,isMobile:H,myRevealedMoves:((He=e.revealedHiddenMoves)==null?void 0:He[n.id])||[],showLastMoveMarker:d.features.lastMoveMarker})})}),t.jsxs("div",{className:"flex-shrink-0 w-full flex flex-col gap-1",children:[t.jsx(Au,{session:e}),t.jsx(db,{...me})]})]})}),!H&&t.jsx("div",{className:"w-full lg:w-[320px] xl:w-[360px] flex-shrink-0",children:t.jsx(Cu,{...je,onLeaveOrResign:ue,isNoContestLeaveAvailable:oe})}),H&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",children:t.jsx("button",{onClick:xe,className:"w-8 h-12 bg-secondary/80 backdrop-blur-sm rounded-l-lg flex items-center justify-center text-primary shadow-lg","aria-label":" ",children:t.jsxs("span",{className:"relative font-bold text-lg",children:["<",ve&&t.jsx("div",{className:"absolute -top-1 -right-1.5 w-2.5 h-2.5 bg-danger rounded-full border-2 border-secondary"})]})})}),t.jsx("div",{className:`fixed top-0 right-0 h-full w-[280px] bg-secondary shadow-2xl z-50 transition-transform duration-300 ease-in-out ${le?"translate-x-0":"translate-x-full"}`,children:t.jsx(Cu,{...je,onLeaveOrResign:ue,isNoContestLeaveAvailable:oe,onClose:()=>ce(!1)})}),le&&t.jsx("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:()=>ce(!1)})]})]}),A&&ae&&t.jsx(nb,{session:e,result:ae,onClose:()=>O(!1)}),t.jsx(Tu,{...je,confirmModalType:x,onHideConfirmModal:()=>j(null),showResultModal:S,onCloseResults:ge})]})},yb=({onNavigate:e,onBackToProfile:n,liveGames:s,onAction:l})=>{const r=a=>{window.confirm(`[${a.player1.nickname} vs ${a.player2.nickname}]   ?`)&&l({type:"ADMIN_FORCE_DELETE_GAME",payload:{gameId:a.id}})};return t.jsxs("div",{className:"bg-primary text-primary",children:[t.jsxs("header",{className:"flex justify-between items-center mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold",children:" "}),t.jsx("button",{onClick:n,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{onClick:()=>e("userManagement"),className:"bg-blue-800/50 hover:bg-blue-700/50 p-6 rounded-lg shadow-lg cursor-pointer transition-all transform hover:-translate-y-1 border border-color",children:[t.jsx("h2",{className:"text-2xl font-bold text-blue-300",children:" "}),t.jsx("p",{className:"mt-2 text-gray-400",children:"  ,  ,    ."})]}),t.jsxs("div",{onClick:()=>e("mailSystem"),className:"bg-green-800/50 hover:bg-green-700/50 p-6 rounded-lg shadow-lg cursor-pointer transition-all transform hover:-translate-y-1 border border-color",children:[t.jsx("h2",{className:"text-2xl font-bold text-green-300",children:"  "}),t.jsx("p",{className:"mt-2 text-gray-400",children:"      ."})]}),t.jsxs("div",{onClick:()=>e("serverSettings"),className:"bg-yellow-800/50 hover:bg-yellow-700/50 p-6 rounded-lg shadow-lg cursor-pointer transition-all transform hover:-translate-y-1 border border-color",children:[t.jsx("h2",{className:"text-2xl font-bold text-yellow-300",children:" "}),t.jsx("p",{className:"mt-2 text-gray-400",children:",        ."})]})]}),t.jsxs("div",{className:"mt-8 bg-panel border border-color p-6 rounded-lg shadow-lg",children:[t.jsxs("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2 text-on-panel",children:["  (",s.length,")"]}),t.jsx("div",{className:"max-h-[40vh] overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm text-left text-secondary",children:[t.jsx("thead",{className:"text-xs text-secondary uppercase bg-secondary sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"px-4 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:" "}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:" "}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:""})]})}),t.jsx("tbody",{children:s.map(a=>t.jsxs("tr",{className:"bg-primary border-b border-color hover:bg-secondary/50",children:[t.jsxs("td",{className:"px-4 py-4 font-medium text-primary whitespace-nowrap",children:[a.player1.nickname," vs ",a.player2.nickname]}),t.jsx("td",{className:"px-4 py-4",children:a.mode}),t.jsx("td",{className:"px-4 py-4",children:a.gameStatus}),t.jsx("td",{className:"px-4 py-4",children:new Date(a.createdAt).toLocaleString()}),t.jsx("td",{className:"px-4 py-4",children:t.jsx("button",{onClick:()=>r(a),className:"font-medium text-red-500 hover:underline",children:" "})})]},a.id))})]})})]})]})},bb=({user:e,currentUser:n,onClose:s,onAction:l})=>{var w,S,C;const[r,a]=f.useState(JSON.parse(JSON.stringify(e))),[i,o]=f.useState("general"),c=k=>{const{name:M,value:_}=k.target;a(E=>({...E,[M]:Number(_)}))},d=k=>{const{name:M,value:_}=k.target;a(E=>({...E,[M]:_}))},u=k=>{const{name:M,checked:_}=k.target;a(E=>({...E,[M]:_}))},p=(k,M)=>{a(_=>{const E={..._.stats||{}};return E[k]||(E[k]={wins:0,losses:0,rankingScore:1200}),E[k].rankingScore=Number(M),{..._,stats:E}})},m=(k,M,_,E)=>{a(I=>{const R=JSON.parse(JSON.stringify(I.quests||{}));if(R[k]&&R[k].quests){const A=R[k].quests.find(O=>O.id===M);A&&(A[_]=E)}return{...I,quests:R}})},h=(k,M)=>{a(_=>{const E=JSON.parse(JSON.stringify(_.quests||{}));return E[k]?E[k].activityProgress=M:E[k]||(E[k]={quests:[],activityProgress:M,claimedMilestones:[!1,!1,!1,!1,!1],lastReset:0}),{..._,quests:E}})},y=(k,M,_)=>{a(E=>{const I=JSON.parse(JSON.stringify(E.quests||{}));return I[k]&&I[k].claimedMilestones&&(I[k].claimedMilestones[M]=_),{...E,quests:I}})},b=()=>{l({type:"ADMIN_UPDATE_USER_DETAILS",payload:{targetUserId:e.id,updatedDetails:r}}),s()},v=k=>{const M=k==="full"?` [${e.nickname}]     ?`:` [${e.nickname}]    ?`;window.confirm(M)&&l({type:"ADMIN_RESET_USER_DATA",payload:{targetUserId:e.id,resetType:k}})},g=()=>{window.confirm(` [${e.nickname}]   ?`)&&(l({type:"ADMIN_DELETE_USER",payload:{targetUserId:e.id}}),s())},x=k=>t.jsx("div",{className:"space-y-2",children:k.map(({mode:M})=>{var _,E;return t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[t.jsx("label",{className:"text-secondary col-span-1",children:M}),t.jsx("input",{type:"number",value:((E=(_=r.stats)==null?void 0:_[M])==null?void 0:E.rankingScore)??1200,onChange:I=>p(M,I.target.value),className:"bg-tertiary p-1 rounded col-span-1"})]},M)})}),j=({title:k,questType:M,questData:_})=>t.jsxs("div",{className:"bg-tertiary/50 p-3 rounded-lg",children:[t.jsx("h3",{className:"font-bold text-lg text-highlight mb-2",children:k}),t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("label",{className:"text-sm font-medium text-secondary whitespace-nowrap",children:":"}),t.jsx("input",{type:"number",value:(_==null?void 0:_.activityProgress)||0,onChange:E=>h(M,parseInt(E.target.value,10)||0),className:"bg-secondary p-1 rounded w-full"})]}),t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("label",{className:"text-sm font-medium text-secondary whitespace-nowrap",children:":"}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:Array.from({length:5}).map((E,I)=>{var R;return t.jsxs("label",{className:"flex items-center gap-1 text-xs",children:[t.jsx("input",{type:"checkbox",checked:((R=_==null?void 0:_.claimedMilestones)==null?void 0:R[I])||!1,onChange:A=>y(M,I,A.target.checked),className:"w-4 h-4"}),I+1]},I)})})]}),t.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2 border-t border-color pt-2",children:((_==null?void 0:_.quests)||[]).map(E=>t.jsxs("div",{className:"bg-primary/50 p-2 rounded-md text-xs",children:[t.jsx("p",{className:"font-semibold truncate",title:E.title,children:E.title}),t.jsxs("div",{className:"flex items-center justify-between gap-2 mt-1",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{children:":"}),t.jsx("input",{type:"number",value:E.progress,onChange:I=>m(M,E.id,"progress",parseInt(I.target.value,10)||0),className:"w-16 bg-secondary p-0.5 rounded text-center"}),t.jsxs("span",{children:["/ ",E.target]})]}),t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"checkbox",checked:E.isClaimed,onChange:I=>m(M,E.id,"isClaimed",I.target.checked),className:"w-4 h-4"}),t.jsx("span",{children:""})]})]})]},E.id))})]});return t.jsx(be,{title:`  : ${e.nickname}`,onClose:s,windowId:`user-edit-${e.id}`,initialWidth:600,children:t.jsxs("div",{className:"flex flex-col h-[60vh]",children:[t.jsxs("div",{className:"flex border-b border-color mb-4",children:[t.jsx("button",{onClick:()=>o("general"),className:`px-4 py-2 ${i==="general"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:" "}),t.jsx("button",{onClick:()=>o("strategic"),className:`px-4 py-2 ${i==="strategic"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:" "}),t.jsx("button",{onClick:()=>o("playful"),className:`px-4 py-2 ${i==="playful"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:" "}),t.jsx("button",{onClick:()=>o("quests"),className:`px-4 py-2 ${i==="quests"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:""}),t.jsx("button",{onClick:()=>o("danger"),className:`px-4 py-2 ${i==="danger"?"border-b-2 border-danger text-danger":"text-tertiary"}`,children:" "})]}),t.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[i==="general"&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:""}),t.jsx("input",{type:"text",name:"nickname",value:r.nickname,onChange:d,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"number",name:"strategyLevel",value:r.strategyLevel,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" XP"}),t.jsx("input",{type:"number",name:"strategyXp",value:r.strategyXp,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"number",name:"playfulLevel",value:r.playfulLevel,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" XP"}),t.jsx("input",{type:"number",name:"playfulXp",value:r.playfulXp,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:""}),t.jsx("input",{type:"number",name:"gold",value:r.gold,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:""}),t.jsx("input",{type:"number",name:"diamonds",value:r.diamonds,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"number",name:"mannerScore",value:r.mannerScore,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"checkbox",name:"isAdmin",checked:!!r.isAdmin,onChange:u,className:"w-5 h-5",disabled:e.id===n.id,title:e.id===n.id?"     .":""})]})]}),i==="strategic"&&t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center font-bold text-sm mb-2 px-1",children:[t.jsx("span",{className:"col-span-1",children:" "}),t.jsx("span",{children:" "})]}),i==="strategic"&&x(Ye),i==="playful"&&t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center font-bold text-sm mb-2 px-1",children:[t.jsx("span",{className:"col-span-1",children:" "}),t.jsx("span",{children:" "})]}),i==="playful"&&x(rt),i==="quests"&&t.jsxs("div",{className:"space-y-4",children:[t.jsx(j,{title:" ",questType:"daily",questData:(w=r.quests)==null?void 0:w.daily}),t.jsx(j,{title:" ",questType:"weekly",questData:(S=r.quests)==null?void 0:S.weekly}),t.jsx(j,{title:" ",questType:"monthly",questData:(C=r.quests)==null?void 0:C.monthly})]}),i==="danger"&&t.jsxs("div",{className:"space-y-4 p-4 border border-danger/50 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-bold text-danger",children:":    ."}),t.jsx(z,{onClick:()=>v("stats"),colorScheme:"yellow",className:"w-full",children:"  "}),t.jsx(z,{onClick:()=>v("full"),colorScheme:"orange",className:"w-full",children:"   "}),t.jsx(z,{onClick:g,colorScheme:"red",className:"w-full",children:" "})]})]}),t.jsxs("div",{className:"flex justify-end gap-4 mt-4 pt-4 border-t border-color",children:[t.jsx(z,{onClick:s,colorScheme:"gray",children:""}),t.jsx(z,{onClick:b,colorScheme:"green",children:""})]})]})})},vb=({allUsers:e,onAction:n,onBack:s,currentUser:l})=>{const[r,a]=f.useState(""),[i,o]=f.useState(null),[c,d]=f.useState(""),[u,p]=f.useState(""),[m,h]=f.useState(""),y=v=>{if(v.preventDefault(),!c||!u||!m){alert("  .");return}n({type:"ADMIN_CREATE_USER",payload:{username:c,password:u,nickname:m}}),d(""),p(""),h("")},b=f.useMemo(()=>{if(!r.trim())return e;const v=r.toLowerCase();return e.filter(g=>g.nickname.toLowerCase().includes(v)||g.username.toLowerCase().includes(v))},[e,r]);return t.jsxs("div",{className:"space-y-8 bg-primary text-primary",children:[i&&t.jsx(bb,{user:i,currentUser:l,onClose:()=>o(null),onAction:n}),t.jsxs("header",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-3xl font-bold",children:" "}),t.jsx("button",{onClick:s,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsxs("div",{className:"lg:col-span-2 bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("h2",{className:"text-xl font-semibold",children:["  (",b.length,")"]}),t.jsx("input",{type:"text",placeholder:"   ...",value:r,onChange:v=>a(v.target.value),className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent w-1/3 p-2.5"})]}),t.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm text-left text-secondary",children:[t.jsx("thead",{className:"text-xs text-secondary uppercase bg-secondary sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"px-6 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-6 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-6 py-3",children:" (/)"}),t.jsx("th",{scope:"col",className:"px-6 py-3",children:""})]})}),t.jsx("tbody",{children:b.map(v=>t.jsxs("tr",{className:"bg-primary border-b border-color hover:bg-secondary/50",children:[t.jsxs("th",{scope:"row",className:"px-6 py-4 font-medium text-primary whitespace-nowrap",children:[" ",v.nickname," ",v.isAdmin&&t.jsx("span",{className:"text-xs text-purple-400 ml-2",children:"[]"})," "]}),t.jsx("td",{className:"px-6 py-4",children:v.username}),t.jsxs("td",{className:"px-6 py-4",children:["S.",v.strategyLevel," / P.",v.playfulLevel]}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("button",{onClick:()=>o(v),className:"font-medium text-blue-500 hover:underline",children:""})})]},v.id))})]})})]}),t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:"  "}),t.jsxs("form",{onSubmit:y,className:"space-y-4",children:[t.jsx("input",{type:"text",name:"username",value:c,onChange:v=>d(v.target.value),placeholder:"",className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5"}),t.jsx("input",{type:"password",name:"password",value:u,onChange:v=>p(v.target.value),placeholder:"",className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5"}),t.jsx("input",{type:"text",name:"nickname",value:m,onChange:v=>h(v.target.value),placeholder:"",className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5"}),t.jsx(z,{type:"submit",className:"w-full",children:""})]})]})]})]})},jb=({onAddItem:e,onClose:n})=>{const[s,l]=f.useState("equipment"),[r,a]=f.useState(null),[i,o]=f.useState(1),c=f.useMemo(()=>{switch(s){case"equipment":return vc;case"consumable":return js;case"material":return Object.values(en);default:return[]}},[s]),d=()=>{r&&i>0&&(e({...r,quantity:i}),a(null),o(1))};return t.jsx(be,{title:" ",onClose:n,windowId:"mail-item-selection",initialWidth:600,children:t.jsxs("div",{className:"h-[60vh] flex flex-col",children:[t.jsxs("div",{className:"flex bg-tertiary/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>l("equipment"),className:`flex-1 py-2 text-sm font-semibold rounded-md ${s==="equipment"?"bg-accent":"text-tertiary"}`,children:""}),t.jsx("button",{onClick:()=>l("consumable"),className:`flex-1 py-2 text-sm font-semibold rounded-md ${s==="consumable"?"bg-accent":"text-tertiary"}`,children:""}),t.jsx("button",{onClick:()=>l("material"),className:`flex-1 py-2 text-sm font-semibold rounded-md ${s==="material"?"bg-accent":"text-tertiary"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 grid grid-cols-4 gap-2",children:c.map(u=>t.jsxs("div",{onClick:()=>a({name:u.name,type:u.type}),className:`p-2 rounded-lg border-2 ${(r==null?void 0:r.name)===u.name?"border-accent ring-2 ring-accent":"border-color bg-secondary/50"} cursor-pointer flex flex-col items-center`,children:[t.jsx("img",{src:u.image,alt:u.name,className:"w-16 h-16 object-contain"}),t.jsx("span",{className:"text-xs text-center mt-1",children:u.name})]},u.name))}),t.jsxs("div",{className:"flex-shrink-0 mt-4 pt-4 border-t border-color flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{children:": "}),t.jsx("input",{type:"number",value:i,onChange:u=>o(Math.max(1,parseInt(u.target.value,10)||1)),className:"bg-tertiary w-20 p-1 rounded"})]}),t.jsx(z,{onClick:d,disabled:!r,children:"  "})]})]})})},wb=({allUsers:e,onAction:n,onBack:s})=>{const[l,r]=f.useState("all"),[a,i]=f.useState(""),[o,c]=f.useState(""),[d,u]=f.useState(""),[p,m]=f.useState(0),[h,y]=f.useState(0),[b,v]=f.useState(0),[g,x]=f.useState(7),[j,w]=f.useState([]),[S,C]=f.useState(!1),[k,M]=f.useState([]),_=I=>{const R=I.target.value;if(i(R),R.length>1){const A=e.filter(O=>O.nickname.toLowerCase().includes(R.toLowerCase())||O.username.toLowerCase().includes(R.toLowerCase())).map(O=>O.nickname).slice(0,5);w(A)}else w([])},E=I=>{if(I.preventDefault(),!o.trim()||!d.trim()){alert("   .");return}if(l==="specific"&&!a.trim()){alert("       .");return}n({type:"ADMIN_SEND_MAIL",payload:{targetSpecifier:l==="all"?"all":a,title:o,message:d,expiresInDays:g,attachments:{gold:p,diamonds:h,actionPoints:b,items:k}}}),c(""),u(""),m(0),y(0),v(0),x(7),i(""),M([])};return t.jsxs("div",{className:"max-w-4xl mx-auto bg-primary text-primary",children:[S&&t.jsx(jb,{onClose:()=>C(!1),onAddItem:I=>M(R=>[...R,I])}),t.jsxs("header",{className:"flex justify-between items-center mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"  "}),t.jsx("button",{onClick:s,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsx("div",{className:"bg-panel border border-color p-6 rounded-lg shadow-lg text-on-panel",children:t.jsxs("form",{onSubmit:E,className:"space-y-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"targetType",value:"all",checked:l==="all",onChange:()=>r("all"),className:"mr-2"})," "]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"targetType",value:"specific",checked:l==="specific",onChange:()=>r("specific"),className:"mr-2"})," "]})]})]}),l==="specific"&&t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:"  "}),t.jsx("input",{type:"text",value:a,onChange:_,className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5",required:!0}),j.length>0&&t.jsx("ul",{className:"absolute z-10 w-full bg-secondary border border-color rounded-lg mt-1",children:j.map(I=>t.jsx("li",{onClick:()=>{i(I),w([])},className:"px-4 py-2 hover:bg-accent cursor-pointer",children:I},I))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:""}),t.jsx("input",{type:"text",value:o,onChange:I=>c(I.target.value),required:!0,className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:""}),t.jsx("textarea",{value:d,onChange:I=>u(I.target.value),rows:4,required:!0,className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:"  (0 = )"}),t.jsx("input",{type:"number",min:"0",value:g,onChange:I=>x(parseInt(I.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsx("input",{type:"number",min:"0",value:b,onChange:I=>v(parseInt(I.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsx("input",{type:"number",min:"0",value:p,onChange:I=>m(parseInt(I.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsx("input",{type:"number",min:"0",value:h,onChange:I=>y(parseInt(I.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]})]}),t.jsxs("div",{className:"pt-2 border-t border-color",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("label",{className:"block font-medium text-secondary",children:["  (",k.length,")"]}),t.jsx(z,{type:"button",onClick:()=>C(!0),colorScheme:"blue",className:"!py-1 !text-xs",children:" "})]}),t.jsxs("div",{className:"bg-tertiary/50 p-2 rounded-md min-h-[50px] space-y-1",children:[k.map((I,R)=>t.jsxs("div",{className:"flex justify-between items-center bg-primary/50 p-1 rounded",children:[t.jsxs("span",{children:[I.name," x ",I.quantity]}),t.jsx("button",{type:"button",onClick:()=>M(A=>A.filter((O,B)=>B!==R)),className:"text-red-500 hover:text-red-400 font-bold px-2",children:"X"})]},R)),k.length===0&&t.jsx("p",{className:"text-tertiary text-center text-xs py-2",children:"  ."})]})]}),t.jsx(z,{type:"submit",className:"w-full py-3",colorScheme:"green",children:""})]})})]})},Nb=e=>{const{gameModeAvailability:n,announcements:s,globalOverrideAnnouncement:l,announcementInterval:r,onAction:a,onBack:i}=e,[o,c]=f.useState(""),[d,u]=f.useState((l==null?void 0:l.message)||""),[p,m]=f.useState(s),[h,y]=f.useState(r),b=f.useRef(null),v=f.useRef(null);f.useEffect(()=>{m(s)},[s]),f.useEffect(()=>{y(r)},[r]),f.useEffect(()=>{u((l==null?void 0:l.message)||"")},[l]);const g=()=>{if(b.current===null||v.current===null||b.current===v.current){b.current=null,v.current=null;return}const S=[...p],C=S.splice(b.current,1)[0];S.splice(v.current,0,C),b.current=null,v.current=null,m(S),a({type:"ADMIN_REORDER_ANNOUNCEMENTS",payload:{announcements:S}})},x=S=>{S.preventDefault(),o.trim()&&(a({type:"ADMIN_ADD_ANNOUNCEMENT",payload:{message:o}}),c(""))},j=S=>{S.preventDefault(),d.trim()&&a({type:"ADMIN_SET_OVERRIDE_ANNOUNCEMENT",payload:{message:d}})},w=f.useMemo(()=>[...Ye,...rt],[]);return t.jsxs("div",{className:"space-y-8 bg-primary text-primary",children:[t.jsxs("header",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-3xl font-bold",children:" "}),t.jsx("button",{onClick:i,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsx("div",{className:"space-y-8",children:t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:"  "}),t.jsx("div",{className:"grid grid-cols-2 gap-3 text-sm",children:w.map(S=>t.jsxs("label",{className:"flex items-center gap-2 p-2 bg-secondary/50 rounded-md",children:[t.jsx("input",{type:"checkbox",checked:n[S.mode]??S.available,onChange:C=>a({type:"ADMIN_TOGGLE_GAME_MODE",payload:{mode:S.mode,isAvailable:C.target.checked}}),className:"w-4 h-4"}),t.jsx("span",{children:S.mode})]},S.mode))})]})}),t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:" "}),t.jsx("div",{className:"space-y-3 mb-4 max-h-60 overflow-y-auto",children:p.map((S,C)=>t.jsxs("div",{draggable:!0,onDragStart:()=>b.current=C,onDragEnter:()=>v.current=C,onDragEnd:g,onDragOver:k=>k.preventDefault(),className:"flex items-center justify-between p-2 bg-secondary/50 rounded-md cursor-grab",children:[t.jsx("span",{className:"text-sm",children:S.message}),t.jsx("button",{onClick:()=>a({type:"ADMIN_REMOVE_ANNOUNCEMENT",payload:{id:S.id}}),className:"text-red-500 hover:text-red-400 font-bold",children:"X"})]},S.id))}),t.jsxs("form",{onSubmit:x,className:"flex gap-2",children:[t.jsx("input",{type:"text",value:o,onChange:S=>c(S.target.value),placeholder:" ...",className:"flex-grow bg-secondary border border-color rounded-lg p-2 text-sm"}),t.jsx(z,{type:"submit",colorScheme:"green",className:"!text-sm",children:""})]}),t.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[t.jsx("label",{className:"text-sm",children:"():"}),t.jsx("input",{type:"number",min:"1",max:"60",value:h,onChange:S=>y(parseInt(S.target.value,10)),className:"w-20 bg-secondary border border-color rounded-lg p-1 text-sm"}),t.jsx(z,{onClick:()=>a({type:"ADMIN_SET_ANNOUNCEMENT_INTERVAL",payload:{interval:h}}),className:"!text-xs",children:""})]})]}),t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:"  "}),t.jsxs("form",{onSubmit:j,className:"flex gap-2",children:[t.jsx("input",{type:"text",value:d,onChange:S=>u(S.target.value),placeholder:"  ...",className:"flex-grow bg-secondary border border-color rounded-lg p-2 text-sm"}),t.jsx(z,{type:"submit",colorScheme:"yellow",className:"!text-sm",children:""})]}),l&&t.jsx(z,{onClick:()=>a({type:"ADMIN_CLEAR_OVERRIDE_ANNOUNCEMENT"}),colorScheme:"red",className:"mt-2 w-full !text-sm",children:"  "})]})]})]})]})},Sb=()=>{const[e,n]=f.useState("dashboard"),{currentUserWithStatus:s,allUsers:l,liveGames:r,adminLogs:a,gameModeAvailability:i,announcements:o,globalOverrideAnnouncement:c,announcementInterval:d,handlers:u}=De(),p=()=>{e==="dashboard"?window.location.hash="#/profile":n("dashboard")},m={currentUser:s,allUsers:l,liveGames:Object.values(r),adminLogs:a,onAction:u.handleAction,onBack:p,gameModeAvailability:i,announcements:o,globalOverrideAnnouncement:c,announcementInterval:d},h=()=>{switch(e){case"userManagement":return t.jsx(vb,{...m});case"mailSystem":return t.jsx(wb,{...m});case"serverSettings":return t.jsx(Nb,{...m});case"dashboard":default:return t.jsx(yb,{onNavigate:n,onBackToProfile:p,...m})}};return t.jsx("div",{className:"p-4 lg:p-8",children:h()})},kb=({onClose:e,isTopmost:n})=>{const s=l=>{const r=l.rankStart===l.rankEnd?`${l.rankStart}`:`${l.rankStart}-${l.rankEnd}`;let a="",i="";switch(l.outcome){case"promote":a="",i="text-green-400";break;case"maintain":a="",i="text-gray-400";break;case"demote":a="",i="text-red-400";break}return t.jsxs("li",{className:"flex justify-between items-center bg-gray-700/50 px-3 py-1.5 rounded-md",children:[t.jsx("span",{className:"font-semibold",children:r}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"flex items-center gap-1 text-yellow-300",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"}),l.diamonds]}),t.jsx("span",{className:`font-bold w-12 text-center ${i}`,children:a})]})]},l.rankStart)};return t.jsx(be,{title:"  ",onClose:e,windowId:"league-tier-info-modal",initialWidth:550,isTopmost:n,children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-300 text-center",children:" 16   // ,       ."}),t.jsx("ul",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-2",children:tl.map(l=>{const r=g0[l.tier];return t.jsxs("li",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("img",{src:l.icon,alt:l.name,className:"w-12 h-12 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold",children:l.name}),t.jsxs("p",{className:"text-xs text-gray-400",children:["  ",l.scoreThreshold.toLocaleString()," "]})]})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700/50",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-1.5",children:" "}),t.jsx("ul",{className:"space-y-1 text-xs",children:r.map(s)})]})]},l.tier)})})]})})},Cb=()=>{const e=[{arena:"",rank:1,points:32},{arena:"",rank:2,points:28},{arena:"",rank:3,points:24},{arena:"",rank:1,points:46},{arena:"",rank:2,points:40},{arena:"",rank:3,points:34},{arena:"",rank:1,points:58},{arena:"",rank:2,points:50},{arena:"",rank:3,points:42}];return t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full flex flex-col",children:[t.jsx("h3",{className:"text-lg font-bold text-center mb-4 flex-shrink-0",children:"   "}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 space-y-4",children:[{arena:"",title:""},{arena:"",title:""},{arena:"",title:""}].map(n=>t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-md shadow-inner",children:[t.jsx("h4",{className:"text-md font-bold text-accent mb-2 border-b border-accent/50 pb-1",children:n.title}),t.jsx("div",{className:"space-y-1",children:e.filter(s=>s.arena===n.arena).map((s,l)=>{const r=s.rank===1?"text-yellow-400":s.rank===2?"text-gray-400":s.rank===3?"text-amber-600":"";return t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsxs("span",{className:"font-semibold",children:[s.rank,""]}),t.jsxs("span",{className:`font-bold ${r}`,children:[s.points,""]})]},l)})})]},n.arena))})]})},Ir=e=>{let n=0;if(e.length===0)return n;for(let s=0;s<e.length;s++){const l=e.charCodeAt(s);n=(n<<5)-n+l,n|=0}return n},Cs=e=>{const n=Math.sin(e)*1e4;return n-Math.floor(n)},Ib=({setHasRankChanged:e})=>{const{currentUserWithStatus:n,allUsers:s,handlers:l}=De(),r=f.useRef(null),[a,i]=f.useState(""),[o,c]=f.useState(()=>{const p=Date.now(),m=new Date(p+324e5);return new Date(m.getFullYear(),m.getMonth(),m.getDate()).getTime()});f.useEffect(()=>{const p=setInterval(()=>{const m=Date.now(),h=new Date(m+324e5),y=new Date(h.getFullYear(),h.getMonth(),h.getDate()).getTime();y!==o&&c(y)},6e4);return()=>clearInterval(p)},[o]),f.useEffect(()=>{const u=()=>{const m=new Date,h=m.getDay(),y=h===0?1:8-h,b=new Date(m.getFullYear(),m.getMonth(),m.getDate()+y);b.setHours(0,0,0,0);const v=b.getTime()-m.getTime(),g=Math.floor(v/(1e3*60*60*24)),x=Math.floor(v%(1e3*60*60*24)/(1e3*60*60)),j=Math.floor(v%(1e3*60*60)/(1e3*60)),w=Math.floor(v%(1e3*60)/1e3);i(`${g}D ${String(x).padStart(2,"0")}:${String(j).padStart(2,"0")}:${String(w).padStart(2,"0")}`)};u();const p=setInterval(u,1e3);return()=>clearInterval(p)},[]);const d=f.useMemo(()=>{if(!(n!=null&&n.weeklyCompetitors))return[];const u=9*60*60*1e3,p=n.lastWeeklyCompetitorsUpdate||o,m=new Date(p+u);m.setHours(0,0,0,0);const h=Math.max(0,o-m.getTime()),y=Math.floor(h/(1e3*60*60*24));let b=n.weeklyCompetitors.map(g=>{if(g.id.startsWith("bot-")){let x=0;for(let S=1;S<=y;S++){const C=`${g.id}-${new Date(m.getTime()+S*24*60*60*1e3).toISOString().slice(0,10)}`,k=Ir(C),M=Cs(k),_=Math.floor(M*26);x+=_}const j=g.initialScore+x,w=j-g.initialScore;return{...g,liveScore:j,scoreChange:w}}else{const x=s.find(S=>S.id===g.id),j=x?x.tournamentScore:g.initialScore,w=j-g.initialScore;return{...g,liveScore:j,scoreChange:w}}});const v=16;if(b.length<v){const g=v-b.length;for(let x=0;x<g;x++){const j=`bot-${o}-${x}`,w=Ir(j),S=1e3+Math.floor(Cs(w)*500),C=Me[Math.floor(Cs(w+1)*Me.length)],k=Re[Math.floor(Cs(w+2)*Re.length)];let M=0;for(let B=1;B<=y;B++){const V=`${j}-${new Date(m.getTime()+B*24*60*60*1e3).toISOString().slice(0,10)}`,D=Ir(V),L=Cs(D),q=Math.floor(L*26);M+=q}const _=S+M,E=_-S,I=["","","","","","","","","","","","","","100%","","","","",""];let R=`Bot ${x+1}`;const A=b.filter(B=>B.id.startsWith("bot-")).map(B=>B.nickname),O=I.filter(B=>!A.includes(B));if(O.length>0){const B=Ir(j+"nickname");R=O[Math.floor(Cs(B)*O.length)]}else I.length>0&&(R=`${I[x%I.length]} ${Math.floor(Math.random()*100)}`);b.push({id:j,nickname:R,avatarId:C.id,borderId:k.id,initialScore:S,liveScore:_,scoreChange:E,league:n.league})}}return b.sort((g,x)=>x.liveScore-g.liveScore)},[n==null?void 0:n.weeklyCompetitors,n==null?void 0:n.lastWeeklyCompetitorsUpdate,s,o]);return f.useEffect(()=>{if(!n)return;const u=d.findIndex(p=>p.id===n.id)+1;u>0&&(r.current!==null&&r.current!==u&&e(!0),r.current=u)},[d,n,e]),!n||!n.weeklyCompetitors||n.weeklyCompetitors.length===0?t.jsx("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0 items-center justify-center text-gray-500",children:"     ..."}):t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0",children:[t.jsxs("div",{className:"flex-shrink-0 text-center mb-3 border-b border-gray-700 pb-2",children:[t.jsx("h2",{className:"text-xl font-bold",children:"  "}),t.jsx("p",{className:"text-sm text-yellow-300 font-mono",children:a})]}),t.jsx("ul",{className:"space-y-1.5 overflow-y-auto pr-2 flex-grow min-h-0",children:d.map((u,p)=>{var j,w;const m=p+1,h=u.id===n.id,y=u.scoreChange>0?"text-green-400":u.scoreChange<0?"text-red-400":"text-gray-400",b=u.scoreChange>0?"":u.scoreChange<0?"":"-",v=(j=Me.find(S=>S.id===u.avatarId))==null?void 0:j.url,g=(w=Re.find(S=>S.id===u.borderId))==null?void 0:w.url,x=!h&&!u.id.startsWith("bot-");return t.jsxs("li",{className:`flex items-center gap-3 p-1.5 rounded-md ${h?"bg-blue-900/50":"bg-gray-900/50"} ${x?"transition-colors cursor-pointer hover:bg-gray-700/50":""}`,onClick:x?()=>l.openViewingUser(u.id):void 0,title:x?`${u.nickname}  `:"",children:[t.jsx("span",{className:"font-bold text-lg w-6 text-center flex-shrink-0",children:m}),t.jsx(Ce,{userId:u.id,userName:u.nickname,avatarUrl:v,borderUrl:g,size:28}),t.jsx("span",{className:"flex-grow font-semibold text-sm truncate",children:u.nickname}),t.jsxs("div",{className:"flex items-baseline gap-1 text-xs",children:[t.jsx("span",{className:"font-mono text-yellow-300",children:u.liveScore.toLocaleString()}),t.jsxs("span",{className:y,children:["(",b,Math.abs(u.scoreChange),")"]})]})]},u.id)})})]})},Bu=({user:e,rank:n,isMyRankDisplay:s})=>{var x,j;const{currentUserWithStatus:l,handlers:r}=De();if(!l)return null;const a=e.tournamentScore||0,i=f.useMemo(()=>n===1?t.jsx("span",{className:"text-3xl",role:"img","aria-label":"Gold Trophy",children:""}):n===2?t.jsx("span",{className:"text-3xl",role:"img","aria-label":"Silver Trophy",children:""}):n===3?t.jsx("span",{className:"text-3xl",role:"img","aria-label":"Bronze Trophy",children:""}):t.jsx("span",{className:"text-2xl font-bold text-gray-300",children:n}),[n]),o=!s&&e.id===l.id,c="flex items-center rounded-lg",d="bg-yellow-900/40 border border-yellow-700",u="bg-blue-900/60 border border-blue-600",p="bg-gray-900/50",m=!s&&e.id!==l.id,h=`${c} ${s?d:o?u:p} p-1.5 lg:p-2 ${m?"cursor-pointer hover:bg-gray-700/50":""}`,y=(x=Me.find(w=>w.id===e.avatarId))==null?void 0:x.url,b=(j=Re.find(w=>w.id===e.borderId))==null?void 0:j.url,v=tl.find(w=>w.tier===e.league),g=v==null?void 0:v.icon;return t.jsxs("li",{className:h,onClick:m?()=>r.openViewingUser(e.id):void 0,title:m?`${e.nickname}  `:"",children:[t.jsx("div",{className:"w-12 text-center flex-shrink-0 flex flex-col items-center justify-center",children:i}),g&&t.jsx("img",{src:g,alt:e.league,className:"w-8 h-8 mr-2 flex-shrink-0",title:e.league}),t.jsx(Ce,{userId:e.id,userName:e.nickname,size:32,avatarUrl:y,borderUrl:b}),t.jsxs("div",{className:"ml-2 lg:ml-3 flex-grow overflow-hidden",children:[t.jsx("p",{className:"font-semibold text-sm truncate",children:e.nickname}),t.jsxs("p",{className:"text-xs text-yellow-400 font-mono",children:[a.toLocaleString(),""]})]})]})},Eb=()=>{const{currentUserWithStatus:e,allUsers:n,handlers:s}=De(),[l,r]=f.useState(tl[0].tier),[a,i]=f.useState(!1);f.useEffect(()=>{e!=null&&e.league&&r(e.league)},[e==null?void 0:e.league]);const o=f.useMemo(()=>e?[...n].filter(u=>u.league===l&&typeof u.tournamentScore=="number").sort((u,p)=>p.tournamentScore-u.tournamentScore):[],[n,l,e]),c=f.useMemo(()=>{if(!e)return{rank:-1,user:null};const u=[...n].filter(m=>m.league===e.league&&typeof m.tournamentScore=="number").sort((m,h)=>h.tournamentScore-m.tournamentScore),p=u.findIndex(m=>m.id===e.id);return{rank:p!==-1?p+1:-1,user:p!==-1?u[p]:null}},[n,e]);if(!e)return t.jsx("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0 items-center justify-center text-gray-500",children:"   ..."});const d=o.slice(0,100);return t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0",children:[a&&t.jsx(kb,{onClose:()=>i(!1)}),t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-gray-700 pb-2 flex-shrink-0",children:[t.jsx("h2",{className:"text-xl font-bold",children:" "}),t.jsx("button",{onClick:()=>i(!0),className:"text-xs bg-gray-600 hover:bg-gray-500 text-white font-bold px-2 py-1 rounded-md transition-colors",children:" "})]}),t.jsx("div",{className:"flex flex-nowrap justify-start bg-gray-900/50 p-1 rounded-lg mb-3 flex-shrink-0 gap-1 tier-tabs-container overflow-x-auto",children:tl.map(u=>t.jsx("button",{onClick:()=>r(u.tier),className:`p-1 rounded-md transition-all duration-200 flex-shrink-0 ${l===u.tier?"bg-purple-600 ring-2 ring-purple-400":"hover:bg-gray-600"}`,title:u.name,children:t.jsx("img",{src:u.icon,alt:u.name,className:"w-10 h-10"})},u.tier))}),c.user&&t.jsx("div",{className:"flex-shrink-0 mb-3",children:t.jsx(Bu,{user:c.user,rank:c.rank,isMyRankDisplay:!0})}),t.jsx("ul",{className:"space-y-2 overflow-y-auto pr-2 flex-grow min-h-0",children:d.length>0?d.map((u,p)=>t.jsx(Bu,{user:u,rank:p+1,isMyRankDisplay:!1},u.id)):t.jsxs("p",{className:"text-center text-gray-500 pt-8",children:[l,"    ."]})},l)]})},Ni=({type:e,onClick:n,onContinue:s,inProgress:l})=>{const r=Ml[e],a=l&&l.status==="round_in_progress",i=l&&(l.status==="complete"||l.status==="eliminated"),o=l&&(l.status==="bracket_ready"||l.status==="round_complete");let c="",d=n;return l&&(a?c=" ":i?c=" ":o&&(c=""),d=s),t.jsxs("div",{className:"group bg-gray-800 rounded-lg p-3 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-purple-500/30 cursor-pointer h-full",onClick:d,children:[t.jsx("h2",{className:"text-lg font-bold mb-2",children:r.name}),t.jsx("div",{className:"w-full aspect-video bg-gray-700 rounded-md flex items-center justify-center text-gray-500 overflow-hidden relative flex-grow",children:t.jsx("img",{src:r.image,alt:r.name,className:"w-full h-full object-cover"})}),t.jsxs("span",{className:"font-bold text-sm mt-2 text-yellow-300",children:[c," "]})]})},Si=e=>e||null,Pb=()=>{const{currentUserWithStatus:e,allUsers:n,handlers:s,waitingRoomChats:l}=De(),[r,a]=f.useState(null),[i,o]=f.useState(window.innerWidth<1024),[c,d]=f.useState(!1),[u,p]=f.useState(!1),[m,h]=f.useState(null);if(!e)return t.jsx("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)] relative text-gray-500 items-center justify-center",children:"   ..."});const y=Si(e.lastNeighborhoodTournament),b=Si(e.lastNationalTournament),v=Si(e.lastWorldTournament),g=f.useCallback(async j=>{await s.handleAction({type:"START_TOURNAMENT_SESSION",payload:{type:j}}),window.location.hash=`#/tournament/${j}`},[s]),x=f.useCallback(async j=>{await s.handleAction({type:"START_TOURNAMENT_ROUND",payload:{type:j}}),window.location.hash=`#/tournament/${j}`},[s]);return t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)] relative",children:[t.jsxs("header",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[t.jsx("button",{onClick:()=>window.location.hash="#/profile",className:"transition-transform active:scale-90 filter hover:drop-shadow-lg",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-10 h-10"})}),t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:""}),t.jsx("div",{className:"w-10"})," "]}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-6 min-h-0",children:[t.jsxs("main",{className:"flex-grow grid grid-cols-12 gap-6 min-h-0",children:[t.jsxs("div",{className:"col-span-12 grid grid-cols-3 gap-4 flex-shrink-0",children:[t.jsx(Ni,{type:"neighborhood",onClick:()=>g("neighborhood"),onContinue:()=>x("neighborhood"),inProgress:y||null}),t.jsx(Ni,{type:"national",onClick:()=>g("national"),onContinue:()=>x("national"),inProgress:b||null}),t.jsx(Ni,{type:"world",onClick:()=>g("world"),onContinue:()=>x("world"),inProgress:v||null})]}),t.jsx("div",{className:"col-span-8 bg-gray-800/50 rounded-lg shadow-lg min-h-0",children:t.jsx(Xl,{messages:l.global||[],mode:"global",onAction:s.handleAction,onViewUser:s.openViewingUser,locationPrefix:"[]"})}),t.jsx("div",{className:"col-span-4",children:t.jsx(Cb,{})})]}),t.jsxs("aside",{className:"hidden lg:flex flex-col lg:w-[480px] flex-shrink-0 gap-6",children:[t.jsxs("div",{className:"flex-1 flex flex-row gap-4 items-stretch min-h-0",children:[t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(Ib,{setHasRankChanged:p})}),t.jsx("div",{className:"w-24 flex-shrink-0",children:t.jsx(Yl,{fillHeight:!0})})]}),t.jsx("div",{className:"flex-1 min-h-0",children:t.jsx(Eb,{})})]})]})]})},Ex=({datasets:e,maxStatValue:n=200,size:s=250})=>{const l=s/2,r=Object.values(N),a=r.length,i=Math.PI*2/a,o=(m,h)=>{const y=i*h-Math.PI/2,b=Math.min(m,n)/n*(l*.8);return{x:l+b*Math.cos(y),y:l+b*Math.sin(y)}},c=[],d=[],u=[],p=s<150?8:10;for(let m=0;m<a;m++){const h=o(n,m);c.push(t.jsx("line",{x1:l,y1:l,x2:h.x,y2:h.y,stroke:"rgba(255, 255, 255, 0.2)",strokeWidth:"1"},`axis-${m}`));const y=o(n*1.15,m);d.push(t.jsx("text",{x:y.x,y:y.y,fontSize:p,fill:"rgba(255, 255, 255, 0.7)",textAnchor:"middle",dy:".3em",children:r[m]},`label-${m}`))}for(let m=1;m<=4;m++){const h=m*.25,y=r.map((b,v)=>o(n*h,v));u.push(t.jsx("polygon",{points:y.map(b=>`${b.x},${b.y}`).join(" "),fill:"none",stroke:"rgba(255, 255, 255, 0.2)",strokeWidth:"0.5"},`grid-${m}`))}return t.jsxs("svg",{viewBox:`0 0 ${s} ${s}`,width:"100%",height:"100%",children:[t.jsxs("g",{children:[u,c,d]}),e.map((m,h)=>{const b=r.map((v,g)=>o(m.stats[v]||0,g)).map(v=>`${v.x},${v.y}`).join(" ");return t.jsx("polygon",{points:b,fill:m.fill,stroke:m.color,strokeWidth:"2"},`dataset-${h}`)})]})},Mb=e=>{try{const n=e.match(/SZ\[(\d+)\]/),s=n?parseInt(n[1],10):19,l=[],r=/;([BW])\[([a-s]{2})\]/g;let a;for(;(a=r.exec(e))!==null;){const i=a[1]==="B"?$.Black:$.White,o=a[2],c=o.charCodeAt(0)-97,d=o.charCodeAt(1)-97;l.push({player:i,x:c,y:d})}return{boardSize:s,moves:l}}catch(n){return console.error("Failed to parse SGF:",n),null}},Px=(e,n,s)=>{const l=[];return e>0&&l.push({x:e-1,y:n}),e<s-1&&l.push({x:e+1,y:n}),n>0&&l.push({x:e,y:n-1}),n<s-1&&l.push({x:e,y:n+1}),l},Tb=(e,n,s,l,r)=>{var d;if(n<0||n>=r||e<0||e>=r||((d=l[n])==null?void 0:d[e])!==s)return null;const a=[{x:e,y:n}],i=new Set([`${e},${n}`]);let o=0;const c=[{x:e,y:n}];for(;a.length>0;){const{x:u,y:p}=a.shift();for(const m of Px(u,p,r)){const h=`${m.x},${m.y}`,y=l[m.y][m.x];y===$.None?o++:y===s&&(i.has(h)||(i.add(h),a.push(m),c.push(m)))}}return{stones:c,liberties:o}},_b=({timeElapsed:e=0,fileIndex:n,showLastMoveOnly:s})=>{const[l,r]=f.useState(null),[a,i]=f.useState(!0),[o,c]=f.useState(null),d=140;f.useEffect(()=>{(async()=>{if(i(!0),c(null),n==null){r({boardSize:19,moves:[]}),i(!1);return}const C=`/sgf/Gibo${n}.sgf`;try{const k=await fetch(C);if(!k.ok)throw new Error(`Failed to fetch SGF file: ${k.statusText}`);const M=await k.text(),_=Mb(M);if(!_)throw new Error("Failed to parse SGF data.");r(_)}catch(k){c(k.message)}finally{i(!1)}})()},[n]);const u=f.useMemo(()=>{if(!l)return 0;if(s)return l.moves.length;if(e===0)return 0;const S=e/d,C=Math.floor(S*l.moves.length);return Math.min(C,l.moves.length)},[e,l,d,s]),p=f.useMemo(()=>{if(!l)return[];const{boardSize:S,moves:C}=l,k=Array(S).fill(null).map(()=>Array(S).fill($.None));for(let M=0;M<u;M++){const _=C[M];k[_.y]&&k[_.y][_.x]!==void 0&&(k[_.y][_.x]=_.player);const E=_.player===$.Black?$.White:$.Black,I=Px(_.x,_.y,S);for(const R of I)if(k[R.y][R.x]===E){const A=Tb(R.x,R.y,E,k,S);if(A&&A.liberties===0)for(const O of A.stones)k[O.y][O.x]=$.None}}return k},[u,l]),m=f.useMemo(()=>{const S=l==null?void 0:l.boardSize;return S?S===19?[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}]:S===13?[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9},{x:6,y:6}]:S===11?[{x:2,y:2},{x:8,y:2},{x:5,y:5},{x:2,y:8},{x:8,y:8}]:S===9?[{x:2,y:2},{x:6,y:2},{x:4,y:4},{x:2,y:6},{x:6,y:6}]:[]:[]},[l]);if(a)return t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"  ..."});if(o)return t.jsxs("div",{className:"flex items-center justify-center h-full text-red-400",children:[": ",o]});if(!l)return null;const{boardSize:h,moves:y}=l,b=300,v=b/h,g=v/2,x=v*.45,j=S=>({cx:g+S.x*v,cy:g+S.y*v}),w=y.slice(0,u);return t.jsx("div",{className:"w-full h-full bg-gray-900 rounded-lg overflow-hidden border-2 border-gray-700 relative",children:t.jsxs("svg",{viewBox:`0 0 ${b} ${b}`,className:"w-full h-full",children:[t.jsx("rect",{width:b,height:b,fill:"#DDAA77"}),Array.from({length:h}).map((S,C)=>t.jsxs("g",{children:[t.jsx("line",{x1:g+C*v,y1:g,x2:g+C*v,y2:b-g,stroke:"#54432a",strokeWidth:"0.5"}),t.jsx("line",{x1:g,y1:g+C*v,x2:b-g,y2:g+C*v,stroke:"#54432a",strokeWidth:"0.5"})]},C)),m.map((S,C)=>t.jsx("circle",{...j(S),r:h>9?3:2,fill:"#54432a"},`star-${C}`)),p.map((S,C)=>S.map((k,M)=>{if(k===$.None)return null;const{cx:_,cy:E}=j({x:M,y:C});let I=-1;for(let A=w.length-1;A>=0;A--)if(w[A].x===M&&w[A].y===C){I=A;break}const R=I===u-1;return t.jsxs("g",{children:[t.jsx("circle",{cx:_,cy:E,r:x,fill:k===$.Black?"black":"white"}),s&&I!==-1&&t.jsx("text",{x:_,y:E,textAnchor:"middle",dy:".35em",fontSize:x*1.2,fontWeight:"bold",fill:k===$.Black?"white":"black",children:I+1}),R&&t.jsx("circle",{cx:_,cy:E,r:x*.4,fill:"rgba(239, 68, 68, 0.8)",className:"animate-pulse"})]},`${M}-${C}`)}))]})})},Ab={early:[N.CombatPower,N.ThinkingSpeed,N.Concentration],mid:[N.CombatPower,N.Judgment,N.Concentration,N.Stability],end:[N.Calculation,N.Stability,N.Concentration]},Lu=({player:e,initialPlayer:n,allUsers:s,currentUserId:l,onViewUser:r,highlightPhase:a})=>{var m,h;if(!e)return t.jsx("div",{className:"p-2 text-center text-gray-500 flex items-center justify-center h-full bg-gray-900/50 rounded-lg",children:"  ..."});const i=f.useMemo(()=>s.find(y=>y.id===e.id),[s,e.id]),o=f.useMemo(()=>{const y={wins:0,losses:0};return i!=null&&i.stats&&Object.values(i.stats).forEach(b=>{y.wins+=b.wins,y.losses+=b.losses}),y},[i]),c=!e.id.startsWith("bot-")&&e.id!==l,d=(m=Me.find(y=>y.id===e.avatarId))==null?void 0:m.url,u=(h=Re.find(y=>y.id===e.borderId))==null?void 0:h.url,p=y=>a==="none"?!1:Ab[a].includes(y);return t.jsxs("div",{className:`bg-gray-900/50 p-3 rounded-lg flex flex-col items-center gap-2 h-full ${c?"cursor-pointer hover:bg-gray-700/50":""}`,onClick:c?()=>r(e.id):void 0,title:c?`${e.nickname}  `:"",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:d,borderUrl:u,size:40}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-bold text-base truncate",children:e.nickname}),t.jsxs("p",{className:"text-xs text-gray-400",children:["(",o.wins," ",o.losses,")"]})]})]}),t.jsxs("div",{className:"font-bold text-sm mt-1 relative",children:[": ",t.jsx("span",{className:"text-yellow-300",children:e.condition===1e3?"-":e.condition})]}),t.jsx("div",{className:"w-full grid grid-cols-2 gap-x-1 sm:gap-x-3 gap-y-0.5 text-xs mt-2 border-t border-gray-600 pt-2",children:Object.values(N).map(y=>{var x;const b=((x=n==null?void 0:n.stats)==null?void 0:x[y])??e.stats[y],g=e.stats[y]-b;return t.jsxs(Pn.Fragment,{children:[t.jsx("span",{className:`text-gray-400 ${p(y)?"text-yellow-400 font-bold":""}`,children:y}),t.jsxs("div",{className:"flex justify-end items-baseline relative",children:[t.jsx("span",{className:`font-mono text-white ${p(y)?"text-yellow-400 font-bold":""}`,children:e.stats[y]}),n&&g!==0&&t.jsxs("span",{className:`ml-1 font-bold ${g>0?"text-green-400":"text-red-400"}`,children:["(",g>0?"+":"",g,")"]})]})]},y)})})]})},Rb=({timeElapsed:e,totalDuration:n})=>{const s=e/n*100,l=Math.min(s,40/140*100),r=Math.min(Math.max(0,s-40/140*100),60/140*100),a=Math.min(Math.max(0,s-100/140*100),40/140*100);return t.jsxs("div",{children:[t.jsxs("div",{className:"w-full bg-gray-900 rounded-full h-2 flex border border-gray-600",children:[t.jsx("div",{className:"bg-green-500 h-full rounded-l-full",style:{width:`${l}%`},title:""}),t.jsx("div",{className:"bg-yellow-500 h-full",style:{width:`${r}%`},title:""}),t.jsx("div",{className:"bg-red-500 h-full rounded-r-full",style:{width:`${a}%`},title:""})]}),t.jsxs("div",{className:"flex text-xs text-gray-400 mt-1",children:[t.jsx("div",{style:{width:`${40/140*100}%`},children:""}),t.jsx("div",{style:{width:`${60/140*100}%`},className:"text-center",children:""}),t.jsx("div",{style:{width:`${40/140*100}%`},className:"text-right",children:""})]})]})},Bb=({p1Percent:e,p2Percent:n,p1Nickname:s,p2Nickname:l})=>t.jsxs("div",{children:[s&&l&&t.jsxs("div",{className:"flex justify-between text-xs px-1 mb-1 font-bold",children:[t.jsxs("span",{className:"truncate max-w-[45%]",children:[": ",s]}),t.jsxs("span",{className:"truncate max-w-[45%] text-right",children:[": ",l]})]}),t.jsxs("div",{className:"flex w-full h-3 bg-gray-700 rounded-full overflow-hidden border-2 border-black/30 relative",children:[t.jsx("div",{className:"bg-black transition-all duration-500 ease-in-out",style:{width:`${e}%`}}),t.jsx("div",{className:"bg-white transition-all duration-500 ease-in-out",style:{width:`${n}%`}}),t.jsx("div",{className:"absolute top-0 bottom-0 left-1/2 -translate-x-1/2 w-0.5 bg-gray-400/50",title:""})]})]}),Lb=e=>{const{text:n,isRandomEvent:s}=e;if(n.startsWith("  !")||n.startsWith("[]"))return t.jsx("strong",{className:"text-yellow-400",children:n});const l=/(\d+\.\d+|\d+\.5)/g,r=n.split(l);return t.jsx("span",{className:s?"text-cyan-400":"",children:r.map((a,i)=>l.test(a)?t.jsx("strong",{className:"text-yellow-400",children:a},i):a)})},$b=({commentary:e,isSimulating:n})=>{const s=f.useRef(null);return f.useEffect(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[e]),t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsxs("h4",{className:"text-center font-bold text-sm mb-2 text-gray-400 py-1 flex-shrink-0",children:[" ",n&&t.jsx("span",{className:"ml-2 text-yellow-400 animate-pulse",children:"  ..."})]}),t.jsx("div",{ref:s,className:"flex-grow overflow-y-auto space-y-2 text-sm text-gray-300 p-2 bg-gray-900/40 rounded-md min-h-0",children:e.length>0?e.map((l,r)=>t.jsx("p",{className:"animate-fade-in break-words",children:Lb(l)},r)):t.jsx("p",{className:"text-gray-500 text-center h-full flex items-center justify-center",children:"   ..."})})]})},Ob=({tournamentState:e,currentUser:n,onAction:s})=>{var b;const l=e.status==="complete",r=e.status==="eliminated";if(!l)return r?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("h4",{className:"font-bold text-gray-400 mb-2",children:" "}),t.jsx("p",{className:"text-xs text-gray-500 mt-2 animate-pulse",children:"    ..."})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("h4",{className:"font-bold text-gray-400 mb-2",children:" "}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"   ."})]});const{type:a,rounds:i}=e,o=Ml[a],c=w0[a];let d=-1;if(a==="neighborhood"){const v={};e.players.forEach(j=>{v[j.id]=0}),i[0].matches.forEach(j=>{j.winner&&(v[j.winner.id]=(v[j.winner.id]||0)+1)});const g=[...e.players].sort((j,w)=>v[w.id]-v[j.id]);let x=-1;for(let j=0;j<g.length;j++)if(j===0?x=1:v[g[j].id]<v[g[j-1].id]&&(x=j+1),g[j].id===n.id){d=x;break}}else{const v=i.length;let g=-1;for(let x=0;x<v;x++){const w=i[x].matches.find(S=>S.isUserMatch);if(w&&((b=w.winner)==null?void 0:b.id)!==n.id){g=x;break}}if(g===-1)d=1;else{const x=o.players/Math.pow(2,g);if(v===3&&g===1){const j=i.find(w=>w.name==="3,4");j&&j.matches.some(S=>S.isUserMatch)?d=j.matches.some(C=>{var k;return C.isUserMatch&&((k=C.winner)==null?void 0:k.id)===n.id})?3:4:d=4}else d=x}}let u;a==="neighborhood"?u=d<=3?d:4:a==="national"?u=d<=4?d:5:d<=4?u=d:d<=8?u=5:u=9;const p=c==null?void 0:c.rewards[u];if(!p)return t.jsx("p",{className:"text-gray-500 flex items-center justify-center h-full",children:"  ."});const m=`${a}RewardClaimed`,h=!!n[m],y=()=>{!h&&l&&(Ee.claimReward(),s({type:"CLAIM_TOURNAMENT_REWARD",payload:{tournamentType:a}}))};return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("h4",{className:"font-bold text-gray-400 mb-2",children:" "}),t.jsx("div",{className:"flex flex-row items-center justify-center gap-4",children:(p.items||[]).map((v,g)=>{const x="itemId"in v?v.itemId:v.name,j=js.find(S=>S.name===x),w=(j==null?void 0:j.image)||"";return t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsxs("button",{onClick:y,disabled:h||!l,className:"relative w-16 h-16 transition-transform hover:scale-105 disabled:cursor-not-allowed",title:h?" ":l?" ":"      .",children:[t.jsx("img",{src:w,alt:x,className:`w-full h-full object-contain ${h||!l?"filter grayscale":""}`}),h&&t.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center text-3xl text-green-400",children:""})]}),t.jsxs("span",{className:"text-xs text-center",children:[x," x",v.quantity]})]},g)})}),!l&&!h&&t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"    "}),h&&t.jsx("p",{className:"text-xs text-green-400 mt-2",children:" ."})]})},Mx=({match:e,currentUser:n})=>{var c,d;const s=e.players[0],l=e.players[1],r=({player:u,isWinner:p})=>{var v,g;if(!u)return t.jsx("div",{className:"h-8 flex items-center",children:t.jsx("span",{className:"text-gray-600 truncate",children:"..."})});const m=!p&&e.isFinished?"opacity-60":"",h=p?"text-yellow-300":"",y=(v=Me.find(x=>x.id===u.avatarId))==null?void 0:v.url,b=(g=Re.find(x=>x.id===u.borderId))==null?void 0:g.url;return t.jsxs("div",{className:`flex items-center gap-2 ${m}`,children:[t.jsx(Ce,{userId:u.id,userName:u.nickname,avatarUrl:y,borderUrl:b,size:28}),t.jsx("span",{className:`truncate font-semibold ${h}`,children:u.nickname})]})},a=e.isFinished&&((c=e.winner)==null?void 0:c.id)===(s==null?void 0:s.id),i=e.isFinished&&((d=e.winner)==null?void 0:d.id)===(l==null?void 0:l.id),o=(s==null?void 0:s.id)===n.id||(l==null?void 0:l.id)===n.id;return t.jsxs("div",{className:`p-1.5 rounded-lg text-sm space-y-1 ${o?"bg-blue-900/40 border border-blue-700":"bg-gray-700/50"}`,children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(r,{player:s,isWinner:a}),a&&t.jsx("span",{className:"font-bold text-green-400",children:"W"})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(r,{player:l,isWinner:i}),i&&t.jsx("span",{className:"font-bold text-green-400",children:"W"})]})]})},Er=({name:e,matches:n,currentUser:s})=>t.jsxs("div",{className:"flex flex-col justify-around h-full gap-4 flex-shrink-0 w-44",children:[t.jsx("h5",{className:"text-center font-bold text-sm text-gray-400",children:e}),t.jsx("div",{className:"flex flex-col justify-around h-full gap-6",children:n==null?void 0:n.map(l=>t.jsx(Mx,{match:l,currentUser:s},l.id))})]}),Db=({tournamentState:e,currentUser:n})=>{var b;const[s,l]=f.useState("matches"),{players:r,rounds:a,status:i,currentRoundRobinRound:o}=e,c=((b=a[0])==null?void 0:b.matches)||[],d=f.useMemo(()=>{const v={};return r.forEach(g=>{v[g.id]={wins:0,losses:0}}),c.forEach(g=>{if(g.isFinished&&g.winner){const x=g.winner.id;v[x]&&v[x].wins++;const j=g.players.find(w=>w&&w.id!==x);j&&v[j.id]&&v[j.id].losses++}}),v},[r,c]),u=f.useMemo(()=>[...r].sort((v,g)=>{var x,j;return(((x=d[g.id])==null?void 0:x.wins)||0)-(((j=d[v.id])==null?void 0:j.wins)||0)}),[r,d]),p=[[[0,5],[1,4],[2,3]],[[0,4],[5,3],[1,2]],[[0,3],[4,2],[5,1]],[[0,2],[3,1],[4,5]],[[0,1],[2,5],[3,4]]],m=i==="bracket_ready"?1:o||1,h=p[m-1],y=f.useMemo(()=>h?h.map(v=>{const g=r[v[0]].id,x=r[v[1]].id;return c.find(j=>{var w,S,C,k;return((w=j.players[0])==null?void 0:w.id)===g&&((S=j.players[1])==null?void 0:S.id)===x||((C=j.players[0])==null?void 0:C.id)===x&&((k=j.players[1])==null?void 0:k.id)===g})}).filter(v=>!!v):[],[h,r,c]);return t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsx("h4",{className:"font-bold text-center mb-2 flex-shrink-0 text-gray-300",children:" "}),t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-2 flex-shrink-0",children:[t.jsxs("button",{onClick:()=>l("matches"),className:`flex-1 py-1 text-xs font-semibold rounded-md transition-all ${s==="matches"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:[m,""]}),t.jsx("button",{onClick:()=>l("ranking"),className:`flex-1 py-1 text-xs font-semibold rounded-md transition-all ${s==="ranking"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "})]}),t.jsx("div",{className:"overflow-y-auto pr-2 flex-grow min-h-0",children:s==="matches"?t.jsx("div",{className:"flex flex-col items-center justify-around h-full gap-4",children:y.map(v=>t.jsx(Mx,{match:v,currentUser:n},v.id))}):t.jsx("ul",{className:"space-y-1.5",children:u.map((v,g)=>{const x=d[v.id],j=v.id===n.id;return t.jsxs("li",{className:`flex items-center gap-3 p-1.5 rounded-md ${j?"bg-blue-900/50":"bg-gray-700/50"}`,children:[t.jsx("span",{className:"font-bold text-lg w-6 text-center flex-shrink-0",children:g+1}),t.jsx("span",{className:"flex-grow font-semibold text-sm truncate",children:v.nickname}),t.jsx("div",{className:"flex items-baseline gap-2 text-xs",children:t.jsxs("span",{className:"font-mono",children:[x.wins," ",x.losses,""]})})]},v.id)})})})]})},qb=({rounds:e,currentUser:n,tournamentType:s})=>{const l=f.useMemo(()=>{const d=new Map;e.forEach(m=>d.set(m.name,m.matches));let u=[];if(s==="world")u=["16","8","4","  3/4"];else if(s==="national")u=["8","4","  3/4"];else return null;return u.map(m=>{let h=[];return m==="  3/4"?h=(d.get("")||[]).concat(d.get("3,4")||[]):h=d.get(m)||[],{name:m,matches:h,isInProgress:h.length>0&&h.some(y=>!y.isFinished)}}).filter(m=>m.matches.length>0)},[e,s]),r=f.useMemo(()=>{if(!l)return 0;const d=l.findIndex(u=>u.isInProgress);return d!==-1?d:Math.max(0,l.length-1)},[l]),[a,i]=f.useState(r);if(f.useEffect(()=>{i(r)},[r]),!l){const d=["16","8","4","3,4",""],u=[...e].sort((p,m)=>d.indexOf(p.name)-d.indexOf(m.name));return t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsx("h4",{className:"font-bold text-center mb-2 flex-shrink-0 text-gray-300",children:""}),t.jsx("div",{className:"flex-grow overflow-auto flex items-center justify-center p-2 space-x-4",children:u.map(p=>t.jsx(Er,{name:p.name,matches:p.matches,currentUser:n},p.id))})]})}const o=l[a],c=d=>{if(d.name==="  3/4"){const u=d.matches.filter(m=>{var h;return((h=e.find(y=>y.matches.includes(m)))==null?void 0:h.name)===""}),p=d.matches.filter(m=>{var h;return((h=e.find(y=>y.matches.includes(m)))==null?void 0:h.name)==="3,4"});return t.jsxs("div",{className:"flex flex-col justify-center items-center h-full gap-12 p-4",children:[t.jsx(Er,{name:"",matches:u,currentUser:n}),p.length>0&&t.jsx(Er,{name:"3,4",matches:p,currentUser:n})]})}return t.jsx("div",{className:"flex justify-center items-center h-full gap-4 p-4",children:t.jsx(Er,{name:d.name,matches:d.matches,currentUser:n})})};return t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsx("h4",{className:"font-bold text-center mb-2 flex-shrink-0 text-gray-300",children:""}),t.jsx("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-2 flex-shrink-0",children:l.map((d,u)=>t.jsx("button",{onClick:()=>i(u),className:`flex-1 py-1 text-xs font-semibold rounded-md transition-all ${a===u?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:d.name},d.name))}),t.jsx("div",{className:"flex-grow overflow-auto",children:o&&c(o)})]})},Ub=e=>{var le,ce,ve;const{tournament:n,currentUser:s,onBack:l,allUsersForRanking:r,onViewUser:a,onAction:i,onStartNextRound:o,onReset:c,onSkip:d,isMobile:u}=e,[p,m]=f.useState(null),[h,y]=f.useState({p1:null,p2:null}),b=f.useRef(n.status),v=f.useMemo(()=>Array.isArray(n.rounds)?n.rounds:[],[n.rounds]);f.useEffect(()=>(i({type:"ENTER_TOURNAMENT_VIEW"}),()=>{i({type:"LEAVE_TOURNAMENT_VIEW"})}),[i]),f.useEffect(()=>{const F=n.status,X=b.current;if((F==="round_complete"||F==="eliminated"||F==="complete")&&X==="round_in_progress"){const ee=[...v].reverse().flatMap(xe=>xe.matches).find(xe=>xe.isUserMatch&&xe.isFinished);ee&&ee.sgfFileIndex&&m(ee.sgfFileIndex)}else if(F==="bracket_ready")m(null);else if(F==="round_in_progress"&&n.timeElapsed===1){const ee=n.currentSimulatingMatch;if(ee){const xe=v[ee.roundIndex].matches[ee.matchIndex],Q=n.players.find(K=>{var Z;return K.id===((Z=xe.players[0])==null?void 0:Z.id)})||null,G=n.players.find(K=>{var Z;return K.id===((Z=xe.players[1])==null?void 0:Z.id)})||null;y({p1:Q?JSON.parse(JSON.stringify(Q)):null,p2:G?JSON.parse(JSON.stringify(G)):null})}}else F!=="round_in_progress"&&y({p1:null,p2:null});b.current=F},[n,v]);const g=f.useCallback(()=>{n.status==="round_in_progress"?window.confirm(" .  ?     .")&&i({type:"FORFEIT_TOURNAMENT",payload:{type:n.type}}):l()},[l,i,n.status,n.type]),x=f.useCallback(()=>{window.confirm("  ?    .")&&i({type:"FORFEIT_TOURNAMENT",payload:{type:n.type}})},[i,n.type]),j=n.status==="round_in_progress",w=j&&n.currentSimulatingMatch?v[n.currentSimulatingMatch.roundIndex].matches[n.currentSimulatingMatch.matchIndex]:null,S=f.useMemo(()=>[...v].reverse().flatMap(F=>F.matches).find(F=>F.isUserMatch&&F.isFinished),[v]),C=j?w:S||v.flatMap(F=>F.matches).find(F=>F.isUserMatch)||((le=v[0])==null?void 0:le.matches[0]),k=f.useMemo(()=>{var F;if(n.status!=="complete")return null;if(n.type==="neighborhood"){const X={};return n.players.forEach(ee=>X[ee.id]=0),v[0].matches.forEach(ee=>{ee.winner&&X[ee.winner.id]++}),[...n.players].sort((ee,xe)=>X[xe.id]-X[ee.id])[0]}else{const X=v.find(ee=>ee.name==="");return(F=X==null?void 0:X.matches[0])==null?void 0:F.winner}},[n.status,n.type,n.players,v]),M=f.useMemo(()=>{var X,ee;if(n.status==="complete"||n.status==="eliminated"){if(n.type==="neighborhood"){const Q=v.flatMap(Y=>Y.matches).filter(Y=>Y.isUserMatch&&Y.isFinished),G=Q.filter(Y=>{var ae;return((ae=Y.winner)==null?void 0:ae.id)===s.id}).length,K=Q.length-G,Z={};n.players.forEach(Y=>{Z[Y.id]=0}),v[0].matches.forEach(Y=>{Y.winner&&(Z[Y.winner.id]=(Z[Y.winner.id]||0)+1)});const fe=[...n.players].sort((Y,ae)=>Z[ae.id]-Z[Y.id]);let we=-1,P=1;for(let Y=0;Y<fe.length;Y++)if(Y>0&&Z[fe[Y].id]<Z[fe[Y-1].id]&&(P=Y+1),fe[Y].id===s.id){we=P;break}return`${G} ${K}! ${we}`}if((k==null?void 0:k.id)===s.id)return" !";const xe=[...v].reverse().flatMap(Q=>Q.matches).find(Q=>Q.isUserMatch&&Q.isFinished);if(xe){const Q=v.find(G=>G.matches.some(K=>K.id===xe.id));if((Q==null?void 0:Q.name)==="")return"!";if((Q==null?void 0:Q.name)==="4"){const G=v.flatMap(K=>K.matches).find(K=>{const Z=v.find(fe=>fe.matches.some(we=>we.id===K.id));return K.isUserMatch&&(Z==null?void 0:Z.name)==="3,4"});if(G)return((X=G.winner)==null?void 0:X.id)===s.id?"3":"4"}return`${(Q==null?void 0:Q.name)||""} `}return" "}if(n.status==="round_complete"||n.status==="bracket_ready"){const xe=[...v].reverse().flatMap(Q=>Q.matches).find(Q=>Q.isUserMatch&&Q.isFinished);if(xe){const Q=((ee=xe.winner)==null?void 0:ee.id)===s.id;if(n.type==="neighborhood"){const G=v.flatMap(fe=>fe.matches).filter(fe=>fe.isUserMatch&&fe.isFinished),K=G.filter(fe=>{var we;return((we=fe.winner)==null?void 0:we.id)===s.id}).length,Z=G.length-K;return`${G.length} ${Q?"":""}! (${K} ${Z})`}else if(Q){const G=v.find(K=>K.matches.some(Z=>!Z.isFinished&&Z.players.some(fe=>(fe==null?void 0:fe.id)===s.id)));if(G)return`${G.name} !`}}}const F=v.find(xe=>xe.matches.some(Q=>Q.isUserMatch&&!Q.isFinished));return F?`${F.name}  `:"  "},[s.id,n,k,v]),_=(C==null?void 0:C.players[0])||null,E=(C==null?void 0:C.players[1])||null,I=_?n.players.find(F=>F.id===_.id)||_:null,R=E?n.players.find(F=>F.id===E.id)||E:null,A=f.useMemo(()=>[{stats:(I==null?void 0:I.stats)||{},color:"#60a5fa",fill:"rgba(59, 130, 246, 0.4)"},{stats:(R==null?void 0:R.stats)||{},color:"#f87171",fill:"rgba(239, 68, 68, 0.4)"}],[I,R]),O=f.useMemo(()=>{if(!I||!R)return 200;const F=[...Object.values(I.stats),...Object.values(R.stats)],X=Math.max(...F,0);return Math.ceil((X+50)/50)*50},[I,R]),B=f.useMemo(()=>{if(n.status!=="round_in_progress")return"none";const F=n.timeElapsed;return F<=40?"early":F<=100?"mid":F<=140?"end":"none"},[n.timeElapsed,n.status]),V=((ce=n.currentMatchScores)==null?void 0:ce.player1)||0,D=((ve=n.currentMatchScores)==null?void 0:ve.player2)||0,L=V+D,q=L>0?V/L*100:50,U=L>0?D/L*100:50,W=()=>{const{status:F}=n;if(F==="round_in_progress")return t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(z,{disabled:!0,colorScheme:"green",children:"  ..."}),t.jsx(z,{onClick:x,colorScheme:"red",children:""})]});if(F==="complete")return t.jsx("button",{onClick:l,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})});if(F==="eliminated")return t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx("button",{onClick:l,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx(z,{onClick:d,colorScheme:"yellow",children:" "})]});const X=v.some(ee=>ee.matches.some(xe=>xe.isUserMatch&&!xe.isFinished));return(F==="round_complete"||F==="bracket_ready")&&X?t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(z,{onClick:o,colorScheme:"green",className:"animate-pulse",children:" "}),t.jsx(z,{onClick:x,colorScheme:"red",children:""})]}):t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(z,{disabled:!0,colorScheme:"gray",children:" "}),t.jsx(z,{onClick:d,colorScheme:"yellow",children:" "})]})},H=t.jsxs("main",{className:"flex-1 flex flex-col lg:flex-row gap-4 min-h-0",children:[t.jsxs("aside",{className:"w-full lg:w-[35%] xl:w-[25%] flex-shrink-0 flex flex-col gap-2",children:[t.jsx("div",{className:"flex-1 bg-gray-800/50 rounded-lg p-2 min-h-0",children:n.type==="neighborhood"?t.jsx(Db,{tournamentState:n,currentUser:s}):t.jsx(qb,{rounds:v,currentUser:s,tournamentType:n.type})}),t.jsxs("div",{className:"h-48 flex-shrink-0 bg-gray-800/50 rounded-lg p-3 text-center flex flex-col items-center justify-center",children:[t.jsx("img",{src:"/images/Ranking.png",alt:"Trophy",className:"w-20 h-20 mb-2"}),t.jsx("h4",{className:"font-bold text-gray-400",children:""}),k?t.jsx("p",{className:"text-xl font-semibold text-yellow-300",children:k.nickname}):t.jsx("p",{className:"text-sm text-gray-500",children:" ..."})]})]}),t.jsxs("div",{className:"flex-grow flex flex-col gap-2 min-h-0 min-w-0",children:[t.jsxs("section",{className:"flex flex-row gap-1 md:gap-2 items-stretch p-2 bg-gray-800/50 rounded-lg",children:[t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(Lu,{player:I,initialPlayer:h.p1,allUsers:r,currentUserId:s.id,onViewUser:a,highlightPhase:B})}),t.jsxs("div",{className:"flex-shrink-0 w-44 sm:w-52 flex flex-col items-center justify-center min-w-0",children:[t.jsx(Ex,{datasets:A,maxStatValue:O,size:u?140:void 0}),t.jsxs("div",{className:"flex justify-center gap-2 sm:gap-4 text-[10px] sm:text-xs mt-1",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 rounded-sm",style:{backgroundColor:"rgba(59, 130, 246, 0.6)"}}),(I==null?void 0:I.nickname)||" 1"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 rounded-sm",style:{backgroundColor:"rgba(239, 68, 68, 0.6)"}}),(R==null?void 0:R.nickname)||" 2"]})]})]}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(Lu,{player:R,initialPlayer:h.p2,allUsers:r,currentUserId:s.id,onViewUser:a,highlightPhase:B})})]}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-2 min-h-0",children:[t.jsx("div",{className:"w-full h-80 lg:h-full lg:w-2/5 bg-gray-800/50 rounded-lg p-2 flex items-center justify-center",children:t.jsx(_b,{timeElapsed:j?n.timeElapsed:0,fileIndex:j?w==null?void 0:w.sgfFileIndex:p,showLastMoveOnly:!j})}),t.jsxs("div",{className:"w-full lg:w-3/5 flex-1 flex flex-col gap-2 min-h-0",children:[t.jsxs("section",{className:"flex-shrink-0 bg-gray-800/50 rounded-lg p-3",children:[t.jsx(Bb,{p1Percent:q,p2Percent:U,p1Nickname:I==null?void 0:I.nickname,p2Nickname:R==null?void 0:R.nickname}),t.jsx("div",{className:"mt-2",children:t.jsx(Rb,{timeElapsed:n.timeElapsed,totalDuration:140})})]}),t.jsx("div",{className:"h-64 lg:h-auto lg:flex-1 min-h-0 bg-gray-800/50 rounded-lg p-2 flex flex-col",children:t.jsx($b,{commentary:n.currentMatchCommentary,isSimulating:n.status==="round_in_progress"})})]})]})]})]}),te=()=>t.jsxs("footer",{className:"flex-shrink-0 bg-gray-800/50 rounded-lg p-3 grid grid-cols-1 md:grid-cols-3 items-center gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ce,{userId:s.id,userName:s.nickname,size:40}),t.jsxs("div",{className:"text-left",children:[t.jsx("h4",{className:"font-bold",children:s.nickname}),t.jsx("p",{className:"text-xs text-yellow-300",children:M})]})]}),t.jsx("div",{className:"text-center order-first md:order-none",children:W()}),t.jsx("div",{className:"text-right",children:t.jsx(Ob,{tournamentState:n,currentUser:s,onAction:i})})]});return t.jsxs("div",{className:"w-full p-2 flex flex-col gap-2 bg-gray-900 text-white min-h-full",children:[t.jsxs("header",{className:"flex items-center justify-between flex-shrink-0",children:[t.jsx("button",{onClick:g,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:n.title}),t.jsx("div",{className:"w-28"})]}),u?t.jsxs("div",{className:"flex-1 flex flex-col gap-4 min-h-0",children:[t.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:H}),te()]}):t.jsxs(t.Fragment,{children:[H,te()]})]})},zb=({type:e})=>{const{currentUserWithStatus:n,handlers:s,allUsers:l}=De();let r;switch(e){case"neighborhood":r="lastNeighborhoodTournament";break;case"national":r="lastNationalTournament";break;case"world":r="lastWorldTournament";break;default:return t.jsx("div",{children:"Invalid tournament type"})}const a=n==null?void 0:n[r];return!a||!n?t.jsxs("div",{className:"p-4 text-center",children:[t.jsx("p",{children:"   ..."}),t.jsx(z,{onClick:()=>window.location.hash="#/tournament",className:"mt-4",children:" "})]}):t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)] relative",children:[t.jsxs("header",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[t.jsx(z,{onClick:()=>window.location.hash="#/tournament",colorScheme:"gray",className:"p-0 flex items-center justify-center w-10 h-10 rounded-full",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:a.title}),t.jsx("div",{className:"w-10"})]}),t.jsx("main",{className:"flex-1 flex flex-col items-center justify-center",children:t.jsx(Ub,{tournament:a,currentUser:n,onBack:()=>window.location.hash="#/tournament",allUsersForRanking:l,onViewUser:s.openViewingUser,onAction:s.handleAction,onStartNextRound:()=>s.handleAction({type:"START_TOURNAMENT_ROUND",payload:{type:e}}),onReset:()=>s.handleAction({type:"CLEAR_TOURNAMENT_SESSION",payload:{type:e}}),onSkip:()=>s.handleAction({type:"SKIP_TOURNAMENT_END",payload:{type:e}}),isMobile:!1})})]})},Fb=()=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full flex flex-col items-center justify-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:""}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{className:"text-2xl",children:""}),t.jsx("img",{src:"/images/championship/Champ1.png",alt:"Beginner Class",className:"w-48 h-32"}),t.jsx("button",{className:"text-2xl",children:""})]})]}),Gb=()=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:" "}),t.jsx("div",{className:"grid grid-cols-5 gap-4",children:Array.from({length:20},(e,n)=>t.jsx("div",{className:"aspect-square bg-gray-700 rounded-md flex items-center justify-center",children:n+1},n))})]}),Wb=()=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:" "}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"bg-gray-700 p-2 rounded-md",children:" 1"}),t.jsx("div",{className:"bg-gray-700 p-2 rounded-md",children:" 2"}),t.jsx("div",{className:"bg-gray-700 p-2 rounded-md",children:" 3"})]})]}),Hb=()=>{const e=()=>window.location.hash="#/profile";return t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)]",children:[t.jsxs("header",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[t.jsx(z,{onClick:e,colorScheme:"gray",className:"p-0 flex items-center justify-center w-10 h-10 rounded-full",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:""}),t.jsx("div",{className:"w-10"})," "]}),t.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-6 min-h-0",children:[t.jsx("div",{className:"col-span-3",children:t.jsx(Fb,{})}),t.jsx("div",{className:"col-span-6",children:t.jsx(Gb,{})}),t.jsx("div",{className:"col-span-3",children:t.jsx(Wb,{})})]})]})},Vb=()=>t.jsxs("div",{className:"p-4",children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Guild Page"}),t.jsx("p",{children:"Welcome to the Guild page. This feature is under construction."})]}),$u=()=>{const{currentRoute:e,currentUser:n,activeGame:s}=De();if(!n)return e.view==="register"?t.jsx(M0,{}):t.jsx(E0,{});if(s&&e.view!=="game")return t.jsx("div",{className:"flex items-center justify-center h-full",children:" ..."});switch(e.view){case"profile":return t.jsx(L0,{});case"lobby":const l=e.params.type==="playful"?"playful":"strategic";return t.jsx(O0,{lobbyType:l});case"waiting":return e.params.mode?t.jsx(Q0,{mode:e.params.mode}):(window.location.hash="#/profile",null);case"game":return e.params.id&&s&&s.id===e.params.id?t.jsx(hb,{session:s}):(console.warn("Router: Mismatch between route and active game. Redirecting to profile."),window.location.hash="#/profile",null);case"admin":return t.jsx(Sb,{});case"tournament":return e.params.type?t.jsx(zb,{type:e.params.type}):t.jsx(Pb,{});case"singleplayer":return t.jsx(Hb,{});case"guild":return t.jsx(Vb,{});default:return window.location.hash="#/profile",null}},Tx=({item:e,currentUser:n,onClose:s,onConfirm:l})=>{const[r,a]=f.useState(1),i=!!e.price.gold,o=e.price.gold||e.price.diamonds||0,c=o*r,d=f.useMemo(()=>{var y,b,v;const p=i?n.gold:n.diamonds,m=o>0?Math.floor(p/o):1/0;let h=1/0;if(e.type==="equipment"){const g=n.inventory.filter(w=>w.type==="equipment").length,j=(((y=n.inventorySlots)==null?void 0:y.equipment)||us+(((b=n.inventoryExpansions)==null?void 0:b.equipment)||0)*jc)-g;h=j>0?j:0}else{const g=n.inventory.filter(w=>w.id===e.itemId).length,j=(((v=n.inventorySlots)==null?void 0:v[e.type])||us)-g;h=j>0?j:0}return Math.max(1,Math.min(e.limit||1/0,m,h,999))},[e,n,i,o]),u=()=>{r>0&&l(e.itemId,r),s()};return t.jsx(be,{title:" ",onClose:s,windowId:"purchase-quantity",initialWidth:400,zIndex:60,children:t.jsxs("div",{className:"text-center flex flex-col items-center",children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:e.name}),t.jsxs("div",{className:"w-full space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(z,{onClick:()=>a(p=>Math.max(1,p-1)),disabled:r<=1,children:"-"}),t.jsx("input",{type:"number",value:r,onChange:p=>a(Math.max(1,Math.min(d,Number(p.target.value)))),className:"w-24 text-center text-2xl font-bold bg-tertiary rounded-md p-2"}),t.jsx(z,{onClick:()=>a(p=>Math.min(d,p+1)),disabled:r>=d,children:"+"}),t.jsx(z,{onClick:()=>a(d),disabled:d<=0,colorScheme:"blue",className:"!py-2 !px-3",children:"Max"})]}),t.jsx("input",{type:"range",min:"1",max:d,value:r,onChange:p=>a(Number(p.target.value)),className:"w-full"})]}),t.jsxs("div",{className:"mt-6 text-lg",children:[t.jsx("p",{children:" :"}),t.jsxs("div",{className:"flex items-center justify-center gap-2 font-bold text-2xl text-yellow-300",children:[t.jsx("img",{src:i?"/images/icon/Gold.png":"/images/icon/Zem.png",alt:i?"":"",className:"w-6 h-6"}),t.jsx("span",{children:c.toLocaleString()})]})]}),t.jsxs("div",{className:"flex w-full gap-4 mt-6",children:[t.jsx(z,{onClick:s,colorScheme:"gray",className:"w-full",children:""}),t.jsx(z,{onClick:u,disabled:r===0||r>d,className:"w-full",children:""})]})]})})},Kb=e=>100+Math.max(0,(e-us)/jc)*20,Ou={normal:0,uncommon:1,rare:2,epic:3,legendary:4,mythic:5},Jb=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-purple-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},Qb=({slot:e,item:n})=>{const s=l=>{if(l===0)return null;let r="",a="";return l>=10?(r="/images/equipments/Star4.png",a="prism-text-effect"):l>=7?(r="/images/equipments/Star3.png",a="text-purple-400"):l>=4?(r="/images/equipments/Star2.png",a="text-amber-400"):l>=1&&(r="/images/equipments/Star1.png",a="text-white"),t.jsxs("div",{className:"absolute top-0.5 right-0.5 flex items-center gap-0.5 bg-black/40 rounded-bl-md px-0.5 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:r,alt:"star",className:"w-2.5 h-2.5"}),t.jsx("span",{className:`font-bold text-[10px] leading-none ${a}`,children:l})]})};return n?t.jsxs("div",{className:"relative w-full aspect-square rounded-lg border-2 border-color/50 bg-tertiary/50",title:n.name,children:[t.jsx("img",{src:$a[n.grade],alt:n.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),n.image&&t.jsx("img",{src:n.image,alt:n.name,className:"relative w-full h-full object-contain p-1.5"}),s(n.stars)]}):t.jsx("img",{src:La[e],alt:`${e} empty slot`,className:"w-full aspect-square rounded-lg bg-tertiary/50 border-2 border-color/50"})},Du=({item:e,title:n,comparisonItem:s})=>{var m;if(!e)return t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:n});const l=El[e.grade],r=h=>{if(h===0)return null;let y="",b="";return h>=10?(y="/images/equipments/Star4.png",b="prism-text-effect"):h>=7?(y="/images/equipments/Star3.png",b="text-purple-400"):h>=4?(y="/images/equipments/Star2.png",b="text-amber-400"):h>=1&&(y="/images/equipments/Star1.png",b="text-white"),t.jsxs("div",{className:"absolute top-0.5 right-0.5 flex items-center gap-0.5 bg-black/40 rounded-bl-md px-0.5 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:y,alt:"star",className:"w-2.5 h-2.5"}),t.jsx("span",{className:`font-bold text-[10px] leading-none ${b}`,children:h})]})},a=En[e.grade],i=h=>!h||!h.options?[]:[...h.options.main?[h.options.main]:[],...h.options.combatSubs||[],...h.options.specialSubs||[],...h.options.mythicSubs||[]].filter(Boolean),o=(h,y)=>{if(!h||!h.options)return 0;const v=i(h).find(g=>g.type===y);return v?v.value:0},c=i(e),d=i(s),u=new Map;c.forEach(h=>{u.set(h.type,{current:h})}),d.forEach(h=>{const y=u.get(h.type);y?y.comparison=h:u.set(h.type,{comparison:h})});const p=Array.from(u.keys()).sort();return t.jsxs("div",{className:"flex flex-col h-full text-xs",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:l.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),r(e.stars)]}),t.jsxs("div",{className:"flex-grow text-right ml-2",children:[t.jsx("div",{className:"flex items-baseline justify-end gap-0.5",children:t.jsx("h3",{className:`text-lg font-bold ${l.color}`,children:e.name})}),t.jsxs("p",{className:"text-gray-400 text-xs",children:["[",l.name,"]"]}),t.jsxs("p",{className:"text-[10px] text-gray-500",children:[" (: ",a,")"]}),((m=e.options)==null?void 0:m.main)&&t.jsxs("p",{className:"font-semibold text-yellow-300 text-xs flex justify-between items-center",children:[t.jsxs("span",{children:[e.options.main.display,e.options.main.range&&` [${e.options.main.range[0]}~${e.options.main.range[1]}]`]}),s&&e.options.main.type&&(()=>{const h=o(s,e.options.main.type),y=e.options.main.value-h,b=y>0?` (+${y})`:y<0?` (${y})`:"",v=y>0?"text-green-400":y<0?"text-red-400":"";return y!==0&&t.jsx("span",{className:`font-bold ${v} text-right`,children:b})})()]})]})]}),t.jsx("div",{className:"w-full text-xs text-left space-y-1 bg-gray-900/50 p-2 rounded-lg flex-grow overflow-y-auto",children:p.map(h=>{var v,g;const{current:y,comparison:b}=u.get(h);if(((g=(v=e.options)==null?void 0:v.main)==null?void 0:g.type)===h)return null;if(y&&b){const x=y.value-b.value,j=x>0?` (+${x})`:x<0?` (${x})`:"",w=x>0?"text-green-400":x<0?"text-red-400":"";let S="text-blue-300";return y.type in Fe&&(S="text-green-300"),y.type in it&&(S="text-red-400"),t.jsxs("p",{className:`${S} flex justify-between items-center`,children:[t.jsx("span",{children:y.display}),x!==0&&t.jsx("span",{className:`font-bold ${w} text-right`,children:j})]},h)}else if(y&&!b){let x="text-green-400";return y.type in Fe&&(x="text-green-300"),y.type in it&&(x="text-red-400"),t.jsxs("p",{className:`${x} flex justify-between items-center`,children:[t.jsx("span",{children:y.display})," ",t.jsx("span",{className:"font-bold text-right",children:"(New)"})]},h)}else if(!y&&b){let x="text-red-400";return b.type in Fe&&(x="text-green-300"),b.type in it&&(x="text-red-400"),t.jsx("p",{className:`${x} line-through flex justify-between items-center`,children:t.jsx("span",{children:b.display})},h)}return null})})]})},Yb=["fan","board","top","bottom","bowl","stones"],Xb=({currentUser:e,onClose:n,onAction:s,onStartEnhance:l,enhancementAnimationTarget:r,onAnimationComplete:a,isTopmost:i})=>{const{presets:o,handlers:c}=De(),{inventorySlots:d={equipment:30,consumable:10,material:10}}=e,[u,p]=f.useState(null),[m,h]=f.useState("all"),[y,b]=f.useState("createdAt"),[v,g]=f.useState(0),[x,j]=f.useState(!1),[w,S]=f.useState(""),[C,k]=f.useState(!1),[M,_]=f.useState(null),E=F=>{g(F);const X=o[F];X&&c.applyPreset(X)},I=f.useMemo(()=>u&&e.inventory.find(F=>F.id===u)||null,[u,e.inventory]),R=f.useMemo(()=>m==="all"?0:Kb(d[m]),[m,d]),{coreStatBonuses:A}=f.useMemo(()=>gx(e),[e]),O=f.useMemo(()=>{if(!I||I.type!=="material")return[];const F={normal:[],uncommon:[],rare:[],epic:[],legendary:[],mythic:[]};for(const ee in ha)ha[ee].forEach((Q,G)=>{Q.forEach(K=>{K.name===I.name&&(F[ee]||(F[ee]=[]),F[ee].push(G+1))})});const X=[];for(const ee in F){const xe=F[ee].sort((Q,G)=>Q-G);xe.length>0&&X.push(`${El[ee].name}   : +${xe.join("/+")}`)}return X},[I]),B=()=>{m!=="all"&&window.confirm(` ${R}  ${m}  ${jc} ?`)&&s({type:"EXPAND_INVENTORY",payload:{category:m}})},V=()=>{S(o[v].name),j(!0)},D=()=>{const F={...o[v],name:w,equipment:e.equipment};s({type:"SAVE_PRESET",payload:{preset:F,index:v}}),j(!1),alert(" .")},L=F=>{const X=e.inventory.find(ee=>ee.id===F);if(X){if(!X.isEquipped){const ee=En[X.grade],xe=e.strategyLevel+e.playfulLevel;if(xe<ee){alert(`   . (: ${ee}, : ${xe})`);return}}s({type:"TOGGLE_EQUIP_ITEM",payload:{itemId:F}})}},q=f.useMemo(()=>{let F=[...e.inventory];return m!=="all"&&(F=F.filter(X=>X.type===m)),m==="material"&&console.log("Filtered materials:",F),F.sort((X,ee)=>{if(y==="createdAt")return ee.createdAt-X.createdAt;if(y==="grade"){const xe=Ou[X.grade],Q=Ou[ee.grade];return xe!==Q?Q-xe:ee.stars-X.stars}if(y==="type"){const xe={equipment:1,consumable:2,material:3};return xe[X.type]-xe[ee.type]}return 0}),F},[e.inventory,m,y]),U=f.useMemo(()=>{const F=d||{};return m==="all"?(F.equipment||us)+(F.consumable||us)+(F.material||us):F[m]||us},[d,m]),W=f.useMemo(()=>{let F=a0;return m==="consumable"?F=i0:m==="material"&&(F=o0),F},[m]),H=f.useMemo(()=>m==="all"?!1:d[m]<W,[m,d,W]),te=f.useCallback(F=>o.some(X=>Object.values(X.equipment).includes(F)),[o]),le=f.useCallback(F=>{const X=e.equipment[F];if(X)return e.inventory.find(ee=>ee.id===X)},[e.equipment,e.inventory]),ce=f.useMemo(()=>!I||!I.slot?null:le(I.slot),[I,le]),ve=f.useMemo(()=>{if(!I||I.type!=="equipment")return!1;const F=En[I.grade];return e.strategyLevel+e.playfulLevel>=F},[I,e.strategyLevel,e.playfulLevel]);return t.jsxs(be,{title:"",onClose:n,windowId:"inventory",isTopmost:i,children:[t.jsxs("div",{className:"flex flex-col h-full w-full max-w-[900px]",children:[t.jsxs("div",{className:"h-96 bg-gray-800 p-4 mb-2 rounded-md shadow-inner flex",children:[t.jsxs("div",{className:"w-1/3 pr-4 border-r border-gray-700",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:Yb.map(F=>t.jsx("div",{className:"w-full",children:t.jsx(Qb,{slot:F,item:le(F)})},F))}),t.jsxs("div",{className:"mt-4",children:[t.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mb-2",children:Object.values(N).map(F=>{var Q;const X=(e.baseStats[F]||0)+(((Q=e.spentStatPoints)==null?void 0:Q[F])||0),ee=Math.floor(X*(A[F].percent/100))+A[F].flat,xe=X+ee;return t.jsxs("div",{className:"bg-tertiary/40 p-1 rounded-md flex items-center justify-between text-xs",children:[t.jsx("span",{className:"font-semibold text-secondary whitespace-nowrap",children:F}),t.jsxs("span",{className:"font-mono font-bold whitespace-nowrap",title:`: ${X}, : ${ee}`,children:[xe,ee>0&&t.jsxs("span",{className:"text-green-400 text-xs ml-0.5",children:["(+",ee,")"]})]})]},F)})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("select",{value:v,onChange:F=>E(Number(F.target.value)),className:"bg-secondary border border-color text-xs rounded-md p-1 focus:ring-accent focus:border-accent flex-grow",children:o.map((F,X)=>t.jsx("option",{value:X,children:F.name},X))}),t.jsx(z,{onClick:V,colorScheme:"blue",className:"!text-xs !py-1",children:""})]})]})]}),I&&I.type==="equipment"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col w-1/3 h-full bg-panel-secondary rounded-lg p-3 relative overflow-hidden ml-4 border-r border-gray-700",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:"  "}),ce?t.jsx(Du,{item:ce,title:"  ",comparisonItem:I}):t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:"  "})]}),t.jsxs("div",{className:"flex flex-col w-1/3 h-full bg-panel-secondary rounded-lg p-3 relative overflow-hidden ml-4",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:" "}),t.jsx(Du,{item:I,title:"  ",comparisonItem:ce}),t.jsxs("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center gap-2 px-4",children:[I.id===(ce==null?void 0:ce.id)?t.jsx(z,{onClick:()=>L(I.id),colorScheme:"red",className:"w-full !text-xs !py-1",children:""}):t.jsx(z,{onClick:()=>L(I.id),colorScheme:"green",className:"w-full !text-xs !py-1",disabled:!ve,children:""}),t.jsx(z,{onClick:()=>l(I),disabled:I.stars>=10,colorScheme:"yellow",className:"w-full !text-xs !py-1",children:I.stars>=10?" ":""}),t.jsx(z,{onClick:()=>s({type:"SELL_ITEM",payload:{itemId:I.id,quantity:1}}),colorScheme:"red",className:"w-full !text-xs !py-1",children:""})]})]})]}):t.jsx("div",{className:"flex flex-col w-2/3 h-full bg-panel-secondary rounded-lg p-3 relative overflow-hidden ml-4",children:I?I.type==="consumable"||I.type==="material"?t.jsxs(t.Fragment,{children:[t.jsxs("h3",{className:"text-lg font-bold text-on-panel mb-2",children:[" ",I.type==="consumable"?"":""]}),t.jsxs("div",{className:"flex flex-col h-full text-xs",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:$a[I.grade],alt:I.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),I.image&&t.jsx("img",{src:I.image,alt:I.name,className:"relative w-full h-full object-contain p-1"})]}),t.jsxs("div",{className:"flex-grow text-right ml-2",children:[t.jsx("h3",{className:`text-lg font-bold ${El[I.grade].color}`,children:I.name}),t.jsxs("p",{className:"text-gray-400 text-xs",children:["[",El[I.grade].name,"]"]}),t.jsx("p",{className:"text-gray-300 text-xs mt-1",children:I.description}),t.jsxs("p",{className:"text-gray-300 text-xs mt-1",children:[" : ",I.quantity]})]})]}),I.type==="material"&&t.jsxs("div",{className:"mt-2 p-2 bg-gray-800/50 rounded-lg flex-grow",style:{maxHeight:"4em"},children:[" ",t.jsx("p",{className:"font-semibold text-secondary mb-1",children:"  :"}),O.length>0?O.slice(0,2).map((F,X)=>t.jsx("p",{className:"text-gray-300 text-xs",children:F},X)):t.jsx("p",{className:"text-gray-300 text-xs",children:"       ."}),O.length>2&&t.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"..."})]}),"                                        "]}),t.jsxs("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center gap-2 px-4",children:[I.type==="consumable"&&t.jsxs(t.Fragment,{children:[t.jsx(z,{onClick:()=>s({type:"USE_ITEM",payload:{itemId:I.id}}),colorScheme:"blue",className:"w-full !text-xs !py-1",children:""}),I.quantity&&I.quantity>1&&t.jsx(z,{onClick:()=>{_(I),k(!0)},colorScheme:"purple",className:"w-full !text-xs !py-1",children:" "})]}),t.jsx(z,{onClick:()=>s({type:"SELL_ITEM",payload:{itemId:I.id}}),colorScheme:"red",className:"w-full !text-xs !py-1",children:""})]})]}):t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:"  "}):t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:" "})})]}),t.jsxs("div",{className:"flex-grow flex-shrink-0 bg-gray-900 p-4 rounded-b-md overflow-y-auto",children:[t.jsx("div",{className:"flex-shrink-0 p-2 bg-gray-900/50 rounded-md mb-2",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(z,{onClick:()=>h("all"),colorScheme:m==="all"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""}),t.jsx(z,{onClick:()=>h("equipment"),colorScheme:m==="equipment"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""}),t.jsx(z,{onClick:()=>h("consumable"),colorScheme:m==="consumable"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""}),t.jsx(z,{onClick:()=>h("material"),colorScheme:m==="material"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-sm",children:":"}),t.jsxs("select",{onChange:F=>b(F.target.value),value:y,className:"bg-gray-700 text-white text-sm rounded-md p-1",children:[t.jsx("option",{value:"createdAt",children:""}),t.jsx("option",{value:"grade",children:""}),t.jsx("option",{value:"type",children:""})]}),t.jsx("div",{className:"text-sm text-gray-400",children:`${q.length} / ${U}`})]})]})}),t.jsx("div",{className:"overflow-y-auto pr-2",style:{height:"116px"},children:t.jsxs("div",{className:"grid grid-cols-5 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2",children:[Array.from({length:U}).map((F,X)=>{const ee=q[X];return ee?t.jsx(Zb,{item:ee,onClick:()=>p(ee.id),isSelected:u===ee.id,isEquipped:ee.isEquipped||!1,enhancementStars:(r==null?void 0:r.itemId)===ee.id?r.stars:void 0,isPresetEquipped:te(ee.id)},ee.id):t.jsx("div",{className:"w-full aspect-square rounded-lg bg-gray-800/50 border-2 border-gray-700/50"},`empty-${X}`)}),H&&t.jsx("button",{onClick:B,className:"w-full aspect-square rounded-lg bg-gray-800/50 border-2 border-gray-700/50 flex items-center justify-center text-gray-400 text-4xl hover:bg-gray-700/50 hover:border-accent transition-all duration-200",title:`  (${R} )`,children:"+"},"expand-slot")]})})]})]}),C&&M&&t.jsx(Tx,{onClose:()=>k(!1),onConfirm:F=>{s({type:"USE_ITEM",payload:{itemId:M.id,quantity:F}}),k(!1),_(null)},maxQuantity:M.quantity||1,itemName:M.name,initialQuantity:1}),x&&t.jsx(be,{title:"  ",onClose:()=>j(!1),windowId:"renamePreset",isTopmost:!0,children:t.jsxs("div",{className:"p-4 flex flex-col items-center",children:[t.jsx("p",{className:"mb-4 text-on-panel",children:"   :"}),t.jsx("input",{type:"text",value:w,onChange:F=>S(F.target.value),className:"bg-secondary border border-color text-on-panel text-sm rounded-md p-2 mb-4 w-full max-w-xs",maxLength:20}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(z,{onClick:D,colorScheme:"blue",children:""}),t.jsx(z,{onClick:()=>j(!1),colorScheme:"gray",children:""})]})]})})]})},Zb=({item:e,onClick:n,isSelected:s,isEquipped:l,enhancementStars:r,isPresetEquipped:a})=>{const i=Jb(r||e.stars||0);return t.jsxs("div",{onClick:n,className:`relative w-full aspect-square rounded-lg cursor-pointer transition-all duration-200 ${s?"ring-2 ring-accent":"ring-1 ring-transparent"} hover:ring-2 hover:ring-accent/70`,title:e.name,children:[t.jsx("img",{src:$a[e.grade],alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1.5"}),l&&t.jsx("div",{className:"absolute top-0.5 left-0.5 w-4 h-4 bg-green-500 text-white text-xs flex items-center justify-center rounded-full border-2 border-gray-800",children:"E"}),!l&&a&&t.jsx("div",{className:"absolute top-0.5 left-0.5 w-4 h-4 bg-blue-500 text-white text-xs flex items-center justify-center rounded-full border-2 border-gray-800",children:"P"}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 text-center text-xs font-bold text-white bg-black/50 py-0.5",children:t.jsx("span",{className:i.colorClass,children:i.text})})]})},ev=e=>{const n=Math.max(0,(e-Date.now())/1e3);if(n===0)return"";const s=Math.floor(n/(24*3600)),l=Math.floor(n%(24*3600)/3600),r=Math.floor(n%3600/60);return s>0?`${s} ${l}`:l>0?`${l} ${r}`:`${r}`},tv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{var b,v,g,x;const{mail:r}=e,[a,i]=f.useState(r.length>0?r[0]:null),[o,c]=f.useState(null);f.useEffect(()=>{if(a){const j=r.find(w=>w.id===a.id);j?JSON.stringify(j)!==JSON.stringify(a)&&i(j):i(r.length>0?r[0]:null)}else r.length>0&&i(r[0])},[r,a]),f.useEffect(()=>{a&&!a.isRead&&s({type:"MARK_MAIL_AS_READ",payload:{mailId:a.id}})},[a,s]),f.useEffect(()=>{if(a!=null&&a.expiresAt){const j=()=>{c(ev(a.expiresAt))};j();const w=setInterval(j,6e4);return()=>clearInterval(w)}else c(null)},[a]);const d=()=>{a&&a.attachments&&!a.attachmentsClaimed&&(Ee.claimReward(),s({type:"CLAIM_MAIL_ATTACHMENTS",payload:{mailId:a.id}}))},u=()=>{if(a){const j=r.findIndex(w=>w.id===a.id)-1;s({type:"DELETE_MAIL",payload:{mailId:a.id}}),i(r.length>1?r[Math.max(0,j)]:null)}},p=r.some(j=>j.attachments&&!j.attachmentsClaimed),m=r.some(j=>j.attachmentsClaimed),h=()=>{Ee.claimReward(),s({type:"CLAIM_ALL_MAIL_ATTACHMENTS"})},y=()=>{if(window.confirm("    ?")){s({type:"DELETE_ALL_CLAIMED_MAIL"});const j=r.filter(w=>!w.attachmentsClaimed);i(j.length>0?j[0]:null)}};return t.jsx(be,{title:"",onClose:n,windowId:"mailbox",initialWidth:800,isTopmost:l,children:t.jsxs("div",{className:"flex gap-6 h-[65vh]",children:[t.jsxs("div",{className:"w-1/3 bg-gray-900/50 rounded-lg p-3 flex flex-col",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-2 flex-shrink-0",children:["  (",r.length,")"]}),t.jsxs("div",{className:"flex flex-col gap-2 mb-2 flex-shrink-0",children:[t.jsx(z,{onClick:h,disabled:!p,colorScheme:"green",className:"!text-sm !py-2",children:" "}),t.jsx(z,{onClick:y,disabled:!m,colorScheme:"red",className:"!text-sm !py-2",children:"   "})]}),t.jsx("ul",{className:"space-y-1 overflow-y-auto flex-grow pr-2",children:r.map(j=>t.jsx("li",{children:t.jsxs("button",{onClick:()=>i(j),className:`w-full text-left p-2 rounded-md transition-colors ${(a==null?void 0:a.id)===j.id?"bg-blue-600":"hover:bg-gray-700/50"}`,children:[t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[t.jsxs("span",{children:["From: ",j.from]}),!j.isRead&&t.jsx("span",{className:"text-yellow-400 font-bold",children:" New"})]}),t.jsx("p",{className:"font-semibold truncate",children:j.title})]})},j.id))})]}),t.jsx("div",{className:"w-2/3 flex flex-col",children:a?t.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4 flex flex-col h-full",children:[t.jsxs("div",{className:"flex-grow flex flex-col mb-4",children:[t.jsx("h2",{className:"text-xl font-bold mb-2 pb-2 border-b border-gray-700",children:a.title}),t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400 mb-4",children:[t.jsxs("span",{children:[" : ",a.from]}),o&&t.jsxs("span",{children:[" : ",t.jsx("span",{className:"text-yellow-400 font-semibold",children:o})]})]}),t.jsx("div",{className:"text-sm text-gray-300 flex-grow bg-gray-800/50 p-3 rounded-md overflow-y-auto",children:a.message})]}),t.jsxs("div",{className:"flex-shrink-0 pt-4 border-t border-gray-700",children:[a.attachments&&t.jsxs("div",{className:"bg-gray-800 p-3 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:" "}),a.attachmentsClaimed?t.jsx("p",{className:"text-gray-400 text-center",children:"[ ]"}):t.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm",children:[(((b=a.attachments)==null?void 0:b.actionPoints)??0)>0&&t.jsxs("span",{children:[" ",a.attachments.actionPoints.toLocaleString()," "]}),(((v=a.attachments)==null?void 0:v.gold)??0)>0&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4"})," ",a.attachments.gold.toLocaleString()," "]}),(((g=a.attachments)==null?void 0:g.diamonds)??0)>0&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",a.attachments.diamonds.toLocaleString()," "]}),(x=a.attachments.items)==null?void 0:x.map((j,w)=>{const S=j;return t.jsxs("span",{className:"flex items-center gap-1",children:[S.image&&t.jsx("img",{src:S.image,alt:S.name,className:"w-4 h-4 object-contain"}),S.name," ",S.quantity&&S.quantity>1?`x${S.quantity}`:""]},w)})]})]}),t.jsxs("div",{className:"flex justify-between items-center gap-3",children:[t.jsx(z,{onClick:u,colorScheme:"red",children:""}),t.jsx(z,{onClick:d,colorScheme:"green",disabled:!a.attachments||a.attachmentsClaimed,children:a.attachmentsClaimed?" ":" "})]})]})]}):t.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900/50 rounded-lg",children:t.jsx("p",{className:"text-gray-400",children:"  ."})})})]})})},nv=({quest:e,onClaim:n})=>{const s=e.progress>=e.target,l=Math.min(e.progress/e.target*100,100),r=()=>{s&&!e.isClaimed&&(Ee.claimReward(),n(e.id))};return t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-md flex items-center justify-center text-gray-500 text-3xl flex-shrink-0",children:""}),t.jsxs("div",{className:"flex-grow min-w-0",children:[t.jsx("h4",{className:"font-bold truncate",children:e.title}),t.jsx("p",{className:"text-xs text-gray-400 mb-1 truncate",children:e.description}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:t.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${l}%`}})}),t.jsxs("p",{className:"text-xs text-right text-gray-300 mt-1",children:[e.progress," / ",e.target]})]}),t.jsxs("div",{className:"w-28 text-center flex-shrink-0 flex flex-col items-center gap-1 relative",children:[t.jsx(z,{onClick:r,disabled:!s||e.isClaimed,colorScheme:s&&!e.isClaimed?"green":"gray",className:"w-full !text-sm !py-2",children:e.isClaimed?"":s?" ":" "}),t.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs flex-wrap",children:[t.jsxs("span",{className:"text-yellow-300 font-semibold flex items-center gap-1",children:[" +",e.activityPoints]}),e.reward.gold&&t.jsxs("span",{className:"text-yellow-300 font-semibold flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-3 h-3"})," +",e.reward.gold]})]})]})]})},ki=({title:e,questData:n,thresholds:s,rewards:l,questType:r,onClaim:a})=>{if(!n)return null;const{activityProgress:i,claimedMilestones:o}=n,c=s[s.length-1],d=u=>{if(!u.items||u.items.length===0)return"/images/Box/box.png";const p=u.items[0],m="itemId"in p?p.itemId:p.name,h=js.find(y=>y.name===m);return(h==null?void 0:h.image)??"/images/Box/box.png"};return t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold text-center mb-2",children:e}),t.jsx("div",{className:"flex items-center gap-3 mb-3",children:t.jsxs("div",{className:"w-full bg-gray-700 rounded-full h-4 relative border border-gray-600",children:[t.jsx("div",{className:"bg-green-500 h-full rounded-full",style:{width:`${Math.min(100,i/c*100)}%`}}),t.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-white",children:[i," / ",c]})]})}),t.jsx("div",{className:"flex justify-around items-end",children:s.map((u,p)=>{if(!l[p])return null;const m=i>=u,h=o[p],y=m&&!h,b=l[p],v=d(b);return t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("button",{onClick:()=>{y&&(Ee.claimReward(),a(p,r))},disabled:!y,className:`relative w-8 h-8 transition-transform hover:scale-110 disabled:cursor-not-allowed ${y?"animate-pulse":""}`,title:h?" ":m?" ":`${u}  `,children:[t.jsx("img",{src:v,alt:` ${p+1}`,className:`w-full h-full object-contain ${!m&&!h?"filter grayscale":""}`}),h&&t.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center text-xl text-green-400",children:""})]}),t.jsx("span",{className:`text-sm font-bold mt-1 ${m?"text-yellow-300":"text-gray-500"}`,children:u})]},u)})})]})},sv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{var u,p,m;const[r,a]=f.useState("daily"),{quests:i}=e,o=h=>{s({type:"CLAIM_QUEST_REWARD",payload:{questId:h}})},c=r==="daily"?((u=i.daily)==null?void 0:u.quests)||[]:r==="weekly"?((p=i.weekly)==null?void 0:p.quests)||[]:((m=i.monthly)==null?void 0:m.quests)||[],d=()=>r==="daily"?t.jsx(ki,{title:" ",questData:i.daily,thresholds:dx,rewards:f0,questType:"daily",onClaim:(h,y)=>s({type:"CLAIM_ACTIVITY_MILESTONE",payload:{milestoneIndex:h,questType:y}})}):r==="weekly"?t.jsx(ki,{title:" ",questData:i.weekly,thresholds:ux,rewards:x0,questType:"weekly",onClaim:(h,y)=>s({type:"CLAIM_ACTIVITY_MILESTONE",payload:{milestoneIndex:h,questType:y}})}):r==="monthly"?t.jsx(ki,{title:" ",questData:i.monthly,thresholds:mx,rewards:p0,questType:"monthly",onClaim:(h,y)=>s({type:"CLAIM_ACTIVITY_MILESTONE",payload:{milestoneIndex:h,questType:y}})}):null;return t.jsx(be,{title:"",onClose:n,windowId:"quests",initialWidth:750,isTopmost:l,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*70)] flex flex-col",children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>a("daily"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="daily"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("weekly"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="weekly"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("monthly"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="monthly"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),r==="monthly"&&t.jsx("div",{className:"flex-shrink-0 text-center text-sm text-yellow-300 mb-4 bg-gray-900/50 p-2 rounded-md",children:t.jsx("p",{children:"   100       50%  ."})}),t.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[d(),c.length>0?t.jsx("ul",{className:"space-y-3",children:c.map(h=>t.jsx("li",{children:t.jsx(nv,{quest:h,onClaim:o})},h.id))}):t.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:t.jsx("p",{children:"   ."})})]})]})})},lv=9*60*60*1e3,qu=(e=Date.now())=>{const n=typeof e=="number"?e:e.getTime();return new Date(n+lv)},rv=(e,n)=>{if(!e||e===0)return!0;const s=qu(e),l=qu(n);if(s.getUTCFullYear()!==l.getUTCFullYear())return!0;const r=s.getUTCDay(),a=s.getUTCDate()-r+(r===0?-6:1),i=new Date(s);i.setUTCDate(a),i.setUTCHours(0,0,0,0);const o=l.getUTCDay(),c=l.getUTCDate()-o+(o===0?-6:1),d=new Date(l);return d.setUTCDate(c),d.setUTCHours(0,0,0,0),i.getTime()!==d.getTime()},_x=(e,n)=>{if(!e||!n)return!1;const s=9*60*60*1e3,l=new Date(e+s),r=new Date(n+s);return l.getUTCFullYear()===r.getUTCFullYear()&&l.getUTCMonth()===r.getUTCMonth()&&l.getUTCDate()===r.getUTCDate()},av=({currentUser:e,onBuy:n})=>{const s=Date.now(),l=_x(e.lastActionPointPurchaseDate||0,s)&&e.actionPointPurchasesToday||0,r=l<su,a=r?v0[l]:0,i=()=>{if(!r)return;if(!(e.diamonds>=a)){alert(" .");return}n()};return t.jsxs("div",{className:"bg-gray-800/60 rounded-lg p-4 flex flex-col items-center text-center border-2 border-gray-700",children:[t.jsx("div",{className:"w-24 h-24 bg-gray-900/50 rounded-md mb-3 flex items-center justify-center text-6xl",children:""}),t.jsx("h3",{className:"text-lg font-bold text-white",children:" "}),t.jsxs("p",{className:"text-xs text-gray-400 mt-1 flex-grow h-10",children:[" ",j0,"  . (  )"]}),t.jsx("div",{className:"flex flex-col items-center justify-center gap-2 my-3 w-full",children:t.jsx(z,{onClick:i,disabled:!r,colorScheme:"green",className:"w-full",children:r?t.jsxs("span",{className:"flex items-center justify-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",a.toLocaleString()]}):"   "})}),t.jsxs("p",{className:"text-xs text-gray-400",children:["  : ",l,"/",su]})]})},Uu=({item:e,onBuy:n,currentUser:s})=>{var j;const{name:l,description:r,price:a,image:i,dailyLimit:o,weeklyLimit:c}=e,d=!!a.gold,u=a.gold||a.diamonds||0,p=d?t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4"}):t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"}),m=Date.now(),h=(j=s.dailyShopPurchases)==null?void 0:j[e.itemId];let y=0,b=0,v="";c?(y=h&&!rv(h.date,m)?h.quantity:0,b=c,v=""):o&&(y=h&&_x(h.date,m)?h.quantity:0,b=o,v="");const g=b>0?b-y:e.type==="equipment"?100:void 0,x=()=>{n({...e,limit:g})};return t.jsxs("div",{className:"bg-gray-800/60 rounded-lg p-4 flex flex-col items-center text-center border-2 border-gray-700",children:[t.jsx("div",{className:"w-24 h-24 bg-gray-900/50 rounded-md mb-3 flex items-center justify-center",children:t.jsx("img",{src:i,alt:l,className:"w-full h-full object-contain p-2"})}),t.jsx("h3",{className:"text-lg font-bold text-white",children:l}),t.jsx("p",{className:"text-xs text-gray-400 mt-1 flex-grow h-10",children:r}),t.jsx("div",{className:"flex flex-col items-stretch justify-center gap-2 my-3 w-full",children:t.jsx(z,{onClick:x,disabled:g===0,colorScheme:"green",className:"w-full",children:t.jsxs("div",{className:"flex items-center justify-center gap-1.5 whitespace-nowrap",children:[t.jsx("span",{children:""}),t.jsxs("div",{className:"flex items-center gap-1",children:["(",p," ",u.toLocaleString(),")"]})]})})}),b>0&&t.jsxs("p",{className:"text-xs text-gray-400",children:[v,"  : ",g,"/",b]})]})},iv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{const[r,a]=f.useState("equipment"),[i,o]=f.useState(null),[c,d]=f.useState(null);f.useEffect(()=>{if(i){const y=setTimeout(()=>o(null),3e3);return()=>clearTimeout(y)}},[i]);const u=y=>{d(y)},p=(y,b)=>{const v=c;if(!v)return;const g=v.type==="equipment"?"BUY_SHOP_ITEM":"BUY_MATERIAL_BOX";s({type:g,payload:{itemId:y,quantity:b}}),o(" !  .")},m=()=>{s({type:"PURCHASE_ACTION_POINTS"}),o("  !")},h=()=>{const y=[{itemId:"equipment_box_1",name:"  I",description:"~   ",price:{gold:500},image:"/images/Box/EquipmentBox1.png",type:"equipment"},{itemId:"equipment_box_2",name:"  II",description:"~   ",price:{gold:1500},image:"/images/Box/EquipmentBox2.png",type:"equipment"},{itemId:"equipment_box_3",name:"  III",description:"~   ",price:{gold:5e3},image:"/images/Box/EquipmentBox3.png",type:"equipment"},{itemId:"equipment_box_4",name:"  IV",description:"~   ",price:{gold:1e4},image:"/images/Box/EquipmentBox4.png",type:"equipment"},{itemId:"equipment_box_5",name:"  V",description:"~   ",price:{diamonds:100},image:"/images/Box/EquipmentBox5.png",type:"equipment"},{itemId:"equipment_box_6",name:"  VI",description:"~   ",price:{diamonds:500},image:"/images/Box/EquipmentBox6.png",type:"equipment"}],b=[{itemId:"material_box_1",name:"  I",description:" ~   5 ",price:{gold:500},image:"/images/Box/ResourceBox1.png",dailyLimit:10,type:"material"},{itemId:"material_box_2",name:"  II",description:" ~   5 ",price:{gold:1e3},image:"/images/Box/ResourceBox2.png",dailyLimit:10,type:"material"},{itemId:"material_box_3",name:"  III",description:" ~   5 ",price:{gold:3e3},image:"/images/Box/ResourceBox3.png",dailyLimit:10,type:"material"},{itemId:"material_box_4",name:"  IV",description:" ~   5 ",price:{gold:5e3},image:"/images/Box/ResourceBox4.png",dailyLimit:10,type:"material"},{itemId:"material_box_5",name:"  V",description:" ~   5 ",price:{gold:1e4},image:"/images/Box/ResourceBox5.png",dailyLimit:10,type:"material"},{itemId:"material_box_6",name:"  VI",description:" ~   5 ",price:{diamonds:100},image:"/images/Box/ResourceBox6.png",dailyLimit:10,type:"material"}];switch(r){case"equipment":return t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:y.map(v=>t.jsx(Uu,{item:v,onBuy:u,currentUser:e},v.itemId))});case"materials":return t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:b.map(v=>t.jsx(Uu,{item:v,onBuy:u,currentUser:e},v.itemId))});case"misc":return t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:t.jsx(av,{currentUser:e,onBuy:m})});case"consumables":default:return t.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:t.jsx("p",{children:"    ."})})}};return t.jsxs(t.Fragment,{children:[c&&t.jsx(Tx,{item:c,currentUser:e,onClose:()=>d(null),onConfirm:p}),t.jsx(be,{title:"",onClose:n,windowId:"shop",initialWidth:700,isTopmost:l&&!c,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*60)] flex flex-col relative",children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>a("equipment"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="equipment"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("materials"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="materials"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("consumables"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="consumables"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("misc"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="misc"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:h()}),i&&t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg animate-fade-in z-10",children:i})]})})]})},Pr=[{id:"EI",question:"  ?",options:[{text:"   .",value:"E"},{text:"    .",value:"I"}]},{id:"SN",question:"  ?",options:[{text:"    .",value:"S"},{text:"    .",value:"N"}]},{id:"TF",question:"     ?",options:[{text:"    .",value:"T"},{text:"  ,  .",value:"F"}]},{id:"JP",question:"   ?",options:[{text:"    .",value:"J"},{text:"    .",value:"P"}]}],ov={ISTJ:", , ",ISFJ:", , ",INFJ:", ,  ",INTJ:", , ",ISTP:", ,  ",ISFP:", , ",INFP:",  , ",INTP:" , , ",ESTP:", , ",ESFP:", , ",ENFP:",  , ",ENTP:", , ",ESTJ:", , ",ESFJ:", , ",ENFJ:", , ",ENTJ:", , "},ko=({onClose:e,isTopmost:n})=>{const{currentUser:s,handlers:l}=De(),[r,a]=f.useState(!1),[i,o]=f.useState(0),[c,d]=f.useState({}),[u,p]=f.useState(!1),[m,h]=f.useState(null),y=f.useMemo(()=>!!(s!=null&&s.mbti),[s]),b=()=>{a(!0),o(0),d({}),p(!1),h(null)},v=(w,S)=>{d(C=>({...C,[w]:S}))},g=()=>{if(i<Pr.length-1)o(w=>w+1);else{const w=x();h(w),p(!0),l.handleAction({type:"UPDATE_MBTI",payload:{mbti:w,isMbtiPublic:!0}}),l.handleAction({type:"CLAIM_MBTI_REWARD"}),console.log("MBTI set:",w,"100 diamonds rewarded!")}},x=()=>{let w="";return Pr.forEach(S=>{w+=c[S.id]||"?"}),w},j=Pr[i];return t.jsx(be,{title:"MBTI  ",onClose:e,windowId:"mbti-info",initialWidth:400,isTopmost:n,children:t.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2",children:[!r&&!y&&t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("p",{className:"text-lg font-bold text-white mb-2",children:"MBTI ?"}),t.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"MBTI(Myers-Briggs Type Indicator)       .             ."}),t.jsx("button",{onClick:b,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200",children:"MBTI "}),t.jsx("p",{className:"text-sm text-yellow-400 mt-2",children:"  100  !"})]}),r&&!u&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-lg font-bold text-white",children:j.question}),t.jsx("div",{className:"space-y-2",children:j.options.map(w=>t.jsx("button",{onClick:()=>v(j.id,w.value),className:`block w-full text-left p-3 rounded-md transition-colors duration-200
                                        ${c[j.id]===w.value?"bg-blue-700 text-white":"bg-gray-800 hover:bg-gray-700 text-gray-200"}`,children:w.text},w.value))}),t.jsx("div",{className:"flex justify-end mt-4",children:t.jsx("button",{onClick:g,disabled:!c[j.id],className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:i<Pr.length-1?"":""})})]}),u&&m&&t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-2xl font-bold text-yellow-300 mb-4",children:[" MBTI ",m," !"]}),t.jsx("p",{className:"text-lg text-green-400 mb-4",children:"100  !"}),t.jsx("button",{onClick:e,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200",children:""})]}),!r&&(y||u)&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-lg font-bold text-white mb-2",children:[" MBTI: ",s==null?void 0:s.mbti]}),t.jsx("div",{className:"text-center mb-4",children:t.jsx("button",{onClick:b,className:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200",children:"MBTI  "})}),t.jsx("ul",{className:"space-y-2 mt-4",children:Object.entries(ov).map(([w,S])=>t.jsxs("li",{className:"flex items-center gap-4 bg-gray-900/50 p-2 rounded-md",children:[t.jsx("span",{className:"font-bold text-lg text-yellow-300 w-16",children:w}),t.jsx("span",{className:"text-sm text-gray-300",children:S})]},w))})]})]})})},zu=({level:e,currentXp:n,label:s,colorClass:l})=>{const r=1e3+(e-1)*200,a=Math.min(n/r*100,100);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-1 text-sm",children:[t.jsxs("span",{className:"font-semibold",children:[s," ",t.jsxs("span",{className:"text-lg font-bold",children:["Lv.",e]})]}),t.jsxs("span",{className:"text-xs font-mono text-gray-400",children:[n," / ",r]})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4 border border-gray-900",children:t.jsx("div",{className:`${l} h-full rounded-full transition-width duration-500`,style:{width:`${a}%`}})})]})},cv={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},dv=e=>{let n="",s="";if(e>=10)n="/images/equipments/Star4.png",s="prism-text-effect";else if(e>=7)n="/images/equipments/Star3.png",s="text-purple-400";else if(e>=4)n="/images/equipments/Star2.png",s="text-amber-400";else if(e>=1)n="/images/equipments/Star1.png",s="text-white";else return t.jsx("img",{src:"/images/equipments/Star1.png",alt:"star",className:"w-4 h-4 inline-block opacity-30",title:""});return t.jsxs("span",{className:"flex items-center gap-0.5",style:{textShadow:"1px 1px 2px black, 0 0 5px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-4 h-4"}),t.jsx("span",{className:`font-bold ${s}`,children:e})]})},Is=({slot:e,item:n,onClick:s})=>{const l=n&&s?"cursor-pointer hover:scale-105 transition-transform":"";return n?t.jsxs("div",{className:`relative w-full aspect-square rounded-lg border-2 border-gray-700/50 bg-gray-900/50 ${l}`,title:n.name,onClick:s,children:[t.jsx("img",{src:cv[n.grade],alt:n.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),t.jsx("div",{className:"absolute top-1 right-1 text-sm font-bold z-10",children:dv(n.stars)}),n.image&&t.jsx("img",{src:n.image,alt:n.name,className:"relative w-full h-full object-contain p-3"})]}):t.jsx("img",{src:La[e],alt:`${e} empty slot`,className:"w-full aspect-square rounded-lg bg-gray-900/50 border-2 border-gray-700/50"})},Fu=({user:e,type:n})=>{const s=n==="strategic"?Ye:rt,l=e.stats||{};let r=0,a=0;const i=s.map(d=>{const u=l[d.mode];return u?(r+=u.wins,a+=u.losses,{mode:d.mode,...u}):{mode:d.mode,wins:0,losses:0,rankingScore:1200}}),o=r+a,c=o>0?Math.round(r/o*100):0;return t.jsxs("div",{className:"space-y-3 text-xs",children:[t.jsx("div",{className:"bg-gray-700/50 p-2 rounded-md text-center",children:t.jsxs("span",{className:"font-bold",children:[" : ",r," ",a," (",c,"%)"]})}),i.map(d=>{if(d.wins===0&&d.losses===0)return null;const u=d.wins+d.losses,p=u>0?Math.round(d.wins/u*100):0;return t.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-900/30 rounded",children:[t.jsx("span",{className:"font-semibold w-28",children:d.mode}),t.jsxs("span",{className:"w-24 text-center",children:[d.wins," ",d.losses," (",p,"%)"]}),t.jsxs("span",{className:"w-16 text-right font-mono text-yellow-300",children:[d.rankingScore,""]})]},d.mode)})]})},uv=({user:e,onClose:n,onViewItem:s,isTopmost:l})=>{const{inventory:r,stats:a,nickname:i,avatarId:o,borderId:c}=e,[d,u]=f.useState("strategic"),[p,m]=f.useState(!1),h=f.useMemo(()=>{var S;return(S=Me.find(C=>C.id===o))==null?void 0:S.url},[o]),y=f.useMemo(()=>{var S;return(S=Re.find(C=>C.id===c))==null?void 0:S.url},[c]),b=f.useMemo(()=>tl.find(S=>S.tier===e.league),[e.league]),v=f.useMemo(()=>(r||[]).filter(S=>S.isEquipped),[r]),g=S=>v.find(C=>C.slot===S),x=Nx(e),j=kc(x),w=Sx(x);return t.jsxs(be,{title:`${i} `,onClose:n,windowId:`user-profile-${e.id}`,initialWidth:750,isTopmost:l,children:[p&&t.jsx(ko,{onClose:()=>m(!1),isTopmost:!0}),t.jsxs("div",{className:"flex flex-col md:flex-row gap-4 max-h-[calc(var(--vh,1vh)*70)]",children:[t.jsxs("div",{className:"w-full md:w-1/3 flex-shrink-0 flex flex-col gap-4",children:[t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:e.id,userName:i,size:80,avatarUrl:h,borderUrl:y}),t.jsx("h2",{className:"text-xl font-bold mt-2",children:i}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mt-1",children:[t.jsx("span",{children:": "}),t.jsxs("span",{className:`font-semibold ${j.color}`,children:[x," (",j.rank,")"]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mt-1",children:[t.jsx("span",{children:"MBTI:"}),t.jsxs("span",{className:"font-semibold text-gray-200 flex items-center gap-1",children:[e.mbti?e.mbti:"",!e.mbti&&t.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"})]}),e.mbti&&t.jsx("button",{onClick:()=>m(!0),className:"w-4 h-4 text-xs bg-gray-600 rounded-full text-white flex items-center justify-center hover:bg-gray-500",children:"?"})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mt-2 border border-gray-900",children:t.jsx("div",{className:`${w.colorClass} h-full rounded-full`,style:{width:`${w.percentage}%`}})})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 space-y-3",children:[t.jsx(zu,{level:e.strategyLevel,currentXp:e.strategyXp,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-400"}),t.jsx(zu,{level:e.playfulLevel,currentXp:e.playfulXp,label:"",colorClass:"bg-gradient-to-r from-yellow-500 to-orange-400"})]}),b&&t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex flex-col items-center text-center",children:[t.jsx("img",{src:b.icon,alt:b.name,className:"w-16 h-16"}),t.jsx("h3",{className:"font-bold text-purple-300 mt-1",children:b.name}),t.jsxs("p",{className:"text-sm text-gray-300",children:[e.tournamentScore.toLocaleString()," "]})]})]}),t.jsxs("div",{className:"w-full md:w-2/3 flex flex-col gap-4",children:[t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex-grow flex flex-col min-h-0",children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-3 flex-shrink-0",children:[t.jsx("button",{onClick:()=>u("strategic"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md transition-all ${d==="strategic"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "}),t.jsx("button",{onClick:()=>u("playful"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md transition-all ${d==="playful"?"bg-yellow-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:d==="strategic"?t.jsx(Fu,{user:e,type:"strategic"}):t.jsx(Fu,{user:e,type:"playful"})})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex-shrink-0",children:[t.jsx("h3",{className:"text-center font-semibold mb-3 text-gray-300",children:" "}),t.jsxs("div",{className:"grid grid-cols-3 gap-3 w-full max-w-xs mx-auto",children:[t.jsx(Is,{slot:"fan",item:g("fan"),onClick:()=>g("fan")&&s(g("fan"),!1)}),t.jsx(Is,{slot:"board",item:g("board"),onClick:()=>g("board")&&s(g("board"),!1)}),t.jsx(Is,{slot:"top",item:g("top"),onClick:()=>g("top")&&s(g("top"),!1)}),t.jsx(Is,{slot:"bottom",item:g("bottom"),onClick:()=>g("bottom")&&s(g("bottom"),!1)}),t.jsx(Is,{slot:"bowl",item:g("bowl"),onClick:()=>g("bowl")&&s(g("bowl"),!1)}),t.jsx(Is,{slot:"stones",item:g("stones"),onClick:()=>g("stones")&&s(g("stones"),!1)})]})]})]})]})]})},mv=({onClose:e,isTopmost:n})=>{const[s,l]=f.useState("game"),r=[{id:"game",label:""},{id:"level",label:""},{id:"ranking",label:""},{id:"equipment",label:""},{id:"manner",label:""}],a=()=>{switch(s){case"game":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-blue-300",children:" "}),t.jsx("p",{className:"text-sm",children:" ,        .     .      '?'     ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-yellow-300",children:" "}),t.jsx("p",{className:"text-sm",children:" ,       .     .      '?'     ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-purple-300",children:""}),t.jsx("p",{className:"text-sm",children:"AI    .        ,      .       ."})]})]});case"level":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:" "}),t.jsx("p",{className:"text-sm",children:"/     (XP) .  100%   ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-green-300",children:" "}),t.jsx("p",{className:"text-sm",children:"       2    .   ' '   6   ,     ."})]})]});case"ranking":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:" "}),t.jsx("p",{className:"text-sm",children:"     ,    .     ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-purple-300",children:" "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1 pl-2",children:[t.jsx("li",{children:" 3   (1, 2, 3, 4)."}),t.jsxs("li",{children:["     ",t.jsx("strong",{className:"text-yellow-300",children:" 20"}),"        . ( )"]}),t.jsx("li",{children:"20       ''  ."}),t.jsx("li",{children:"  ,             ."}),t.jsx("li",{children:"      (/)   ,  20   ."})]})]})]});case"equipment":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:" "}),t.jsx("p",{className:"text-sm",children:", ,   6        .  , , , , ,   .      ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-cyan-300",children:""}),t.jsx("p",{className:"text-sm",children:"    ()  5   .      ,        ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-orange-300",children:""}),t.jsx("p",{className:"text-sm",children:"          .   ''  2    ."})]})]});case"manner":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:"  "}),t.jsx("p",{className:"text-sm",children:"      . ''  ,       ( ,   )   .       ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:"   "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-2 pl-2",children:[t.jsxs("li",{children:[t.jsx("span",{className:"text-purple-400 font-semibold",children:" (2000 ):"}),"    +20 (   )"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-blue-400 font-semibold",children:" (1600 ~ 1999):"}),"     +10%"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-cyan-400 font-semibold",children:" (1200 ~ 1599):"}),"        +10%"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-teal-400 font-semibold",children:"  (800 ~ 1199):"}),"      +10%"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-green-400 font-semibold",children:" (400 ~ 799):"}),"   +10"]}),t.jsxs("li",{className:"border-t border-gray-600 pt-2",children:[t.jsx("span",{className:"text-gray-300 font-semibold",children:" (200 ~ 399):"}),"  "]}),t.jsxs("li",{className:"border-t border-gray-600 pt-2",children:[t.jsx("span",{className:"text-yellow-400 font-semibold",children:" (100 ~ 199):"}),"        +1  "]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-orange-400 font-semibold",children:" (50 ~ 99):"}),"   50% "]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-500 font-semibold",children:"  (1 ~ 49):"}),"     (20 1)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-700 font-semibold",children:" (0):"}),"   10% "]})]})]})]});default:return null}};return t.jsx(be,{title:"",onClose:e,windowId:"info-modal",initialWidth:600,isTopmost:n,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*60)] flex flex-col",children:[t.jsx("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:r.map(i=>t.jsx("button",{onClick:()=>l(i.id),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s===i.id?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:i.label},i.id))}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 bg-gray-900/30 p-4 rounded-md",children:a()})]})})},Ax=({isOpen:e,onClose:n,result:s})=>!e||!s?null:t.jsx(be,{title:" ",onClose:n,windowId:"disassemblyResult",isTopmost:!0,children:t.jsxs("div",{className:"p-4 text-on-panel flex flex-col items-center",children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:"  !"}),s.jackpot&&t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("p",{className:"text-yellow-400 text-2xl font-bold animate-pulse",children:"!"}),t.jsx("p",{className:"text-lg text-green-400",children:"   2 !"})]}),t.jsxs("div",{className:"w-full max-h-60 overflow-y-auto bg-gray-800/50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"font-semibold text-secondary mb-2",children:" :"}),s.gained.length>0?s.gained.map((l,r)=>{const a=en[l.name];return t.jsxs("div",{className:"flex items-center justify-between text-sm py-1 border-b border-gray-700 last:border-b-0",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[(a==null?void 0:a.image)&&t.jsx("img",{src:a.image,alt:l.name,className:"w-6 h-6"}),l.name]}),t.jsxs("span",{className:"font-mono text-primary",children:["x ",l.amount.toLocaleString()]})]},r)}):t.jsx("p",{className:"text-sm text-tertiary",children:"  ."})]}),t.jsx(z,{onClick:n,colorScheme:"blue",className:"w-full max-w-xs",children:""})]})}),fv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{const[r,a]=f.useState(!e.spentStatPoints||Object.keys(e.spentStatPoints).length===0),[i,o]=f.useState(()=>e.spentStatPoints&&Object.keys(e.spentStatPoints).length>0?e.spentStatPoints:{[N.Concentration]:0,[N.ThinkingSpeed]:0,[N.Judgment]:0,[N.Calculation]:0,[N.CombatPower]:0,[N.Stability]:0}),c=1e3,d=2,u=new Date().toDateString(),p=e.lastStatResetDate,m=e.statResetCountToday||0,h=f.useMemo(()=>!(e.gold<c||p===u&&m>=d),[e.diamonds,p,m,u]),y=(e.strategyLevel-1)*2+(e.playfulLevel-1)*2,b=e.mannerMasteryApplied?20:0,v=y+b,g=f.useMemo(()=>Object.values(i).reduce((_,E)=>_+E,0),[i]),x=f.useMemo(()=>r?v-g:0,[r,v,g]),j=(_,E)=>{const I=Number(E)||0;o(R=>{const A=Object.entries(R).filter(([V])=>V!==_).reduce((V,[,D])=>V+D,0),O=v-A,B=Math.max(0,Math.min(I,O));return{...R,[_]:B}})},w=()=>{if(!h){alert("    .      .");return}window.confirm(` ${c}     ? ( ${d-m} )`)&&(s({type:"RESET_STAT_POINTS"}),o({[N.Concentration]:0,[N.ThinkingSpeed]:0,[N.Judgment]:0,[N.Calculation]:0,[N.CombatPower]:0,[N.Stability]:0}),a(!0))},S=f.useMemo(()=>e.spentStatPoints?Object.values(N).some(_=>i[_]!==e.spentStatPoints[_]):g>0,[i,e.spentStatPoints,g]),C=()=>{s({type:"CONFIRM_STAT_ALLOCATION",payload:{newStatPoints:i}}),n()},k=f.useMemo(()=>{const _={};for(const E of Object.values(N))_[E]=(e.baseStats[E]||0)+(i[E]||0);return _},[e.baseStats,i]),M=f.useMemo(()=>[{stats:k,color:"#60a5fa",fill:"rgba(59, 130, 246, 0.4)"}],[k]);return t.jsx(be,{title:"  ",onClose:n,windowId:"stat-allocation",initialWidth:700,isTopmost:l,children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-6 h-[calc(var(--vh,1vh)*70)]",children:[t.jsxs("div",{className:"w-full md:w-1/2 flex flex-col items-center justify-center bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-bold mb-4",children:" "}),t.jsx(Ex,{datasets:M,maxStatValue:300})]}),t.jsxs("div",{className:"w-full md:w-1/2 flex flex-col",children:[t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg mb-4 text-center",children:[t.jsx("p",{className:"text-gray-300",children:"   "}),t.jsx("p",{className:"text-3xl font-bold text-green-400",children:x})]}),t.jsx("div",{className:"flex-grow space-y-2 overflow-y-auto pr-2",children:Object.values(N).map(_=>{const E=i[_]||0,I=E+x;return t.jsxs("div",{className:"bg-gray-900/40 p-2 md:p-3 rounded-md",children:[t.jsxs("div",{className:"flex justify-between items-center mb-1",children:[t.jsx("span",{className:"font-bold text-gray-200 text-sm md:text-base",children:_}),t.jsx("span",{className:"font-mono font-bold text-lg",title:`: ${e.baseStats[_]}, : ${E}`,children:k[_]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"range",min:"0",max:I,value:E,onChange:R=>j(_,R.target.value),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer",disabled:!r}),t.jsx("input",{type:"number",value:E,onChange:R=>j(_,R.target.value),className:"w-16 bg-gray-700 border border-gray-600 rounded-md p-1 text-center",disabled:!r})]}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:c0[_].description})]},_)})}),t.jsxs("div",{className:"flex justify-between mt-4 pt-4 border-t border-gray-700",children:[t.jsxs("div",{className:"flex flex-col items-start",children:[t.jsxs(z,{onClick:w,colorScheme:"red",disabled:!h,children:[" (",t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4 inline-block"}),c,")"]}),t.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[" : ",d-m,"/",d]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(z,{onClick:n,colorScheme:"gray",children:""}),t.jsx(z,{onClick:C,colorScheme:"green",disabled:!r||!S,children:""})]})]})]})]})})},xv={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},pv=e=>{if(e===0)return null;let n="",s="";return e>=10?(n="/images/equipments/Star4.png",s="prism-text-effect"):e>=7?(n="/images/equipments/Star3.png",s="text-purple-400"):e>=4?(n="/images/equipments/Star2.png",s="text-amber-400"):e>=1&&(n="/images/equipments/Star1.png",s="text-white"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:`font-bold text-xs leading-none ${s}`,children:e})]})},gv=({item:e,isOwnedByCurrentUser:n,onClose:s,onStartEnhance:l,isTopmost:r})=>{var u,p,m,h;const{currentUserWithStatus:a}=De(),i=xv[e.grade],o=En[e.grade],d=((a==null?void 0:a.strategyLevel)||0)+((a==null?void 0:a.playfulLevel)||0)>=o;return t.jsx(be,{title:"  ",onClose:s,windowId:`item-detail-${e.id}`,initialWidth:350,isTopmost:r,children:t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"relative w-24 h-24 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:i.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-2"}),pv(e.stars)]}),t.jsxs("div",{className:"flex-grow text-right ml-4",children:[t.jsx("div",{className:"flex items-baseline justify-end gap-1",children:t.jsx("h3",{className:`text-xl font-bold ${i.color}`,children:e.name})}),t.jsxs("p",{className:"text-gray-400 text-sm",children:["[",i.name,"]"]}),t.jsxs("p",{className:`text-xs ${d?"text-gray-500":"text-red-500"}`,children:["(: ",o,")"]}),((u=e.options)==null?void 0:u.main)&&t.jsx("p",{className:"font-semibold text-yellow-300 text-sm",children:e.options.main.display})]})]}),t.jsxs("div",{className:"w-full text-sm text-left space-y-2 bg-gray-900/50 p-3 rounded-lg flex-grow overflow-y-auto",children:[((p=e.options)==null?void 0:p.combatSubs)&&e.options.combatSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.combatSubs.map((y,b)=>t.jsx("p",{className:"text-blue-300",children:y.display},b))}),((m=e.options)==null?void 0:m.specialSubs)&&e.options.specialSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.specialSubs.map((y,b)=>t.jsx("p",{className:"text-green-300",children:y.display},b))}),((h=e.options)==null?void 0:h.mythicSubs)&&e.options.mythicSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.mythicSubs.map((y,b)=>t.jsx("p",{className:"text-red-400",children:y.display},b))})]}),n&&e.type==="equipment"&&t.jsx("div",{className:"w-full mt-6 pt-4 border-t border-gray-700",children:t.jsx(z,{onClick:()=>l(e),disabled:e.stars>=10,colorScheme:"yellow",className:"w-full",children:e.stars>=10?" ":""})})]})})},Ln=({checked:e,onChange:n,label:s,disabled:l=!1})=>{const r=Pn.useId();return t.jsxs("label",{htmlFor:r,className:`flex items-center ${l?"cursor-not-allowed opacity-60":"cursor-pointer"}`,children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{id:r,type:"checkbox",className:"sr-only",checked:e,onChange:a=>!l&&n(a.target.checked),disabled:l}),t.jsx("div",{className:`block w-12 h-6 rounded-full transition-colors ${e?"bg-accent":"bg-secondary"}`}),t.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${e?"transform translate-x-6":""}`})]}),s&&t.jsx("span",{className:"ml-3 text-secondary font-medium",children:s})]})},Ci={E:{name:" (E)",general:" .       .",goStyle:"     .        ."},I:{name:" (I)",general:" ,    .         .",goStyle:"     .     ,    ."},S:{name:" (S)",general:" ,    .     .",goStyle:"     .    ,   ."},N:{name:" (N)",general:"  .   ,     .",goStyle:"    .  ,       ."},T:{name:" (T)",general:" ,     .    .",goStyle:"       .      ."},F:{name:" (F)",general:"     .     ,   .",goStyle:"      .       ."},J:{name:" (J)",general:" ,     .       .",goStyle:"      .      ,    ."},P:{name:" (P)",general:"   ,    .     .",goStyle:"       .       ."}},hv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{const{handlers:r}=De(),[a,i]=f.useState("border"),[o,c]=f.useState(e.avatarId),[d,u]=f.useState(e.borderId),[p,m]=f.useState(e.nickname),[h,y]=f.useState(e.isMbtiPublic||!1),b=E=>E&&E.length===4?{ei:E[0],sn:E[1],tf:E[2],jp:E[3]}:{ei:"E",sn:"S",tf:"T",jp:"J"},[v,g]=f.useState(b(e.mbti)),x=150,j=e.diamonds>=x,w=f.useMemo(()=>{var E;return(E=Me.find(I=>I.id===e.avatarId))==null?void 0:E.url},[e.avatarId]),S=()=>{switch(a){case"avatar":o!==e.avatarId&&s({type:"UPDATE_AVATAR",payload:{avatarId:o}});break;case"border":d!==e.borderId&&s({type:"UPDATE_BORDER",payload:{borderId:d}});break;case"nickname":if(p!==e.nickname){if(Ql(p)){alert("    .");return}window.confirm(` ${x}   '${p}'() ?`)&&s({type:"CHANGE_NICKNAME",payload:{newNickname:p}})}break;case"mbti":const E=`${v.ei}${v.sn}${v.tf}${v.jp}`;s({type:"UPDATE_MBTI",payload:{mbti:E,isMbtiPublic:!0}});break}},C=f.useMemo(()=>{switch(a){case"avatar":return o===e.avatarId;case"border":return d===e.borderId;case"nickname":return p===e.nickname||!j||p.trim().length<2||p.trim().length>12;case"mbti":return`${v.ei}${v.sn}${v.tf}${v.jp}`===(e.mbti||"");default:return!0}},[a,o,d,p,e,j,v]),k=f.useMemo(()=>{const E=R=>ru.some(A=>A.id===R.id),I={:[],:[],:[],:[]};return Re.forEach(R=>{R.unlockTier?I..push(R):R.requiredLevelSum?I..push(R):E(R)?I..push(R):I..push(R)}),I},[]),M=()=>{switch(a){case"avatar":return t.jsx("div",{className:"flex flex-wrap justify-center gap-4",children:Me.map(E=>{const I=E.type==="any"||E.type==="strategy"&&e.strategyLevel>=E.requiredLevel||E.type==="playful"&&e.playfulLevel>=E.requiredLevel;return t.jsxs("div",{onClick:()=>I&&c(E.id),className:`relative p-2 rounded-lg border-2 ${o===E.id?"border-blue-500 ring-2 ring-blue-500":"border-gray-700"} ${I?"cursor-pointer hover:bg-gray-700/50":"opacity-50 cursor-not-allowed"}`,children:[t.jsx(Ce,{userId:"preview",userName:E.name,avatarUrl:E.url,size:80}),t.jsx("p",{className:"text-xs text-center mt-1",children:E.name}),!I&&t.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center text-center text-xs p-1 rounded-full",children:[t.jsx("span",{className:"font-bold",children:""}),t.jsxs("span",{children:[E.type==="strategy"?"":""," Lv.",E.requiredLevel]})]})]},E.id)})});case"border":{const{ownedBorders:E,strategyLevel:I,playfulLevel:R,previousSeasonTier:A}=e,O=I+R,B=At.map(V=>V.name);return t.jsx("div",{className:"space-y-6",children:Object.keys(k).map(V=>{const D=k[V];return D.length===0?null:t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-yellow-300 mb-3 border-b border-gray-700 pb-2",children:V}),t.jsx("div",{className:"flex flex-wrap justify-start gap-4",children:D.map(L=>{var xe,Q;const q=(E==null?void 0:E.includes(L.id))||L.id==="default"||L.id==="simple_black";let U=!1,W=L.description;if(L.unlockTier){if(W=`  ${L.unlockTier}  `,A){const G=B.indexOf(L.unlockTier),K=B.indexOf(A);G!==-1&&K!==-1&&K<=G&&(U=!0)}}else L.requiredLevelSum&&(W=`  ${L.requiredLevelSum} `,O>=L.requiredLevelSum&&(U=!0));const H=q||U,te=ru.find(G=>G.id===L.id),le=te&&!q,ce=()=>{var G;if(H)u(L.id);else if(le){const K=te.price.gold?`${te.price.gold.toLocaleString()} `:`${(G=te.price.diamonds)==null?void 0:G.toLocaleString()} `;window.confirm(`'${L.name}'  ${K} ?`)&&s({type:"BUY_BORDER",payload:{borderId:L.id}})}},F=H||le?"cursor-pointer":"cursor-not-allowed",X=!H&&!le?"opacity-50":"",ee=H?L.description:le?` : ${L.description}`:W;return t.jsxs("div",{onClick:ce,className:`relative flex flex-col items-center gap-1 p-1 rounded-lg ${F}`,title:ee,children:[t.jsxs("div",{className:`p-1 rounded-full relative ${d===L.id?"border-2 border-blue-500 ring-2 ring-blue-500":"border-2 border-transparent"}`,children:[t.jsx("div",{className:X,children:t.jsx(Ce,{userId:"preview",userName:L.name,avatarUrl:w,borderUrl:L.url,size:80})}),!H&&!le&&t.jsx("div",{className:"absolute top-1 right-1 bg-gray-900/80 rounded-full p-1",children:t.jsx("span",{className:"text-base",role:"img","aria-label":"Locked",children:""})}),le&&t.jsxs("div",{className:"absolute bottom-0 inset-x-0 bg-black/70 rounded-b-md text-xs py-0.5 text-center flex items-center justify-center gap-1",children:[te.price.gold?t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-3 h-3"}):t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-3 h-3"}),t.jsx("span",{children:((xe=te.price.gold)==null?void 0:xe.toLocaleString())||((Q=te.price.diamonds)==null?void 0:Q.toLocaleString())})]})]}),t.jsx("p",{className:"text-xs text-center truncate w-24",children:L.name}),!H&&!le&&t.jsx("p",{className:"text-[10px] text-center text-red-400",children:L.requiredLevelSum?` ${L.requiredLevelSum}`:L.unlockTier?`${L.unlockTier} `:""})]},L.id)})})]},V)})})}case"nickname":return t.jsxs("div",{className:"space-y-4 max-w-sm mx-auto p-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"nickname-input",className:"block text-sm font-medium text-gray-300 mb-1",children:"  (2-12)"}),t.jsx("input",{id:"nickname-input",type:"text",value:p,onChange:E=>m(E.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-md p-3 focus:ring-blue-500 focus:border-blue-500",maxLength:12,minLength:2})]}),t.jsxs("div",{className:"text-sm p-3 rounded-md bg-gray-900/50",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"}),t.jsxs("span",{className:`font-bold flex items-center gap-1 ${j?"text-cyan-300":"text-red-400"}`,children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",x]})]}),t.jsxs("div",{className:"flex justify-between mt-1",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",e.diamonds.toLocaleString()]})]})]})]});case"mbti":{const E=({title:R,options:A,selected:O,onSelect:B})=>t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg flex-1",children:[t.jsx("h4",{className:"font-semibold text-lg text-center mb-2",children:R}),t.jsx("div",{className:"flex justify-center gap-2 mb-3",children:A.map(V=>t.jsx(z,{onClick:()=>B(V),colorScheme:O===V?"blue":"gray",className:"w-24",children:Ci[V].name},V))}),t.jsxs("div",{className:"bg-gray-800/60 p-2 rounded-md text-xs min-h-[120px]",children:[t.jsx("h5",{className:"font-bold text-yellow-300",children:" "}),t.jsx("p",{className:"text-gray-300",children:Ci[O].general}),t.jsx("h5",{className:"font-bold text-cyan-300 mt-2",children:" "}),t.jsx("p",{className:"text-gray-300",children:Ci[O].goStyle})]})]}),I=`${v.ei}${v.sn}${v.tf}${v.jp}`;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg text-center",children:[t.jsx("h3",{className:"text-lg font-bold text-yellow-300",children:"MBTI?"}),t.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"MBTI 4    16       .      !"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(E,{title:" ",options:["E","I"],selected:v.ei,onSelect:R=>g(A=>({...A,ei:R}))}),t.jsx(E,{title:" ",options:["S","N"],selected:v.sn,onSelect:R=>g(A=>({...A,sn:R}))}),t.jsx(E,{title:" ",options:["T","F"],selected:v.tf,onSelect:R=>g(A=>({...A,tf:R}))}),t.jsx(E,{title:" ",options:["J","P"],selected:v.jp,onSelect:R=>g(A=>({...A,jp:R}))})]}),t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold text-lg",children:" MBTI:"}),t.jsx("span",{className:"font-bold text-2xl text-green-400",children:I})]}),t.jsx(Ln,{label:" MBTI  ",checked:h,onChange:y})]})]})}default:return null}},_=[{id:"avatar",label:""},{id:"border",label:""},{id:"nickname",label:""},{id:"mbti",label:"MBTI"}];return t.jsx(be,{title:"",onClose:n,windowId:"profile-edit",initialWidth:750,isTopmost:l,children:t.jsxs("div",{className:"flex flex-col h-[70vh]",children:[t.jsx("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:_.map(E=>t.jsxs("button",{onClick:()=>i(E.id),className:`relative flex-1 py-2 text-sm font-semibold rounded-md transition-all ${a===E.id?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:[E.label,E.id==="mbti"&&!e.mbti&&t.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]},E.id))}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:M()}),t.jsxs("div",{className:"flex justify-end gap-4 mt-4 pt-4 border-t border-gray-700 flex-shrink-0",children:[t.jsx(z,{onClick:n,colorScheme:"gray",children:""}),t.jsx(z,{onClick:S,colorScheme:"green",disabled:C,children:a==="nickname"&&!j?" ":""})]})]})})},yv={normal:{bg:"bg-gray-700",text:"text-white",shadow:"shadow-gray-900/50",name:"",background:"/images/equipments/normalbgi.png"},uncommon:{bg:"bg-green-700",text:"text-green-200",shadow:"shadow-green-500/50",name:"",background:"/images/equipments/uncommonbgi.png"},rare:{bg:"bg-blue-700",text:"text-blue-200",shadow:"shadow-blue-500/50",name:"",background:"/images/equipments/rarebgi.png"},epic:{bg:"bg-purple-700",text:"text-purple-200",shadow:"shadow-purple-500/50",name:"",background:"/images/equipments/epicbgi.png"},legendary:{bg:"bg-red-800",text:"text-red-200",shadow:"shadow-red-500/50",name:"",background:"/images/equipments/legendarybgi.png"},mythic:{bg:"bg-orange-700",text:"text-orange-200",shadow:"shadow-orange-500/50",name:"",background:"/images/equipments/mythicbgi.png"}},bv={rare:"spinning-border-rare",epic:"spinning-border-epic",legendary:"spinning-border-legendary",mythic:"spinning-border-mythic"},vv=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-blue-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},Mr=({title:e,options:n,color:s})=>n.length===0?null:t.jsxs("div",{children:[t.jsx("h5",{className:`font-semibold ${s} border-b border-gray-600 pb-1 mb-1 text-sm`,children:e}),t.jsx("ul",{className:"list-disc list-inside space-y-0.5 text-gray-300 text-xs",children:n.map((l,r)=>t.jsx("li",{children:l.display},r))})]}),jv=e=>{if(!e.options)return null;const{main:n,combatSubs:s,specialSubs:l,mythicSubs:r}=e.options;return t.jsxs("div",{className:"w-full text-xs text-left space-y-2",children:[t.jsx(Mr,{title:"",options:[n],color:"text-yellow-300"}),t.jsx(Mr,{title:" ",options:s,color:"text-blue-300"}),t.jsx(Mr,{title:" ",options:l,color:"text-green-300"}),t.jsx(Mr,{title:" ",options:r,color:"text-red-400"})]})},wv=({item:e,onClose:n,isTopmost:s})=>{var c;const l=yv[e.grade],r=e.type==="equipment"?En[e.grade]:null,a=vv(e.stars),i=bv[e.grade],o=e.image==="/images/icon/Gold.png"||e.image==="/images/icon/Zem.png";return f.useEffect(()=>{["epic","legendary","mythic"].includes(e.grade)&&Ee.gachaEpicOrHigher()},[e.grade]),t.jsx(be,{title:" ",onClose:n,windowId:"item-obtained",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"p-6 rounded-lg",children:[t.jsxs("div",{className:"relative w-48 h-48 mx-auto rounded-lg mb-4 overflow-hidden",children:[i&&t.jsx("div",{className:`absolute -inset-1 rounded-lg ${i}`}),t.jsxs("div",{className:"relative w-full h-full rounded-lg flex items-center justify-center border-2 border-black/50 overflow-hidden",children:[t.jsx("img",{src:l.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-4"}),o&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-sm p-1",children:t.jsxs("span",{className:"text-white text-3xl font-bold text-center break-words",style:{textShadow:"1px 1px 2px black"},children:["+",(c=e.quantity)==null?void 0:c.toLocaleString()]})})]})]}),t.jsxs("p",{className:`font-bold text-lg ${l.text}`,children:["[",l.name,"]"]}),t.jsxs("div",{className:"flex items-baseline justify-center gap-2",children:[t.jsx("h2",{className:`text-3xl font-bold ${a.colorClass}`,children:e.name}),e.stars>0&&t.jsx("span",{className:`text-2xl font-bold ${a.colorClass}`,children:a.text})]}),r&&t.jsxs("p",{className:"text-xs text-yellow-300",children:["(  : ",r,")"]}),e.type==="equipment"&&t.jsx("div",{className:"w-full text-xs text-left space-y-2 mt-4 max-h-48 overflow-y-auto bg-black/20 p-2 rounded-md",children:jv(e)})]}),t.jsx(z,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},Nv={normal:{bg:"bg-gray-700",text:"text-white",shadow:"shadow-gray-900/50",name:"",background:"/images/equipments/normalbgi.png"},uncommon:{bg:"bg-green-700",text:"text-green-200",shadow:"shadow-green-500/50",name:"",background:"/images/equipments/uncommonbgi.png"},rare:{bg:"bg-blue-700",text:"text-blue-200",shadow:"shadow-blue-500/50",name:"",background:"/images/equipments/rarebgi.png"},epic:{bg:"bg-purple-700",text:"text-purple-200",shadow:"shadow-purple-500/50",name:"",background:"/images/equipments/epicbgi.png"},legendary:{bg:"bg-red-800",text:"text-red-200",shadow:"shadow-red-500/50",name:"",background:"/images/equipments/legendarybgi.png"},mythic:{bg:"bg-orange-700",text:"text-orange-200",shadow:"shadow-orange-500/50",name:"",background:"/images/equipments/mythicbgi.png"}},Sv={rare:"spinning-border-rare",epic:"spinning-border-epic",legendary:"spinning-border-legendary",mythic:"spinning-border-mythic"},kv=({items:e,onClose:n,isTopmost:s})=>{f.useEffect(()=>{if(e&&e.length>0){const r=["normal","uncommon","rare","epic","legendary","mythic"],a=e.reduce((i,o)=>{const c=i.grade||"normal",d=o.grade||"normal";return r.indexOf(d)>r.indexOf(c)?o:i});["epic","legendary","mythic"].includes(a.grade)&&Ee.gachaEpicOrHigher()}},[e]);const l=f.useMemo(()=>e.reduce((r,a)=>r+(a.quantity||1),0),[e]);return t.jsx(be,{title:"  ",onClose:n,windowId:"bulk-item-obtained",initialWidth:600,closeOnOutsideClick:!1,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsxs("h2",{className:"text-xl font-bold mb-4",children:[" ",l," !"]}),t.jsx("div",{className:"grid grid-cols-5 gap-2 max-h-[60vh] overflow-y-auto p-2 bg-gray-900/50 rounded-lg",children:e.map((r,a)=>{var p;const i=Nv[r.grade],o=Sv[r.grade],c=r.type==="equipment"?En[r.grade]:null,d=`${r.name}${c?` (  : ${c})`:""}`,u=r.image==="/images/icon/Gold.png"||r.image==="/images/icon/Zem.png";return t.jsxs("div",{className:"relative aspect-square rounded-md overflow-hidden",title:d,children:[o&&t.jsx("div",{className:`absolute -inset-0.5 rounded-md ${o}`}),t.jsxs("div",{className:`relative w-full h-full rounded-md flex items-center justify-center border-2 border-black/20 ${i.bg}`,children:[t.jsx("img",{src:i.background,alt:r.grade,className:"absolute inset-0 w-full h-full object-cover rounded-sm"}),r.image&&t.jsx("img",{src:r.image,alt:r.name,className:"relative w-full h-full object-contain p-1"}),u?t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-sm p-1",children:t.jsxs("span",{className:"text-white text-lg font-bold text-center break-words",style:{textShadow:"1px 1px 2px black"},children:["+",(p=r.quantity)==null?void 0:p.toLocaleString()]})}):r.quantity&&r.quantity>1&&t.jsx("span",{className:"absolute bottom-0 right-0 text-xs font-bold text-white bg-black/60 px-1 rounded-tl-md",children:r.quantity})]})]},a)})}),t.jsx(z,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},Gu={normal:"images/equipments/normalbgi.png",uncommon:"images/equipments/uncommonbgi.png",rare:"images/equipments/rarebgi.png",epic:"images/equipments/epicbgi.png",legendary:"images/equipments/legendarybgi.png",mythic:"images/equipments/mythicbgi.png"},Tr={normal:0,uncommon:1,rare:2,epic:3,legendary:4,mythic:5},Cv=({onClose:e,isTopmost:n})=>{const[s,l]=f.useState("equipment"),r=["fan","board","top","bottom","bowl","stones"],a={fan:"",board:"",top:"",bottom:"",bowl:"",stones:""},i=[{id:"",name:""},{id:"",name:""},{id:"",name:""},{id:"",name:""}],o={normal:{name:"",color:"text-gray-300"},uncommon:{name:"",color:"text-green-400"},rare:{name:"",color:"text-blue-400"},epic:{name:"",color:"text-purple-400"},legendary:{name:"",color:"text-red-500"},mythic:{name:"",color:"text-orange-400"}},[c,d]=f.useState("fan"),[u,p]=f.useState(null),[m,h]=f.useState(""),y=f.useMemo(()=>{if(s==="equipment")return vc.filter(x=>x.slot===c).sort((x,j)=>Tr[x.grade]-Tr[j.grade]);if(s==="material")return Object.values(en).sort((x,j)=>Tr[x.grade]-Tr[j.grade]);if(s==="consumable"){const j={:" ",:" ",:" ",:" "}[m];return[...js].filter(S=>S.name.includes(j)).sort((S,C)=>S.name.localeCompare(C.name))}return[]},[s,c,m]);f.useEffect(()=>{y.length>0?(!u||!y.some(x=>x.name===u.name))&&p(y[0]):u&&p(null)},[y,u]);const b=()=>{var I;if(!u||u.type!=="equipment"||!u.slot)return null;const x=u0[u.grade],j=R=>R[0]===R[1]?`${R[0]}`:`${R[0]}~${R[1]}`,w=x.mythicCount[0]>0,S=((I=m0[u.slot])==null?void 0:I[x.combatTier])||[],C=d0[u.slot],k=C.options[u.grade],M=k.value,_=C.isPercentage,E=k.stats.join("  ");return t.jsxs(t.Fragment,{children:[t.jsx("h5",{className:"text-sm md:text-base font-semibold text-yellow-300 mt-3 border-b border-gray-600 pb-1",children:""}),t.jsxs("p",{className:"text-xs md:text-sm text-gray-300 py-1",children:[t.jsx("strong",{className:"text-yellow-400",children:E}),": +",M,_?"%":""]}),t.jsxs("h5",{className:"text-sm md:text-base font-semibold text-blue-300 mt-3 border-b border-gray-600 pb-1",children:[" ( ",j(x.combatCount),")"]}),t.jsx("ul",{className:"space-y-1 text-[10px] md:text-xs text-gray-300 pt-1",children:S.map((R,A)=>t.jsxs("li",{children:[t.jsx("strong",{className:"text-blue-400",children:R.type}),": +",R.range[0],"~",R.range[1],R.isPercentage?"%":""]},`${R.type}-${A}`))}),t.jsxs("h5",{className:"text-sm md:text-base font-semibold text-green-300 mt-3 border-b border-gray-600 pb-1",children:["  ( ",j(x.specialCount),")"]}),t.jsx("ul",{className:"space-y-1 text-[10px] md:text-xs text-gray-300 pt-1",children:Object.entries(ox).map(([R,A])=>t.jsxs("li",{children:[t.jsx("strong",{className:"text-green-400",children:A.name}),": +",A.range[0],"~",A.range[1],A.isPercentage?"%":""]},R))}),w&&t.jsxs(t.Fragment,{children:[t.jsxs("h5",{className:"text-sm md:text-base font-semibold text-red-400 mt-3 border-b border-gray-600 pb-1",children:["  ( ",j(x.mythicCount),")"]}),t.jsx("ul",{className:"space-y-1 text-[10px] md:text-xs text-gray-300 pt-1",children:Object.values(it).map(R=>{const A=cx[R];return t.jsxs("li",{children:[t.jsx("strong",{className:"text-red-400",children:A.name}),": ",A.description]},R)})})]})]})},v=()=>t.jsxs("div",{className:"text-left text-gray-300 space-y-6 overflow-y-auto pr-2 h-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-center text-yellow-300",children:"    "}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-green-400 border-b-2 border-green-400/50 pb-1 mb-2",children:" "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1",children:[t.jsx("li",{children:"     . (+4, +7, +10   2 )"}),t.jsx("li",{children:"      ."})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-blue-400 border-b-2 border-blue-400/50 pb-1 mb-2",children:" "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-2",children:[t.jsx("li",{children:"     , ,      ."}),t.jsxs("li",{children:[t.jsx("strong",{className:"text-yellow-400",children:" :"}),"             .       ."]}),t.jsxs("li",{children:[t.jsx("strong",{className:"text-yellow-400",children:"/ :"}),"       ."]}),t.jsxs("li",{children:[t.jsx("strong",{className:"text-yellow-400",children:" :"}),"         ."]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-purple-400 border-b-2 border-purple-400/50 pb-1 mb-2",children:"  "}),t.jsxs("div",{className:"space-y-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-yellow-300",children:""}),t.jsx("p",{className:"text-xs text-gray-400 pl-4",children:"1     .    (+4),  (+7),  (+10)    2 ."})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-blue-300",children:""}),t.jsx("p",{className:"text-xs text-gray-400 pl-4",children:" 4 . 1  4     , 4        ."})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-green-300",children:"  &  "}),t.jsx("p",{className:"text-xs text-gray-400 pl-4",children:"    .      ."})]})]})]})]});return t.jsxs(be,{title:"",onClose:e,windowId:"encyclopedia",initialWidth:900,isTopmost:n,children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>l("equipment"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="equipment"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>l("material"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="material"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>l("consumable"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="consumable"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>l("help"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="help"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),s==="help"?t.jsx("div",{className:"h-[calc(var(--vh,1vh)*65)] bg-gray-900/50 rounded-lg p-4",children:v()}):t.jsxs("div",{className:"flex gap-4 h-[calc(var(--vh,1vh)*65)] flex-row",children:[t.jsxs("div",{className:"flex flex-col gap-4 w-1/2 h-full",children:[s==="consumable"&&t.jsxs("div",{className:"w-full bg-gray-900/50 rounded-lg p-2 flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold mb-2 hidden md:block",children:""}),t.jsx("div",{className:"flex flex-row md:flex-col gap-2 overflow-x-auto md:overflow-y-auto md:overflow-x-hidden pb-1 md:pb-0 scrollbar-thin",children:i.map(x=>t.jsx("button",{onClick:()=>h(x.id),className:`flex-shrink-0 whitespace-nowrap text-center rounded-md transition-colors px-3 py-1.5 text-xs md:text-left md:w-full md:px-4 md:py-2 md:text-sm ${m===x.id?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:x.name},x.id))})]}),s==="equipment"&&t.jsxs("div",{className:"w-full bg-gray-900/50 rounded-lg p-2 flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold mb-2 hidden md:block",children:""}),t.jsx("div",{className:"flex flex-row md:flex-col gap-2 overflow-x-auto md:overflow-y-auto md:overflow-x-hidden pb-1 md:pb-0 scrollbar-thin",children:r.map(x=>t.jsx("button",{onClick:()=>d(x),className:`flex-shrink-0 whitespace-nowrap text-center rounded-md transition-colors px-3 py-1.5 text-xs md:text-left md:w-full md:px-4 md:py-2 md:text-sm ${c===x?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:a[x]},x))})]}),t.jsxs("div",{className:"w-full bg-gray-900/50 rounded-lg p-2 flex flex-col min-h-0 flex-grow",children:[t.jsx("h3",{className:"text-lg font-bold mb-2 flex-shrink-0",children:" "}),t.jsx("div",{className:"flex flex-col space-y-1 overflow-y-auto pr-2 flex-grow",children:y.map(x=>t.jsxs("button",{onClick:()=>p(x),className:`w-full text-left p-2 rounded-md text-sm flex items-center gap-2 ${(u==null?void 0:u.name)===x.name?"bg-blue-800/80":"hover:bg-gray-700/50"}`,children:[t.jsxs("div",{className:"relative w-8 h-8 flex-shrink-0",children:[t.jsx("img",{src:Gu[x.grade],alt:x.grade,className:"absolute inset-0 w-full h-full object-cover rounded-sm"}),x.image&&t.jsx("img",{src:x.image,alt:x.name,className:"relative w-full h-full object-contain p-0.5"})]}),t.jsx("span",{className:`${o[x.grade].color} truncate`,children:x.name})]},x.name))})]})]}),t.jsx("div",{className:"bg-gray-900/50 rounded-lg flex flex-col items-center min-h-0 w-1/2 h-full p-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:`relative flex-shrink-0 ${s==="equipment"?"w-20 h-20 md:w-40 md:h-40":"w-24 h-24 md:w-40 md:h-40"}`,children:[t.jsx("img",{src:Gu[u.grade],alt:u.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),u.image&&t.jsx("img",{src:u.image,alt:u.name,className:"relative w-full h-full object-contain p-[15%]"})]}),t.jsx("h3",{className:`font-bold mt-2 md:mt-4 ${o[u.grade].color} text-center ${s==="equipment"?"text-lg md:text-2xl":"text-xl md:text-2xl"}`,children:u.name}),t.jsx("p",{className:"text-xs md:text-sm text-gray-400 text-center",children:u.type==="equipment"?`[${o[u.grade].name}] ${u.slot?a[u.slot]:""}`:s==="material"?"":""}),u.type==="equipment"&&t.jsx("p",{className:"text-[10px] md:text-xs text-gray-400 mt-1",children:`  : ${En[u.grade]}`}),t.jsxs("div",{className:"w-full flex-grow overflow-y-auto mt-2 pt-2 border-t border-gray-700 min-h-0 pr-2",children:[u.type==="equipment"&&b(),u.type!=="equipment"&&t.jsx("p",{className:"text-xs md:text-sm text-gray-300 py-1 text-center",children:u.description})]})]}):t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:t.jsx("p",{children:" ."})})})]})]})},Iv=({info:e,onClose:n,isTopmost:s})=>{const{user:l,mode:r}=e,a=l.seasonHistory||{},i=Object.keys(a).sort((o,c)=>c.localeCompare(o));return t.jsx(be,{title:"  ",onClose:n,windowId:"past-rankings",initialWidth:450,isTopmost:s,children:t.jsxs("div",{className:"max-h-[calc(var(--vh,1vh)*60)] overflow-y-auto pr-2",children:[t.jsx("h3",{className:"text-lg font-bold text-center mb-4",children:r}),i.length>0?t.jsx("ul",{className:"space-y-2",children:i.map(o=>{var u;const c=(u=a[o])==null?void 0:u[r],d=At.find(p=>p.name===c);return t.jsxs("li",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg",children:[t.jsx("span",{className:"font-semibold text-gray-300",children:o}),c&&d?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:d.icon,alt:c,className:"w-8 h-8"}),t.jsx("span",{className:`font-bold ${d.color}`,children:c})]}):t.jsx("span",{className:"text-gray-500",children:" "})]},o)})}):t.jsx("p",{className:"text-center text-gray-500",children:"    ."})]})})},Ev=({user:e,currentUser:n,onClose:s,onAction:l,isTopmost:r})=>{const a=Date.now(),i=e.chatBanUntil&&e.chatBanUntil>a,o=e.connectionBanUntil&&e.connectionBanUntil>a,c=i?Math.ceil((e.chatBanUntil-a)/1e3/60):0,d=o?Math.ceil((e.connectionBanUntil-a)/1e3/60):0,u=(v,g)=>{l({type:"ADMIN_APPLY_SANCTION",payload:{targetUserId:e.id,sanctionType:v,durationMinutes:g}})},p=v=>{l({type:"ADMIN_LIFT_SANCTION",payload:{targetUserId:e.id,sanctionType:v}})},m=f.useMemo(()=>{var v;return(v=Me.find(g=>g.id===e.avatarId))==null?void 0:v.url},[e.avatarId]),h=f.useMemo(()=>{var v;return(v=Re.find(g=>g.id===e.borderId))==null?void 0:v.url},[e.borderId]),y=[{label:"1",minutes:1},{label:"5",minutes:5},{label:"10",minutes:10},{label:"30",minutes:30},{label:"1",minutes:60}],b=[{label:"10",minutes:10},{label:"1",minutes:60},{label:"6",minutes:360},{label:"1",minutes:1440},{label:"3",minutes:4320},{label:"",minutes:999999}];return t.jsx(be,{title:` : ${e.nickname}`,onClose:s,windowId:`admin-mod-${e.id}`,isTopmost:r,children:t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4 bg-gray-900/50 p-3 rounded-lg",children:[t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:m,borderUrl:h,size:64}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold",children:e.nickname}),t.jsxs("p",{className:"text-sm text-gray-400",children:["ID: ",e.username]})]})]}),t.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg space-y-3",children:[t.jsx("h4",{className:"font-bold text-lg border-b border-gray-600 pb-2",children:" "}),i?t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-red-400",children:["  (",c," )"]}),t.jsx(z,{onClick:()=>p("chat"),colorScheme:"yellow",className:"!text-xs !py-1",children:""})]}):t.jsx("div",{className:"grid grid-cols-5 gap-2",children:y.map(v=>t.jsx(z,{onClick:()=>u("chat",v.minutes),className:"!text-xs",children:v.label},v.minutes))})]}),t.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg space-y-3",children:[t.jsx("h4",{className:"font-bold text-lg border-b border-gray-600 pb-2",children:" "}),o?t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-red-400",children:["  (",d," )"]}),t.jsx(z,{onClick:()=>p("connection"),colorScheme:"yellow",className:"!text-xs !py-1",children:""})]}):t.jsx("div",{className:"grid grid-cols-3 gap-2",children:b.map(v=>t.jsx(z,{onClick:()=>u("connection",v.minutes),colorScheme:"orange",className:"!text-xs",children:v.label},v.minutes))})]})]})})},Pv=({summary:e,onClose:n,isTopmost:s})=>{var i,o;const{reward:l,items:r,title:a}=e;return t.jsx(be,{title:a,onClose:n,windowId:"quest-reward-summary",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:" !"}),t.jsxs("div",{className:"space-y-3 bg-gray-900/50 p-4 rounded-lg text-lg",children:[(l.gold??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-yellow-300",children:["+",l.gold.toLocaleString()]})]}),(l.diamonds??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-cyan-300",children:["+",l.diamonds.toLocaleString()]})]}),(l.actionPoints??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold text-green-300",children:["+",l.actionPoints.toLocaleString()]})]}),((i=l.xp)==null?void 0:i.type)==="blacksmith"&&(((o=l.xp)==null?void 0:o.amount)??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/equipments/moru.png",alt:" ",className:"w-5 h-5"}),"  :"]}),t.jsxs("span",{className:"font-bold text-orange-400",children:["+",l.xp.amount.toLocaleString()]})]})]}),r.length>0&&t.jsxs("div",{className:"mt-4 bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"font-semibold mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-4 gap-2",children:r.map((c,d)=>t.jsxs("div",{className:"flex flex-col items-center",title:c.name,children:[t.jsx("img",{src:c.image,alt:c.name,className:"w-12 h-12 object-contain"}),t.jsxs("span",{className:"text-xs",children:[c.name,c.quantity&&c.quantity>1?` x${c.quantity}`:""]})]},d))})]}),t.jsx(z,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},Mv={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},Tv=["/images/equipments/Star1.png","/images/equipments/Star2.png","/images/equipments/Star3.png","/images/equipments/Star4.png"],_v=["/images/icon/Gold.png","/images/icon/Zem.png","/images/quest.png","/images/gibo.png","/images/mail.png","/images/store.png","/images/bag.png","/images/BlankEquipmentsSlot.png"],Rx=new Set,Tt=e=>{for(const n of e)n&&typeof n=="string"&&n.startsWith("/")&&Rx.add(n)};Tt(Object.values(La));Tt([Ml.neighborhood.image,Ml.national.image,Ml.world.image]);Tt(Ye.map(e=>e.image));Tt(rt.map(e=>e.image));Tt(tl.map(e=>e.icon));Tt(Me.map(e=>e.url));Tt(Re.map(e=>e.url));Tt(At.map(e=>e.icon));Tt(vc.map(e=>e.image));Tt(js.map(e=>e.image));Tt(Object.values(en).map(e=>e.image));Tt([Oa,Da,Nc,Sc,yx,bx,vx,jx,wx]);Tt(Object.values(Mv));Tt(Tv);Tt(_v);const Av=Array.from(Rx),Rv=e=>{const n=e.map(s=>new Promise(l=>{const r=new Image;r.src=s,r.onload=l,r.onerror=a=>l(`Failed to load ${s}: ${a.toString()}`)}));return Promise.all(n)},Bv=({result:e,onClose:n,isTopmost:s})=>{const{gained:l,used:r,craftType:a}=e,i=a==="upgrade"?" ":" ",o=l[0],c=r[0],d=en[o.name],u=en[c.name];return t.jsx(be,{title:i,onClose:n,windowId:"crafting-result",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"   ."}),t.jsxs("div",{className:"flex items-center justify-around text-center mb-4 bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[(u==null?void 0:u.image)&&t.jsx("img",{src:u.image,alt:c.name,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:c.name}),t.jsxs("span",{className:"text-sm text-red-400 mt-1",children:["-",c.amount.toLocaleString(),""]})]}),t.jsx("div",{className:"text-4xl font-bold text-yellow-400 mx-4",children:""}),t.jsxs("div",{className:"flex flex-col items-center",children:[(d==null?void 0:d.image)&&t.jsx("img",{src:d.image,alt:o.name,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:o.name}),t.jsxs("span",{className:"text-sm text-green-400 mt-1",children:["+",o.amount.toLocaleString(),""]})]})]}),t.jsx(z,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},Lv=({value:e,min:n,max:s,step:l=1,onChange:r,disabled:a=!1})=>t.jsx("input",{type:"range",min:n,max:s,step:l,value:e,onChange:i=>r(Number(i.target.value)),disabled:a,className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer disabled:opacity-50"}),$v=[{id:"black",name:"",colors:["#0f172a","#1e293b","#e2e8f0","#eab308"]},{id:"white",name:"",colors:["#f8fafc","#f1f5f9","#0f172a","#ca8a04"]},{id:"sky",name:"",colors:["#f0f9ff","#e0f2fe","#1e3a8a","#f97316"]},{id:"blue",name:" ",colors:["#eff6ff","#dbeafe","#1e40af","#3b82f6"]},{id:"green",name:" ",colors:["#f0fdf4","#dcfce7","#14532d","#d946ef"]}],Ov=({onClose:e,isTopmost:n})=>{const{settings:s,updateTheme:l,updateSoundSetting:r,updateFeatureSetting:a,updatePanelColor:i,updateTextColor:o,resetGraphicsToDefault:c}=De(),[d,u]=f.useState("graphics"),p=[{id:"graphics",label:""},{id:"sound",label:""},{id:"features",label:""}],m=[{key:"stone",label:"// "},{key:"notification",label:"/ "},{key:"item",label:"  "},{key:"countdown",label:"/ "},{key:"turn",label:"   "}],h=()=>{switch(d){case"graphics":return t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary",children:"UI "}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2",children:$v.map(y=>t.jsxs("label",{className:"flex items-center p-3 bg-tertiary/50 rounded-lg cursor-pointer border-2 border-transparent has-[:checked]:border-accent has-[:checked]:ring-2 has-[:checked]:ring-accent",children:[t.jsx("input",{type:"radio",name:"theme",value:y.id,checked:s.graphics.theme===y.id,onChange:()=>l(y.id),className:"w-5 h-5 text-accent bg-secondary border-color focus:ring-accent"}),t.jsx("span",{className:"ml-3 text-text-primary",children:y.name}),t.jsx("div",{className:"ml-auto flex -space-x-2",children:y.colors.map((b,v)=>t.jsx("div",{style:{backgroundColor:b},className:"w-6 h-6 rounded-full border-2 border-primary"},v))})]},y.id))})]})});case"sound":return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-2",children:" "}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"w-12 text-center font-mono text-text-primary text-lg",children:(s.sound.masterVolume*10).toFixed(0)}),t.jsx(Lv,{min:0,max:1,step:.1,value:s.sound.masterVolume,onChange:y=>r("masterVolume",y),disabled:s.sound.masterMuted})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary",children:" "}),t.jsx(Ln,{checked:!s.sound.masterMuted,onChange:y=>r("masterMuted",!y)})]}),t.jsxs("div",{className:"space-y-3 pt-4 border-t border-color",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-2",children:"  "}),m.map(({key:y,label:b})=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:b}),t.jsx(Ln,{checked:!s.sound.categoryMuted[y],onChange:v=>r("categoryMuted",{...s.sound.categoryMuted,[y]:!v}),disabled:s.sound.masterMuted})]},y))]})]});case"features":return t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-4",children:" "}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"   []  "}),t.jsx(Ln,{checked:s.features.mobileConfirm,onChange:y=>a("mobileConfirm",y)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"  ( )"}),t.jsx(Ln,{checked:s.features.stonePreview,onChange:y=>a("stonePreview",y)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"   "}),t.jsx(Ln,{checked:s.features.lastMoveMarker,onChange:y=>a("lastMoveMarker",y)})]}),t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-4 pt-4 border-t border-color",children:""}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"  "}),t.jsx(Ln,{checked:s.features.questNotifications,onChange:y=>a("questNotifications",y)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"   ( )"}),t.jsx(Ln,{checked:s.features.chatNotifications,onChange:y=>a("chatNotifications",y)})]})]})}};return t.jsx(be,{title:"",onClose:e,windowId:"settings",initialWidth:600,isTopmost:n,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*60)] flex flex-col",children:[t.jsx("div",{className:"flex bg-tertiary/70 p-1 rounded-lg mb-4 flex-shrink-0",children:p.map(y=>t.jsx("button",{onClick:()=>u(y.id),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${d===y.id?"bg-accent":"text-tertiary hover:bg-secondary/50"}`,children:y.label},y.id))}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 p-2",children:h()}),t.jsx("div",{className:"flex justify-end gap-4 mt-4 pt-4 border-t border-color flex-shrink-0",children:t.jsx(z,{onClick:e,colorScheme:"gray",children:""})})]})})},Wu=({summary:e,onClose:n,isTopmost:s})=>t.jsx(be,{title:"  ",onClose:n,windowId:"claim-all-summary",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"   !"}),t.jsxs("div",{className:"space-y-3 bg-gray-900/50 p-4 rounded-lg text-lg",children:[e.gold>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-yellow-300",children:["+",e.gold.toLocaleString()]})]}),e.diamonds>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-cyan-300",children:["+",e.diamonds.toLocaleString()]})]}),e.actionPoints>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold text-green-300",children:["+",e.actionPoints.toLocaleString()]})]})]}),t.jsx(z,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})}),Dv={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},qv=e=>{if(e===0)return null;let n="",s="";return e>=10?(n="/images/equipments/Star4.png",s="prism-text-effect"):e>=7?(n="/images/equipments/Star3.png",s="text-purple-400"):e>=4?(n="/images/equipments/Star2.png",s="text-amber-400"):e>=1&&(n="/images/equipments/Star1.png",s="text-white"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:`font-bold text-xs leading-none ${s}`,children:e})]})},Uv=({item:e})=>{var i,o,c,d;const{currentUserWithStatus:n}=De(),s=Dv[e.grade],l=En[e.grade],a=((n==null?void 0:n.strategyLevel)||0)+((n==null?void 0:n.playfulLevel)||0)>=l;return t.jsxs("div",{className:"flex flex-col w-full h-full p-1",children:[t.jsxs("div",{className:"flex mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0 mr-3",children:[t.jsx("img",{src:s.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),qv(e.stars)]}),t.jsxs("div",{className:"flex-grow overflow-hidden pt-2",children:[t.jsx("h3",{className:`text-lg font-bold truncate ${s.color}`,children:e.name}),t.jsxs("p",{className:`text-xs ${a?"text-gray-500":"text-red-500"}`,children:["(: ",l,")"]}),((i=e.options)==null?void 0:i.main)&&t.jsx("p",{className:"font-semibold text-yellow-300 text-sm truncate",children:e.options.main.display})]})]}),t.jsxs("div",{className:"w-full text-sm text-left space-y-1 bg-black/30 p-2 rounded-lg flex-grow overflow-y-auto",children:[((o=e.options)==null?void 0:o.combatSubs)&&e.options.combatSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.combatSubs.map((u,p)=>t.jsx("p",{className:"text-blue-300",children:u.display},`c-${p}`))}),((c=e.options)==null?void 0:c.specialSubs)&&e.options.specialSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.specialSubs.map((u,p)=>t.jsx("p",{className:"text-green-300",children:u.display},`s-${p}`))}),((d=e.options)==null?void 0:d.mythicSubs)&&e.options.mythicSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.mythicSubs.map((u,p)=>t.jsx("p",{className:"text-red-400",children:u.display},`m-${p}`))})]})]})},ba=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-purple-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},zv=({outcome:e,onConfirm:n})=>{if(!e)return null;const{success:s,message:l,itemBefore:r,itemAfter:a}=e,i=f.useMemo(()=>{if(!s||!r.options||!a.options)return null;if(a.options.combatSubs.length>r.options.combatSubs.length){const d=a.options.combatSubs.find(u=>!r.options.combatSubs.some(p=>p.type===u.type&&p.isPercentage===u.isPercentage));return d?{type:"new",option:d}:null}for(const d of a.options.combatSubs){const u=r.options.combatSubs.find(p=>p.type===d.type&&p.isPercentage===d.isPercentage);if(!u||u.value!==d.value)return{type:"upgraded",before:u,after:d}}return null},[s,r,a]),o=ba(r.stars),c=ba(a.stars);return t.jsxs("div",{className:"absolute inset-0 bg-gray-900/80 rounded-lg flex flex-col items-center justify-center z-20 animate-fade-in p-4",children:[t.jsx("div",{className:`text-6xl mb-4 ${s?"animate-bounce":""}`,children:s?"":""}),t.jsx("h2",{className:`text-3xl font-bold ${s?"text-green-400":"text-red-400"}`,children:s?" !":" ..."}),t.jsx("p",{className:"text-gray-300 mt-2 text-center",children:l}),s&&t.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg mt-4 w-full max-w-sm text-xs space-y-1",children:[t.jsx("h4",{className:"font-bold text-center text-yellow-300 mb-2",children:" "}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"}),t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("span",{className:o.colorClass,children:o.text||"()"}),"",t.jsx("span",{className:c.colorClass,children:c.text})]})]}),r.options&&a.options&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsxs("span",{className:"truncate",children:[r.options.main.display,"  ",a.options.main.display]})]}),(i==null?void 0:i.type)==="new"&&i.option&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{className:"truncate",children:i.option.display})]}),(i==null?void 0:i.type)==="upgraded"&&i.before&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"truncate",children:[i.before.display,"  ",i.after.display]})]})]}),t.jsx(z,{onClick:n,colorScheme:"green",className:"mt-6 w-full max-w-sm",children:""})]})},Fv=({selectedItem:e,currentUser:n,onAction:s,enhancementOutcome:l,onOutcomeConfirm:r})=>{const[a,i]=f.useState(!1),o=f.useMemo(()=>{var C;return e?(C=ha[e.grade])==null?void 0:C[e.stars]:null},[e]),c=n?n.strategyLevel+n.playfulLevel:0,d=f.useMemo(()=>{if(!e)return 0;const C=e.stars+1;return C===4?3:C===7?8:C===10?15:0},[e]),u=c>=d,p=f.useMemo(()=>{if(!n)return{};const C={};for(const k of Object.keys(en))C[k]=n.inventory.filter(M=>M.name===k).reduce((M,_)=>M+(_.quantity||0),0);return C},[n]),m=f.useMemo(()=>!e||!o||d>0&&!u?!1:o.every(C=>p[C.name]>=C.amount),[o,p,d,u,e]),{mainOptionPreview:h,subOptionPreview:y}=f.useMemo(()=>{if(!e)return{mainOptionPreview:"",subOptionPreview:""};if(!e.options||e.stars>=10)return{mainOptionPreview:" ",subOptionPreview:""};const{main:C,combatSubs:k}=e.options,M=C.baseValue;if(!M)return{mainOptionPreview:"N/A",subOptionPreview:"N/A"};let _=1;[3,6,9].includes(e.stars)&&(_=2);const E=M*_,I=C.value+E,R=`${C.type} +${C.value.toFixed(2).replace(/\.00$/,"")}${C.isPercentage?"%":""}`,A=`+${I.toFixed(2).replace(/\.00$/,"")}${C.isPercentage?"%":""}`,O=`${R}  ${A}`,B=k.length<4?"   1 ":"   1 ";return{mainOptionPreview:O,subOptionPreview:B}},[e]),b=f.useMemo(()=>e?ba(e.stars):{text:"",colorClass:"text-white"},[e]),v=f.useMemo(()=>!e||e.stars>=10?null:ba(e.stars+1),[e]),g=f.useMemo(()=>e?a?" ...":e.stars>=10?" ":d>0&&!u?`  ( ${d} )`:o?m?` (+${e.stars+1})`:" ":"  ":"  .",[a,e,d,u,o,m]);if(f.useEffect(()=>{i(!1)},[e]),!e)return t.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:t.jsx("p",{children:"  ."})});const x=s0[e.stars],j=l0[e.grade]||.5,w=(e.enhancementFails||0)*j,S=()=>{!m||a||(i(!0),s({type:"ENHANCE_ITEM",payload:{itemId:e.id}}))};return t.jsxs("div",{className:"relative h-full",children:[t.jsx(zv,{outcome:l,onConfirm:r}),t.jsxs("div",{className:"flex flex-row gap-6 h-full",children:[t.jsx("div",{className:"w-1/2 flex flex-col bg-gray-900/40 p-2 rounded-lg h-full",children:t.jsx(Uv,{item:e})}),t.jsxs("div",{className:"w-1/2 space-y-3 flex flex-col",children:[t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-center mb-2 text-green-300",children:"  "}),t.jsxs("div",{className:"space-y-1 text-xs sm:text-sm text-left",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsxs("div",{className:"font-mono text-white flex items-center gap-2",children:[t.jsx("span",{className:b.colorClass,children:b.text||"(0)"}),"",v?t.jsx("span",{className:v.colorClass,children:v.text}):"-"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsx("span",{className:"font-mono text-white",children:h})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsx("span",{className:"font-mono text-white",children:e.stars<10?y:""})]})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:" "}),t.jsx("div",{className:"space-y-1 text-sm",children:o==null?void 0:o.map(C=>{const k=p[C.name]||0,M=k>=C.amount;return t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("img",{src:en[C.name].image,alt:C.name,className:"w-6 h-6"}),C.name]}),t.jsxs("span",{className:`font-mono ${M?"text-green-400":"text-red-400"}`,children:[k.toLocaleString()," / ",C.amount.toLocaleString()]})]},C.name)})})]}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg text-center flex-grow flex flex-col justify-center",children:[t.jsx("h4",{className:"font-semibold mb-1",children:"  "}),t.jsxs("p",{className:"text-3xl font-bold text-yellow-300",children:[x,"%",w>0&&t.jsxs("span",{className:"text-xl text-green-400 ml-2",children:["(+",w.toFixed(1).replace(/\.0$/,""),"%)"]})]})]}),t.jsx(z,{onClick:S,disabled:!m||a||e.stars>=10,colorScheme:"yellow",className:"w-full py-3 mt-auto",children:g})]})]})]})},Gv={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},Hu=["fan","board","top","bottom","bowl","stones"],Bx={fan:"",board:"",top:"",bottom:"",bowl:"",stones:""},Wv=({item:e,onRemove:n})=>{if(!e)return t.jsx("div",{className:"w-1/3 h-32 border-2 border-dashed border-gray-500 rounded-lg flex items-center justify-center bg-black/20",children:t.jsx("span",{className:"text-gray-400",children:""})});const s=Gv[e.grade];return t.jsxs("div",{className:"w-1/3 h-32 rounded-lg bg-black/20 p-2 flex flex-col items-center justify-center text-center relative",children:[t.jsx("button",{onClick:n,className:"absolute top-1 right-1 text-red-500 hover:text-red-400 z-10",children:""}),t.jsxs("div",{className:"relative w-16 h-16 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:s.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"})]}),t.jsx("p",{className:`text-sm font-bold ${s.color} truncate w-full`,children:e.name}),t.jsx("p",{className:"text-xs text-gray-400",children:Bx[e.slot]||""})]})},Hv=({items:e,isRandom:n})=>{const s=f.useMemo(()=>{const l=e.filter(a=>a!==null);if(l.length!==3)return[];const r=new Map;if(n){const a=1/Hu.length;for(const i of Hu)r.set(i,a)}else{const a=new Map;for(const i of l)i.slot&&a.set(i.slot,(a.get(i.slot)||0)+1);for(const[i,o]of a.entries())r.set(i,o/3)}return Array.from(r.entries()).sort((a,i)=>i[1]-a[1])},[e,n]);return s.length===0?null:t.jsxs("div",{className:"w-full bg-black/20 p-3 rounded-lg mt-4",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:"  "}),t.jsx("div",{className:"grid grid-cols-3 gap-x-4 gap-y-1 text-sm",children:s.map(([l,r])=>t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-gray-400",children:[Bx[l],":"]}),t.jsxs("span",{className:"font-bold text-white",children:[(r*100).toFixed(1),"%"]})]},l))})]})},Vv=({items:e,currentUser:n})=>{const{blacksmithLevel:s}=n,l=f.useMemo(()=>{var d;const r=e.filter(u=>u!==null);if(r.length!==3||new Set(r.map(u=>u.grade)).size!==1)return null;const a=r[0].grade,i=(s??1)-1,o=((d=Kl[i])==null?void 0:d[a])??0;return{successRate:100-o,greatSuccessRate:o}},[e,s]);return l?t.jsxs("div",{className:"w-full bg-black/20 p-3 rounded-lg mt-2",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:"  "}),t.jsxs("div",{className:"grid grid-cols-2 gap-x-4 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsxs("span",{className:"font-bold text-white",children:[l.successRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-yellow-400",children:":"}),t.jsxs("span",{className:"font-bold text-yellow-300",children:[l.greatSuccessRate.toFixed(1),"%"]})]})]})]}):null},Kv=({items:e,onRemoveItem:n,onAction:s,currentUser:l})=>{const[r,a]=f.useState(!1),i=()=>{const c=e.map(d=>d==null?void 0:d.id).filter(d=>!!d);c.length===3&&s({type:"COMBINE_ITEMS",payload:{itemIds:c,isRandom:r}})},o=e.every(c=>c!==null)&&new Set(e.map(c=>c==null?void 0:c.grade)).size===1;return t.jsxs("div",{className:"h-full flex flex-col items-center justify-between",children:[t.jsx("div",{className:"w-full flex justify-around items-stretch gap-2",children:e.map((c,d)=>t.jsx(Wv,{item:c,onRemove:()=>n(d)},d))}),t.jsxs("div",{className:"w-full",children:[t.jsx(Hv,{items:e,isRandom:r}),t.jsx(Vv,{items:e,currentUser:l})]}),t.jsxs("div",{className:"w-full space-y-4 mt-4",children:[t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("input",{type:"checkbox",id:"random-combine",checked:r,onChange:c=>a(c.target.checked),className:"h-4 w-4 rounded text-accent bg-gray-700 border-gray-600 focus:ring-accent"}),t.jsx("label",{htmlFor:"random-combine",className:"ml-2 text-sm text-gray-300",children:"   "})]}),t.jsx(z,{onClick:i,disabled:!o,colorScheme:"blue",className:"w-full",children:""})]})]})},Jv=e=>{if(e.type==="equipment"){const n=r0[e.grade]||0,s=Math.pow(1.2,e.stars);return Math.floor(n*s)}return 0},Qv=({selectedIds:e,inventory:n})=>{const{totalMaterials:s,totalSellPrice:l,itemCount:r}=f.useMemo(()=>{var c;const a=n.filter(d=>e.has(d.id)),i={};let o=0;for(const d of a){o+=Jv(d);const u=Math.min(d.stars,9),p=(c=ha[d.grade])==null?void 0:c[u];if(p)for(const m of p){const h=Math.floor(m.amount*.25);h>0&&(i[m.name]=(i[m.name]||0)+h)}}return{totalMaterials:Object.entries(i).map(([d,u])=>({name:d,amount:u})),totalSellPrice:o,itemCount:a.length}},[e,n]);return t.jsxs("div",{className:"w-full h-full bg-secondary/50 rounded-lg p-4 flex flex-col text-center",children:[t.jsx("h3",{className:"font-bold text-lg text-tertiary mb-2",children:" "}),t.jsxs("p",{className:"text-sm text-tertiary mb-4",children:[" : ",r,""]}),t.jsxs("div",{className:"flex-grow w-full bg-tertiary/30 p-3 rounded-md overflow-y-auto space-y-2",children:[t.jsx("h4",{className:"font-semibold text-highlight text-left border-b border-color pb-1",children:"  "}),s.length>0?s.map(({name:a,amount:i})=>{const o=en[a];return t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[(o==null?void 0:o.image)&&t.jsx("img",{src:o.image,alt:a,className:"w-6 h-6"}),a]}),t.jsxs("span",{className:"font-mono text-primary",children:["x ",i.toLocaleString()]})]},a)}):t.jsx("p",{className:"text-sm text-tertiary pt-4",children:"  ."}),t.jsx("p",{className:"text-xs text-cyan-300 text-center pt-4",children:"  30%  ''     2 !"})]}),t.jsx("div",{className:"mt-4 text-sm text-tertiary",children:t.jsxs("p",{children:["   : ",t.jsxs("span",{className:"font-bold text-yellow-300",children:[l.toLocaleString()," "]})]})})]})},Yv=["normal","uncommon","rare","epic","legendary"],Xv={normal:"",uncommon:"",rare:"",epic:"",legendary:"",mythic:""},Zv=({onClose:e,onConfirm:n})=>{const[s,l]=f.useState([]),r=i=>{l(o=>o.includes(i)?o.filter(c=>c!==i):[...o,i])},a=()=>{n(s),e()};return t.jsx(be,{title:"  ",onClose:e,windowId:"disassembly-auto-select",initialWidth:400,isTopmost:!0,children:t.jsxs("div",{className:"text-on-panel",children:[t.jsx("p",{className:"text-sm text-tertiary mb-4 text-center",children:"   .   ."}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:Yv.map(i=>t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-tertiary/50 rounded-lg cursor-pointer border-2 border-transparent has-[:checked]:border-accent",children:[t.jsx("input",{type:"checkbox",checked:s.includes(i),onChange:()=>r(i),className:"w-5 h-5 text-accent bg-secondary border-color rounded focus:ring-accent"}),t.jsx("span",{className:"font-semibold",children:Xv[i]})]},i))}),t.jsxs("div",{className:"flex justify-end gap-4 mt-6 pt-4 border-t border-color",children:[t.jsx(z,{onClick:e,colorScheme:"gray",children:""}),t.jsx(z,{onClick:a,colorScheme:"blue",children:" "})]})]})})},ej=({onAction:e,selectedForDisassembly:n=new Set,onToggleDisassemblySelection:s})=>{const{currentUserWithStatus:l}=De(),[r,a]=f.useState(!1);if(!l)return null;const{inventory:i}=l,o=()=>{n.size===0||Array.from(n).some(u=>{const p=i.find(m=>m.id===u);return p&&(p.grade==="legendary"||p.grade==="mythic")})&&!window.confirm("    .  ?")||window.confirm(`${n.size}  ?`)&&e({type:"DISASSEMBLE_ITEM",payload:{itemIds:Array.from(n)}})},c=d=>{i.filter(p=>p.type==="equipment"&&!p.isEquipped&&d.includes(p.grade)).map(p=>p.id).forEach(p=>s(p)),a(!1)};return t.jsxs("div",{className:"h-full flex flex-col",children:[r&&t.jsx(Zv,{onClose:()=>a(!1),onConfirm:c}),t.jsx("div",{className:"flex-grow",children:t.jsx(Qv,{selectedIds:n,inventory:i})}),t.jsxs("div",{className:"flex-shrink-0 border-t border-color py-3 px-2 my-2 flex flex-wrap justify-center items-center gap-2",children:[t.jsx(z,{onClick:()=>a(!0),colorScheme:"blue",children:" "}),t.jsxs(z,{onClick:o,colorScheme:"red",disabled:n.size===0,children:["   (",n.size,")"]})]})]})},tj=({details:e,inventory:n,onClose:s,onAction:l})=>{const{materialName:r,craftType:a}=e,i=a==="upgrade",o=[" "," "," "," "," "],c=o.indexOf(r),d=r,u=i?o[c+1]:o[c-1],p=en[d],m=en[u],h=i?10:1,y=i?1:5,b=f.useMemo(()=>n.filter(S=>S.name===d).reduce((S,C)=>S+(C.quantity||0),0),[n,d]),v=Math.floor(b/h),[g,x]=f.useState(v>0?1:0),j=S=>{const C=parseInt(S.target.value,10);isNaN(C)?x(0):x(Math.max(0,Math.min(v,C)))},w=()=>{g>0&&l({type:"CRAFT_MATERIAL",payload:{materialName:r,craftType:a,quantity:g}}),s()};return t.jsx("div",{className:"absolute inset-0 bg-black/80 z-50 flex items-center justify-center",onClick:s,children:t.jsxs("div",{className:"bg-panel rounded-lg shadow-xl p-6 w-full max-w-md border border-color text-on-panel",onClick:S=>S.stopPropagation(),children:[t.jsx("h2",{className:"text-xl font-bold text-center mb-4",children:i?" ":" "}),t.jsxs("div",{className:"flex items-center justify-around text-center mb-4",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("img",{src:p.image,alt:d,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:d}),t.jsxs("span",{className:"text-xs text-tertiary mt-1",children:[": ",b.toLocaleString(),""]})]}),t.jsx("div",{className:"text-4xl font-bold text-highlight mx-4",children:""}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("img",{src:m.image,alt:u,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:u}),t.jsxs("span",{className:"text-sm text-green-400 mt-1",children:[": ",(g*y).toLocaleString(),""]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"quantity-slider",className:"block text-sm font-medium text-secondary text-center",children:[i?"":""," ",d,": ",t.jsxs("span",{className:"font-bold text-highlight",children:[(g*h).toLocaleString()," / ",b.toLocaleString()]}),""]}),t.jsx("input",{id:"quantity-slider",type:"range",min:"0",max:v,value:g,onChange:j,disabled:v===0,className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer"}),t.jsxs("div",{className:"flex justify-between text-xs text-tertiary",children:[t.jsx("span",{children:"0"}),t.jsxs("span",{children:[v,""]})]}),t.jsxs("p",{className:"text-center text-sm text-tertiary",children:[i?"":""," : ",g.toLocaleString(),""]})]}),t.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[t.jsx(z,{onClick:s,colorScheme:"gray",children:""}),t.jsxs(z,{onClick:w,colorScheme:i?"blue":"orange",disabled:g===0,children:[g," ",i?"":""]})]})]})})},nj=({onAction:e})=>{const{currentUserWithStatus:n}=De(),[s,l]=f.useState(null);if(!n)return null;const{inventory:r}=n,a=f.useMemo(()=>{const o={};return r.filter(c=>c.type==="material").forEach(c=>{o[c.name]||(o[c.name]=[]),o[c.name].push(c)}),o},[r]),i=[" "," "," "," "," "];return t.jsxs("div",{className:"h-full flex flex-col",children:[s&&t.jsx(tj,{details:s,inventory:r,onClose:()=>l(null),onAction:e}),t.jsxs("div",{className:"flex-grow p-4 overflow-y-auto",children:[t.jsx("h3",{className:"text-xl font-bold text-on-panel mb-4",children:" "}),t.jsx("p",{className:"text-sm text-tertiary mb-4",children:"         ."}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map((o,c)=>{const d=a[o]&&a[o].length>0,u=a[o]?a[o].reduce((y,b)=>y+(b.quantity||0),0):0,p=c<i.length-1,m=c>0,h=en[o];return t.jsxs("div",{className:"bg-panel-secondary rounded-lg p-4 flex items-center space-x-4",children:[t.jsx("img",{src:h.image,alt:o,className:"w-16 h-16 flex-shrink-0"}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("h4",{className:"font-bold text-secondary text-lg",children:o}),t.jsxs("p",{className:"text-sm text-tertiary",children:[": ",u.toLocaleString(),""]})]}),t.jsxs("div",{className:"flex flex-col space-y-2",children:[p&&t.jsx(z,{onClick:()=>l({materialName:o,craftType:"upgrade"}),colorScheme:"blue",className:"!text-xs !py-1 w-20",disabled:!d||u<10,children:""}),m&&t.jsx(z,{onClick:()=>l({materialName:o,craftType:"downgrade"}),colorScheme:"purple",className:"!text-xs !py-1 w-20",disabled:!d||u<1,children:""})]})]},o)})})]})]})},sj={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},lj=e=>{if(e===0)return null;let n="",s="";return e>=10?(n="/images/equipments/Star4.png",s="prism-text-effect"):e>=7?(n="/images/equipments/Star3.png",s="text-purple-400"):e>=4?(n="/images/equipments/Star2.png",s="text-amber-400"):e>=1&&(n="/images/equipments/Star1.png",s="text-white"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:`font-bold text-xs leading-none ${s}`,children:e})]})},rj=({inventory:e,inventorySlots:n,onSelectItem:s,selectedItemId:l,disabledItemIds:r=[],selectedItemIdsForDisassembly:a,onToggleDisassemblySelection:i})=>{const o=Array.from({length:n},(c,d)=>e[d]||null);return t.jsx("div",{className:"grid grid-cols-10 gap-1 flex-grow pr-2 bg-tertiary/30 p-2 rounded-md",children:o.map((c,d)=>{const u=c?r.includes(c.id):!1;return t.jsx("div",{onClick:()=>{!c||u||(a&&i?i(c.id):s(c))},className:`relative aspect-square rounded-md transition-all duration-200 ${c?"hover:scale-105":"bg-tertiary/50"} ${u?"filter grayscale opacity-50 pointer-events-none":"cursor-pointer"}`,children:c?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`absolute inset-0 rounded-md border-2 ${l===c.id?"border-accent ring-2 ring-accent":"border-black/20"} ${a!=null&&a.has(c.id)?"bg-gray-700/70":""}`}),t.jsx("img",{src:sj[c.grade],alt:c.grade,className:"absolute inset-0 w-full h-full object-cover rounded-sm"}),c.image&&t.jsx("img",{src:c.image,alt:c.name,className:"relative w-full h-full object-contain p-1"}),lj(c.stars),c.isEquipped&&t.jsx("div",{className:"absolute top-0.5 right-0.5 text-xs font-bold text-white bg-blue-600/80 px-1 rounded-bl-md",children:"E"}),c.quantity&&c.quantity>1&&t.jsx("span",{className:"absolute bottom-0 right-0 text-xs font-bold text-white bg-black/60 px-1 rounded-tl-md",children:c.quantity}),(a==null?void 0:a.has(c.id))&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-800/70 rounded-md",children:t.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})]}):t.jsx("div",{className:"bg-tertiary/50 w-full h-full rounded-md"})},c?c.id:`empty-${d}`)})})},Ii=["normal","uncommon","rare","epic","legendary","mythic"],aj=({onClose:e,isTopmost:n,selectedItemForEnhancement:s,activeTab:l,onSetActiveTab:r,enhancementOutcome:a})=>{const{currentUserWithStatus:i,handlers:o,modals:c}=De(),[d,u]=f.useState(s),[p,m]=f.useState([null,null,null]),[h,y]=f.useState(new Set);if(!i)return null;f.useEffect(()=>{s&&(u(s),r("enhance"))},[s,r]),f.useEffect(()=>{m([null,null,null])},[l]),f.useEffect(()=>{l==="combine"&&m(L=>L.map(U=>U&&i.inventory.find(W=>W.id===U.id)||null))},[i.inventory,l]);const b=f.useCallback(L=>{if(l==="combine"){const q=p.findIndex(U=>U===null);if(q!==-1){const U=[...p];U[q]=L,m(U)}}else u(L)},[l,p]),v=f.useCallback(L=>{y(q=>{const U=new Set(q);return U.has(L)?U.delete(L):U.add(L),U})},[]),{blacksmithLevel:g,blacksmithXp:x,inventory:j,inventorySlots:w}=i,S={normal:"",uncommon:"",rare:"",epic:"",legendary:"",mythic:""},C=g??1,k=C>=wc,M=C-1,_=k?M:C,E=Pl[M],I=Ii.indexOf(E),R=f.useMemo(()=>{var U;if(l!=="combine")return[];const L=(U=p[0])==null?void 0:U.grade,q=p.map(W=>W==null?void 0:W.id).filter(Boolean);return j.filter(W=>!!(q.includes(W.id)||W.isEquipped||Ii.indexOf(W.grade)>I||L&&W.grade!==L)).map(W=>W.id)},[l,j,p,I]),A=[{id:"enhance",label:" "},{id:"combine",label:" "},{id:"disassemble",label:" "},{id:"convert",label:" "}],O=()=>{switch(l){case"enhance":return t.jsx(Fv,{selectedItem:d,currentUser:i,onAction:o.handleAction,enhancementOutcome:a,onOutcomeConfirm:o.clearEnhancementOutcome});case"combine":return t.jsx(Kv,{items:p,onRemoveItem:L=>{const q=[...p];q[L]=null,m(q)},onAction:o.handleAction,currentUser:i});case"disassemble":return t.jsx(ej,{onAction:o.handleAction,selectedForDisassembly:h,onToggleDisassemblySelection:v});case"convert":return t.jsx(nj,{onAction:o.handleAction});default:return null}},B=f.useMemo(()=>l==="enhance"||l==="combine"||l==="disassemble"?j.filter(L=>L.type==="equipment"):l==="convert"?j.filter(L=>L.type==="material"):j,[j,l]),V=(()=>{const L=w||{};return l==="enhance"||l==="combine"||l==="disassemble"?L.equipment||30:l==="convert"&&L.material||30})(),D=f.useMemo(()=>l==="enhance"||l==="combine"||l==="disassemble"?"":l==="convert"?"":"",[l]);return t.jsxs(t.Fragment,{children:[t.jsx(be,{title:"",onClose:e,isTopmost:n&&!c.isBlacksmithHelpOpen,initialWidth:950,windowId:"blacksmith",children:t.jsxs("div",{className:"flex h-[700px]",children:[t.jsxs("div",{className:"w-1/3 bg-tertiary/30 p-4 flex flex-col items-center gap-4",children:[t.jsxs("div",{className:"w-full aspect-w-3 aspect-h-2 prism-border rounded-lg overflow-hidden relative",children:[t.jsx("img",{src:"/images/equipments/moru.png",alt:"Blacksmith",className:"w-full h-full object-cover"}),t.jsx("button",{onClick:o.openBlacksmithHelp,className:"absolute top-2 right-2 text-lg font-bold text-yellow-400 hover:text-yellow-300 bg-black/50 rounded-full w-8 h-8 flex items-center justify-center",children:"?"})]}),t.jsx("div",{className:"text-center",children:t.jsxs("h2",{className:"text-2xl font-bold",children:[" ",t.jsxs("span",{className:"text-yellow-400",children:["Lv.",g??1]})]})}),t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[t.jsx("span",{children:""}),t.jsxs("span",{children:[x??0," / ",lu(g??1)]})]}),t.jsx("div",{className:"w-full bg-black/50 rounded-full h-4 border-2 border-color",children:t.jsx("div",{className:"bg-yellow-500 h-full rounded-full",style:{width:`${(x??0)/lu(g??1)*100}%`}})})]}),t.jsxs("div",{className:"w-full text-left",children:[t.jsx("h3",{className:"font-bold mb-2 text-center",children:" "}),t.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400 px-2 pb-1 border-b border-gray-600 mb-1",children:[t.jsx("span",{children:""}),t.jsxs("span",{children:["Lv.",C,!k&&t.jsxs("span",{className:"text-yellow-400",children:["  Lv.",C+1]})]})]}),t.jsxs("div",{className:"text-xs text-secondary space-y-2",children:[t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[S[Pl[M]],!k&&t.jsxs("span",{className:"text-yellow-400",children:["  ",S[Pl[_]]]})]})]})}),t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[ya[M],"%",!k&&t.jsxs("span",{className:"text-yellow-400",children:["  ",ya[_],"%"]})]})]})}),t.jsxs("div",{className:"bg-black/20 p-2 rounded-md",children:[t.jsx("p",{className:"font-semibold",children:"  :"}),Ii.map(L=>{var W,H;const q=((W=Kl[M])==null?void 0:W[L])??0,U=(H=Kl[_])==null?void 0:H[L];return t.jsxs("div",{className:"flex justify-between pl-2",children:[t.jsx("span",{children:S[L]}),t.jsxs("span",{children:[q,"%",!k&&U!==void 0&&t.jsxs("span",{className:"text-yellow-400",children:["  ",U,"%"]})]})]},L)})]})]})]})]}),t.jsxs("div",{className:"w-2/3 bg-primary p-4 flex flex-col",children:[t.jsx("div",{className:"flex border-b border-color mb-4",children:A.map(L=>t.jsx("button",{onClick:()=>r(L.id),className:`px-4 py-2 text-sm font-semibold ${l===L.id?"border-b-2 border-accent text-accent":"text-secondary hover:bg-secondary/20"}`,children:L.label},L.id))}),t.jsx("div",{className:"p-4 bg-tertiary/20 rounded-lg flex-1",children:O()}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:D}),t.jsx("div",{className:"h-[140px] overflow-y-auto pr-1",children:t.jsx(rj,{inventory:B,inventorySlots:V,onSelectItem:b,selectedItemId:(d==null?void 0:d.id)||null,disabledItemIds:R,selectedItemIdsForDisassembly:l==="disassemble"?h:void 0,onToggleDisassemblySelection:l==="disassemble"?v:void 0})})]})]})]})}),t.jsx(Ax,{isOpen:!!c.disassemblyResult,onClose:o.closeDisassemblyResult,result:c.disassemblyResult})]})},Ei={normal:"",uncommon:"",rare:"",epic:"",legendary:"",mythic:""},ij=["normal","uncommon","rare","epic","legendary","mythic"],oj=({onClose:e,currentUser:n})=>{const{blacksmithLevel:s}=n,l=s??1,r=l>=wc,a=l-1,i=r?a:l,o=()=>t.jsxs("div",{className:"w-full text-left",children:[t.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400 px-2 pb-1 border-b border-gray-600 mb-1",children:[t.jsx("span",{children:""}),t.jsxs("span",{children:["Lv.",l,!r&&t.jsxs("span",{className:"text-yellow-400",children:["  Lv.",l+1]})]})]}),t.jsxs("div",{className:"text-xs text-secondary space-y-2",children:[t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[Ei[Pl[a]],!r&&t.jsxs("span",{className:"text-yellow-400",children:["  ",Ei[Pl[i]]]})]})]})}),t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[ya[a],"%",!r&&t.jsxs("span",{className:"text-yellow-400",children:["  ",ya[i],"%"]})]})]})}),t.jsxs("div",{className:"bg-black/20 p-2 rounded-md",children:[t.jsx("p",{className:"font-semibold",children:"  :"}),ij.map(c=>{var p,m;const d=((p=Kl[a])==null?void 0:p[c])??0,u=(m=Kl[i])==null?void 0:m[c];return t.jsxs("div",{className:"flex justify-between pl-2",children:[t.jsx("span",{children:Ei[c]}),t.jsxs("span",{children:[d,"%",!r&&u!==void 0&&t.jsxs("span",{className:"text-yellow-400",children:["  ",u,"%"]})]})]},c)})]})]})]});return t.jsx(be,{title:" ",onClose:e,windowId:"blacksmith-help",initialWidth:500,zIndex:60,children:t.jsxs("div",{className:"space-y-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-accent mb-2",children:" "}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:[t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"    () .    ,     ."]}),t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"    3    .        ''   ."]}),t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"      ."]}),t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"       ."]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-accent mb-2",children:" "}),t.jsx("p",{className:"text-gray-300",children:"  (, , , )      ,    ."}),t.jsxs("div",{className:"text-xs text-gray-400 mt-2 space-y-1 bg-black/20 p-2 rounded-md",children:[t.jsxs("p",{children:[t.jsx("strong",{children:":"})," /    "]}),t.jsxs("p",{children:[t.jsx("strong",{children:":"}),"    "]}),t.jsxs("p",{children:[t.jsx("strong",{children:":"}),"    "]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-accent mb-2",children:"  "}),o()]})]})})},cj={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},dj=e=>{if(e===0)return null;let n="";return e>=10?n="/images/equipments/Star4.png":e>=7?n="/images/equipments/Star3.png":e>=4?n="/images/equipments/Star2.png":e>=1&&(n="/images/equipments/Star1.png"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:"font-bold text-xs leading-none",children:e})]})},uj=({item:e})=>{var s,l,r,a;const n=cj[e.grade];return t.jsxs("div",{className:"flex flex-col w-full h-full p-1 bg-black/20 rounded-lg",children:[t.jsxs("div",{className:"flex mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0 mr-3",children:[t.jsx("img",{src:n.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),dj(e.stars)]}),t.jsxs("div",{className:"flex-grow overflow-hidden pt-2",children:[t.jsx("h3",{className:`text-lg font-bold truncate ${n.color}`,children:e.name}),((s=e.options)==null?void 0:s.main)&&t.jsx("p",{className:"font-semibold text-yellow-300 text-sm truncate",children:e.options.main.display})]})]}),t.jsxs("div",{className:"w-full text-sm text-left space-y-1 bg-black/30 p-2 rounded-lg flex-grow overflow-y-auto",children:[((l=e.options)==null?void 0:l.combatSubs)&&e.options.combatSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.combatSubs.map((i,o)=>t.jsx("p",{className:"text-blue-300",children:i.display},`c-${o}`))}),((r=e.options)==null?void 0:r.specialSubs)&&e.options.specialSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.specialSubs.map((i,o)=>t.jsx("p",{className:"text-green-300",children:i.display},`s-${o}`))}),((a=e.options)==null?void 0:a.mythicSubs)&&e.options.mythicSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.mythicSubs.map((i,o)=>t.jsx("p",{className:"text-red-400",children:i.display},`m-${o}`))})]})]})},mj=({result:e,onClose:n})=>{const{item:s,xpGained:l,isGreatSuccess:r}=e;return t.jsx(be,{title:r?" !":" ",onClose:n,windowId:"combination-result",initialWidth:400,children:t.jsxs("div",{className:"text-center flex flex-col items-center",children:[t.jsx("div",{className:"w-full max-w-xs",children:t.jsx(uj,{item:s})}),t.jsx("div",{className:"mt-4 bg-gray-900/50 p-4 rounded-lg text-lg w-full max-w-xs",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/equipments/moru.png",alt:" ",className:"w-5 h-5"}),"  :"]}),t.jsxs("span",{className:"font-bold text-orange-400",children:["+",l.toLocaleString()]})]})}),t.jsx(z,{onClick:n,className:"w-full mt-6 py-2.5 max-w-xs",children:""})]})})},Vu=({item:e})=>t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("div",{className:"relative w-20 h-20 mb-2",children:[t.jsx("img",{src:$a[e.grade],alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 text-center text-xs font-bold text-white bg-black/50 py-0.5",children:t.jsxs("span",{className:"text-white",children:["",e.stars]})})]}),t.jsx("p",{className:`font-bold ${El[e.grade].color}`,children:e.name})]}),fj=({result:e,onClose:n,isTopmost:s})=>{const l=e.success?" !":" !",r=e.success?"text-green-400":"text-red-400";return t.jsx(be,{title:l,onClose:n,windowId:"enhancementResult",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"p-4 text-center",children:[t.jsx("h3",{className:`text-xl font-bold mb-4 ${r}`,children:e.message}),t.jsxs("div",{className:"flex justify-around items-center mb-4",children:[t.jsx(Vu,{item:e.itemBefore}),t.jsx("span",{className:"text-2xl font-bold mx-4",children:e.success?"->":"X"}),t.jsx(Vu,{item:e.itemAfter})]}),t.jsx("button",{onClick:n,className:"mt-4 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-md",children:""})]})})},_r=({title:e,color:n,children:s})=>{const l=Pn.Children.toArray(s).filter(Boolean);return t.jsxs("div",{className:"flex-1 bg-gray-800/30 p-2 rounded-md flex flex-col min-h-0",children:[t.jsx("h4",{className:`text-center font-semibold mb-1 text-sm flex-shrink-0 ${n}`,children:e}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-1 space-y-1 text-xs",children:l.length>0?l:t.jsx("p",{className:"text-xs text-gray-400 text-center",children:" "})})]})},xj=(e,n)=>{const s=cx[e].description;switch(e){case it.StrategicGoldBonus:case it.PlayfulGoldBonus:{const l=20*n.count;return t.jsx("span",{className:"w-full",children:s.replace(/20%/,`${l}%`)})}case it.MannerActionCooldown:return t.jsxs("div",{className:"flex justify-between items-center w-full",children:[t.jsx("span",{children:s}),t.jsxs("span",{className:"font-mono font-semibold",children:["+",n.totalValue]})]});case it.DiceGoOddBonus:case it.AlkkagiSlowBonus:case it.AlkkagiAimingBonus:return t.jsx("span",{className:"w-full",children:s.replace(/1/g,`${n.totalValue}`)});default:return t.jsx("span",{className:"w-full",children:s})}},pj=({onClose:e,isTopmost:n,mainOptionBonuses:s,combatSubOptionBonuses:l,specialStatBonuses:r,aggregatedMythicStats:a})=>{const i={[N.Concentration]:"",[N.ThinkingSpeed]:"",[N.Judgment]:"",[N.Calculation]:"",[N.CombatPower]:"",[N.Stability]:""},o={[Fe.ActionPointMax]:" AP",[Fe.ActionPointRegen]:"AP ",[Fe.StrategyXpBonus]:" XP",[Fe.PlayfulXpBonus]:" XP",[Fe.GoldBonus]:" ",[Fe.ItemDropRate]:" ",[Fe.MaterialDropRate]:" "};return t.jsx(be,{title:"  ",onClose:e,windowId:"equipment-effects",initialWidth:600,isTopmost:n,children:t.jsxs("div",{className:"flex flex-col gap-4 p-2",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsx(_r,{title:" ",color:"text-yellow-300",children:Object.values(N).map(c=>{const d=s[c],u=d?`+${d.value.toFixed(d.isPercentage?1:0).replace(/\.0$/,"")}${d.isPercentage?"%":""}`:"+0";return t.jsxs("div",{className:"flex justify-between items-baseline",children:[t.jsx("span",{className:"text-gray-300",children:i[c]||c}),t.jsx("span",{className:`font-mono font-semibold text-right ${d?"":"text-gray-400"}`,children:u})]},c)})}),t.jsx(_r,{title:"  ",color:"text-blue-300",children:Object.values(N).map(c=>{const d=l[c],u=d?`+${d.value.toFixed(d.isPercentage?1:0).replace(/\.0$/,"")}${d.isPercentage?"%":""}`:"+0";return t.jsxs("div",{className:"flex justify-between items-baseline",children:[t.jsx("span",{className:"text-gray-300",children:i[c]||c}),t.jsx("span",{className:`font-mono font-semibold text-right ${d?"":"text-gray-400"}`,children:u})]},c)})})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsx(_r,{title:"  ",color:"text-green-300",children:Object.entries(r).map(([c,d])=>{if(d.flat===0&&d.percent===0)return null;const u=c,p=ox[u].name,m=o[u];return t.jsxs("div",{className:"flex justify-between items-baseline",title:p,children:[t.jsx("span",{className:"text-gray-300 truncate",children:m}),t.jsxs("span",{className:"font-mono font-semibold text-right text-green-300",children:[d.flat>0&&`+${d.flat.toFixed(0)}`,d.percent>0&&(d.flat>0?", ":"")+`+${d.percent.toFixed(1)}%`]})]},c)})}),t.jsx(_r,{title:"  ",color:"text-red-400",children:Object.entries(a).map(([c,d])=>d.count===0?null:t.jsx("div",{className:"text-red-300 text-[10px] leading-tight",children:xj(c,d)},c))})]})]})})};function gj(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const hj=()=>{const{currentUser:e,currentUserWithStatus:n,currentRoute:s,error:l,activeNegotiation:r,modals:a,showExitToast:i,enhancementResult:o,enhancementOutcome:c,handlers:d,onlineUsers:u,hasClaimableQuest:p,settings:m,mainOptionBonuses:h,combatSubOptionBonuses:y,specialStatBonuses:b,aggregatedMythicStats:v}=De(),[g,x]=f.useState(!0),[j,w]=f.useState(!1),S=gj(p);f.useEffect(()=>{if(m.features.questNotifications&&p&&!S){w(!0);const E=setTimeout(()=>w(!1),3e3);return()=>clearTimeout(E)}},[p,S,m.features.questNotifications]),f.useEffect(()=>{if(j){const E=setTimeout(()=>w(!1),3e3);return()=>clearTimeout(E)}},[j]),f.useEffect(()=>{const E=()=>{Ee.initialize(),document.removeEventListener("pointerdown",E)};return document.addEventListener("pointerdown",E),()=>{document.removeEventListener("pointerdown",E)}},[]),f.useEffect(()=>{e?Rv(Av).then(()=>{x(!1)}):x(!1)},[e]);const C=f.useMemo(()=>{const E=[];return r&&E.push("negotiation"),a.isSettingsModalOpen&&E.push("settings"),a.isInventoryOpen&&E.push("inventory"),a.isMailboxOpen&&E.push("mailbox"),a.isQuestsOpen&&E.push("quests"),a.rewardSummary&&E.push("rewardSummary"),a.isClaimAllSummaryOpen&&E.push("claimAllSummary"),a.isShopOpen&&E.push("shop"),a.lastUsedItemResult&&E.push("itemObtained"),a.disassemblyResult&&E.push("disassemblyResult"),a.craftResult&&E.push("craftResult"),a.viewingUser&&E.push("viewingUser"),a.isInfoModalOpen&&E.push("infoModal"),a.isEncyclopediaOpen&&E.push("encyclopedia"),a.isStatAllocationModalOpen&&E.push("statAllocation"),a.isProfileEditModalOpen&&E.push("profileEdit"),a.pastRankingsInfo&&E.push("pastRankings"),a.moderatingUser&&E.push("moderatingUser"),a.viewingItem&&E.push("viewingItem"),a.enhancingItem&&E.push("enhancingItem"),a.isBlacksmithModalOpen&&E.push("blacksmith"),a.combinationResult&&E.push("combinationResult"),E},[a,r]),k=C.length>0?C[C.length-1]:null,M=s.view==="game",_=e?"bg-primary":"bg-login-background";return t.jsxs("div",{className:`font-sans ${_} text-primary h-full flex flex-col`,children:[g&&t.jsxs("div",{className:"fixed inset-0 bg-tertiary z-[100] flex flex-col items-center justify-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-primary"}),t.jsx("p",{className:"mt-4 text-primary",children:"  ..."})]}),l&&t.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 w-full max-w-md z-50 animate-slide-down",children:t.jsx("div",{className:"bg-danger border-2 border-red-500 rounded-lg shadow-2xl p-4 text-white font-bold text-center",children:l})}),j&&t.jsx("div",{onClick:()=>{d.openQuests(),w(!1)},className:"fixed top-20 right-4 w-full max-w-xs z-50 animate-slide-in-right cursor-pointer",children:t.jsx("div",{className:"bg-success border-2 border-green-400 rounded-lg shadow-2xl p-4 text-white font-bold text-center",children:"   !"})}),o&&!a.enhancingItem&&t.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 w-full max-w-md z-50 animate-slide-down",children:t.jsx("div",{className:`${o.success?"bg-accent border-accent":"bg-danger border-red-500"} border-2 rounded-lg shadow-2xl p-4 text-white font-bold text-center`,children:o.message})}),i&&t.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 w-full max-w-md z-50 animate-slide-down-fast",children:t.jsx("div",{className:"bg-primary border-2 border-color rounded-lg shadow-2xl p-3 text-primary font-semibold text-center",children:"     ."})}),e&&!M&&t.jsx(I0,{}),e?t.jsx("main",{className:"flex-1 flex flex-col min-h-0",children:t.jsx($u,{})}):t.jsxs("div",{className:"relative h-full w-full flex flex-col items-center justify-center p-4 sm:p-8 bg-tertiary bg-[url('/images/bg/loginbg.png')] bg-cover bg-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60"}),t.jsxs("header",{className:"relative text-center z-10 pt-8 md:pt-16 mb-8",children:[t.jsx("h1",{className:"text-4xl sm:text-5xl md:text-6xl font-black text-white tracking-widest uppercase title-glow-secondary",style:{fontFamily:"serif"},children:"SUDAM"}),t.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white tracking-wider mt-2 title-glow-secondary",style:{fontFamily:"serif"},children:"The Ascending Masters"}),t.jsxs("p",{className:"mt-4 text-xs sm:text-sm text-gray-300",children:["Supreme Universe of Dueling Ascending Masters (S.U.D.A.M)",t.jsx("br",{}),"(    )"]})]}),t.jsx("main",{className:"relative flex-1 flex flex-col min-h-0 z-10",children:t.jsx($u,{})})]}),n&&t.jsxs(t.Fragment,{children:[a.isSettingsModalOpen&&t.jsx(Ov,{onClose:d.closeSettingsModal,isTopmost:k==="settings"}),a.isInventoryOpen&&t.jsx(Xb,{currentUser:n,onClose:d.closeInventory,onAction:d.handleAction,onStartEnhance:d.openEnhancingItem,enhancementAnimationTarget:a.enhancementAnimationTarget,onAnimationComplete:d.clearEnhancementAnimation,isTopmost:k==="inventory"}),a.isMailboxOpen&&t.jsx(tv,{currentUser:n,onClose:d.closeMailbox,onAction:d.handleAction,isTopmost:k==="mailbox"}),a.isQuestsOpen&&t.jsx(sv,{currentUser:n,onClose:d.closeQuests,onAction:d.handleAction,isTopmost:k==="quests"}),a.rewardSummary&&t.jsx(Pv,{summary:a.rewardSummary,onClose:d.closeRewardSummary,isTopmost:k==="rewardSummary"}),a.isClaimAllSummaryOpen&&a.claimAllSummary&&t.jsx(Wu,{summary:a.claimAllSummary,onClose:d.closeClaimAllSummary,isTopmost:k==="claimAllSummary"}),a.isShopOpen&&t.jsx(iv,{currentUser:n,onClose:d.closeShop,onAction:d.handleAction,isTopmost:k==="shop"}),a.lastUsedItemResult&&a.lastUsedItemResult.length===1&&t.jsx(wv,{item:a.lastUsedItemResult[0],onClose:d.closeItemObtained,isTopmost:k==="itemObtained"}),a.lastUsedItemResult&&a.lastUsedItemResult.length>1&&t.jsx(kv,{items:a.lastUsedItemResult,onClose:d.closeItemObtained,isTopmost:k==="itemObtained"}),a.disassemblyResult&&t.jsx(Ax,{result:a.disassemblyResult,onClose:d.closeDisassemblyResult,isTopmost:k==="disassemblyResult"}),a.craftResult&&t.jsx(Bv,{result:a.craftResult,onClose:d.closeCraftResult,isTopmost:k==="craftResult"}),a.viewingUser&&t.jsx(uv,{user:a.viewingUser,onClose:d.closeViewingUser,onViewItem:d.openViewingItem,isTopmost:k==="viewingUser"}),a.isInfoModalOpen&&t.jsx(mv,{onClose:d.closeInfoModal,isTopmost:k==="infoModal"}),a.isEncyclopediaOpen&&t.jsx(Cv,{onClose:d.closeEncyclopedia,isTopmost:k==="encyclopedia"}),a.isStatAllocationModalOpen&&t.jsx(fv,{currentUser:n,onClose:d.closeStatAllocationModal,onAction:d.handleAction,isTopmost:k==="statAllocation"}),a.isProfileEditModalOpen&&t.jsx(hv,{currentUser:n,onClose:d.closeProfileEditModal,onAction:d.handleAction,isTopmost:k==="profileEdit"}),a.pastRankingsInfo&&t.jsx(Iv,{info:a.pastRankingsInfo,onClose:d.closePastRankings,isTopmost:k==="pastRankings"}),a.moderatingUser&&t.jsx(Ev,{user:a.moderatingUser,currentUser:n,onClose:d.closeModerationModal,onAction:d.handleAction,isTopmost:k==="moderatingUser"}),a.viewingItem&&t.jsx(gv,{item:a.viewingItem.item,isOwnedByCurrentUser:a.viewingItem.isOwnedByCurrentUser,onClose:d.closeViewingItem,onStartEnhance:d.openEnhancementFromDetail,isTopmost:k==="viewingItem"}),r&&t.jsx(Cx,{negotiation:r,currentUser:n,onAction:d.handleAction,onlineUsers:u,isTopmost:k==="negotiation"}),a.isMbtiInfoModalOpen&&t.jsx(ko,{onClose:d.closeMbtiInfoModal,isTopmost:k==="mbtiInfo"}),a.isBlacksmithModalOpen&&t.jsx(aj,{onClose:d.closeBlacksmithModal,isTopmost:k==="blacksmith",selectedItemForEnhancement:a.blacksmithSelectedItemForEnhancement,activeTab:a.blacksmithActiveTab,onSetActiveTab:d.setBlacksmithActiveTab,enhancementOutcome:c}),a.combinationResult&&t.jsx(mj,{result:a.combinationResult,onClose:d.closeCombinationResult,isTopmost:k==="combinationResult"}),a.isBlacksmithHelpOpen&&t.jsx(oj,{onClose:d.closeBlacksmithHelp,isTopmost:k==="blacksmithHelp",currentUser:n}),a.isEnhancementResultModalOpen&&c&&t.jsx(fj,{result:c,onClose:d.closeEnhancementModal,isTopmost:k==="enhancementResult"}),a.isClaimAllSummaryOpen&&a.claimAllSummary&&t.jsx(Wu,{summary:a.claimAllSummary,onClose:d.closeClaimAllSummary,isTopmost:k==="claimAllSummary"}),a.isMbtiInfoModalOpen&&t.jsx(ko,{onClose:d.closeMbtiInfoModal,isTopmost:k==="mbtiInfo"}),a.isEquipmentEffectsModalOpen&&t.jsx(pj,{onClose:d.closeEquipmentEffectsModal,isTopmost:k==="equipmentEffects",mainOptionBonuses:h,combatSubOptionBonuses:y,specialStatBonuses:b,aggregatedMythicStats:v})]})]})},yj=()=>t.jsx("div",{className:"app-container",children:t.jsx(k0,{children:t.jsx(hj,{})})}),Lx=document.getElementById("root");if(!Lx)throw new Error("Could not find root element to mount to");const bj=Pi.createRoot(Lx);bj.render(t.jsx(Pn.StrictMode,{children:t.jsx(yj,{})}));
