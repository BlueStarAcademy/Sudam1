var ip=Object.defineProperty;var op=(e,n,s)=>n in e?ip(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s;var Mn=(e,n,s)=>op(e,typeof n!="symbol"?n+"":n,s);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();function cp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Vu={exports:{}},va={},Ku={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zl=Symbol.for("react.element"),dp=Symbol.for("react.portal"),up=Symbol.for("react.fragment"),mp=Symbol.for("react.strict_mode"),fp=Symbol.for("react.profiler"),xp=Symbol.for("react.provider"),pp=Symbol.for("react.context"),gp=Symbol.for("react.forward_ref"),hp=Symbol.for("react.suspense"),yp=Symbol.for("react.memo"),bp=Symbol.for("react.lazy"),Cc=Symbol.iterator;function vp(e){return e===null||typeof e!="object"?null:(e=Cc&&e[Cc]||e["@@iterator"],typeof e=="function"?e:null)}var Qu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ju=Object.assign,Yu={};function sl(e,n,s){this.props=e,this.context=n,this.refs=Yu,this.updater=s||Qu}sl.prototype.isReactComponent={};sl.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};sl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Xu(){}Xu.prototype=sl.prototype;function Co(e,n,s){this.props=e,this.context=n,this.refs=Yu,this.updater=s||Qu}var Io=Co.prototype=new Xu;Io.constructor=Co;Ju(Io,sl.prototype);Io.isPureReactComponent=!0;var Ic=Array.isArray,Zu=Object.prototype.hasOwnProperty,Eo={current:null},em={key:!0,ref:!0,__self:!0,__source:!0};function tm(e,n,s){var l,r={},a=null,i=null;if(n!=null)for(l in n.ref!==void 0&&(i=n.ref),n.key!==void 0&&(a=""+n.key),n)Zu.call(n,l)&&!em.hasOwnProperty(l)&&(r[l]=n[l]);var o=arguments.length-2;if(o===1)r.children=s;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(l in o=e.defaultProps,o)r[l]===void 0&&(r[l]=o[l]);return{$$typeof:Zl,type:e,key:a,ref:i,props:r,_owner:Eo.current}}function jp(e,n){return{$$typeof:Zl,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function Po(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zl}function wp(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return n[s]})}var Ec=/\/+/g;function Va(e,n){return typeof e=="object"&&e!==null&&e.key!=null?wp(""+e.key):n.toString(36)}function Ar(e,n,s,l,r){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Zl:case dp:i=!0}}if(i)return i=e,r=r(i),e=l===""?"."+Va(i,0):l,Ic(r)?(s="",e!=null&&(s=e.replace(Ec,"$&/")+"/"),Ar(r,n,s,"",function(d){return d})):r!=null&&(Po(r)&&(r=jp(r,s+(!r.key||i&&i.key===r.key?"":(""+r.key).replace(Ec,"$&/")+"/")+e)),n.push(r)),1;if(i=0,l=l===""?".":l+":",Ic(e))for(var o=0;o<e.length;o++){a=e[o];var c=l+Va(a,o);i+=Ar(a,n,s,c,r)}else if(c=vp(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=l+Va(a,o++),i+=Ar(a,n,s,c,r);else if(a==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return i}function ir(e,n,s){if(e==null)return e;var l=[],r=0;return Ar(e,l,"","",function(a){return n.call(s,a,r++)}),l}function Np(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var Pt={current:null},Rr={transition:null},kp={ReactCurrentDispatcher:Pt,ReactCurrentBatchConfig:Rr,ReactCurrentOwner:Eo};function nm(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:ir,forEach:function(e,n,s){ir(e,function(){n.apply(this,arguments)},s)},count:function(e){var n=0;return ir(e,function(){n++}),n},toArray:function(e){return ir(e,function(n){return n})||[]},only:function(e){if(!Po(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Le.Component=sl;Le.Fragment=up;Le.Profiler=fp;Le.PureComponent=Co;Le.StrictMode=mp;Le.Suspense=hp;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kp;Le.act=nm;Le.cloneElement=function(e,n,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=Ju({},e.props),r=e.key,a=e.ref,i=e._owner;if(n!=null){if(n.ref!==void 0&&(a=n.ref,i=Eo.current),n.key!==void 0&&(r=""+n.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in n)Zu.call(n,c)&&!em.hasOwnProperty(c)&&(l[c]=n[c]===void 0&&o!==void 0?o[c]:n[c])}var c=arguments.length-2;if(c===1)l.children=s;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];l.children=o}return{$$typeof:Zl,type:e.type,key:r,ref:a,props:l,_owner:i}};Le.createContext=function(e){return e={$$typeof:pp,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:xp,_context:e},e.Consumer=e};Le.createElement=tm;Le.createFactory=function(e){var n=tm.bind(null,e);return n.type=e,n};Le.createRef=function(){return{current:null}};Le.forwardRef=function(e){return{$$typeof:gp,render:e}};Le.isValidElement=Po;Le.lazy=function(e){return{$$typeof:bp,_payload:{_status:-1,_result:e},_init:Np}};Le.memo=function(e,n){return{$$typeof:yp,type:e,compare:n===void 0?null:n}};Le.startTransition=function(e){var n=Rr.transition;Rr.transition={};try{e()}finally{Rr.transition=n}};Le.unstable_act=nm;Le.useCallback=function(e,n){return Pt.current.useCallback(e,n)};Le.useContext=function(e){return Pt.current.useContext(e)};Le.useDebugValue=function(){};Le.useDeferredValue=function(e){return Pt.current.useDeferredValue(e)};Le.useEffect=function(e,n){return Pt.current.useEffect(e,n)};Le.useId=function(){return Pt.current.useId()};Le.useImperativeHandle=function(e,n,s){return Pt.current.useImperativeHandle(e,n,s)};Le.useInsertionEffect=function(e,n){return Pt.current.useInsertionEffect(e,n)};Le.useLayoutEffect=function(e,n){return Pt.current.useLayoutEffect(e,n)};Le.useMemo=function(e,n){return Pt.current.useMemo(e,n)};Le.useReducer=function(e,n,s){return Pt.current.useReducer(e,n,s)};Le.useRef=function(e){return Pt.current.useRef(e)};Le.useState=function(e){return Pt.current.useState(e)};Le.useSyncExternalStore=function(e,n,s){return Pt.current.useSyncExternalStore(e,n,s)};Le.useTransition=function(){return Pt.current.useTransition()};Le.version="18.3.1";Ku.exports=Le;var f=Ku.exports;const Pn=cp(f);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sp=f,Cp=Symbol.for("react.element"),Ip=Symbol.for("react.fragment"),Ep=Object.prototype.hasOwnProperty,Pp=Sp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Tp={key:!0,ref:!0,__self:!0,__source:!0};function sm(e,n,s){var l,r={},a=null,i=null;s!==void 0&&(a=""+s),n.key!==void 0&&(a=""+n.key),n.ref!==void 0&&(i=n.ref);for(l in n)Ep.call(n,l)&&!Tp.hasOwnProperty(l)&&(r[l]=n[l]);if(e&&e.defaultProps)for(l in n=e.defaultProps,n)r[l]===void 0&&(r[l]=n[l]);return{$$typeof:Cp,type:e,key:a,ref:i,props:r,_owner:Pp.current}}va.Fragment=Ip;va.jsx=sm;va.jsxs=sm;Vu.exports=va;var t=Vu.exports,Pi={},lm={exports:{}},zt={},rm={exports:{}},am={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(O,U){var G=O.length;O.push(U);e:for(;0<G;){var z=G-1>>>1,H=O[z];if(0<r(H,U))O[z]=U,O[G]=H,G=z;else break e}}function s(O){return O.length===0?null:O[0]}function l(O){if(O.length===0)return null;var U=O[0],G=O.pop();if(G!==U){O[0]=G;e:for(var z=0,H=O.length,ne=H>>>1;z<ne;){var oe=2*(z+1)-1,me=O[oe],ve=oe+1,J=O[ve];if(0>r(me,G))ve<H&&0>r(J,me)?(O[z]=J,O[ve]=G,z=ve):(O[z]=me,O[oe]=G,z=oe);else if(ve<H&&0>r(J,G))O[z]=J,O[ve]=G,z=ve;else break e}}return U}function r(O,U){var G=O.sortIndex-U.sortIndex;return G!==0?G:O.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],d=[],u=1,p=null,m=3,h=!1,y=!1,v=!1,b=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(O){for(var U=s(d);U!==null;){if(U.callback===null)l(d);else if(U.startTime<=O)l(d),U.sortIndex=U.expirationTime,n(c,U);else break;U=s(d)}}function w(O){if(v=!1,j(O),!y)if(s(c)!==null)y=!0,Q(k);else{var U=s(d);U!==null&&q(w,U.startTime-O)}}function k(O,U){y=!1,v&&(v=!1,g(P),P=-1),h=!0;var G=m;try{for(j(U),p=s(c);p!==null&&(!(p.expirationTime>U)||O&&!T());){var z=p.callback;if(typeof z=="function"){p.callback=null,m=p.priorityLevel;var H=z(p.expirationTime<=U);U=e.unstable_now(),typeof H=="function"?p.callback=H:p===s(c)&&l(c),j(U)}else l(c);p=s(c)}if(p!==null)var ne=!0;else{var oe=s(d);oe!==null&&q(w,oe.startTime-U),ne=!1}return ne}finally{p=null,m=G,h=!1}}var C=!1,S=null,P=-1,_=5,I=-1;function T(){return!(e.unstable_now()-I<_)}function B(){if(S!==null){var O=e.unstable_now();I=O;var U=!0;try{U=S(!0,O)}finally{U?R():(C=!1,S=null)}}else C=!1}var R;if(typeof x=="function")R=function(){x(B)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,L=A.port2;A.port1.onmessage=B,R=function(){L.postMessage(null)}}else R=function(){b(B,0)};function Q(O){S=O,C||(C=!0,R())}function q(O,U){P=b(function(){O(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,Q(k))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return s(c)},e.unstable_next=function(O){switch(m){case 1:case 2:case 3:var U=3;break;default:U=m}var G=m;m=U;try{return O()}finally{m=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,U){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var G=m;m=O;try{return U()}finally{m=G}},e.unstable_scheduleCallback=function(O,U,G){var z=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?z+G:z):G=z,O){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=G+H,O={id:u++,callback:U,priorityLevel:O,startTime:G,expirationTime:H,sortIndex:-1},G>z?(O.sortIndex=G,n(d,O),s(c)===null&&O===s(d)&&(v?(g(P),P=-1):v=!0,q(w,G-z))):(O.sortIndex=H,n(c,O),y||h||(y=!0,Q(k))),O},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(O){var U=m;return function(){var G=m;m=U;try{return O.apply(this,arguments)}finally{m=G}}}})(am);rm.exports=am;var Mp=rm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _p=f,Ut=Mp;function ee(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var im=new Set,_l={};function ys(e,n){Vs(e,n),Vs(e+"Capture",n)}function Vs(e,n){for(_l[e]=n,e=0;e<n.length;e++)im.add(n[e])}var kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ti=Object.prototype.hasOwnProperty,Ap=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Pc={},Tc={};function Rp(e){return Ti.call(Tc,e)?!0:Ti.call(Pc,e)?!1:Ap.test(e)?Tc[e]=!0:(Pc[e]=!0,!1)}function Bp(e,n,s,l){if(s!==null&&s.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return l?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Lp(e,n,s,l){if(n===null||typeof n>"u"||Bp(e,n,s,l))return!0;if(l)return!1;if(s!==null)switch(s.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Tt(e,n,s,l,r,a,i){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=l,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=n,this.sanitizeURL=a,this.removeEmptyString=i}var yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){yt[e]=new Tt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];yt[n]=new Tt(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){yt[e]=new Tt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){yt[e]=new Tt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){yt[e]=new Tt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){yt[e]=new Tt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){yt[e]=new Tt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){yt[e]=new Tt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){yt[e]=new Tt(e,5,!1,e.toLowerCase(),null,!1,!1)});var To=/[\-:]([a-z])/g;function Mo(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(To,Mo);yt[n]=new Tt(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(To,Mo);yt[n]=new Tt(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(To,Mo);yt[n]=new Tt(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){yt[e]=new Tt(e,1,!1,e.toLowerCase(),null,!1,!1)});yt.xlinkHref=new Tt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){yt[e]=new Tt(e,1,!1,e.toLowerCase(),null,!0,!0)});function _o(e,n,s,l){var r=yt.hasOwnProperty(n)?yt[n]:null;(r!==null?r.type!==0:l||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(Lp(n,s,r,l)&&(s=null),l||r===null?Rp(n)&&(s===null?e.removeAttribute(n):e.setAttribute(n,""+s)):r.mustUseProperty?e[r.propertyName]=s===null?r.type===3?!1:"":s:(n=r.attributeName,l=r.attributeNamespace,s===null?e.removeAttribute(n):(r=r.type,s=r===3||r===4&&s===!0?"":""+s,l?e.setAttributeNS(l,n,s):e.setAttribute(n,s))))}var Tn=_p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,or=Symbol.for("react.element"),Is=Symbol.for("react.portal"),Es=Symbol.for("react.fragment"),Ao=Symbol.for("react.strict_mode"),Mi=Symbol.for("react.profiler"),om=Symbol.for("react.provider"),cm=Symbol.for("react.context"),Ro=Symbol.for("react.forward_ref"),_i=Symbol.for("react.suspense"),Ai=Symbol.for("react.suspense_list"),Bo=Symbol.for("react.memo"),$n=Symbol.for("react.lazy"),dm=Symbol.for("react.offscreen"),Mc=Symbol.iterator;function ol(e){return e===null||typeof e!="object"?null:(e=Mc&&e[Mc]||e["@@iterator"],typeof e=="function"?e:null)}var nt=Object.assign,Ka;function gl(e){if(Ka===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);Ka=n&&n[1]||""}return`
`+Ka+e}var Qa=!1;function Ja(e,n){if(!e||Qa)return"";Qa=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(d){var l=d}Reflect.construct(e,[],n)}else{try{n.call()}catch(d){l=d}e.call(n.prototype)}else{try{throw Error()}catch(d){l=d}e()}}catch(d){if(d&&l&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),a=l.stack.split(`
`),i=r.length-1,o=a.length-1;1<=i&&0<=o&&r[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(r[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||r[i]!==a[o]){var c=`
`+r[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{Qa=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?gl(e):""}function $p(e){switch(e.tag){case 5:return gl(e.type);case 16:return gl("Lazy");case 13:return gl("Suspense");case 19:return gl("SuspenseList");case 0:case 2:case 15:return e=Ja(e.type,!1),e;case 11:return e=Ja(e.type.render,!1),e;case 1:return e=Ja(e.type,!0),e;default:return""}}function Ri(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Es:return"Fragment";case Is:return"Portal";case Mi:return"Profiler";case Ao:return"StrictMode";case _i:return"Suspense";case Ai:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case cm:return(e.displayName||"Context")+".Consumer";case om:return(e._context.displayName||"Context")+".Provider";case Ro:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Bo:return n=e.displayName||null,n!==null?n:Ri(e.type)||"Memo";case $n:n=e._payload,e=e._init;try{return Ri(e(n))}catch{}}return null}function Op(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ri(n);case 8:return n===Ao?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Xn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function um(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Dp(e){var n=um(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),l=""+e[n];if(!e.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var r=s.get,a=s.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return r.call(this)},set:function(i){l=""+i,a.call(this,i)}}),Object.defineProperty(e,n,{enumerable:s.enumerable}),{getValue:function(){return l},setValue:function(i){l=""+i},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function cr(e){e._valueTracker||(e._valueTracker=Dp(e))}function mm(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var s=n.getValue(),l="";return e&&(l=um(e)?e.checked?"true":"false":e.value),e=l,e!==s?(n.setValue(e),!0):!1}function Wr(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Bi(e,n){var s=n.checked;return nt({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function _c(e,n){var s=n.defaultValue==null?"":n.defaultValue,l=n.checked!=null?n.checked:n.defaultChecked;s=Xn(n.value!=null?n.value:s),e._wrapperState={initialChecked:l,initialValue:s,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function fm(e,n){n=n.checked,n!=null&&_o(e,"checked",n,!1)}function Li(e,n){fm(e,n);var s=Xn(n.value),l=n.type;if(s!=null)l==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?$i(e,n.type,s):n.hasOwnProperty("defaultValue")&&$i(e,n.type,Xn(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function Ac(e,n,s){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var l=n.type;if(!(l!=="submit"&&l!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,s||n===e.value||(e.value=n),e.defaultValue=n}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function $i(e,n,s){(n!=="number"||Wr(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var hl=Array.isArray;function qs(e,n,s,l){if(e=e.options,n){n={};for(var r=0;r<s.length;r++)n["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=n.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&l&&(e[s].defaultSelected=!0)}else{for(s=""+Xn(s),n=null,r=0;r<e.length;r++){if(e[r].value===s){e[r].selected=!0,l&&(e[r].defaultSelected=!0);return}n!==null||e[r].disabled||(n=e[r])}n!==null&&(n.selected=!0)}}function Oi(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(ee(91));return nt({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Rc(e,n){var s=n.value;if(s==null){if(s=n.children,n=n.defaultValue,s!=null){if(n!=null)throw Error(ee(92));if(hl(s)){if(1<s.length)throw Error(ee(93));s=s[0]}n=s}n==null&&(n=""),s=n}e._wrapperState={initialValue:Xn(s)}}function xm(e,n){var s=Xn(n.value),l=Xn(n.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),n.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),l!=null&&(e.defaultValue=""+l)}function Bc(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function pm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Di(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?pm(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var dr,gm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,s,l,r){MSApp.execUnsafeLocalFunction(function(){return e(n,s,l,r)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(dr=dr||document.createElement("div"),dr.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=dr.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Al(e,n){if(n){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=n;return}}e.textContent=n}var vl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qp=["Webkit","ms","Moz","O"];Object.keys(vl).forEach(function(e){qp.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),vl[n]=vl[e]})});function hm(e,n,s){return n==null||typeof n=="boolean"||n===""?"":s||typeof n!="number"||n===0||vl.hasOwnProperty(e)&&vl[e]?(""+n).trim():n+"px"}function ym(e,n){e=e.style;for(var s in n)if(n.hasOwnProperty(s)){var l=s.indexOf("--")===0,r=hm(s,n[s],l);s==="float"&&(s="cssFloat"),l?e.setProperty(s,r):e[s]=r}}var Up=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qi(e,n){if(n){if(Up[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(ee(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(ee(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(ee(61))}if(n.style!=null&&typeof n.style!="object")throw Error(ee(62))}}function Ui(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zi=null;function Lo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Fi=null,Us=null,zs=null;function Lc(e){if(e=nr(e)){if(typeof Fi!="function")throw Error(ee(280));var n=e.stateNode;n&&(n=Sa(n),Fi(e.stateNode,e.type,n))}}function bm(e){Us?zs?zs.push(e):zs=[e]:Us=e}function vm(){if(Us){var e=Us,n=zs;if(zs=Us=null,Lc(e),n)for(e=0;e<n.length;e++)Lc(n[e])}}function jm(e,n){return e(n)}function wm(){}var Ya=!1;function Nm(e,n,s){if(Ya)return e(n,s);Ya=!0;try{return jm(e,n,s)}finally{Ya=!1,(Us!==null||zs!==null)&&(wm(),vm())}}function Rl(e,n){var s=e.stateNode;if(s===null)return null;var l=Sa(s);if(l===null)return null;s=l[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(ee(231,n,typeof s));return s}var Gi=!1;if(kn)try{var cl={};Object.defineProperty(cl,"passive",{get:function(){Gi=!0}}),window.addEventListener("test",cl,cl),window.removeEventListener("test",cl,cl)}catch{Gi=!1}function zp(e,n,s,l,r,a,i,o,c){var d=Array.prototype.slice.call(arguments,3);try{n.apply(s,d)}catch(u){this.onError(u)}}var jl=!1,Hr=null,Vr=!1,Wi=null,Fp={onError:function(e){jl=!0,Hr=e}};function Gp(e,n,s,l,r,a,i,o,c){jl=!1,Hr=null,zp.apply(Fp,arguments)}function Wp(e,n,s,l,r,a,i,o,c){if(Gp.apply(this,arguments),jl){if(jl){var d=Hr;jl=!1,Hr=null}else throw Error(ee(198));Vr||(Vr=!0,Wi=d)}}function bs(e){var n=e,s=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(s=n.return),e=n.return;while(e)}return n.tag===3?s:null}function km(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function $c(e){if(bs(e)!==e)throw Error(ee(188))}function Hp(e){var n=e.alternate;if(!n){if(n=bs(e),n===null)throw Error(ee(188));return n!==e?null:e}for(var s=e,l=n;;){var r=s.return;if(r===null)break;var a=r.alternate;if(a===null){if(l=r.return,l!==null){s=l;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===s)return $c(r),e;if(a===l)return $c(r),n;a=a.sibling}throw Error(ee(188))}if(s.return!==l.return)s=r,l=a;else{for(var i=!1,o=r.child;o;){if(o===s){i=!0,s=r,l=a;break}if(o===l){i=!0,l=r,s=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===s){i=!0,s=a,l=r;break}if(o===l){i=!0,l=a,s=r;break}o=o.sibling}if(!i)throw Error(ee(189))}}if(s.alternate!==l)throw Error(ee(190))}if(s.tag!==3)throw Error(ee(188));return s.stateNode.current===s?e:n}function Sm(e){return e=Hp(e),e!==null?Cm(e):null}function Cm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Cm(e);if(n!==null)return n;e=e.sibling}return null}var Im=Ut.unstable_scheduleCallback,Oc=Ut.unstable_cancelCallback,Vp=Ut.unstable_shouldYield,Kp=Ut.unstable_requestPaint,lt=Ut.unstable_now,Qp=Ut.unstable_getCurrentPriorityLevel,$o=Ut.unstable_ImmediatePriority,Em=Ut.unstable_UserBlockingPriority,Kr=Ut.unstable_NormalPriority,Jp=Ut.unstable_LowPriority,Pm=Ut.unstable_IdlePriority,ja=null,gn=null;function Yp(e){if(gn&&typeof gn.onCommitFiberRoot=="function")try{gn.onCommitFiberRoot(ja,e,void 0,(e.current.flags&128)===128)}catch{}}var rn=Math.clz32?Math.clz32:eg,Xp=Math.log,Zp=Math.LN2;function eg(e){return e>>>=0,e===0?32:31-(Xp(e)/Zp|0)|0}var ur=64,mr=4194304;function yl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Qr(e,n){var s=e.pendingLanes;if(s===0)return 0;var l=0,r=e.suspendedLanes,a=e.pingedLanes,i=s&268435455;if(i!==0){var o=i&~r;o!==0?l=yl(o):(a&=i,a!==0&&(l=yl(a)))}else i=s&~r,i!==0?l=yl(i):a!==0&&(l=yl(a));if(l===0)return 0;if(n!==0&&n!==l&&!(n&r)&&(r=l&-l,a=n&-n,r>=a||r===16&&(a&4194240)!==0))return n;if(l&4&&(l|=s&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=l;0<n;)s=31-rn(n),r=1<<s,l|=e[s],n&=~r;return l}function tg(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ng(e,n){for(var s=e.suspendedLanes,l=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-rn(a),o=1<<i,c=r[i];c===-1?(!(o&s)||o&l)&&(r[i]=tg(o,n)):c<=n&&(e.expiredLanes|=o),a&=~o}}function Hi(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Tm(){var e=ur;return ur<<=1,!(ur&4194240)&&(ur=64),e}function Xa(e){for(var n=[],s=0;31>s;s++)n.push(e);return n}function er(e,n,s){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-rn(n),e[n]=s}function sg(e,n){var s=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-rn(s),a=1<<r;n[r]=0,l[r]=-1,e[r]=-1,s&=~a}}function Oo(e,n){var s=e.entangledLanes|=n;for(e=e.entanglements;s;){var l=31-rn(s),r=1<<l;r&n|e[l]&n&&(e[l]|=n),s&=~r}}var Fe=0;function Mm(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var _m,Do,Am,Rm,Bm,Vi=!1,fr=[],Fn=null,Gn=null,Wn=null,Bl=new Map,Ll=new Map,Dn=[],lg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dc(e,n){switch(e){case"focusin":case"focusout":Fn=null;break;case"dragenter":case"dragleave":Gn=null;break;case"mouseover":case"mouseout":Wn=null;break;case"pointerover":case"pointerout":Bl.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ll.delete(n.pointerId)}}function dl(e,n,s,l,r,a){return e===null||e.nativeEvent!==a?(e={blockedOn:n,domEventName:s,eventSystemFlags:l,nativeEvent:a,targetContainers:[r]},n!==null&&(n=nr(n),n!==null&&Do(n)),e):(e.eventSystemFlags|=l,n=e.targetContainers,r!==null&&n.indexOf(r)===-1&&n.push(r),e)}function rg(e,n,s,l,r){switch(n){case"focusin":return Fn=dl(Fn,e,n,s,l,r),!0;case"dragenter":return Gn=dl(Gn,e,n,s,l,r),!0;case"mouseover":return Wn=dl(Wn,e,n,s,l,r),!0;case"pointerover":var a=r.pointerId;return Bl.set(a,dl(Bl.get(a)||null,e,n,s,l,r)),!0;case"gotpointercapture":return a=r.pointerId,Ll.set(a,dl(Ll.get(a)||null,e,n,s,l,r)),!0}return!1}function Lm(e){var n=os(e.target);if(n!==null){var s=bs(n);if(s!==null){if(n=s.tag,n===13){if(n=km(s),n!==null){e.blockedOn=n,Bm(e.priority,function(){Am(s)});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Br(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var s=Ki(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var l=new s.constructor(s.type,s);zi=l,s.target.dispatchEvent(l),zi=null}else return n=nr(s),n!==null&&Do(n),e.blockedOn=s,!1;n.shift()}return!0}function qc(e,n,s){Br(e)&&s.delete(n)}function ag(){Vi=!1,Fn!==null&&Br(Fn)&&(Fn=null),Gn!==null&&Br(Gn)&&(Gn=null),Wn!==null&&Br(Wn)&&(Wn=null),Bl.forEach(qc),Ll.forEach(qc)}function ul(e,n){e.blockedOn===n&&(e.blockedOn=null,Vi||(Vi=!0,Ut.unstable_scheduleCallback(Ut.unstable_NormalPriority,ag)))}function $l(e){function n(r){return ul(r,e)}if(0<fr.length){ul(fr[0],e);for(var s=1;s<fr.length;s++){var l=fr[s];l.blockedOn===e&&(l.blockedOn=null)}}for(Fn!==null&&ul(Fn,e),Gn!==null&&ul(Gn,e),Wn!==null&&ul(Wn,e),Bl.forEach(n),Ll.forEach(n),s=0;s<Dn.length;s++)l=Dn[s],l.blockedOn===e&&(l.blockedOn=null);for(;0<Dn.length&&(s=Dn[0],s.blockedOn===null);)Lm(s),s.blockedOn===null&&Dn.shift()}var Fs=Tn.ReactCurrentBatchConfig,Jr=!0;function ig(e,n,s,l){var r=Fe,a=Fs.transition;Fs.transition=null;try{Fe=1,qo(e,n,s,l)}finally{Fe=r,Fs.transition=a}}function og(e,n,s,l){var r=Fe,a=Fs.transition;Fs.transition=null;try{Fe=4,qo(e,n,s,l)}finally{Fe=r,Fs.transition=a}}function qo(e,n,s,l){if(Jr){var r=Ki(e,n,s,l);if(r===null)oi(e,n,l,Yr,s),Dc(e,l);else if(rg(r,e,n,s,l))l.stopPropagation();else if(Dc(e,l),n&4&&-1<lg.indexOf(e)){for(;r!==null;){var a=nr(r);if(a!==null&&_m(a),a=Ki(e,n,s,l),a===null&&oi(e,n,l,Yr,s),a===r)break;r=a}r!==null&&l.stopPropagation()}else oi(e,n,l,null,s)}}var Yr=null;function Ki(e,n,s,l){if(Yr=null,e=Lo(l),e=os(e),e!==null)if(n=bs(e),n===null)e=null;else if(s=n.tag,s===13){if(e=km(n),e!==null)return e;e=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Yr=e,null}function $m(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qp()){case $o:return 1;case Em:return 4;case Kr:case Jp:return 16;case Pm:return 536870912;default:return 16}default:return 16}}var Un=null,Uo=null,Lr=null;function Om(){if(Lr)return Lr;var e,n=Uo,s=n.length,l,r="value"in Un?Un.value:Un.textContent,a=r.length;for(e=0;e<s&&n[e]===r[e];e++);var i=s-e;for(l=1;l<=i&&n[s-l]===r[a-l];l++);return Lr=r.slice(e,1<l?1-l:void 0)}function $r(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function xr(){return!0}function Uc(){return!1}function Ft(e){function n(s,l,r,a,i){this._reactName=s,this._targetInst=r,this.type=l,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(s=e[o],this[o]=s?s(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?xr:Uc,this.isPropagationStopped=Uc,this}return nt(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=xr)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=xr)},persist:function(){},isPersistent:xr}),n}var ll={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zo=Ft(ll),tr=nt({},ll,{view:0,detail:0}),cg=Ft(tr),Za,ei,ml,wa=nt({},tr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ml&&(ml&&e.type==="mousemove"?(Za=e.screenX-ml.screenX,ei=e.screenY-ml.screenY):ei=Za=0,ml=e),Za)},movementY:function(e){return"movementY"in e?e.movementY:ei}}),zc=Ft(wa),dg=nt({},wa,{dataTransfer:0}),ug=Ft(dg),mg=nt({},tr,{relatedTarget:0}),ti=Ft(mg),fg=nt({},ll,{animationName:0,elapsedTime:0,pseudoElement:0}),xg=Ft(fg),pg=nt({},ll,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),gg=Ft(pg),hg=nt({},ll,{data:0}),Fc=Ft(hg),yg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jg(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=vg[e])?!!n[e]:!1}function Fo(){return jg}var wg=nt({},tr,{key:function(e){if(e.key){var n=yg[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=$r(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?bg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fo,charCode:function(e){return e.type==="keypress"?$r(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?$r(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ng=Ft(wg),kg=nt({},wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gc=Ft(kg),Sg=nt({},tr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fo}),Cg=Ft(Sg),Ig=nt({},ll,{propertyName:0,elapsedTime:0,pseudoElement:0}),Eg=Ft(Ig),Pg=nt({},wa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Tg=Ft(Pg),Mg=[9,13,27,32],Go=kn&&"CompositionEvent"in window,wl=null;kn&&"documentMode"in document&&(wl=document.documentMode);var _g=kn&&"TextEvent"in window&&!wl,Dm=kn&&(!Go||wl&&8<wl&&11>=wl),Wc=" ",Hc=!1;function qm(e,n){switch(e){case"keyup":return Mg.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Um(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ps=!1;function Ag(e,n){switch(e){case"compositionend":return Um(n);case"keypress":return n.which!==32?null:(Hc=!0,Wc);case"textInput":return e=n.data,e===Wc&&Hc?null:e;default:return null}}function Rg(e,n){if(Ps)return e==="compositionend"||!Go&&qm(e,n)?(e=Om(),Lr=Uo=Un=null,Ps=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Dm&&n.locale!=="ko"?null:n.data;default:return null}}var Bg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vc(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!Bg[e.type]:n==="textarea"}function zm(e,n,s,l){bm(l),n=Xr(n,"onChange"),0<n.length&&(s=new zo("onChange","change",null,s,l),e.push({event:s,listeners:n}))}var Nl=null,Ol=null;function Lg(e){Zm(e,0)}function Na(e){var n=_s(e);if(mm(n))return e}function $g(e,n){if(e==="change")return n}var Fm=!1;if(kn){var ni;if(kn){var si="oninput"in document;if(!si){var Kc=document.createElement("div");Kc.setAttribute("oninput","return;"),si=typeof Kc.oninput=="function"}ni=si}else ni=!1;Fm=ni&&(!document.documentMode||9<document.documentMode)}function Qc(){Nl&&(Nl.detachEvent("onpropertychange",Gm),Ol=Nl=null)}function Gm(e){if(e.propertyName==="value"&&Na(Ol)){var n=[];zm(n,Ol,e,Lo(e)),Nm(Lg,n)}}function Og(e,n,s){e==="focusin"?(Qc(),Nl=n,Ol=s,Nl.attachEvent("onpropertychange",Gm)):e==="focusout"&&Qc()}function Dg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Na(Ol)}function qg(e,n){if(e==="click")return Na(n)}function Ug(e,n){if(e==="input"||e==="change")return Na(n)}function zg(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var on=typeof Object.is=="function"?Object.is:zg;function Dl(e,n){if(on(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var s=Object.keys(e),l=Object.keys(n);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var r=s[l];if(!Ti.call(n,r)||!on(e[r],n[r]))return!1}return!0}function Jc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Yc(e,n){var s=Jc(e);e=0;for(var l;s;){if(s.nodeType===3){if(l=e+s.textContent.length,e<=n&&l>=n)return{node:s,offset:n-e};e=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Jc(s)}}function Wm(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?Wm(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function Hm(){for(var e=window,n=Wr();n instanceof e.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)e=n.contentWindow;else break;n=Wr(e.document)}return n}function Wo(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function Fg(e){var n=Hm(),s=e.focusedElem,l=e.selectionRange;if(n!==s&&s&&s.ownerDocument&&Wm(s.ownerDocument.documentElement,s)){if(l!==null&&Wo(s)){if(n=l.start,e=l.end,e===void 0&&(e=n),"selectionStart"in s)s.selectionStart=n,s.selectionEnd=Math.min(e,s.value.length);else if(e=(n=s.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var r=s.textContent.length,a=Math.min(l.start,r);l=l.end===void 0?a:Math.min(l.end,r),!e.extend&&a>l&&(r=l,l=a,a=r),r=Yc(s,a);var i=Yc(s,l);r&&i&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(n=n.createRange(),n.setStart(r.node,r.offset),e.removeAllRanges(),a>l?(e.addRange(n),e.extend(i.node,i.offset)):(n.setEnd(i.node,i.offset),e.addRange(n)))}}for(n=[],e=s;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<n.length;s++)e=n[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Gg=kn&&"documentMode"in document&&11>=document.documentMode,Ts=null,Qi=null,kl=null,Ji=!1;function Xc(e,n,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Ji||Ts==null||Ts!==Wr(l)||(l=Ts,"selectionStart"in l&&Wo(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),kl&&Dl(kl,l)||(kl=l,l=Xr(Qi,"onSelect"),0<l.length&&(n=new zo("onSelect","select",null,n,s),e.push({event:n,listeners:l}),n.target=Ts)))}function pr(e,n){var s={};return s[e.toLowerCase()]=n.toLowerCase(),s["Webkit"+e]="webkit"+n,s["Moz"+e]="moz"+n,s}var Ms={animationend:pr("Animation","AnimationEnd"),animationiteration:pr("Animation","AnimationIteration"),animationstart:pr("Animation","AnimationStart"),transitionend:pr("Transition","TransitionEnd")},li={},Vm={};kn&&(Vm=document.createElement("div").style,"AnimationEvent"in window||(delete Ms.animationend.animation,delete Ms.animationiteration.animation,delete Ms.animationstart.animation),"TransitionEvent"in window||delete Ms.transitionend.transition);function ka(e){if(li[e])return li[e];if(!Ms[e])return e;var n=Ms[e],s;for(s in n)if(n.hasOwnProperty(s)&&s in Vm)return li[e]=n[s];return e}var Km=ka("animationend"),Qm=ka("animationiteration"),Jm=ka("animationstart"),Ym=ka("transitionend"),Xm=new Map,Zc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function es(e,n){Xm.set(e,n),ys(n,[e])}for(var ri=0;ri<Zc.length;ri++){var ai=Zc[ri],Wg=ai.toLowerCase(),Hg=ai[0].toUpperCase()+ai.slice(1);es(Wg,"on"+Hg)}es(Km,"onAnimationEnd");es(Qm,"onAnimationIteration");es(Jm,"onAnimationStart");es("dblclick","onDoubleClick");es("focusin","onFocus");es("focusout","onBlur");es(Ym,"onTransitionEnd");Vs("onMouseEnter",["mouseout","mouseover"]);Vs("onMouseLeave",["mouseout","mouseover"]);Vs("onPointerEnter",["pointerout","pointerover"]);Vs("onPointerLeave",["pointerout","pointerover"]);ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ys("onBeforeInput",["compositionend","keypress","textInput","paste"]);ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vg=new Set("cancel close invalid load scroll toggle".split(" ").concat(bl));function ed(e,n,s){var l=e.type||"unknown-event";e.currentTarget=s,Wp(l,n,void 0,e),e.currentTarget=null}function Zm(e,n){n=(n&4)!==0;for(var s=0;s<e.length;s++){var l=e[s],r=l.event;l=l.listeners;e:{var a=void 0;if(n)for(var i=l.length-1;0<=i;i--){var o=l[i],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==a&&r.isPropagationStopped())break e;ed(r,o,d),a=c}else for(i=0;i<l.length;i++){if(o=l[i],c=o.instance,d=o.currentTarget,o=o.listener,c!==a&&r.isPropagationStopped())break e;ed(r,o,d),a=c}}}if(Vr)throw e=Wi,Vr=!1,Wi=null,e}function Ye(e,n){var s=n[to];s===void 0&&(s=n[to]=new Set);var l=e+"__bubble";s.has(l)||(ef(n,e,2,!1),s.add(l))}function ii(e,n,s){var l=0;n&&(l|=4),ef(s,e,l,n)}var gr="_reactListening"+Math.random().toString(36).slice(2);function ql(e){if(!e[gr]){e[gr]=!0,im.forEach(function(s){s!=="selectionchange"&&(Vg.has(s)||ii(s,!1,e),ii(s,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[gr]||(n[gr]=!0,ii("selectionchange",!1,n))}}function ef(e,n,s,l){switch($m(n)){case 1:var r=ig;break;case 4:r=og;break;default:r=qo}s=r.bind(null,n,s,e),r=void 0,!Gi||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(r=!0),l?r!==void 0?e.addEventListener(n,s,{capture:!0,passive:r}):e.addEventListener(n,s,!0):r!==void 0?e.addEventListener(n,s,{passive:r}):e.addEventListener(n,s,!1)}function oi(e,n,s,l,r){var a=l;if(!(n&1)&&!(n&2)&&l!==null)e:for(;;){if(l===null)return;var i=l.tag;if(i===3||i===4){var o=l.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(i===4)for(i=l.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;i=i.return}for(;o!==null;){if(i=os(o),i===null)return;if(c=i.tag,c===5||c===6){l=a=i;continue e}o=o.parentNode}}l=l.return}Nm(function(){var d=a,u=Lo(s),p=[];e:{var m=Xm.get(e);if(m!==void 0){var h=zo,y=e;switch(e){case"keypress":if($r(s)===0)break e;case"keydown":case"keyup":h=Ng;break;case"focusin":y="focus",h=ti;break;case"focusout":y="blur",h=ti;break;case"beforeblur":case"afterblur":h=ti;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=zc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=ug;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Cg;break;case Km:case Qm:case Jm:h=xg;break;case Ym:h=Eg;break;case"scroll":h=cg;break;case"wheel":h=Tg;break;case"copy":case"cut":case"paste":h=gg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Gc}var v=(n&4)!==0,b=!v&&e==="scroll",g=v?m!==null?m+"Capture":null:m;v=[];for(var x=d,j;x!==null;){j=x;var w=j.stateNode;if(j.tag===5&&w!==null&&(j=w,g!==null&&(w=Rl(x,g),w!=null&&v.push(Ul(x,w,j)))),b)break;x=x.return}0<v.length&&(m=new h(m,y,null,s,u),p.push({event:m,listeners:v}))}}if(!(n&7)){e:{if(m=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",m&&s!==zi&&(y=s.relatedTarget||s.fromElement)&&(os(y)||y[Sn]))break e;if((h||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,h?(y=s.relatedTarget||s.toElement,h=d,y=y?os(y):null,y!==null&&(b=bs(y),y!==b||y.tag!==5&&y.tag!==6)&&(y=null)):(h=null,y=d),h!==y)){if(v=zc,w="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(v=Gc,w="onPointerLeave",g="onPointerEnter",x="pointer"),b=h==null?m:_s(h),j=y==null?m:_s(y),m=new v(w,x+"leave",h,s,u),m.target=b,m.relatedTarget=j,w=null,os(u)===d&&(v=new v(g,x+"enter",y,s,u),v.target=j,v.relatedTarget=b,w=v),b=w,h&&y)t:{for(v=h,g=y,x=0,j=v;j;j=Ns(j))x++;for(j=0,w=g;w;w=Ns(w))j++;for(;0<x-j;)v=Ns(v),x--;for(;0<j-x;)g=Ns(g),j--;for(;x--;){if(v===g||g!==null&&v===g.alternate)break t;v=Ns(v),g=Ns(g)}v=null}else v=null;h!==null&&td(p,m,h,v,!1),y!==null&&b!==null&&td(p,b,y,v,!0)}}e:{if(m=d?_s(d):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var k=$g;else if(Vc(m))if(Fm)k=Ug;else{k=Dg;var C=Og}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(k=qg);if(k&&(k=k(e,d))){zm(p,k,s,u);break e}C&&C(e,m,d),e==="focusout"&&(C=m._wrapperState)&&C.controlled&&m.type==="number"&&$i(m,"number",m.value)}switch(C=d?_s(d):window,e){case"focusin":(Vc(C)||C.contentEditable==="true")&&(Ts=C,Qi=d,kl=null);break;case"focusout":kl=Qi=Ts=null;break;case"mousedown":Ji=!0;break;case"contextmenu":case"mouseup":case"dragend":Ji=!1,Xc(p,s,u);break;case"selectionchange":if(Gg)break;case"keydown":case"keyup":Xc(p,s,u)}var S;if(Go)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Ps?qm(e,s)&&(P="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(P="onCompositionStart");P&&(Dm&&s.locale!=="ko"&&(Ps||P!=="onCompositionStart"?P==="onCompositionEnd"&&Ps&&(S=Om()):(Un=u,Uo="value"in Un?Un.value:Un.textContent,Ps=!0)),C=Xr(d,P),0<C.length&&(P=new Fc(P,e,null,s,u),p.push({event:P,listeners:C}),S?P.data=S:(S=Um(s),S!==null&&(P.data=S)))),(S=_g?Ag(e,s):Rg(e,s))&&(d=Xr(d,"onBeforeInput"),0<d.length&&(u=new Fc("onBeforeInput","beforeinput",null,s,u),p.push({event:u,listeners:d}),u.data=S))}Zm(p,n)})}function Ul(e,n,s){return{instance:e,listener:n,currentTarget:s}}function Xr(e,n){for(var s=n+"Capture",l=[];e!==null;){var r=e,a=r.stateNode;r.tag===5&&a!==null&&(r=a,a=Rl(e,s),a!=null&&l.unshift(Ul(e,a,r)),a=Rl(e,n),a!=null&&l.push(Ul(e,a,r))),e=e.return}return l}function Ns(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function td(e,n,s,l,r){for(var a=n._reactName,i=[];s!==null&&s!==l;){var o=s,c=o.alternate,d=o.stateNode;if(c!==null&&c===l)break;o.tag===5&&d!==null&&(o=d,r?(c=Rl(s,a),c!=null&&i.unshift(Ul(s,c,o))):r||(c=Rl(s,a),c!=null&&i.push(Ul(s,c,o)))),s=s.return}i.length!==0&&e.push({event:n,listeners:i})}var Kg=/\r\n?/g,Qg=/\u0000|\uFFFD/g;function nd(e){return(typeof e=="string"?e:""+e).replace(Kg,`
`).replace(Qg,"")}function hr(e,n,s){if(n=nd(n),nd(e)!==n&&s)throw Error(ee(425))}function Zr(){}var Yi=null,Xi=null;function Zi(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var eo=typeof setTimeout=="function"?setTimeout:void 0,Jg=typeof clearTimeout=="function"?clearTimeout:void 0,sd=typeof Promise=="function"?Promise:void 0,Yg=typeof queueMicrotask=="function"?queueMicrotask:typeof sd<"u"?function(e){return sd.resolve(null).then(e).catch(Xg)}:eo;function Xg(e){setTimeout(function(){throw e})}function ci(e,n){var s=n,l=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&r.nodeType===8)if(s=r.data,s==="/$"){if(l===0){e.removeChild(r),$l(n);return}l--}else s!=="$"&&s!=="$?"&&s!=="$!"||l++;s=r}while(s);$l(n)}function Hn(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function ld(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return e;n--}else s==="/$"&&n++}e=e.previousSibling}return null}var rl=Math.random().toString(36).slice(2),pn="__reactFiber$"+rl,zl="__reactProps$"+rl,Sn="__reactContainer$"+rl,to="__reactEvents$"+rl,Zg="__reactListeners$"+rl,eh="__reactHandles$"+rl;function os(e){var n=e[pn];if(n)return n;for(var s=e.parentNode;s;){if(n=s[Sn]||s[pn]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(e=ld(e);e!==null;){if(s=e[pn])return s;e=ld(e)}return n}e=s,s=e.parentNode}return null}function nr(e){return e=e[pn]||e[Sn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function _s(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ee(33))}function Sa(e){return e[zl]||null}var no=[],As=-1;function ts(e){return{current:e}}function Xe(e){0>As||(e.current=no[As],no[As]=null,As--)}function Qe(e,n){As++,no[As]=e.current,e.current=n}var Zn={},kt=ts(Zn),Bt=ts(!1),fs=Zn;function Ks(e,n){var s=e.type.contextTypes;if(!s)return Zn;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===n)return l.__reactInternalMemoizedMaskedChildContext;var r={},a;for(a in s)r[a]=n[a];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=r),r}function Lt(e){return e=e.childContextTypes,e!=null}function ea(){Xe(Bt),Xe(kt)}function rd(e,n,s){if(kt.current!==Zn)throw Error(ee(168));Qe(kt,n),Qe(Bt,s)}function tf(e,n,s){var l=e.stateNode;if(n=n.childContextTypes,typeof l.getChildContext!="function")return s;l=l.getChildContext();for(var r in l)if(!(r in n))throw Error(ee(108,Op(e)||"Unknown",r));return nt({},s,l)}function ta(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Zn,fs=kt.current,Qe(kt,e),Qe(Bt,Bt.current),!0}function ad(e,n,s){var l=e.stateNode;if(!l)throw Error(ee(169));s?(e=tf(e,n,fs),l.__reactInternalMemoizedMergedChildContext=e,Xe(Bt),Xe(kt),Qe(kt,e)):Xe(Bt),Qe(Bt,s)}var vn=null,Ca=!1,di=!1;function nf(e){vn===null?vn=[e]:vn.push(e)}function th(e){Ca=!0,nf(e)}function ns(){if(!di&&vn!==null){di=!0;var e=0,n=Fe;try{var s=vn;for(Fe=1;e<s.length;e++){var l=s[e];do l=l(!0);while(l!==null)}vn=null,Ca=!1}catch(r){throw vn!==null&&(vn=vn.slice(e+1)),Im($o,ns),r}finally{Fe=n,di=!1}}return null}var Rs=[],Bs=0,na=null,sa=0,Vt=[],Kt=0,xs=null,jn=1,wn="";function as(e,n){Rs[Bs++]=sa,Rs[Bs++]=na,na=e,sa=n}function sf(e,n,s){Vt[Kt++]=jn,Vt[Kt++]=wn,Vt[Kt++]=xs,xs=e;var l=jn;e=wn;var r=32-rn(l)-1;l&=~(1<<r),s+=1;var a=32-rn(n)+r;if(30<a){var i=r-r%5;a=(l&(1<<i)-1).toString(32),l>>=i,r-=i,jn=1<<32-rn(n)+r|s<<r|l,wn=a+e}else jn=1<<a|s<<r|l,wn=e}function Ho(e){e.return!==null&&(as(e,1),sf(e,1,0))}function Vo(e){for(;e===na;)na=Rs[--Bs],Rs[Bs]=null,sa=Rs[--Bs],Rs[Bs]=null;for(;e===xs;)xs=Vt[--Kt],Vt[Kt]=null,wn=Vt[--Kt],Vt[Kt]=null,jn=Vt[--Kt],Vt[Kt]=null}var qt=null,Dt=null,Ze=!1,ln=null;function lf(e,n){var s=Qt(5,null,null,0);s.elementType="DELETED",s.stateNode=n,s.return=e,n=e.deletions,n===null?(e.deletions=[s],e.flags|=16):n.push(s)}function id(e,n){switch(e.tag){case 5:var s=e.type;return n=n.nodeType!==1||s.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,qt=e,Dt=Hn(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,qt=e,Dt=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(s=xs!==null?{id:jn,overflow:wn}:null,e.memoizedState={dehydrated:n,treeContext:s,retryLane:1073741824},s=Qt(18,null,null,0),s.stateNode=n,s.return=e,e.child=s,qt=e,Dt=null,!0):!1;default:return!1}}function so(e){return(e.mode&1)!==0&&(e.flags&128)===0}function lo(e){if(Ze){var n=Dt;if(n){var s=n;if(!id(e,n)){if(so(e))throw Error(ee(418));n=Hn(s.nextSibling);var l=qt;n&&id(e,n)?lf(l,s):(e.flags=e.flags&-4097|2,Ze=!1,qt=e)}}else{if(so(e))throw Error(ee(418));e.flags=e.flags&-4097|2,Ze=!1,qt=e}}}function od(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qt=e}function yr(e){if(e!==qt)return!1;if(!Ze)return od(e),Ze=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!Zi(e.type,e.memoizedProps)),n&&(n=Dt)){if(so(e))throw rf(),Error(ee(418));for(;n;)lf(e,n),n=Hn(n.nextSibling)}if(od(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ee(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(n===0){Dt=Hn(e.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++}e=e.nextSibling}Dt=null}}else Dt=qt?Hn(e.stateNode.nextSibling):null;return!0}function rf(){for(var e=Dt;e;)e=Hn(e.nextSibling)}function Qs(){Dt=qt=null,Ze=!1}function Ko(e){ln===null?ln=[e]:ln.push(e)}var nh=Tn.ReactCurrentBatchConfig;function fl(e,n,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(ee(309));var l=s.stateNode}if(!l)throw Error(ee(147,e));var r=l,a=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===a?n.ref:(n=function(i){var o=r.refs;i===null?delete o[a]:o[a]=i},n._stringRef=a,n)}if(typeof e!="string")throw Error(ee(284));if(!s._owner)throw Error(ee(290,e))}return e}function br(e,n){throw e=Object.prototype.toString.call(n),Error(ee(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function cd(e){var n=e._init;return n(e._payload)}function af(e){function n(g,x){if(e){var j=g.deletions;j===null?(g.deletions=[x],g.flags|=16):j.push(x)}}function s(g,x){if(!e)return null;for(;x!==null;)n(g,x),x=x.sibling;return null}function l(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function r(g,x){return g=Jn(g,x),g.index=0,g.sibling=null,g}function a(g,x,j){return g.index=j,e?(j=g.alternate,j!==null?(j=j.index,j<x?(g.flags|=2,x):j):(g.flags|=2,x)):(g.flags|=1048576,x)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,x,j,w){return x===null||x.tag!==6?(x=hi(j,g.mode,w),x.return=g,x):(x=r(x,j),x.return=g,x)}function c(g,x,j,w){var k=j.type;return k===Es?u(g,x,j.props.children,w,j.key):x!==null&&(x.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===$n&&cd(k)===x.type)?(w=r(x,j.props),w.ref=fl(g,x,j),w.return=g,w):(w=Gr(j.type,j.key,j.props,null,g.mode,w),w.ref=fl(g,x,j),w.return=g,w)}function d(g,x,j,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==j.containerInfo||x.stateNode.implementation!==j.implementation?(x=yi(j,g.mode,w),x.return=g,x):(x=r(x,j.children||[]),x.return=g,x)}function u(g,x,j,w,k){return x===null||x.tag!==7?(x=ms(j,g.mode,w,k),x.return=g,x):(x=r(x,j),x.return=g,x)}function p(g,x,j){if(typeof x=="string"&&x!==""||typeof x=="number")return x=hi(""+x,g.mode,j),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case or:return j=Gr(x.type,x.key,x.props,null,g.mode,j),j.ref=fl(g,null,x),j.return=g,j;case Is:return x=yi(x,g.mode,j),x.return=g,x;case $n:var w=x._init;return p(g,w(x._payload),j)}if(hl(x)||ol(x))return x=ms(x,g.mode,j,null),x.return=g,x;br(g,x)}return null}function m(g,x,j,w){var k=x!==null?x.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return k!==null?null:o(g,x,""+j,w);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case or:return j.key===k?c(g,x,j,w):null;case Is:return j.key===k?d(g,x,j,w):null;case $n:return k=j._init,m(g,x,k(j._payload),w)}if(hl(j)||ol(j))return k!==null?null:u(g,x,j,w,null);br(g,j)}return null}function h(g,x,j,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(j)||null,o(x,g,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case or:return g=g.get(w.key===null?j:w.key)||null,c(x,g,w,k);case Is:return g=g.get(w.key===null?j:w.key)||null,d(x,g,w,k);case $n:var C=w._init;return h(g,x,j,C(w._payload),k)}if(hl(w)||ol(w))return g=g.get(j)||null,u(x,g,w,k,null);br(x,w)}return null}function y(g,x,j,w){for(var k=null,C=null,S=x,P=x=0,_=null;S!==null&&P<j.length;P++){S.index>P?(_=S,S=null):_=S.sibling;var I=m(g,S,j[P],w);if(I===null){S===null&&(S=_);break}e&&S&&I.alternate===null&&n(g,S),x=a(I,x,P),C===null?k=I:C.sibling=I,C=I,S=_}if(P===j.length)return s(g,S),Ze&&as(g,P),k;if(S===null){for(;P<j.length;P++)S=p(g,j[P],w),S!==null&&(x=a(S,x,P),C===null?k=S:C.sibling=S,C=S);return Ze&&as(g,P),k}for(S=l(g,S);P<j.length;P++)_=h(S,g,P,j[P],w),_!==null&&(e&&_.alternate!==null&&S.delete(_.key===null?P:_.key),x=a(_,x,P),C===null?k=_:C.sibling=_,C=_);return e&&S.forEach(function(T){return n(g,T)}),Ze&&as(g,P),k}function v(g,x,j,w){var k=ol(j);if(typeof k!="function")throw Error(ee(150));if(j=k.call(j),j==null)throw Error(ee(151));for(var C=k=null,S=x,P=x=0,_=null,I=j.next();S!==null&&!I.done;P++,I=j.next()){S.index>P?(_=S,S=null):_=S.sibling;var T=m(g,S,I.value,w);if(T===null){S===null&&(S=_);break}e&&S&&T.alternate===null&&n(g,S),x=a(T,x,P),C===null?k=T:C.sibling=T,C=T,S=_}if(I.done)return s(g,S),Ze&&as(g,P),k;if(S===null){for(;!I.done;P++,I=j.next())I=p(g,I.value,w),I!==null&&(x=a(I,x,P),C===null?k=I:C.sibling=I,C=I);return Ze&&as(g,P),k}for(S=l(g,S);!I.done;P++,I=j.next())I=h(S,g,P,I.value,w),I!==null&&(e&&I.alternate!==null&&S.delete(I.key===null?P:I.key),x=a(I,x,P),C===null?k=I:C.sibling=I,C=I);return e&&S.forEach(function(B){return n(g,B)}),Ze&&as(g,P),k}function b(g,x,j,w){if(typeof j=="object"&&j!==null&&j.type===Es&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case or:e:{for(var k=j.key,C=x;C!==null;){if(C.key===k){if(k=j.type,k===Es){if(C.tag===7){s(g,C.sibling),x=r(C,j.props.children),x.return=g,g=x;break e}}else if(C.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===$n&&cd(k)===C.type){s(g,C.sibling),x=r(C,j.props),x.ref=fl(g,C,j),x.return=g,g=x;break e}s(g,C);break}else n(g,C);C=C.sibling}j.type===Es?(x=ms(j.props.children,g.mode,w,j.key),x.return=g,g=x):(w=Gr(j.type,j.key,j.props,null,g.mode,w),w.ref=fl(g,x,j),w.return=g,g=w)}return i(g);case Is:e:{for(C=j.key;x!==null;){if(x.key===C)if(x.tag===4&&x.stateNode.containerInfo===j.containerInfo&&x.stateNode.implementation===j.implementation){s(g,x.sibling),x=r(x,j.children||[]),x.return=g,g=x;break e}else{s(g,x);break}else n(g,x);x=x.sibling}x=yi(j,g.mode,w),x.return=g,g=x}return i(g);case $n:return C=j._init,b(g,x,C(j._payload),w)}if(hl(j))return y(g,x,j,w);if(ol(j))return v(g,x,j,w);br(g,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,x!==null&&x.tag===6?(s(g,x.sibling),x=r(x,j),x.return=g,g=x):(s(g,x),x=hi(j,g.mode,w),x.return=g,g=x),i(g)):s(g,x)}return b}var Js=af(!0),of=af(!1),la=ts(null),ra=null,Ls=null,Qo=null;function Jo(){Qo=Ls=ra=null}function Yo(e){var n=la.current;Xe(la),e._currentValue=n}function ro(e,n,s){for(;e!==null;){var l=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,l!==null&&(l.childLanes|=n)):l!==null&&(l.childLanes&n)!==n&&(l.childLanes|=n),e===s)break;e=e.return}}function Gs(e,n){ra=e,Qo=Ls=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(Rt=!0),e.firstContext=null)}function Yt(e){var n=e._currentValue;if(Qo!==e)if(e={context:e,memoizedValue:n,next:null},Ls===null){if(ra===null)throw Error(ee(308));Ls=e,ra.dependencies={lanes:0,firstContext:e}}else Ls=Ls.next=e;return n}var cs=null;function Xo(e){cs===null?cs=[e]:cs.push(e)}function cf(e,n,s,l){var r=n.interleaved;return r===null?(s.next=s,Xo(n)):(s.next=r.next,r.next=s),n.interleaved=s,Cn(e,l)}function Cn(e,n){e.lanes|=n;var s=e.alternate;for(s!==null&&(s.lanes|=n),s=e,e=e.return;e!==null;)e.childLanes|=n,s=e.alternate,s!==null&&(s.childLanes|=n),s=e,e=e.return;return s.tag===3?s.stateNode:null}var On=!1;function Zo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function df(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nn(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Vn(e,n,s){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,Oe&2){var r=l.pending;return r===null?n.next=n:(n.next=r.next,r.next=n),l.pending=n,Cn(e,s)}return r=l.interleaved,r===null?(n.next=n,Xo(l)):(n.next=r.next,r.next=n),l.interleaved=n,Cn(e,s)}function Or(e,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194240)!==0)){var l=n.lanes;l&=e.pendingLanes,s|=l,n.lanes=s,Oo(e,s)}}function dd(e,n){var s=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var r=null,a=null;if(s=s.firstBaseUpdate,s!==null){do{var i={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};a===null?r=a=i:a=a.next=i,s=s.next}while(s!==null);a===null?r=a=n:a=a.next=n}else r=a=n;s={baseState:l.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:l.shared,effects:l.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=n:e.next=n,s.lastBaseUpdate=n}function aa(e,n,s,l){var r=e.updateQueue;On=!1;var a=r.firstBaseUpdate,i=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var c=o,d=c.next;c.next=null,i===null?a=d:i.next=d,i=c;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=d:o.next=d,u.lastBaseUpdate=c))}if(a!==null){var p=r.baseState;i=0,u=d=c=null,o=a;do{var m=o.lane,h=o.eventTime;if((l&m)===m){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=e,v=o;switch(m=n,h=s,v.tag){case 1:if(y=v.payload,typeof y=="function"){p=y.call(h,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,m=typeof y=="function"?y.call(h,p,m):y,m==null)break e;p=nt({},p,m);break e;case 2:On=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=r.effects,m===null?r.effects=[o]:m.push(o))}else h={eventTime:h,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(d=u=h,c=p):u=u.next=h,i|=m;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;m=o,o=m.next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}while(!0);if(u===null&&(c=p),r.baseState=c,r.firstBaseUpdate=d,r.lastBaseUpdate=u,n=r.shared.interleaved,n!==null){r=n;do i|=r.lane,r=r.next;while(r!==n)}else a===null&&(r.shared.lanes=0);gs|=i,e.lanes=i,e.memoizedState=p}}function ud(e,n,s){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var l=e[n],r=l.callback;if(r!==null){if(l.callback=null,l=s,typeof r!="function")throw Error(ee(191,r));r.call(l)}}}var sr={},hn=ts(sr),Fl=ts(sr),Gl=ts(sr);function ds(e){if(e===sr)throw Error(ee(174));return e}function ec(e,n){switch(Qe(Gl,n),Qe(Fl,e),Qe(hn,sr),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:Di(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=Di(n,e)}Xe(hn),Qe(hn,n)}function Ys(){Xe(hn),Xe(Fl),Xe(Gl)}function uf(e){ds(Gl.current);var n=ds(hn.current),s=Di(n,e.type);n!==s&&(Qe(Fl,e),Qe(hn,s))}function tc(e){Fl.current===e&&(Xe(hn),Xe(Fl))}var et=ts(0);function ia(e){for(var n=e;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var ui=[];function nc(){for(var e=0;e<ui.length;e++)ui[e]._workInProgressVersionPrimary=null;ui.length=0}var Dr=Tn.ReactCurrentDispatcher,mi=Tn.ReactCurrentBatchConfig,ps=0,tt=null,dt=null,ft=null,oa=!1,Sl=!1,Wl=0,sh=0;function jt(){throw Error(ee(321))}function sc(e,n){if(n===null)return!1;for(var s=0;s<n.length&&s<e.length;s++)if(!on(e[s],n[s]))return!1;return!0}function lc(e,n,s,l,r,a){if(ps=a,tt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Dr.current=e===null||e.memoizedState===null?ih:oh,e=s(l,r),Sl){a=0;do{if(Sl=!1,Wl=0,25<=a)throw Error(ee(301));a+=1,ft=dt=null,n.updateQueue=null,Dr.current=ch,e=s(l,r)}while(Sl)}if(Dr.current=ca,n=dt!==null&&dt.next!==null,ps=0,ft=dt=tt=null,oa=!1,n)throw Error(ee(300));return e}function rc(){var e=Wl!==0;return Wl=0,e}function xn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ft===null?tt.memoizedState=ft=e:ft=ft.next=e,ft}function Xt(){if(dt===null){var e=tt.alternate;e=e!==null?e.memoizedState:null}else e=dt.next;var n=ft===null?tt.memoizedState:ft.next;if(n!==null)ft=n,dt=e;else{if(e===null)throw Error(ee(310));dt=e,e={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},ft===null?tt.memoizedState=ft=e:ft=ft.next=e}return ft}function Hl(e,n){return typeof n=="function"?n(e):n}function fi(e){var n=Xt(),s=n.queue;if(s===null)throw Error(ee(311));s.lastRenderedReducer=e;var l=dt,r=l.baseQueue,a=s.pending;if(a!==null){if(r!==null){var i=r.next;r.next=a.next,a.next=i}l.baseQueue=r=a,s.pending=null}if(r!==null){a=r.next,l=l.baseState;var o=i=null,c=null,d=a;do{var u=d.lane;if((ps&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),l=d.hasEagerState?d.eagerState:e(l,d.action);else{var p={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=p,i=l):c=c.next=p,tt.lanes|=u,gs|=u}d=d.next}while(d!==null&&d!==a);c===null?i=l:c.next=o,on(l,n.memoizedState)||(Rt=!0),n.memoizedState=l,n.baseState=i,n.baseQueue=c,s.lastRenderedState=l}if(e=s.interleaved,e!==null){r=e;do a=r.lane,tt.lanes|=a,gs|=a,r=r.next;while(r!==e)}else r===null&&(s.lanes=0);return[n.memoizedState,s.dispatch]}function xi(e){var n=Xt(),s=n.queue;if(s===null)throw Error(ee(311));s.lastRenderedReducer=e;var l=s.dispatch,r=s.pending,a=n.memoizedState;if(r!==null){s.pending=null;var i=r=r.next;do a=e(a,i.action),i=i.next;while(i!==r);on(a,n.memoizedState)||(Rt=!0),n.memoizedState=a,n.baseQueue===null&&(n.baseState=a),s.lastRenderedState=a}return[a,l]}function mf(){}function ff(e,n){var s=tt,l=Xt(),r=n(),a=!on(l.memoizedState,r);if(a&&(l.memoizedState=r,Rt=!0),l=l.queue,ac(gf.bind(null,s,l,e),[e]),l.getSnapshot!==n||a||ft!==null&&ft.memoizedState.tag&1){if(s.flags|=2048,Vl(9,pf.bind(null,s,l,r,n),void 0,null),pt===null)throw Error(ee(349));ps&30||xf(s,n,r)}return r}function xf(e,n,s){e.flags|=16384,e={getSnapshot:n,value:s},n=tt.updateQueue,n===null?(n={lastEffect:null,stores:null},tt.updateQueue=n,n.stores=[e]):(s=n.stores,s===null?n.stores=[e]:s.push(e))}function pf(e,n,s,l){n.value=s,n.getSnapshot=l,hf(n)&&yf(e)}function gf(e,n,s){return s(function(){hf(n)&&yf(e)})}function hf(e){var n=e.getSnapshot;e=e.value;try{var s=n();return!on(e,s)}catch{return!0}}function yf(e){var n=Cn(e,1);n!==null&&an(n,e,1,-1)}function md(e){var n=xn();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hl,lastRenderedState:e},n.queue=e,e=e.dispatch=ah.bind(null,tt,e),[n.memoizedState,e]}function Vl(e,n,s,l){return e={tag:e,create:n,destroy:s,deps:l,next:null},n=tt.updateQueue,n===null?(n={lastEffect:null,stores:null},tt.updateQueue=n,n.lastEffect=e.next=e):(s=n.lastEffect,s===null?n.lastEffect=e.next=e:(l=s.next,s.next=e,e.next=l,n.lastEffect=e)),e}function bf(){return Xt().memoizedState}function qr(e,n,s,l){var r=xn();tt.flags|=e,r.memoizedState=Vl(1|n,s,void 0,l===void 0?null:l)}function Ia(e,n,s,l){var r=Xt();l=l===void 0?null:l;var a=void 0;if(dt!==null){var i=dt.memoizedState;if(a=i.destroy,l!==null&&sc(l,i.deps)){r.memoizedState=Vl(n,s,a,l);return}}tt.flags|=e,r.memoizedState=Vl(1|n,s,a,l)}function fd(e,n){return qr(8390656,8,e,n)}function ac(e,n){return Ia(2048,8,e,n)}function vf(e,n){return Ia(4,2,e,n)}function jf(e,n){return Ia(4,4,e,n)}function wf(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Nf(e,n,s){return s=s!=null?s.concat([e]):null,Ia(4,4,wf.bind(null,n,e),s)}function ic(){}function kf(e,n){var s=Xt();n=n===void 0?null:n;var l=s.memoizedState;return l!==null&&n!==null&&sc(n,l[1])?l[0]:(s.memoizedState=[e,n],e)}function Sf(e,n){var s=Xt();n=n===void 0?null:n;var l=s.memoizedState;return l!==null&&n!==null&&sc(n,l[1])?l[0]:(e=e(),s.memoizedState=[e,n],e)}function Cf(e,n,s){return ps&21?(on(s,n)||(s=Tm(),tt.lanes|=s,gs|=s,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,Rt=!0),e.memoizedState=s)}function lh(e,n){var s=Fe;Fe=s!==0&&4>s?s:4,e(!0);var l=mi.transition;mi.transition={};try{e(!1),n()}finally{Fe=s,mi.transition=l}}function If(){return Xt().memoizedState}function rh(e,n,s){var l=Qn(e);if(s={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null},Ef(e))Pf(n,s);else if(s=cf(e,n,s,l),s!==null){var r=Et();an(s,e,l,r),Tf(s,n,l)}}function ah(e,n,s){var l=Qn(e),r={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null};if(Ef(e))Pf(n,r);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=n.lastRenderedReducer,a!==null))try{var i=n.lastRenderedState,o=a(i,s);if(r.hasEagerState=!0,r.eagerState=o,on(o,i)){var c=n.interleaved;c===null?(r.next=r,Xo(n)):(r.next=c.next,c.next=r),n.interleaved=r;return}}catch{}finally{}s=cf(e,n,r,l),s!==null&&(r=Et(),an(s,e,l,r),Tf(s,n,l))}}function Ef(e){var n=e.alternate;return e===tt||n!==null&&n===tt}function Pf(e,n){Sl=oa=!0;var s=e.pending;s===null?n.next=n:(n.next=s.next,s.next=n),e.pending=n}function Tf(e,n,s){if(s&4194240){var l=n.lanes;l&=e.pendingLanes,s|=l,n.lanes=s,Oo(e,s)}}var ca={readContext:Yt,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useInsertionEffect:jt,useLayoutEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useMutableSource:jt,useSyncExternalStore:jt,useId:jt,unstable_isNewReconciler:!1},ih={readContext:Yt,useCallback:function(e,n){return xn().memoizedState=[e,n===void 0?null:n],e},useContext:Yt,useEffect:fd,useImperativeHandle:function(e,n,s){return s=s!=null?s.concat([e]):null,qr(4194308,4,wf.bind(null,n,e),s)},useLayoutEffect:function(e,n){return qr(4194308,4,e,n)},useInsertionEffect:function(e,n){return qr(4,2,e,n)},useMemo:function(e,n){var s=xn();return n=n===void 0?null:n,e=e(),s.memoizedState=[e,n],e},useReducer:function(e,n,s){var l=xn();return n=s!==void 0?s(n):n,l.memoizedState=l.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},l.queue=e,e=e.dispatch=rh.bind(null,tt,e),[l.memoizedState,e]},useRef:function(e){var n=xn();return e={current:e},n.memoizedState=e},useState:md,useDebugValue:ic,useDeferredValue:function(e){return xn().memoizedState=e},useTransition:function(){var e=md(!1),n=e[0];return e=lh.bind(null,e[1]),xn().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,s){var l=tt,r=xn();if(Ze){if(s===void 0)throw Error(ee(407));s=s()}else{if(s=n(),pt===null)throw Error(ee(349));ps&30||xf(l,n,s)}r.memoizedState=s;var a={value:s,getSnapshot:n};return r.queue=a,fd(gf.bind(null,l,a,e),[e]),l.flags|=2048,Vl(9,pf.bind(null,l,a,s,n),void 0,null),s},useId:function(){var e=xn(),n=pt.identifierPrefix;if(Ze){var s=wn,l=jn;s=(l&~(1<<32-rn(l)-1)).toString(32)+s,n=":"+n+"R"+s,s=Wl++,0<s&&(n+="H"+s.toString(32)),n+=":"}else s=sh++,n=":"+n+"r"+s.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},oh={readContext:Yt,useCallback:kf,useContext:Yt,useEffect:ac,useImperativeHandle:Nf,useInsertionEffect:vf,useLayoutEffect:jf,useMemo:Sf,useReducer:fi,useRef:bf,useState:function(){return fi(Hl)},useDebugValue:ic,useDeferredValue:function(e){var n=Xt();return Cf(n,dt.memoizedState,e)},useTransition:function(){var e=fi(Hl)[0],n=Xt().memoizedState;return[e,n]},useMutableSource:mf,useSyncExternalStore:ff,useId:If,unstable_isNewReconciler:!1},ch={readContext:Yt,useCallback:kf,useContext:Yt,useEffect:ac,useImperativeHandle:Nf,useInsertionEffect:vf,useLayoutEffect:jf,useMemo:Sf,useReducer:xi,useRef:bf,useState:function(){return xi(Hl)},useDebugValue:ic,useDeferredValue:function(e){var n=Xt();return dt===null?n.memoizedState=e:Cf(n,dt.memoizedState,e)},useTransition:function(){var e=xi(Hl)[0],n=Xt().memoizedState;return[e,n]},useMutableSource:mf,useSyncExternalStore:ff,useId:If,unstable_isNewReconciler:!1};function nn(e,n){if(e&&e.defaultProps){n=nt({},n),e=e.defaultProps;for(var s in e)n[s]===void 0&&(n[s]=e[s]);return n}return n}function ao(e,n,s,l){n=e.memoizedState,s=s(l,n),s=s==null?n:nt({},n,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Ea={isMounted:function(e){return(e=e._reactInternals)?bs(e)===e:!1},enqueueSetState:function(e,n,s){e=e._reactInternals;var l=Et(),r=Qn(e),a=Nn(l,r);a.payload=n,s!=null&&(a.callback=s),n=Vn(e,a,r),n!==null&&(an(n,e,r,l),Or(n,e,r))},enqueueReplaceState:function(e,n,s){e=e._reactInternals;var l=Et(),r=Qn(e),a=Nn(l,r);a.tag=1,a.payload=n,s!=null&&(a.callback=s),n=Vn(e,a,r),n!==null&&(an(n,e,r,l),Or(n,e,r))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var s=Et(),l=Qn(e),r=Nn(s,l);r.tag=2,n!=null&&(r.callback=n),n=Vn(e,r,l),n!==null&&(an(n,e,l,s),Or(n,e,l))}};function xd(e,n,s,l,r,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,a,i):n.prototype&&n.prototype.isPureReactComponent?!Dl(s,l)||!Dl(r,a):!0}function Mf(e,n,s){var l=!1,r=Zn,a=n.contextType;return typeof a=="object"&&a!==null?a=Yt(a):(r=Lt(n)?fs:kt.current,l=n.contextTypes,a=(l=l!=null)?Ks(e,r):Zn),n=new n(s,a),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Ea,e.stateNode=n,n._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),n}function pd(e,n,s,l){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,l),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,l),n.state!==e&&Ea.enqueueReplaceState(n,n.state,null)}function io(e,n,s,l){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},Zo(e);var a=n.contextType;typeof a=="object"&&a!==null?r.context=Yt(a):(a=Lt(n)?fs:kt.current,r.context=Ks(e,a)),r.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(ao(e,n,a,s),r.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(n=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),n!==r.state&&Ea.enqueueReplaceState(r,r.state,null),aa(e,s,r,l),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Xs(e,n){try{var s="",l=n;do s+=$p(l),l=l.return;while(l);var r=s}catch(a){r=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:n,stack:r,digest:null}}function pi(e,n,s){return{value:e,source:null,stack:s??null,digest:n??null}}function oo(e,n){try{console.error(n.value)}catch(s){setTimeout(function(){throw s})}}var dh=typeof WeakMap=="function"?WeakMap:Map;function _f(e,n,s){s=Nn(-1,s),s.tag=3,s.payload={element:null};var l=n.value;return s.callback=function(){ua||(ua=!0,bo=l),oo(e,n)},s}function Af(e,n,s){s=Nn(-1,s),s.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var r=n.value;s.payload=function(){return l(r)},s.callback=function(){oo(e,n)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(s.callback=function(){oo(e,n),typeof l!="function"&&(Kn===null?Kn=new Set([this]):Kn.add(this));var i=n.stack;this.componentDidCatch(n.value,{componentStack:i!==null?i:""})}),s}function gd(e,n,s){var l=e.pingCache;if(l===null){l=e.pingCache=new dh;var r=new Set;l.set(n,r)}else r=l.get(n),r===void 0&&(r=new Set,l.set(n,r));r.has(s)||(r.add(s),e=kh.bind(null,e,n,s),n.then(e,e))}function hd(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function yd(e,n,s,l,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===n?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(n=Nn(-1,1),n.tag=2,Vn(s,n,1))),s.lanes|=1),e)}var uh=Tn.ReactCurrentOwner,Rt=!1;function It(e,n,s,l){n.child=e===null?of(n,null,s,l):Js(n,e.child,s,l)}function bd(e,n,s,l,r){s=s.render;var a=n.ref;return Gs(n,r),l=lc(e,n,s,l,a,r),s=rc(),e!==null&&!Rt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r,In(e,n,r)):(Ze&&s&&Ho(n),n.flags|=1,It(e,n,l,r),n.child)}function vd(e,n,s,l,r){if(e===null){var a=s.type;return typeof a=="function"&&!pc(a)&&a.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(n.tag=15,n.type=a,Rf(e,n,a,l,r)):(e=Gr(s.type,null,l,n,n.mode,r),e.ref=n.ref,e.return=n,n.child=e)}if(a=e.child,!(e.lanes&r)){var i=a.memoizedProps;if(s=s.compare,s=s!==null?s:Dl,s(i,l)&&e.ref===n.ref)return In(e,n,r)}return n.flags|=1,e=Jn(a,l),e.ref=n.ref,e.return=n,n.child=e}function Rf(e,n,s,l,r){if(e!==null){var a=e.memoizedProps;if(Dl(a,l)&&e.ref===n.ref)if(Rt=!1,n.pendingProps=l=a,(e.lanes&r)!==0)e.flags&131072&&(Rt=!0);else return n.lanes=e.lanes,In(e,n,r)}return co(e,n,s,l,r)}function Bf(e,n,s){var l=n.pendingProps,r=l.children,a=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(Os,Ot),Ot|=s;else{if(!(s&1073741824))return e=a!==null?a.baseLanes|s:s,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,Qe(Os,Ot),Ot|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=a!==null?a.baseLanes:s,Qe(Os,Ot),Ot|=l}else a!==null?(l=a.baseLanes|s,n.memoizedState=null):l=s,Qe(Os,Ot),Ot|=l;return It(e,n,r,s),n.child}function Lf(e,n){var s=n.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(n.flags|=512,n.flags|=2097152)}function co(e,n,s,l,r){var a=Lt(s)?fs:kt.current;return a=Ks(n,a),Gs(n,r),s=lc(e,n,s,l,a,r),l=rc(),e!==null&&!Rt?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~r,In(e,n,r)):(Ze&&l&&Ho(n),n.flags|=1,It(e,n,s,r),n.child)}function jd(e,n,s,l,r){if(Lt(s)){var a=!0;ta(n)}else a=!1;if(Gs(n,r),n.stateNode===null)Ur(e,n),Mf(n,s,l),io(n,s,l,r),l=!0;else if(e===null){var i=n.stateNode,o=n.memoizedProps;i.props=o;var c=i.context,d=s.contextType;typeof d=="object"&&d!==null?d=Yt(d):(d=Lt(s)?fs:kt.current,d=Ks(n,d));var u=s.getDerivedStateFromProps,p=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";p||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==l||c!==d)&&pd(n,i,l,d),On=!1;var m=n.memoizedState;i.state=m,aa(n,l,i,r),c=n.memoizedState,o!==l||m!==c||Bt.current||On?(typeof u=="function"&&(ao(n,s,u,l),c=n.memoizedState),(o=On||xd(n,s,o,l,m,c,d))?(p||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(n.flags|=4194308)):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=l,n.memoizedState=c),i.props=l,i.state=c,i.context=d,l=o):(typeof i.componentDidMount=="function"&&(n.flags|=4194308),l=!1)}else{i=n.stateNode,df(e,n),o=n.memoizedProps,d=n.type===n.elementType?o:nn(n.type,o),i.props=d,p=n.pendingProps,m=i.context,c=s.contextType,typeof c=="object"&&c!==null?c=Yt(c):(c=Lt(s)?fs:kt.current,c=Ks(n,c));var h=s.getDerivedStateFromProps;(u=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==p||m!==c)&&pd(n,i,l,c),On=!1,m=n.memoizedState,i.state=m,aa(n,l,i,r);var y=n.memoizedState;o!==p||m!==y||Bt.current||On?(typeof h=="function"&&(ao(n,s,h,l),y=n.memoizedState),(d=On||xd(n,s,d,l,m,y,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(l,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(l,y,c)),typeof i.componentDidUpdate=="function"&&(n.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=1024),n.memoizedProps=l,n.memoizedState=y),i.props=l,i.state=y,i.context=c,l=d):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(n.flags|=1024),l=!1)}return uo(e,n,s,l,a,r)}function uo(e,n,s,l,r,a){Lf(e,n);var i=(n.flags&128)!==0;if(!l&&!i)return r&&ad(n,s,!1),In(e,n,a);l=n.stateNode,uh.current=n;var o=i&&typeof s.getDerivedStateFromError!="function"?null:l.render();return n.flags|=1,e!==null&&i?(n.child=Js(n,e.child,null,a),n.child=Js(n,null,o,a)):It(e,n,o,a),n.memoizedState=l.state,r&&ad(n,s,!0),n.child}function $f(e){var n=e.stateNode;n.pendingContext?rd(e,n.pendingContext,n.pendingContext!==n.context):n.context&&rd(e,n.context,!1),ec(e,n.containerInfo)}function wd(e,n,s,l,r){return Qs(),Ko(r),n.flags|=256,It(e,n,s,l),n.child}var mo={dehydrated:null,treeContext:null,retryLane:0};function fo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Of(e,n,s){var l=n.pendingProps,r=et.current,a=!1,i=(n.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(r&2)!==0),o?(a=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),Qe(et,r&1),e===null)return lo(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(i=l.children,e=l.fallback,a?(l=n.mode,a=n.child,i={mode:"hidden",children:i},!(l&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Ma(i,l,0,null),e=ms(e,l,s,null),a.return=n,e.return=n,a.sibling=e,n.child=a,n.child.memoizedState=fo(s),n.memoizedState=mo,e):oc(n,i));if(r=e.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return mh(e,n,i,l,o,r,s);if(a){a=l.fallback,i=n.mode,r=e.child,o=r.sibling;var c={mode:"hidden",children:l.children};return!(i&1)&&n.child!==r?(l=n.child,l.childLanes=0,l.pendingProps=c,n.deletions=null):(l=Jn(r,c),l.subtreeFlags=r.subtreeFlags&14680064),o!==null?a=Jn(o,a):(a=ms(a,i,s,null),a.flags|=2),a.return=n,l.return=n,l.sibling=a,n.child=l,l=a,a=n.child,i=e.child.memoizedState,i=i===null?fo(s):{baseLanes:i.baseLanes|s,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~s,n.memoizedState=mo,l}return a=e.child,e=a.sibling,l=Jn(a,{mode:"visible",children:l.children}),!(n.mode&1)&&(l.lanes=s),l.return=n,l.sibling=null,e!==null&&(s=n.deletions,s===null?(n.deletions=[e],n.flags|=16):s.push(e)),n.child=l,n.memoizedState=null,l}function oc(e,n){return n=Ma({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function vr(e,n,s,l){return l!==null&&Ko(l),Js(n,e.child,null,s),e=oc(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function mh(e,n,s,l,r,a,i){if(s)return n.flags&256?(n.flags&=-257,l=pi(Error(ee(422))),vr(e,n,i,l)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(a=l.fallback,r=n.mode,l=Ma({mode:"visible",children:l.children},r,0,null),a=ms(a,r,i,null),a.flags|=2,l.return=n,a.return=n,l.sibling=a,n.child=l,n.mode&1&&Js(n,e.child,null,i),n.child.memoizedState=fo(i),n.memoizedState=mo,a);if(!(n.mode&1))return vr(e,n,i,null);if(r.data==="$!"){if(l=r.nextSibling&&r.nextSibling.dataset,l)var o=l.dgst;return l=o,a=Error(ee(419)),l=pi(a,l,void 0),vr(e,n,i,l)}if(o=(i&e.childLanes)!==0,Rt||o){if(l=pt,l!==null){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(l.suspendedLanes|i)?0:r,r!==0&&r!==a.retryLane&&(a.retryLane=r,Cn(e,r),an(l,e,r,-1))}return xc(),l=pi(Error(ee(421))),vr(e,n,i,l)}return r.data==="$?"?(n.flags|=128,n.child=e.child,n=Sh.bind(null,e),r._reactRetry=n,null):(e=a.treeContext,Dt=Hn(r.nextSibling),qt=n,Ze=!0,ln=null,e!==null&&(Vt[Kt++]=jn,Vt[Kt++]=wn,Vt[Kt++]=xs,jn=e.id,wn=e.overflow,xs=n),n=oc(n,l.children),n.flags|=4096,n)}function Nd(e,n,s){e.lanes|=n;var l=e.alternate;l!==null&&(l.lanes|=n),ro(e.return,n,s)}function gi(e,n,s,l,r){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:r}:(a.isBackwards=n,a.rendering=null,a.renderingStartTime=0,a.last=l,a.tail=s,a.tailMode=r)}function Df(e,n,s){var l=n.pendingProps,r=l.revealOrder,a=l.tail;if(It(e,n,l.children,s),l=et.current,l&2)l=l&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Nd(e,s,n);else if(e.tag===19)Nd(e,s,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Qe(et,l),!(n.mode&1))n.memoizedState=null;else switch(r){case"forwards":for(s=n.child,r=null;s!==null;)e=s.alternate,e!==null&&ia(e)===null&&(r=s),s=s.sibling;s=r,s===null?(r=n.child,n.child=null):(r=s.sibling,s.sibling=null),gi(n,!1,r,s,a);break;case"backwards":for(s=null,r=n.child,n.child=null;r!==null;){if(e=r.alternate,e!==null&&ia(e)===null){n.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}gi(n,!0,s,null,a);break;case"together":gi(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Ur(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function In(e,n,s){if(e!==null&&(n.dependencies=e.dependencies),gs|=n.lanes,!(s&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(ee(153));if(n.child!==null){for(e=n.child,s=Jn(e,e.pendingProps),n.child=s,s.return=n;e.sibling!==null;)e=e.sibling,s=s.sibling=Jn(e,e.pendingProps),s.return=n;s.sibling=null}return n.child}function fh(e,n,s){switch(n.tag){case 3:$f(n),Qs();break;case 5:uf(n);break;case 1:Lt(n.type)&&ta(n);break;case 4:ec(n,n.stateNode.containerInfo);break;case 10:var l=n.type._context,r=n.memoizedProps.value;Qe(la,l._currentValue),l._currentValue=r;break;case 13:if(l=n.memoizedState,l!==null)return l.dehydrated!==null?(Qe(et,et.current&1),n.flags|=128,null):s&n.child.childLanes?Of(e,n,s):(Qe(et,et.current&1),e=In(e,n,s),e!==null?e.sibling:null);Qe(et,et.current&1);break;case 19:if(l=(s&n.childLanes)!==0,e.flags&128){if(l)return Df(e,n,s);n.flags|=128}if(r=n.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Qe(et,et.current),l)break;return null;case 22:case 23:return n.lanes=0,Bf(e,n,s)}return In(e,n,s)}var qf,xo,Uf,zf;qf=function(e,n){for(var s=n.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};xo=function(){};Uf=function(e,n,s,l){var r=e.memoizedProps;if(r!==l){e=n.stateNode,ds(hn.current);var a=null;switch(s){case"input":r=Bi(e,r),l=Bi(e,l),a=[];break;case"select":r=nt({},r,{value:void 0}),l=nt({},l,{value:void 0}),a=[];break;case"textarea":r=Oi(e,r),l=Oi(e,l),a=[];break;default:typeof r.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=Zr)}qi(s,l);var i;s=null;for(d in r)if(!l.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var o=r[d];for(i in o)o.hasOwnProperty(i)&&(s||(s={}),s[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(_l.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in l){var c=l[d];if(o=r!=null?r[d]:void 0,l.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(s||(s={}),s[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(s||(s={}),s[i]=c[i])}else s||(a||(a=[]),a.push(d,s)),s=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(_l.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ye("scroll",e),a||o===c||(a=[])):(a=a||[]).push(d,c))}s&&(a=a||[]).push("style",s);var d=a;(n.updateQueue=d)&&(n.flags|=4)}};zf=function(e,n,s,l){s!==l&&(n.flags|=4)};function xl(e,n){if(!Ze)switch(e.tailMode){case"hidden":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function wt(e){var n=e.alternate!==null&&e.alternate.child===e.child,s=0,l=0;if(n)for(var r=e.child;r!==null;)s|=r.lanes|r.childLanes,l|=r.subtreeFlags&14680064,l|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)s|=r.lanes|r.childLanes,l|=r.subtreeFlags,l|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=l,e.childLanes=s,n}function xh(e,n,s){var l=n.pendingProps;switch(Vo(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(n),null;case 1:return Lt(n.type)&&ea(),wt(n),null;case 3:return l=n.stateNode,Ys(),Xe(Bt),Xe(kt),nc(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(yr(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,ln!==null&&(wo(ln),ln=null))),xo(e,n),wt(n),null;case 5:tc(n);var r=ds(Gl.current);if(s=n.type,e!==null&&n.stateNode!=null)Uf(e,n,s,l,r),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!l){if(n.stateNode===null)throw Error(ee(166));return wt(n),null}if(e=ds(hn.current),yr(n)){l=n.stateNode,s=n.type;var a=n.memoizedProps;switch(l[pn]=n,l[zl]=a,e=(n.mode&1)!==0,s){case"dialog":Ye("cancel",l),Ye("close",l);break;case"iframe":case"object":case"embed":Ye("load",l);break;case"video":case"audio":for(r=0;r<bl.length;r++)Ye(bl[r],l);break;case"source":Ye("error",l);break;case"img":case"image":case"link":Ye("error",l),Ye("load",l);break;case"details":Ye("toggle",l);break;case"input":_c(l,a),Ye("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!a.multiple},Ye("invalid",l);break;case"textarea":Rc(l,a),Ye("invalid",l)}qi(s,a),r=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?l.textContent!==o&&(a.suppressHydrationWarning!==!0&&hr(l.textContent,o,e),r=["children",o]):typeof o=="number"&&l.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&hr(l.textContent,o,e),r=["children",""+o]):_l.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Ye("scroll",l)}switch(s){case"input":cr(l),Ac(l,a,!0);break;case"textarea":cr(l),Bc(l);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(l.onclick=Zr)}l=r,n.updateQueue=l,l!==null&&(n.flags|=4)}else{i=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=pm(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=i.createElement(s,{is:l.is}):(e=i.createElement(s),s==="select"&&(i=e,l.multiple?i.multiple=!0:l.size&&(i.size=l.size))):e=i.createElementNS(e,s),e[pn]=n,e[zl]=l,qf(e,n,!1,!1),n.stateNode=e;e:{switch(i=Ui(s,l),s){case"dialog":Ye("cancel",e),Ye("close",e),r=l;break;case"iframe":case"object":case"embed":Ye("load",e),r=l;break;case"video":case"audio":for(r=0;r<bl.length;r++)Ye(bl[r],e);r=l;break;case"source":Ye("error",e),r=l;break;case"img":case"image":case"link":Ye("error",e),Ye("load",e),r=l;break;case"details":Ye("toggle",e),r=l;break;case"input":_c(e,l),r=Bi(e,l),Ye("invalid",e);break;case"option":r=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},r=nt({},l,{value:void 0}),Ye("invalid",e);break;case"textarea":Rc(e,l),r=Oi(e,l),Ye("invalid",e);break;default:r=l}qi(s,r),o=r;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?ym(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&gm(e,c)):a==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&Al(e,c):typeof c=="number"&&Al(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(_l.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Ye("scroll",e):c!=null&&_o(e,a,c,i))}switch(s){case"input":cr(e),Ac(e,l,!1);break;case"textarea":cr(e),Bc(e);break;case"option":l.value!=null&&e.setAttribute("value",""+Xn(l.value));break;case"select":e.multiple=!!l.multiple,a=l.value,a!=null?qs(e,!!l.multiple,a,!1):l.defaultValue!=null&&qs(e,!!l.multiple,l.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=Zr)}switch(s){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return wt(n),null;case 6:if(e&&n.stateNode!=null)zf(e,n,e.memoizedProps,l);else{if(typeof l!="string"&&n.stateNode===null)throw Error(ee(166));if(s=ds(Gl.current),ds(hn.current),yr(n)){if(l=n.stateNode,s=n.memoizedProps,l[pn]=n,(a=l.nodeValue!==s)&&(e=qt,e!==null))switch(e.tag){case 3:hr(l.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hr(l.nodeValue,s,(e.mode&1)!==0)}a&&(n.flags|=4)}else l=(s.nodeType===9?s:s.ownerDocument).createTextNode(l),l[pn]=n,n.stateNode=l}return wt(n),null;case 13:if(Xe(et),l=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ze&&Dt!==null&&n.mode&1&&!(n.flags&128))rf(),Qs(),n.flags|=98560,a=!1;else if(a=yr(n),l!==null&&l.dehydrated!==null){if(e===null){if(!a)throw Error(ee(318));if(a=n.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ee(317));a[pn]=n}else Qs(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;wt(n),a=!1}else ln!==null&&(wo(ln),ln=null),a=!0;if(!a)return n.flags&65536?n:null}return n.flags&128?(n.lanes=s,n):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(n.child.flags|=8192,n.mode&1&&(e===null||et.current&1?ut===0&&(ut=3):xc())),n.updateQueue!==null&&(n.flags|=4),wt(n),null);case 4:return Ys(),xo(e,n),e===null&&ql(n.stateNode.containerInfo),wt(n),null;case 10:return Yo(n.type._context),wt(n),null;case 17:return Lt(n.type)&&ea(),wt(n),null;case 19:if(Xe(et),a=n.memoizedState,a===null)return wt(n),null;if(l=(n.flags&128)!==0,i=a.rendering,i===null)if(l)xl(a,!1);else{if(ut!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(i=ia(e),i!==null){for(n.flags|=128,xl(a,!1),l=i.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),n.subtreeFlags=0,l=s,s=n.child;s!==null;)a=s,e=l,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Qe(et,et.current&1|2),n.child}e=e.sibling}a.tail!==null&&lt()>Zs&&(n.flags|=128,l=!0,xl(a,!1),n.lanes=4194304)}else{if(!l)if(e=ia(i),e!==null){if(n.flags|=128,l=!0,s=e.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),xl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Ze)return wt(n),null}else 2*lt()-a.renderingStartTime>Zs&&s!==1073741824&&(n.flags|=128,l=!0,xl(a,!1),n.lanes=4194304);a.isBackwards?(i.sibling=n.child,n.child=i):(s=a.last,s!==null?s.sibling=i:n.child=i,a.last=i)}return a.tail!==null?(n=a.tail,a.rendering=n,a.tail=n.sibling,a.renderingStartTime=lt(),n.sibling=null,s=et.current,Qe(et,l?s&1|2:s&1),n):(wt(n),null);case 22:case 23:return fc(),l=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(n.flags|=8192),l&&n.mode&1?Ot&1073741824&&(wt(n),n.subtreeFlags&6&&(n.flags|=8192)):wt(n),null;case 24:return null;case 25:return null}throw Error(ee(156,n.tag))}function ph(e,n){switch(Vo(n),n.tag){case 1:return Lt(n.type)&&ea(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return Ys(),Xe(Bt),Xe(kt),nc(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return tc(n),null;case 13:if(Xe(et),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(ee(340));Qs()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Xe(et),null;case 4:return Ys(),null;case 10:return Yo(n.type._context),null;case 22:case 23:return fc(),null;case 24:return null;default:return null}}var jr=!1,Nt=!1,gh=typeof WeakSet=="function"?WeakSet:Set,he=null;function $s(e,n){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(l){st(e,n,l)}else s.current=null}function po(e,n,s){try{s()}catch(l){st(e,n,l)}}var kd=!1;function hh(e,n){if(Yi=Jr,e=Hm(),Wo(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var r=l.anchorOffset,a=l.focusNode;l=l.focusOffset;try{s.nodeType,a.nodeType}catch{s=null;break e}var i=0,o=-1,c=-1,d=0,u=0,p=e,m=null;t:for(;;){for(var h;p!==s||r!==0&&p.nodeType!==3||(o=i+r),p!==a||l!==0&&p.nodeType!==3||(c=i+l),p.nodeType===3&&(i+=p.nodeValue.length),(h=p.firstChild)!==null;)m=p,p=h;for(;;){if(p===e)break t;if(m===s&&++d===r&&(o=i),m===a&&++u===l&&(c=i),(h=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=h}s=o===-1||c===-1?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(Xi={focusedElem:e,selectionRange:s},Jr=!1,he=n;he!==null;)if(n=he,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,he=e;else for(;he!==null;){n=he;try{var y=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,b=y.memoizedState,g=n.stateNode,x=g.getSnapshotBeforeUpdate(n.elementType===n.type?v:nn(n.type,v),b);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var j=n.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(w){st(n,n.return,w)}if(e=n.sibling,e!==null){e.return=n.return,he=e;break}he=n.return}return y=kd,kd=!1,y}function Cl(e,n,s){var l=n.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var r=l=l.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,a!==void 0&&po(n,s,a)}r=r.next}while(r!==l)}}function Pa(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var l=s.create;s.destroy=l()}s=s.next}while(s!==n)}}function go(e){var n=e.ref;if(n!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof n=="function"?n(e):n.current=e}}function Ff(e){var n=e.alternate;n!==null&&(e.alternate=null,Ff(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[pn],delete n[zl],delete n[to],delete n[Zg],delete n[eh])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Gf(e){return e.tag===5||e.tag===3||e.tag===4}function Sd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Gf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ho(e,n,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?s.nodeType===8?s.parentNode.insertBefore(e,n):s.insertBefore(e,n):(s.nodeType===8?(n=s.parentNode,n.insertBefore(e,s)):(n=s,n.appendChild(e)),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=Zr));else if(l!==4&&(e=e.child,e!==null))for(ho(e,n,s),e=e.sibling;e!==null;)ho(e,n,s),e=e.sibling}function yo(e,n,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,n?s.insertBefore(e,n):s.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(yo(e,n,s),e=e.sibling;e!==null;)yo(e,n,s),e=e.sibling}var gt=null,sn=!1;function _n(e,n,s){for(s=s.child;s!==null;)Wf(e,n,s),s=s.sibling}function Wf(e,n,s){if(gn&&typeof gn.onCommitFiberUnmount=="function")try{gn.onCommitFiberUnmount(ja,s)}catch{}switch(s.tag){case 5:Nt||$s(s,n);case 6:var l=gt,r=sn;gt=null,_n(e,n,s),gt=l,sn=r,gt!==null&&(sn?(e=gt,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):gt.removeChild(s.stateNode));break;case 18:gt!==null&&(sn?(e=gt,s=s.stateNode,e.nodeType===8?ci(e.parentNode,s):e.nodeType===1&&ci(e,s),$l(e)):ci(gt,s.stateNode));break;case 4:l=gt,r=sn,gt=s.stateNode.containerInfo,sn=!0,_n(e,n,s),gt=l,sn=r;break;case 0:case 11:case 14:case 15:if(!Nt&&(l=s.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){r=l=l.next;do{var a=r,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&po(s,n,i),r=r.next}while(r!==l)}_n(e,n,s);break;case 1:if(!Nt&&($s(s,n),l=s.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=s.memoizedProps,l.state=s.memoizedState,l.componentWillUnmount()}catch(o){st(s,n,o)}_n(e,n,s);break;case 21:_n(e,n,s);break;case 22:s.mode&1?(Nt=(l=Nt)||s.memoizedState!==null,_n(e,n,s),Nt=l):_n(e,n,s);break;default:_n(e,n,s)}}function Cd(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new gh),n.forEach(function(l){var r=Ch.bind(null,e,l);s.has(l)||(s.add(l),l.then(r,r))})}}function tn(e,n){var s=n.deletions;if(s!==null)for(var l=0;l<s.length;l++){var r=s[l];try{var a=e,i=n,o=i;e:for(;o!==null;){switch(o.tag){case 5:gt=o.stateNode,sn=!1;break e;case 3:gt=o.stateNode.containerInfo,sn=!0;break e;case 4:gt=o.stateNode.containerInfo,sn=!0;break e}o=o.return}if(gt===null)throw Error(ee(160));Wf(a,i,r),gt=null,sn=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(d){st(r,n,d)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)Hf(n,e),n=n.sibling}function Hf(e,n){var s=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(tn(n,e),fn(e),l&4){try{Cl(3,e,e.return),Pa(3,e)}catch(v){st(e,e.return,v)}try{Cl(5,e,e.return)}catch(v){st(e,e.return,v)}}break;case 1:tn(n,e),fn(e),l&512&&s!==null&&$s(s,s.return);break;case 5:if(tn(n,e),fn(e),l&512&&s!==null&&$s(s,s.return),e.flags&32){var r=e.stateNode;try{Al(r,"")}catch(v){st(e,e.return,v)}}if(l&4&&(r=e.stateNode,r!=null)){var a=e.memoizedProps,i=s!==null?s.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&fm(r,a),Ui(o,i);var d=Ui(o,a);for(i=0;i<c.length;i+=2){var u=c[i],p=c[i+1];u==="style"?ym(r,p):u==="dangerouslySetInnerHTML"?gm(r,p):u==="children"?Al(r,p):_o(r,u,p,d)}switch(o){case"input":Li(r,a);break;case"textarea":xm(r,a);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?qs(r,!!a.multiple,h,!1):m!==!!a.multiple&&(a.defaultValue!=null?qs(r,!!a.multiple,a.defaultValue,!0):qs(r,!!a.multiple,a.multiple?[]:"",!1))}r[zl]=a}catch(v){st(e,e.return,v)}}break;case 6:if(tn(n,e),fn(e),l&4){if(e.stateNode===null)throw Error(ee(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(v){st(e,e.return,v)}}break;case 3:if(tn(n,e),fn(e),l&4&&s!==null&&s.memoizedState.isDehydrated)try{$l(n.containerInfo)}catch(v){st(e,e.return,v)}break;case 4:tn(n,e),fn(e);break;case 13:tn(n,e),fn(e),r=e.child,r.flags&8192&&(a=r.memoizedState!==null,r.stateNode.isHidden=a,!a||r.alternate!==null&&r.alternate.memoizedState!==null||(uc=lt())),l&4&&Cd(e);break;case 22:if(u=s!==null&&s.memoizedState!==null,e.mode&1?(Nt=(d=Nt)||u,tn(n,e),Nt=d):tn(n,e),fn(e),l&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(he=e,u=e.child;u!==null;){for(p=he=u;he!==null;){switch(m=he,h=m.child,m.tag){case 0:case 11:case 14:case 15:Cl(4,m,m.return);break;case 1:$s(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){l=m,s=m.return;try{n=l,y.props=n.memoizedProps,y.state=n.memoizedState,y.componentWillUnmount()}catch(v){st(l,s,v)}}break;case 5:$s(m,m.return);break;case 22:if(m.memoizedState!==null){Ed(p);continue}}h!==null?(h.return=m,he=h):Ed(p)}u=u.sibling}e:for(u=null,p=e;;){if(p.tag===5){if(u===null){u=p;try{r=p.stateNode,d?(a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,c=p.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=hm("display",i))}catch(v){st(e,e.return,v)}}}else if(p.tag===6){if(u===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(v){st(e,e.return,v)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:tn(n,e),fn(e),l&4&&Cd(e);break;case 21:break;default:tn(n,e),fn(e)}}function fn(e){var n=e.flags;if(n&2){try{e:{for(var s=e.return;s!==null;){if(Gf(s)){var l=s;break e}s=s.return}throw Error(ee(160))}switch(l.tag){case 5:var r=l.stateNode;l.flags&32&&(Al(r,""),l.flags&=-33);var a=Sd(e);yo(e,a,r);break;case 3:case 4:var i=l.stateNode.containerInfo,o=Sd(e);ho(e,o,i);break;default:throw Error(ee(161))}}catch(c){st(e,e.return,c)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function yh(e,n,s){he=e,Vf(e)}function Vf(e,n,s){for(var l=(e.mode&1)!==0;he!==null;){var r=he,a=r.child;if(r.tag===22&&l){var i=r.memoizedState!==null||jr;if(!i){var o=r.alternate,c=o!==null&&o.memoizedState!==null||Nt;o=jr;var d=Nt;if(jr=i,(Nt=c)&&!d)for(he=r;he!==null;)i=he,c=i.child,i.tag===22&&i.memoizedState!==null?Pd(r):c!==null?(c.return=i,he=c):Pd(r);for(;a!==null;)he=a,Vf(a),a=a.sibling;he=r,jr=o,Nt=d}Id(e)}else r.subtreeFlags&8772&&a!==null?(a.return=r,he=a):Id(e)}}function Id(e){for(;he!==null;){var n=he;if(n.flags&8772){var s=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Nt||Pa(5,n);break;case 1:var l=n.stateNode;if(n.flags&4&&!Nt)if(s===null)l.componentDidMount();else{var r=n.elementType===n.type?s.memoizedProps:nn(n.type,s.memoizedProps);l.componentDidUpdate(r,s.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var a=n.updateQueue;a!==null&&ud(n,a,l);break;case 3:var i=n.updateQueue;if(i!==null){if(s=null,n.child!==null)switch(n.child.tag){case 5:s=n.child.stateNode;break;case 1:s=n.child.stateNode}ud(n,i,s)}break;case 5:var o=n.stateNode;if(s===null&&n.flags&4){s=o;var c=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var d=n.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var p=u.dehydrated;p!==null&&$l(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Nt||n.flags&512&&go(n)}catch(m){st(n,n.return,m)}}if(n===e){he=null;break}if(s=n.sibling,s!==null){s.return=n.return,he=s;break}he=n.return}}function Ed(e){for(;he!==null;){var n=he;if(n===e){he=null;break}var s=n.sibling;if(s!==null){s.return=n.return,he=s;break}he=n.return}}function Pd(e){for(;he!==null;){var n=he;try{switch(n.tag){case 0:case 11:case 15:var s=n.return;try{Pa(4,n)}catch(c){st(n,s,c)}break;case 1:var l=n.stateNode;if(typeof l.componentDidMount=="function"){var r=n.return;try{l.componentDidMount()}catch(c){st(n,r,c)}}var a=n.return;try{go(n)}catch(c){st(n,a,c)}break;case 5:var i=n.return;try{go(n)}catch(c){st(n,i,c)}}}catch(c){st(n,n.return,c)}if(n===e){he=null;break}var o=n.sibling;if(o!==null){o.return=n.return,he=o;break}he=n.return}}var bh=Math.ceil,da=Tn.ReactCurrentDispatcher,cc=Tn.ReactCurrentOwner,Jt=Tn.ReactCurrentBatchConfig,Oe=0,pt=null,ct=null,ht=0,Ot=0,Os=ts(0),ut=0,Kl=null,gs=0,Ta=0,dc=0,Il=null,_t=null,uc=0,Zs=1/0,bn=null,ua=!1,bo=null,Kn=null,wr=!1,zn=null,ma=0,El=0,vo=null,zr=-1,Fr=0;function Et(){return Oe&6?lt():zr!==-1?zr:zr=lt()}function Qn(e){return e.mode&1?Oe&2&&ht!==0?ht&-ht:nh.transition!==null?(Fr===0&&(Fr=Tm()),Fr):(e=Fe,e!==0||(e=window.event,e=e===void 0?16:$m(e.type)),e):1}function an(e,n,s,l){if(50<El)throw El=0,vo=null,Error(ee(185));er(e,s,l),(!(Oe&2)||e!==pt)&&(e===pt&&(!(Oe&2)&&(Ta|=s),ut===4&&qn(e,ht)),$t(e,l),s===1&&Oe===0&&!(n.mode&1)&&(Zs=lt()+500,Ca&&ns()))}function $t(e,n){var s=e.callbackNode;ng(e,n);var l=Qr(e,e===pt?ht:0);if(l===0)s!==null&&Oc(s),e.callbackNode=null,e.callbackPriority=0;else if(n=l&-l,e.callbackPriority!==n){if(s!=null&&Oc(s),n===1)e.tag===0?th(Td.bind(null,e)):nf(Td.bind(null,e)),Yg(function(){!(Oe&6)&&ns()}),s=null;else{switch(Mm(l)){case 1:s=$o;break;case 4:s=Em;break;case 16:s=Kr;break;case 536870912:s=Pm;break;default:s=Kr}s=tx(s,Kf.bind(null,e))}e.callbackPriority=n,e.callbackNode=s}}function Kf(e,n){if(zr=-1,Fr=0,Oe&6)throw Error(ee(327));var s=e.callbackNode;if(Ws()&&e.callbackNode!==s)return null;var l=Qr(e,e===pt?ht:0);if(l===0)return null;if(l&30||l&e.expiredLanes||n)n=fa(e,l);else{n=l;var r=Oe;Oe|=2;var a=Jf();(pt!==e||ht!==n)&&(bn=null,Zs=lt()+500,us(e,n));do try{wh();break}catch(o){Qf(e,o)}while(!0);Jo(),da.current=a,Oe=r,ct!==null?n=0:(pt=null,ht=0,n=ut)}if(n!==0){if(n===2&&(r=Hi(e),r!==0&&(l=r,n=jo(e,r))),n===1)throw s=Kl,us(e,0),qn(e,l),$t(e,lt()),s;if(n===6)qn(e,l);else{if(r=e.current.alternate,!(l&30)&&!vh(r)&&(n=fa(e,l),n===2&&(a=Hi(e),a!==0&&(l=a,n=jo(e,a))),n===1))throw s=Kl,us(e,0),qn(e,l),$t(e,lt()),s;switch(e.finishedWork=r,e.finishedLanes=l,n){case 0:case 1:throw Error(ee(345));case 2:is(e,_t,bn);break;case 3:if(qn(e,l),(l&130023424)===l&&(n=uc+500-lt(),10<n)){if(Qr(e,0)!==0)break;if(r=e.suspendedLanes,(r&l)!==l){Et(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=eo(is.bind(null,e,_t,bn),n);break}is(e,_t,bn);break;case 4:if(qn(e,l),(l&4194240)===l)break;for(n=e.eventTimes,r=-1;0<l;){var i=31-rn(l);a=1<<i,i=n[i],i>r&&(r=i),l&=~a}if(l=r,l=lt()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*bh(l/1960))-l,10<l){e.timeoutHandle=eo(is.bind(null,e,_t,bn),l);break}is(e,_t,bn);break;case 5:is(e,_t,bn);break;default:throw Error(ee(329))}}}return $t(e,lt()),e.callbackNode===s?Kf.bind(null,e):null}function jo(e,n){var s=Il;return e.current.memoizedState.isDehydrated&&(us(e,n).flags|=256),e=fa(e,n),e!==2&&(n=_t,_t=s,n!==null&&wo(n)),e}function wo(e){_t===null?_t=e:_t.push.apply(_t,e)}function vh(e){for(var n=e;;){if(n.flags&16384){var s=n.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var l=0;l<s.length;l++){var r=s[l],a=r.getSnapshot;r=r.value;try{if(!on(a(),r))return!1}catch{return!1}}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function qn(e,n){for(n&=~dc,n&=~Ta,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var s=31-rn(n),l=1<<s;e[s]=-1,n&=~l}}function Td(e){if(Oe&6)throw Error(ee(327));Ws();var n=Qr(e,0);if(!(n&1))return $t(e,lt()),null;var s=fa(e,n);if(e.tag!==0&&s===2){var l=Hi(e);l!==0&&(n=l,s=jo(e,l))}if(s===1)throw s=Kl,us(e,0),qn(e,n),$t(e,lt()),s;if(s===6)throw Error(ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,is(e,_t,bn),$t(e,lt()),null}function mc(e,n){var s=Oe;Oe|=1;try{return e(n)}finally{Oe=s,Oe===0&&(Zs=lt()+500,Ca&&ns())}}function hs(e){zn!==null&&zn.tag===0&&!(Oe&6)&&Ws();var n=Oe;Oe|=1;var s=Jt.transition,l=Fe;try{if(Jt.transition=null,Fe=1,e)return e()}finally{Fe=l,Jt.transition=s,Oe=n,!(Oe&6)&&ns()}}function fc(){Ot=Os.current,Xe(Os)}function us(e,n){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Jg(s)),ct!==null)for(s=ct.return;s!==null;){var l=s;switch(Vo(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&ea();break;case 3:Ys(),Xe(Bt),Xe(kt),nc();break;case 5:tc(l);break;case 4:Ys();break;case 13:Xe(et);break;case 19:Xe(et);break;case 10:Yo(l.type._context);break;case 22:case 23:fc()}s=s.return}if(pt=e,ct=e=Jn(e.current,null),ht=Ot=n,ut=0,Kl=null,dc=Ta=gs=0,_t=Il=null,cs!==null){for(n=0;n<cs.length;n++)if(s=cs[n],l=s.interleaved,l!==null){s.interleaved=null;var r=l.next,a=s.pending;if(a!==null){var i=a.next;a.next=r,l.next=i}s.pending=l}cs=null}return e}function Qf(e,n){do{var s=ct;try{if(Jo(),Dr.current=ca,oa){for(var l=tt.memoizedState;l!==null;){var r=l.queue;r!==null&&(r.pending=null),l=l.next}oa=!1}if(ps=0,ft=dt=tt=null,Sl=!1,Wl=0,cc.current=null,s===null||s.return===null){ut=1,Kl=n,ct=null;break}e:{var a=e,i=s.return,o=s,c=n;if(n=ht,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=o,p=u.tag;if(!(u.mode&1)&&(p===0||p===11||p===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=hd(i);if(h!==null){h.flags&=-257,yd(h,i,o,a,n),h.mode&1&&gd(a,d,n),n=h,c=d;var y=n.updateQueue;if(y===null){var v=new Set;v.add(c),n.updateQueue=v}else y.add(c);break e}else{if(!(n&1)){gd(a,d,n),xc();break e}c=Error(ee(426))}}else if(Ze&&o.mode&1){var b=hd(i);if(b!==null){!(b.flags&65536)&&(b.flags|=256),yd(b,i,o,a,n),Ko(Xs(c,o));break e}}a=c=Xs(c,o),ut!==4&&(ut=2),Il===null?Il=[a]:Il.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,n&=-n,a.lanes|=n;var g=_f(a,c,n);dd(a,g);break e;case 1:o=c;var x=a.type,j=a.stateNode;if(!(a.flags&128)&&(typeof x.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Kn===null||!Kn.has(j)))){a.flags|=65536,n&=-n,a.lanes|=n;var w=Af(a,o,n);dd(a,w);break e}}a=a.return}while(a!==null)}Xf(s)}catch(k){n=k,ct===s&&s!==null&&(ct=s=s.return);continue}break}while(!0)}function Jf(){var e=da.current;return da.current=ca,e===null?ca:e}function xc(){(ut===0||ut===3||ut===2)&&(ut=4),pt===null||!(gs&268435455)&&!(Ta&268435455)||qn(pt,ht)}function fa(e,n){var s=Oe;Oe|=2;var l=Jf();(pt!==e||ht!==n)&&(bn=null,us(e,n));do try{jh();break}catch(r){Qf(e,r)}while(!0);if(Jo(),Oe=s,da.current=l,ct!==null)throw Error(ee(261));return pt=null,ht=0,ut}function jh(){for(;ct!==null;)Yf(ct)}function wh(){for(;ct!==null&&!Vp();)Yf(ct)}function Yf(e){var n=ex(e.alternate,e,Ot);e.memoizedProps=e.pendingProps,n===null?Xf(e):ct=n,cc.current=null}function Xf(e){var n=e;do{var s=n.alternate;if(e=n.return,n.flags&32768){if(s=ph(s,n),s!==null){s.flags&=32767,ct=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ut=6,ct=null;return}}else if(s=xh(s,n,Ot),s!==null){ct=s;return}if(n=n.sibling,n!==null){ct=n;return}ct=n=e}while(n!==null);ut===0&&(ut=5)}function is(e,n,s){var l=Fe,r=Jt.transition;try{Jt.transition=null,Fe=1,Nh(e,n,s,l)}finally{Jt.transition=r,Fe=l}return null}function Nh(e,n,s,l){do Ws();while(zn!==null);if(Oe&6)throw Error(ee(327));s=e.finishedWork;var r=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(ee(177));e.callbackNode=null,e.callbackPriority=0;var a=s.lanes|s.childLanes;if(sg(e,a),e===pt&&(ct=pt=null,ht=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||wr||(wr=!0,tx(Kr,function(){return Ws(),null})),a=(s.flags&15990)!==0,s.subtreeFlags&15990||a){a=Jt.transition,Jt.transition=null;var i=Fe;Fe=1;var o=Oe;Oe|=4,cc.current=null,hh(e,s),Hf(s,e),Fg(Xi),Jr=!!Yi,Xi=Yi=null,e.current=s,yh(s),Kp(),Oe=o,Fe=i,Jt.transition=a}else e.current=s;if(wr&&(wr=!1,zn=e,ma=r),a=e.pendingLanes,a===0&&(Kn=null),Yp(s.stateNode),$t(e,lt()),n!==null)for(l=e.onRecoverableError,s=0;s<n.length;s++)r=n[s],l(r.value,{componentStack:r.stack,digest:r.digest});if(ua)throw ua=!1,e=bo,bo=null,e;return ma&1&&e.tag!==0&&Ws(),a=e.pendingLanes,a&1?e===vo?El++:(El=0,vo=e):El=0,ns(),null}function Ws(){if(zn!==null){var e=Mm(ma),n=Jt.transition,s=Fe;try{if(Jt.transition=null,Fe=16>e?16:e,zn===null)var l=!1;else{if(e=zn,zn=null,ma=0,Oe&6)throw Error(ee(331));var r=Oe;for(Oe|=4,he=e.current;he!==null;){var a=he,i=a.child;if(he.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(he=d;he!==null;){var u=he;switch(u.tag){case 0:case 11:case 15:Cl(8,u,a)}var p=u.child;if(p!==null)p.return=u,he=p;else for(;he!==null;){u=he;var m=u.sibling,h=u.return;if(Ff(u),u===d){he=null;break}if(m!==null){m.return=h,he=m;break}he=h}}}var y=a.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var b=v.sibling;v.sibling=null,v=b}while(v!==null)}}he=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,he=i;else e:for(;he!==null;){if(a=he,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Cl(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,he=g;break e}he=a.return}}var x=e.current;for(he=x;he!==null;){i=he;var j=i.child;if(i.subtreeFlags&2064&&j!==null)j.return=i,he=j;else e:for(i=x;he!==null;){if(o=he,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Pa(9,o)}}catch(k){st(o,o.return,k)}if(o===i){he=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,he=w;break e}he=o.return}}if(Oe=r,ns(),gn&&typeof gn.onPostCommitFiberRoot=="function")try{gn.onPostCommitFiberRoot(ja,e)}catch{}l=!0}return l}finally{Fe=s,Jt.transition=n}}return!1}function Md(e,n,s){n=Xs(s,n),n=_f(e,n,1),e=Vn(e,n,1),n=Et(),e!==null&&(er(e,1,n),$t(e,n))}function st(e,n,s){if(e.tag===3)Md(e,e,s);else for(;n!==null;){if(n.tag===3){Md(n,e,s);break}else if(n.tag===1){var l=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Kn===null||!Kn.has(l))){e=Xs(s,e),e=Af(n,e,1),n=Vn(n,e,1),e=Et(),n!==null&&(er(n,1,e),$t(n,e));break}}n=n.return}}function kh(e,n,s){var l=e.pingCache;l!==null&&l.delete(n),n=Et(),e.pingedLanes|=e.suspendedLanes&s,pt===e&&(ht&s)===s&&(ut===4||ut===3&&(ht&130023424)===ht&&500>lt()-uc?us(e,0):dc|=s),$t(e,n)}function Zf(e,n){n===0&&(e.mode&1?(n=mr,mr<<=1,!(mr&130023424)&&(mr=4194304)):n=1);var s=Et();e=Cn(e,n),e!==null&&(er(e,n,s),$t(e,s))}function Sh(e){var n=e.memoizedState,s=0;n!==null&&(s=n.retryLane),Zf(e,s)}function Ch(e,n){var s=0;switch(e.tag){case 13:var l=e.stateNode,r=e.memoizedState;r!==null&&(s=r.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(ee(314))}l!==null&&l.delete(n),Zf(e,s)}var ex;ex=function(e,n,s){if(e!==null)if(e.memoizedProps!==n.pendingProps||Bt.current)Rt=!0;else{if(!(e.lanes&s)&&!(n.flags&128))return Rt=!1,fh(e,n,s);Rt=!!(e.flags&131072)}else Rt=!1,Ze&&n.flags&1048576&&sf(n,sa,n.index);switch(n.lanes=0,n.tag){case 2:var l=n.type;Ur(e,n),e=n.pendingProps;var r=Ks(n,kt.current);Gs(n,s),r=lc(null,n,l,e,r,s);var a=rc();return n.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Lt(l)?(a=!0,ta(n)):a=!1,n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Zo(n),r.updater=Ea,n.stateNode=r,r._reactInternals=n,io(n,l,e,s),n=uo(null,n,l,!0,a,s)):(n.tag=0,Ze&&a&&Ho(n),It(null,n,r,s),n=n.child),n;case 16:l=n.elementType;e:{switch(Ur(e,n),e=n.pendingProps,r=l._init,l=r(l._payload),n.type=l,r=n.tag=Eh(l),e=nn(l,e),r){case 0:n=co(null,n,l,e,s);break e;case 1:n=jd(null,n,l,e,s);break e;case 11:n=bd(null,n,l,e,s);break e;case 14:n=vd(null,n,l,nn(l.type,e),s);break e}throw Error(ee(306,l,""))}return n;case 0:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:nn(l,r),co(e,n,l,r,s);case 1:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:nn(l,r),jd(e,n,l,r,s);case 3:e:{if($f(n),e===null)throw Error(ee(387));l=n.pendingProps,a=n.memoizedState,r=a.element,df(e,n),aa(n,l,null,s);var i=n.memoizedState;if(l=i.element,a.isDehydrated)if(a={element:l,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},n.updateQueue.baseState=a,n.memoizedState=a,n.flags&256){r=Xs(Error(ee(423)),n),n=wd(e,n,l,s,r);break e}else if(l!==r){r=Xs(Error(ee(424)),n),n=wd(e,n,l,s,r);break e}else for(Dt=Hn(n.stateNode.containerInfo.firstChild),qt=n,Ze=!0,ln=null,s=of(n,null,l,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Qs(),l===r){n=In(e,n,s);break e}It(e,n,l,s)}n=n.child}return n;case 5:return uf(n),e===null&&lo(n),l=n.type,r=n.pendingProps,a=e!==null?e.memoizedProps:null,i=r.children,Zi(l,r)?i=null:a!==null&&Zi(l,a)&&(n.flags|=32),Lf(e,n),It(e,n,i,s),n.child;case 6:return e===null&&lo(n),null;case 13:return Of(e,n,s);case 4:return ec(n,n.stateNode.containerInfo),l=n.pendingProps,e===null?n.child=Js(n,null,l,s):It(e,n,l,s),n.child;case 11:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:nn(l,r),bd(e,n,l,r,s);case 7:return It(e,n,n.pendingProps,s),n.child;case 8:return It(e,n,n.pendingProps.children,s),n.child;case 12:return It(e,n,n.pendingProps.children,s),n.child;case 10:e:{if(l=n.type._context,r=n.pendingProps,a=n.memoizedProps,i=r.value,Qe(la,l._currentValue),l._currentValue=i,a!==null)if(on(a.value,i)){if(a.children===r.children&&!Bt.current){n=In(e,n,s);break e}}else for(a=n.child,a!==null&&(a.return=n);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===l){if(a.tag===1){c=Nn(-1,s&-s),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}a.lanes|=s,c=a.alternate,c!==null&&(c.lanes|=s),ro(a.return,s,n),o.lanes|=s;break}c=c.next}}else if(a.tag===10)i=a.type===n.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ee(341));i.lanes|=s,o=i.alternate,o!==null&&(o.lanes|=s),ro(i,s,n),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===n){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}It(e,n,r.children,s),n=n.child}return n;case 9:return r=n.type,l=n.pendingProps.children,Gs(n,s),r=Yt(r),l=l(r),n.flags|=1,It(e,n,l,s),n.child;case 14:return l=n.type,r=nn(l,n.pendingProps),r=nn(l.type,r),vd(e,n,l,r,s);case 15:return Rf(e,n,n.type,n.pendingProps,s);case 17:return l=n.type,r=n.pendingProps,r=n.elementType===l?r:nn(l,r),Ur(e,n),n.tag=1,Lt(l)?(e=!0,ta(n)):e=!1,Gs(n,s),Mf(n,l,r),io(n,l,r,s),uo(null,n,l,!0,e,s);case 19:return Df(e,n,s);case 22:return Bf(e,n,s)}throw Error(ee(156,n.tag))};function tx(e,n){return Im(e,n)}function Ih(e,n,s,l){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qt(e,n,s,l){return new Ih(e,n,s,l)}function pc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Eh(e){if(typeof e=="function")return pc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ro)return 11;if(e===Bo)return 14}return 2}function Jn(e,n){var s=e.alternate;return s===null?(s=Qt(e.tag,n,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=n,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,n=e.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Gr(e,n,s,l,r,a){var i=2;if(l=e,typeof e=="function")pc(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Es:return ms(s.children,r,a,n);case Ao:i=8,r|=8;break;case Mi:return e=Qt(12,s,n,r|2),e.elementType=Mi,e.lanes=a,e;case _i:return e=Qt(13,s,n,r),e.elementType=_i,e.lanes=a,e;case Ai:return e=Qt(19,s,n,r),e.elementType=Ai,e.lanes=a,e;case dm:return Ma(s,r,a,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case om:i=10;break e;case cm:i=9;break e;case Ro:i=11;break e;case Bo:i=14;break e;case $n:i=16,l=null;break e}throw Error(ee(130,e==null?e:typeof e,""))}return n=Qt(i,s,n,r),n.elementType=e,n.type=l,n.lanes=a,n}function ms(e,n,s,l){return e=Qt(7,e,l,n),e.lanes=s,e}function Ma(e,n,s,l){return e=Qt(22,e,l,n),e.elementType=dm,e.lanes=s,e.stateNode={isHidden:!1},e}function hi(e,n,s){return e=Qt(6,e,null,n),e.lanes=s,e}function yi(e,n,s){return n=Qt(4,e.children!==null?e.children:[],e.key,n),n.lanes=s,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Ph(e,n,s,l,r){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xa(0),this.expirationTimes=Xa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xa(0),this.identifierPrefix=l,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function gc(e,n,s,l,r,a,i,o,c){return e=new Ph(e,n,s,o,c),n===1?(n=1,a===!0&&(n|=8)):n=0,a=Qt(3,null,null,n),e.current=a,a.stateNode=e,a.memoizedState={element:l,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zo(a),e}function Th(e,n,s){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Is,key:l==null?null:""+l,children:e,containerInfo:n,implementation:s}}function nx(e){if(!e)return Zn;e=e._reactInternals;e:{if(bs(e)!==e||e.tag!==1)throw Error(ee(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Lt(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(ee(171))}if(e.tag===1){var s=e.type;if(Lt(s))return tf(e,s,n)}return n}function sx(e,n,s,l,r,a,i,o,c){return e=gc(s,l,!0,e,r,a,i,o,c),e.context=nx(null),s=e.current,l=Et(),r=Qn(s),a=Nn(l,r),a.callback=n??null,Vn(s,a,r),e.current.lanes=r,er(e,r,l),$t(e,l),e}function _a(e,n,s,l){var r=n.current,a=Et(),i=Qn(r);return s=nx(s),n.context===null?n.context=s:n.pendingContext=s,n=Nn(a,i),n.payload={element:e},l=l===void 0?null:l,l!==null&&(n.callback=l),e=Vn(r,n,i),e!==null&&(an(e,r,i,a),Or(e,r,i)),i}function xa(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _d(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<n?s:n}}function hc(e,n){_d(e,n),(e=e.alternate)&&_d(e,n)}function Mh(){return null}var lx=typeof reportError=="function"?reportError:function(e){console.error(e)};function yc(e){this._internalRoot=e}Aa.prototype.render=yc.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(ee(409));_a(e,n,null,null)};Aa.prototype.unmount=yc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;hs(function(){_a(null,e,null,null)}),n[Sn]=null}};function Aa(e){this._internalRoot=e}Aa.prototype.unstable_scheduleHydration=function(e){if(e){var n=Rm();e={blockedOn:null,target:e,priority:n};for(var s=0;s<Dn.length&&n!==0&&n<Dn[s].priority;s++);Dn.splice(s,0,e),s===0&&Lm(e)}};function bc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ra(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ad(){}function _h(e,n,s,l,r){if(r){if(typeof l=="function"){var a=l;l=function(){var d=xa(i);a.call(d)}}var i=sx(n,l,e,0,null,!1,!1,"",Ad);return e._reactRootContainer=i,e[Sn]=i.current,ql(e.nodeType===8?e.parentNode:e),hs(),i}for(;r=e.lastChild;)e.removeChild(r);if(typeof l=="function"){var o=l;l=function(){var d=xa(c);o.call(d)}}var c=gc(e,0,!1,null,null,!1,!1,"",Ad);return e._reactRootContainer=c,e[Sn]=c.current,ql(e.nodeType===8?e.parentNode:e),hs(function(){_a(n,c,s,l)}),c}function Ba(e,n,s,l,r){var a=s._reactRootContainer;if(a){var i=a;if(typeof r=="function"){var o=r;r=function(){var c=xa(i);o.call(c)}}_a(n,i,e,r)}else i=_h(s,n,e,r,l);return xa(i)}_m=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var s=yl(n.pendingLanes);s!==0&&(Oo(n,s|1),$t(n,lt()),!(Oe&6)&&(Zs=lt()+500,ns()))}break;case 13:hs(function(){var l=Cn(e,1);if(l!==null){var r=Et();an(l,e,1,r)}}),hc(e,1)}};Do=function(e){if(e.tag===13){var n=Cn(e,134217728);if(n!==null){var s=Et();an(n,e,134217728,s)}hc(e,134217728)}};Am=function(e){if(e.tag===13){var n=Qn(e),s=Cn(e,n);if(s!==null){var l=Et();an(s,e,n,l)}hc(e,n)}};Rm=function(){return Fe};Bm=function(e,n){var s=Fe;try{return Fe=e,n()}finally{Fe=s}};Fi=function(e,n,s){switch(n){case"input":if(Li(e,s),n=s.name,s.type==="radio"&&n!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<s.length;n++){var l=s[n];if(l!==e&&l.form===e.form){var r=Sa(l);if(!r)throw Error(ee(90));mm(l),Li(l,r)}}}break;case"textarea":xm(e,s);break;case"select":n=s.value,n!=null&&qs(e,!!s.multiple,n,!1)}};jm=mc;wm=hs;var Ah={usingClientEntryPoint:!1,Events:[nr,_s,Sa,bm,vm,mc]},pl={findFiberByHostInstance:os,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rh={bundleType:pl.bundleType,version:pl.version,rendererPackageName:pl.rendererPackageName,rendererConfig:pl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Tn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Sm(e),e===null?null:e.stateNode},findFiberByHostInstance:pl.findFiberByHostInstance||Mh,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nr.isDisabled&&Nr.supportsFiber)try{ja=Nr.inject(Rh),gn=Nr}catch{}}zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ah;zt.createPortal=function(e,n){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bc(n))throw Error(ee(200));return Th(e,n,null,s)};zt.createRoot=function(e,n){if(!bc(e))throw Error(ee(299));var s=!1,l="",r=lx;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(r=n.onRecoverableError)),n=gc(e,1,!1,null,null,s,!1,l,r),e[Sn]=n.current,ql(e.nodeType===8?e.parentNode:e),new yc(n)};zt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(ee(188)):(e=Object.keys(e).join(","),Error(ee(268,e)));return e=Sm(n),e=e===null?null:e.stateNode,e};zt.flushSync=function(e){return hs(e)};zt.hydrate=function(e,n,s){if(!Ra(n))throw Error(ee(200));return Ba(null,e,n,!0,s)};zt.hydrateRoot=function(e,n,s){if(!bc(e))throw Error(ee(405));var l=s!=null&&s.hydratedSources||null,r=!1,a="",i=lx;if(s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(i=s.onRecoverableError)),n=sx(n,null,e,1,s??null,r,!1,a,i),e[Sn]=n.current,ql(e),l)for(e=0;e<l.length;e++)s=l[e],r=s._getVersion,r=r(s._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[s,r]:n.mutableSourceEagerHydrationData.push(s,r);return new Aa(n)};zt.render=function(e,n,s){if(!Ra(n))throw Error(ee(200));return Ba(null,e,n,!1,s)};zt.unmountComponentAtNode=function(e){if(!Ra(e))throw Error(ee(40));return e._reactRootContainer?(hs(function(){Ba(null,null,e,!1,function(){e._reactRootContainer=null,e[Sn]=null})}),!0):!1};zt.unstable_batchedUpdates=mc;zt.unstable_renderSubtreeIntoContainer=function(e,n,s,l){if(!Ra(s))throw Error(ee(200));if(e==null||e._reactInternals===void 0)throw Error(ee(38));return Ba(e,n,s,!1,l)};zt.version="18.3.1-next-f1338f8080-20240426";function rx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rx)}catch(e){console.error(e)}}rx(),lm.exports=zt;var Bh=lm.exports,Rd=Bh;Pi.createRoot=Rd.createRoot,Pi.hydrateRoot=Rd.hydrateRoot;const F=({children:e,onClick:n,colorScheme:s="accent",disabled:l=!1,className:r="",type:a="button",title:i})=>{const o="px-4 py-2 font-bold rounded-lg transition-colors shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-primary disabled:bg-secondary disabled:opacity-70 disabled:cursor-not-allowed",c={accent:"bg-accent hover:bg-accent-hover text-white focus:ring-accent",blue:"bg-blue-600 hover:bg-blue-500 text-white focus:ring-blue-400",red:"bg-danger hover:bg-danger-hover text-white focus:ring-red-400",gray:"bg-secondary hover:bg-tertiary text-secondary focus:ring-color",green:"bg-success hover:opacity-90 text-white focus:ring-green-400",yellow:"bg-yellow-500 hover:bg-yellow-400 text-black focus:ring-yellow-300",purple:"bg-purple-600 hover:bg-purple-500 text-white focus:ring-purple-400",orange:"bg-orange-500 hover:bg-orange-400 text-white focus:ring-orange-300"};return t.jsx("button",{type:a,onClick:n,disabled:l,className:`${o} ${c[s]} ${r}`,title:i,children:e})},Lh=({userId:e,userName:n,avatarUrl:s,borderUrl:l,size:r=40,className:a=""})=>{const i=r/16,o=l&&(l.startsWith("#")||l.startsWith("conic-gradient")),c=l&&!o,d=s||"/images/profiles/profile1.png";if(c){let u=i*1.4;l.includes("Ring")&&(u=i*1.5);const p={width:`${i}rem`,height:`${i}rem`};return l.includes("Ring5.png")&&(p.transform=`translateX(-${i*.2}rem)`),t.jsxs("div",{className:`relative flex-shrink-0 flex items-center justify-center ${a}`,style:{width:`${u}rem`,height:`${u}rem`},children:[t.jsx("div",{className:"rounded-full overflow-hidden bg-gray-700",style:p,children:t.jsx("img",{src:d,alt:n,className:"w-full h-full object-cover"})}),t.jsx("img",{src:l,alt:"",className:"absolute inset-0 w-full h-full pointer-events-none object-contain","aria-hidden":"true"})]})}if(o){const u=i*.85,p=l.startsWith("conic-gradient");return t.jsx("div",{className:`relative flex items-center justify-center rounded-full flex-shrink-0 ${a}`,style:{width:`${i}rem`,height:`${i}rem`,...p?{background:l}:{backgroundColor:l}},children:t.jsx("div",{className:"flex items-center justify-center rounded-full overflow-hidden bg-gray-700",style:{width:`${u}rem`,height:`${u}rem`},children:t.jsx("img",{src:d,alt:n,className:"w-full h-full object-cover"})})})}return t.jsx("div",{className:`rounded-full overflow-hidden bg-gray-700 flex-shrink-0 ${a}`,style:{width:`${i}rem`,height:`${i}rem`},children:t.jsx("img",{src:d,alt:n,className:"w-full h-full object-cover"})})},Ce=Pn.memo(Lh);var $;(function(e){e[e.None=0]="None",e[e.Black=1]="Black",e[e.White=2]="White"})($||($={}));var M;(function(e){e.Standard=" ",e.Capture=" ",e.Speed=" ",e.Base=" ",e.Hidden=" ",e.Missile=" ",e.Mix=" ",e.Dice=" ",e.Omok="",e.Ttamok="",e.Thief=" ",e.Alkkagi="",e.Curling=" "})(M||(M={}));var xt;(function(e){e.Sprout="",e.Rookie="",e.Rising="",e.Ace="",e.Diamond="",e.Master="",e.Grandmaster="",e.Challenger=""})(xt||(xt={}));var Bd;(function(e){e.Online="online",e.Waiting="waiting",e.Resting="resting",e.Negotiating="negotiating",e.InGame="in-game",e.Spectating="spectating"})(Bd||(Bd={}));var pa;(function(e){e.Basic="basic"})(pa||(pa={}));var ga;(function(e){e.TurnByTurn=" ",e.Simultaneous=" "})(ga||(ga={}));var el;(function(e){e.Normal="",e.Battle=""})(el||(el={}));var N;(function(e){e.Concentration="",e.ThinkingSpeed="",e.Judgment="",e.Calculation="",e.CombatPower="",e.Stability=""})(N||(N={}));var ze;(function(e){e.ActionPointMax=" ",e.ActionPointRegen=" ",e.StrategyXpBonus="  ",e.PlayfulXpBonus="  ",e.GoldBonus="   ",e.ItemDropRate="  ",e.MaterialDropRate="  "})(ze||(ze={}));var rt;(function(e){e.MannerActionCooldown="    ",e.StrategicGoldBonus="    20% (10~50) 5",e.PlayfulGoldBonus="   60 20% (10~50) 5",e.DiceGoOddBonus=" / ",e.AlkkagiSlowBonus="     1",e.AlkkagiAimingBonus="     1"})(rt||(rt={}));var Pe;(function(e){e.="",e.="",e.="",e.="",e.=""})(Pe||(Pe={}));const tl="ai-player-01",at=[{mode:M.Standard,name:" ",description:"  .",available:!0,image:"/images/simbols/simbol1.png"},{mode:M.Capture,name:" ",description:"       .",available:!0,image:"/images/simbols/simbol2.png"},{mode:M.Speed,name:" ",description:"       .       .",available:!0,image:"/images/simbols/simbol3.png"},{mode:M.Base,name:" ",description:"  ''     .   ,    /    .        .",available:!0,image:"/images/simbols/simbol4.png"},{mode:M.Hidden,name:" ",description:"   ''   ,  ''       .        ,      .",available:!0,image:"/images/simbols/simbol5.png"},{mode:M.Missile,name:" ",description:"        .",available:!0,image:"/images/simbols/simbol6.png"},{mode:M.Mix,name:" ",description:", , , ,    2    .",available:!0,image:"/images/simbols/simbol7.png"}],St=[{mode:M.Dice,name:" ",description:" 3 ,          .     .",available:!0,image:"/images/simbols/simbolp1.png"},{mode:M.Omok,name:"",description:"        .",available:!0,image:"/images/simbols/simbolp2.png"},{mode:M.Ttamok,name:"",description:"       .",available:!0,image:"/images/simbols/simbolp3.png"},{mode:M.Thief,name:"",description:"() ()    5 ,      .",available:!0,image:"/images/simbols/simbolp4.png"},{mode:M.Alkkagi,name:"",description:"        .",available:!0,image:"/images/simbols/simbolp5.png"},{mode:M.Curling,name:"",description:"    ()      .",available:!0,image:"/images/simbols/simbolp6.png"}],Ld=[19,13,9],$d=[19,15],Od=[13,11,9,7],Dd=[7,9,11,13,19],qd=[19,13,11,9,7],Ud=[9,13,19],zd=[19,13,9],Fd=[5,10,15,20,25,30],$h=[10,20,30],Gd=[1,2,3],Wd=[1,2,3,4,5,6,7,8,9,10],Hd=Array.from({length:15},(e,n)=>n+1),Oh=[{value:0,label:""},{value:5,label:"5"},{value:10,label:"10"},{value:15,label:"15"},{value:20,label:"20"},{value:30,label:"30"},{value:40,label:"40"},{value:50,label:"50"},{value:60,label:"1"},{value:120,label:"2"},{value:180,label:"3"}],Dh=[{value:1,label:"1"},{value:3,label:"3"},{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:30,label:"30"}],qh=[1,2,3,4,5,6,7,8,9,10],Uh=[10,20,30,40,50,60],bi=[3,4,5,6,7,8,9,10],ax=6.5,zh=5,Vd=[0,1,2,3],Kd=[0,1,2,3],Fh=[1,2,3],Gh=[1,2,3],Qd=[0,1,2,3,4,5],Jd={boardSize:19,timeLimit:10,byoyomiCount:3,byoyomiTime:30,baseStones:4,diceGoVariant:pa.Basic,diceGoRounds:3,oddDiceCount:1,evenDiceCount:1,captureTarget:20,timeIncrement:5,hiddenStoneCount:2,scanCount:5,missileCount:5,mixedModes:[M.Hidden,M.Speed],hasOverlineForbidden:!0,has33Forbidden:!0,alkkagiPlacementType:ga.TurnByTurn,alkkagiLayout:el.Normal,alkkagiStoneCount:5,alkkagiGaugeSpeed:700,alkkagiSlowItemCount:2,alkkagiAimingLineItemCount:2,alkkagiRounds:1,curlingStoneCount:5,curlingGaugeSpeed:700,curlingSlowItemCount:2,curlingAimingLineItemCount:2,curlingRounds:3,komi:ax,player1Color:$.Black,aiDifficulty:1},Wh=[5,7,10],Hh=30,kr=30,Yd=30;pa.Basic+"";const Xd=[3,5,7,9],Vh=30,Kh=30,Qh=30,No=[{value:1e3,label:"x1 ()"},{value:700,label:"x2 ()"},{value:400,label:"x3 ()"}],Zd={[$.Black]:[{x:7,y:4,width:5,height:2},{x:4,y:7,width:2,height:4},{x:13,y:7,width:2,height:4},{x:7,y:13,width:2,height:2},{x:10,y:13,width:2,height:2}],[$.White]:[{x:4,y:4,width:2,height:2},{x:13,y:4,width:2,height:2},{x:7,y:7,width:5,height:2},{x:7,y:10,width:5,height:2}]},Jh=5,eu=[3,5,7],Yh=30,ko=[{value:1e3,label:"x1 ()"},{value:700,label:"x2 ()"},{value:400,label:"x3 ()"}],La={fan:"images/equipments/EmptyFanSlot.png",board:"images/equipments/EmptyBoardSlot.png",top:"images/equipments/EmptyTopSlot.png",bottom:"images/equipments/EmptyBottomSlot.png",bowl:"images/equipments/EmptyStoneBoxSlot.png",stones:"images/equipments/EmptyStoneSlot.png"},En={normal:1,uncommon:1,rare:5,epic:12,legendary:20,mythic:30},vc=[{name:"  ",slot:"fan",image:"images/equipments/Fan1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:"  ",slot:"fan",image:"images/equipments/Fan2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"fan",image:"images/equipments/Fan3.png",grade:"rare",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"fan",image:"images/equipments/Fan4.png",grade:"epic",stars:0,type:"equipment",description:"        ."},{name:"  ",slot:"fan",image:"images/equipments/Fan5.png",grade:"legendary",stars:0,type:"equipment",description:"      ."},{name:"  ",slot:"fan",image:"images/equipments/Fan6.png",grade:"mythic",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"board",image:"images/equipments/Board1.png",grade:"normal",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"board",image:"images/equipments/Board2.png",grade:"uncommon",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"board",image:"images/equipments/Board3.png",grade:"rare",stars:0,type:"equipment",description:"       ."},{name:" ",slot:"board",image:"images/equipments/Board4.png",grade:"epic",stars:0,type:"equipment",description:"    ."},{name:" ",slot:"board",image:"images/equipments/Board5.png",grade:"legendary",stars:0,type:"equipment",description:"       ."},{name:" ",slot:"board",image:"images/equipments/Board6.png",grade:"mythic",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top1.png",grade:"normal",stars:0,type:"equipment",description:"    ."},{name:"  ",slot:"top",image:"images/equipments/Top2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top3.png",grade:"rare",stars:0,type:"equipment",description:"    ."},{name:"  ",slot:"top",image:"images/equipments/Top4.png",grade:"epic",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top5.png",grade:"legendary",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"top",image:"images/equipments/Top6.png",grade:"mythic",stars:0,type:"equipment",description:"       ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom3.png",grade:"rare",stars:0,type:"equipment",description:"      ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom4.png",grade:"epic",stars:0,type:"equipment",description:"     ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom5.png",grade:"legendary",stars:0,type:"equipment",description:"      ."},{name:"  ",slot:"bottom",image:"images/equipments/Bottom6.png",grade:"mythic",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox3.png",grade:"rare",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox4.png",grade:"epic",stars:0,type:"equipment",description:"       ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox5.png",grade:"legendary",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"bowl",image:"images/equipments/StoneBox6.png",grade:"mythic",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"stones",image:"images/equipments/Stone1.png",grade:"normal",stars:0,type:"equipment",description:"   ."},{name:" ",slot:"stones",image:"images/equipments/Stone2.png",grade:"uncommon",stars:0,type:"equipment",description:"     ."},{name:" ",slot:"stones",image:"images/equipments/Stone3.png",grade:"rare",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"stones",image:"images/equipments/Stone4.png",grade:"epic",stars:0,type:"equipment",description:"      ."},{name:" ",slot:"stones",image:"images/equipments/Stone5.png",grade:"legendary",stars:0,type:"equipment",description:" ,      ."},{name:" ",slot:"stones",image:"images/equipments/Stone6.png",grade:"mythic",stars:0,type:"equipment",description:"      ."}],vs=[{name:"  I",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox1.png",grade:"normal"},{name:"  II",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox2.png",grade:"uncommon"},{name:"  III",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox3.png",grade:"rare"},{name:"  IV",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox4.png",grade:"epic"},{name:"  V",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox5.png",grade:"legendary"},{name:"  VI",description:"~   ",type:"consumable",slot:null,image:"/images/Box/EquipmentBox6.png",grade:"mythic"},{name:"  I",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox1.png",grade:"normal"},{name:"  II",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox2.png",grade:"uncommon"},{name:"  III",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox3.png",grade:"rare"},{name:"  IV",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox4.png",grade:"epic"},{name:"  V",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox5.png",grade:"legendary"},{name:"  VI",description:" ~   5 ",type:"consumable",slot:null,image:"/images/Box/ResourceBox6.png",grade:"mythic"},{name:" 1",description:"10 ~ 500  ",type:"consumable",slot:null,image:"/images/Box/GoldBox1.png",grade:"normal"},{name:" 2",description:"100 ~ 1,000  ",type:"consumable",slot:null,image:"/images/Box/GoldBox2.png",grade:"uncommon"},{name:" 3",description:"500 ~ 3,000  ",type:"consumable",slot:null,image:"/images/Box/GoldBox3.png",grade:"rare"},{name:" 4",description:"1,000 ~ 10,000  ",type:"consumable",slot:null,image:"/images/Box/GoldBox4.png",grade:"epic"},{name:" 1",description:"1 ~ 20  ",type:"consumable",slot:null,image:"/images/Box/DiaBox1.png",grade:"rare"},{name:" 2",description:"10 ~ 30  ",type:"consumable",slot:null,image:"/images/Box/DiaBox2.png",grade:"epic"},{name:" 3",description:"20 ~ 50  ",type:"consumable",slot:null,image:"/images/Box/DiaBox3.png",grade:"legendary"},{name:" 4",description:"30 ~ 100  ",type:"consumable",slot:null,image:"/images/Box/DiaBox4.png",grade:"mythic"}],Zt={" ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials1.png",grade:"normal"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials2.png",grade:"uncommon"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials3.png",grade:"rare"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials4.png",grade:"epic"}," ":{name:" ",description:"    .",type:"material",slot:null,image:"/images/materials/materials5.png",grade:"legendary"}},$a={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},Pl={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},Xh=[100,90,80,70,60,55,50,45,40,35],Zh={normal:5,uncommon:4,rare:3,epic:2,legendary:1,mythic:.5},ha={normal:[[{amount:10,name:" "}],[{amount:15,name:" "}],[{amount:20,name:" "}],[{amount:25,name:" "}],[{amount:30,name:" "}],[{amount:30,name:" "}],[{amount:50,name:" "}],[{amount:5,name:" "}],[{amount:10,name:" "}],[{amount:5,name:" "}]],uncommon:[[{amount:20,name:" "}],[{amount:30,name:" "}],[{amount:40,name:" "}],[{amount:50,name:" "}],[{amount:60,name:" "}],[{amount:50,name:" "}],[{amount:10,name:" "}],[{amount:20,name:" "}],[{amount:10,name:" "}],[{amount:20,name:" "}]],rare:[[{amount:10,name:" "}],[{amount:15,name:" "}],[{amount:20,name:" "}],[{amount:25,name:" "}],[{amount:30,name:" "}],[{amount:100,name:" "}],[{amount:20,name:" "}],[{amount:40,name:" "}],[{amount:15,name:" "}],[{amount:30,name:" "}]],epic:[[{amount:20,name:" "}],[{amount:30,name:" "}],[{amount:40,name:" "}],[{amount:50,name:" "}],[{amount:60,name:" "}],[{amount:30,name:" "}],[{amount:50,name:" "}],[{amount:20,name:" "}],[{amount:45,name:" "}],[{amount:80,name:" "}]],legendary:[[{amount:10,name:" "}],[{amount:15,name:" "}],[{amount:20,name:" "}],[{amount:25,name:" "}],[{amount:30,name:" "}],[{amount:100,name:" "}],[{amount:20,name:" "}],[{amount:50,name:" "}],[{amount:100,name:" "}],[{amount:10,name:" "}]],mythic:[[{amount:20,name:" "}],[{amount:30,name:" "}],[{amount:40,name:" "}],[{amount:50,name:" "}],[{amount:60,name:" "}],[{amount:40,name:" "}],[{amount:80,name:" "}],[{amount:10,name:" "}],[{amount:50,name:" "}],[{amount:100,name:" "}]]},e0={normal:50,uncommon:100,rare:200,epic:300,legendary:500,mythic:1e3},Ds=30,ix=10,t0=100,n0=50,s0=50,l0={[N.Concentration]:{name:"",description:"    .    ,      ."},[N.ThinkingSpeed]:{name:"",description:"   .            ."},[N.Judgment]:{name:"",description:"     .          ."},[N.Calculation]:{name:"",description:"      .       ."},[N.CombatPower]:{name:"",description:"     .           ."},[N.Stability]:{name:"",description:"    .         ."}},r0={fan:{isPercentage:!0,options:{normal:{stats:[N.ThinkingSpeed,N.Concentration],value:4},uncommon:{stats:[N.ThinkingSpeed,N.Concentration],value:6},rare:{stats:[N.ThinkingSpeed,N.Concentration],value:8},epic:{stats:[N.ThinkingSpeed,N.Concentration],value:10},legendary:{stats:[N.ThinkingSpeed,N.Concentration],value:12},mythic:{stats:[N.ThinkingSpeed,N.Concentration],value:15}}},board:{isPercentage:!0,options:{normal:{stats:[N.Stability,N.Calculation],value:4},uncommon:{stats:[N.Stability,N.Calculation],value:6},rare:{stats:[N.Stability,N.Calculation],value:8},epic:{stats:[N.Stability,N.Calculation],value:10},legendary:{stats:[N.Stability,N.Calculation],value:12},mythic:{stats:[N.Stability,N.Calculation],value:15}}},top:{isPercentage:!0,options:{normal:{stats:[N.CombatPower,N.Judgment],value:4},uncommon:{stats:[N.CombatPower,N.Judgment],value:6},rare:{stats:[N.CombatPower,N.Judgment],value:8},epic:{stats:[N.CombatPower,N.Judgment],value:10},legendary:{stats:[N.CombatPower,N.Judgment],value:12},mythic:{stats:[N.CombatPower,N.Judgment],value:15}}},bottom:{isPercentage:!1,options:{normal:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:8},uncommon:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:12},rare:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:16},epic:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:20},legendary:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:24},mythic:{stats:[N.Concentration,N.Stability,N.Judgment,N.Calculation,N.ThinkingSpeed],value:30}}},stones:{isPercentage:!1,options:{normal:{stats:[N.CombatPower,N.Calculation],value:8},uncommon:{stats:[N.CombatPower,N.Calculation],value:12},rare:{stats:[N.CombatPower,N.Calculation],value:16},epic:{stats:[N.CombatPower,N.Calculation],value:20},legendary:{stats:[N.CombatPower,N.Calculation],value:24},mythic:{stats:[N.CombatPower,N.Calculation],value:30}}},bowl:{isPercentage:!1,options:{normal:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:8},uncommon:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:12},rare:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:16},epic:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:20},legendary:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:24},mythic:{stats:[N.Concentration,N.Stability,N.ThinkingSpeed],value:30}}}},ox={[ze.ActionPointMax]:{name:" ",description:"  .",isPercentage:!1,range:[2,5]},[ze.ActionPointRegen]:{name:" ",description:"   .",isPercentage:!0,range:[1,3]},[ze.StrategyXpBonus]:{name:"  ",description:"      .",isPercentage:!0,range:[1,3]},[ze.PlayfulXpBonus]:{name:"  ",description:"      .",isPercentage:!0,range:[1,3]},[ze.GoldBonus]:{name:" ",description:"      .",isPercentage:!0,range:[1,3]},[ze.ItemDropRate]:{name:"  ",description:"      .",isPercentage:!0,range:[1,2]},[ze.MaterialDropRate]:{name:"  ",description:"      .",isPercentage:!0,range:[1,3]}},cx={[rt.MannerActionCooldown]:{name:"    ",description:"    .",value:()=>30},[rt.StrategicGoldBonus]:{name:"  ",description:"    20% (10~50) 5",value:()=>1},[rt.PlayfulGoldBonus]:{name:"  ",description:"   60 20% (10~50) 5",value:()=>1},[rt.DiceGoOddBonus]:{name:" / ",description:"  /  1 ",value:()=>1},[rt.AlkkagiSlowBonus]:{name:"  ",description:"     1",value:()=>1},[rt.AlkkagiAimingBonus]:{name:"  ",description:"     1",value:()=>1}},a0={normal:{combatCount:[1,2],specialCount:[0,0],mythicCount:[0,0],combatTier:1},uncommon:{combatCount:[2,3],specialCount:[1,1],mythicCount:[0,0],combatTier:2},rare:{combatCount:[3,3],specialCount:[1,1],mythicCount:[0,0],combatTier:3},epic:{combatCount:[3,4],specialCount:[1,1],mythicCount:[0,0],combatTier:4},legendary:{combatCount:[4,4],specialCount:[1,2],mythicCount:[0,0],combatTier:5},mythic:{combatCount:[4,4],specialCount:[1,2],mythicCount:[1,1],combatTier:6}},i0={fan:{1:[{type:N.Concentration,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!0,range:[1,2]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!0,range:[2,3]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!0,range:[3,5]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!0,range:[4,6]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!0,range:[5,7]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!1,range:[10,15]},{type:N.Judgment,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!0,range:[8,10]},{type:N.Stability,isPercentage:!1,range:[10,15]},{type:N.Calculation,isPercentage:!1,range:[10,15]}]},board:{1:[{type:N.Concentration,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!0,range:[1,2]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!0,range:[2,3]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!0,range:[3,5]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!0,range:[4,6]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!0,range:[5,7]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!1,range:[10,15]},{type:N.Judgment,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!1,range:[10,15]},{type:N.Stability,isPercentage:!0,range:[8,10]},{type:N.Calculation,isPercentage:!1,range:[10,15]}]},top:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.Concentration,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!0,range:[1,2]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!0,range:[1,2]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!0,range:[1,2]},{type:N.Calculation,isPercentage:!0,range:[1,2]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.Concentration,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!0,range:[2,3]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!0,range:[2,3]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!0,range:[2,3]},{type:N.Calculation,isPercentage:!0,range:[2,3]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.Concentration,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!0,range:[3,5]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!0,range:[3,5]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!0,range:[3,5]},{type:N.Calculation,isPercentage:!0,range:[3,5]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.Concentration,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!0,range:[4,6]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!0,range:[4,6]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!0,range:[4,6]},{type:N.Calculation,isPercentage:!0,range:[4,6]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.Concentration,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!0,range:[5,7]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!0,range:[5,7]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!0,range:[5,7]},{type:N.Calculation,isPercentage:!0,range:[5,7]}],6:[{type:N.Concentration,isPercentage:!1,range:[10,15]},{type:N.Concentration,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!0,range:[8,10]},{type:N.CombatPower,isPercentage:!1,range:[10,15]},{type:N.Judgment,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!1,range:[10,15]},{type:N.ThinkingSpeed,isPercentage:!0,range:[8,10]},{type:N.Stability,isPercentage:!1,range:[10,15]},{type:N.Stability,isPercentage:!0,range:[8,10]},{type:N.Calculation,isPercentage:!0,range:[8,10]}]},bottom:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!1,range:[8,12]},{type:N.CombatPower,isPercentage:!1,range:[8,12]},{type:N.Judgment,isPercentage:!1,range:[8,12]},{type:N.ThinkingSpeed,isPercentage:!1,range:[8,12]},{type:N.Stability,isPercentage:!1,range:[8,12]},{type:N.Calculation,isPercentage:!1,range:[8,12]}]},stones:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.ThinkingSpeed,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.ThinkingSpeed,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.ThinkingSpeed,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.ThinkingSpeed,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.ThinkingSpeed,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!1,range:[8,12]},{type:N.CombatPower,isPercentage:!1,range:[8,12]},{type:N.Judgment,isPercentage:!1,range:[8,12]},{type:N.ThinkingSpeed,isPercentage:!1,range:[8,12]},{type:N.Stability,isPercentage:!1,range:[8,12]}]},bowl:{1:[{type:N.Concentration,isPercentage:!1,range:[2,5]},{type:N.CombatPower,isPercentage:!1,range:[2,5]},{type:N.Judgment,isPercentage:!1,range:[2,5]},{type:N.Stability,isPercentage:!1,range:[2,5]},{type:N.Calculation,isPercentage:!1,range:[2,5]}],2:[{type:N.Concentration,isPercentage:!1,range:[3,6]},{type:N.CombatPower,isPercentage:!1,range:[3,6]},{type:N.Judgment,isPercentage:!1,range:[3,6]},{type:N.Stability,isPercentage:!1,range:[3,6]},{type:N.Calculation,isPercentage:!1,range:[3,6]}],3:[{type:N.Concentration,isPercentage:!1,range:[4,7]},{type:N.CombatPower,isPercentage:!1,range:[4,7]},{type:N.Judgment,isPercentage:!1,range:[4,7]},{type:N.Stability,isPercentage:!1,range:[4,7]},{type:N.Calculation,isPercentage:!1,range:[4,7]}],4:[{type:N.Concentration,isPercentage:!1,range:[5,8]},{type:N.CombatPower,isPercentage:!1,range:[5,8]},{type:N.Judgment,isPercentage:!1,range:[5,8]},{type:N.Stability,isPercentage:!1,range:[5,8]},{type:N.Calculation,isPercentage:!1,range:[5,8]}],5:[{type:N.Concentration,isPercentage:!1,range:[7,10]},{type:N.CombatPower,isPercentage:!1,range:[7,10]},{type:N.Judgment,isPercentage:!1,range:[7,10]},{type:N.Stability,isPercentage:!1,range:[7,10]},{type:N.Calculation,isPercentage:!1,range:[7,10]}],6:[{type:N.Concentration,isPercentage:!1,range:[8,12]},{type:N.CombatPower,isPercentage:!1,range:[8,12]},{type:N.Judgment,isPercentage:!1,range:[8,12]},{type:N.Stability,isPercentage:!1,range:[8,12]},{type:N.Calculation,isPercentage:!1,range:[8,12]}]}},dx=[20,40,60,80,100],ux=[20,40,60,80,100],mx=[20,40,60,80,100],o0=[{items:[{itemId:" 1",quantity:1}]},{items:[{itemId:" 2",quantity:1}]},{items:[{itemId:"  I",quantity:1}]},{items:[{itemId:"  I",quantity:1}]},{items:[{itemId:" 1",quantity:1}]}],c0=[{items:[{itemId:" 2",quantity:1}]},{items:[{itemId:" 3",quantity:1}]},{items:[{itemId:"  II",quantity:1}]},{items:[{itemId:"  II",quantity:1}]},{items:[{itemId:" 2",quantity:1}]}],d0=[{items:[{itemId:" 3",quantity:1}]},{items:[{itemId:" 4",quantity:1}]},{items:[{itemId:"  III",quantity:1}]},{items:[{itemId:"  III",quantity:1}]},{items:[{itemId:" 3",quantity:1}]}],nl=[{tier:xt.Sprout,name:" ",scoreThreshold:0,icon:"/images/tire/auto1.png"},{tier:xt.Rookie,name:" ",scoreThreshold:1300,icon:"/images/tire/auto2.png"},{tier:xt.Rising,name:" ",scoreThreshold:1400,icon:"/images/tire/auto3.png"},{tier:xt.Ace,name:" ",scoreThreshold:1500,icon:"/images/tire/auto4.png"},{tier:xt.Diamond,name:" ",scoreThreshold:1600,icon:"/images/tire/auto5.png"},{tier:xt.Master,name:" ",scoreThreshold:1700,icon:"/images/tire/auto6.png"},{tier:xt.Grandmaster,name:" ",scoreThreshold:1800,icon:"/images/tire/auto7.png"},{tier:xt.Challenger,name:" ",scoreThreshold:2e3,icon:"/images/tire/auto8.png"}],u0={[xt.Sprout]:[{rankStart:1,rankEnd:1,diamonds:50,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:30,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:15,outcome:"promote"},{rankStart:4,rankEnd:16,diamonds:5,outcome:"maintain"}],[xt.Rookie]:[{rankStart:1,rankEnd:1,diamonds:65,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:40,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:25,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:15,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:5,outcome:"demote"}],[xt.Rising]:[{rankStart:1,rankEnd:1,diamonds:80,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:50,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:35,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:20,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:10,outcome:"demote"}],[xt.Ace]:[{rankStart:1,rankEnd:1,diamonds:95,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:60,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:45,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:25,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:15,outcome:"demote"}],[xt.Diamond]:[{rankStart:1,rankEnd:1,diamonds:110,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:70,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:55,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:30,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:20,outcome:"demote"}],[xt.Master]:[{rankStart:1,rankEnd:1,diamonds:125,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:80,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:65,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:35,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:25,outcome:"demote"}],[xt.Grandmaster]:[{rankStart:1,rankEnd:1,diamonds:150,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:100,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:80,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:50,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:35,outcome:"demote"}],[xt.Challenger]:[{rankStart:1,rankEnd:1,diamonds:200,outcome:"promote"},{rankStart:2,rankEnd:2,diamonds:125,outcome:"promote"},{rankStart:3,rankEnd:3,diamonds:100,outcome:"promote"},{rankStart:4,rankEnd:13,diamonds:75,outcome:"maintain"},{rankStart:14,rankEnd:16,diamonds:50,outcome:"demote"}]},At=[{name:"",icon:"/images/tire/tire9.png",color:"text-cyan-400",threshold:(e,n,s)=>e>=3500&&n<=100},{name:"",icon:"/images/tire/tire8.png",color:"text-purple-400",threshold:(e,n,s)=>e>=3e3},{name:"",icon:"/images/tire/tire7.png",color:"text-blue-400",threshold:(e,n,s)=>e>=2400},{name:"",icon:"/images/tire/tire6.png",color:"text-teal-400",threshold:(e,n,s)=>e>=2e3},{name:"",icon:"/images/tire/tire5.png",color:"text-yellow-400",threshold:(e,n,s)=>e>=1700},{name:"",icon:"/images/tire/tire4.png",color:"text-gray-300",threshold:(e,n,s)=>e>=1500},{name:"",icon:"/images/tire/tire3.png",color:"text-orange-400",threshold:(e,n,s)=>e>=1400},{name:"",icon:"/images/tire/tire2.png",color:"text-green-400",threshold:(e,n,s)=>e>=1300},{name:"",icon:"/images/tire/tire1.png",color:"text-green-200",threshold:(e,n,s)=>e<1300||s<50}],m0={:{diamonds:75,items:[{itemId:"  I",quantity:1},{itemId:"  I",quantity:1},{itemId:" 1",quantity:1}]},:{diamonds:100,items:[{itemId:"  I",quantity:1},{itemId:"  II",quantity:1},{itemId:" 2",quantity:1}]},:{diamonds:125,items:[{itemId:"  II",quantity:1},{itemId:"  II",quantity:1},{itemId:" 2",quantity:1}]},:{diamonds:150,items:[{itemId:"  II",quantity:1},{itemId:"  III",quantity:1},{itemId:" 3",quantity:1}]},:{diamonds:200,items:[{itemId:"  III",quantity:1},{itemId:"  III",quantity:1},{itemId:" 3",quantity:1}]},:{diamonds:250,items:[{itemId:"  IV",quantity:1},{itemId:"  IV",quantity:1},{itemId:" 4",quantity:1}]},:{diamonds:300,items:[{itemId:"  V",quantity:1},{itemId:"  V",quantity:1},{itemId:" 4",quantity:1}]},:{diamonds:400,items:[{itemId:"  V",quantity:1},{itemId:"  VI",quantity:1},{itemId:" 4",quantity:1}]},:{diamonds:500,items:[{itemId:"  VI",quantity:1},{itemId:"  VI",quantity:1},{itemId:" 4",quantity:1}]}},tu=5,f0=3,x0=5*60*1e3,p0=[10,20,30,50,80,120,180,250,350,500],nu=10,g0=30,jc=20,Tl=["uncommon","rare","epic","legendary","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic","mythic"],Ql=[{normal:50,uncommon:30},{normal:50,uncommon:30,rare:20},{normal:50,uncommon:30,rare:20,epic:10},{normal:50,uncommon:30,rare:20,epic:10,legendary:1},{normal:50,uncommon:30,rare:20,epic:10,legendary:1.5,mythic:25},{normal:65,uncommon:40,rare:25,epic:12.5,legendary:2,mythic:30},{normal:80,uncommon:50,rare:30,epic:15,legendary:2.5,mythic:35},{normal:95,uncommon:60,rare:35,epic:17.5,legendary:3,mythic:40},{normal:100,uncommon:70,rare:40,epic:20,legendary:3.5,mythic:45},{normal:100,uncommon:80,rare:45,epic:22.5,legendary:4,mythic:50},{normal:100,uncommon:90,rare:50,epic:25,legendary:4.5,mythic:55},{normal:100,uncommon:100,rare:55,epic:27.5,legendary:5,mythic:60},{normal:100,uncommon:100,rare:60,epic:30,legendary:5.5,mythic:65},{normal:100,uncommon:100,rare:65,epic:32.5,legendary:6,mythic:70},{normal:100,uncommon:100,rare:70,epic:35,legendary:6.5,mythic:75},{normal:100,uncommon:100,rare:75,epic:37.5,legendary:7,mythic:80},{normal:100,uncommon:100,rare:80,epic:40,legendary:7.5,mythic:85},{normal:100,uncommon:100,rare:85,epic:42.5,legendary:8,mythic:90},{normal:100,uncommon:100,rare:90,epic:45,legendary:8.5,mythic:95},{normal:100,uncommon:100,rare:100,epic:50,legendary:10,mythic:100}],ya=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40],su=e=>e<1?0:e>=jc?1/0:e*2e3,Ml={neighborhood:{id:"neighborhood",name:"",description:"6   .    !",format:"round-robin",players:6,image:"/images/championship/Champ1.png"},national:{id:"national",name:"",description:"  8   .",format:"tournament",players:8,image:"/images/championship/Champ2.png"},world:{id:"world",name:"",description:"    16 .",format:"tournament",players:16,image:"/images/championship/Champ3.png"}},h0={neighborhood:{rewardType:"rank",rewards:{1:{items:[{itemId:" 4",quantity:1},{itemId:" 1",quantity:1}]},2:{items:[{itemId:" 3",quantity:1}]},3:{items:[{itemId:" 2",quantity:1}]},4:{items:[{itemId:" 1",quantity:1}]}}},national:{rewardType:"rank",rewards:{1:{items:[{itemId:" 4",quantity:1},{itemId:" 2",quantity:1}]},2:{items:[{itemId:" 3",quantity:1},{itemId:" 1",quantity:1}]},3:{items:[{itemId:" 2",quantity:1},{itemId:" 1",quantity:1}]},4:{items:[{itemId:" 1",quantity:1},{itemId:" 1",quantity:1}]},5:{items:[{itemId:" 1",quantity:1}]}}},world:{rewardType:"rank",rewards:{1:{items:[{itemId:" 4",quantity:1},{itemId:" 3",quantity:1}]},2:{items:[{itemId:" 3",quantity:1},{itemId:" 2",quantity:1}]},3:{items:[{itemId:" 3",quantity:1},{itemId:" 1",quantity:1}]},4:{items:[{itemId:" 2",quantity:1},{itemId:" 1",quantity:1}]},5:{items:[{itemId:" 1",quantity:1},{itemId:" 1",quantity:1}]},9:{items:[{itemId:" 1",quantity:1}]}}}},Te=[{id:"profile_1",name:"  1",url:"/images/profiles/profile1.png",requiredLevel:1,type:"any"},{id:"profile_2",name:"  2",url:"/images/profiles/profile2.png",requiredLevel:1,type:"any"},{id:"profile_3",name:"  3",url:"/images/profiles/profile3.png",requiredLevel:1,type:"any"},{id:"profile_4",name:"  4",url:"/images/profiles/profile4.png",requiredLevel:1,type:"any"},{id:"profile_5",name:"  5",url:"/images/profiles/profile5.png",requiredLevel:1,type:"any"},{id:"profile_6",name:"  6",url:"/images/profiles/profile6.png",requiredLevel:1,type:"any"},{id:"profile_7",name:"  7",url:"/images/profiles/profile7.png",requiredLevel:1,type:"any"},{id:"profile_8",name:"  8",url:"/images/profiles/profile8.png",requiredLevel:1,type:"any"},{id:"profile_9",name:"  9",url:"/images/profiles/profile9.png",requiredLevel:1,type:"any"},{id:"profile_10",name:"  10",url:"/images/profiles/profile10.png",requiredLevel:1,type:"any"},{id:"profile_11",name:"  11",url:"/images/profiles/profile11.png",requiredLevel:1,type:"any"},{id:"profile_12",name:"  12",url:"/images/profiles/profile12.png",requiredLevel:1,type:"any"},{id:"profile_13",name:"  13",url:"/images/profiles/profile13.png",requiredLevel:1,type:"any"},{id:"profile_14",name:"  14",url:"/images/profiles/profile14.png",requiredLevel:1,type:"any"},{id:"profile_15",name:"  15",url:"/images/profiles/profile15.png",requiredLevel:1,type:"any"},{id:"profile_16",name:"  16",url:"/images/profiles/profile16.png",requiredLevel:1,type:"any"},{id:"profile_17",name:"  17",url:"/images/profiles/profile17.png",requiredLevel:1,type:"any"},{id:"profile_18",name:"  18",url:"/images/profiles/profile18.png",requiredLevel:1,type:"any"},{id:"profile_19",name:"  19",url:"/images/profiles/profile19.png",requiredLevel:1,type:"any"},{id:"profile_20",name:"  20",url:"/images/profiles/profile20.png",requiredLevel:1,type:"any"},{id:"profile_21",name:"  21",url:"/images/profiles/profile21.png",requiredLevel:1,type:"any"},{id:"profile_22",name:"  22",url:"/images/profiles/profile22.png",requiredLevel:1,type:"any"},{id:"profile_23",name:"  23",url:"/images/profiles/profile23.png",requiredLevel:1,type:"any"},{id:"profile_24",name:"  24",url:"/images/profiles/profile24.png",requiredLevel:1,type:"any"},{id:"profile_25",name:"  25",url:"/images/profiles/profile25.png",requiredLevel:1,type:"any"},{id:"profile_26",name:"  26",url:"/images/profiles/profile26.png",requiredLevel:1,type:"any"},{id:"profile_27",name:"  27",url:"/images/profiles/profile27.png",requiredLevel:1,type:"any"},{id:"profile_28",name:"  28",url:"/images/profiles/profile28.png",requiredLevel:1,type:"any"},{id:"profile_29",name:"  29",url:"/images/profiles/profile29.png",requiredLevel:1,type:"any"},{id:"profile_30",name:"  30",url:"/images/profiles/profile30.png",requiredLevel:1,type:"any"},{id:"profile_31",name:"  31",url:"/images/profiles/profile31.png",requiredLevel:1,type:"any"},{id:"profile_32",name:"  32",url:"/images/profiles/profile32.png",requiredLevel:1,type:"any"},{id:"profile_33",name:"  33",url:"/images/profiles/profile33.png",requiredLevel:1,type:"any"},{id:"profile_34",name:"  34",url:"/images/profiles/profile34.png",requiredLevel:1,type:"any"},{id:"profile_35",name:"  35",url:"/images/profiles/profile35.png",requiredLevel:1,type:"any"}],Re=[{id:"default",name:" ",url:"#FFFFFF",description:"   ."},{id:"simple_black",name:" ",url:"#000000",description:"    ."},{id:"red",name:"",url:"#ef4444",description:"/   3   .",requiredLevelSum:3},{id:"orange",name:"",url:"#f97316",description:"/   4   .",requiredLevelSum:4},{id:"yellow",name:"",url:"#eab308",description:"/   5   .",requiredLevelSum:5},{id:"green",name:"",url:"#22c55e",description:"/   6   .",requiredLevelSum:6},{id:"blue",name:"",url:"#3b82f6",description:"/   7   .",requiredLevelSum:7},{id:"indigo",name:"",url:"#6366f1",description:"/   8   .",requiredLevelSum:8},{id:"purple",name:"",url:"#8b5cf6",description:"/   9   .",requiredLevelSum:9},{id:"rainbow",name:"",url:"conic-gradient(red, yellow, lime, aqua, blue, magenta, red)",description:"/   10   .",requiredLevelSum:10},{id:"bronze_reward",name:" ",url:"/images/tire/Round1.png",description:"     .",unlockTier:""},{id:"silver_reward",name:" ",url:"/images/tire/Round2.png",description:"     .",unlockTier:""},{id:"gold_reward",name:" ",url:"/images/tire/Round3.png",description:"     .",unlockTier:""},{id:"platinum_reward",name:" ",url:"/images/tire/Round4.png",description:"     .",unlockTier:""},{id:"diamond_reward",name:" ",url:"/images/tire/Round5.png",description:"     .",unlockTier:""},{id:"master_reward",name:" ",url:"/images/tire/Round6.png",description:"     .",unlockTier:""},{id:"challenger_reward",name:" ",url:"/images/tire/Round7.png",description:"     .",unlockTier:""},{id:"tier_ring_1",name:"",url:"/images/tire/Ring1.png",description:"     ."},{id:"tier_ring_2",name:"",url:"/images/tire/Ring2.png",description:"     ."},{id:"tier_ring_3",name:"",url:"/images/tire/Ring3.png",description:"     ."},{id:"tier_ring_4",name:"",url:"/images/tire/Ring4.png",description:"     ."},{id:"tier_ring_5",name:"1",url:"/images/tire/Ring5.png",description:"     ."},{id:"tier_ring_6",name:"2",url:"/images/tire/Ring6.png",description:"     ."},{id:"tier_ring_7",name:"",url:"/images/tire/Ring7.png",description:"     ."},{id:"tier_ring_8",name:"VIP",url:"/images/tire/Ring8.png",description:"     ."}],lu=[{id:"tier_ring_1",name:"",url:"/images/tire/Ring1.png",description:"     .",price:{gold:1e4}},{id:"tier_ring_2",name:"",url:"/images/tire/Ring2.png",description:"     .",price:{gold:15e3}},{id:"tier_ring_3",name:"",url:"/images/tire/Ring3.png",description:"     .",price:{gold:3e4}},{id:"tier_ring_4",name:"",url:"/images/tire/Ring4.png",description:"     .",price:{diamonds:200}},{id:"tier_ring_5",name:"1",url:"/images/tire/Ring5.png",description:"     .",price:{diamonds:1e3}},{id:"tier_ring_6",name:"2",url:"/images/tire/Ring6.png",description:"     .",price:{diamonds:1e3}},{id:"tier_ring_7",name:"",url:"/images/tire/Ring7.png",description:"     .",price:{diamonds:1e3}},{id:"tier_ring_8",name:"VIP",url:"/images/tire/Ring8.png",description:"     .",price:{diamonds:2e3}}];M.Standard+"",M.Capture+"",M.Speed+"",M.Base+"",M.Hidden+"",M.Missile+"",M.Mix+"",M.Dice+"",M.Omok+"",M.Ttamok+"",M.Thief+"",M.Alkkagi+"",M.Curling+"";const fx=[",  ."," !",". ."," !",",   ."," .","GG!  .","?"],xx=["","","","","","","","",""],Jl=[{id:"-1",name:" 1",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:0,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:10},repeatClear:{gold:10,exp:10}}},{id:"-2",name:" 2",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:0,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:11},repeatClear:{gold:10,exp:10}}},{id:"-3",name:" 3",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:1,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:12},repeatClear:{gold:10,exp:10}}},{id:"-4",name:" 4",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:5,white:5},katagoLevel:1,placements:{black:2,white:2,blackPattern:2,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:13},repeatClear:{gold:10,exp:10}}},{id:"-5",name:" 5",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:2,white:3,blackPattern:2,whitePattern:1,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:14,items:[{itemId:" 1",quantity:1}]},repeatClear:{gold:10,exp:10}}},{id:"-6",name:" 6",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:5,blackPattern:2,whitePattern:0,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:15},repeatClear:{gold:10,exp:10}}},{id:"-7",name:" 7",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:4,blackPattern:2,whitePattern:2,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:16},repeatClear:{gold:10,exp:10}}},{id:"-8",name:" 8",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:5,blackPattern:3,whitePattern:2,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:100,exp:17},repeatClear:{gold:10,exp:10}}},{id:"-9",name:" 9",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:6,white:6},katagoLevel:1,placements:{black:3,white:4,blackPattern:3,whitePattern:3,centerBlackStoneChance:90},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:100,exp:18},repeatClear:{gold:10,exp:10}}},{id:"-10",name:" 10",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:2,whitePattern:3,centerBlackStoneChance:50},timeControl:{type:"fischer",mainTime:5,increment:10},rewards:{firstClear:{gold:150,exp:20,items:[{itemId:"  I",quantity:1}]},repeatClear:{gold:10,exp:15}}},{id:"-11",name:" 11",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:5,blackPattern:2,whitePattern:2,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:21},repeatClear:{gold:10,exp:10}}},{id:"-12",name:" 12",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:2,whitePattern:3,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:22},repeatClear:{gold:10,exp:10}}},{id:"-13",name:" 13",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:3,whitePattern:2,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:23},repeatClear:{gold:10,exp:10}}},{id:"-14",name:" 14",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:7,white:7},katagoLevel:2,placements:{black:4,white:4,blackPattern:3,whitePattern:4,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:24},repeatClear:{gold:10,exp:10}}},{id:"-15",name:" 15",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:6,blackPattern:2,whitePattern:3,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:25,items:[{itemId:"  I",quantity:1}]},repeatClear:{gold:10,exp:10}}},{id:"-16",name:" 16",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:4,blackPattern:3,whitePattern:3,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:26},repeatClear:{gold:10,exp:10}}},{id:"-17",name:" 17",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:4,blackPattern:4,whitePattern:4,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:27},repeatClear:{gold:10,exp:10}}},{id:"-18",name:" 18",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:5,blackPattern:3,whitePattern:4,centerBlackStoneChance:80},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:5},rewards:{firstClear:{gold:150,exp:28},repeatClear:{gold:10,exp:10}}},{id:"-19",name:" 19",level:Pe.,actionPointCost:2,boardSize:7,targetScore:{black:8,white:8},katagoLevel:2,placements:{black:4,white:4,blackPattern:2,whitePattern:2,centerBlackStoneChance:80},timeControl:{type:"fischer",mainTime:1,increment:8},rewards:{firstClear:{gold:150,exp:30},repeatClear:{gold:10,exp:10}}},{id:"-20",name:" 20",level:Pe.,actionPointCost:3,boardSize:7,targetScore:{black:9,white:8},katagoLevel:2,placements:{black:5,white:5,blackPattern:2,whitePattern:1,centerBlackStoneChance:50},timeControl:{type:"byoyomi",mainTime:5,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:50,items:[{itemId:" 1",quantity:1}],bonus:"10"},repeatClear:{gold:30,exp:20}}},{id:"-1",name:" 1",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:5,blackPattern:2,whitePattern:4,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:30},repeatClear:{gold:30,exp:20}}},{id:"-2",name:" 2",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:5,blackPattern:3,whitePattern:4,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:32},repeatClear:{gold:30,exp:20}}},{id:"-3",name:" 3",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:5,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:34},repeatClear:{gold:30,exp:20}}},{id:"-4",name:" 4",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:9,white:8},katagoLevel:3,placements:{black:5,white:6,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:36},repeatClear:{gold:30,exp:20}}},{id:"-5",name:" 5",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:6,blackPattern:4,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:38,items:[{itemId:" 2",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-6",name:" 6",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:3,white:6,blackPattern:4,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:40},repeatClear:{gold:30,exp:20}}},{id:"-7",name:" 7",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:6,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:42},repeatClear:{gold:30,exp:20}}},{id:"-8",name:" 8",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:6,blackPattern:3,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:200,exp:44,items:[{itemId:"  I",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-9",name:" 9",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:10,white:9},katagoLevel:4,placements:{black:5,white:5,blackPattern:2,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"fischer",mainTime:1,increment:8},rewards:{firstClear:{gold:200,exp:46},repeatClear:{gold:30,exp:20}}},{id:"-10",name:" 10",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:6,blackPattern:2,whitePattern:4,centerBlackStoneChance:50},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:50,items:[{itemId:"  II",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-11",name:" 11",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:6,blackPattern:1,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:52},repeatClear:{gold:30,exp:20}}},{id:"-12",name:" 12",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:6,blackPattern:2,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:54},repeatClear:{gold:30,exp:20}}},{id:"-13",name:" 13",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:7,blackPattern:3,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:56},repeatClear:{gold:30,exp:20}}},{id:"-14",name:" 14",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:11,white:9},katagoLevel:5,placements:{black:6,white:7,blackPattern:3,whitePattern:4,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:0,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:58},repeatClear:{gold:30,exp:20}}},{id:"-15",name:" 15",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:3,white:6,blackPattern:4,whitePattern:1,centerBlackStoneChance:70},timeControl:{type:"fischer",mainTime:1,increment:7},rewards:{firstClear:{gold:250,exp:60,items:[{itemId:"  II",quantity:1}]},repeatClear:{gold:30,exp:20}}},{id:"-16",name:" 16",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:4,white:8,blackPattern:5,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:62},repeatClear:{gold:30,exp:20}}},{id:"-17",name:" 17",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:6,white:6,blackPattern:1,whitePattern:2,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:64},repeatClear:{gold:30,exp:20}}},{id:"-18",name:" 18",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:4,white:8,blackPattern:5,whitePattern:3,centerBlackStoneChance:70},timeControl:{type:"byoyomi",mainTime:1,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:250,exp:66},repeatClear:{gold:30,exp:20}}},{id:"-19",name:" 19",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:12,white:10},katagoLevel:6,placements:{black:6,white:6,blackPattern:5,whitePattern:3,centerBlackStoneChance:50},timeControl:{type:"fischer",mainTime:1,increment:7},rewards:{firstClear:{gold:250,exp:100},repeatClear:{gold:30,exp:20}}},{id:"-20",name:" 20",level:Pe.,actionPointCost:3,boardSize:9,targetScore:{black:15,white:12},katagoLevel:7,placements:{black:5,white:6,blackPattern:5,whitePattern:3,centerBlackStoneChance:50},timeControl:{type:"byoyomi",mainTime:3,byoyomiTime:30,byoyomiCount:3},rewards:{firstClear:{gold:300,exp:120,items:[{itemId:" 2",quantity:1}],bonus:"10"},repeatClear:{gold:50,exp:30}}}],px=e=>{const n=e.mannerScore??200,s={maxActionPoints:30,actionPointRegenInterval:x0,goldBonusPercent:0,itemDropRateBonus:0,mannerActionButtonBonus:0,rewardMultiplier:1,enhancementSuccessRateBonus:0};return n>=400&&(s.maxActionPoints+=10),n>=800&&(s.goldBonusPercent+=10),n>=1200&&(s.itemDropRateBonus+=10),n>=1600&&(s.enhancementSuccessRateBonus+=10),n<=199&&(s.mannerActionButtonBonus+=1),n<=99&&(s.rewardMultiplier*=.5),n<=49&&(s.actionPointRegenInterval=20*60*1e3),n<=0&&(s.maxActionPoints=Math.floor(s.maxActionPoints*.1)),s},gx=e=>{const s={...px(e),coreStatBonuses:{},specialStatBonuses:{},mythicStatBonuses:{}};for(const a of Object.values(N))s.coreStatBonuses[a]={flat:0,percent:0};for(const a of Object.values(ze))s.specialStatBonuses[a]={flat:0,percent:0};for(const a of Object.values(rt))s.mythicStatBonuses[a]={flat:0,percent:0};const l=e.inventory.filter(a=>a.isEquipped&&a.type==="equipment"&&a.options);for(const a of l){const i=[a.options.main,...a.options.combatSubs,...a.options.specialSubs,...a.options.mythicSubs];for(const o of i){if(!o)continue;const{type:c,value:d,isPercentage:u}=o;Object.values(N).includes(c)?u?s.coreStatBonuses[c].percent+=d:s.coreStatBonuses[c].flat+=d:Object.values(ze).includes(c)?u?s.specialStatBonuses[c].percent+=d:s.specialStatBonuses[c].flat+=d:Object.values(rt).includes(c)&&(s.mythicStatBonuses[c].flat+=d)}}s.maxActionPoints+=s.specialStatBonuses[ze.ActionPointMax].flat;const r=s.specialStatBonuses[ze.ActionPointRegen].percent;return r>0&&(s.actionPointRegenInterval=Math.floor(s.actionPointRegenInterval/(1+r/100))),s},yn={graphics:{theme:"black",panelColor:void 0,textColor:void 0},sound:{masterVolume:.5,masterMuted:!1,categoryMuted:{stone:!1,notification:!1,item:!1,countdown:!1,turn:!1}},features:{mobileConfirm:!1,stonePreview:!0,lastMoveMarker:!0,questNotifications:!0,chatNotifications:!0}},ru="appSettings_v2";class y0{constructor(){Mn(this,"audioContext",null);Mn(this,"isInitializing",!1);Mn(this,"scanBgmSourceNode",null);Mn(this,"timerWarningSourceNode",null);Mn(this,"audioBuffers",new Map);Mn(this,"soundsPath","/sound/");Mn(this,"settings",yn.sound)}isReady(){return!!this.audioContext&&this.audioContext.state==="running"}async initialize(){if(!(this.isReady()||this.isInitializing)){this.isInitializing=!0;try{this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.audioContext.state==="suspended"&&await this.audioContext.resume()}catch(n){console.error("Audio context initialization failed:",n)}finally{this.isInitializing=!1}}}updateSettings(n){this.settings=n}async loadSound(n){if(this.audioContext||await this.initialize(),!this.audioContext)return null;if(this.audioBuffers.has(n))return this.audioBuffers.get(n);try{const s=await fetch(n);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const l=await s.arrayBuffer(),r=await this.audioContext.decodeAudioData(l);return this.audioBuffers.set(n,r),r}catch(s){return console.error(`Failed to load sound: ${n}`,s),null}}playSound(n,s=1,l=!1){if(!this.isReady()||!this.audioContext)return null;const r=this.audioContext.createBufferSource();r.buffer=n,r.loop=l;const a=this.audioContext.createGain();return a.gain.setValueAtTime(s,this.audioContext.currentTime),r.connect(a),a.connect(this.audioContext.destination),r.start(0),r}async play(n,s,l,r=!1){if(this.settings.masterMuted||this.settings.categoryMuted[s])return null;try{const a=await this.loadSound(`${this.soundsPath}${n}.mp3`);if(a)return this.playSound(a,l*this.settings.masterVolume,r)}catch(a){console.error(`Could not play sound ${n}`,a)}return null}placeStone(){this.play("move","stone",.7)}rollDice(n){this.play("dice","item",.6),n>1&&setTimeout(()=>this.play("dice","item",.6),500)}enhancementFail(){this.play("failure","notification",.7)}revealHiddenStone(){this.play("hidden","item",.8)}async playScanBgm(){this.stopScanBgm(),this.scanBgmSourceNode=await this.play("scanbgm","item",.4,!0)}stopScanBgm(){if(this.scanBgmSourceNode){try{this.scanBgmSourceNode.stop()}catch{}this.scanBgmSourceNode=null}}scanSuccess(){this.play("find","item",.7)}stoneCollision(){this.play("hit","stone",.4)}launchMissile(){this.play("rocket","item",.7)}gameLose(){this.play("lose","notification",.6)}gameWin(){this.play("win","notification",.6)}levelUp(){this.play("levelup","notification",.7)}disassemblyJackpot(){this.play("jackpot2","notification",.8)}gachaEpicOrHigher(){this.play("jackpot","notification",.7)}gameStart(){this.play("gamestart","notification",.6)}myTurn(){this.play("myturn","turn",.7)}scanFail(){this.play("scanfail","item",.6)}async timerWarning(){this.stopTimerWarning(),this.timerWarningSourceNode=await this.play("timer10","countdown",.7)}stopTimerWarning(){if(this.timerWarningSourceNode){try{this.timerWarningSourceNode.stop()}catch{}this.timerWarningSourceNode=null}}timeoutFoul(){this.play("bip","notification",.8)}enhancementSuccess(){this.play("success","notification",.7)}combinationGreatSuccess(){this.play("jackpot","notification",.7)}combinationSuccess(){this.play("success","notification",.7)}stoneFallOff(){this.play("fall","stone",.5)}claimReward(){this.play("reward","notification",.7)}}const Ee=new y0;function au(e){const n=e.replace(/^#\/?/,""),[s,...l]=n.split("/");switch(s){case"lobby":return{view:"lobby",params:{type:l[0]||"strategic"}};case"waiting":return{view:"waiting",params:{mode:l[0]?decodeURIComponent(l[0]):null}};case"game":return{view:"game",params:{id:l[0]}};case"tournament":return{view:"tournament",params:{}};case"singleplayer":return{view:"singleplayer",params:{}};case"admin":return{view:"admin",params:{}};case"register":return{view:"register",params:{}};case"profile":return{view:"profile",params:{}};default:return{view:"login",params:{}}}}const b0=()=>{const[e,n]=f.useState(()=>{try{const X=sessionStorage.getItem("currentUser");if(X)return JSON.parse(X)}catch(X){console.error("Failed to parse user from sessionStorage",X)}return null}),[s,l]=f.useState(()=>au(window.location.hash)),r=f.useRef(s),[a,i]=f.useState(null),o=f.useRef(!1),[c,d]=f.useState(()=>{try{const X=localStorage.getItem(ru);if(X){let re=JSON.parse(X);return typeof re.theme=="string"&&(re={...yn,graphics:{theme:re.theme,panelColor:void 0,textColor:void 0},sound:re.sound||yn.sound,features:re.features||yn.features}),{...yn,...re,graphics:{...yn.graphics,...re.graphics||{}},sound:{...yn.sound,...re.sound||{}},features:{...yn.features,...re.features||{}}}}}catch(X){console.error("Error reading settings from localStorage",X)}return yn}),[u,p]=f.useState({}),[m,h]=f.useState([]),[y,v]=f.useState({}),[b,g]=f.useState({}),[x,j]=f.useState({}),[w,k]=f.useState({}),[C,S]=f.useState([]),[P,_]=f.useState({}),[I,T]=f.useState([]),[B,R]=f.useState(null),[A,L]=f.useState(3),[Q,q]=f.useState(!1),[O,U]=f.useState(!1),[G,z]=f.useState(!1),[H,ne]=f.useState(!1),[oe,me]=f.useState(!1),[ve,J]=f.useState(null),[fe,ye]=f.useState(null),[K,W]=f.useState(null),[D,V]=f.useState(null),[Y,ie]=f.useState(!1),[je,E]=f.useState(null),[Z,le]=f.useState(null),[ae,de]=f.useState(!1),[te,pe]=f.useState(!1),[we,ue]=f.useState(!1),[Se,qe]=f.useState(null),[Be,He]=f.useState(null),[se,Me]=f.useState(null),[_e,Ge]=f.useState(null),[it,Gt]=f.useState(null),[bt,en]=f.useState(null),[Ct,vt]=f.useState(!1),xe=f.useRef(null),[ce,Ae]=f.useState(!1),[ke,Ie]=f.useState(null),[mt,ot]=f.useState(!1),[Wt,Ht]=f.useState(!1),[cn,dn]=f.useState(!1),[un,ss]=f.useState(null),[lr,js]=f.useState("enhance"),[Ua,rr]=f.useState(null),[za,ar]=f.useState(!1),[Fa,Ve]=f.useState(!1);f.useEffect(()=>{Ve(!!Be)},[Be]),f.useEffect(()=>{try{localStorage.setItem(ru,JSON.stringify(c))}catch(re){console.error("Error saving settings to localStorage",re)}const X=document.documentElement;c.graphics.panelColor?X.style.setProperty("--custom-panel-bg",c.graphics.panelColor):X.style.removeProperty("--custom-panel-bg"),c.graphics.textColor?X.style.setProperty("--custom-text-color",c.graphics.textColor):X.style.removeProperty("--custom-text-color")},[c]),f.useEffect(()=>{document.documentElement.setAttribute("data-theme",c.graphics.theme)},[c.graphics.theme]),f.useEffect(()=>{Ee.updateSettings(c.sound)},[c.sound]);const Ga=f.useCallback(X=>{d(re=>({...re,graphics:{...re.graphics,theme:X,panelColor:void 0,textColor:void 0}}))},[]),ls=f.useCallback(X=>{d(re=>({...re,graphics:{...re.graphics,panelColor:X}}))},[]),$x=f.useCallback(X=>{d(re=>({...re,graphics:{...re.graphics,textColor:X}}))},[]),Ox=f.useCallback(()=>{d(X=>({...X,graphics:{...X.graphics,panelColor:void 0,textColor:void 0}}))},[]),Dx=f.useCallback((X,re)=>{d(ge=>({...ge,sound:{...ge.sound,[X]:re}}))},[]),qx=f.useCallback((X,re)=>{d(ge=>({...ge,features:{...ge.features,[X]:re}}))},[]),al=f.useMemo(()=>Object.values(u),[u]),Ke=f.useMemo(()=>{if(!e)return null;const X=m.find(re=>re.id===e.id);return{...e,...X||{status:"online"}}},[e,m]),rs=f.useMemo(()=>{if(!Ke)return null;const X=Ke.gameId||Ke.spectatingGameId;if(X&&(Ke.status==="in-game"||Ke.status==="spectating"||Ke.status==="negotiating")){const re=y[X];if(re)return re}return null},[Ke,y]),Ux=f.useMemo(()=>Ke&&Object.values(b).find(X=>X.challenger.id===Ke.id||X.opponent.id===Ke.id&&X.status==="pending")||null,[Ke,b]),zx=f.useMemo(()=>(e==null?void 0:e.mail.filter(X=>!X.isRead).length)||0,[e==null?void 0:e.mail]),Fx=f.useMemo(()=>{if(!(e!=null&&e.quests))return!1;const{daily:X,weekly:re,monthly:ge}=e.quests,Ne=Ue=>Ue?Ue.quests.some(We=>We.progress>=We.target&&!We.isClaimed):!1,Je=(Ue,We)=>!Ue||!We?!1:Ue.claimedMilestones.some((il,mn)=>!il&&Ue.activityProgress>=We[mn]);return Ne(X)||Ne(re)||Ne(ge)||Je(X,dx)||Je(re,ux)||Je(ge,mx)},[e==null?void 0:e.quests]),Sc=X=>{let re=X;X.includes("Invalid move: ko")?re=" .         .":X.includes("action point")&&(re="   ."),i(re),setTimeout(()=>i(null),5e3)};f.useEffect(()=>{e?sessionStorage.setItem("currentUser",JSON.stringify(e)):sessionStorage.removeItem("currentUser")},[e]);const ws=f.useCallback(async X=>{X.type==="CLEAR_TOURNAMENT_SESSION"&&n(re=>re?{...re,lastNeighborhoodTournament:null,lastNationalTournament:null,lastWorldTournament:null}:null),X.type==="TOGGLE_EQUIP_ITEM"?n(re=>{if(!re)return null;const{itemId:ge}=X.payload,Ne=re.inventory.find(mn=>mn.id===ge);if(!Ne||Ne.type!=="equipment"||!Ne.slot)return re;const Je=Ne.slot,Ue=!Ne.isEquipped,We={...re.equipment};Ue?We[Je]=Ne.id:delete We[Je];const il=re.inventory.map(mn=>mn.id===ge?{...mn,isEquipped:Ue}:Ue&&mn.slot===Je&&mn.id!==ge?{...mn,isEquipped:!1}:mn);return{...re,inventory:il,equipment:We}}):X.type==="SAVE_PRESET"&&n(re=>{if(!re)return null;const{preset:ge,index:Ne}=X.payload,Je=[...re.equipmentPresets];return Je[Ne]=ge,{...re,equipmentPresets:Je}});try{Ee.initialize();const re=await fetch("/api/action",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...X,userId:e==null?void 0:e.id})});if(re.ok){const ge=await re.json();if(ge.updatedUser&&n(ge.updatedUser),ge.obtainedItemsBulk&&J(ge.obtainedItemsBulk),ge.rewardSummary&&V(ge.rewardSummary),ge.claimAllSummary&&(E(ge.claimAllSummary),ie(!0)),ge.disassemblyResult&&(ye(ge.disassemblyResult),ge.disassemblyResult.jackpot&&Ee.disassemblyJackpot()),ge.craftResult&&W(ge.craftResult),ge.combinationResult&&(rr(ge.combinationResult),ge.combinationResult.isGreatSuccess?Ee.combinationGreatSuccess():Ee.combinationSuccess()),ge.enhancementOutcome){const{message:Ne,success:Je,itemBefore:Ue,itemAfter:We}=ge.enhancementOutcome;qe({message:Ne,success:Je}),He({message:Ne,success:Je,itemBefore:Ue,itemAfter:We}),Je?Ee.enhancementSuccess():Ee.enhancementFail()}ge.enhancementAnimationTarget&&Me(ge.enhancementAnimationTarget),ge.redirectToTournament&&(window.location.hash=`#/tournament/${ge.redirectToTournament}`)}else{const ge=await re.json();Sc(ge.message||"An unknown error occurred."),(X.type==="TOGGLE_EQUIP_ITEM"||X.type==="USE_ITEM")&&n(Ne=>Ne?{...Ne}:null)}}catch(re){Sc(re.message)}},[e==null?void 0:e.id]),Wa=f.useCallback(()=>{e&&(o.current=!0,ws({type:"LOGOUT"}),n(null),window.location.hash="")},[e,ws]);f.useEffect(()=>{if(!(e!=null&&e.id))return;const X=async()=>{if(!o.current)try{const ge=await fetch("/api/state",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id})});if(o.current)return;if(!ge.ok)throw ge.status===401&&(n(null),window.location.hash=""),new Error("Failed to fetch state");const Ne=await ge.json();if(o.current)return;const Je=Ne.users[e.id];n(Je||null),p(Ne.users),v(Ne.liveGames),g(Ne.negotiations),j(Ne.waitingRoomChats),k(Ne.gameChats),S(Ne.adminLogs),_(Ne.gameModeAvailability),T(Ne.announcements),R(Ne.globalOverrideAnnouncement),L(Ne.announcementInterval);const Ue=Object.entries(Ne.userStatuses).map(([We,il])=>({...Ne.users[We],...il}));h(Ue)}catch(ge){console.error("Polling error:",ge)}};X();const re=setInterval(X,1e3);return()=>clearInterval(re)},[e==null?void 0:e.id]);const Ha=f.useRef(!1);f.useEffect(()=>{r.current=s},[s]),f.useEffect(()=>{const X=()=>{const re=r.current,ge=au(window.location.hash);if(re.view==="profile"&&ge.view==="login"&&window.location.hash===""&&e)if(Ct)Wa();else{vt(!0),xe.current=window.setTimeout(()=>vt(!1),2e3),window.history.pushState(null,"","#/profile");return}else xe.current&&clearTimeout(xe.current),Ct&&vt(!1);l(ge)};return window.addEventListener("hashchange",X),()=>window.removeEventListener("hashchange",X)},[e,Wa,Ct]),f.useEffect(()=>{if(!e){Ha.current=!1,window.location.hash&&window.location.hash!=="#/register"&&(window.location.hash="");return}const X=window.location.hash;if(!Ha.current&&(Ha.current=!0,X===""||X==="#/")){if(rs){window.location.hash=`#/game/${rs.id}`;return}window.location.hash="#/profile";return}const re=X.startsWith("#/game/");if(rs&&!re)window.location.hash=`#/game/${rs.id}`;else if(!rs&&re){let ge="#/profile";(Ke==null?void 0:Ke.status)==="waiting"&&(Ke!=null&&Ke.mode)&&(ge=`#/waiting/${encodeURIComponent(Ke.mode)}`),X!==ge&&(window.location.hash=ge)}},[e,rs,Ke]),f.useEffect(()=>{const X=()=>document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`);return X(),window.addEventListener("resize",X),window.addEventListener("orientationchange",X),()=>{window.removeEventListener("resize",X),window.removeEventListener("orientationchange",X)}},[]),f.useEffect(()=>{if(Se){const X=setTimeout(()=>{qe(null)},5e3);return()=>clearTimeout(X)}},[Se]);const Gx=X=>{ws({type:"ENTER_WAITING_ROOM",payload:{mode:X}}),window.location.hash=`#/waiting/${encodeURIComponent(X)}`},Wx=f.useCallback(X=>{const re=m.find(ge=>ge.id===X)||al.find(ge=>ge.id===X);if(re){const ge=m.find(Ne=>Ne.id===X);le({...re,...ge||{status:"online"}})}},[m,al]),Hx=f.useCallback(X=>{const re=m.find(ge=>ge.id===X)||al.find(ge=>ge.id===X);if(re){const ge=m.find(Ne=>Ne.id===X);Ie({...re,...ge||{status:"online"}})}},[m,al]),Vx=f.useCallback(()=>Ie(null),[]),Kx=f.useCallback(X=>{n(X),window.location.hash="#/profile"},[]),Qx=f.useCallback(X=>{ss(X),js("enhance"),dn(!0)},[]),Jx=f.useCallback(X=>{ss(X),js("enhance"),dn(!0)},[]),Yx=f.useCallback((X,re)=>{en({item:X,isOwnedByCurrentUser:re})},[]),Xx=f.useCallback(()=>{if(Be!=null&&Be.success){const X=Be.itemAfter;en(re=>re&&X&&re.item.id===X.id?{...re,item:X}:re),n(re=>re?{...re,inventory:re.inventory.map(ge=>ge.id===X.id?X:ge)}:null)}He(null)},[Be]),Zx=f.useCallback(()=>{He(null)},[]),ep=f.useCallback(()=>{ie(!1),E(null)},[]),tp=f.useCallback(X=>{ws({type:"APPLY_PRESET",payload:{presetName:X.name}})},[ws]),np=f.useMemo(()=>(e==null?void 0:e.equipmentPresets)||[],[e]),{mainOptionBonuses:sp,combatSubOptionBonuses:lp,specialStatBonuses:rp,aggregatedMythicStats:ap}=f.useMemo(()=>{const X={mainOptionBonuses:{},combatSubOptionBonuses:{},specialStatBonuses:{},aggregatedMythicStats:{}};return!Ke||!Ke.equipment||!Ke.inventory?X:Ke.inventory.filter(Ne=>Object.values(Ke.equipment).includes(Ne.id)).reduce((Ne,Je)=>{if(!Je.options)return Ne;if(Je.options.main){const Ue=Je.options.main.type;Ne.mainOptionBonuses[Ue]||(Ne.mainOptionBonuses[Ue]={value:0,isPercentage:Je.options.main.isPercentage}),Ne.mainOptionBonuses[Ue].value+=Je.options.main.value}return Je.options.combatSubs.forEach(Ue=>{const We=Ue.type;Ne.combatSubOptionBonuses[We]||(Ne.combatSubOptionBonuses[We]={value:0,isPercentage:Ue.isPercentage}),Ne.combatSubOptionBonuses[We].value+=Ue.value}),Je.options.specialSubs.forEach(Ue=>{const We=Ue.type;Ne.specialStatBonuses[We]||(Ne.specialStatBonuses[We]={flat:0,percent:0}),Ue.isPercentage?Ne.specialStatBonuses[We].percent+=Ue.value:Ne.specialStatBonuses[We].flat+=Ue.value}),Je.options.mythicSubs.forEach(Ue=>{const We=Ue.type;Ne.aggregatedMythicStats[We]||(Ne.aggregatedMythicStats[We]={count:0,totalValue:0}),Ne.aggregatedMythicStats[We].count++,Ne.aggregatedMythicStats[We].totalValue+=Ue.value}),Ne},X)},[Ke]);return{currentUser:e,presets:np,setCurrentUserAndRoute:Kx,currentUserWithStatus:Ke,currentRoute:s,error:a,allUsers:al,onlineUsers:m,liveGames:y,negotiations:b,waitingRoomChats:x,gameChats:w,adminLogs:C,gameModeAvailability:P,announcements:I,globalOverrideAnnouncement:B,announcementInterval:A,activeGame:rs,activeNegotiation:Ux,showExitToast:Ct,enhancementResult:Se,enhancementOutcome:Be,unreadMailCount:zx,hasClaimableQuest:Fx,settings:c,updateTheme:Ga,updateSoundSetting:Dx,updateFeatureSetting:qx,updatePanelColor:ls,updateTextColor:$x,resetGraphicsToDefault:Ox,mainOptionBonuses:sp,combatSubOptionBonuses:lp,specialStatBonuses:rp,aggregatedMythicStats:ap,modals:{isSettingsModalOpen:Q,isInventoryOpen:O,isMailboxOpen:G,isQuestsOpen:H,isShopOpen:oe,lastUsedItemResult:ve,disassemblyResult:fe,craftResult:K,rewardSummary:D,viewingUser:Z,isInfoModalOpen:ae,isEncyclopediaOpen:te,isStatAllocationModalOpen:we,enhancementAnimationTarget:se,pastRankingsInfo:_e,viewingItem:bt,isProfileEditModalOpen:ce,moderatingUser:ke,isClaimAllSummaryOpen:Y,claimAllSummary:je,isMbtiInfoModalOpen:mt,isEquipmentEffectsModalOpen:Wt,isBlacksmithModalOpen:cn,blacksmithSelectedItemForEnhancement:un,blacksmithActiveTab:lr,combinationResult:Ua,isBlacksmithHelpOpen:za,isEnhancementResultModalOpen:Fa,enhancingItem:it},handlers:{handleAction:ws,handleLogout:Wa,handleEnterWaitingRoom:Gx,applyPreset:tp,openSettingsModal:()=>q(!0),closeSettingsModal:()=>q(!1),openInventory:()=>U(!0),closeInventory:()=>U(!1),openMailbox:()=>z(!0),closeMailbox:()=>z(!1),openQuests:()=>ne(!0),closeQuests:()=>ne(!1),openShop:()=>me(!0),closeShop:()=>me(!1),closeItemObtained:()=>J(null),closeDisassemblyResult:()=>ye(null),closeCraftResult:()=>W(null),closeCombinationResult:()=>rr(null),closeRewardSummary:()=>V(null),closeClaimAllSummary:ep,openViewingUser:Wx,closeViewingUser:()=>le(null),openInfoModal:()=>de(!0),closeInfoModal:()=>de(!1),openEncyclopedia:()=>pe(!0),closeEncyclopedia:()=>pe(!1),openStatAllocationModal:()=>ue(!0),closeStatAllocationModal:()=>ue(!1),openProfileEditModal:()=>Ae(!0),closeProfileEditModal:()=>Ae(!1),openPastRankings:X=>Ge(X),closePastRankings:()=>Ge(null),openViewingItem:Yx,closeViewingItem:()=>en(null),openEnhancingItem:Qx,openEnhancementFromDetail:Jx,clearEnhancementOutcome:Xx,clearEnhancementAnimation:()=>Me(null),openModerationModal:Hx,closeModerationModal:Vx,openMbtiInfoModal:()=>ot(!0),closeMbtiInfoModal:()=>ot(!1),openEquipmentEffectsModal:()=>Ht(!0),closeEquipmentEffectsModal:()=>Ht(!1),openBlacksmithModal:()=>dn(!0),closeBlacksmithModal:()=>{dn(!1),ss(null),js("enhance")},openBlacksmithHelp:()=>ar(!0),closeBlacksmithHelp:()=>ar(!1),setBlacksmithActiveTab:js,closeEnhancementModal:Zx}}},hx=f.createContext(void 0),v0=({children:e})=>{const n=b0();return t.jsx(hx.Provider,{value:n,children:e})},De=()=>{const e=f.useContext(hx);if(e===void 0)throw new Error("useAppContext must be used within an AppProvider");return e},vi=({icon:e,value:n,className:s})=>t.jsxs("div",{className:`flex items-center gap-1 sm:gap-2 bg-tertiary/50 rounded-full py-1 pl-1 pr-2 sm:pr-3 shadow-inner ${s}`,children:[t.jsx("div",{className:"bg-primary w-7 h-7 flex items-center justify-center rounded-full text-lg flex-shrink-0",children:e}),t.jsx("span",{className:"font-bold text-xs sm:text-sm text-primary",children:n})]}),j0=({user:e})=>{const{actionPoints:n,lastActionPointUpdate:s}=e,[l,r]=f.useState(""),a=f.useMemo(()=>px(e).actionPointRegenInterval,[e]);return f.useEffect(()=>{if(n.current>=n.max){r("");return}const i=()=>{const c=s+a,d=Math.max(0,c-Date.now()),u=Math.floor(d/1e3),p=Math.floor(u/60),m=u%60;r(`${String(p).padStart(2,"0")}:${String(m).padStart(2,"0")}`)};i();const o=setInterval(i,1e3);return()=>clearInterval(o)},[n.current,n.max,s,a]),l?t.jsxs("span",{className:"text-xs text-tertiary font-mono text-center",children:["(",l,")"]}):null},w0=()=>{const{currentUserWithStatus:e,handlers:n,unreadMailCount:s}=De();if(!e)return null;const{handleLogout:l,openShop:r,openSettingsModal:a,openProfileEditModal:i,openMailbox:o}=n,{actionPoints:c,gold:d,diamonds:u,isAdmin:p,avatarId:m,borderId:h,mbti:y}=e,v=f.useMemo(()=>{var g;return(g=Te.find(x=>x.id===m))==null?void 0:g.url},[m]),b=f.useMemo(()=>{var g;return(g=Re.find(x=>x.id===h))==null?void 0:g.url},[h]);return t.jsx("header",{className:"flex-shrink-0 bg-primary/80 backdrop-blur-sm shadow-lg",children:t.jsxs("div",{className:"p-2 flex justify-between items-center gap-2 h-[60px]",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink min-w-0 cursor-pointer relative",onClick:i,children:[t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:v,borderUrl:b,size:40}),t.jsxs("div",{className:"hidden sm:block min-w-0",children:[t.jsx("h1",{className:"font-bold text-primary truncate",children:e.nickname}),t.jsxs("p",{className:"text-xs text-tertiary truncate",children:[" Lv.",e.strategyLevel," /  Lv.",e.playfulLevel]})]}),!y&&t.jsx("span",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"})]}),t.jsxs("div",{className:"flex items-center justify-end flex-wrap gap-1 sm:gap-2",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(vi,{icon:"",value:`${c.current}/${c.max}`}),t.jsx(j0,{user:e}),t.jsx("button",{onClick:r,className:"ml-1 w-6 h-6 flex-shrink-0 rounded-full bg-green-600 hover:bg-green-500 text-white font-bold flex items-center justify-center text-lg shadow-md transition-transform hover:scale-110 active:scale-95",title:" ",children:"+"})]}),t.jsx(vi,{icon:t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-5 h-5 object-contain"}),value:d.toLocaleString()}),t.jsx(vi,{icon:t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-5 h-5 object-contain"}),value:u.toLocaleString()}),t.jsx("div",{className:"h-9 w-px bg-border-color mx-1 sm:mx-2"}),p&&t.jsx(F,{onClick:()=>window.location.hash="#/admin",colorScheme:"purple",className:"text-xs sm:text-sm",children:""}),t.jsxs("button",{onClick:o,className:"relative p-2 rounded-lg text-xl hover:bg-secondary transition-colors",title:"",children:[t.jsx("img",{src:"/images/icon/mail.png",alt:"",className:"w-6 h-6"}),s>0&&t.jsx("span",{className:"absolute top-1 right-1 bg-red-500 rounded-full w-2.5 h-2.5 border-2 border-primary"})]}),t.jsx("button",{onClick:a,className:"p-2 rounded-lg text-xl hover:bg-secondary transition-colors",title:"",children:""}),t.jsx(F,{onClick:l,colorScheme:"red",className:"text-xs sm:text-sm",children:""})]})]})})},N0=()=>{const{setCurrentUserAndRoute:e}=De(),[n,s]=f.useState(""),[l,r]=f.useState(""),[a,i]=f.useState(null),[o,c]=f.useState(!1),d=async u=>{if(u.preventDefault(),!n.trim()||!l.trim()){i("   .");return}c(!0),i(null);try{const p=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:l})});if(!p.ok){let h=`  (${p.statusText})`;try{const y=await p.json();y&&y.message&&(h=y.message)}catch(y){console.error("Login failed with a non-JSON response body.",y)}throw new Error(h)}const m=await p.json();e(m.user)}catch(p){i(p.message)}finally{c(!1)}};return t.jsx("div",{className:"flex items-center justify-center",children:t.jsxs("div",{className:"w-full max-w-sm p-6 space-y-6 bg-gray-800 rounded-lg shadow-2xl border border-color",children:[t.jsx("div",{children:t.jsx("p",{className:"mt-2 text-center text-gray-400",children:"   ."})}),t.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d,children:[t.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"username-login",className:"sr-only",children:"Username"}),t.jsx("input",{id:"username-login",name:"username",type:"text",autoComplete:"username",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:n,onChange:u=>s(u.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password-login",className:"sr-only",children:"Password"}),t.jsx("input",{id:"password-login",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:l,onChange:u=>r(u.target.value)})]})]}),a&&t.jsx("p",{className:"text-sm text-red-400 text-center",children:a}),t.jsx("div",{className:"w-full flex justify-center",children:t.jsx(F,{type:"submit",disabled:o,className:"w-full py-3 text-lg",children:o?" ...":""})})]}),t.jsx("div",{className:"text-sm text-center",children:t.jsx("a",{href:"#/register",onClick:u=>{u.preventDefault(),window.location.hash="#/register"},className:"font-medium text-blue-400 hover:text-blue-300",children:" ? "})}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 flex items-center",children:t.jsx("div",{className:"w-full border-t border-gray-600"})}),t.jsx("div",{className:"relative flex justify-center text-sm",children:t.jsx("span",{className:"px-2 bg-gray-800 text-gray-400",children:"   "})})]}),t.jsxs("div",{className:"flex justify-center gap-3",children:[t.jsx(F,{disabled:!0,colorScheme:"yellow",className:"w-full",children:""}),t.jsx(F,{disabled:!0,colorScheme:"gray",className:"w-full",children:""})]})]})})},k0=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Yl=e=>{if(!e)return!1;const n=e.toLowerCase().replace(/\s/g,"");return k0.some(s=>n.includes(s))},S0=()=>{const{setCurrentUserAndRoute:e}=De(),[n,s]=f.useState(""),[l,r]=f.useState(""),[a,i]=f.useState(""),[o,c]=f.useState(""),[d,u]=f.useState(null),[p,m]=f.useState(!1),h=async y=>{if(y.preventDefault(),u(null),!n.trim()||!l.trim()||!a.trim()){u("  .");return}if(n.trim().length<2){u(" 2  .");return}if(a.trim().length<4){u(" 4  .");return}if(a!==o){u("  .");return}if(Yl(n)||Yl(l)){u("      .");return}m(!0);try{const v=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,nickname:l,password:a})});if(!v.ok){let g=`  (${v.statusText})`;try{g=(await v.json()).message||g}catch(x){console.error("Could not parse error response as JSON",x)}throw new Error(g)}const b=await v.json();e(b.user)}catch(v){u(v.message)}finally{m(!1)}};return t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-gray-800 rounded-lg shadow-2xl border border-color",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-3xl font-bold text-center text-white",children:""}),t.jsx("p",{className:"mt-2 text-center text-gray-400",children:"  ."})]}),t.jsxs("form",{className:"mt-8 space-y-4",onSubmit:h,children:[t.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"username-register",className:"sr-only",children:"Username"}),t.jsx("input",{id:"username-register",name:"username",type:"text",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:n,onChange:y=>s(y.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"nickname-register",className:"sr-only",children:"Nickname"}),t.jsx("input",{id:"nickname-register",name:"nickname",type:"text",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:l,onChange:y=>r(y.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password-register",className:"sr-only",children:"Password"}),t.jsx("input",{id:"password-register",name:"password",type:"password",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"",value:a,onChange:y=>i(y.target.value)})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password-confirm",className:"sr-only",children:"Confirm Password"}),t.jsx("input",{id:"password-confirm",name:"passwordConfirm",type:"password",required:!0,className:"appearance-none rounded-md relative block w-full px-4 py-3 border border-gray-700 bg-gray-900 text-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:" ",value:o,onChange:y=>c(y.target.value)})]})]}),d&&t.jsx("p",{className:"text-sm text-red-400 text-center",children:d}),t.jsx("div",{className:"w-full flex justify-center",children:t.jsx(F,{type:"submit",disabled:p,className:"w-full py-3 text-lg",children:p?" ...":""})})]}),t.jsx("div",{className:"text-sm text-center",children:t.jsx("a",{href:"#",onClick:y=>{y.preventDefault(),window.location.hash=""},className:"font-medium text-blue-400 hover:text-blue-300",children:"  ? "})})]})})},Oa="/images/Base.png",Da="/images/Base.png",wc="/images/Hidden.png",Nc="/images/Hidden.png",yx="/images/RatingArena.png",bx="/images/PlayingArena.png",vx="/images/Championship.png",jx="/images/single/Map.png",wx="/images/tower/Tower.png",ji="draggableWindowSettings",be=({title:e,windowId:n,onClose:s,children:l,initialWidth:r=500,modal:a=!0,closeOnOutsideClick:i=!0,isTopmost:o=!0,headerContent:c,zIndex:d=50})=>{const[u,p]=f.useState({x:0,y:0}),[m,h]=f.useState(!1),y=f.useRef({x:0,y:0}),v=f.useRef({x:0,y:0}),[b,g]=f.useState(!1),x=f.useRef(u),[j,w]=f.useState(window.innerWidth<768),[k,C]=f.useState(!0),[S,P]=f.useState(1),_=f.useRef(null),I=f.useCallback(z=>{s&&i&&o&&_.current&&!_.current.contains(z.target)&&s()},[s,i,o]);f.useEffect(()=>{if(a&&s)return document.addEventListener("mousedown",I),()=>{document.removeEventListener("mousedown",I)}},[a,s,I]),f.useEffect(()=>{const z=()=>w(window.innerWidth<768);return window.addEventListener("resize",z),z(),()=>window.removeEventListener("resize",z)},[]),f.useEffect(()=>{const z=()=>{if(j){P(1);return}const H=window.innerWidth,ne=Math.min(1,H/(r+100));P(ne)};return window.addEventListener("resize",z),z(),()=>window.removeEventListener("resize",z)},[j,r]),f.useEffect(()=>{x.current=u},[u]),f.useEffect(()=>{try{const H=JSON.parse(localStorage.getItem(ji)||"{}").rememberPosition??!0;if(C(H),H){const ne=JSON.parse(localStorage.getItem("draggableWindowPositions")||"{}");ne[n]?p(ne[n]):p({x:0,y:0})}else p({x:0,y:0})}catch(z){console.error("Failed to load window settings from localStorage",z),p({x:0,y:0})}g(!0)},[n]);const T=f.useCallback((z,H)=>{h(!0),y.current={x:z,y:H},v.current=x.current},[]),B=f.useCallback(z=>{!o||z.button!==0||T(z.clientX,z.clientY)},[T,o]),R=f.useCallback(z=>{if(!o)return;const H=z.touches[0];T(H.clientX,H.clientY)},[T,o]),A=f.useCallback((z,H)=>{if(!m||!_.current)return;const ne=z-y.current.x,oe=H-y.current.y;let me=v.current.x+ne,ve=v.current.y+oe;const{offsetWidth:J,offsetHeight:fe}=_.current,{innerWidth:ye,innerHeight:K}=window,W=J/2,D=fe/2,V=-(ye/2)+W,Y=ye/2-W,ie=50;let je,E;fe<=K?(je=-(K/2)+D,E=K/2-D):(je=-(K/2)-D+ie,E=K/2+D-ie),me=Math.max(V,Math.min(me,Y)),ve=Math.max(je,Math.min(ve,E)),p({x:me,y:ve})},[m]),L=f.useCallback(z=>{A(z.clientX,z.clientY)},[A]),Q=f.useCallback(z=>{if(m){const H=z.touches[0];A(H.clientX,H.clientY)}},[m,A]),q=f.useCallback(()=>{if(m&&(h(!1),k))try{const z=JSON.parse(localStorage.getItem("draggableWindowPositions")||"{}");z[n]=x.current,localStorage.setItem("draggableWindowPositions",JSON.stringify(z))}catch(z){console.error("Failed to save window position to localStorage",z)}},[m,n,k]);f.useEffect(()=>(m&&(window.addEventListener("mousemove",L),window.addEventListener("mouseup",q),window.addEventListener("touchmove",Q),window.addEventListener("touchend",q)),()=>{window.removeEventListener("mousemove",L),window.removeEventListener("mouseup",q),window.removeEventListener("touchmove",Q),window.removeEventListener("touchend",q)}),[m,L,Q,q]);const O=z=>{const H=z.target.checked;C(H);try{const ne=JSON.parse(localStorage.getItem(ji)||"{}");if(ne.rememberPosition=H,localStorage.setItem(ji,JSON.stringify(ne)),!H){p({x:0,y:0});const oe=JSON.parse(localStorage.getItem("draggableWindowPositions")||"{}");delete oe[n],localStorage.setItem("draggableWindowPositions",JSON.stringify(oe))}}catch(ne){console.error("Failed to save remember position setting",ne)}},U=`translate(calc(-50% + ${u.x}px), calc(-50% + ${u.y}px)) scale(${m?S*1.02:S})`;if(!b)return null;const G=o?"cursor-move":"";return t.jsxs(t.Fragment,{children:[a&&t.jsx("div",{className:`fixed inset-0 z-40 bg-black/50 ${o?"":"backdrop-blur-sm"}`}),t.jsxs("div",{ref:_,className:"fixed top-1/2 left-1/2 bg-primary rounded-xl shadow-2xl border border-color flex flex-col text-on-panel",style:{width:j?"90vw":void 0,minWidth:j?"90vw":`${r}px`,transform:U,transformOrigin:"center",boxShadow:m?"0 25px 50px -12px rgba(0, 0, 0, 0.5)":"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",maxHeight:"90vh",zIndex:d},children:["                ",!o&&t.jsx("div",{className:"absolute inset-0 bg-black/30 z-20 rounded-xl cursor-not-allowed"}),t.jsxs("div",{className:`bg-secondary p-3 rounded-t-xl flex justify-between items-center ${G} touch-none`,onMouseDown:B,onTouchStart:R,children:[t.jsx("h2",{className:"text-lg font-bold text-secondary select-none",children:e}),t.jsxs("div",{className:"flex items-center gap-2",children:[c,s&&t.jsx("button",{onClick:o?s:void 0,className:"w-10 h-10 flex items-center justify-center rounded-full bg-tertiary hover:bg-danger transition-colors z-30",children:t.jsx("span",{className:"text-white font-bold text-lg",children:""})})]})]}),t.jsx("div",{className:"p-3 md:p-6 flex-grow",children:l}),t.jsx("div",{className:"flex-shrink-0 p-2 border-t border-color flex justify-end items-center bg-secondary rounded-b-xl",children:t.jsxs("label",{className:"flex items-center text-xs text-tertiary gap-2 cursor-pointer select-none",children:[t.jsx("input",{type:"checkbox",checked:k,onChange:O,className:"w-4 h-4 bg-tertiary border-color rounded focus:ring-accent"}),"  "]})})]})]})},C0=({currentUser:e,statsType:n,onClose:s,onAction:l})=>{const r=n==="strategic",a=r?"   ":"   ",i=r?at:St,{stats:o,diamonds:c}=e,d=300,u=500,p=c>=d,m=c>=u,h=v=>{p&&window.confirm(` ${d}  '${v}'   ?`)&&l({type:"RESET_SINGLE_STAT",payload:{mode:v}})},y=()=>{if(!m)return;const v=r?"":"";window.confirm(` ${u}   '${v}'   ?`)&&l({type:"RESET_STATS_CATEGORY",payload:{category:n}})};return t.jsxs(be,{title:a,onClose:s,windowId:"detailed-stats",initialWidth:600,children:[t.jsx("div",{className:"max-h-[calc(var(--vh,1vh)*60)] overflow-y-auto pr-2",children:t.jsx("ul",{className:"space-y-3",children:i.map(({mode:v})=>{const b=o==null?void 0:o[v];if(!b||b.wins===0&&b.losses===0)return null;const g=b.wins+b.losses,x=g>0?Math.round(b.wins/g*100):0;return t.jsxs("li",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsx("h3",{className:"text-lg font-bold text-yellow-300 mb-2",children:v}),t.jsx(F,{onClick:()=>h(v),disabled:!p,className:"!text-xs !py-1",colorScheme:"orange",title:`:  ${d}`,children:""})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-sm text-center",children:[t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:"/"}),t.jsxs("p",{className:"font-semibold text-white",children:[b.wins," ",b.losses,""]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:""}),t.jsxs("p",{className:"font-semibold text-white",children:[x,"%"]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[b.rankingScore,""]})]})]})]},v)})})}),t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700 text-center",children:[t.jsxs("p",{className:"text-sm mb-2 text-gray-300",children:[" :",t.jsxs("span",{className:"font-bold text-cyan-300 ml-2 flex items-center justify-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",c.toLocaleString()]})]}),t.jsxs(F,{onClick:y,colorScheme:"red",disabled:!m,title:`:  ${u}`,children:[r?"":"","   "]})]})]})},Nx=e=>e.mannerScore??200,kc=e=>e>=2e3?{rank:"",color:"text-purple-400"}:e>=1600?{rank:"",color:"text-blue-400"}:e>=1100?{rank:"",color:"text-cyan-400"}:e>=800?{rank:" ",color:"text-teal-400"}:e>=400?{rank:"",color:"text-green-400"}:e>=200?{rank:"",color:"text-gray-300"}:e>=100?{rank:"",color:"text-yellow-400"}:e>=50?{rank:"",color:"text-orange-400"}:e>=1?{rank:" ",color:"text-red-500"}:{rank:"",color:"text-red-700"},kx=e=>{const n=Math.max(0,Math.min(100,e/2e3*100));let s="bg-red-700";return e>=2e3?s="bg-purple-400":e>=1600?s="bg-blue-400":e>=1100?s="bg-cyan-400":e>=800?s="bg-teal-400":e>=400?s="bg-green-400":e>=200?s="bg-gray-300":e>=100?s="bg-yellow-400":e>=50?s="bg-orange-400":e>=1&&(s="bg-red-500"),{percentage:n,colorClass:s}},Hs=({mobile:e=!1,compact:n=!1,showOnlyWhenQuestCompleted:s=!1,fillHeight:l=!0})=>{const{handlers:r,unreadMailCount:a,hasClaimableQuest:i}=De();if(s&&!i)return null;const o=[{label:"",iconUrl:"/images/quickmenu/quest.png",handler:r.openQuests,disabled:!1,notification:i},{label:"",iconUrl:"/images/quickmenu/gibo.png",handler:()=>alert("   ."),disabled:!0,notification:!1},{label:"",iconUrl:"/images/quickmenu/enhance.png",handler:r.openBlacksmithModal,disabled:!1,notification:!1},{label:"",iconUrl:"/images/quickmenu/store.png",handler:r.openShop,disabled:!1,notification:!1},{label:"",iconUrl:"/images/quickmenu/bag.png",handler:r.openInventory,disabled:!1,notification:!1}],c=e?"flex justify-around items-center gap-2":`bg-gray-800/50 rounded-lg p-${n?1:2} flex flex-col justify-around gap-${n?1:2} ${l?"h-full":""}`,d=e?"flex flex-col items-center justify-center p-1 rounded-md w-14 h-14 bg-gray-700/50 hover:bg-gray-600/50":"flex flex-col items-center justify-center p-1 rounded-lg w-full bg-gray-700/50 hover:bg-gray-600/50",u=e?"w-6 h-6 object-contain":n?"w-7 h-7 object-contain":"w-8 h-8 object-contain",p=e||n?"text-[10px] mt-1":"text-xs mt-1",m=e?"absolute top-1 right-1 bg-red-500 rounded-full w-2.5 h-2.5 border-2 border-gray-800":`absolute top-1 right-1 bg-red-500 rounded-full w-2.5 h-2.5 border-2 ${n?"border-gray-800":"border-gray-800/50"}`,h=e?"absolute top-0 right-0 bg-red-500 text-white text-[10px] font-bold rounded-full w-4 h-4 flex items-center justify-center border-2 border-gray-800":`absolute top-0 right-0 bg-red-500 text-white text-[10px] font-bold rounded-full ${n?"w-4 h-4":"w-5 h-5"} flex items-center justify-center border-2 ${n?"border-gray-800":"border-gray-800/50"}`,y=v=>t.jsxs("button",{onClick:v.handler,disabled:v.disabled,className:`relative flex-1 ${d} disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,title:v.label,children:[t.jsx("img",{src:v.iconUrl,alt:v.label,className:u}),t.jsx("span",{className:p,children:v.label}),v.notification&&(v.count&&v.count>0?t.jsx("span",{className:h,children:v.count>9?"9+":v.count}):t.jsx("span",{className:m}))]},v.label);return t.jsx("div",{className:c,children:o.map(y)})},Xl=({messages:e,onAction:n,mode:s,onViewUser:l,locationPrefix:r})=>{const a=f.useRef(null),i=f.useRef(null),[o,c]=f.useState(""),[d,u]=f.useState(!1),[p,m]=f.useState(0),{currentUserWithStatus:h,handlers:y}=De();f.useEffect(()=>{a.current&&(a.current.scrollTop=a.current.scrollHeight)},[e]),f.useEffect(()=>{if(p>0){const C=setTimeout(()=>{m(S=>Math.max(0,S-1))},1e3);return()=>clearTimeout(C)}},[p]),f.useEffect(()=>{const C=S=>{i.current&&!i.current.contains(S.target)&&u(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);const v=C=>{if(p>0)return;const S={channel:"global",...C,location:r};n({type:"SEND_CHAT_MESSAGE",payload:S}),u(!1),c(""),m(5)},b=C=>{if(C.preventDefault(),!!o.trim()){if(Yl(o)){alert("       ."),c("");return}v({text:o})}};if(!h)return null;const g=C=>{h.isAdmin&&C!==h.id?y.openModerationModal(C):C!==h.id&&(l||y.openViewingUser)(C)},x=(h.chatBanUntil??0)>Date.now(),j=x?Math.ceil((h.chatBanUntil-Date.now())/1e3/60):0,w=x||p>0,k=x?`   (${j} )`:w?`(${p})`:"[ ]";return t.jsxs("div",{className:"p-1 flex flex-col h-full min-h-0 text-on-panel",children:[t.jsx("h2",{className:"text-lg font-semibold mb-1 border-b border-color pb-1 flex-shrink-0",children:""}),t.jsx("p",{className:"text-[10px] text-center text-yellow-400 mb-1 bg-tertiary/50 rounded-sm p-0.5",children:"AI      . "}),t.jsxs("div",{ref:a,className:"flex-grow space-y-0.5 overflow-y-auto pr-1 mb-1 bg-tertiary/40 p-1 rounded-md min-h-0",children:[e.map(C=>{const S=C.system&&!C.actionInfo&&C.user.nickname==="AI ";return t.jsxs("div",{className:"text-xs",children:[C.location&&t.jsx("span",{className:"font-semibold text-tertiary pr-1",children:C.location}),t.jsxs("span",{className:`font-semibold pr-2 ${C.system?"text-highlight":"text-tertiary cursor-pointer hover:underline"}`,onClick:()=>!C.system&&g(C.user.id),title:C.system?"":`${C.user.nickname}   / `,children:[C.system?S?"AI ":"":C.user.nickname,":"]}),C.text&&t.jsxs("span",{className:S?"text-highlight":"",children:[C.text,S&&" "]}),C.emoji&&t.jsx("span",{className:"text-xl",children:C.emoji})]},C.id)}),e.length===0&&t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:"  ."})]}),t.jsxs("div",{className:"relative flex-shrink-0",children:[d&&t.jsxs("div",{ref:i,className:"absolute bottom-full mb-2 w-full bg-secondary rounded-lg shadow-xl p-1 z-10 max-h-64 overflow-y-auto",children:[t.jsx("div",{className:"grid grid-cols-5 gap-1 text-xl mb-1 border-b border-color pb-1",children:xx.map(C=>t.jsxs("button",{onClick:()=>v({emoji:C}),className:"w-full p-1 rounded-md hover:bg-accent transition-colors text-center",children:[" ",C," "]},C))}),t.jsx("ul",{className:"space-y-0.5",children:fx.map(C=>t.jsxs("li",{children:[" ",t.jsxs("button",{onClick:()=>v({text:C}),className:"w-full text-left text-xs p-1 rounded-md hover:bg-accent transition-colors",children:[" ",C," "]})," "]},C))})]}),t.jsxs("form",{onSubmit:b,className:"flex gap-1",children:[t.jsx("button",{type:"button",onClick:()=>u(C=>!C),className:"bg-secondary hover:bg-tertiary text-primary font-bold px-2.5 rounded-md transition-colors text-lg flex items-center justify-center",title:" ",disabled:w,children:t.jsx("span",{children:""})}),t.jsx("input",{type:"text",value:o,onChange:C=>c(C.target.value),placeholder:k,className:"flex-grow bg-tertiary border border-color rounded-md p-1 focus:ring-accent focus:border-accent text-xs disabled:bg-secondary disabled:text-tertiary",maxLength:30,disabled:w}),t.jsx(F,{type:"submit",disabled:!o.trim()||w,className:"!px-2 !py-1",title:"",children:""})]})]})]})},iu=e=>{if(!e.inventory)return 0;const n=e.inventory.filter(l=>l.isEquipped);let s=0;return n.forEach(l=>{if(l.options){const{main:r,combatSubs:a,specialSubs:i,mythicSubs:o}=l.options;r&&(s+=r.value),a.forEach(c=>s+=c.value),i.forEach(c=>s+=c.value),o.forEach(c=>s+=c.value)}}),s},ou=({user:e,rank:n,value:s,isCurrentUser:l})=>{const r=f.useMemo(()=>{var i;return(i=Te.find(o=>o.id===e.avatarId))==null?void 0:i.url},[e.avatarId]),a=f.useMemo(()=>{var i;return(i=Re.find(o=>o.id===e.borderId))==null?void 0:i.url},[e.borderId]);return t.jsxs("div",{className:`flex items-center p-1 rounded-md ${l?"bg-blue-500/30":""}`,children:[t.jsx("span",{className:"w-8 text-center font-bold",children:n}),t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:r,borderUrl:a,size:24}),t.jsx("span",{className:"flex-1 truncate font-semibold ml-2",children:e.nickname}),t.jsx("span",{className:"w-16 text-right font-mono",children:s.toLocaleString()})]})},cu=({isTopmost:e})=>{const{allUsers:n,currentUserWithStatus:s}=De(),[l,r]=f.useState("combat"),a=f.useMemo(()=>l==="combat"?n.filter(o=>o).map(o=>({user:o,value:iu(o)})).sort((o,c)=>c.value-o.value).slice(0,100):n.filter(o=>o).map(o=>({user:o,value:o.mannerScore})).sort((o,c)=>c.value-o.value).slice(0,100),[n,l]),i=f.useMemo(()=>{if(!s)return null;const o=a.findIndex(d=>d.user&&d.user.id===s.id);if(o!==-1)return{...a[o],rank:o+1};const c=l==="combat"?iu(s):s.mannerScore;return{user:s,value:c,rank:"N/A"}},[a,s,l]);return t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-2 h-full",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0",children:" "}),t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg flex-shrink-0",children:[t.jsx("button",{onClick:()=>r("combat"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="combat"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>r("manner"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="manner"?"bg-yellow-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),t.jsxs("div",{className:"flex-grow overflow-y-auto pr-1 text-xs flex flex-col gap-1 min-h-0 h-48",children:[i&&t.jsx("div",{className:"sticky top-0 bg-panel z-10",children:t.jsx(ou,{user:i.user,rank:i.rank,value:i.value,isCurrentUser:!0})}),t.jsx("div",{className:"flex flex-col gap-1",children:a.filter(o=>o&&o.user).map((o,c)=>t.jsx(ou,{user:o.user,rank:c+1,value:o.value,isCurrentUser:!1},o.user.id))})]})]})},du=({user:e,rank:n,value:s,isCurrentUser:l})=>{const r=f.useMemo(()=>{var i;return(i=Te.find(o=>o.id===e.avatarId))==null?void 0:i.url},[e.avatarId]),a=f.useMemo(()=>{var i;return(i=Re.find(o=>o.id===e.borderId))==null?void 0:i.url},[e.borderId]);return t.jsxs("div",{className:`flex items-center p-1 rounded-md ${l?"bg-blue-500/30":""}`,children:[t.jsx("span",{className:"w-8 text-center font-bold",children:n}),t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:r,borderUrl:a,size:24}),t.jsx("span",{className:"flex-1 truncate font-semibold ml-2",children:e.nickname}),t.jsx("span",{className:"w-16 text-right font-mono",children:s.toLocaleString()})]})},uu=({isTopmost:e})=>{const{allUsers:n,currentUserWithStatus:s}=De(),[l,r]=f.useState("strategic"),a=f.useMemo(()=>{if(l==="championship")return n.filter(o=>o&&typeof o.tournamentScore=="number").map(o=>({user:o,value:o.tournamentScore})).sort((o,c)=>c.value-o.value).slice(0,100);{const o=l==="strategic"?"standard":"playful";return n.filter(c=>c).map(c=>{var d;return{user:c,value:((d=c.cumulativeRankingScore)==null?void 0:d[o])||0}}).sort((c,d)=>d.value-c.value).slice(0,100)}},[n,l]),i=f.useMemo(()=>{var d;if(!s)return null;let o;if(l==="championship")o=s.tournamentScore;else{const u=l==="strategic"?"standard":"playful";o=((d=s.cumulativeRankingScore)==null?void 0:d[u])||0}const c=a.findIndex(u=>u.user&&u.user.id===s.id);return c!==-1?{...a[c],rank:c+1}:{user:s,value:o,rank:"N/A"}},[a,s,l]);return t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-2 h-full",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0",children:" "}),t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg flex-shrink-0",children:[t.jsx("button",{onClick:()=>r("strategic"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="strategic"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "}),t.jsx("button",{onClick:()=>r("playful"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="playful"?"bg-yellow-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "}),t.jsx("button",{onClick:()=>r("championship"),className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-all ${l==="championship"?"bg-purple-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-1 text-xs flex flex-col gap-1 min-h-0 h-48",children:t.jsxs(t.Fragment,{children:[i&&t.jsx("div",{className:"sticky top-0 bg-panel z-10",children:t.jsx(du,{user:i.user,rank:i.rank,value:i.value,isCurrentUser:!0})}),t.jsx("div",{className:"flex flex-col gap-1",children:a.filter(o=>o&&o.user).map((o,c)=>t.jsx(du,{user:o.user,rank:c+1,value:o.value,isCurrentUser:!1},o.user.id))})]})})]})};function I0(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const mu=({level:e,currentXp:n,label:s,colorClass:l})=>{const r=1e3+(e-1)*200,a=Math.min(n/r*100,100);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-0.5 text-xs",children:[t.jsxs("span",{className:"font-semibold",children:[s," ",t.jsxs("span",{className:"text-base font-bold",children:["Lv.",e]})]}),t.jsxs("span",{className:"font-mono text-tertiary",children:[n," / ",r]})]}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-full h-3 border border-color",children:t.jsx("div",{className:`${l} h-full rounded-full transition-width duration-500`,style:{width:`${a}%`}})})]})},E0={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},P0=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-purple-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},fu=({slot:e,item:n,onClick:s})=>{const l=n&&s?"cursor-pointer hover:scale-105 transition-transform":"";if(n){const r=En[n.grade],a=`${n.name} (  : ${r}) -  `,i=P0(n.stars);return t.jsxs("div",{className:`relative w-full aspect-square rounded-lg border-2 border-color/50 bg-tertiary/50 ${l}`,title:a,onClick:s,children:[t.jsx("img",{src:E0[n.grade],alt:n.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),n.stars>0&&t.jsxs("div",{className:`absolute top-1 right-1.5 text-sm font-bold z-10 ${i.colorClass}`,style:{textShadow:"1px 1px 2px black"},children:["",n.stars]}),n.image&&t.jsx("img",{src:n.image,alt:n.name,className:"relative w-full h-full object-contain p-1.5"})]})}else return t.jsx("img",{src:La[e],alt:`${e} empty slot`,className:"w-full aspect-square rounded-lg bg-tertiary/50 border-2 border-color/50"})},xu=({type:e,stats:n,onEnter:s,onViewStats:l,level:r,title:a,imageUrl:i,tier:o})=>{const d=e==="strategic"?"hover:shadow-blue-500/30":"hover:shadow-yellow-500/30",u=n.wins+n.losses,p=u>0?Math.round(n.wins/u*100):0;return t.jsxs("div",{onClick:s,className:`bg-panel border border-color rounded-lg p-2 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg ${d} cursor-pointer h-full text-on-panel`,children:[t.jsxs("h2",{className:"text-base font-bold flex items-center justify-center gap-1 h-6 mb-1",children:[a,o&&t.jsx("img",{src:o.icon,alt:o.name,className:"w-5 h-5",title:o.name}),t.jsxs("span",{className:"text-sm text-highlight font-normal",children:["Lv.",r]})]}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden",children:t.jsx("img",{src:i,alt:a,className:"w-full h-full object-cover"})}),t.jsxs("div",{onClick:m=>{m.stopPropagation(),l()},className:"w-full bg-tertiary/50 rounded-md p-1 text-xs flex justify-between items-center cursor-pointer hover:bg-tertiary transition-colors mt-2",title:"  ",children:[t.jsxs("span",{children:[" : ",n.wins," ",n.losses," (",p,"%)"]}),t.jsx("span",{className:"text-accent font-semibold",children:""})]})]})},T0=({title:e,imageUrl:n,layout:s,footerContent:l})=>{const r=s==="tall";return t.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 border-2 border-purple-500/50 rounded-lg p-2 flex flex-col text-center shadow-lg shadow-purple-500/20 h-full text-on-panel relative overflow-hidden cursor-not-allowed group",children:[t.jsx("div",{className:"absolute top-2 -right-10 transform rotate-45 bg-purple-600 text-white text-[10px] font-bold px-10 py-0.5 z-10",children:"Coming Soon"}),t.jsx("h2",{className:"text-base font-bold text-purple-300 mt-1 h-6 mb-1",children:e}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden transition-transform duration-300 group-hover:scale-105 bg-black/20",children:t.jsx("img",{src:n,alt:e,className:`w-full h-full object-contain p-2 ${r?"object-contain":"object-cover"}`})}),l&&t.jsx("div",{className:"w-full bg-tertiary/50 rounded-md p-1 text-xs mt-2",children:l})]})},pu=(e,n,s)=>{if(s===0)return At[At.length-1];for(const l of At)if(l.threshold(e,n,s))return l;return At[At.length-1]},M0=()=>{const{currentUserWithStatus:e,allUsers:n,handlers:s,waitingRoomChats:l,hasClaimableQuest:r,presets:a}=De(),[i,o]=f.useState(null),[c,d]=f.useState(!1),[u,p]=f.useState(!1),[m,h]=f.useState(""),[y,v]=f.useState(0);if(f.useEffect(()=>{const D=()=>{const Y=new Date,ie=Y.getFullYear(),je=Y.getMonth(),Z=new Date(ie,je+1,1).getTime()-Y.getTime(),le=Math.floor(Z/(1e3*60*60*24)),ae=Math.floor(Z%(1e3*60*60*24)/(1e3*60*60));h(`${le} ${ae} `)};D();const V=setInterval(D,60*60*1e3);return()=>clearInterval(V)},[]),!e)return null;const{inventory:b,stats:g,nickname:x,avatarId:j,borderId:w}=e,k=f.useMemo(()=>l.global||[],[l]),C=I0(k.length),S=u||r;f.useEffect(()=>{!c&&C!==void 0&&k.length>C&&p(!0)},[k.length,C,c]);const P=f.useMemo(()=>{var D;return(D=Te.find(V=>V.id===j))==null?void 0:D.url},[j]),_=f.useMemo(()=>{var D;return(D=Re.find(V=>V.id===w))==null?void 0:D.url},[w]),I=f.useMemo(()=>(b||[]).filter(D=>D.isEquipped),[b]),T=D=>I.find(V=>V.slot===D),B=f.useMemo(()=>{const D={wins:0,losses:0},V={wins:0,losses:0};if(g){for(const Y of at){const ie=g[Y.mode];ie&&(D.wins+=ie.wins,D.losses+=ie.losses)}for(const Y of St){const ie=g[Y.mode];ie&&(V.wins+=ie.wins,V.losses+=ie.losses)}}return{strategic:D,playful:V}},[g]),R=Nx(e),A=kc(R),L=kx(R),{coreStatBonuses:Q,specialStatBonuses:q,mythicStatBonuses:O}=f.useMemo(()=>gx(e),[e]);f.useMemo(()=>Object.values(q).some(D=>D.flat>0||D.percent>0),[q]),f.useMemo(()=>Object.values(O).some(D=>D.flat>0),[O]),f.useMemo(()=>{const D={};for(const V of Object.values(rt))D[V]={count:0,totalValue:0};return I.forEach(V=>{var Y;(Y=V.options)==null||Y.mythicSubs.forEach(ie=>{const je=ie.type;D[je]&&(D[je].count++,D[je].totalValue+=ie.value)})}),D},[I]);const U=(e.strategyLevel-1)*2+(e.playfulLevel-1)*2,G=e.mannerMasteryApplied?20:0,z=e.bonusStatPoints||0,H=U+G+z,ne=f.useMemo(()=>Object.values(e.spentStatPoints||{}).reduce((D,V)=>D+V,0),[e.spentStatPoints]),oe=H-ne,me=D=>window.location.hash=`#/lobby/${D}`,ve=()=>window.location.hash="#/tournament",J=()=>window.location.hash="#/singleplayer",fe=D=>{const V=Number(D.target.value);v(V);const Y=a[V];Y&&s.applyPreset(Y)},ye=f.useMemo(()=>{var de,te;const D=(pe,we)=>{var qe;let ue=0,Se=0;for(const Be of we){const He=(qe=pe.stats)==null?void 0:qe[Be.mode];He&&(ue+=He.rankingScore,Se++)}return Se>0?ue/Se:1200},V=n.map(pe=>({id:pe.id,score:D(pe,at)})).sort((pe,we)=>we.score-pe.score),Y=n.map(pe=>({id:pe.id,score:D(pe,St)})).sort((pe,we)=>we.score-pe.score),ie=V.findIndex(pe=>pe.id===e.id)+1,je=Y.findIndex(pe=>pe.id===e.id)+1,E=((de=V.find(pe=>pe.id===e.id))==null?void 0:de.score)||0,Z=((te=Y.find(pe=>pe.id===e.id))==null?void 0:te.score)||0,le=pu(E,ie,V.length),ae=pu(Z,je,Y.length);return{strategicTier:le,playfulTier:ae}},[e,n]);N.Concentration+"",N.ThinkingSpeed+"",N.Judgment+"",N.Calculation+"",N.CombatPower+"",N.Stability+"",ze.ActionPointMax+"",ze.ActionPointRegen+"",ze.StrategyXpBonus+"",ze.PlayfulXpBonus+"",ze.GoldBonus+"",ze.ItemDropRate+"",ze.MaterialDropRate+"",f.useMemo(()=>{const D={};return I.forEach(V=>{var Y;if((Y=V.options)!=null&&Y.main){const ie=V.options.main,je=ie.type;D[je]||(D[je]={value:0,isPercentage:ie.isPercentage}),D[je].value+=ie.value}}),D},[I]),f.useMemo(()=>{const D={};return I.forEach(V=>{var Y;(Y=V.options)!=null&&Y.combatSubs&&V.options.combatSubs.forEach(ie=>{const je=ie.type;D[je]||(D[je]={value:0,isPercentage:ie.isPercentage}),D[je].value+=ie.value})}),D},[I]);const K=f.useMemo(()=>t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[t.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center gap-1 w-24",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ce,{userId:e.id,userName:x,size:80,avatarUrl:P,borderUrl:_}),t.jsxs("button",{onClick:s.openProfileEditModal,className:"absolute bottom-0 right-0 w-6 h-6 flex items-center justify-center bg-secondary hover:bg-tertiary rounded-full p-1 border-2 border-primary transition-transform hover:scale-110 active:scale-95",title:" ",children:[t.jsx("span",{className:"text-sm",children:""}),!e.mbti&&t.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-red-500 rounded-full"})]})]}),t.jsxs("div",{className:"flex flex-col items-center w-full",children:[t.jsx("div",{className:"flex items-center gap-1 w-full justify-center",children:t.jsx("h2",{className:"text-base font-bold truncate",title:x,children:x})}),t.jsxs("p",{className:"text-xs text-tertiary mt-0.5",children:["MBTI: ",e.mbti?e.mbti:""]})]})]}),t.jsxs("div",{className:"flex-grow space-y-1 bg-tertiary/30 p-2 rounded-md flex flex-col justify-center",children:[t.jsx(mu,{level:e.strategyLevel,currentXp:e.strategyXp,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-400"}),t.jsx(mu,{level:e.playfulLevel,currentXp:e.playfulXp,label:"",colorClass:"bg-gradient-to-r from-yellow-500 to-orange-400"}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-0.5 text-xs",children:[t.jsx("span",{className:"font-semibold",children:" "}),t.jsxs("span",{className:`font-semibold text-xs ${A.color}`,children:[R," (",A.rank,")"]})]}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-full h-2 border border-color",children:t.jsx("div",{className:`${L.colorClass} h-full rounded-full`,style:{width:`${L.percentage}%`}})})]})]})]}),t.jsxs("div",{className:"flex-grow flex flex-col min-h-0 border-t border-color mt-2 pt-2",children:[t.jsx("div",{className:"bg-tertiary/30 p-2 rounded-md text-center mb-2",children:e.guildId?t.jsx(F,{onClick:()=>window.location.hash="#/guild",colorScheme:"green",className:"w-full",children:" "}):t.jsx(F,{onClick:()=>window.location.hash="#/guild",colorScheme:"blue",className:"w-full",children:" "})}),t.jsxs("div",{className:"flex justify-between items-center mb-1 flex-shrink-0",children:[t.jsx("h3",{className:"font-semibold text-secondary text-sm",children:""}),t.jsxs("div",{className:"text-xs flex items-center gap-2",children:[t.jsxs("span",{children:[": ",t.jsx("span",{className:"font-bold text-green-400",children:oe}),"P"]}),t.jsx(F,{onClick:s.openStatAllocationModal,colorScheme:"yellow",className:"!text-[10px] !py-0.5",children:""})]})]}),t.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1",children:Object.values(N).map(D=>{var je;const V=(e.baseStats[D]||0)+(((je=e.spentStatPoints)==null?void 0:je[D])||0),Y=Math.floor(V*(Q[D].percent/100))+Q[D].flat,ie=V+Y;return t.jsxs("div",{className:"bg-tertiary/40 p-1 rounded-md flex items-center justify-between text-xs",children:[t.jsx("span",{className:"font-semibold text-secondary",children:D}),t.jsxs("span",{className:"font-mono font-bold",title:`: ${V}, : ${Y}`,children:[ie,Y>0&&t.jsxs("span",{className:"text-green-400 text-xs ml-0.5",children:["(+",Y,")"]})]})]},D)})})]})]}),[e,s,A,L,R,oe,Q]),W=t.jsxs("div",{className:"grid grid-cols-10 grid-rows-2 lg:grid-rows-7 gap-4 h-full",children:[t.jsx("div",{className:"col-span-5 row-span-1 lg:col-span-5 lg:row-span-3",children:t.jsx(xu,{type:"strategic",stats:B.strategic,onEnter:()=>me("strategic"),onViewStats:()=>o("strategic"),level:e.strategyLevel,title:" ",imageUrl:yx,tier:ye.strategicTier})}),t.jsx("div",{className:"col-span-5 row-span-1 lg:col-span-5 lg:row-span-3",children:t.jsx(xu,{type:"playful",stats:B.playful,onEnter:()=>me("playful"),onViewStats:()=>o("playful"),level:e.playfulLevel,title:" ",imageUrl:bx,tier:ye.playfulTier})}),t.jsx("div",{className:"col-span-4 row-span-1 lg:col-span-4 lg:row-span-4",children:t.jsxs("div",{onClick:ve,className:"bg-panel border border-color rounded-lg p-2 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-purple-500/30 cursor-pointer h-full text-on-panel",children:[t.jsx("h2",{className:"text-base font-bold h-6 mb-1",children:""}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden",children:t.jsx("img",{src:vx,alt:"",className:"w-full h-full object-cover"})}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-md p-1 text-xs mt-2",title:" ",children:t.jsxs("span",{children:[": ",e.tournamentScore.toLocaleString()," / : ",e.league]})})]})}),t.jsx("div",{className:"col-span-4 row-span-1 lg:col-span-4 lg:row-span-4",children:t.jsxs("div",{onClick:J,className:"bg-panel border border-color rounded-lg p-2 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-green-500/30 cursor-pointer h-full text-on-panel",children:[t.jsx("h2",{className:"text-base font-bold h-6 mb-1",children:""}),t.jsx("div",{className:"w-full flex-1 bg-tertiary rounded-md flex items-center justify-center text-tertiary overflow-hidden",children:t.jsx("img",{src:jx,alt:"",className:"w-full h-full object-cover"})}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-md p-1 text-xs mt-2",title:" ",children:t.jsxs("span",{children:[": ",e.singlePlayerProgress??0," / ",Jl.length]})})]})}),t.jsx("div",{className:"col-span-2 row-span-1 lg:col-span-2 lg:row-span-4",children:t.jsx(T0,{title:" ",imageUrl:wx,layout:"tall",footerContent:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{children:" : 1"}),t.jsx("span",{className:"text-tertiary",children:m})]})})})]});return t.jsxs("div",{className:"bg-primary text-primary p-2 sm:p-4 lg:p-2 max-w-screen-2xl mx-auto w-full h-full flex flex-col",children:[t.jsxs("header",{className:"flex justify-between items-center mb-2 px-2 flex-shrink-0",children:[t.jsx("h1",{className:"text-2xl font-bold text-primary",children:""}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:s.openEncyclopedia,className:"w-8 h-8 flex items-center justify-center bg-purple-600 hover:bg-purple-500 rounded-full text-white font-bold text-lg flex-shrink-0 transition-transform hover:scale-110",title:"",children:""}),t.jsx("button",{onClick:s.openInfoModal,className:"w-8 h-8 flex items-center justify-center bg-gray-600 hover:bg-gray-500 rounded-full text-white font-bold text-lg flex-shrink-0 transition-transform hover:scale-110",title:"",children:"?"})]})]}),t.jsxs("main",{className:"flex-1 flex flex-col min-h-0",children:[t.jsxs("div",{className:"hidden lg:flex flex-col h-full gap-2",children:[t.jsxs("div",{className:"flex flex-row gap-2",children:[t.jsx("div",{className:"w-[25%] bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-1",children:K}),t.jsxs("div",{className:"flex-1 flex flex-row gap-2 min-w-0",children:[t.jsxs("div",{className:"w-[240px] bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0 mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:["fan","top","bottom","board","bowl","stones"].map(D=>{const V=T(D);return t.jsx("div",{className:"w-full",children:t.jsx(fu,{slot:D,item:V,onClick:()=>V&&s.openViewingItem(V,!0)})},D)})}),t.jsx(F,{onClick:s.openEquipmentEffectsModal,colorScheme:"blue",className:"mt-2 !text-xs",children:"  "}),t.jsx("div",{className:"mt-2",children:t.jsx("select",{value:y,onChange:fe,className:"bg-secondary border border-color text-xs rounded-md p-1 focus:ring-accent focus:border-accent w-full",children:a&&a.map((D,V)=>t.jsx("option",{value:V,children:D.name},V))})})]}),t.jsxs("div",{className:"flex-1 flex flex-row gap-2",children:[t.jsx("div",{className:"flex-1",children:t.jsx(cu,{})}),t.jsx("div",{className:"flex-1",children:t.jsx(uu,{})})]}),t.jsx("div",{className:"w-24 flex-shrink-0",children:t.jsx(Hs,{})})]})]}),t.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2 min-h-0",children:[t.jsx("div",{className:"col-span-5 bg-panel border border-color text-on-panel rounded-lg min-h-0 flex flex-col",children:t.jsx(Xl,{messages:k,mode:"global",onAction:s.handleAction,onViewUser:s.openViewingUser,locationPrefix:"[]"})}),t.jsx("div",{className:"col-span-7 min-h-0 flex flex-col justify-end",children:W})]})]}),t.jsxs("div",{className:"lg:hidden flex flex-col h-full gap-2 relative",children:[t.jsxs("div",{className:"flex flex-col gap-2 flex-1 min-h-0 overflow-y-auto",children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col gap-1",children:K}),t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg p-2 flex flex-col",children:[t.jsx("h3",{className:"text-center font-semibold text-secondary text-sm flex-shrink-0 mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:["fan","top","bottom","board","bowl","stones"].map(D=>{const V=T(D);return t.jsx("div",{className:"w-full",children:t.jsx(fu,{slot:D,item:V,onClick:()=>V&&s.openViewingItem(V,!0)})},D)})}),t.jsx(F,{onClick:s.openEquipmentEffectsModal,colorScheme:"blue",className:"mt-2 !text-xs",children:"  "}),t.jsx("div",{className:"mt-2",children:t.jsx("select",{value:y,onChange:fe,className:"bg-secondary border border-color text-xs rounded-md p-1 focus:ring-accent focus:border-accent w-full",children:a&&a.map((D,V)=>t.jsx("option",{value:V,children:D.name},V))})})]})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx(cu,{}),t.jsx(uu,{})]}),t.jsx("div",{className:"flex-shrink-0",children:W})]}),t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",children:t.jsx("button",{onClick:()=>{d(!0),p(!1)},className:"w-8 h-12 bg-secondary/80 backdrop-blur-sm rounded-l-lg flex items-center justify-center text-primary shadow-lg","aria-label":"/ ",children:t.jsxs("span",{className:"relative font-bold text-lg",children:["<",S&&t.jsx("div",{className:"absolute -top-1 -right-1.5 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-secondary"})]})})}),t.jsxs("div",{className:`fixed top-0 right-0 h-full w-[280px] bg-primary shadow-2xl z-50 transition-transform duration-300 ease-in-out ${c?"translate-x-0":"translate-x-full"} flex flex-col`,children:[t.jsxs("div",{className:"flex justify-between items-center p-2 border-b border-color flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold",children:" / "}),t.jsx("button",{onClick:()=>d(!1),className:"text-2xl font-bold text-tertiary hover:text-primary",children:""})]}),t.jsxs("div",{className:"flex flex-col gap-2 p-2 flex-grow min-h-0",children:[t.jsx("div",{className:"flex-shrink-0 p-1 bg-panel rounded-lg border border-color",children:t.jsx(Hs,{mobile:!0})}),t.jsx("div",{className:"flex-1 bg-panel border border-color rounded-lg min-h-0",children:t.jsx(Xl,{messages:k,mode:"global",onAction:s.handleAction,onViewUser:s.openViewingUser,locationPrefix:"[]"})})]})]}),c&&t.jsx("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:()=>d(!1)})]})]}),i&&t.jsx(C0,{currentUser:e,statsType:i,onClose:()=>o(null),onAction:s.handleAction})]})},_0=({mode:e,description:n,image:s,available:l,onSelect:r,hoverColorClass:a})=>{const[i,o]=f.useState(!1);return t.jsxs("div",{className:`bg-panel text-on-panel rounded-lg p-5 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg ${a} ${l?"cursor-pointer":"opacity-50 cursor-not-allowed"}`,onClick:l?r:void 0,children:[t.jsx("div",{className:"w-[200px] h-[150px] mx-auto bg-tertiary rounded-md mb-4 flex items-center justify-center text-tertiary overflow-hidden shadow-inner",children:i?t.jsx("span",{className:"text-xs",children:e}):t.jsx("img",{src:s,alt:e,className:"w-full h-full object-cover",onError:()=>o(!0)})}),t.jsxs("div",{className:"flex-grow flex flex-col",children:[t.jsx("h3",{className:"text-xl font-bold text-primary mb-2",children:e}),t.jsx("p",{className:"text-tertiary text-sm flex-grow",children:n})]})]})},A0=({lobbyType:e})=>{const{gameModeAvailability:n,handlers:s}=De(),l=e==="strategic",r=l?" ":" ",a=l?at:St,i=l?" ":" ",o=l?"border-blue-400":"border-yellow-400",c=l?"hover:shadow-blue-500/20":"hover:shadow-yellow-500/20",d=()=>window.location.hash="#/profile";return t.jsxs("div",{className:"bg-primary text-primary p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto",children:[t.jsxs("header",{className:"flex flex-wrap justify-between items-center mb-8 gap-4",children:[t.jsx("button",{onClick:d,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsxs("div",{className:"text-center flex-grow",children:[t.jsxs("h1",{className:"text-4xl font-bold",children:[r," "]}),t.jsx("p",{className:"text-secondary mt-2",children:"  ."})]}),t.jsx("div",{className:"w-24"})," "]}),t.jsx("main",{children:t.jsxs("section",{children:[t.jsx("h2",{className:`text-2xl font-semibold mb-5 border-l-4 ${o} pl-4`,children:i}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(u=>t.jsx(_0,{...u,available:n[u.mode]??u.available,onSelect:()=>s.handleEnterWaitingRoom(u.mode),hoverColorClass:c},u.mode))})]})})]})},R0={[M.Standard]:{title:" ",sections:[{subtitle:" ",content:["   ()    .","            ."]},{subtitle:" ",content:["    .","       .","          ()  .","   ()   ."]},{subtitle:" ",content:["  ,    .","     ( 6.5)   .","     ."]}]},[M.Capture]:{title:" ",sections:[{subtitle:" ",content:["          ."]},{subtitle:" : ",content:["  (: 20)       .","     () ,      .","   ,       ."]},{subtitle:" ",content:["   ,         ."]},{subtitle:" ",content:["         ,   .","   ."]}]},[M.Speed]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" :   ",content:["      .","     ,   (: 5)    .","   ."]},{subtitle:" ",content:["  ,      .","      . (: 5 1)","       ."]}]},[M.Base]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" ",content:["1.  :         .","2.  :   ,    ()  () ,      ( ) .","3.  :       ,     ."]},{subtitle:" ",content:["  ,   1    (5) .","       ."]}]},[M.Hidden]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" ",content:["     ( , )    ."," :     .     .",":           .      ."]},{subtitle:" ",content:["     (4) .","   ,        ."]}]},[M.Missile]:{title:" ",sections:[{subtitle:" ",content:["         ."]},{subtitle:" ",content:["          . (   )"]},{subtitle:" : ",content:["     , , ,      .","       .","       ."]}]},[M.Mix]:{title:" ",sections:[{subtitle:" ",content:["       ."]},{subtitle:" ",content:[", , , ,    2    ."," , + , +     .","        ."]}]},[M.Omok]:{title:"",sections:[{subtitle:" ",content:["  , ,        ."]},{subtitle:"",content:["    .","       .","    3-3 , (6 )     ."]}]},[M.Ttamok]:{title:"",sections:[{subtitle:" ",content:["        .","1.       ()","2.    (: 10) "]},{subtitle:"  ",content:["       ,             .","   ."]},{subtitle:" ",content:["  (3-3 ,   )    ."]}]},[M.Dice]:{title:" ",sections:[{subtitle:" ",content:[" 3 ,    ()  .","        ."]},{subtitle:" ",content:["1.    . (/   )","2.      ( )   .","3.       ."]},{subtitle:" ",content:["   1 1 .","        .","3        .    ."]}]},[M.Thief]:{title:" ",sections:[{subtitle:" ",content:[" 2      ,      ."]},{subtitle:"",content:[" ():         . 1  1 ."," ():     . 1  2 ."]},{subtitle:" ",content:["       .","      ,       .","   5 ."]},{subtitle:" ",content:[":       1 1 ",":      1 1 ","2         .    ."]}]},[M.Alkkagi]:{title:"",sections:[{subtitle:" ",content:["      ."]},{subtitle:" ",content:["1.  :       .","2. :            .","3.       ,           .","       ."]},{subtitle:" ",content:["      .","  ,          .","        ."]},{subtitle:" ",content:[",         .","    ,       ."]}]},[M.Curling]:{title:" ",sections:[{subtitle:" ",content:[" 3       ."]},{subtitle:" ",content:["     ()   .","        .","       ."]},{subtitle:" ",content:[" :   , ()      .  5, 3, 2, 1,      ."," :        1   ."]},{subtitle:"",content:["     ,     1     .    ."]},{subtitle:" ",content:[",         .","    ,       ."]}]}},B0=({mode:e,onClose:n})=>{const s=R0[e];return s?t.jsx(be,{title:`${s.title}  `,onClose:n,windowId:`help-${e}`,initialWidth:550,children:t.jsx("div",{className:"max-h-[70vh] overflow-y-auto pr-2 text-gray-300",children:t.jsx("div",{className:"space-y-4",children:s.sections.map((l,r)=>t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"font-bold text-lg text-yellow-300 mb-2",children:l.subtitle}),t.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm",children:l.content.map((a,i)=>t.jsx("li",{children:a},i))})]},r))})})}):t.jsx(be,{title:"",onClose:n,windowId:`help-${e}`,initialWidth:500,children:t.jsx("p",{className:"text-center text-gray-400",children:"       ."})})},L0=({onClose:e})=>t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-panel rounded-xl shadow-2xl w-full max-w-md p-6 border border-gray-700 flex flex-col",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-2xl font-bold text-primary",children:"   "}),t.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white text-3xl leading-none",children:""})]}),t.jsx("div",{className:"text-on-panel",children:t.jsx("p",{children:"      ."})})]})}),gu={online:{text:"",color:"text-green-500"},waiting:{text:" ",color:"text-green-400"},resting:{text:" ",color:"text-gray-400"},negotiating:{text:" ",color:"text-yellow-400"},"in-game":{text:" ",color:"text-blue-400"},spectating:{text:" ",color:"text-purple-400"}},hu=({users:e,onAction:n,currentUser:s,mode:l,negotiations:r,onViewUser:a})=>{const[i,o]=f.useState(!1),[c,d]=f.useState(null),[u,p]=f.useState(!1),m=e.find(b=>b.id===s.id),h=e.filter(b=>b.id!==s.id).sort((b,g)=>b.nickname.localeCompare(g.nickname)),y=b=>s.status!=="waiting"?!1:b.status==="waiting"||b.status==="online",v=(b,g)=>{var P,_;const x=!g&&y(b),j=gu[b.status],w=l===M.Dice,k=g?null:r.find(I=>I.challenger.id===s.id&&I.opponent.id===b.id&&(I.status==="pending"||I.status==="draft")),C=(P=Te.find(I=>I.id===b.avatarId))==null?void 0:P.url,S=(_=Re.find(I=>I.id===b.borderId))==null?void 0:_.url;return t.jsxs("li",{className:`flex items-center justify-between p-1.5 rounded-lg ${g?"bg-blue-900/40 border border-blue-700":"bg-tertiary/50"}`,children:[t.jsxs("div",{className:`flex items-center gap-2 lg:gap-3 overflow-hidden ${g?"":"cursor-pointer"}`,onClick:()=>!g&&a(b.id),title:g?"":`${b.nickname}  `,children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,size:36,className:"border-2 border-color",avatarUrl:C,borderUrl:S}),w&&t.jsx("div",{className:"w-5 h-5 rounded-full bg-black border border-gray-300 flex-shrink-0"}),t.jsxs("div",{className:"overflow-hidden",children:[t.jsx("h3",{className:"font-bold text-sm lg:text-base truncate",children:b.nickname}),t.jsxs("span",{className:`text-xs ${j.color}`,children:[" ",j.text]})]})]}),g?t.jsxs("select",{value:s.status,onChange:I=>n({type:"SET_USER_STATUS",payload:{status:I.target.value}}),disabled:!["waiting","resting"].includes(s.status),className:"px-2 py-1 lg:px-3 lg:py-1.5 bg-secondary border border-color rounded-lg text-xs lg:text-sm transition-colors w-20 lg:w-24 text-center focus:ring-accent focus:border-accent disabled:opacity-50",children:[t.jsx("option",{value:"waiting",children:" "}),t.jsx("option",{value:"resting",children:" "}),!["waiting","resting"].includes(s.status)&&t.jsx("option",{value:s.status,disabled:!0,children:gu[s.status].text})]}):t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[s.isAdmin&&!b.isAdmin&&t.jsx(F,{onClick:()=>{window.confirm(`[${b.nickname}]   ?`)&&n({type:"ADMIN_FORCE_LOGOUT",payload:{targetUserId:b.id}})},colorScheme:"red",className:"!text-xs !py-1 !px-2",children:" "}),k?t.jsx(F,{onClick:()=>n({type:"DECLINE_NEGOTIATION",payload:{negotiationId:k.id}}),colorScheme:"red",className:"!text-xs !py-1 !px-2",children:" "}):t.jsx(F,{onClick:()=>n({type:"CHALLENGE_USER",payload:{opponentId:b.id,mode:l}}),disabled:!x,className:"!text-xs !py-1 !px-2",children:" "})]})]},b.id)};return t.jsxs("div",{className:"p-3 flex flex-col min-h-0 text-on-panel",children:[t.jsxs("h2",{className:"text-xl font-semibold mb-2 border-b border-color pb-2 flex-shrink-0 flex justify-between items-center",children:[t.jsx("span",{children:" "}),t.jsx(F,{onClick:()=>p(!0),colorScheme:"gray",className:"!text-xs !py-1 !px-2",children:"  "})]}),m&&t.jsx("div",{className:"flex-shrink-0 mb-2",children:v(m,!0)}),t.jsx("ul",{className:"space-y-2 overflow-y-auto pr-2 max-h-[calc(var(--vh,1vh)*25)] min-h-[96px]",children:h.length>0?h.map(b=>v(b,!1)):t.jsx("p",{className:"text-center text-tertiary pt-8",children:"  ."})}),i&&c&&t.jsx(ChallengeApplicationModal,{opponentUser:c,onClose:()=>o(!1),onAction:n}),u&&t.jsx(L0,{onClose:()=>p(!1)})]})},$0=(e,n,s)=>{for(const l of At)if(l.threshold(e,n,s))return l;return At[At.length-1]},O0=()=>{const e=new Date,n=e.getFullYear().toString().slice(-2),s=e.getMonth();let l;return s<3?l=1:s<6?l=2:s<9?l=3:l=4,`${n}-${l}`},yu=({currentUser:e,mode:n,onViewUser:s,onShowTierInfo:l,onShowPastRankings:r})=>{const{allUsers:a}=De(),i=f.useMemo(()=>[...a].filter(y=>{var v;return(v=y.stats)==null?void 0:v[n]}).sort((y,v)=>(v.stats[n].rankingScore||0)-(y.stats[n].rankingScore||0)),[a,n]),o=f.useMemo(()=>i.filter(y=>{var b;const v=(b=y.stats)==null?void 0:b[n];return v&&v.wins+v.losses>=20}),[i,n]);o.length;const c=At[At.length-1],d=i.findIndex(y=>y.id===e.id),u=d!==-1?{user:i[d],rank:d+1}:null,p=i.slice(0,100),m=f.useCallback(y=>{var j;const v=(j=y.stats)==null?void 0:j[n];if(!v||v.wins+v.losses<20)return c;const b=o.findIndex(w=>w.id===y.id)+1;if(b===0)return c;const g=v.rankingScore||1200,x=v.wins+v.losses;return $0(g,b,x)},[n,o,c]),h=f.useCallback((y,v,b)=>{var A,L,Q;const g=(A=y.stats)==null?void 0:A[n];if(!g)return null;const x=g.wins+g.losses>0?Math.round(g.wins/(g.wins+g.losses)*100):0,j=g.rankingScore||1200,w=m(y),k=!b&&y.id===e.id,C="flex items-center gap-2 rounded-lg",S="bg-yellow-900/40 border border-yellow-700",P="bg-blue-900/60 border border-blue-600",_="bg-tertiary/50",I=!b&&y.id!==e.id,T=`${C} ${b?S:k?P:_} p-1.5 ${I?"cursor-pointer hover:bg-secondary/50":""}`,B=(L=Te.find(q=>q.id===y.avatarId))==null?void 0:L.url,R=(Q=Re.find(q=>q.id===y.borderId))==null?void 0:Q.url;return t.jsxs("li",{className:T,onClick:I?()=>s(y.id):void 0,title:I?`${y.nickname}  `:"",children:[t.jsx("span",{className:"w-8 text-center font-mono text-sm",children:v}),t.jsx("img",{src:w.icon,alt:w.name,className:"w-8 h-8 flex-shrink-0",title:w.name}),t.jsx(Ce,{userId:y.id,userName:y.nickname,size:32,avatarUrl:B,borderUrl:R}),t.jsxs("div",{className:"flex-grow overflow-hidden",children:[t.jsx("p",{className:"font-semibold text-sm truncate",children:y.nickname}),t.jsxs("p",{className:"text-xs text-highlight font-mono",children:[j,""]})]}),t.jsxs("div",{className:"text-right text-[10px] lg:text-xs flex-shrink-0 w-20 text-tertiary",children:[t.jsxs("p",{children:[g.wins," ",g.losses,""]}),t.jsxs("p",{className:"font-semibold",children:[x,"%"]})]})]},y.id)},[n,e.id,m,s]);return t.jsxs("div",{className:"p-4 flex flex-col text-on-panel",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-color pb-2 flex-shrink-0 flex-wrap gap-2",children:[t.jsxs("h2",{className:"text-xl font-semibold",children:[n,"  (",O0(),")"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(F,{onClick:()=>r({user:e,mode:n}),className:"!text-xs !py-1",colorScheme:"gray",children:" "}),t.jsx(F,{onClick:l,className:"!text-xs !py-1",colorScheme:"gray",children:" "})]})]}),u&&t.jsx("div",{className:"flex-shrink-0 mb-3",children:h(u.user,u.rank,!0)}),t.jsx("ul",{className:"space-y-2 overflow-y-auto pr-2 h-72",children:p.length>0?p.map((y,v)=>h(y,v+1,!1)):t.jsx("p",{className:"text-center text-tertiary pt-8",children:"  ."})})]})},bu=({games:e,onAction:n,currentUser:s})=>{const[l,r]=f.useState(""),[a,i]=f.useState(null),o=f.useRef(null);f.useEffect(()=>{const m=h=>{o.current&&!o.current.contains(h.target)&&i(null)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const c=()=>{const m=parseInt(l,10);if(isNaN(m)||m<1||m>e.length){alert("   .");return}const h=e[m-1];h&&n({type:"SPECTATE_GAME",payload:{gameId:h.id}}),r("")},d=m=>{i(h=>h===m?null:m)},u=m=>{const h=prompt("   (50 ):",m.description||"");if(h!==null){if(h.length>50){alert("  50   .");return}n({type:"ADMIN_SET_GAME_DESCRIPTION",payload:{gameId:m.id,description:h}})}i(null)},p=m=>{window.confirm(`[${m.player1.nickname} vs ${m.player2.nickname}]   ?`)&&n({type:"ADMIN_FORCE_DELETE_GAME",payload:{gameId:m.id}}),i(null)};return t.jsxs("div",{className:"bg-panel border border-color text-on-panel rounded-lg shadow-lg p-4 flex flex-col min-h-0",children:[t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-color pb-2 flex-shrink-0",children:[t.jsx("h2",{className:"text-xl font-semibold",children:" "}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"number",min:"1",placeholder:" ",value:l,onChange:m=>{const h=m.target.value;(h===""||parseInt(h,10)>0)&&r(h)},onKeyDown:m=>{m.key==="Enter"&&c()},className:"w-24 bg-tertiary border border-color rounded-md p-2 focus:ring-accent focus:border-accent text-sm text-center"}),t.jsx("button",{onClick:c,className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg text-sm transition-colors shrink-0",children:""})]})]}),t.jsx("ul",{className:"space-y-3 overflow-y-auto pr-2 max-h-[calc(var(--vh,1vh)*25)] min-h-[96px]",children:e.length>0?e.map((m,h)=>!m||!m.player1||!m.player2?null:t.jsxs("li",{className:"relative",children:[t.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-tertiary/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[t.jsx("div",{className:`flex-shrink-0 w-8 h-8 flex items-center justify-center bg-secondary rounded-full font-bold text-sm ${s.isAdmin?"cursor-pointer hover:bg-tertiary transition-colors":""}`,onClick:s.isAdmin?()=>d(m.id):void 0,title:s.isAdmin?"  ":` : ${h+1}`,children:h+1}),t.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[t.jsxs("div",{className:"text-center truncate",children:[t.jsx(Ce,{userId:m.player1.id,userName:m.player1.nickname,size:36,className:"border-2 border-color mx-auto"}),t.jsx("span",{className:"text-xs font-semibold block truncate",children:m.player1.nickname})]}),t.jsx("span",{className:"text-tertiary font-bold",children:"vs"}),t.jsxs("div",{className:"text-center truncate",children:[t.jsx(Ce,{userId:m.player2.id,userName:m.player2.nickname,size:36,className:"border-2 border-color mx-auto"}),t.jsx("span",{className:"text-xs font-semibold block truncate",children:m.player2.nickname})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[m.description&&t.jsx("div",{className:"text-sm text-highlight truncate max-w-xs hidden md:block",title:m.description,children:m.description}),t.jsx("button",{onClick:()=>n({type:"SPECTATE_GAME",payload:{gameId:m.id}}),className:"ml-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg text-sm transition-colors shrink-0",children:""})]})]}),s.isAdmin&&a===m.id&&t.jsxs("div",{ref:o,className:"absolute top-12 left-2 z-10 bg-secondary rounded-md shadow-lg p-2 space-y-2 w-48 border border-color",children:[t.jsx("button",{onClick:()=>u(m),className:"w-full text-left px-3 py-1.5 text-sm rounded hover:bg-accent transition-colors",children:"  /"}),t.jsx("button",{onClick:()=>p(m),className:"w-full text-left px-3 py-1.5 text-sm rounded hover:bg-danger text-red-300 transition-colors",children:"  "})]})]},m.id)):t.jsx("p",{className:"text-center text-tertiary pt-8",children:"  ."})})]})},D0=({onClose:e})=>{const n={:" 0.1%",:" 3%",:" 5%",:" 10%",:" 25%",:" 40%",:" 60%",:" 80%",:" "},s=r=>{if(r.includes(""))return"/images/icon/Zem.png";const a=vs.find(i=>i.name===r);return(a==null?void 0:a.image)||null},l=r=>{const a=m0[r];if(!a)return t.jsx("span",{className:"text-gray-500",children:"  "});const i=[];return a.diamonds&&i.push({name:`${a.diamonds.toLocaleString()}`,image:"/images/icon/Zem.png"}),a.items&&a.items.forEach(o=>{const c="itemId"in o?o.itemId:o.name,d=s(c);i.push({name:`${c} x${o.quantity}`,image:d})}),t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:i.map((o,c)=>o.image&&t.jsxs("div",{className:"flex items-center gap-1.5 bg-gray-700/50 px-2 py-1 rounded-md",title:o.name,children:[t.jsx("img",{src:o.image,alt:o.name,className:"w-5 h-5 object-contain"}),t.jsx("span",{className:"text-gray-300 whitespace-nowrap text-xs",children:o.name})]},c))})};return t.jsx(be,{title:"   ",onClose:e,windowId:"ranking-tier-info-modal",initialWidth:600,children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-300",children:"        .        ,  ."}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg",children:[t.jsx("h4",{className:"font-bold text-lg text-yellow-300 mb-2",children:" "}),t.jsxs("ul",{className:"text-sm text-gray-300 space-y-1",children:[t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 1:"})," 1 1 ~ 3 31"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 2:"})," 4 1 ~ 6 30"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 3:"})," 7 1 ~ 9 30"]}),t.jsxs("li",{children:[t.jsx("span",{className:"font-semibold",children:" 4:"})," 10 1 ~ 12 31"]})]}),t.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"       ."})]}),t.jsx("ul",{className:"space-y-2 max-h-[40vh] overflow-y-auto pr-2",children:At.map(r=>t.jsxs("li",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("img",{src:r.icon,alt:r.name,className:"w-12 h-12 mr-4 flex-shrink-0"}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("p",{className:`font-bold text-lg ${r.color}`,children:r.name}),t.jsx("p",{className:"text-sm text-gray-400",children:n[r.name]||"N/A"})]})]}),t.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-700/50",children:[t.jsx("h5",{className:"text-xs font-semibold text-gray-400 mb-1.5",children:"  "}),l(r.name)]})]},r.name))})]})})},q0=[M.Dice,M.Omok,M.Ttamok,M.Thief,M.Alkkagi,M.Curling];function U0(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const vu=({mode:e})=>{const{handlers:n}=De(),s=at.some(a=>a.mode===e),l=q0.includes(e);if(!s&&!l)return null;const r=s?`${e}()`:`${e}`;return t.jsxs("div",{className:"bg-panel rounded-lg shadow-lg p-3 flex items-center justify-between flex-shrink-0 text-on-panel",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ce,{userId:tl,userName:"AI",size:40,className:"border-2 border-purple-500"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-base font-bold text-purple-300",children:"AI "}),t.jsxs("p",{className:"text-xs text-tertiary",children:[r,"()   ."]})]})]}),t.jsx(F,{onClick:()=>n.handleAction({type:"CHALLENGE_USER",payload:{opponentId:tl,mode:e}}),colorScheme:"purple",className:"!text-sm !py-1.5",children:"  "})]})},ju=({mode:e})=>{const{announcements:n,globalOverrideAnnouncement:s,announcementInterval:l}=De(),[r,a]=f.useState(0),i=f.useMemo(()=>n.map(c=>c.id).join(","),[n]);return f.useEffect(()=>{if(!n||n.length<=1){a(0);return}const c=setInterval(()=>{a(d=>(d+1)%n.length)},l*1e3);return()=>clearInterval(c)},[i,n.length,l]),s&&(s.modes==="all"||s.modes.includes(e))?t.jsx("div",{className:"bg-yellow-800/50 border border-yellow-600 rounded-lg shadow-lg p-2 flex items-center justify-center flex-shrink-0 h-10",children:t.jsx("span",{className:"font-bold text-yellow-300 animate-pulse text-center",children:s.message})}):!n||n.length===0?t.jsx("div",{className:"bg-panel rounded-lg shadow-lg p-2 flex items-center justify-center flex-shrink-0 h-10 text-on-panel",children:t.jsx("span",{className:"font-bold text-tertiary text-center",children:"[   .]"})}):t.jsx("div",{className:"bg-panel rounded-lg shadow-lg px-4 relative overflow-hidden flex-shrink-0 h-10",children:t.jsx("div",{className:"w-full absolute top-0 left-0 transition-transform duration-1000 ease-in-out",style:{transform:`translateY(-${r*2.5}rem)`},children:n.map(c=>t.jsx("div",{className:"w-full h-10 flex items-center justify-center",children:t.jsxs("span",{className:"font-bold",children:[t.jsx("span",{className:"text-red-500 mr-2",children:"[]"}),t.jsx("span",{className:"text-highlight",children:c.message})]})},c.id))})})},z0=({mode:e})=>{const{currentUserWithStatus:n,onlineUsers:s,allUsers:l,liveGames:r,waitingRoomChats:a,negotiations:i,handlers:o}=De(),[c,d]=f.useState(window.innerWidth<1024),[u,p]=f.useState(!1),[m,h]=f.useState(!1),[y,v]=f.useState(!1),[b,g]=f.useState(!1),x=f.useRef(null),j=a.global||[],w=U0(j.length);f.useEffect(()=>{!u&&w!==void 0&&j.length>w&&h(!0)},[j.length,w,u]);const k=()=>{o.handleAction({type:"LEAVE_WAITING_ROOM"});const T=at.some(B=>B.mode===e);window.location.hash=`#/lobby/${T?"strategic":"playful"}`};if(f.useEffect(()=>{const T=()=>d(window.innerWidth<1024);return window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]),!n)return null;const C=Object.values(r).filter(T=>T.mode===e),S=f.useMemo(()=>{const T=s.filter(R=>{if(R.mode===e)return!0;if(!R.mode){const A=R.gameId||R.spectatingGameId;if(A){const L=r[A];if(L&&L.mode===e)return!0}}return!1}),B=T.find(R=>R.id===n.id);return B?[B,...T.filter(R=>R.id!==n.id)]:T},[s,e,n.id,r]),I=`[${f.useMemo(()=>at.some(T=>T.mode===e),[e])?"":""}:${e}]`;return t.jsxs("div",{className:"bg-primary text-primary flex flex-col h-full max-w-full",children:[t.jsxs("header",{className:"flex justify-between items-center mb-4 flex-shrink-0 px-2 sm:px-4 lg:px-6 pt-2 sm:pt-4 lg:pt-6",children:[t.jsx("div",{className:"flex-1",children:t.jsx(F,{onClick:k,colorScheme:"gray",children:"  "})}),t.jsxs("div",{className:"flex-1 text-center flex items-center justify-center",children:[t.jsxs("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:[e," "]}),t.jsx("button",{onClick:()=>g(!0),className:"ml-3 w-8 h-8 flex items-center justify-center bg-secondary hover:bg-tertiary rounded-full text-primary font-bold text-xl flex-shrink-0 transition-transform hover:scale-110","aria-label":"  ",title:"  ",children:"?"})]}),t.jsx("div",{className:"flex-1 text-right",children:t.jsxs("p",{className:"text-secondary text-sm",children:[S.length,"  "]})})]}),t.jsx("div",{className:"flex-1 min-h-0 relative px-2 sm:px-4 lg:px-6 pb-2 sm:pb-4 lg:pb-6",children:c?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col h-full gap-2",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(ju,{mode:e})}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx(vu,{mode:e})}),t.jsxs("div",{className:"flex-1 flex flex-row gap-2 items-stretch min-h-0",children:[t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(bu,{games:C,onAction:o.handleAction,currentUser:n})}),t.jsx("div",{className:"w-20 flex-shrink-0",children:t.jsx(Hs,{compact:!0,fillHeight:!0})})]}),t.jsx("div",{className:"flex-1 min-h-0 bg-panel border border-color rounded-lg shadow-lg flex flex-col",children:t.jsx(Xl,{messages:j,mode:"global",onAction:o.handleAction,locationPrefix:I,onViewUser:o.openViewingUser})})]}),t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",children:t.jsx("button",{onClick:()=>{p(!0),h(!1)},className:"w-8 h-12 bg-secondary/80 backdrop-blur-sm rounded-l-lg flex items-center justify-center text-primary shadow-lg","aria-label":"    ",children:t.jsxs("span",{className:"relative font-bold text-lg",children:["<",m&&t.jsx("div",{className:"absolute -top-1 -right-1.5 w-2.5 h-2.5 bg-danger rounded-full border-2 border-secondary"})]})})}),t.jsxs("div",{className:`fixed top-0 right-0 h-full w-[280px] bg-primary shadow-2xl z-50 transition-transform duration-300 ease-in-out ${u?"translate-x-0":"translate-x-full"}`,children:[t.jsx("button",{onClick:()=>p(!1),className:"self-end text-2xl p-2 text-tertiary hover:text-primary",children:""}),t.jsx("div",{className:"flex-shrink-0 p-2 border-b border-color",children:t.jsx(Hs,{mobile:!0})}),t.jsx("div",{className:"flex-1 min-h-0",children:t.jsx(hu,{users:S,mode:e,onAction:o.handleAction,currentUser:n,negotiations:Object.values(i),onViewUser:o.openViewingUser})}),t.jsx("div",{className:"flex-1 min-h-0 border-t border-color",children:t.jsx(yu,{mode:e,onShowTierInfo:()=>v(!0),currentUser:n,onViewUser:o.openViewingUser,onShowPastRankings:o.openPastRankings})})]}),u&&t.jsx("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:()=>p(!1)})]}):t.jsxs("div",{ref:x,className:"grid grid-cols-1 lg:grid-cols-5 h-full gap-4",children:[t.jsxs("div",{className:"lg:col-span-3 flex flex-col gap-4 min-h-0",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx(ju,{mode:e})}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx(vu,{mode:e})}),t.jsxs("div",{className:"flex-1 flex flex-col gap-4 min-h-0",children:[t.jsx("div",{className:"flex-1 min-h-0",children:t.jsx(bu,{games:C,onAction:o.handleAction,currentUser:n})}),t.jsx("div",{className:"flex-1 flex flex-col bg-panel border border-color rounded-lg shadow-lg",children:t.jsx(Xl,{messages:j,mode:"global",onAction:o.handleAction,locationPrefix:I,onViewUser:o.openViewingUser})})]})]}),t.jsxs("div",{className:"lg:col-span-2 grid grid-rows-[1fr_auto] gap-4",children:[t.jsxs("div",{className:"flex flex-row gap-4 items-stretch min-h-0",children:[t.jsx("div",{className:"flex-1 bg-panel border border-color rounded-lg shadow-lg min-w-0",children:t.jsx(hu,{users:S,mode:e,onAction:o.handleAction,currentUser:n,negotiations:Object.values(i),onViewUser:o.openViewingUser})}),t.jsx("div",{className:"w-24 flex-shrink-0",children:t.jsx(Hs,{})})]}),t.jsx("div",{className:"bg-panel border border-color rounded-lg shadow-lg",children:t.jsx(yu,{currentUser:n,mode:e,onViewUser:o.openViewingUser,onShowTierInfo:()=>v(!0),onShowPastRankings:o.openPastRankings})})]})]})}),y&&t.jsx(D0,{onClose:()=>v(!1)}),b&&t.jsx(B0,{mode:e,onClose:()=>g(!1)})]})},F0=({animation:e,toSvgCoords:n,cellSize:s})=>{const{text:l,point:r}=e,{cx:a,cy:i}=n(r),o=s*1.5;return t.jsx("g",{style:{pointerEvents:"none"},className:"bonus-text-animation",children:t.jsx("text",{x:a,y:i,textAnchor:"middle",dy:".35em",fontSize:o,fontWeight:"bold",fill:"url(#bonus-gradient)",stroke:"black",strokeWidth:"1.5px",paintOrder:"stroke",children:l})})},G0=({ownershipMap:e,toSvgCoords:n,cellSize:s})=>t.jsx("g",{style:{pointerEvents:"none"},className:"animate-fade-in",children:e.map((l,r)=>l.map((a,i)=>{const{cx:o,cy:c}=n({x:i,y:r}),u=Math.abs(a)/10;if(u<.3)return null;const p=s*u*.9,m=u*.7,h=a>0?`rgba(0, 0, 0, ${m})`:`rgba(255, 255, 255, ${m})`;return t.jsx("rect",{x:o-p/2,y:c-p/2,width:p,height:p,fill:h,rx:p*.3},`${i}-${r}`)}))}),W0=({animation:e,stone_radius:n,toSvgCoords:s})=>{const{from:l,to:r,player:a}=e,i=s(l),o=s(r),c={"--from-x":`${i.cx}px`,"--from-y":`${i.cy}px`,"--to-x":`${o.cx}px`,"--to-y":`${o.cy}px`},d=Math.atan2(o.cy-i.cy,o.cx-i.cx)*180/Math.PI;return t.jsx("g",{style:c,className:"missile-flight-group",children:t.jsxs("g",{transform:"translate(0, 0)",children:[t.jsx("ellipse",{cx:0,cy:0,rx:n*1.5,ry:n*.7,fill:"url(#missile_fire)",className:"missile-fire-trail",transform:`rotate(${d}) translate(${-n}, 0)`}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===$.Black?"#111827":"#f5f2e8"}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===$.Black?"url(#slate_highlight)":"url(#clamshell_highlight)"})]})})},H0=({animation:e,stone_radius:n,toSvgCoords:s})=>{const{from:l,to:r,player:a,duration:i}=e,o=s(l),c=s(r),d={"--from-x":`${o.cx}px`,"--from-y":`${o.cy}px`,"--to-x":`${c.cx}px`,"--to-y":`${c.cy}px`,animationDuration:`${i}ms`,animationFillMode:"forwards"},u=n*2*.7,p=u/2,m=Math.atan2(c.cy-o.cy,c.cx-o.cx)*180/Math.PI,h=t.jsx("g",{style:d,className:"hidden-missile-flight-group",children:t.jsxs("g",{transform:"translate(0, 0)",children:[t.jsx("ellipse",{cx:0,cy:0,rx:n*1.5,ry:n*.7,fill:"url(#missile_fire)",className:"missile-fire-trail",transform:`rotate(${m}) translate(${-n}, 0)`}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===$.Black?"#111827":"#f5f2e8"}),t.jsx("circle",{cx:0,cy:0,r:n,fill:a===$.Black?"url(#slate_highlight)":"url(#clamshell_highlight)"}),t.jsx("image",{href:a===$.Black?Nc:wc,x:-p,y:-p,width:u,height:u})]})});return t.jsx("g",{style:{pointerEvents:"none"},children:h})},V0=({animation:e,toSvgCoords:n,stone_radius:s})=>{const{point:l,success:r}=e,{cx:a,cy:i}=n(l),o=s*2.5;return t.jsx("g",{style:{pointerEvents:"none"},children:r?t.jsxs(t.Fragment,{children:[t.jsx("circle",{cx:a,cy:i,r:o*.2,fill:"none",stroke:"#34d399",className:"scan-success-circle",style:{animationDelay:"0s"}}),t.jsx("circle",{cx:a,cy:i,r:o*.2,fill:"none",stroke:"#34d399",className:"scan-success-circle",style:{animationDelay:"0.2s"}}),t.jsx("circle",{cx:a,cy:i,r:o*.2,fill:"none",stroke:"#34d399",className:"scan-success-circle",style:{animationDelay:"0.4s"}})]}):t.jsxs(t.Fragment,{children:[t.jsx("line",{x1:a-o/2,y1:i-o/2,x2:a+o/2,y2:i+o/2,stroke:"#f87171",strokeWidth:"4",strokeLinecap:"round",className:"scan-fail-line"}),t.jsx("line",{x1:a+o/2,y1:i-o/2,x2:a-o/2,y2:i+o/2,stroke:"#f87171",strokeWidth:"4",strokeLinecap:"round",className:"scan-fail-line",style:{animationDelay:"0.2s"}})]})})},K0=({move:e,toSvgCoords:n,cellSize:s,onClick:l})=>{const{cx:r,cy:a}=n({x:e.x,y:e.y}),i=s*.45,c=["#3b82f6","#16a34a","#f59e0b"][e.order-1]||"#6b7280";return t.jsxs("g",{onClick:d=>{d.stopPropagation(),l(e.x,e.y)},className:"cursor-pointer recommended-move-marker",children:[t.jsx("circle",{cx:r,cy:a,r:i,fill:c,fillOpacity:"0.7",stroke:"white",strokeWidth:"2"}),t.jsx("text",{x:r,y:a,textAnchor:"middle",dy:".35em",fontSize:i*1.2,fontWeight:"bold",fill:"white",style:{pointerEvents:"none",textShadow:"0 0 3px black"},children:e.order})]})},Sr=({player:e,cx:n,cy:s,isLastMove:l,isSelectedMissile:r,isHoverSelectableMissile:a,isKnownHidden:i,isNewlyRevealed:o,animationClass:c,isPending:d,isBaseStone:u,isPatternStone:p,radius:m,isFaint:h})=>{const y=m*2*.7,v=y/2,b=d?"rgb(34, 197, 94)":r?"rgb(239, 68, 68)":"none",g=r||d?3.5:0;return t.jsxs("g",{className:`${c||""} ${a?"missile-selectable-stone":""}`,opacity:d?.6:h?.4:1,children:[t.jsx("circle",{cx:n,cy:s,r:m,fill:e===$.Black?"#111827":"#f5f2e8",stroke:b,strokeWidth:g}),e===$.White&&t.jsx("circle",{cx:n,cy:s,r:m,fill:"url(#clam_grain)"}),t.jsx("circle",{cx:n,cy:s,r:m,fill:e===$.Black?"url(#slate_highlight)":"url(#clamshell_highlight)"}),u&&t.jsx("image",{href:e===$.Black?Da:Oa,x:n-v,y:s-v,width:y,height:y}),i&&t.jsx("image",{href:e===$.Black?Nc:wc,x:n-v,y:s-v,width:y,height:y}),p&&t.jsx("image",{href:e===$.Black?"/images/single/BlackDouble.png":"/images/single/WhiteDouble.png",x:n-v,y:s-v,width:y,height:y}),o&&t.jsx("circle",{cx:n,cy:s,r:m,fill:"none",stroke:"rgba(0, 255, 255, 0.8)",strokeWidth:"4",className:"sparkle-animation",style:{pointerEvents:"none",transformOrigin:"center"}}),l&&t.jsx("circle",{cx:n,cy:s,r:m*.25,fill:"rgba(239, 68, 68, 0.9)",className:"animate-pulse",style:{pointerEvents:"none"}})]})},qa=e=>{var vt;const{boardState:n,boardSize:s,onBoardClick:l,onMissileLaunch:r,lastMove:a,lastTurnStones:i,isBoardDisabled:o,stoneColor:c,winningLine:d,hiddenMoves:u,moveHistory:p,baseStones:m,baseStones_p1:h,baseStones_p2:y,myPlayerEnum:v,gameStatus:b,highlightedPoints:g,highlightStyle:x="circle",myRevealedStones:j,allRevealedStones:w,newlyRevealed:k,isSpectator:C,analysisResult:S,showTerritoryOverlay:P=!1,showHintOverlay:_=!1,currentUser:I,blackPlayerNickname:T,whitePlayerNickname:B,currentPlayer:R,isItemModeActive:A,animation:L,mode:Q,mixedModes:q,justCaptured:O,permanentlyRevealedStones:U,onAction:G,gameId:z,showLastMoveMarker:H,blackPatternStones:ne,whitePatternStones:oe}=e,[me,ve]=f.useState(null),[J,fe]=f.useState(null),[ye,K]=f.useState(!1),[W,D]=f.useState(null),[V,Y]=f.useState(null),[ie,je]=f.useState(window.innerWidth<1024),E=f.useRef(null),Z=f.useRef(null),le=840,ae=s>0?s:19,de=le/ae,te=de/2,pe=de*.47;f.useEffect(()=>{const xe=()=>je(window.innerWidth<1024);return window.addEventListener("resize",xe),()=>window.removeEventListener("resize",xe)},[]);const we=f.useMemo(()=>{const xe=at.map(Ae=>Ae.mode),ce=[M.Omok,M.Ttamok,M.Dice,M.Thief];return xe.includes(Q)||ce.includes(Q)||b.startsWith("single_player")},[Q,b]);f.useEffect(()=>{b!=="missile_selecting"&&fe(null)},[b]);const ue=f.useMemo(()=>ae===19?[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}]:ae===15?[{x:3,y:3},{x:11,y:3},{x:7,y:7},{x:3,y:11},{x:11,y:11}]:ae===13?[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9},{x:6,y:6}]:ae===11?[{x:2,y:2},{x:8,y:2},{x:5,y:5},{x:2,y:8},{x:8,y:8}]:ae===9?[{x:2,y:2},{x:6,y:2},{x:4,y:4},{x:2,y:6},{x:6,y:6}]:ae===7?[{x:3,y:3}]:[],[ae]),Se=xe=>({cx:te+xe.x*de,cy:te+xe.y*de}),qe=xe=>{const ce=Z.current;if(!ce)return null;const Ae=ce.createSVGPoint();Ae.x=xe.clientX,Ae.y=xe.clientY;const ke=ce.getScreenCTM();if(ke){const Ie=Ae.matrixTransform(ke.inverse()),mt=Math.round((Ie.x-te)/de),ot=Math.round((Ie.y-te)/de);if(mt>=0&&mt<ae&&ot>=0&&ot<ae)return{x:mt,y:ot}}return null},Be=f.useCallback(xe=>{const ce=[];return xe.x>0&&ce.push({x:xe.x-1,y:xe.y}),xe.x<ae-1&&ce.push({x:xe.x+1,y:xe.y}),xe.y>0&&ce.push({x:xe.x,y:xe.y-1}),xe.y<ae-1&&ce.push({x:xe.x,y:xe.y+1}),ce},[ae]),He=xe=>{const ce=qe(xe);ce&&(ve(ce),b==="missile_selecting"&&!o&&n[ce.y][ce.x]===v&&Be(ce).some(Ie=>n[Ie.y][Ie.x]===$.None)&&(fe(ce),K(!0),D({x:xe.clientX,y:xe.clientY}),E.current=ce,xe.target.setPointerCapture(xe.pointerId)))},se=xe=>{const ce=qe(xe);ve(ce),ye&&Y({x:xe.clientX,y:xe.clientY})},Me=xe=>{xe.target.releasePointerCapture(xe.pointerId);const ce=qe(xe);if(ye){const Ae=W&&V?Math.hypot(V.x-W.x,V.y-W.y):0,ke=E.current;if(K(!1),D(null),Y(null),!ie&&Ae<10)return;if(ke&&ce&&r){const Ie=ce.x-ke.x,mt=ce.y-ke.y;if(Ie!==0||mt!==0){let ot;Math.abs(Ie)>Math.abs(mt)?ot=Ie>0?"right":"left":ot=mt>0?"down":"up",r(ke,ot),fe(null)}}}else!o&&ce&&l(ce.x,ce.y)},_e=f.useMemo(()=>b!=="base_placement"?null:v===$.Black?h:y,[b,v,h,y]),Ge=xe=>{if(!u||!p||b!=="playing"&&b!=="hidden_placing")return!1;const ce=v===$.Black?$.White:$.Black;for(let Ae=p.length-1;Ae>=0;Ae--){const ke=p[Ae];if(ke.x===xe.x&&ke.y===xe.y)return!!u[Ae]&&ke.player===ce}return!1},it=b==="ended"||b==="no_contest",Gt=me&&!o&&b!=="scanning"&&b!=="missile_selecting"&&(n[me.y][me.x]===$.None||Ge(me)),bt=()=>!P||!S||!S.deadStones?null:t.jsx("g",{style:{pointerEvents:"none"},className:"animate-fade-in",children:S.deadStones.map((xe,ce)=>{const{cx:Ae,cy:ke}=Se(xe),Ie=pe*.7;return t.jsxs("g",{children:[t.jsx("line",{x1:Ae-Ie,y1:ke-Ie,x2:Ae+Ie,y2:ke+Ie,stroke:"red",strokeWidth:"3",strokeLinecap:"round"}),t.jsx("line",{x1:Ae-Ie,y1:ke+Ie,x2:Ae+Ie,y2:ke-Ie,stroke:"red",strokeWidth:"3",strokeLinecap:"round"})]},`ds-${ce}`)})}),en=(xe,ce,Ae)=>{const ke=xe.moveHistory||[];if(!Array.isArray(ke))return-1;for(let Ie=ke.length-1;Ie>=0;Ie--)if(ke[Ie].x===ce&&ke[Ie].y===Ae)return Ie;return-1},Ct=()=>{var ke;if(b!=="missile_selecting"||!J||!r)return null;if(ye&&W&&V){const Ie=Z.current;if(!Ie)return null;const mt=(ke=Ie.getScreenCTM())==null?void 0:ke.inverse();if(!mt)return null;const ot=Se(J),Wt=Ie.createSVGPoint();Wt.x=V.x,Wt.y=V.y;const Ht=Wt.matrixTransform(mt),cn=Ht.x-ot.cx,dn=Ht.y-ot.cy;let un={cx:ot.cx,cy:ot.cy};return Math.abs(cn)>Math.abs(dn)?un.cx+=Math.sign(cn)*de*2:un.cy+=Math.sign(dn)*de*2,t.jsx("g",{style:{pointerEvents:"none"},children:t.jsx("line",{x1:ot.cx,y1:ot.cy,x2:un.cx,y2:un.cy,stroke:"rgba(239, 68, 68, 0.7)",strokeWidth:"4",strokeDasharray:"8 4",markerEnd:"url(#arrowhead-missile)"})})}const xe=Be(J).filter(Ie=>n[Ie.y][Ie.x]===$.None);if(xe.length===0)return null;const ce=de*.4,Ae=[{dir:"up",point:{x:J.x,y:J.y-1}},{dir:"down",point:{x:J.x,y:J.y+1}},{dir:"left",point:{x:J.x-1,y:J.y}},{dir:"right",point:{x:J.x+1,y:J.y}}];return t.jsx("g",{children:Ae.map(({dir:Ie,point:mt})=>{if(!xe.some(cn=>cn.x===mt.x&&cn.y===mt.y))return null;const{cx:Wt,cy:Ht}=Se(mt);return t.jsx("polygon",{points:`${Wt},${Ht-ce} ${Wt+ce},${Ht} ${Wt},${Ht+ce} ${Wt-ce},${Ht}`,fill:"rgba(239, 68, 68, 0.8)",stroke:"white",strokeWidth:"1",className:"cursor-pointer hover:opacity-100 opacity-80",onClick:()=>r(J,Ie)},Ie)})})};return t.jsx("div",{className:`relative w-full h-full shadow-2xl rounded-lg overflow-hidden p-0 border-4 ${A?"prism-border":"border-gray-800"}`,children:t.jsxs("svg",{ref:Z,viewBox:`0 0 ${le} ${le}`,className:"w-full h-full touch-none",onPointerDown:He,onPointerMove:se,onPointerUp:Me,onPointerLeave:()=>{ve(null)},children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"slate_highlight",cx:"35%",cy:"35%",r:"60%",fx:"30%",fy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#6b7280",stopOpacity:"0.8"}),t.jsx("stop",{offset:"100%",stopColor:"#111827",stopOpacity:"0.2"})]}),t.jsxs("radialGradient",{id:"clamshell_highlight",cx:"35%",cy:"35%",r:"60%",fx:"30%",fy:"30%",children:[t.jsx("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"0.9"}),t.jsx("stop",{offset:"100%",stopColor:"#e5e7eb",stopOpacity:"0.1"})]}),t.jsxs("filter",{id:"clam_grain_filter",children:[t.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.8",numOctaves:"4",stitchTiles:"stitch"}),t.jsx("feColorMatrix",{type:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 0.1 0"})]}),t.jsxs("pattern",{id:"clam_grain",patternUnits:"userSpaceOnUse",width:"100",height:"100",children:[t.jsx("rect",{width:"100",height:"100",fill:"#f5f2e8"}),t.jsx("rect",{width:"100",height:"100",filter:"url(#clam_grain_filter)"})]}),t.jsxs("radialGradient",{id:"missile_fire",cx:"50%",cy:"50%",r:"50%",children:[t.jsx("stop",{offset:"0%",stopColor:"#fca5a5"}),t.jsx("stop",{offset:"50%",stopColor:"#f87171"}),t.jsx("stop",{offset:"100%",stopColor:"#ef4444",stopOpacity:"0"})]}),t.jsxs("linearGradient",{id:"bonus-gradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[t.jsx("stop",{offset:"0%",stopColor:"#fef08a"}),t.jsx("stop",{offset:"100%",stopColor:"#f59e0b"})]}),t.jsxs("filter",{id:"blue-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"3.5",result:"blur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"blur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]}),t.jsx("marker",{id:"arrowhead-missile",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"rgba(239, 68, 68, 0.9)"})})]}),t.jsx("rect",{width:le,height:le,fill:"#e0b484"}),Array.from({length:ae}).map((xe,ce)=>t.jsxs("g",{children:[t.jsx("line",{x1:te+ce*de,y1:te,x2:te+ce*de,y2:le-te,stroke:"#54432a",strokeWidth:"1.5"}),t.jsx("line",{x1:te,y1:te+ce*de,x2:le-te,y2:te+ce*de,stroke:"#54432a",strokeWidth:"1.5"})]},ce)),ue.map((xe,ce)=>t.jsx("circle",{...Se(xe),r:ae>9?6:4,fill:"#54432a"},ce)),P&&(S==null?void 0:S.ownershipMap)&&t.jsx(G0,{ownershipMap:S.ownershipMap,toSvgCoords:Se,cellSize:de}),n.map((xe,ce)=>xe.map((Ae,ke)=>{if(Ae===$.None)return null;const{cx:Ie,cy:mt}=Se({x:ke,y:ce}),ot=H&&we&&a&&a.x===ke&&a.y===ce,Wt=H&&we&&i&&i.some(Ve=>Ve.x===ke&&Ve.y===ce),Ht=!!(ot||Wt),cn=p?en({moveHistory:p},ke,ce):-1,dn=u&&cn!==-1&&u[cn],un=U==null?void 0:U.some(Ve=>Ve.x===ke&&Ve.y===ce);let ss=!0;if(dn)if(C)ss=it||!!un;else{const Ve=!C&&(j==null?void 0:j.some(ls=>ls.x===ke&&ls.y===ce)),Ga=k==null?void 0:k.some(ls=>ls.point.x===ke&&ls.point.y===ce);ss=it||!!un||Ae===v||!!Ve||!!Ga}if(!ss||(L==null?void 0:L.type)==="missile"&&L.from.x===ke&&L.from.y===ce||(L==null?void 0:L.type)==="hidden_missile"&&L.from.x===ke&&L.from.y===ce)return null;const lr=k==null?void 0:k.some(Ve=>Ve.point.x===ke&&Ve.point.y===ce),js=!C&&(j==null?void 0:j.some(Ve=>Ve.x===ke&&Ve.y===ce))&&!un,Ua=m==null?void 0:m.some(Ve=>Ve.x===ke&&Ve.y===ce&&Ve.player===Ae),rr=dn,za=(J==null?void 0:J.x)===ke&&(J==null?void 0:J.y)===ce,ar=b==="missile_selecting"&&!J&&Ae===v,Fa=Ae===$.Black&&(ne==null?void 0:ne.some(Ve=>Ve.x===ke&&Ve.y===ce))||Ae===$.White&&(oe==null?void 0:oe.some(Ve=>Ve.x===ke&&Ve.y===ce));return t.jsx(Sr,{player:Ae,cx:Ie,cy:mt,isLastMove:Ht,isKnownHidden:rr,isBaseStone:Ua,isPatternStone:Fa,isNewlyRevealed:lr,animationClass:lr?"sparkle-animation":"",isSelectedMissile:za,isHoverSelectableMissile:ar,radius:pe,isFaint:js},`${ke}-${ce}`)})),_e==null?void 0:_e.map((xe,ce)=>{const{cx:Ae,cy:ke}=Se(xe);return t.jsx("g",{opacity:.7,className:"animate-fade-in",children:t.jsx(Sr,{player:v,cx:Ae,cy:ke,isBaseStone:!0,radius:pe})},`my-base-${ce}`)}),d&&d.length>0&&t.jsx("path",{d:`M ${Se(d[0]).cx} ${Se(d[0]).cy} L ${Se(d[d.length-1]).cx} ${Se(d[d.length-1]).cy}`,stroke:"rgba(239, 68, 68, 0.8)",strokeWidth:"10",strokeLinecap:"round",className:"animate-fade-in"}),g&&g.map((xe,ce)=>{const{cx:Ae,cy:ke}=Se(xe);return x==="ring"?t.jsx("circle",{cx:Ae,cy:ke,r:pe*.9,fill:"none",stroke:"#0ea5e9",strokeWidth:"3",strokeDasharray:"5 3",className:"animate-pulse",style:{pointerEvents:"none"}},`highlight-ring-${ce}`):t.jsx("circle",{cx:Ae,cy:ke,r:pe*.3,fill:R===$.Black?"black":"white",opacity:"0.3"},`highlight-circle-${ce}`)}),Gt&&me&&t.jsxs("g",{opacity:"0.5",children:[" ",t.jsx(Sr,{player:c,cx:Se(me).cx,cy:Se(me).cy,radius:pe})," "]}),Ct(),L&&t.jsxs(t.Fragment,{children:[L.type==="missile"&&t.jsx(W0,{animation:L,stone_radius:pe,toSvgCoords:Se}),L.type==="hidden_missile"&&L.player===v&&!C&&t.jsx(H0,{animation:L,stone_radius:pe,toSvgCoords:Se}),L.type==="scan"&&!C&&L.playerId===I.id&&t.jsx(V0,{animation:L,toSvgCoords:Se,stone_radius:pe}),L.type==="hidden_reveal"&&L.stones.map((xe,ce)=>t.jsx(Sr,{player:xe.player,cx:Se(xe.point).cx,cy:Se(xe.point).cy,isKnownHidden:!0,animationClass:"sparkle-animation",radius:pe},`reveal-${ce}`)),L.type==="bonus_text"&&t.jsx(F0,{animation:L,toSvgCoords:Se,cellSize:de})]}),bt(),_&&!o&&((vt=S==null?void 0:S.recommendedMoves)==null?void 0:vt.map(xe=>t.jsx(K0,{move:xe,toSvgCoords:Se,cellSize:de,onClick:l},`rec-${xe.order}`)))]})})},Q0=e=>{var _,I;const{session:n,onAction:s,myPlayerEnum:l,handleBoardClick:r,isItemModeActive:a,showTerritoryOverlay:i,isMyTurn:o,isMobile:c,myRevealedMoves:d,showLastMoveMarker:u}=e,{blackPlayerId:p,whitePlayerId:m,player1:h,player2:y,settings:v,lastMove:b,gameStatus:g,mode:x}=n,j=[h,y],w=j.find(T=>T.id===p)||null,k=j.find(T=>T.id===m)||null,C=f.useMemo(()=>(d||[]).map(T=>{var B;return(B=n.moveHistory)==null?void 0:B[T]}).filter(T=>!!T).map(T=>({x:T.x,y:T.y})),[d,n.moveHistory]),S=f.useMemo(()=>{if(!n.moveHistory||!n.revealedHiddenMoves)return{};const T={};for(const B in n.revealedHiddenMoves)T[B]=n.revealedHiddenMoves[B].map(R=>{var A;return(A=n.moveHistory)==null?void 0:A[R]}).filter(R=>!!R).map(R=>({x:R.x,y:R.y}));return T},[n.revealedHiddenMoves,n.moveHistory]),P=f.useMemo(()=>at.some(T=>T.mode===x)?"bg-strategic-background":St.some(T=>T.mode===x)?"bg-playful-background":"bg-primary",[x]);return t.jsx("div",{className:`w-full h-full flex items-center justify-center ${P}`,children:t.jsx(qa,{boardState:n.boardState,boardSize:v.boardSize,onBoardClick:r,onMissileLaunch:(T,B)=>{s({type:"LAUNCH_MISSILE",payload:{gameId:n.id,from:T,direction:B}})},onAction:s,gameId:n.id,lastMove:b,lastTurnStones:n.lastTurnStones,isBoardDisabled:e.isSpectator||!o&&g!=="base_placement",stoneColor:l,winningLine:n.winningLine,mode:n.mode,mixedModes:n.settings.mixedModes,hiddenMoves:n.hiddenMoves,moveHistory:n.moveHistory,baseStones:n.baseStones,myPlayerEnum:l,gameStatus:g,currentPlayer:n.currentPlayer,highlightedPoints:[],myRevealedStones:C,allRevealedStones:S,newlyRevealed:n.newlyRevealed,justCaptured:n.justCaptured,permanentlyRevealedStones:n.permanentlyRevealedStones,isSpectator:e.isSpectator,analysisResult:((_=n.analysisResult)==null?void 0:_[e.currentUser.id])??(g==="ended"?(I=n.analysisResult)==null?void 0:I.system:null),showTerritoryOverlay:i,showHintOverlay:!1,showLastMoveMarker:u,baseStones_p1:g==="base_placement"?n.baseStones_p1:void 0,baseStones_p2:g==="base_placement"?n.baseStones_p2:void 0,currentUser:e.currentUser,blackPlayerNickname:(w==null?void 0:w.nickname)||"",whitePlayerNickname:(k==null?void 0:k.nickname)||"",isItemModeActive:a,animation:n.animation,isMobile:c})})},J0=f.forwardRef((e,n)=>{const{stones:s,gameStatus:l,myPlayer:r,isMyTurn:a,settings:i,onPlacementClick:o,onStoneInteractionStart:c,isSpectator:d,dragStartPoint:u,dragEndPoint:p,selectedStone:m,myStonesCount:h,maxStones:y,session:v,currentUser:b}=e,[g,x]=f.useState(s),[j,w]=f.useState(null),k=f.useRef(null),C=840,S=i.boardSize>0?i.boardSize:19,P=C/S,_=P/2,I=f.useMemo(()=>S===19?[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}]:S===13?[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9},{x:6,y:6}]:S===11?[{x:2,y:2},{x:8,y:2},{x:2,y:8},{x:8,y:8},{x:5,y:5}]:S===9?[{x:2,y:2},{x:6,y:2},{x:2,y:6},{x:6,y:6},{x:4,y:4}]:[],[S]),T=U=>({cx:_+U.x*P,cy:_+U.y*P});f.useEffect(()=>{l!=="alkkagi_animating"&&x(s)},[s,l]),f.useImperativeHandle(n,()=>({updateLocalStones:U=>{x([...U])},getSvg:()=>k.current}));const B=U=>{const G=k.current;if(!G)return null;const z=G.createSVGPoint();z.x=U.clientX,z.y=U.clientY;const H=G.getScreenCTM();if(H){const ne=z.matrixTransform(H.inverse());return{x:ne.x,y:ne.y}}return null},R=f.useCallback(U=>{if(!U||l!=="alkkagi_placement"&&l!=="alkkagi_simultaneous_placement"||r===$.None)return!1;const G=g&&g.length>0&&g[0].radius?g[0].radius:840/19*.47,{x:z,y:H}=U;if(z<G||z>C-G||H<G||H>C-G)return!1;let ne=!1;if(i.alkkagiLayout===el.Battle)ne=Zd[r].some(me=>{const ve=_+(me.x-.5)*P,J=_+(me.y-.5)*P,fe=ve+me.width*P,ye=J+me.height*P;return z>=ve&&z<=fe&&H>=J&&H<=ye});else{const oe=C*.15,me=C*.35,ve=C*.65,J=C*.85;r===$.White?H>=oe&&H<=me&&(ne=!0):H>=ve&&H<=J&&(ne=!0)}if(!ne)return!1;for(const oe of g)if(oe.player===r&&Math.hypot(z-oe.x,H-oe.y)<oe.radius*2)return!1;return!0},[l,r,g,i.alkkagiLayout,P,_]),A=f.useMemo(()=>R(j),[j,R]),L=U=>{if(l!=="alkkagi_placement"&&l!=="alkkagi_simultaneous_placement"||!a)return;const G=B(U);G&&R(G)&&o({x:G.x,y:G.y})},Q=a&&(l==="alkkagi_placement"||l==="alkkagi_simultaneous_placement")&&h<y,q=()=>{if(l!=="alkkagi_placement"&&l!=="alkkagi_simultaneous_placement"||d||r===$.None)return null;const U={strokeWidth:"3",rx:"5",className:Q?"animate-pulse-blue":"",style:{pointerEvents:"none"}};if(i.alkkagiLayout===el.Battle){const G=Zd[r],z=r===$.Black?"rgba(0, 0, 0, 0.25)":"rgba(255, 255, 255, 0.35)",H=r===$.Black?"rgba(50, 50, 50, 0.8)":"rgba(220, 220, 220, 0.8)";return t.jsx("g",{children:G.map((ne,oe)=>t.jsx("rect",{x:_+(ne.x-.5)*P,y:_+(ne.y-.5)*P,width:ne.width*P,height:ne.height*P,fill:z,stroke:H,...U},`zone-${oe}`))})}else{const G=C*.15,z=C*.35,H=C*.65,ne=r===$.White?G:H,oe=z-G,me=r===$.Black?"rgba(0, 0, 0, 0.25)":"rgba(255, 255, 255, 0.35)",ve=r===$.Black?"rgba(50, 50, 50, 0.8)":"rgba(220, 220, 220, 0.8)";return t.jsx("rect",{x:0,y:ne,width:C,height:oe,fill:me,stroke:ve,...U})}},O=f.useMemo(()=>{var je,E;if(!u||!p||!m||!k.current)return null;const U=k.current,G=(je=U.getScreenCTM())==null?void 0:je.inverse();if(!G)return null;const z=U.createSVGPoint();z.x=u.x,z.y=u.y;const H=z.matrixTransform(G);z.x=p.x,z.y=p.y;const ne=z.matrixTransform(G),oe=ne.x-H.x,me=ne.y-H.y,ve=m,J={x:ve.x,y:ve.y};let fe={x:J.x-oe,y:J.y-me};const K=(((E=v.activeAlkkagiItems)==null?void 0:E[b.id])||[]).includes("aimingLine"),W=80*.2,D=K?W*11:W,V=fe.x-J.x,Y=fe.y-J.y,ie=Math.hypot(V,Y);return ie>D&&(fe.x=J.x+V/ie*D,fe.y=J.y+Y/ie*D),{start:J,end:fe}},[u,p,m,v.activeAlkkagiItems,b.id]);return t.jsx("div",{className:"relative w-full h-full shadow-2xl rounded-lg overflow-hidden border-4 border-gray-800",children:t.jsxs("svg",{ref:k,viewBox:`0 0 ${C} ${C}`,className:"w-full h-full touch-none",onClick:L,onMouseMove:U=>{const G=B(U);w(G)},onMouseLeave:()=>w(null),children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"gloss-alkkagi-1",children:[t.jsx("stop",{offset:"10%",stopColor:"#333"}),t.jsx("stop",{offset:"95%",stopColor:"#000"})]}),t.jsxs("radialGradient",{id:"gloss-alkkagi-2",children:[t.jsx("stop",{offset:"10%",stopColor:"#fff"}),t.jsx("stop",{offset:"95%",stopColor:"#ccc"})]}),t.jsx("marker",{id:"arrowhead-alkkagi",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"rgba(239, 68, 68, 0.9)"})})]}),t.jsx("rect",{width:C,height:C,fill:"#DDAA77"}),Array.from({length:S}).map((U,G)=>t.jsxs("g",{children:[t.jsx("line",{x1:_+G*P,y1:_,x2:_+G*P,y2:C-_,stroke:"#54432a",strokeWidth:"1.5"}),t.jsx("line",{x1:_,y1:_+G*P,x2:C-_,y2:_+G*P,stroke:"#54432a",strokeWidth:"1.5"})]},G)),I.map((U,G)=>t.jsx("circle",{...T(U),r:S>9?5:4,fill:"#54432a"},G)),q(),g.map(U=>{if(!U.onBoard)return null;const G=U.player===r,z=!d&&a&&l==="alkkagi_playing",H=z&&G?"cursor-pointer":"";return t.jsxs("g",{className:H,onMouseDown:z&&G?ne=>c(U,ne):void 0,onTouchStart:z&&G?ne=>{ne.preventDefault(),c(U,ne)}:void 0,children:[t.jsx("circle",{cx:U.x,cy:U.y,r:U.radius,fill:U.player===$.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:U.x,cy:U.y,r:U.radius,fill:`url(#gloss-alkkagi-${U.player})`})]},U.id)}),Q&&j&&A&&t.jsx("g",{opacity:"0.5",style:{pointerEvents:"none"},children:t.jsx("circle",{cx:j.x,cy:j.y,r:g&&g[0]?g[0].radius:840/19*.47,fill:r===$.Black?"#111827":"#f9fafb"})}),O&&t.jsx("g",{style:{pointerEvents:"none"},children:t.jsx("line",{x1:O.start.x,y1:O.start.y,x2:O.end.x,y2:O.end.y,stroke:"rgba(239, 68, 68, 0.7)",strokeWidth:"4",strokeDasharray:"8 4",markerEnd:"url(#arrowhead-alkkagi)"})})]})})});function wu(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const Y0=e=>{const{session:n,onAction:s,currentUser:l,isSpectator:r}=e,{id:a,settings:i,gameStatus:o,alkkagiStones:c,currentPlayer:d,player1:u,alkkagiStones_p1:p,alkkagiStones_p2:m,activeAlkkagiItems:h}=n,y=f.useRef(null),v=f.useRef(null),b=f.useRef(null),g=f.useRef(null),x=f.useRef(null),j=f.useRef(0),w=f.useRef(!1),k=f.useRef(null),C=f.useRef(null),S=f.useRef(0),[P,_]=f.useState(null),[I,T]=f.useState(null),[B,R]=f.useState(null),[A,L]=f.useState(0),[Q,q]=f.useState(null),[O,U]=f.useState(window.innerWidth<1024),G=f.useRef(e);f.useEffect(()=>{G.current=e});const z=wu(n.turnStartTime),H=wu(n.gameStatus),ne=f.useCallback(()=>{b.current&&(cancelAnimationFrame(b.current),b.current=null),g.current=null},[]),oe=f.useCallback(()=>{w.current=!1,k.current=null,C.current=null,ne(),_(null),T(null),R(null),L(0),S.current=0},[ne]);f.useEffect(()=>{n.turnStartTime!==z&&oe()},[n.turnStartTime,z,oe]),f.useEffect(()=>{H==="alkkagi_animating"&&n.gameStatus!=="alkkagi_animating"&&q(null)},[n.gameStatus,H]),f.useEffect(()=>{const E=()=>U(window.innerWidth<1024);return window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]);const me=f.useMemo(()=>n.blackPlayerId===l.id?$.Black:n.whitePlayerId===l.id?$.White:$.None,[n.blackPlayerId,n.whitePlayerId,l.id]),ve=f.useMemo(()=>r?!1:o==="alkkagi_simultaneous_placement"?!0:d===me,[o,d,me,r]),J=me===$.White,fe=f.useMemo(()=>{if(o==="alkkagi_simultaneous_placement"||o==="alkkagi_placement"){const E=l.id===u.id?p:m;return[...c||[],...E||[]]}return c||[]},[o,c,p,m,l.id,u.id]),ye=f.useMemo(()=>{var Z;const E=(n.alkkagiStones||[]).filter(le=>le.player===me).length;if(n.gameStatus==="alkkagi_simultaneous_placement"||n.gameStatus==="alkkagi_placement"){const le=((Z=l.id===n.player1.id?n.alkkagiStones_p1:n.alkkagiStones_p2)==null?void 0:Z.length)||0;return E+le}return E},[n,l.id,me]),K=f.useCallback(E=>{const{session:Z,onAction:le}=G.current;le({type:"ALKKAGI_PLACE_STONE",payload:{gameId:Z.id,point:E}})},[]),W=f.useCallback(()=>{ne(),q(null),g.current=performance.now();const E=Z=>{var He;g.current||(g.current=Z);const{session:le,currentUser:ae}=G.current,te=(((He=le.activeAlkkagiItems)==null?void 0:He[ae.id])||[]).includes("slow"),pe=le.settings.alkkagiGaugeSpeed||900,we=te?pe*2:pe,ue=we/2,qe=(Z-g.current)%we/ue;let Be;qe<=1?Be=qe*100:Be=(2-qe)*100,x.current&&(x.current.style.width=`${Be}%`),S.current=Be,b.current=requestAnimationFrame(E)};b.current=requestAnimationFrame(E)},[ne]),D=f.useCallback((E,Z,le,ae)=>{v.current&&cancelAnimationFrame(v.current);let de=JSON.parse(JSON.stringify(E||[])),te=de.find(Be=>Be.id===Z);if(te)te.vx=le,te.vy=ae;else return;const pe=840,we=.98;let ue=0;const Se=1e3,qe=()=>{var He;let Be=!1;for(const se of de)se.onBoard&&(se.x+=se.vx,se.y+=se.vy,se.vx*=we,se.vy*=we,Math.abs(se.vx)<.01&&(se.vx=0),Math.abs(se.vy)<.01&&(se.vy=0),(Math.abs(se.vx)>0||Math.abs(se.vy)>0)&&(Be=!0),(se.x<0||se.x>pe||se.y<0||se.y>pe)&&se.onBoard&&(se.onBoard=!1,se.timeOffBoard=Date.now(),Ee.stoneFallOff()));for(let se=0;se<de.length;se++)for(let Me=se+1;Me<de.length;Me++){const _e=de[se],Ge=de[Me];if(!_e.onBoard||!Ge.onBoard)continue;const it=Ge.x-_e.x,Gt=Ge.y-_e.y,bt=Math.hypot(it,Gt),en=_e.radius+Ge.radius;if(bt<en){Ee.stoneCollision();const Ct=it/bt,vt=Gt/bt,xe=Ge.vx-_e.vx,ce=Ge.vy-_e.vy,Ae=xe*Ct+ce*vt;if(Ae<0){const Ie=Ae;_e.vx+=Ie*Ct,_e.vy+=Ie*vt,Ge.vx-=Ie*Ct,Ge.vy-=Ie*vt}const ke=(en-bt)/2;_e.x-=ke*Ct,_e.y-=ke*vt,Ge.x+=ke*Ct,Ge.y+=ke*vt}}(He=y.current)==null||He.updateLocalStones(de),ue++,Be&&ue<Se?v.current=requestAnimationFrame(qe):v.current=null};v.current=requestAnimationFrame(qe)},[]),V=f.useCallback((E,Z)=>{Z.preventDefault();const{session:le,currentUser:ae}=G.current,de=le.blackPlayerId===ae.id?$.Black:le.whitePlayerId===ae.id?$.White:$.None;if(!(le.currentPlayer===de)||le.gameStatus!=="alkkagi_playing")return;const pe="touches"in Z?{x:Z.touches[0].clientX,y:Z.touches[0].clientY}:{x:Z.clientX,y:Z.clientY};w.current=!0,k.current=E,C.current=pe,_(E.id),T(pe),R(pe),W()},[W]);f.useEffect(()=>{const E=ae=>{if(!w.current)return;"preventDefault"in ae&&ae.preventDefault();const de="touches"in ae?{x:ae.touches[0].clientX,y:ae.touches[0].clientY}:{x:ae.clientX,y:ae.clientY};R(de)},Z=ae=>{var qe,Be;if(!w.current)return;const{session:de,onAction:te}=G.current,pe=k.current,we=C.current,ue="touches"in ae?{x:ae.changedTouches[0].clientX,y:ae.changedTouches[0].clientY}:{x:ae.clientX,y:ae.clientY};ne();const Se=S.current;if(q(Se),pe&&we&&ue){const He=(qe=y.current)==null?void 0:qe.getSvg();if(!He){oe();return}const se=(Be=He.getScreenCTM())==null?void 0:Be.inverse();if(!se){oe();return}const Me=He.createSVGPoint();Me.x=we.x,Me.y=we.y;const _e=Me.matrixTransform(se);Me.x=ue.x,Me.y=ue.y;const Ge=Me.matrixTransform(se),it=Ge.x-_e.x,Gt=Ge.y-_e.y,bt=-it,en=-Gt,Ct=Se/100*25,vt=Math.hypot(bt,en);if(vt>0){const xe=bt/vt*Ct,ce=en/vt*Ct;te({type:"ALKKAGI_FLICK_STONE",payload:{gameId:de.id,stoneId:pe.id,vx:xe,vy:ce}})}}w.current=!1,k.current=null,C.current=null,_(null),T(null),R(null),L(0),S.current=0,setTimeout(()=>q(null),1500)},le=ae=>{w.current&&(ae.preventDefault(),oe())};return window.addEventListener("mousemove",E,{passive:!1}),window.addEventListener("touchmove",E,{passive:!1}),window.addEventListener("mouseup",Z),window.addEventListener("touchend",Z),window.addEventListener("contextmenu",le),()=>{window.removeEventListener("mousemove",E),window.removeEventListener("touchmove",E),window.removeEventListener("mouseup",Z),window.removeEventListener("touchend",Z),window.removeEventListener("contextmenu",le),ne(),v.current&&cancelAnimationFrame(v.current)}},[ne,oe]),f.useEffect(()=>{const{session:E}=G.current,Z=E.animation;if((Z==null?void 0:Z.type)==="alkkagi_flick"&&Z.startTime>j.current){j.current=Z.startTime;const{stoneId:le,vx:ae,vy:de}=Z;D(E.alkkagiStones||[],le,ae,de)}},[n.animation,D]);const Y=Q!==null?Q:A,ie=n.settings.alkkagiStoneCount||5,je=f.useMemo(()=>P&&(c==null?void 0:c.find(E=>E.id===P))||null,[P,c]);return t.jsxs("div",{className:"relative w-full h-full flex items-center justify-center px-4 sm:px-6 lg:px-0",children:[t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 w-3/4 max-w-md z-10 pointer-events-none",children:(I||Q!==null)&&t.jsxs("div",{className:`bg-gray-900/50 rounded-full h-6 border-2 border-gray-500 ${Q!==null?"animate-flick-power-pulse":""}`,children:[t.jsx("div",{ref:x,className:"bg-gradient-to-r from-yellow-400 to-red-500 h-full rounded-full",style:{width:`${Y}%`}}),t.jsx("span",{className:"absolute inset-0 w-full h-full flex items-center justify-center text-white font-bold text-sm drop-shadow-md",children:"POWER"})]})}),t.jsx("div",{className:`w-full h-full transition-transform duration-500 ${J?"rotate-180":""}`,children:t.jsx(J0,{ref:y,stones:fe,gameStatus:o,myPlayer:me,isMyTurn:ve,settings:i,onPlacementClick:K,onStoneInteractionStart:V,isSpectator:r,dragStartPoint:I,dragEndPoint:B,selectedStone:je,myStonesCount:ye,maxStones:ie,session:n,currentUser:l})})]})},X0=f.forwardRef((e,n)=>{const{stones:s,gameStatus:l,myPlayer:r,currentPlayer:a,onLaunchAreaInteractionStart:i,isSpectator:o,dragStartPoint:c,dragEndPoint:d,selectedStone:u,currentUser:p,session:m}=e,[h,y]=f.useState(s),v=f.useRef(null),b=840,g=19,x=b/g,j=x/2,w={x:b/2,y:b/2};f.useEffect(()=>{y(s)},[s]),f.useImperativeHandle(n,()=>({updateLocalStones:R=>{y([...R])},getSvg:()=>v.current}));const k=f.useMemo(()=>[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}],[g]),C=R=>({cx:j+R.x*x,cy:j+R.y*x}),S=f.useMemo(()=>{var K,W;if(!c||!d||!u||!v.current)return null;const R=v.current,A=(K=R.getScreenCTM())==null?void 0:K.inverse();if(!A)return null;const L=R.createSVGPoint();L.x=c.x,L.y=c.y;const Q=L.matrixTransform(A);L.x=d.x,L.y=d.y;const q=L.matrixTransform(A),O=q.x-Q.x,U=q.y-Q.y,G=u,z={x:G.x,y:G.y};let H={x:z.x-O,y:z.y-U};const oe=(((W=m.activeCurlingItems)==null?void 0:W[p.id])||[]).includes("aimingLine"),me=80*.2,ve=oe?me*11:me,J=H.x-z.x,fe=H.y-z.y,ye=Math.hypot(J,fe);return ye>ve&&(H.x=z.x+J/ye*ve,H.y=z.y+fe/ye*ve),{start:z,end:H}},[c,d,u,m.activeCurlingItems,p.id]),P=()=>{const R=[x*6,x*4,x*2,x*.5],A=["rgba(0, 100, 255, 0.2)","rgba(255, 255, 255, 0.2)","rgba(255, 0, 0, 0.2)","white"];return t.jsxs("g",{children:[R.map((L,Q)=>t.jsx("circle",{cx:w.x,cy:w.y,r:L,fill:A[Q]},Q)),t.jsx("line",{x1:0,y1:w.y,x2:b,y2:w.y,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1"}),t.jsx("line",{x1:w.x,y1:0,x2:w.x,y2:b,stroke:"rgba(255,255,255,0.1)",strokeWidth:"1"})]})},_=!o&&l==="curling_playing"&&r===a,T=1*x,B=[{x:j,y:j,player:$.White},{x:b-j-T,y:j,player:$.White},{x:j,y:b-j-T,player:$.Black},{x:b-j-T,y:b-j-T,player:$.Black}];return t.jsx("div",{className:"relative w-full h-full shadow-2xl rounded-lg overflow-hidden border-4 border-gray-800",children:t.jsxs("svg",{ref:v,viewBox:`0 0 ${b} ${b}`,className:"w-full h-full",children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"gloss-curling-1",children:[t.jsx("stop",{offset:"10%",stopColor:"#333"}),t.jsx("stop",{offset:"95%",stopColor:"#000"})]}),t.jsxs("radialGradient",{id:"gloss-curling-2",children:[t.jsx("stop",{offset:"10%",stopColor:"#fff"}),t.jsx("stop",{offset:"95%",stopColor:"#ccc"})]}),t.jsx("marker",{id:"arrowhead-curling",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"rgba(239, 68, 68, 0.9)"})})]}),t.jsx("rect",{width:b,height:b,fill:"#DDAA77"}),Array.from({length:g}).map((R,A)=>t.jsxs("g",{children:[t.jsx("line",{x1:j+A*x,y1:j,x2:j+A*x,y2:b-j,stroke:"#54432a",strokeWidth:"1.5"}),t.jsx("line",{x1:j,y1:j+A*x,x2:b-j,y2:j+A*x,stroke:"#54432a",strokeWidth:"1.5"})]},A)),k.map((R,A)=>t.jsx("circle",{...C(R),r:5,fill:"#54432a"},A)),P(),B.map((R,A)=>{const L=_&&R.player===r,Q=[L?"cursor-pointer":"cursor-default",L?"animate-pulse-white":""].filter(Boolean).join(" ");return t.jsx("rect",{x:R.x,y:R.y,width:T,height:T,fill:L?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.03)",stroke:L?"rgba(255, 255, 255, 0.8)":"rgba(255, 255, 255, 0.1)",strokeWidth:L?3:2,rx:"5",className:Q,onMouseDown:L?q=>i(q,R):void 0,onTouchStart:L?q=>{q.preventDefault(),i(q,R)}:void 0},`launch-area-${A}`)}),h.map(R=>R.onBoard?t.jsxs("g",{children:[t.jsx("circle",{cx:R.x,cy:R.y,r:R.radius,fill:R.player===$.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:R.x,cy:R.y,r:R.radius,fill:`url(#gloss-curling-${R.player})`})]},R.id):null),u&&S&&t.jsxs("g",{opacity:"0.7",children:[t.jsx("circle",{cx:u.x,cy:u.y,r:u.radius,fill:u.player===$.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:u.x,cy:u.y,r:u.radius,fill:`url(#gloss-curling-${u.player})`})]}),S&&t.jsx("g",{style:{pointerEvents:"none"},children:t.jsx("line",{x1:S.start.x,y1:S.start.y,x2:S.end.x,y2:S.end.y,stroke:"rgba(239, 68, 68, 0.7)",strokeWidth:"4",strokeDasharray:"8 4",markerEnd:"url(#arrowhead-curling)"})})]})})});function Nu(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const Z0=f.forwardRef((e,n)=>{const{session:s,onAction:l,currentUser:r,isSpectator:a}=e,{id:i,settings:o,gameStatus:c,curlingStones:d,currentPlayer:u,activeCurlingItems:p}=s,m=f.useRef(null),h=f.useRef(null),y=f.useRef(null),v=f.useRef(null),b=f.useRef(null),g=f.useRef(0),x=f.useRef(0),j=f.useRef(!1),w=f.useRef(null),k=f.useRef(null),[C,S]=f.useState(null),[P,_]=f.useState(null),[I,T]=f.useState(null),[B,R]=f.useState(0),[A,L]=f.useState(null),[Q,q]=f.useState(!1),[O,U]=f.useState(window.innerWidth<1024),G=f.useRef(e);f.useEffect(()=>{G.current=e});const z=f.useMemo(()=>s.blackPlayerId===r.id?$.Black:s.whitePlayerId===r.id?$.White:$.None,[s.blackPlayerId,s.whitePlayerId,r.id]);f.useMemo(()=>a?!1:u===z,[u,z,a]);const H=z===$.White,ne=Nu(s.gameStatus),oe=Nu(s.turnStartTime);f.useEffect(()=>{s.turnStartTime!==oe&&L(null)},[s.turnStartTime,oe]),f.useEffect(()=>{ne==="curling_animating"&&s.gameStatus!=="curling_animating"&&(S(null),h.current&&(cancelAnimationFrame(h.current),h.current=null))},[s.gameStatus,ne]),f.useEffect(()=>{const W=()=>U(window.innerWidth<1024);return window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]);const me=f.useCallback(()=>{y.current&&(cancelAnimationFrame(y.current),y.current=null),v.current=null},[]),ve=f.useCallback(()=>{j.current=!1,w.current=null,k.current=null,me(),_(null),T(null),R(0),L(null),q(!1),x.current=0},[me]),J=f.useCallback(()=>{me(),L(null),v.current=performance.now();const W=D=>{var pe;v.current||(v.current=D);const{session:V,currentUser:Y}=G.current,je=(((pe=V.activeCurlingItems)==null?void 0:pe[Y.id])||[]).includes("slow"),E=V.settings.curlingGaugeSpeed||700,Z=je?E*2:E,le=Z/2,de=(D-v.current)%Z/le;let te;de<=1?te=de*100:te=(2-de)*100,b.current&&(b.current.style.width=`${te}%`),x.current=te,y.current=requestAnimationFrame(W)};y.current=requestAnimationFrame(W)},[me]),fe=f.useCallback((W,D,V)=>{h.current&&cancelAnimationFrame(h.current);let Y=JSON.parse(JSON.stringify(W||[])),ie={...D,vx:V.x,vy:V.y,onBoard:!0};Y.push(ie),S(Y);const je=840,E=.98;let Z=0;const le=1e3,ae=()=>{let de=!1;for(const te of Y)te.onBoard&&(te.x+=te.vx,te.y+=te.vy,te.vx*=E,te.vy*=E,Math.abs(te.vx)<.01&&(te.vx=0),Math.abs(te.vy)<.01&&(te.vy=0),(Math.abs(te.vx)>0||Math.abs(te.vy)>0)&&(de=!0),(te.x<0||te.x>je||te.y<0||te.y>je)&&te.onBoard&&(te.onBoard=!1,te.timeOffBoard=Date.now(),Ee.stoneFallOff()));for(let te=0;te<Y.length;te++)for(let pe=te+1;pe<Y.length;pe++){const we=Y[te],ue=Y[pe];if(!we.onBoard||!ue.onBoard)continue;const Se=ue.x-we.x,qe=ue.y-we.y,Be=Math.hypot(Se,qe),He=we.radius+ue.radius;if(Be<He){Ee.stoneCollision();const se=Se/Be,Me=qe/Be,_e=ue.vx-we.vx,Ge=ue.vy-we.vy,it=_e*se+Ge*Me;if(it<0){const bt=it;we.vx+=bt*se,we.vy+=bt*Me,ue.vx-=bt*se,ue.vy-=bt*Me}const Gt=(He-Be)/2;we.x-=Gt*se,we.y-=Gt*Me,ue.x+=Gt*se,ue.y+=Gt*Me}}S([...Y]),Z++,de&&Z<le?h.current=requestAnimationFrame(ae):h.current=null};h.current=requestAnimationFrame(ae)},[]),ye=f.useCallback((W,D)=>{const{session:V,currentUser:Y}=G.current,ie=V.blackPlayerId===Y.id?$.Black:V.whitePlayerId===Y.id?$.White:$.None;if(!(V.currentPlayer===ie)||V.gameStatus!=="curling_playing")return;j.current=!0;const E=840/19*.47,Z={id:Date.now(),player:ie,x:D.x+E,y:D.y+E,vx:0,vy:0,radius:E,onBoard:!1};w.current=Z;const le="touches"in W?{x:W.touches[0].clientX,y:W.touches[0].clientY}:{x:W.clientX,y:W.clientY};k.current=le,_(le),T(le),q(!0),J()},[J]);f.useEffect(()=>{const W=Y=>{if(!j.current)return;"touches"in Y&&Y.preventDefault();const ie="touches"in Y?{x:Y.touches[0].clientX,y:Y.touches[0].clientY}:{x:Y.clientX,y:Y.clientY};T(ie)},D=()=>{if(!j.current)return;const{session:Y,onAction:ie}=G.current,je=w.current,E=k.current;me();const Z=x.current;L(Z),T(le=>{var ae,de;if(je&&E&&le){const te=(ae=m.current)==null?void 0:ae.getSvg();if(!te)return console.error("SVG element not found for coordinate conversion."),ve(),null;const pe=(de=te.getScreenCTM())==null?void 0:de.inverse();if(!pe)return console.error("Could not get CTM for coordinate conversion."),ve(),null;const we=te.createSVGPoint();we.x=E.x,we.y=E.y;const ue=we.matrixTransform(pe);we.x=le.x,we.y=le.y;const Se=we.matrixTransform(pe),qe=Se.x-ue.x,Be=Se.y-ue.y,He=-qe,se=-Be,Me=Z/100*25,_e=Math.hypot(He,se);if(_e>0){const Ge=He/_e*Me,it=se/_e*Me;ie({type:"CURLING_FLICK_STONE",payload:{gameId:Y.id,launchPosition:{x:je.x,y:je.y},velocity:{x:Ge,y:it}}})}}return j.current=!1,w.current=null,k.current=null,_(null),q(!1),null}),R(0),x.current=0,setTimeout(()=>L(null),1500)},V=Y=>{j.current&&(Y.preventDefault(),ve())};return window.addEventListener("mousemove",W),window.addEventListener("touchmove",W,{passive:!1}),window.addEventListener("mouseup",D),window.addEventListener("touchend",D),window.addEventListener("contextmenu",V),()=>{window.removeEventListener("mousemove",W),window.removeEventListener("touchmove",W),window.removeEventListener("mouseup",D),window.removeEventListener("touchend",D),window.removeEventListener("contextmenu",V),me(),h.current&&cancelAnimationFrame(h.current)}},[me,ve]),f.useEffect(()=>{const{session:W}=G.current,D=W.animation;if((D==null?void 0:D.type)==="curling_flick"&&D.startTime>g.current){g.current=D.startTime;const{stone:V,velocity:Y}=D;fe(W.curlingStones||[],V,Y)}},[s.animation,fe]);const K=A!==null?A:B;return t.jsxs("div",{className:"relative w-full h-full flex items-center justify-center px-4 sm:px-6 lg:px-0",children:[t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 w-3/4 max-w-md z-10 pointer-events-none",children:(P||A!==null)&&t.jsxs("div",{className:`bg-gray-900/50 rounded-full h-6 border-2 border-gray-500 ${A!==null?"animate-flick-power-pulse":""}`,children:[t.jsx("div",{ref:b,className:"bg-gradient-to-r from-yellow-400 to-red-500 h-full rounded-full",style:{width:`${K}%`}}),t.jsx("span",{className:"absolute inset-0 w-full h-full flex items-center justify-center text-white font-bold text-sm drop-shadow-md",children:"POWER"})]})}),t.jsx("div",{className:`w-full h-full transition-transform duration-500 ${H?"rotate-180":""}`,children:t.jsx(X0,{ref:m,stones:C??d??[],gameStatus:c,myPlayer:z,currentPlayer:u,onLaunchAreaInteractionStart:ye,isSpectator:a,dragStartPoint:P,dragEndPoint:I,selectedStone:Q?w.current:null,activeCurlingItems:s.activeCurlingItems,currentUser:r,session:s})})]})}),ey=(e,n,s,l,r)=>{const{x:a,y:i,player:o}=n,c=e.length,d=o===$.Black?$.White:$.Black;if(i<0||i>=c||a<0||a>=c||e[i][a]!==$.None)return{isValid:!1,reason:"occupied",newBoardState:e,capturedStones:[],newKoInfo:s};if(s&&s.point.x===a&&s.point.y===i&&s.turn===l)return{isValid:!1,reason:"ko",newBoardState:e,capturedStones:[],newKoInfo:s};const u=JSON.parse(JSON.stringify(e));u[i][a]=o;const p=(x,j)=>{const w=[];return x>0&&w.push({x:x-1,y:j}),x<c-1&&w.push({x:x+1,y:j}),j>0&&w.push({x,y:j-1}),j<c-1&&w.push({x,y:j+1}),w},m=(x,j,w,k)=>{var I;if(((I=k[j])==null?void 0:I[x])!==w)return null;const C=[{x,y:j}],S=new Set([`${x},${j}`]),P=new Set,_=[{x,y:j}];for(;C.length>0;){const{x:T,y:B}=C.shift();for(const R of p(T,B)){const A=`${R.x},${R.y}`,L=k[R.y][R.x];L===$.None?P.add(A):L===w&&(S.has(A)||(S.add(A),C.push(R),_.push(R)))}}return{stones:_,liberties:P.size}};let h=[],y=null;const v=new Set;for(const x of p(a,i)){const j=`${x.x},${x.y}`;if(u[x.y][x.x]===d&&!v.has(j)){const w=m(x.x,x.y,d,u);w&&w.liberties===0&&(h.push(...w.stones),w.stones.length===1&&(y=w.stones[0]),w.stones.forEach(k=>v.add(`${k.x},${k.y}`)))}}if(h.length>0)for(const x of h)u[x.y][x.x]=$.None;const b=m(a,i,o,u);if(b&&b.liberties===0)return{isValid:!1,reason:"suicide",newBoardState:e,capturedStones:[],newKoInfo:s};let g=null;return b&&h.length===1&&b.stones.length===1&&b.liberties===1&&(g={point:y,turn:l+1}),{isValid:!0,newBoardState:u,capturedStones:h,newKoInfo:g}},Sx=e=>{const{boardState:n,settings:{boardSize:s}}=e,l=(d,u)=>{const p=e.currentPlayer,m=ey(e.boardState,{x:d,y:u,player:p},e.koInfo,e.moveHistory.length);return m.isValid&&(e.boardState=m.newBoardState,e.captures[p]+=m.capturedStones.length,e.koInfo=m.newKoInfo),m},r=(d,u)=>{const p=[];return d>0&&p.push({x:d-1,y:u}),d<s-1&&p.push({x:d+1,y:u}),u>0&&p.push({x:d,y:u-1}),u<s-1&&p.push({x:d,y:u+1}),p},a=(d,u,p,m)=>{var g;if(u<0||u>=s||d<0||d>=s||((g=m[u])==null?void 0:g[d])!==p)return null;const h=[{x:d,y:u}],y=new Set([`${d},${u}`]),v=new Set,b=[{x:d,y:u}];for(;h.length>0;){const{x,y:j}=h.shift();for(const w of r(x,j)){const k=`${w.x},${w.y}`,C=m[w.y][w.x];C===$.None?v.add(k):C===p&&(y.has(k)||(y.add(k),h.push(w),b.push(w)))}}return{stones:b,liberties:v.size,libertyPoints:v,player:p}};return{getScore:()=>{const d={[$.Black]:0,[$.White]:0,[$.None]:0},u=Array(s).fill(0).map(()=>Array(s).fill(!1));for(let p=0;p<s;p++)for(let m=0;m<s;m++)if(n[p][m]!==$.None)d[n[p][m]]++;else if(!u[p][m]){const h=[{x:m,y:p}];u[p][m]=!0;const y=[{x:m,y:p}];let v=!1,b=!1;for(;h.length>0;){const g=h.shift();for(const x of r(g.x,g.y))u[x.y][x.x]||(n[x.y][x.x]===$.None?(u[x.y][x.x]=!0,h.push(x),y.push(x)):n[x.y][x.x]===$.Black?v=!0:b=!0)}v&&!b?d[$.Black]+=y.length:b&&!v&&(d[$.White]+=y.length)}return d[$.Black]+=e.captures[$.Black],d[$.White]+=e.captures[$.White],{score:{black:d[$.Black],white:d[$.White]}}},findGroup:a,getAllLibertiesOfPlayer:(d,u)=>{const p=new Set,m=new Set;for(let h=0;h<s;h++)for(let y=0;y<s;y++){const v=`${y},${h}`;if(u[h][y]===d&&!m.has(v)){const b=a(y,h,d,u);b&&(b.stones.forEach(g=>m.add(`${g.x},${g.y}`)),b.libertyPoints.forEach(g=>p.add(g)))}}return Array.from(p).map(h=>{const[y,v]=h.split(",").map(Number);return{x:y,y:v}})},getNeighbors:r,getAllGroups:(d,u)=>{const p=[],m=new Set;for(let h=0;h<s;h++)for(let y=0;y<s;y++)if(u[h][y]===d&&!m.has(`${y},${h}`)){const v=a(y,h,d,u);v&&(p.push(v),v.stones.forEach(b=>m.add(`${b.x},${b.y}`)))}return p},placeStone:l}},ty=e=>{const{session:n,onAction:s,currentUser:l,isSpectator:r,isMyTurn:a,isMobile:i,showLastMoveMarker:o}=e,{id:c,boardState:d,settings:u,lastMove:p,winningLine:m,gameStatus:h,currentPlayer:y,blackPlayerId:v,whitePlayerId:b,player1:g,player2:x,animation:j,lastTurnStones:w}=n,k=v===l.id?$.Black:$.White,C=[g,x],S=C.find(T=>T.id===v)||null,P=C.find(T=>T.id===b)||null,_=f.useMemo(()=>{if(h!=="dice_placing"||!a)return[];if(!d.flat().some(B=>B===$.White)){const B=[];for(let R=0;R<u.boardSize;R++)for(let A=0;A<u.boardSize;A++)d[R][A]===$.None&&B.push({x:A,y:R});return B}return Sx(n).getAllLibertiesOfPlayer($.White,d)},[n,h,a,d,u.boardSize]),I=(T,B)=>{!a||h!=="dice_placing"||!_.some(A=>A.x===T&&A.y===B)||s({type:"DICE_PLACE_STONE",payload:{gameId:c,x:T,y:B}})};return t.jsx("div",{className:"relative w-full h-full flex flex-col items-center justify-center",children:t.jsx(qa,{boardState:d,boardSize:u.boardSize,onBoardClick:I,lastMove:p,lastTurnStones:w,isBoardDisabled:!a||h!=="dice_placing",stoneColor:$.Black,winningLine:m,mode:n.mode,mixedModes:n.settings.mixedModes,myPlayerEnum:k,gameStatus:h,currentPlayer:y,highlightedPoints:_,highlightStyle:"ring",isSpectator:r,currentUser:l,blackPlayerNickname:(S==null?void 0:S.nickname)||"",whitePlayerNickname:(P==null?void 0:P.nickname)||"",isItemModeActive:!1,animation:j,isMobile:i,showLastMoveMarker:o})})},ny=e=>{const{session:n,onAction:s,currentUser:l,isMyTurn:r,isSpectator:a,isMobile:i,showLastMoveMarker:o}=e,{id:c,boardState:d,settings:u,lastMove:p,winningLine:m,gameStatus:h,currentPlayer:y,blackPlayerId:v,whitePlayerId:b,thiefPlayerId:g,player1:x,player2:j,lastTurnStones:w}=n,k=v===l.id?$.Black:b===l.id?$.White:$.None,C=l.id===g?"":"",S=[x,j],P=S.find(B=>B.id===v)||null,_=S.find(B=>B.id===b)||null,I=(B,R)=>{!r||h!=="thief_placing"||s({type:"THIEF_PLACE_STONE",payload:{gameId:c,x:B,y:R}})},T=f.useMemo(()=>{if(h!=="thief_placing"||!r)return[];const B=Sx(n),R=()=>{const A=[];for(let L=0;L<u.boardSize;L++)for(let Q=0;Q<u.boardSize;Q++)d[L][Q]===$.None&&A.push({x:Q,y:L});return A};if(C===""){const A=!d.flat().includes($.Black);if(n.turnInRound===1||A)return R();if(d.flat().includes($.Black)){const q=B.getAllLibertiesOfPlayer($.Black,d);return q.length>0?q:R()}else return R()}else if(d.flat().includes($.Black)){const L=B.getAllLibertiesOfPlayer($.Black,d);return L.length>0?L:R()}else return R()},[h,r,n,d,C,u.boardSize]);return t.jsx("div",{className:"relative w-full h-full",children:t.jsx(qa,{boardState:d,boardSize:u.boardSize,onBoardClick:I,lastMove:p,lastTurnStones:w,isBoardDisabled:!r||h!=="thief_placing",stoneColor:k,winningLine:m,mode:n.mode,mixedModes:n.settings.mixedModes,myPlayerEnum:k,gameStatus:h,currentPlayer:y,highlightedPoints:T,isSpectator:a,currentUser:l,blackPlayerNickname:(P==null?void 0:P.nickname)||"",whitePlayerNickname:(_==null?void 0:_.nickname)||"",isItemModeActive:!1,isMobile:i,showLastMoveMarker:o})})},sy=e=>{const{session:n,currentUser:s,isSpectator:l,isMyTurn:r,myPlayerEnum:a,handleBoardClick:i,isMobile:o,showLastMoveMarker:c}=e,{boardState:d,settings:u,lastMove:p,winningLine:m,gameStatus:h,currentPlayer:y,blackPlayerId:v,whitePlayerId:b,player1:g,player2:x,animation:j,blackPatternStones:w,whitePatternStones:k,lastTurnStones:C}=n,S=g.id===v?g:x,P=g.id===b?x:g;return t.jsx("div",{className:"relative w-full h-full flex flex-col items-center justify-center",children:t.jsx(qa,{boardState:d,boardSize:u.boardSize,onBoardClick:i,lastMove:p,lastTurnStones:C,isBoardDisabled:!r||l,stoneColor:a,winningLine:m,mode:n.mode,myPlayerEnum:a,gameStatus:h,currentPlayer:y,isSpectator:l,currentUser:s,blackPlayerNickname:S.nickname,whitePlayerNickname:P.nickname,animation:j,isMobile:o,showLastMoveMarker:c,blackPatternStones:w,whitePatternStones:k,isItemModeActive:!1})})},ku=e=>{const{session:n}=e,{mode:s,isSinglePlayer:l}=n;if(l)return t.jsx(sy,{...e});switch(s){case M.Alkkagi:return t.jsx(Y0,{...e});case M.Curling:return t.jsx(Z0,{...e});case M.Dice:return t.jsx(ty,{...e});case M.Thief:return t.jsx(ny,{...e});case M.Standard:case M.Capture:case M.Speed:case M.Base:case M.Hidden:case M.Missile:case M.Mix:case M.Omok:case M.Ttamok:default:return t.jsx(Q0,{...e})}},ly=({session:e,onClose:n})=>{const{mode:s,settings:l,effectiveCaptureTargets:r}=e,a=(o,c)=>c!=null&&c!==""&&t.jsxs(Pn.Fragment,{children:[t.jsxs("div",{className:"font-semibold text-gray-400",children:[o,":"]}),t.jsx("div",{className:"whitespace-nowrap",children:c})]},o),i=f.useMemo(()=>{var u,p,m,h,y,v,b,g;const o=[],c=[M.Standard,M.Speed,M.Base,M.Hidden,M.Missile,M.Mix],d=[M.Alkkagi,M.Curling,M.Dice,M.Thief];if(o.push(a(" ",s)),[M.Alkkagi,M.Curling,M.Dice].includes(s)||o.push(a(" ",`${l.boardSize}x${l.boardSize}`)),c.includes(s)&&!((u=l.mixedModes)!=null&&u.includes(M.Base))&&o.push(a("",`${e.finalKomi??e.settings.komi??ax}`)),d.includes(s)||(l.timeLimit>0?(o.push(a("",`${l.timeLimit}`)),o.push(a("",s===M.Speed?`${l.timeIncrement} `:`${l.byoyomiTime} ${l.byoyomiCount}`))):o.push(a("",""))),s===M.Mix&&o.push(a(" ",(p=l.mixedModes)==null?void 0:p.join(", "))),(s===M.Omok||s===M.Ttamok)&&(o.push(a(" ",l.has33Forbidden?"":"")),o.push(a(" ",l.hasOverlineForbidden?"":""))),s===M.Ttamok&&o.push(a(" ",`${l.captureTarget}`)),s===M.Capture||s===M.Mix&&((m=l.mixedModes)!=null&&m.includes(M.Capture))){const x=r?`: ${r[$.Black]} / : ${r[$.White]}`:`${l.captureTarget} (/  )`;o.push(a(" ",x))}if((s===M.Base||s===M.Mix&&((h=l.mixedModes)!=null&&h.includes(M.Base)))&&o.push(a("",`${l.baseStones}`)),(s===M.Hidden||s===M.Mix&&((y=l.mixedModes)!=null&&y.includes(M.Hidden)))&&(o.push(a("",`${l.hiddenStoneCount}`)),o.push(a("",`${l.scanCount}`))),(s===M.Missile||s===M.Mix&&((v=l.mixedModes)!=null&&v.includes(M.Missile)))&&o.push(a("",`${l.missileCount}`)),s===M.Dice&&(o.push(a("",`${l.diceGoRounds}R`)),o.push(a(" ",`${l.oddDiceCount}`)),o.push(a(" ",`${l.evenDiceCount}`))),s===M.Alkkagi){const x=((b=No.find(j=>j.value===l.alkkagiGaugeSpeed))==null?void 0:b.label)||"";o.push(a("",`${l.alkkagiRounds}R`)),o.push(a(" ",`${l.alkkagiStoneCount}`)),o.push(a(" ",l.alkkagiPlacementType)),o.push(a(" ",l.alkkagiLayout)),o.push(a(" ",x)),o.push(a(" ",`${l.alkkagiSlowItemCount}`)),o.push(a(" ",`${l.alkkagiAimingLineItemCount}`))}if(s===M.Curling){const x=((g=ko.find(j=>j.value===l.curlingGaugeSpeed))==null?void 0:g.label)||"";o.push(a(" ",`${l.curlingStoneCount}`)),o.push(a(" ",x)),o.push(a(" ",`${l.curlingSlowItemCount}`)),o.push(a(" ",`${l.curlingAimingLineItemCount}`))}return o.filter(Boolean)},[e]);return t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md flex-shrink-0 border border-color",children:[t.jsxs("h3",{className:"text-base font-bold border-b border-gray-700 pb-1 mb-2 text-yellow-300 flex justify-between items-center",children:[" ",n&&t.jsx("button",{onClick:n,className:"text-xl font-bold text-gray-400 hover:text-white",children:""})]}),t.jsx("div",{className:"grid grid-cols-2 gap-x-3 gap-y-0.5 text-xs",children:i})]})},ry=({session:e,onlineUsers:n,currentUser:s,onClose:l,onAction:r,onViewUser:a})=>{const{player1:i,player2:o,blackPlayerId:c,whitePlayerId:d,gameStatus:u,isAiGame:p}=e,m=f.useMemo(()=>n.filter(x=>x.status==="in-game"&&x.gameId===e.id).sort((x,j)=>x.id===c?-1:j.id===c?1:0),[n,e.id,c]),h=f.useMemo(()=>n.filter(x=>x.status==="spectating"&&x.spectatingGameId===e.id),[n,e.id]),y=["ended","no_contest","rematch_pending"].includes(u),v=u==="rematch_pending",b=x=>{r({type:"REQUEST_REMATCH",payload:{opponentId:x,originalGameId:e.id}})},g=(x,j)=>{var P,_;const w=x.id===s.id,k=!w&&(x.id===i.id||x.id===o.id),C=(P=Te.find(I=>I.id===x.avatarId))==null?void 0:P.url,S=(_=Re.find(I=>I.id===x.borderId))==null?void 0:_.url;return t.jsxs("div",{className:`flex items-center gap-2 p-1 rounded ${w?"bg-blue-900/50":""}`,children:[t.jsx(Ce,{userId:x.id,userName:x.nickname,size:28,avatarUrl:C,borderUrl:S}),t.jsxs("div",{className:`flex items-center gap-2 flex-grow overflow-hidden ${w?"":"cursor-pointer"}`,onClick:()=>!w&&a(x.id),title:w?"":`${x.nickname}  `,children:[t.jsx("span",{className:"font-semibold truncate text-sm",children:x.nickname}),y&&k&&!p&&t.jsx(F,{onClick:I=>{I==null||I.stopPropagation(),b(x.id)},disabled:v,colorScheme:"yellow",className:"!text-xs !py-0.5 !px-2 flex-shrink-0",children:v?"":""})]}),t.jsx("span",{className:"ml-auto text-xs text-gray-400 flex-shrink-0",children:j})]},x.id)};return t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md flex flex-col border border-color",children:[t.jsxs("h3",{className:"text-base font-bold border-b border-gray-700 pb-1 mb-2 text-yellow-300 flex-shrink-0 flex justify-between items-center",children:[" ",l&&t.jsx("button",{onClick:l,className:"text-xl font-bold text-gray-400 hover:text-white",children:""})]}),t.jsxs("div",{className:"space-y-0.5 overflow-y-auto pr-1 flex-grow",children:[m.map(x=>g(x,x.id===c?"":"")),h.map(x=>g(x,""))]})]})},ay=e=>{const{session:n,isSpectator:s,onAction:l,waitingRoomChat:r,gameChat:a,onClose:i,onViewUser:o}=e,{mode:c}=n,{currentUserWithStatus:d,handlers:u}=De(),p=n.isAiGame,[m,h]=f.useState(p?"global":"game"),[y,v]=f.useState(""),[b,g]=f.useState(!1),[x,j]=f.useState(0),w=f.useRef(null),k=f.useRef(null),C=m==="game"?a:r;f.useEffect(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},[C]),f.useEffect(()=>{if(x>0){const q=setTimeout(()=>{j(O=>Math.max(0,O-1))},1e3);return()=>clearTimeout(q)}},[x]),f.useEffect(()=>{const q=O=>{w.current&&!w.current.contains(O.target)&&g(!1)};return document.addEventListener("mousedown",q),()=>document.removeEventListener("mousedown",q)},[]);const _=`[${at.some(q=>q.mode===c)?"":""}:${c}]`,I=q=>{if(s||x>0)return;const O=m==="game"?n.id:"global",U={channel:O,...q};O==="global"&&(U.location=_),l({type:"SEND_CHAT_MESSAGE",payload:U}),g(!1),v(""),j(5)},T=q=>{if(q.preventDefault(),y.trim()){if(Yl(y)){alert("       ."),v("");return}I({text:y})}};if(!d)return null;const B=q=>{d.isAdmin&&q!==d.id?u.openModerationModal(q):q!==d.id&&o(q)},R=(d.chatBanUntil??0)>Date.now(),A=R?Math.ceil((d.chatBanUntil-Date.now())/1e3/60):0,L=R||x>0,Q=R?`   (${A} )`:L?`(${x})`:"[ ]";return t.jsxs("div",{className:"flex flex-col h-full bg-gray-800 p-2 rounded-md border border-color",children:[p?t.jsx("h3",{className:"text-base font-bold border-b border-gray-700 pb-1 mb-2 text-yellow-300 flex-shrink-0",children:""}):t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-2 flex-shrink-0",children:[t.jsx("button",{onClick:()=>h("game"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md ${m==="game"?"bg-blue-600":"text-gray-400"}`,children:""}),t.jsx("button",{onClick:()=>h("global"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md ${m==="global"?"bg-blue-600":"text-gray-400"}`,children:""})]}),t.jsxs("div",{ref:k,className:"flex-grow space-y-1 overflow-y-auto pr-2 mb-2 bg-gray-900/40 p-1.5 rounded-md min-h-0",children:[C.map(q=>{const O=q.system&&!q.actionInfo&&q.user.nickname==="AI ";return t.jsx("div",{className:"text-sm",children:q.actionInfo?t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"font-semibold text-gray-400 pr-2",children:[q.user.nickname,":"]}),t.jsx("span",{className:"text-yellow-400",children:q.actionInfo.message}),t.jsx("span",{className:"text-gray-400",children:" ( "}),t.jsx("span",{className:q.actionInfo.scoreChange>0?"text-blue-400 font-bold":"text-red-400 font-bold",children:q.actionInfo.scoreChange>0?`+${q.actionInfo.scoreChange}`:q.actionInfo.scoreChange}),t.jsx("span",{className:"text-gray-400",children:")"})]}):t.jsxs(t.Fragment,{children:[q.location&&t.jsx("span",{className:"font-semibold text-gray-500 pr-1",children:q.location}),t.jsxs("span",{className:`font-semibold pr-2 ${q.system?"text-yellow-400":"text-gray-400 cursor-pointer hover:underline"}`,onClick:()=>!q.system&&B(q.user.id),title:q.system?"":`${q.user.nickname}   / `,children:[q.system?O?"AI ":"":q.user.nickname,":"]}),q.text&&t.jsxs("span",{className:O?"text-yellow-400":"",children:[q.text,O&&" "]}),q.emoji&&t.jsx("span",{className:"text-xl",children:q.emoji})]})},q.id)}),C.length===0&&t.jsx("div",{className:"h-full flex items-center justify-center text-gray-500 text-sm",children:"  ."})]}),!s&&t.jsxs("div",{className:"relative flex-shrink-0",children:[b&&t.jsxs("div",{ref:w,className:"absolute bottom-full mb-2 w-full bg-gray-600 rounded-lg shadow-xl p-2 z-10 max-h-64 overflow-y-auto",children:[t.jsx("div",{className:"grid grid-cols-5 gap-2 text-2xl mb-2 border-b border-gray-500 pb-2",children:xx.map(q=>t.jsxs("button",{onClick:()=>I({emoji:q}),className:"w-full p-2 rounded-md hover:bg-blue-600 transition-colors text-center",children:[" ",q," "]},q))}),t.jsx("ul",{className:"space-y-1",children:fx.map(q=>t.jsxs("li",{children:[" ",t.jsxs("button",{onClick:()=>I({text:q}),className:"w-full text-left text-sm p-2 rounded-md hover:bg-blue-600 transition-colors",children:[" ",q," "]})," "]},q))})]}),t.jsxs("form",{onSubmit:T,className:"flex gap-2",children:[t.jsx("button",{type:"button",onClick:()=>g(q=>!q),className:"bg-gray-700 hover:bg-gray-600 text-white font-bold px-2.5 rounded-md transition-colors text-lg flex items-center justify-center",title:" ",disabled:L,children:t.jsx("span",{children:""})}),t.jsx("input",{type:"text",value:y,onChange:q=>v(q.target.value),placeholder:Q,className:"flex-grow bg-gray-900 border border-gray-600 rounded-md p-1.5 focus:ring-blue-500 focus:border-blue-500 text-sm disabled:bg-gray-800 disabled:text-gray-500",maxLength:30,disabled:L}),t.jsx(F,{type:"submit",disabled:!y.trim()||L,className:"!px-2.5 !py-1.5",title:"",children:""})]})]})]})},Su=e=>{const{session:n,onLeaveOrResign:s,isNoContestLeaveAvailable:l,isSpectator:r}=e,{gameStatus:a}=n,i=["ended","no_contest","rematch_pending"].includes(a),o=l?"":i?"":r?"":"",c=l?"yellow":"red";return t.jsxs("div",{className:"flex flex-col h-full gap-1.5 bg-gray-900/80 rounded-lg p-2 border border-color",children:[t.jsxs("div",{className:"flex-shrink-0 space-y-2",children:[t.jsx(ly,{session:n,onClose:e.onClose}),t.jsx(ry,{...e})]}),t.jsx("div",{className:"flex-1 mt-2 min-h-0",children:t.jsx(ay,{...e})}),t.jsx("div",{className:"flex-shrink-0 pt-2",children:t.jsx(F,{onClick:s,colorScheme:c,className:"w-full",children:o})})]})},iy=e=>{e<0&&(e=0);const n=Math.floor(e/60),s=Math.floor(e%60);return`${String(n).padStart(2,"0")}:${String(s).padStart(2,"0")}`},oy=({count:e,target:n,panelType:s,mode:l})=>{const r=typeof n=="number"&&n>0?`${e}/${n}`:`${e}`,a=l===M.Dice;let i=" ";a?i=" ":[M.Thief,M.Curling].includes(l)&&(i="");const o="flex flex-col items-center justify-center w-[clamp(4.5rem,16vmin,6rem)] rounded-lg shadow-lg border-2 p-1 text-center h-full";let c="",d="text-gray-300",u="text-white";return s==="white"?(c="bg-gradient-to-br from-gray-50 to-gray-200 border-gray-400",d="text-gray-700",u="text-black"):c="bg-gradient-to-br from-gray-800 to-black border-gray-600",t.jsxs("div",{className:`${o} ${c}`,children:[t.jsx("span",{className:`${d} text-[clamp(0.6rem,2vmin,0.75rem)] font-semibold whitespace-nowrap`,children:i}),a?t.jsxs("div",{className:`font-mono font-bold text-[clamp(1rem,5vmin,2rem)] tracking-tighter my-1 ${u} flex items-center justify-center gap-1`,children:[t.jsx("div",{className:"w-[clamp(0.8rem,3vmin,1rem)] h-[clamp(0.8rem,3vmin,1rem)] rounded-full bg-white border border-black inline-block flex-shrink-0"}),t.jsx("span",{children:r})]}):t.jsx("span",{className:`font-mono font-bold text-[clamp(1rem,5vmin,2rem)] tracking-tighter my-1 ${u}`,children:r})]})},cy=({timeLeft:e,totalTime:n,byoyomiTime:s,byoyomiPeriods:l,totalByoyomi:r,isActive:a,isInByoyomi:i,isFoulMode:o=!1,isLeft:c})=>{const d=f.useMemo(()=>{if(o){const m=n>0?n:s;return m>0?e/m*100:0}return i?s>0?e/s*100:0:n>0?e/n*100:0},[e,n,s,i,o]),u=c?"right-1":"left-1",p=c?"justify-end":"justify-start";return t.jsxs("div",{className:"w-full relative",children:[t.jsx("div",{className:`w-full h-1.5 rounded-full transition-colors ${i||o?"bg-red-900/70":"bg-gray-700"}`,children:t.jsx("div",{className:`h-1.5 rounded-full ${i||o?"bg-red-500":"bg-blue-500"} ${a&&e<5?"animate-pulse":""}`,style:{width:`${Math.min(100,d)}%`,transition:"width 0.2s linear"}})}),(r>0||o)&&t.jsx("div",{className:`absolute ${u} top-1/2 -translate-y-1/2 flex items-center ${p} gap-1 sm:gap-1.5`,children:o?t.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:l}).map((m,h)=>t.jsx("span",{className:"text-base leading-none",title:`${l} fouls remaining`,children:""},h))}):t.jsxs("div",{className:"flex items-center gap-1 text-yellow-300",children:[t.jsx("span",{className:"text-base",children:""}),t.jsx("span",{className:"text-sm font-bold",children:l})]})})]})},Cu=e=>{var le,ae;const{user:n,playerEnum:s,score:l,isActive:r,timeLeft:a,totalTime:i,mainTimeLeft:o,byoyomiPeriodsLeft:c,totalByoyomi:d,byoyomiTime:u,isLeft:p,session:m,captureTarget:h,role:y,isAiPlayer:v,mode:b,isSinglePlayer:g}=e,{gameStatus:x,winner:j,blackPlayerId:w,whitePlayerId:k}=m,C=f.useMemo(()=>{var de;return(de=Te.find(te=>te.id===n.avatarId))==null?void 0:de.url},[n.avatarId]),S=f.useMemo(()=>{var de;return(de=Re.find(te=>te.id===n.borderId))==null?void 0:de.url},[n.borderId]),P=at.some(de=>de.mode===b),_=St.some(de=>de.mode===b)&&![M.Omok,M.Ttamok].includes(b),I=b===M.Curling,T=_?i:u,B=P?n.strategyLevel:n.playfulLevel,A=`${P?"":""} Lv.${B}`,L=p?"flex-row":"flex-row-reverse",Q=p?"text-left":"text-right",q=p?"justify-start":"justify-end",O=["ended","no_contest","rematch_pending"].includes(x),U=j===$.Black&&w===n.id||j===$.White&&k===n.id,G=(j===$.Black||j===$.White)&&!U,z=!_&&o<=0&&d>0,H=Jh,ne=_?H:d,oe=_?H-(((le=m.timeoutFouls)==null?void 0:le[n.id])||0):c,me=b===M.Dice,ve=me||s===$.Black,J=!me&&s===$.White,fe=ve?"black":J?"white":"neutral";let ye="",K="",W="",D="";g?(ye=r&&!O?"bg-stone-800 ring-2 ring-amber-400 border-stone-600":"bg-stone-900/50 border-stone-700",K="text-stone-100",W="text-stone-400",D="text-stone-200"):fe==="black"?(ye=r&&!O?"bg-gray-800 ring-2 ring-blue-400 border-gray-600":"bg-black/50 border-gray-700",K="text-white",W="text-gray-400",D="text-gray-200"):fe==="white"?(ye=r&&!O?"bg-gray-300 ring-2 ring-blue-500 border-blue-500":"bg-gray-200 border-gray-400",K="text-black",W="text-gray-600",D="text-gray-800"):(ye=r&&!O?"bg-blue-900/50 ring-2 ring-blue-400":"bg-gray-800/30",K="text-white",W="text-gray-400",D="text-gray-200");const ie=U?g?"text-amber-300":ve?"text-yellow-300":"text-yellow-600":G?g?"text-stone-500":"text-gray-500":K,je=m.settings.curlingStoneCount||5,E=((ae=m.stonesThrownThisRound)==null?void 0:ae[n.id])||0,Z=je-E;return t.jsxs("div",{className:`flex items-stretch gap-2 flex-1 ${L} p-1 rounded-lg transition-all duration-300 border ${ye}`,children:[t.jsxs("div",{className:`flex flex-col ${Q} flex-grow justify-between min-w-0`,children:[t.jsxs("div",{className:`flex items-center gap-2 ${p?"":"flex-row-reverse"}`,children:[t.jsx(Ce,{userId:n.id,userName:n.nickname,size:48,avatarUrl:C,borderUrl:S}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs("div",{className:`flex items-baseline gap-2 ${q}`,children:[!p&&O&&U&&t.jsx("span",{className:"text-2xl font-black text-blue-400",children:""}),!p&&O&&G&&t.jsx("span",{className:"text-2xl font-black text-red-400",children:""}),t.jsxs("h2",{className:`font-bold text-[clamp(0.8rem,3vmin,1.125rem)] leading-tight whitespace-nowrap ${ie}`,children:[n.nickname," ",v&&""," ",y&&`(${y})`]}),p&&O&&U&&t.jsx("span",{className:"text-2xl font-black text-blue-400",children:""}),p&&O&&G&&t.jsx("span",{className:"text-2xl font-black text-red-400",children:""})]}),t.jsx("p",{className:`text-[clamp(0.6rem,2vmin,0.75rem)] ${W}`,children:A}),I&&t.jsxs("div",{className:`flex items-center gap-3 text-xs mt-1 ${q} ${W}`,children:[t.jsxs("span",{children:[m.curlingRound||1,"/",m.settings.curlingRounds||3,"R"]}),t.jsxs("span",{className:"font-semibold",children:[" : ",Z]})]})]})]}),t.jsxs("div",{className:"mt-1",children:[t.jsx(cy,{timeLeft:a,totalTime:i,byoyomiTime:T,byoyomiPeriods:oe,totalByoyomi:ne,isActive:r&&!O,isInByoyomi:z,isFoulMode:_,isLeft:p}),t.jsx("div",{className:`flex items-center mt-0.5 ${q}`,children:t.jsx("span",{className:`font-mono font-bold ${z||_&&a<10?"text-red-400":D} text-[clamp(1rem,3.5vmin,1.25rem)]`,children:iy(a)})})]})]}),t.jsx(oy,{count:l,target:h,panelType:fe,mode:b})]})},dy=(e,n,s)=>{if(!(St.some(r=>r.mode===e)&&![M.Omok,M.Ttamok].includes(e)))return s.timeLimit*60;switch(e){case M.Alkkagi:return n==="alkkagi_placement"?Kh:n==="alkkagi_simultaneous_placement"?Qh:Vh;case M.Curling:return Yh;case M.Dice:return n==="dice_rolling"?kr:n==="dice_placing"?Yd:kr;case M.Thief:return n==="thief_rolling"?kr:n==="thief_placing"?Yd:kr;default:return s.timeLimit*60}},Iu=e=>{var U,G;const{session:n,clientTimes:s,isSinglePlayer:l}=e,{player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,captures:c,mode:d,settings:u,effectiveCaptureTargets:p,scores:m,currentPlayer:h}=n,y=[M.Dice,M.Thief,M.Curling].includes(d),v=r,b=a,g=v.id===i?$.Black:v.id===o?$.White:$.None,x=b.id===i?$.Black:b.id===o?$.White:$.None,j=h===g&&g!==$.None,w=h===x&&x!==$.None,k=d===M.Curling?((U=n.curlingScores)==null?void 0:U[g])??0:y?(m==null?void 0:m[v.id])??0:c[g],C=d===M.Curling?((G=n.curlingScores)==null?void 0:G[x])??0:y?(m==null?void 0:m[b.id])??0:c[x],S=g===$.Black?s.black:g===$.White?s.white:u.timeLimit*60,P=x===$.Black?s.black:x===$.White?s.white:u.timeLimit*60,_=g===$.Black?n.blackTimeLeft:g===$.White?n.whiteTimeLeft:u.timeLimit*60,I=x===$.Black?n.blackTimeLeft:x===$.White?n.whiteTimeLeft:u.timeLimit*60,T=g===$.Black?n.blackByoyomiPeriodsLeft:g===$.White?n.whiteByoyomiPeriodsLeft:u.byoyomiCount,B=x===$.Black?n.blackByoyomiPeriodsLeft:x===$.White?n.whiteByoyomiPeriodsLeft:u.byoyomiCount,R=d===M.Thief?v.id===n.thiefPlayerId?"":"":void 0,A=d===M.Thief?b.id===n.thiefPlayerId?"":"":void 0,L=z=>{if(n.isSinglePlayer||d===M.Capture)return p==null?void 0:p[z];if(d===M.Ttamok)return u.captureTarget},Q=n.isAiGame&&v.id===tl,q=n.isAiGame&&b.id===tl,O=dy(d,n.gameStatus,u);return t.jsxs("div",{className:"flex justify-between items-start gap-2 flex-shrink-0 h-full",children:[t.jsx(Cu,{user:v,playerEnum:g,score:k,isActive:j,timeLeft:S,totalTime:O,mainTimeLeft:_,byoyomiPeriodsLeft:T,totalByoyomi:u.byoyomiCount,byoyomiTime:u.byoyomiTime,isLeft:!0,session:n,captureTarget:L(g),role:R,isAiPlayer:Q,mode:d,isSinglePlayer:l}),t.jsx(Cu,{user:b,playerEnum:x,score:C,isActive:w,timeLeft:P,totalTime:O,mainTimeLeft:I,byoyomiPeriodsLeft:B,totalByoyomi:u.byoyomiCount,byoyomiTime:u.byoyomiTime,isLeft:!1,session:n,captureTarget:L(x),role:A,isAiPlayer:q,mode:d,isSinglePlayer:l})]})},uy=(e,n)=>{const{winner:s,blackPlayerId:l,whitePlayerId:r,player1:a,player2:i}=e;return s===null||s===$.None||!(n.id===a.id||n.id===i.id)?null:s===$.Black&&n.id===l||s===$.White&&n.id===r},Cr=e=>kc(e).rank,my=({initial:e,final:n,max:s,levelUp:l,xpGain:r,finalLevel:a})=>{const[i,o]=f.useState(0),[c,d]=f.useState(0),[u,p]=f.useState(!1),m=s>0?e/s*100:0,h=s>0?l?100:n/s*100:0,y=h-m;f.useEffect(()=>{o(m),d(0),p(!1);const b=setTimeout(()=>{p(!0),d(1),o(h);const g=setTimeout(()=>{d(0)},500);return()=>clearTimeout(g)},500);return()=>clearTimeout(b)},[e,n,s,l,m,h]);const v=`${r}-${e}`;return t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-sm font-bold w-16 text-right",children:["Lv.",a]}),t.jsxs("div",{className:"w-full bg-gray-700/50 rounded-full h-4 relative border border-gray-900/50 overflow-hidden",children:[t.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-full transition-all duration-1000 ease-out",style:{width:`${i}%`}}),t.jsx("div",{className:"absolute top-0 h-full bg-gradient-to-r from-green-400 to-green-500 rounded-r-full transition-opacity duration-500 ease-out pointer-events-none",style:{left:`${m}%`,width:`${y}%`,opacity:c}}),t.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-black/80 drop-shadow-sm",children:[n," / ",s]}),l&&t.jsx("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-white animate-pulse",style:{textShadow:"0 0 5px black"},children:"LEVEL UP!"})]}),u&&r>0&&t.jsxs("span",{className:"text-sm font-bold text-green-400 whitespace-nowrap animate-fade-in-xp w-20",children:["+",r," XP"]},v),t.jsx("style",{children:`
                @keyframes fadeInXp {
                    from { opacity: 0; transform: scale(0.8); }
                    to { opacity: 1; transform: scale(1); }
                }
                .animate-fade-in-xp {
                    animation: fadeInXp 0.5s ease-out forwards;
                }
            `})]})},fy=({analysis:e,session:n})=>{var c,d,u;const{scoreDetails:s}=e,{mode:l,settings:r}=n;if(!s)return t.jsx("p",{className:"text-center text-gray-400",children:"  ."});const a=l===M.Speed||l===M.Mix&&((c=r.mixedModes)==null?void 0:c.includes(M.Speed)),i=l===M.Base||l===M.Mix&&((d=r.mixedModes)==null?void 0:d.includes(M.Base)),o=l===M.Hidden||l===M.Mix&&((u=r.mixedModes)==null?void 0:u.includes(M.Hidden));return t.jsx("div",{className:"space-y-3 text-xs md:text-sm",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.black.territory.toFixed(0)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.black.deadStones??0})]}),i&&t.jsxs("div",{className:"flex justify-between text-blue-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.baseStoneBonus})]}),o&&t.jsxs("div",{className:"flex justify-between text-purple-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.hiddenStoneBonus})]}),a&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.black.timeBonus.toFixed(1)})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:s.black.total.toFixed(1)})]})]}),t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.white.territory.toFixed(0)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.white.deadStones??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{children:s.white.komi})]}),i&&t.jsxs("div",{className:"flex justify-between text-blue-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.baseStoneBonus})]}),o&&t.jsxs("div",{className:"flex justify-between text-purple-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.hiddenStoneBonus})]}),a&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:s.white.timeBonus.toFixed(1)})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:s.white.total.toFixed(1)})]})]})]})})},xy=({gameSession:e})=>{const{scores:n,player1:s,player2:l,diceGoBonuses:r}=e,a=s.id,i=l.id,o=n[a]||0,c=n[i]||0,d=(r==null?void 0:r[a])||0,u=(r==null?void 0:r[i])||0,p=o-d,m=c-u;return d>0||u>0?t.jsx("div",{className:"space-y-3 text-xs md:text-sm",children:t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:s.nickname}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:p})]}),d>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  :"})," ",t.jsxs("span",{className:"text-green-400",children:["+",d]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:o})]})]}),t.jsxs("div",{className:"space-y-1 bg-gray-800/50 p-2 rounded-md",children:[t.jsx("h3",{className:"font-bold text-center mb-1",children:l.nickname}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{children:m})]}),u>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  :"})," ",t.jsxs("span",{className:"text-green-400",children:["+",u]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold text-base",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"text-yellow-300",children:c})]})]})]})}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300",children:" "}),t.jsxs("p",{className:"text-5xl font-mono my-2",children:[o," : ",c]})]})},py=({gameSession:e})=>{var y,v,b,g;const{curlingScores:n,player1:s,player2:l,blackPlayerId:r,whitePlayerId:a}=e;if(!n)return t.jsx("p",{className:"text-center text-gray-400",children:"  ."});const i=r===s.id?s:l,o=a===s.id?s:l,c=n[$.Black]||0,d=n[$.White]||0,u=(y=Te.find(x=>x.id===i.avatarId))==null?void 0:y.url,p=(v=Re.find(x=>x.id===i.borderId))==null?void 0:v.url,m=(b=Te.find(x=>x.id===o.avatarId))==null?void 0:b.url,h=(g=Re.find(x=>x.id===o.borderId))==null?void 0:g.url;return t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-4",children:" "}),t.jsxs("div",{className:"flex items-center justify-center my-2",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2 w-32 flex-shrink-0",children:[t.jsx(Ce,{userId:i.id,userName:i.nickname,size:64,avatarUrl:u,borderUrl:p}),t.jsxs("span",{className:"font-bold mt-1 w-full truncate",children:[i.nickname," ()"]})]}),t.jsxs("p",{className:"text-5xl font-mono text-center flex-grow px-2",children:[c," : ",d]}),t.jsxs("div",{className:"flex flex-col items-center gap-2 w-32 flex-shrink-0",children:[t.jsx(Ce,{userId:o.id,userName:o.nickname,size:64,avatarUrl:m,borderUrl:h}),t.jsxs("span",{className:"font-bold mt-1 w-full truncate",children:[o.nickname," ()"]})]})]})]})},gy=({session:e,currentUser:n,onConfirm:s})=>{var _,I,T,B,R;const{winner:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,winReason:c}=e,d=f.useRef(!1),u=uy(e,n),p=(_=e.summary)==null?void 0:_[n.id],m=St.some(A=>A.mode===e.mode),h=f.useMemo(()=>{var A;return(A=Te.find(L=>L.id===n.avatarId))==null?void 0:A.url},[n.avatarId]),y=f.useMemo(()=>{var A;return(A=Re.find(L=>L.id===n.borderId))==null?void 0:A.url},[n.borderId]),v=(I=p==null?void 0:p.items)==null?void 0:I[0],b=v?vs.find(A=>A.name===v.name):null;f.useEffect(()=>{d.current||(u===!0?Ee.gameWin():u===!1&&Ee.gameLose(),p&&(p.level&&p.level.initial<p.level.final&&setTimeout(()=>Ee.levelUp(),800),p.manner&&Cr(p.manner.initial)!==Cr(p.manner.final)&&setTimeout(()=>Ee.levelUp(),900)),d.current=!0)},[u,p]);const g=l===$.None,x=l===$.Black?r.id===i?r:a:l===$.White?r.id===o?r:a:null,{title:j,color:w}=f.useMemo(()=>{if(g)return{title:"",color:"text-yellow-400"};if(u===null)return x?{title:`${x.nickname} `,color:"text-gray-300"}:{title:" ",color:"text-gray-300"};if(u){let A="";return c==="resign"&&(A=""),c==="timeout"&&(A=""),{title:A,color:"text-green-400"}}else{let A="";return c==="resign"&&(A=""),c==="timeout"&&(A=""),{title:A,color:"text-red-400"}}},[u,g,c,x]),k=(T=e.analysisResult)==null?void 0:T.system,C=()=>{if(m&&c==="resign"){const A=u?"  .":" .";return t.jsx("p",{className:"text-center text-lg",children:A})}if(c==="score")return k?t.jsx("div",{className:"w-full",children:t.jsx(fy,{analysis:k,session:e})}):t.jsx("p",{className:"text-center text-gray-400 animate-pulse",children:"  ..."});if(e.mode===M.Dice||e.mode===M.Thief)return t.jsx(xy,{gameSession:e});if(e.mode===M.Curling)return t.jsx(py,{gameSession:e});if(e.mode===M.Omok||e.mode===M.Ttamok){let A="";if(c==="omok_win"?A=u?" ":"  ":c==="capture_limit"&&(A=u?"  ":"   "),A)return t.jsx("p",{className:"text-center text-2xl font-bold",children:A})}if(e.mode===M.Alkkagi){const A=n.id===i?$.Black:$.White,L=(e.alkkagiStones||[]).filter(q=>q.player===A&&q.onBoard).length,Q=(e.alkkagiStones||[]).filter(q=>q.player!==A&&q.onBoard).length;return u?L>0?t.jsxs("p",{className:"text-center text-lg",children:[L,"   ."]}):t.jsx("p",{className:"text-center text-lg",children:"    ."}):Q>0?t.jsxs("p",{className:"text-center text-lg",children:["     . (  ",Q," )"]}):t.jsx("p",{className:"text-center text-lg",children:" ."})}return t.jsx("p",{className:"text-center text-gray-400",children:"   ."})},S=p?Cr(p.manner.initial):"",P=p?Cr(p.manner.final):"";return t.jsx(be,{title:" ",onClose:s,initialWidth:600,windowId:"game-summary",children:t.jsxs("div",{className:"text-white text-[clamp(0.75rem,2.5vw,1rem)]",children:[t.jsx("h1",{className:`text-[clamp(2.25rem,10vw,3rem)] font-black text-center mb-4 tracking-widest ${w}`,children:j}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsxs("div",{className:"w-full bg-gray-900/50 p-2 sm:p-4 rounded-lg",children:[t.jsx("h2",{className:"text-lg font-bold text-center text-gray-200 mb-3 border-b border-gray-700 pb-2",children:" "}),C()]}),p&&t.jsxs("div",{className:"w-full flex flex-col gap-2 sm:gap-4",children:[t.jsxs("div",{className:"bg-gray-900/50 p-2 sm:p-4 rounded-lg space-y-4",children:[t.jsx("h2",{className:"text-lg font-bold text-center text-gray-200 mb-3 border-b border-gray-700 pb-2",children:"  "}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ce,{userId:n.id,userName:n.nickname,size:48,avatarUrl:h,borderUrl:y}),t.jsxs("div",{children:[t.jsx("p",{className:"font-bold",children:n.nickname}),t.jsxs("p",{className:"text-xs text-gray-400",children:[m?"":""," Lv.",p.level?p.level.final:m?n.playfulLevel:n.strategyLevel]})]})]}),p.level&&t.jsx(my,{initial:p.level.progress.initial,final:p.level.progress.final,max:p.level.progress.max,levelUp:p.level.initial<p.level.final,xpGain:p.xp.change,finalLevel:p.level.final}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-center",children:[t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[p.rating.final," (",t.jsxs("span",{className:p.rating.change>=0?"text-green-400":"text-red-400",children:[p.rating.change>0?"+":"",p.rating.change]}),")"]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:"  "}),t.jsxs("p",{className:`font-semibold ${p.manner.change===0?"text-white":p.manner.change>0?"text-green-400":"text-red-400"}`,children:[p.manner.change>0?"+":"",p.manner.change]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[(B=p.overallRecord)==null?void 0:B.wins," ",(R=p.overallRecord)==null?void 0:R.losses,""]})]}),t.jsxs("div",{className:"bg-gray-800 p-2 rounded-md",children:[t.jsx("p",{className:"text-gray-400",children:" "}),t.jsxs("p",{className:"font-semibold text-white",children:[S,"  ",P]})]})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-2 sm:p-4 rounded-lg space-y-3",children:[t.jsx("h2",{className:"text-lg font-bold text-center text-gray-200 border-b border-gray-700 pb-2",children:" "}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-center",children:[t.jsx("div",{className:"bg-gray-800 p-2 rounded-md",children:t.jsxs("p",{className:"font-semibold flex items-center justify-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4"})," ",(p.gold??0).toLocaleString()," "]})}),t.jsx("div",{className:"bg-gray-800 p-2 rounded-md flex items-center justify-center",children:v&&b?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[b.image&&t.jsx("img",{src:b.image,alt:v.name,className:"w-6 h-6 object-contain"}),t.jsx("p",{className:"font-semibold text-xs",children:v.name})]}):t.jsx("p",{className:"font-semibold text-xs",children:"   "})})]})]})]})]}),t.jsx(F,{onClick:s,className:"w-full py-3 mt-6",children:""})]})})},hy=({session:e,currentUser:n,onAction:s})=>{const[l,r]=f.useState(15),a=f.useRef(!1),{id:i,nigiri:o,player1:c,player2:d,gameStatus:u}=e;if(!o)return null;const{holderId:p,guesserId:m,result:h,stones:y,guess:v}=o,b=n.id===m;f.useEffect(()=>{u==="nigiri_choosing"&&!a.current&&(a.current=!0)},[u]);const g=f.useCallback(w=>{var k;n.id!==((k=e.nigiri)==null?void 0:k.guesserId)||e.gameStatus!=="nigiri_guessing"||s({type:"NIGIRI_GUESS",payload:{gameId:e.id,guess:w}})},[e,n,s]);f.useEffect(()=>{if(u!=="nigiri_guessing"||!b)return;const w=e.guessDeadline||Date.now()+15*1e3,k=setInterval(()=>{const C=Math.max(0,Math.ceil((w-Date.now())/1e3));r(C),C<=0&&clearInterval(k)},1e3);return()=>clearInterval(k)},[u,b,e.guessDeadline]);const x=()=>{switch(u){case"nigiri_reveal":return" ";case"nigiri_guessing":return"  ";case"nigiri_choosing":default:return"/  ()"}},j=()=>{const w=c.id===p?c:d,k=c.id===m?c:d;if(u==="nigiri_reveal"){if(!h||!k||!w||typeof y!="number"||!v)return t.jsxs("div",{className:"text-center animate-pulse",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2",children:"  ..."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]});const C=h==="correct",S=C?k:w,P=n.id===S.id,_=P?"  .":"  .",I=P?"bg-black border-gray-300":"bg-white border-gray-800",T=C?`${k.nickname} !`:`${k.nickname} .`,B=C?"text-green-400":"text-red-400",R=`${S.nickname} ()  .`;return t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg space-y-3 mb-6",children:[t.jsxs("div",{className:"flex justify-between items-center text-lg",children:[t.jsx("span",{className:"text-gray-400",children:"  :"}),t.jsxs("span",{className:"font-semibold",children:[y,""]})]}),t.jsxs("div",{className:"flex justify-between items-center text-lg",children:[t.jsxs("span",{className:"text-gray-400",children:[k.nickname," :"]}),t.jsx("span",{className:"font-semibold",children:v===1?"":""})]}),t.jsx("div",{className:`mt-2 text-lg font-bold ${B}`,children:T})]}),t.jsx("p",{className:"text-lg font-semibold mb-4",children:R}),t.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[t.jsx("div",{className:`w-24 h-24 rounded-full flex items-center justify-center border-4 ${I}`}),t.jsx("p",{className:"text-xl font-bold",children:_})]}),t.jsx("p",{className:"mt-6 text-sm text-gray-400 animate-pulse",children:"   ..."})]})}return u==="nigiri_guessing"?b?t.jsxs("div",{className:"text-center",children:[t.jsxs("h2",{className:"text-xl font-bold mb-2",children:[w.nickname,"  ."]}),t.jsx("p",{className:"text-gray-300 mb-4",children:"     ."}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${l/15*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:l})]}),t.jsxs("div",{className:"flex justify-center gap-4 mt-4",children:[t.jsx(F,{onClick:()=>g(1),colorScheme:"gray",className:"w-40 py-4 text-lg",children:""}),t.jsx(F,{onClick:()=>g(2),colorScheme:"gray",className:"w-40 py-4 text-lg",children:""})]})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-2",children:"  "}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[k.nickname,"    ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6 animate-pulse",children:b?`${w.nickname}   ...`:"   ..."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]})};return t.jsx(be,{title:x(),windowId:"nigiri",children:j()})},An=Pn.memo(({amount:e,onAdjust:n,disabled:s})=>t.jsx(F,{onClick:()=>n(e),disabled:s,colorScheme:"gray",className:"w-full",children:e>0?`+${e}`:`${e}`})),yy=e=>{const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,bids:o,biddingRound:c,captureBidDeadline:d,settings:u}=n,[p,m]=f.useState(1),[h,y]=f.useState(30),[v,b]=f.useState(!1),g=f.useRef(c),x=f.useRef(e);f.useEffect(()=>{x.current=e}),f.useEffect(()=>{c!==g.current&&(m(1),b(!1),g.current=c)},[c]);const j=s.id===a.id?i:a,w=o==null?void 0:o[s.id],k=o==null?void 0:o[j.id],C=typeof w=="number"&&typeof k=="number",S=f.useCallback(()=>{var A;const{onAction:I,session:T,currentUser:B}=x.current;typeof((A=T.bids)==null?void 0:A[B.id])=="number"||v||(b(!0),I({type:"UPDATE_CAPTURE_BID",payload:{gameId:r,bid:p}}),setTimeout(()=>b(!1),5e3))},[v,r,p]);f.useEffect(()=>{if(typeof w=="number"||!d){y(0);return}const I=setInterval(()=>{const T=Math.max(0,Math.ceil((d-Date.now())/1e3));y(T),T<=0&&clearInterval(I)},1e3);return()=>clearInterval(I)},[w,d]);const P=f.useCallback(I=>{typeof w!="number"&&m(T=>Math.max(1,Math.min(50,T+I)))},[w]),_=()=>{const I=u.captureTarget||20;if(C){const B=o[a.id],R=o[i.id];let A="";const L=B===R;let Q,q;B>R?(Q=a,q=B):R>B&&(Q=i,q=R),Q?A=`${Q.nickname} ${q}   () .`:A=c===2?"  ,  .":", !";const O=L&&c===1?"   ...":"   ...";return t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-lg mb-6",children:[t.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[t.jsxs("p",{className:"text-gray-400 text-sm mb-1",children:[a.nickname," "]}),t.jsxs("p",{className:"text-3xl font-bold",children:[B,""]})]}),t.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[t.jsxs("p",{className:"text-gray-400 text-sm mb-1",children:[i.nickname," "]}),t.jsxs("p",{className:"text-3xl font-bold",children:[R,""]})]})]}),t.jsx("p",{className:"mt-4 text-xl",children:t.jsx("span",{className:"font-bold text-yellow-300",children:A})}),t.jsx("p",{className:"mt-6 text-sm text-gray-400 animate-pulse",children:O})]})}if(typeof w=="number")return t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[j.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]});const T=typeof w=="number";return t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-gray-300 mb-6",children:["  ",t.jsxs("span",{className:"font-bold text-yellow-300",children:[I,""]}),". ()         .       ."]}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${h/30*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:h})]}),t.jsxs("div",{className:"my-4",children:[t.jsxs("div",{className:"bg-gray-900/70 p-2 rounded-lg text-4xl font-bold text-yellow-300 mb-4 text-center",children:[I," + ",p,""]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-2",children:[t.jsx(An,{amount:10,onAdjust:P,disabled:T}),t.jsx(An,{amount:5,onAdjust:P,disabled:T}),t.jsx(An,{amount:3,onAdjust:P,disabled:T}),t.jsx(An,{amount:1,onAdjust:P,disabled:T})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsx(An,{amount:-10,onAdjust:P,disabled:T}),t.jsx(An,{amount:-5,onAdjust:P,disabled:T}),t.jsx(An,{amount:-3,onAdjust:P,disabled:T}),t.jsx(An,{amount:-1,onAdjust:P,disabled:T})]})]}),t.jsx(F,{onClick:S,disabled:v||T,className:"w-full py-3",children:v?" ...":""})]})};return t.jsx(be,{title:`  ${c===2?"()":""}`,windowId:"capture-bid",children:_()})},by=({session:e,currentUser:n,onAction:s})=>{const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,effectiveCaptureTargets:c,gameStatus:d,settings:u,preGameConfirmations:p,revealEndTime:m}=e,h=p==null?void 0:p[n.id],[y,v]=f.useState(10);if(f.useEffect(()=>{const _=m||Date.now()+1e4,I=setInterval(()=>{const T=Math.max(0,Math.ceil((_-Date.now())/1e3));v(T)},1e3);return()=>{clearInterval(I)}},[m]),!i||!o||!c)return null;const b=r.id===i?r:a,g=r.id===o?r:a,x=c[$.Black],j=c[$.White],w=d==="capture_tiebreaker",k=()=>{if(w)return{title:"   ()",description:"    , /  ."};const _=c[$.Black]-u.captureTarget;return{title:"  ",description:`${b.nickname} ${_}  () .`}},{title:C,description:S}=k(),P=({user:_,color:I,target:T})=>t.jsxs("div",{className:"flex flex-col items-center text-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:_.id,userName:_.nickname,size:80,className:`border-4 ${I===""?"border-gray-500":"border-gray-400"}`}),t.jsx("p",{className:"mt-3 text-xl font-bold",children:_.nickname}),t.jsxs("p",{className:"text-lg font-semibold text-gray-300",children:[I,I===""&&" ()"]}),t.jsxs("div",{className:"mt-2 text-sm bg-gray-800 px-3 py-1 rounded-full",children:[t.jsx("span",{className:"text-gray-400",children:" : "}),t.jsxs("span",{className:"font-bold text-yellow-300",children:[T,""]}),t.jsx("span",{className:"text-gray-400",children:" "})]})]});return t.jsx(be,{title:C,initialWidth:550,windowId:"capture-tiebreaker",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-6",children:S}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 my-6",children:[t.jsx(P,{user:b,color:"",target:x}),t.jsx(P,{user:g,color:"",target:j})]}),t.jsx(F,{onClick:()=>s({type:"CONFIRM_CAPTURE_REVEAL",payload:{gameId:l}}),disabled:!!h,className:"w-full py-3",children:h?"   ...":`  (${y})`})]})})},wi=["rock","paper","scissors"],ks={rock:{emoji:"",name:""},paper:{emoji:"",name:""},scissors:{emoji:"",name:""}},vy=(e,n)=>e===n?"draw":e==="rock"&&n==="scissors"||e==="scissors"&&n==="paper"||e==="paper"&&n==="rock"?"p1":"p2",jy=e=>{const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,rpsState:o,gameStatus:c,mode:d,rpsRound:u}=n,[p,m]=f.useState(null),[h,y]=f.useState(30),v=f.useRef(e);f.useEffect(()=>{v.current=e});const b=s.id,g=b===a.id?i:a,x=o==null?void 0:o[b],j=f.useCallback(S=>{const{session:P,onAction:_,currentUser:I}=v.current,{id:T,rpsState:B}=P;B!=null&&B[I.id]||(m(S),_({type:"SUBMIT_RPS_CHOICE",payload:{gameId:T,choice:S}}))},[]);f.useEffect(()=>{(c==="dice_rps"||c==="thief_rps"||c==="alkkagi_rps"||c==="curling_rps"||c==="omok_rps"||c==="ttamok_rps")&&(m(null),y(30))},[c]),f.useEffect(()=>{if(!(!x&&!p&&(c==="dice_rps"||c==="thief_rps"||c==="alkkagi_rps"||c==="curling_rps"||c==="omok_rps"||c==="ttamok_rps")))return;const P=setInterval(()=>{y(_=>{if(_<=1){clearInterval(P);const I=wi[Math.floor(Math.random()*wi.length)];return j(I),0}return _-1})},1e3);return()=>clearInterval(P)},[x,p,c,j]);const w=()=>{switch(d){case M.Thief:return" !    .";case M.Alkkagi:case M.Curling:case M.Omok:case M.Ttamok:return" !     .";case M.Dice:default:return"    ."}},k=()=>` ${u?`(${u}/3)`:""}`,C=()=>{if(c.endsWith("_rps_reveal")){const P=o==null?void 0:o[a.id],_=o==null?void 0:o[i.id];if(P&&_){const I=vy(P,_);let T="",B="";if(I==="draw")T=(u||1)>=3?"!  ...":"!  !",B="text-yellow-400";else if(b===a.id&&I==="p1"||b===i.id&&I==="p2"){let A="!";d===M.Dice&&(A="! ."),d===M.Thief&&(A="!   ."),(d===M.Alkkagi||d===M.Curling||d===M.Omok||d===M.Ttamok)&&n.turnChoices&&(A=`! ${n.turnChoices[b]==="first"?"":""} .`),T=A,B="text-green-400"}else{let A="!";d===M.Dice&&(A="! ."),d===M.Thief&&(A="!   ."),(d===M.Alkkagi||d===M.Curling||d===M.Omok||d===M.Ttamok)&&n.turnChoices&&(A=`!  ${n.turnChoices[g.id]==="first"?"":""} .`),T=A,B="text-red-400"}return t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"flex justify-around items-center mb-6",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-lg font-semibold",children:a.nickname}),t.jsx("span",{className:"text-7xl my-2",children:ks[P].emoji}),t.jsx("span",{className:"text-gray-300",children:ks[P].name})]}),t.jsx("span",{className:"text-4xl font-bold text-gray-500",children:"VS"}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("span",{className:"text-lg font-semibold",children:i.nickname}),t.jsx("span",{className:"text-7xl my-2",children:ks[_].emoji}),t.jsx("span",{className:"text-gray-300",children:ks[_].name})]})]}),t.jsx("h2",{className:`text-3xl font-bold animate-pulse ${B}`,children:T})]})}}return x||p?t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[g.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-4",children:w()}),u===3&&t.jsx("p",{className:"text-sm text-yellow-300 mb-4",children:"   !"}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${h/30*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:h})]}),t.jsx("div",{className:"flex justify-center gap-4 mt-4",children:wi.map(P=>t.jsx(F,{onClick:()=>j(P),colorScheme:"gray",className:"w-32 h-20 text-lg",children:t.jsxs("div",{className:"flex flex-col items-center justify-center",children:[t.jsx("span",{className:"text-3xl",children:ks[P].emoji}),t.jsx("span",{children:ks[P].name})]})},P))})]})};return t.jsx(be,{title:k(),windowId:"rps-minigame",children:C()})},wy=e=>{const{session:n,currentUser:s}=e,{player1:l,player2:r,roleChoices:a}=n,[i,o]=f.useState(null),[c,d]=f.useState(10),u=f.useRef(e);f.useEffect(()=>{u.current=e});const p=s.id,m=p===l.id?r:l,h=a==null?void 0:a[p],y=f.useCallback(b=>{var k;const{session:g,onAction:x,currentUser:j}=u.current;(k=g.roleChoices)!=null&&k[j.id]||(o(b),x({type:"THIEF_UPDATE_ROLE_CHOICE",payload:{gameId:g.id,choice:b}}))},[]);f.useEffect(()=>{if(h||i)return;const b=setInterval(()=>{d(g=>g<=1?(clearInterval(b),0):g-1)},1e3);return()=>clearInterval(b)},[h,i,y]);const v=()=>h||i?t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[m.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6",children:"  .    ."}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${c*10}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:c})]}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsx(F,{onClick:()=>y("thief"),colorScheme:"yellow",className:"w-full py-4 text-lg",children:" "}),t.jsx(F,{onClick:()=>y("police"),colorScheme:"blue",className:"w-full py-4 text-lg",children:" "})]})]});return t.jsx(be,{title:" ",windowId:"thief-role-selection",children:v()})},Ny=({session:e,currentUser:n,onAction:s})=>{var _,I,T,B,R,A;const{id:l,player1:r,player2:a,thiefPlayerId:i,policePlayerId:o,preGameConfirmations:c,revealEndTime:d,rpsState:u,turnChoices:p}=e,m=!!(c!=null&&c[n.id]),[h,y]=f.useState(10);if(f.useEffect(()=>{const L=d||Date.now()+1e4,Q=setInterval(()=>{const q=Math.max(0,Math.ceil((L-Date.now())/1e3));y(q)},1e3);return()=>clearInterval(Q)},[d]),!i||!o)return null;const v=r.id===i?r:a,b=r.id===o?r:a,g=(_=Te.find(L=>L.id===v.avatarId))==null?void 0:_.url,x=(I=Re.find(L=>L.id===v.borderId))==null?void 0:I.url,j=(T=Te.find(L=>L.id===b.avatarId))==null?void 0:T.url,w=(B=Re.find(L=>L.id===b.borderId))==null?void 0:B.url;let k=" .";const C=(R=e.roleChoices)==null?void 0:R[n.id],S=n.id===r.id?a.id:r.id,P=(A=e.roleChoices)==null?void 0:A[S];return C===P&&(k=` , ${v.id===n.id?"":""}  .`),t.jsx(be,{title:"  ",initialWidth:600,windowId:"thief-role-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:k}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:v.id,userName:v.nickname,size:64,avatarUrl:g,borderUrl:x}),t.jsx("p",{className:"mt-2 font-bold",children:v.nickname}),t.jsx("p",{className:"font-semibold px-2 py-0.5 rounded-full text-sm my-1 bg-yellow-600 text-black",children:"  ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:b.id,userName:b.nickname,size:64,avatarUrl:j,borderUrl:w}),t.jsx("p",{className:"mt-2 font-bold",children:b.nickname}),t.jsx("p",{className:"font-semibold px-2 py-0.5 rounded-full text-sm my-1 bg-blue-600 text-white",children:"  ()"})]})]}),t.jsx(F,{onClick:()=>s({type:"CONFIRM_THIEF_ROLE",payload:{gameId:l}}),disabled:!!m,className:"w-full py-3 mt-6",children:m?"   ...":`  (${h})`})]})})},ky=e=>{const{session:n,currentUser:s}=e,{player1:l,player2:r,turnChoices:a,turnChoiceDeadline:i}=n,[o,c]=f.useState(null),[d,u]=f.useState(30),p=f.useRef(e);f.useEffect(()=>{p.current=e});const m=s.id,h=m===l.id?r:l,y=a==null?void 0:a[m],v=f.useCallback(g=>{var C;const{session:x,onAction:j,currentUser:w}=p.current;(C=x.turnChoices)!=null&&C[w.id]||(c(g),j({type:"CHOOSE_TURN_PREFERENCE",payload:{gameId:x.id,choice:g}}))},[]);f.useEffect(()=>{if(y||o||!i)return;const g=setInterval(()=>{const x=Math.max(0,Math.ceil((i-Date.now())/1e3));u(x),x<=0&&clearInterval(g)},1e3);return()=>clearInterval(g)},[y,o,i]);const b=()=>y||o?t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:" !"}),t.jsxs("p",{className:"text-gray-300 mb-6 animate-pulse",children:[h.nickname,"   ..."]}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-100"})})]}):t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6",children:"  .    ."}),t.jsxs("div",{className:"my-4 text-center",children:[t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mb-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${d/30*100}%`,transition:"width 1s linear"}})}),t.jsx("div",{className:"text-5xl font-mono text-yellow-300",children:d})]}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsx(F,{onClick:()=>v("first"),colorScheme:"blue",className:"w-full py-4 text-lg",children:" ()"}),t.jsx(F,{onClick:()=>v("second"),colorScheme:"gray",className:"w-full py-4 text-lg",children:" ()"})]})]});return t.jsx(be,{title:" ",windowId:"turn-preference-selection",children:b()})},Sy=({session:e,currentUser:n,onConfirm:s})=>{var r;const l=(r=e.noContestInitiatorIds)==null?void 0:r.includes(n.id);return t.jsx(be,{title:" ",onClose:s,initialWidth:450,windowId:"no-contest",children:t.jsxs("div",{className:"text-white",children:[t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg mb-6 text-center",children:[t.jsxs("p",{className:"text-lg",children:["10       ",t.jsx("br",{}),"   ."]}),l&&t.jsx("p",{className:"text-sm text-red-400 mt-3",children:":     ,    ."})]}),t.jsx(F,{onClick:s,className:"w-full py-3",children:""})]})})},Eu=(e,n)=>{var r,a;const s=(r=Te.find(i=>i.id===n.avatarId))==null?void 0:r.url,l=(a=Re.find(i=>i.id===n.borderId))==null?void 0:a.url;return t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:n.id,userName:n.nickname,size:80,avatarUrl:s,borderUrl:l}),t.jsx("p",{className:"mt-2 font-bold text-lg",children:n.nickname}),t.jsx("p",{className:`px-2 py-0.5 rounded-full text-sm font-semibold my-2 ${e.role==="thief"?"bg-yellow-600 text-black":"bg-blue-600 text-white"}`,children:e.role==="thief"?" ":" "}),t.jsxs("div",{className:"text-left text-sm space-y-1 w-full",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold",children:[e.roundScore," ",e.role==="thief"?" ":" "]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-1 mt-1 font-bold",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-mono text-xl text-yellow-300",children:[e.cumulativeScore,""]})]})]})]})},Cy=({session:e,currentUser:n,onAction:s})=>{const{id:l,player1:r,player2:a,thiefRoundSummary:i,roundEndConfirmations:o,revealEndTime:c}=e,[d,u]=f.useState(20),p=!!(o!=null&&o[n.id]);if(f.useEffect(()=>{const x=c||Date.now()+2e4,j=setInterval(()=>{const w=Math.max(0,Math.ceil((x-Date.now())/1e3));u(w)},1e3);return()=>{clearInterval(j)}},[c]),!i)return null;const{round:m,isDeathmatch:h,player1:y,player2:v}=i,b=h?` ${m-2} `:`${m}  `;let g="";return h?g="  ,     .":m<2?g="     .":g="2  .     .",t.jsx(be,{title:b,initialWidth:550,windowId:"thief-round-summary",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-6",children:g}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 my-6",children:[Eu(y,r),Eu(v,a)]}),t.jsx(F,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:p,className:"w-full py-3",children:p?"   ...":`   (${d})`})]})})},Iy=({session:e,currentUser:n,onAction:s})=>{var q,O,U,G;const{id:l,curlingRoundSummary:r,player1:a,player2:i,blackPlayerId:o,whitePlayerId:c,roundEndConfirmations:d}=e,[u,p]=f.useState(20),m=!!(d!=null&&d[n.id]);if(f.useEffect(()=>{const z=e.revealEndTime||Date.now()+2e4,H=setInterval(()=>{const ne=Math.max(0,Math.ceil((z-Date.now())/1e3));p(ne)},1e3);return()=>clearInterval(H)},[e.revealEndTime]),!r)return null;const h=o===a.id?a:i,y=c===a.id?a:i,v=(q=Te.find(z=>z.id===h.avatarId))==null?void 0:q.url,b=(O=Re.find(z=>z.id===h.borderId))==null?void 0:O.url,g=(U=Te.find(z=>z.id===y.avatarId))==null?void 0:U.url,x=(G=Re.find(z=>z.id===y.borderId))==null?void 0:G.url,{round:j,black:w,white:k,cumulativeScores:C,stonesState:S,scoredStones:P}=r,I=(n.id===o?$.Black:$.White)===$.White,T=e.settings.curlingRounds||3,B=840,R={x:B/2,y:B/2},A=B/19,L=[A*6,A*4,A*2,A*.5],Q=["rgba(0, 100, 255, 0.2)","rgba(255, 255, 255, 0.2)","rgba(255, 0, 0, 0.2)","white"];return t.jsx(be,{title:`${j}  `,initialWidth:900,windowId:"curling-round-summary",children:t.jsxs("div",{className:"text-white flex flex-col md:flex-row gap-4",children:[t.jsxs("div",{className:"w-full md:w-1/2 flex flex-col items-center flex-shrink-0",children:[t.jsx("h3",{className:"text-xl font-bold mb-2",children:"  "}),t.jsx("div",{className:`w-full aspect-square bg-gray-700 rounded-lg overflow-hidden border-2 border-gray-600 transition-transform duration-500 ${I?"rotate-180":""}`,children:t.jsxs("svg",{viewBox:`0 0 ${B} ${B}`,className:"w-full h-full bg-[#DDAA77]",children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"gloss-curling-summary-1",children:[t.jsx("stop",{offset:"10%",stopColor:"#333"}),t.jsx("stop",{offset:"95%",stopColor:"#000"})]}),t.jsxs("radialGradient",{id:"gloss-curling-summary-2",children:[t.jsx("stop",{offset:"10%",stopColor:"#fff"}),t.jsx("stop",{offset:"95%",stopColor:"#ccc"})]}),t.jsxs("filter",{id:"glow-effect",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[t.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),t.jsxs("feMerge",{children:[t.jsx("feMergeNode",{in:"coloredBlur"}),t.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),L.map((z,H)=>t.jsx("circle",{cx:R.x,cy:R.y,r:z,fill:Q[H]},H)),S.map(z=>{if(!z.onBoard)return null;const H=P[z.id];return t.jsxs("g",{children:[t.jsx("circle",{cx:z.x,cy:z.y,r:z.radius,fill:z.player===$.Black?"#111827":"#f9fafb"}),t.jsx("circle",{cx:z.x,cy:z.y,r:z.radius,fill:`url(#gloss-curling-summary-${z.player})`}),H&&t.jsxs("g",{style:{pointerEvents:"none"},transform:I?`rotate(180, ${z.x}, ${z.y})`:void 0,children:[t.jsx("circle",{cx:z.x,cy:z.y,r:z.radius,fill:"none",stroke:z.player===$.Black?"#67e8f9":"#facc15",strokeWidth:"5",filter:"url(#glow-effect)"}),t.jsxs("text",{x:z.x,y:z.y,textAnchor:"middle",dy:".35em",fontSize:z.radius*.9,fontWeight:"bold",fill:z.player===$.Black?"white":"black",stroke:"rgba(0,0,0,0.5)",strokeWidth:"0.5px",children:["+",H]})]})]},z.id)})]})})]}),t.jsxs("div",{className:"w-full md:w-1/2 flex-grow flex flex-col justify-center",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-2 my-2",children:[t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(Ce,{userId:h.id,userName:h.nickname,size:48,avatarUrl:v,borderUrl:b}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold",children:h.nickname}),t.jsx("p",{className:"text-sm text-gray-400",children:""})]})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[w.houseScore,""]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[w.knockoutScore,""]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-2 mt-2 text-base",children:[t.jsx("strong",{children:" :"})," ",t.jsxs("strong",{className:"text-yellow-300",children:[w.total,""]})]})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:48,avatarUrl:g,borderUrl:x}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-bold",children:y.nickname}),t.jsx("p",{className:"text-sm text-gray-400",children:""})]})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[k.houseScore,""]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"font-semibold",children:[k.knockoutScore,""]})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-600 pt-2 mt-2 text-base",children:[t.jsx("strong",{children:" :"})," ",t.jsxs("strong",{className:"text-yellow-300",children:[k.total,""]})]})]})]})]}),t.jsxs("div",{className:"text-center bg-gray-700/50 p-3 rounded-lg mt-4",children:[t.jsx("p",{className:"text-lg font-bold",children:" "}),t.jsxs("p",{className:"text-2xl font-mono",children:[t.jsxs("span",{children:[" ",C[$.Black]]}),t.jsx("span",{className:"mx-4 text-gray-400",children:":"}),t.jsxs("span",{children:[" ",C[$.White]]})]})]}),t.jsx(F,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:!!m,className:"w-full mt-6 py-3",children:m?"   ...":`${j>=T?"  ":"  "} (${u})`})]})]})})},Ey=({session:e,currentUser:n,onAction:s})=>{var _,I,T,B;const{id:l,player1:r,player2:a,diceRoundSummary:i,roundEndConfirmations:o,revealEndTime:c}=e,[d,u]=f.useState(20),p=!!(o!=null&&o[n.id]);if(f.useEffect(()=>{const R=c||Date.now()+2e4,A=setInterval(()=>{const L=Math.max(0,Math.ceil((R-Date.now())/1e3));u(L)},1e3);return()=>{clearInterval(A)}},[c]),!i)return null;const{round:m,scores:h,diceStats:y}=i,v=h[r.id]||0,b=h[a.id]||0,g=(_=Te.find(R=>R.id===r.avatarId))==null?void 0:_.url,x=(I=Re.find(R=>R.id===r.borderId))==null?void 0:I.url,j=(T=Te.find(R=>R.id===a.avatarId))==null?void 0:T.url,w=(B=Re.find(R=>R.id===a.borderId))==null?void 0:B.url,k=R=>{if(!y||!y[R])return null;const A=y[R];return A.totalRolls===0?t.jsx("p",{className:"text-sm text-gray-400",children:"  ."}):t.jsx("div",{className:"grid grid-cols-3 gap-x-4 gap-y-1 text-xs",children:Array.from({length:6},(L,Q)=>Q+1).map(L=>{const Q=A.rolls[L]||0,q=(Q/A.totalRolls*100).toFixed(0);return t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:[L,":"]}),t.jsxs("span",{className:"font-mono",children:[Q," (",q,"%)"]})]},L)})})},C=i.round>=(e.settings.diceGoRounds??3),S=v===b;let P=`   (${d})`;return C&&(S?P=`  (${d})`:P=`   (${d})`),p&&(P="   ..."),t.jsx(be,{title:`${m}   `,initialWidth:650,windowId:"dice-round-summary",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-6",children:"    ."}),t.jsxs("div",{className:"flex justify-around items-center my-6",children:[t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:r.id,userName:r.nickname,size:96,avatarUrl:g,borderUrl:x}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:r.nickname})]}),t.jsxs("span",{className:"text-4xl font-mono text-gray-300",children:[v," : ",b]}),t.jsxs("div",{className:"flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:a.id,userName:a.nickname,size:96,avatarUrl:j,borderUrl:w}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:a.nickname})]})]}),y&&t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg my-6",children:[t.jsx("h3",{className:"text-lg font-bold text-center text-gray-200 mb-3",children:"1  "}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-gray-800/60 p-3 rounded",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:r.nickname}),k(r.id)]}),t.jsxs("div",{className:"bg-gray-800/60 p-3 rounded",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:a.nickname}),k(a.id)]})]})]}),t.jsx(F,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:!!p,className:"w-full py-3",children:P})]})})},Py=({session:e,currentUser:n,onAction:s})=>{const{basePlacementDeadline:l,settings:r,player1:a,baseStones_p1:i,baseStones_p2:o}=e,c=r.baseStones||4,d=n.id===a.id?i:o,u=(d==null?void 0:d.length)||0,p=u>=c,[m,h]=f.useState(30);return f.useEffect(()=>{if(!l)return;const y=setInterval(()=>{const v=Math.max(0,Math.ceil((l-Date.now())/1e3));h(v)},1e3);return()=>clearInterval(y)},[l]),t.jsx(be,{title:" ",windowId:"base-placement",initialWidth:300,modal:!1,children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-200",children:"    ."}),t.jsxs("p",{className:"text-lg font-bold my-2",children:["(",u,"/",c,")"]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 my-3 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${m/30*100}%`,transition:"width 0.5s linear"}})}),t.jsx("div",{className:"text-5xl font-mono font-bold mt-1 text-white",children:m}),!p&&t.jsx(F,{onClick:()=>s({type:"PLACE_REMAINING_BASE_STONES_RANDOMLY"}),colorScheme:"yellow",className:"w-full mt-4 !text-sm !py-2",children:"   "}),p&&t.jsx("p",{className:"text-sm text-green-400 animate-pulse mt-4",children:" !  ..."})]})})},Ty=({session:e})=>{const{baseStones_p1:n,baseStones_p2:s,settings:{boardSize:l}}=e,r=[...(n||[]).map(m=>({...m,player:$.Black})),...(s||[]).map(m=>({...m,player:$.White}))],a=250,i=a/l,o=i/2,c=i*.47,d=c*2*.7,u=d/2,p=m=>({cx:o+m.x*i,cy:o+m.y*i});return t.jsxs("svg",{viewBox:`0 0 ${a} ${a}`,className:"w-full h-full bg-[#e0b484] rounded-md shadow-inner",children:[Array.from({length:l}).map((m,h)=>t.jsxs("g",{children:[t.jsx("line",{x1:o+h*i,y1:o,x2:o+h*i,y2:a-o,stroke:"#54432a",strokeWidth:"1"}),t.jsx("line",{x1:o,y1:o+h*i,x2:a-o,y2:o+h*i,stroke:"#54432a",strokeWidth:"1"})]},h)),r.map((m,h)=>{const{cx:y,cy:v}=p(m);return t.jsxs("g",{children:[t.jsx("circle",{cx:y,cy:v,r:c,fill:m.player===$.Black?"#111827":"#f5f2e8"}),t.jsx("image",{href:m.player===$.Black?Da:Oa,x:y-u,y:v-u,width:d,height:d})]},`base-stone-${h}`)})]})},Rn=Pn.memo(({amount:e,onAdjust:n,disabled:s})=>t.jsx(F,{onClick:()=>n(e),disabled:s,colorScheme:"gray",className:"w-full !py-1",children:e>0?`+${e}`:`${e}`})),My=e=>{const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,komiBids:o,komiBiddingDeadline:c,gameStatus:d,komiBiddingRound:u}=n,[p,m]=f.useState($.Black),[h,y]=f.useState(0),[v,b]=f.useState(30),[g,x]=f.useState(!1),j=f.useRef(e);f.useEffect(()=>{j.current=e});const w=s.id===a.id?i:a,k=o==null?void 0:o[s.id],C=w?o==null?void 0:o[w.id]:void 0,S=f.useCallback(()=>{var O;const{session:R,onAction:A,currentUser:L}=j.current;if(((O=R.komiBids)==null?void 0:O[L.id])||g||p===$.None)return;x(!0);const q={color:p,komi:h};A({type:"UPDATE_KOMI_BID",payload:{gameId:R.id,bid:q}}),setTimeout(()=>x(!1),5e3)},[g,p,h]);f.useEffect(()=>{m($.Black),y(0)},[u]),f.useEffect(()=>{if(k||!c){b(k?0:30);return}const R=setInterval(()=>{const A=Math.max(0,Math.ceil((c-Date.now())/1e3));b(A),A<=0&&S()},1e3);return()=>clearInterval(R)},[k,c,S]);const P=R=>{y(A=>Math.max(0,Math.min(100,A+R)))},_=()=>{if(!k||!C||!w)return t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:"  ..."}),t.jsx("p",{className:"text-gray-400 animate-pulse",children:"  ."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-gray-100"})})]});let R="";const A=k.color===C.color&&k.komi===C.komi;k.color!==C.color?R="   ,    . ( 0.5)":k.komi!==C.komi?R="  ,      .":u===1?R="   , 2   .":R="2    , /  .";const L=A&&u===1?"   ...":"   ...";return t.jsxs("div",{className:"text-center",children:[t.jsxs("h3",{className:"text-lg font-bold mb-2",children:["   ",u===2&&"()"]}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-md space-y-2 text-sm",children:[t.jsxs("div",{children:[s.nickname,": ",t.jsxs("span",{className:"font-bold",children:[k.color===$.Black?"":"",", ",k.komi,""]})]}),t.jsxs("div",{children:[w.nickname,": ",t.jsxs("span",{className:"font-bold",children:[C.color===$.Black?"":"",", ",C.komi,""]})]})]}),t.jsx("p",{className:"mt-4 text-xs text-yellow-300",children:R}),t.jsx("p",{className:"mt-4 text-sm text-gray-400 animate-pulse",children:L})]})};if(d==="komi_bid_reveal")return t.jsx(be,{title:"  ",windowId:"komi-bidding",children:_()});if(k)return t.jsx(be,{title:" ",windowId:"komi-bidding",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"text-lg font-bold mb-2",children:" !"}),t.jsx("p",{className:"text-gray-400 animate-pulse",children:"   ..."}),t.jsx("div",{className:"flex justify-center items-center h-20",children:t.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-gray-100"})})]})});const I=.5,T=()=>{if(p===$.Black)return` ,   ${h+I} .`;{const R=I-h;return R>=0?` ,   ${R} .`:` ,    ${Math.abs(R)} .`}},B=!!k;return t.jsx(be,{title:`  ${u===2?"()":""}`,windowId:"komi-bidding",initialWidth:650,children:t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col",children:[t.jsx("p",{className:"text-center text-sm text-gray-400 mb-2",children:" "}),t.jsx("div",{className:"aspect-square",children:t.jsx(Ty,{session:n})}),t.jsx("p",{className:"text-center text-xs text-gray-400 mt-1",children:"(P1: , P2:  )"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col justify-between",children:[t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:["       . ( :  ",I,")"]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5 my-2 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-1.5 rounded-full",style:{width:`${v/30*100}%`,transition:"width 0.5s linear"}})}),t.jsx("div",{className:"text-3xl font-mono font-bold text-center text-white",children:v}),t.jsxs("div",{className:"flex justify-center gap-4 my-4",children:[t.jsx(F,{onClick:()=>m($.Black),disabled:B,colorScheme:p===$.Black?"blue":"gray",className:"w-24",children:""}),t.jsx(F,{onClick:()=>m($.White),disabled:B,colorScheme:p===$.White?"blue":"gray",className:"w-24",children:""})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-300 mb-2",children:"   (0~100)"}),t.jsxs("div",{className:"bg-gray-900/70 p-2 rounded-lg text-2xl font-bold text-yellow-300 mb-2",children:[h,""]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-2",children:[t.jsx(Rn,{amount:10,onAdjust:P,disabled:B}),t.jsx(Rn,{amount:5,onAdjust:P,disabled:B}),t.jsx(Rn,{amount:3,onAdjust:P,disabled:B}),t.jsx(Rn,{amount:1,onAdjust:P,disabled:B})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[t.jsx(Rn,{amount:-10,onAdjust:P,disabled:B}),t.jsx(Rn,{amount:-5,onAdjust:P,disabled:B}),t.jsx(Rn,{amount:-3,onAdjust:P,disabled:B}),t.jsx(Rn,{amount:-1,onAdjust:P,disabled:B})]})]}),t.jsx("p",{className:"text-xs text-gray-400 text-center mt-3 h-8",children:T()})]}),t.jsx(F,{onClick:S,disabled:B||g,className:"w-full mt-auto",children:B?" ":"  "})]})]})})},_y=({session:e,currentUser:n})=>{const{alkkagiPlacementDeadline:s,settings:l,player1:r,alkkagiStones:a,alkkagiStones_p1:i,alkkagiStones_p2:o,alkkagiStonesPlacedThisRound:c,blackPlayerId:d}=e,u=l.alkkagiStoneCount||5,p=(c==null?void 0:c[n.id])||0,m=u,h=(e.alkkagiRound||1)>1?`  (${e.alkkagiRound} )`:"  ",y=p>=m,[v,b]=f.useState(30);return f.useEffect(()=>{if(!s)return;const g=setInterval(()=>{const x=Math.max(0,Math.ceil((s-Date.now())/1e3));b(x)},1e3);return()=>clearInterval(g)},[s]),t.jsx(be,{title:h,windowId:"alkkagi-placement",initialWidth:300,modal:!1,children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-200",children:(e.alkkagiRound||1)>1?"  .":"    ."}),t.jsxs("p",{className:"text-lg font-bold my-2",children:["(",p,"/",m,")"]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 my-3 overflow-hidden",children:t.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${v/30*100}%`,transition:"width 0.5s linear"}})}),t.jsx("div",{className:"text-5xl font-mono font-bold mt-1 text-white",children:v}),y&&t.jsx("p",{className:"text-sm text-green-400 animate-pulse mt-4",children:" !  ..."})]})})},Pu="preferredGameSettings",$e=({label:e,children:n,className:s})=>t.jsxs("div",{className:`grid grid-cols-2 gap-4 items-center ${s}`,children:[t.jsx("label",{className:"font-semibold text-gray-300",children:e}),n]}),Ay=({deadline:e})=>{const[n,s]=f.useState(()=>Math.max(0,Math.ceil((e-Date.now())/1e3)));return f.useEffect(()=>{s(Math.max(0,Math.ceil((e-Date.now())/1e3)));const l=setInterval(()=>{s(r=>{const a=Math.max(0,Math.ceil((e-Date.now())/1e3));return r!==a?a:r})},1e3);return()=>clearInterval(l)},[e]),t.jsxs("span",{children:["(",n,")"]})},Ry=e=>{var je;const{negotiation:n,currentUser:s,onAction:l,onlineUsers:r,isTopmost:a}=e,[i,o]=f.useState(n.settings),c=f.useRef(!1),d=n.proposerId===s.id,u=n.status==="pending",m=n.status==="draft"&&d,h=u&&d,y=u&&!d,v=f.useMemo(()=>{const E=n.challenger.id===s.id?n.opponent:n.challenger;return E.id===tl?E:r.find(le=>le.id===E.id)||E},[n.challenger,n.opponent,s.id,r]),b=v.id===tl,g=f.useCallback(()=>{l({type:"DECLINE_NEGOTIATION",payload:{negotiationId:n.id}})},[l,n.id]);f.useEffect(()=>{let E;if(m){E={...Jd,...n.settings};try{const ae=`${Pu}_${n.mode}`,de=localStorage.getItem(ae);if(de){const te=JSON.parse(de);if(n.mode===M.Alkkagi){const pe=No.map(we=>we.value);te.alkkagiGaugeSpeed&&!pe.includes(te.alkkagiGaugeSpeed)&&delete te.alkkagiGaugeSpeed,te.alkkagiStoneCount&&!Xd.includes(te.alkkagiStoneCount)&&delete te.alkkagiStoneCount}if(n.mode===M.Curling){const pe=ko.map(we=>we.value);te.curlingGaugeSpeed&&!pe.includes(te.curlingGaugeSpeed)&&delete te.curlingGaugeSpeed,te.curlingStoneCount&&!eu.includes(te.curlingStoneCount)&&delete te.curlingStoneCount}te.baseStones&&!bi.includes(te.baseStones)&&delete te.baseStones,E={...E,...te}}}catch(ae){console.error("Failed to load or parse preferred settings",ae)}}else E={...Jd,...n.settings};n.mode===M.Base&&(E.komi=.5),b&&!E.player1Color&&(E.player1Color=$.Black);const le=(ae=>{switch(ae){case M.Omok:case M.Ttamok:return $d;case M.Capture:return Od;case M.Speed:return Dd;case M.Hidden:return qd;case M.Thief:return Ud;case M.Missile:return zd;case M.Alkkagi:case M.Curling:case M.Dice:return[19];default:return Ld}})(n.mode);if(le.includes(E.boardSize)||(E.boardSize=le[0]),E.mixedModes){const ae=E.mixedModes.includes(M.Base),de=E.mixedModes.includes(M.Capture);ae&&de&&(E.mixedModes=E.mixedModes.filter(te=>te!==M.Base))}o(E),c.current=!1},[n.id,n.turnCount]),f.useEffect(()=>{h&&!c.current&&(Ee.myTurn(),c.current=!0)},[h]);const x=f.useMemo(()=>{var ue;const E=at.some(Se=>Se.mode===n.mode),Z=E?v.strategyLevel:v.playfulLevel,le=(ue=v.stats)==null?void 0:ue[n.mode],ae=(le==null?void 0:le.wins)??0,de=(le==null?void 0:le.losses)??0,te=v.mannerScore??200,pe=ae+de,we=pe>0?Math.round(ae/pe*100):0;return{level:Z,levelLabel:E?"":"",wins:ae,losses:de,mannerScore:te,winRate:we}},[v,n.mode]),j=f.useMemo(()=>{var E;return(E=Te.find(Z=>Z.id===v.avatarId))==null?void 0:E.url},[v.avatarId]),w=f.useMemo(()=>{var E;return(E=Re.find(Z=>Z.id===v.borderId))==null?void 0:E.url},[v.borderId]),k=f.useMemo(()=>at.some(E=>E.mode===n.mode)?tu:St.some(E=>E.mode===n.mode)?f0:tu,[n.mode]),C=f.useMemo(()=>JSON.stringify(i)!==JSON.stringify(n.settings),[i,n.settings]),S=f.useCallback((E,Z)=>o(le=>({...le,[E]:Z})),[]),P=(E,Z)=>o(le=>({...le,mixedModes:Z?[...le.mixedModes||[],E]:(le.mixedModes||[]).filter(ae=>ae!==E)})),_=f.useCallback(E=>{try{const Z=`${Pu}_${n.mode}`;localStorage.setItem(Z,JSON.stringify(i))}catch(Z){console.error("Failed to save preferred settings",Z)}l(E)},[l,i,n.mode]),I=()=>l({type:"ACCEPT_NEGOTIATION",payload:{negotiationId:n.id,settings:i}}),T=()=>l({type:"UPDATE_NEGOTIATION",payload:{negotiationId:n.id,settings:i}}),B=()=>_({type:"SEND_CHALLENGE",payload:{negotiationId:n.id,settings:i}}),R=()=>_({type:"START_AI_GAME",payload:{mode:n.mode,settings:i}}),A=f.useMemo(()=>b?`${n.mode} AI  `:n.rematchOfGameId?`  (${n.mode})`:`  (${n.mode})`,[n.mode,n.rematchOfGameId,b]),L=s.actionPoints.current>=k,Q=()=>{const E="flex-1";if(b)return t.jsxs("div",{className:"flex justify-end gap-4",children:[t.jsx(F,{onClick:g,colorScheme:"red",className:E,children:""}),t.jsxs(F,{onClick:R,colorScheme:"green",className:E,disabled:!L,children:[" ",L?`(${k})`:"()"]})]});if(m){const Z=n.mode===M.Mix&&(!i.mixedModes||i.mixedModes.length<2);return t.jsxs("div",{className:"flex justify-between items-center gap-4",children:[t.jsx(F,{onClick:g,colorScheme:"red",className:E,children:""}),t.jsxs(F,{onClick:B,disabled:Z||!L,colorScheme:"green",className:E,children:["  ",L?`(${k})`:"()"]})]})}return h?t.jsxs("div",{className:"flex justify-between items-center gap-4",children:[t.jsx(F,{onClick:g,colorScheme:"red",className:E,children:""}),t.jsx(F,{onClick:T,disabled:!C,colorScheme:"yellow",className:E,children:" "}),t.jsxs(F,{onClick:I,disabled:C||!L,colorScheme:"green",className:E,children:[" ",L?`(${k})`:"()"]})]}):null},q=y||!d,O=()=>b?"AI   .":m?"   [ ]  .":h?"  []  [ ].":y?`(${v.nickname})   ...`:"  ...",U=({value:E,onChange:Z,children:le,disabled:ae})=>t.jsx("select",{value:E,onChange:de=>Z(de.target.value),disabled:ae,className:"w-full bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5",children:le}),{mode:G}=n,z=![M.Alkkagi,M.Curling,M.Dice].includes(G),H=![M.Capture,M.Omok,M.Ttamok,M.Alkkagi,M.Curling,M.Dice,M.Thief,M.Base].includes(G),ne=![M.Alkkagi,M.Curling,M.Dice,M.Thief].includes(G),oe=G===M.Speed||G===M.Mix&&!!((je=i.mixedModes)!=null&&je.includes(M.Speed)),me=G===M.Capture,ve=G===M.Ttamok,J=G===M.Omok||G===M.Ttamok,fe=G===M.Base,ye=G===M.Hidden,K=G===M.Missile,W=G===M.Mix,D=G===M.Dice,V=G===M.Alkkagi,Y=G===M.Curling,ie=b;return t.jsx(be,{title:A,windowId:"negotiation",onClose:g,initialWidth:600,closeOnOutsideClick:!1,isTopmost:a,children:t.jsxs("div",{onMouseDown:E=>E.stopPropagation(),className:"text-sm",children:[t.jsxs("p",{className:"text-center text-yellow-300 mb-4",children:[O()," ",t.jsx(Ay,{deadline:n.deadline})]}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx("div",{className:"bg-gray-900/50 p-2 md:p-4 rounded-lg border border-gray-700",children:t.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[t.jsx(Ce,{userId:v.id,userName:v.nickname,avatarUrl:j,borderUrl:w,size:48}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("h3",{className:"text-xl font-bold",children:v.nickname}),t.jsxs("p",{className:"text-sm text-gray-400",children:[x.levelLabel," Lv.",x.level]})]}),t.jsxs("div",{className:"text-right text-sm",children:[t.jsxs("p",{className:"font-semibold",children:[x.wins," ",x.losses," (",x.winRate,"%)"]}),t.jsxs("p",{className:"text-gray-300",children:[": ",x.mannerScore,""]})]})]})}),t.jsxs("div",{className:"space-y-3 max-h-[calc(60vh - 12rem)] overflow-y-auto pr-2",children:[z&&t.jsx($e,{label:" ",children:t.jsx(U,{value:i.boardSize,onChange:E=>S("boardSize",parseInt(E,10)),disabled:q,children:(n.mode===M.Omok||n.mode===M.Ttamok?$d:n.mode===M.Capture?Od:n.mode===M.Speed?Dd:n.mode===M.Hidden?qd:n.mode===M.Thief?Ud:n.mode===M.Missile?zd:Ld).map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),H&&t.jsx($e,{label:" ()",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"number",step:"1",value:Math.floor(i.komi),onChange:E=>S("komi",parseInt(E.target.value,10)+.5),disabled:q,className:"w-full bg-gray-700 border border-gray-600 text-white text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2.5"}),t.jsx("span",{className:"font-bold text-lg text-gray-300 whitespace-nowrap",children:".5 "})]})}),ie&&(n.mode===M.Thief?t.jsx($e,{label:" ",children:t.jsxs(U,{value:i.player1Color,onChange:E=>S("player1Color",parseInt(E,10)),disabled:q,children:[t.jsx("option",{value:$.Black,children:"()"}),t.jsx("option",{value:$.White,children:"()"})]})}):t.jsx($e,{label:"  ",children:t.jsxs(U,{value:i.player1Color,onChange:E=>S("player1Color",parseInt(E,10)),disabled:q,children:[t.jsx("option",{value:$.Black,children:""}),t.jsx("option",{value:$.White,children:""})]})})),ne&&(oe?t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx(U,{value:i.timeLimit,onChange:E=>S("timeLimit",parseInt(E)),disabled:q,children:Dh.map(E=>t.jsx("option",{value:E.value,children:E.label},E.value))})}),t.jsxs($e,{label:" ",children:[" ",t.jsxs("p",{className:"text-sm text-gray-300",children:[zh," ( )"]})," "]})]}):t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx(U,{value:i.timeLimit,onChange:E=>S("timeLimit",parseInt(E)),disabled:q,children:Oh.map(E=>t.jsx("option",{value:E.value,children:E.label},E.value))})}),t.jsx($e,{label:"",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(U,{value:i.byoyomiTime,onChange:E=>S("byoyomiTime",parseInt(E)),disabled:q,children:Uh.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))}),t.jsx(U,{value:i.byoyomiCount,onChange:E=>S("byoyomiCount",parseInt(E)),disabled:q,children:qh.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})]})})]})),D&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx(U,{value:i.diceGoRounds??3,onChange:E=>S("diceGoRounds",parseInt(E,10)),disabled:q,children:[1,2,3].map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.oddDiceCount??1,onChange:E=>S("oddDiceCount",parseInt(E,10)),disabled:q,children:Vd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.evenDiceCount??1,onChange:E=>S("evenDiceCount",parseInt(E,10)),disabled:q,children:Vd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})})]}),me&&t.jsx($e,{label:" ",children:t.jsx(U,{value:i.captureTarget,onChange:E=>S("captureTarget",parseInt(E)),disabled:q,children:Fd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),ve&&t.jsx($e,{label:" ",children:t.jsx(U,{value:i.captureTarget,onChange:E=>S("captureTarget",parseInt(E)),disabled:q,children:$h.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),J&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx("input",{type:"checkbox",checked:i.has33Forbidden,onChange:E=>S("has33Forbidden",E.target.checked),disabled:q,className:"w-5 h-5"})}),t.jsx($e,{label:" ",children:t.jsx("input",{type:"checkbox",checked:i.hasOverlineForbidden,onChange:E=>S("hasOverlineForbidden",E.target.checked),disabled:q,className:"w-5 h-5"})})]}),fe&&t.jsx($e,{label:" ",children:t.jsx(U,{value:i.baseStones,onChange:E=>S("baseStones",parseInt(E)),disabled:q,children:bi.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),ye&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",children:t.jsx(U,{value:i.hiddenStoneCount,onChange:E=>S("hiddenStoneCount",parseInt(E)),disabled:q,children:Gd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.scanCount,onChange:E=>S("scanCount",parseInt(E)),disabled:q,children:Wd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})})]}),K&&t.jsx($e,{label:" ",children:t.jsx(U,{value:i.missileCount,onChange:E=>S("missileCount",parseInt(E)),disabled:q,children:Hd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),W&&(()=>{var le,ae,de,te,pe,we;const E=(le=i.mixedModes)==null?void 0:le.includes(M.Base),Z=(ae=i.mixedModes)==null?void 0:ae.includes(M.Capture);return t.jsxs("div",{className:"col-span-2 pt-2 border-t border-gray-700",children:[t.jsx("h3",{className:"font-semibold text-gray-300 mb-2",children:"  (2  )"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:at.filter(ue=>ue.mode!==M.Standard&&ue.mode!==M.Mix).map(ue=>{var qe;const Se=ue.mode===M.Base&&Z||ue.mode===M.Capture&&E;return t.jsxs("label",{className:`flex items-center gap-2 p-2 bg-gray-700/50 rounded-md ${q||Se?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:[t.jsx("input",{type:"checkbox",checked:(qe=i.mixedModes)==null?void 0:qe.includes(ue.mode),onChange:Be=>P(ue.mode,Be.target.checked),disabled:q||Se,className:"w-4 h-4"}),t.jsx("span",{children:ue.mode})]},ue.mode)})}),((de=i.mixedModes)==null?void 0:de.includes(M.Base))&&t.jsx($e,{label:" ",className:"mt-4",children:t.jsx(U,{value:i.baseStones,onChange:ue=>S("baseStones",parseInt(ue)),disabled:q,children:bi.map(ue=>t.jsxs("option",{value:ue,children:[ue,""]},ue))})}),((te=i.mixedModes)==null?void 0:te.includes(M.Hidden))&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:" ",className:"mt-2",children:t.jsx(U,{value:i.hiddenStoneCount,onChange:ue=>S("hiddenStoneCount",parseInt(ue)),disabled:q,children:Gd.map(ue=>t.jsxs("option",{value:ue,children:[ue,""]},ue))})}),t.jsx($e,{label:" ",className:"mt-2",children:t.jsx(U,{value:i.scanCount,onChange:ue=>S("scanCount",parseInt(ue)),disabled:q,children:Wd.map(ue=>t.jsxs("option",{value:ue,children:[ue,""]},ue))})})]}),((pe=i.mixedModes)==null?void 0:pe.includes(M.Missile))&&t.jsx($e,{label:" ",className:"mt-2",children:t.jsx(U,{value:i.missileCount,onChange:ue=>S("missileCount",parseInt(ue)),disabled:q,children:Hd.map(ue=>t.jsxs("option",{value:ue,children:[ue,""]},ue))})}),((we=i.mixedModes)==null?void 0:we.includes(M.Capture))&&t.jsx($e,{label:" ",className:"mt-2",children:t.jsx(U,{value:i.captureTarget,onChange:ue=>S("captureTarget",parseInt(ue)),disabled:q,children:Fd.map(ue=>t.jsxs("option",{value:ue,children:[ue,""]},ue))})})]})})(),V&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:"",children:t.jsx(U,{value:i.alkkagiRounds,onChange:E=>S("alkkagiRounds",parseInt(E)),disabled:q,children:Fh.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.alkkagiPlacementType,onChange:E=>S("alkkagiPlacementType",E),disabled:q,children:Object.values(ga).map(E=>t.jsx("option",{value:E,children:E},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.alkkagiLayout,onChange:E=>S("alkkagiLayout",E),disabled:q,children:Object.values(el).map(E=>t.jsx("option",{value:E,children:E},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.alkkagiStoneCount,onChange:E=>S("alkkagiStoneCount",parseInt(E)),disabled:q,children:Xd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.alkkagiGaugeSpeed,onChange:E=>S("alkkagiGaugeSpeed",parseInt(E)),disabled:q,children:No.map(E=>t.jsx("option",{value:E.value,children:E.label},E.value))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.alkkagiSlowItemCount,onChange:E=>S("alkkagiSlowItemCount",parseInt(E)),disabled:q,children:Kd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.alkkagiAimingLineItemCount,onChange:E=>S("alkkagiAimingLineItemCount",parseInt(E)),disabled:q,children:Kd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})})]}),Y&&t.jsxs(t.Fragment,{children:[t.jsx($e,{label:"",children:t.jsx(U,{value:i.curlingRounds,onChange:E=>S("curlingRounds",parseInt(E)),disabled:q,children:Gh.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.curlingStoneCount,onChange:E=>S("curlingStoneCount",parseInt(E)),disabled:q,children:eu.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.curlingGaugeSpeed,onChange:E=>S("curlingGaugeSpeed",parseInt(E)),disabled:q,children:ko.map(E=>t.jsx("option",{value:E.value,children:E.label},E.value))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.curlingSlowItemCount,onChange:E=>S("curlingSlowItemCount",parseInt(E)),disabled:q,children:Qd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})}),t.jsx($e,{label:" ",children:t.jsx(U,{value:i.curlingAimingLineItemCount,onChange:E=>S("curlingAimingLineItemCount",parseInt(E)),disabled:q,children:Qd.map(E=>t.jsxs("option",{value:E,children:[E,""]},E))})})]})]})]}),t.jsx("div",{className:"mt-6 border-t border-gray-700 pt-6",children:Q()})]})})},By=(e,n)=>{if(e.isTopmost!==n.isTopmost||JSON.stringify(e.negotiation)!==JSON.stringify(n.negotiation)||JSON.stringify(e.currentUser)!==JSON.stringify(n.currentUser))return!1;const l=(i=>(i.negotiation.challenger.id===i.currentUser.id?i.negotiation.opponent:i.negotiation.challenger).id)(e),r=e.onlineUsers.find(i=>i.id===l),a=n.onlineUsers.find(i=>i.id===l);return JSON.stringify(r)===JSON.stringify(a)},Cx=Pn.memo(Ry,By),Ly=({pos:e})=>t.jsx("div",{className:`w-[22%] h-[22%] bg-black rounded-full absolute ${e}`}),$y=({value:e})=>{var s;const n={1:["top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"],2:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],3:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],4:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/4 right-1/4 translate-x-1/2 -translate-y-1/2","bottom-1/4 left-1/4 -translate-x-1/2 translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],5:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/4 right-1/4 translate-x-1/2 -translate-y-1/2","top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","bottom-1/4 left-1/4 -translate-x-1/2 translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"],6:["top-1/4 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/4 right-1/4 translate-x-1/2 -translate-y-1/2","top-1/2 left-1/4 -translate-x-1/2 -translate-y-1/2","top-1/2 right-1/4 translate-x-1/2 -translate-y-1/2","bottom-1/4 left-1/4 -translate-x-1/2 translate-y-1/2","bottom-1/4 right-1/4 translate-x-1/2 translate-y-1/2"]};return t.jsx("div",{className:"w-full h-full relative",children:(s=n[e])==null?void 0:s.map((l,r)=>t.jsx(Ly,{pos:l},r))})},Yn=({value:e,isRolling:n,sides:s=6,size:l=60,onClick:r,disabled:a=!1,displayText:i,color:o="gray"})=>{const[c,d]=f.useState(e||1),u=!a&&!n&&r;f.useEffect(()=>{let m;return n?m=window.setInterval(()=>{d(Math.floor(Math.random()*s)+1)},50):d(e||1),()=>{m&&clearInterval(m)}},[n,e,s]);const p={gray:"bg-gray-100 hover:bg-white text-black",blue:"bg-blue-400 hover:bg-blue-300 text-white",yellow:"bg-yellow-400 hover:bg-yellow-300 text-black"};return t.jsx("div",{onClick:u?r:void 0,className:`flex items-center justify-center rounded-lg shadow-md transition-all duration-200 p-1
                ${u?`cursor-pointer hover:shadow-lg hover:-translate-y-1 ${p[o]}`:`${p[o]}`}
                ${a?"opacity-60 cursor-not-allowed":""}
                ${n?"animate-dice-flicker":""}`,style:{width:l,height:l},children:i?t.jsx("span",{className:"select-none font-bold",style:{fontSize:l*.5},children:i}):t.jsx($y,{value:c})})},Oy=e=>{var I,T,B,R,A,L;const{session:n,currentUser:s,onAction:l}=e,{id:r,player1:a,player2:i,gameStatus:o,turnOrderRollReady:c,animation:d}=n,[u,p]=f.useState(Hh),m=s.id===a.id?i:a;f.useEffect(()=>{let Q;const q=o==="dice_turn_rolling"?n.turnOrderRollDeadline:o==="dice_turn_choice"?n.turnChoiceDeadline:null;if(q){const O=()=>{const U=Math.max(0,Math.ceil((q-Date.now())/1e3));p(U)};O(),Q=window.setInterval(O,1e3)}return()=>{Q&&clearInterval(Q)}},[o,n.turnOrderRollDeadline,n.turnChoiceDeadline]);const h=c==null?void 0:c[s.id],y=(d==null?void 0:d.type)==="dice_roll_turn"?d:null,v=o==="dice_turn_rolling_animating",b=!!(n.turnOrderRolls&&n.turnOrderRolls[s.id]!=null),g=o==="dice_turn_choice"||!!y&&!v,x=y?s.id===a.id?y.p1Roll:y.p2Roll:(I=n.turnOrderRolls)==null?void 0:I[s.id],j=y?m.id===a.id?y.p1Roll:y.p2Roll:(T=n.turnOrderRolls)==null?void 0:T[m.id];let w="",k="";g&&x!=null&&j!=null&&(x>j?(w="!",k="text-green-400"):x<j?(w="!",k="text-red-400"):(w="!",k="text-yellow-400"));const C=(B=Te.find(Q=>Q.id===s.avatarId))==null?void 0:B.url,S=(R=Re.find(Q=>Q.id===s.borderId))==null?void 0:R.url,P=(A=Te.find(Q=>Q.id===m.avatarId))==null?void 0:A.url,_=(L=Re.find(Q=>Q.id===m.borderId))==null?void 0:L.url;return t.jsx(be,{title:"/ ",windowId:"dice-go-turn-selection",children:t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-gray-300 mb-6",children:"    .     / ."}),n.turnOrderRollResult==="tie"&&t.jsx("p",{className:"text-yellow-400 font-bold text-lg mb-4 animate-pulse",children:"!    ."}),t.jsxs("div",{className:"flex justify-around w-full items-center my-4",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2 w-24",children:[t.jsx(Ce,{userId:s.id,userName:s.nickname,size:64,avatarUrl:C,borderUrl:S}),t.jsx("span",{className:"font-semibold",children:s.nickname}),(h||y||b)&&t.jsx(Yn,{value:g?x??null:null,isRolling:v,sides:6,size:64})]}),g&&x!=null&&j!=null?t.jsxs("div",{className:"text-4xl font-bold",children:[x," : ",j]}):t.jsx("span",{className:"text-3xl font-bold",children:"VS"}),t.jsxs("div",{className:"flex flex-col items-center gap-2 w-24",children:[t.jsx(Ce,{userId:m.id,userName:m.nickname,size:64,avatarUrl:P,borderUrl:_}),t.jsx("span",{className:"font-semibold",children:m.nickname}),((c==null?void 0:c[m.id])||y||b)&&t.jsx(Yn,{value:g?j??null:null,isRolling:v,sides:6,size:64})]})]}),t.jsx("div",{className:"min-h-[6rem] mt-6 text-xl font-bold flex items-center justify-center",children:o==="dice_turn_choice"?n.turnChooserId===s.id?t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsxs("p",{className:"text-base font-normal text-gray-300 mb-2",children:["   . (",u,")"]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx(F,{onClick:()=>l({type:"DICE_CHOOSE_TURN",payload:{gameId:r,choice:"first"}}),colorScheme:"blue",children:" ()"}),t.jsx(F,{onClick:()=>l({type:"DICE_CHOOSE_TURN",payload:{gameId:r,choice:"second"}}),colorScheme:"gray",children:" ()"})]})]}):t.jsx("p",{className:"text-base text-green-400 animate-pulse",children:" /  ..."}):g&&w?t.jsx("p",{className:k,children:w}):!h&&!y?t.jsxs(F,{onClick:()=>l({type:"DICE_READY_FOR_TURN_ROLL",payload:{gameId:r}}),colorScheme:"blue",children:[" (",u,")"]}):h&&!y?t.jsx("p",{className:"text-base text-green-400 animate-pulse",children:"  ..."}):v?t.jsx("p",{className:"text-base text-gray-400 animate-pulse",children:" ..."}):null})]})})},Dy=({session:e})=>{const{boardState:n,baseStones:s,settings:{boardSize:l}}=e,r=300,a=r/l,i=a/2,o=a*.47,c=o*2*.7,d=c/2,u=p=>({cx:i+p.x*a,cy:i+p.y*a});return t.jsxs("svg",{viewBox:`0 0 ${r} ${r}`,className:"w-full h-full bg-[#e0b484] rounded-md shadow-inner",children:[Array.from({length:l}).map((p,m)=>t.jsxs("g",{children:[t.jsx("line",{x1:i+m*a,y1:i,x2:i+m*a,y2:r-i,stroke:"#54432a",strokeWidth:"1"}),t.jsx("line",{x1:i,y1:i+m*a,x2:r-i,y2:i+m*a,stroke:"#54432a",strokeWidth:"1"})]},m)),s==null?void 0:s.map((p,m)=>{const{cx:h,cy:y}=u(p);return t.jsxs("g",{children:[t.jsx("circle",{cx:h,cy:y,r:o,fill:p.player===$.Black?"#111827":"#f5f2e8"}),t.jsx("image",{href:p.player===$.Black?Da:Oa,x:h-d,y:y-d,width:c,height:c})]},`base-stone-${m}`)})]})},qy=({session:e,currentUser:n,onAction:s})=>{var w,k,C,S;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d,finalKomi:u}=e,p=c==null?void 0:c[n.id],[m,h]=f.useState(20);if(f.useEffect(()=>{const P=d||Date.now()+2e4,_=setInterval(()=>{const I=Math.max(0,Math.ceil((P-Date.now())/1e3));h(I)},1e3);return()=>clearInterval(_)},[d]),!i||!o)return null;const y=r.id===i?r:a,v=r.id===o?r:a,b=(w=Te.find(P=>P.id===y.avatarId))==null?void 0:w.url,g=(k=Re.find(P=>P.id===y.borderId))==null?void 0:k.url,x=(C=Te.find(P=>P.id===v.avatarId))==null?void 0:C.url,j=(S=Re.find(P=>P.id===v.borderId))==null?void 0:S.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"base-start-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:"/ .     20   ."}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:b,borderUrl:g}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:v.id,userName:v.nickname,size:64,avatarUrl:x,borderUrl:j}),t.jsx("p",{className:"mt-2 font-bold",children:v.nickname}),t.jsxs("p",{className:"font-semibold",children:[" (: ",u,")"]})]})]}),t.jsx("div",{className:"my-4 mx-auto w-full max-w-xs",children:t.jsx(Dy,{session:e})}),t.jsx(F,{onClick:()=>s({type:"CONFIRM_BASE_REVEAL",payload:{gameId:l}}),disabled:!!p,className:"w-full py-3",children:p?"   ...":`  (${m})`})]})})},Uy=({session:e,currentUser:n,onAction:s})=>{var T,B,R,A;const{id:l,alkkagiRoundSummary:r,player1:a,player2:i,roundEndConfirmations:o,revealEndTime:c,alkkagiStones:d}=e,[u,p]=f.useState(30),m=!!(o!=null&&o[n.id]);if(f.useEffect(()=>{const L=c||Date.now()+3e4,Q=setInterval(()=>{const q=Math.max(0,Math.ceil((L-Date.now())/1e3));p(q)},1e3);return()=>clearInterval(Q)},[c]),!r)return null;const{round:h,winnerId:y}=r,v=a.id===y?a:i,b=a.id===e.blackPlayerId?$.Black:$.White,g=i.id===e.blackPlayerId?$.Black:$.White,x=(d==null?void 0:d.filter(L=>L.player===b&&L.onBoard).length)??0,j=(d==null?void 0:d.filter(L=>L.player===g&&L.onBoard).length)??0,w=(T=Te.find(L=>L.id===a.avatarId))==null?void 0:T.url,k=(B=Re.find(L=>L.id===a.borderId))==null?void 0:B.url,C=(R=Te.find(L=>L.id===i.avatarId))==null?void 0:R.url,S=(A=Re.find(L=>L.id===i.borderId))==null?void 0:A.url,P=h+1,_=e.settings.alkkagiRounds||1;let I="        .";return P>_&&(I="  .   ."),t.jsx(be,{title:`${h}  `,initialWidth:550,windowId:"alkkari-round-summary",children:t.jsxs("div",{className:"text-white text-center",children:[t.jsxs("h2",{className:"text-2xl font-bold mb-2",children:[v.nickname,"  !"]}),t.jsx("p",{className:"text-gray-300 mb-6",children:I}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 my-6",children:[t.jsxs("div",{className:"flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border-2 border-gray-600",children:[t.jsx(Ce,{userId:a.id,userName:a.nickname,size:80,avatarUrl:w,borderUrl:k}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:a.nickname}),t.jsxs("p",{className:"text-lg font-semibold",children:[" : ",x,""]})]}),t.jsxs("div",{className:"flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border-2 border-gray-600",children:[t.jsx(Ce,{userId:i.id,userName:i.nickname,size:80,avatarUrl:C,borderUrl:S}),t.jsx("p",{className:"mt-2 text-xl font-bold",children:i.nickname}),t.jsxs("p",{className:"text-lg font-semibold",children:[" : ",j,""]})]})]}),t.jsx(F,{onClick:()=>s({type:"CONFIRM_ROUND_END",payload:{gameId:l}}),disabled:!!m,className:"w-full py-3",children:m?"   ...":`${P>_?"  ":"  "} (${u})`})]})})},zy=({session:e,currentUser:n,onAction:s})=>{var S,P,_,I;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d,turnOrderRolls:u}=e,p=c==null?void 0:c[n.id],[m,h]=f.useState(10);if(f.useEffect(()=>{const T=d||Date.now()+1e4,B=setInterval(()=>{const R=Math.max(0,Math.ceil((T-Date.now())/1e3));h(R)},1e3);return()=>clearInterval(B)},[d]),!i||!o)return null;const y=r.id===i?r:a,v=r.id===o?r:a;n.id;const b=(u==null?void 0:u[r.id])??null,g=(u==null?void 0:u[a.id])??null,x=b!==null&&g!==null&&b>g?r:a,j=(S=Te.find(T=>T.id===y.avatarId))==null?void 0:S.url,w=(P=Re.find(T=>T.id===y.borderId))==null?void 0:P.url,k=(_=Te.find(T=>T.id===v.avatarId))==null?void 0:_.url,C=(I=Re.find(T=>T.id===v.borderId))==null?void 0:I.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"dice-go-start-confirm",children:t.jsxs("div",{className:"text-white",children:[b!==null&&g!==null&&t.jsxs("p",{className:"text-center text-gray-300 mb-2",children:["  ",t.jsx("span",{className:"font-bold text-yellow-300",children:x.nickname}),"  / ."]}),t.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm",children:"    10    ."}),b!==null&&g!==null&&t.jsxs("div",{className:"flex justify-around items-center my-4 bg-gray-900/50 p-3 rounded-lg",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(Ce,{userId:r.id,userName:r.nickname,size:48}),t.jsx("span",{className:"font-semibold text-sm",children:r.nickname}),t.jsx(Yn,{value:b,isRolling:!1,size:48})]}),t.jsx("span",{className:"text-2xl font-bold",children:"VS"}),t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx(Ce,{userId:a.id,userName:a.nickname,size:48}),t.jsx("span",{className:"font-semibold text-sm",children:a.nickname}),t.jsx(Yn,{value:g,isRolling:!1,size:48})]})]}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:j,borderUrl:w}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:v.id,userName:v.nickname,size:64,avatarUrl:k,borderUrl:C}),t.jsx("p",{className:"mt-2 font-bold",children:v.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]})]}),t.jsx(F,{onClick:()=>s({type:"DICE_CONFIRM_START",payload:{gameId:l}}),disabled:!!p,className:"w-full py-3 mt-6",children:p?"   ...":`  (${m})`})]})})},Fy=({session:e,currentUser:n,onAction:s})=>{var _,I,T,B,R;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d}=e,u=c==null?void 0:c[n.id],[p,m]=f.useState(30);if(f.useEffect(()=>{const A=d||Date.now()+3e4,L=setInterval(()=>{const Q=Math.max(0,Math.ceil((A-Date.now())/1e3));m(Q)},1e3);return()=>clearInterval(L)},[d]),!i||!o)return null;const h=r.id===i?r:a,y=r.id===o?r:a,v=e.rpsState&&Object.values(e.rpsState).every(A=>A!==null),b=i===r.id?r.id:a.id,g=r.id===b?r:a,j=((_=e.turnChoices)==null?void 0:_[g.id])==="first"?"()":"()",w=v?`${g.nickname}   ${j}() .`:"/  .",k=(I=Te.find(A=>A.id===h.avatarId))==null?void 0:I.url,C=(T=Re.find(A=>A.id===h.borderId))==null?void 0:T.url,S=(B=Te.find(A=>A.id===y.avatarId))==null?void 0:B.url,P=(R=Re.find(A=>A.id===y.borderId))==null?void 0:R.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"curling-start-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:w}),t.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm",children:"    30    ."}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:h.id,userName:h.nickname,size:64,avatarUrl:k,borderUrl:C}),t.jsx("p",{className:"mt-2 font-bold",children:h.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:S,borderUrl:P}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]})]}),t.jsx(F,{onClick:()=>s({type:"CONFIRM_CURLING_START",payload:{gameId:l}}),disabled:!!u,className:"w-full py-3 mt-6",children:u?"   ...":`  (${p})`})]})})},Gy=({session:e,currentUser:n,onAction:s})=>{var C,S,P,_;const{id:l,player1:r,player2:a,blackPlayerId:i,whitePlayerId:o,preGameConfirmations:c,revealEndTime:d}=e,u=c==null?void 0:c[n.id],[p,m]=f.useState(30);if(f.useEffect(()=>{const I=d||Date.now()+3e4,T=setInterval(()=>{const B=Math.max(0,Math.ceil((I-Date.now())/1e3));m(B)},1e3);return()=>clearInterval(T)},[d]),!i||!o)return null;const h=r.id===i?r:a,y=r.id===o?r:a,v=e.rpsState&&Object.values(e.rpsState).every(I=>I!==null),b=i===r.id?r:a,g=v?`${b.nickname}   () .`:"/  .",x=(C=Te.find(I=>I.id===h.avatarId))==null?void 0:C.url,j=(S=Re.find(I=>I.id===h.borderId))==null?void 0:S.url,w=(P=Te.find(I=>I.id===y.avatarId))==null?void 0:P.url,k=(_=Re.find(I=>I.id===y.borderId))==null?void 0:_.url;return t.jsx(be,{title:"  ",initialWidth:600,windowId:"alkkagi-start-confirm",children:t.jsxs("div",{className:"text-white",children:[t.jsx("p",{className:"text-center text-gray-300 mb-4",children:g}),t.jsx("p",{className:"text-center text-gray-400 mb-4 text-sm",children:"    30    ."}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:h.id,userName:h.nickname,size:64,avatarUrl:x,borderUrl:j}),t.jsx("p",{className:"mt-2 font-bold",children:h.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]}),t.jsxs("div",{className:"w-1/2 flex flex-col items-center p-4 bg-gray-900/50 rounded-lg border border-gray-700",children:[t.jsx(Ce,{userId:y.id,userName:y.nickname,size:64,avatarUrl:w,borderUrl:k}),t.jsx("p",{className:"mt-2 font-bold",children:y.nickname}),t.jsx("p",{className:"font-semibold",children:" ()"})]})]}),t.jsx(F,{onClick:()=>s({type:"CONFIRM_ALKKAGI_START",payload:{gameId:l}}),disabled:!!u,className:"w-full py-3 mt-6",children:u?"   ...":`  (${p})`})]})})},Wy=({item:e})=>t.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-1 bg-gray-900/50 rounded-md",title:e.name,children:[t.jsx("img",{src:e.image,alt:e.name,className:"w-12 h-12 object-contain"}),t.jsxs("span",{className:"text-xs mt-1 text-gray-300 truncate w-full",children:[e.name,e.quantity>1?` x${e.quantity}`:""]})]}),Hy=({session:e,currentUser:n,onAction:s,onClose:l})=>{var m,h,y;const r=e.winner===$.Black,a=(m=e.summary)==null?void 0:m[n.id],i=Jl.findIndex(v=>v.id===e.stageId),o=Jl[i+1],c=r&&o&&(n.singlePlayerProgress??0)>i,d=()=>{s({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:e.stageId}}),l()},u=()=>{c&&(s({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:o.id}}),l())},p=()=>{sessionStorage.setItem("postGameRedirect","#/singleplayer"),s({type:"LEAVE_AI_GAME",payload:{gameId:e.id}}),l()};return t.jsx(be,{title:r?" ":" ",onClose:l,windowId:"sp-summary-redesigned",initialWidth:500,children:t.jsxs("div",{className:`relative text-center p-4 rounded-lg overflow-hidden ${r?"bg-gradient-to-br from-blue-900/50 to-gray-900":"bg-gradient-to-br from-red-900/50 to-gray-900"}`,children:[r&&t.jsx("div",{className:"absolute -top-1/2 -left-1/4 w-full h-full bg-yellow-400/20 rounded-full blur-3xl animate-pulse"}),t.jsx("h1",{className:`text-5xl font-black mb-4 tracking-widest ${r?"text-yellow-300":"text-red-400"}`,style:{textShadow:r?"0 0 15px rgba(250, 204, 21, 0.5)":"0 0 10px rgba(220, 38, 38, 0.5)"},children:r?"MISSION CLEAR":"MISSION FAILED"}),a&&t.jsxs("div",{className:"bg-black/30 backdrop-blur-sm p-4 rounded-lg my-4 space-y-3 border border-gray-700/50",children:[t.jsx("h2",{className:"font-bold text-lg text-gray-200",children:""}),t.jsxs("div",{className:"flex justify-center items-center gap-6 text-lg",children:[a.xp&&a.xp.change>0&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-400",children:" "}),t.jsxs("p",{className:"font-bold text-green-400 sparkle-animation",children:["+",a.xp.change," XP"]})]}),a.gold&&a.gold>0&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-8 h-8"}),t.jsxs("span",{className:"font-bold text-yellow-400 sparkle-animation",children:["+",a.gold.toLocaleString()]})]})]}),a.items&&a.items.length>0&&t.jsxs("div",{className:"pt-3 border-t border-gray-700/50",children:[t.jsx("h3",{className:"text-sm text-gray-400 mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-5 gap-2",children:a.items.map(v=>t.jsx(Wy,{item:v},v.id))})]}),!r&&(!a||a.gold===0&&((h=a.xp)==null?void 0:h.change)===0&&((y=a.items)==null?void 0:y.length)===0)&&t.jsx("p",{className:"text-gray-500",children:"  ."})]}),t.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[t.jsx(F,{onClick:p,colorScheme:"gray",className:"w-full",children:""}),t.jsx(F,{onClick:d,colorScheme:"yellow",className:"w-full",children:""}),t.jsxs(F,{onClick:u,colorScheme:"blue",className:"w-full",disabled:!c,children:[" ",o?`: ${o.name.replace(" ","")}`:""]}),t.jsx(F,{onClick:l,colorScheme:"green",className:"w-full",children:""})]})]})})},Tu=e=>{const{session:n,currentUser:s,onAction:l,confirmModalType:r,onHideConfirmModal:a,showResultModal:i,onCloseResults:o,isSpectator:c,activeNegotiation:d,onlineUsers:u,onViewUser:p}=e,{gameStatus:m,mode:h,id:y}=n,v=()=>{if(d)return t.jsx(Cx,{negotiation:d,currentUser:s,onAction:l,onlineUsers:u});if(n.isSinglePlayer&&i)return t.jsx(Hy,{session:n,currentUser:s,onAction:l,onClose:o});if(c&&["nigiri_choosing","nigiri_guessing","base_placement","komi_bidding","capture_bidding","dice_rps","thief_rps","alkkagi_rps","curling_rps","omok_rps","ttamok_rps","turn_preference_selection","thief_role_selection","alkkagi_simultaneous_placement","dice_turn_rolling"].includes(m))return null;const j=["dice_rps","dice_rps_reveal","thief_rps","thief_rps_reveal","alkkagi_rps","alkkagi_rps_reveal","curling_rps","curling_rps_reveal","omok_rps","omok_rps_reveal","ttamok_rps","ttamok_rps_reveal"];if(m==="dice_turn_rolling"||m==="dice_turn_rolling_animating"||m==="dice_turn_choice")return t.jsx(Oy,{session:n,currentUser:s,onAction:l});if(m==="dice_start_confirmation")return t.jsx(zy,{session:n,currentUser:s,onAction:l});if(m==="turn_preference_selection")return t.jsx(ky,{session:n,currentUser:s,onAction:l,tiebreaker:n.turnSelectionTiebreaker});if(["nigiri_choosing","nigiri_guessing","nigiri_reveal"].includes(m))return t.jsx(hy,{session:n,currentUser:s,onAction:l});if(m==="capture_bidding")return t.jsx(yy,{session:n,currentUser:s,onAction:l});if(["capture_tiebreaker","capture_reveal"].includes(m))return t.jsx(by,{session:n,currentUser:s,onAction:l});if(m==="base_placement")return t.jsx(Py,{session:n,currentUser:s,onAction:l});if(["komi_bidding","komi_bid_reveal"].includes(m))return t.jsx(My,{session:n,currentUser:s,onAction:l});if(m==="base_game_start_confirmation")return t.jsx(qy,{session:n,currentUser:s,onAction:l});if(j.includes(m))return t.jsx(jy,{session:n,currentUser:s,onAction:l});if(m==="alkkagi_start_confirmation")return t.jsx(Gy,{session:n,currentUser:s,onAction:l});if(m==="curling_start_confirmation")return t.jsx(Fy,{session:n,currentUser:s,onAction:l});if(m==="thief_role_selection")return t.jsx(wy,{session:n,currentUser:s,onAction:l});if(m==="thief_role_confirmed")return t.jsx(Ny,{session:n,currentUser:s,onAction:l});if(m==="thief_round_end")return t.jsx(Cy,{session:n,currentUser:s,onAction:l});if(m==="curling_round_end")return t.jsx(Iy,{session:n,currentUser:s,onAction:l});if(m==="alkkagi_round_end")return t.jsx(Uy,{session:n,currentUser:s,onAction:l});if(m==="dice_round_end")return t.jsx(Ey,{session:n,currentUser:s,onAction:l});if(m==="alkkagi_simultaneous_placement")return t.jsx(_y,{session:n,currentUser:s});if(i){if(m==="ended")return t.jsx(gy,{session:n,currentUser:s,onConfirm:o});if(m==="no_contest")return t.jsx(Sy,{session:n,currentUser:s,onConfirm:o})}return null},g=r?{resign:{title:" ",message:" ?  .",confirmText:"",onConfirm:()=>l({type:"RESIGN_GAME",payload:{gameId:y}})}}[r]:null;return t.jsxs(t.Fragment,{children:[v(),g&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm p-6 border border-gray-700",children:[t.jsx("h2",{className:"text-xl font-bold text-center mb-4",children:g.title}),t.jsx("p",{className:"text-center text-gray-300 mb-6",children:g.message}),t.jsxs("div",{className:"flex gap-4 mt-4",children:[t.jsx(F,{onClick:a,colorScheme:"gray",className:"w-full",children:""}),t.jsx(F,{onClick:()=>{a(),g.onConfirm()},colorScheme:"red",className:"w-full",children:g.confirmText})]})]})})]})};function Mu(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const Vy=e=>{const{gameStatus:n,currentPlayer:s,blackPlayerId:l,whitePlayerId:r,player1:a,player2:i,mode:o,settings:c,passCount:d,moveHistory:u,alkkagiRound:p}=e,m=v=>{const b=v===$.Black?l:r;return b?a.id===b?a:i:null},h=m(s);if(e.mode===M.Dice&&e.lastWhiteGroupInfo&&e.lastWhiteGroupInfo.liberties<=6){const v=e.settings.diceGoRounds??1;let b=` !  ${e.lastWhiteGroupInfo.liberties}`;if(e.round===v&&v>0){const g=Wh[v-1];g&&(b+=` (   +${g})`)}return b}const y=u.length>0?u[u.length-1]:null;if(d>=2&&(y==null?void 0:y.x)===-1)return"    .";if(n!=="ended"&&d===1&&(y==null?void 0:y.x)===-1){const v=s===$.Black?$.White:$.Black,b=m(v);if(b)return`${b.nickname} .`}switch(n){case"playing":return h?`${h.nickname} .`:"  ";case"nigiri_choosing":case"nigiri_guessing":case"nigiri_reveal":return"   ...";case"base_placement":return`  ... (${c.baseStones})`;case"komi_bidding":return"  ...";case"ended":return" ";case"no_contest":return" ";case"rematch_pending":return"  ...";case"hidden_placing":case"scanning":case"missile_selecting":return"  ...";case"hidden_final_reveal":return"    .";case"alkkagi_placement":{const v=p||1,b=c.alkkagiRounds||1;return v>1?`  . (${v} / ${b} )`:` . (${v} / ${b} )`}case"alkkagi_playing":{const v=p||1,b=c.alkkagiRounds||1;return`${h==null?void 0:h.nickname} . (${v} / ${b} )`}case"alkkagi_round_end":return" !  .";case"dice_rolling":return h?`${h.nickname}   .`:"  ";case"thief_rolling":return h?`${h.nickname}   .`:"  ";case"curling_tiebreaker_preference_selection":case"curling_tiebreaker_rps":case"curling_tiebreaker_rps_reveal":return"   ...";case"curling_tiebreaker_playing":return`  ... (${h==null?void 0:h.nickname} )`;default:return o===M.Dice?`  (${e.round} / ${e.settings.diceGoRounds} )`:o===M.Thief?`  (${e.round} )`:h?`${h.nickname} .`:"  ..."}},_u=({session:e})=>{var b;const[n,s]=f.useState(30),[l,r]=f.useState(100),[a,i]=f.useState(null),o=Mu(e.lastTimeoutPlayerId),c=Mu((b=e.foulInfo)==null?void 0:b.message),d=f.useMemo(()=>St.some(g=>g.mode===e.mode)&&e.turnDeadline&&e.turnStartTime&&["dice_rolling","dice_placing","thief_rolling","thief_placing"].includes(e.gameStatus),[e.mode,e.turnDeadline,e.turnStartTime,e.gameStatus]);f.useEffect(()=>{if(!d){r(100);return}const g=e.turnDeadline-e.turnStartTime;if(g<=0)return;const x=()=>{const w=e.turnDeadline-Date.now(),k=Math.max(0,w/g*100);r(k)};x();const j=setInterval(x,100);return()=>clearInterval(j)},[d,e.turnDeadline,e.turnStartTime]),f.useEffect(()=>{if(e.foulInfo&&e.foulInfo.message!==c){i(e.foulInfo.message),Ee.timeoutFoul();const g=setTimeout(()=>i(null),5e3);return()=>clearTimeout(g)}},[e.foulInfo,c]),f.useEffect(()=>{if(e.lastTimeoutPlayerId&&e.lastTimeoutPlayerId!==o&&St.some(x=>x.mode===e.mode)){const x=e.player1.id===e.lastTimeoutPlayerId?e.player1:e.player2;i(`${x.nickname}  !`);const j=setTimeout(()=>i(null),5e3);return()=>clearTimeout(j)}},[e.lastTimeoutPlayerId,o,e.mode,e.player1,e.player2]),f.useEffect(()=>{["playing","ended","no_contest","alkkagi_playing","curling_playing","dice_rolling","dice_placing","thief_rolling","thief_placing"].includes(e.gameStatus)&&i(null)},[e.gameStatus]);const u=["hidden_placing","scanning","missile_selecting"].includes(e.gameStatus);f.useEffect(()=>{if(!u||!e.itemUseDeadline)return;const g=()=>{const j=Math.max(0,Math.ceil((e.itemUseDeadline-Date.now())/1e3));s(j)};g();const x=setInterval(g,500);return()=>clearInterval(x)},[u,e.itemUseDeadline]);const p=e.isSinglePlayer,m="flex-shrink-0 rounded-lg flex flex-col items-center justify-center shadow-inner py-1 h-12 border",h=p?"bg-stone-800/70 backdrop-blur-sm border-stone-700/50":"bg-secondary border-color",y=p?"text-amber-300":"text-highlight";if(a)return t.jsx("div",{className:"flex-shrink-0 bg-danger rounded-lg flex items-center justify-center shadow-inner animate-pulse py-1 h-12 border-2 border-red-500",children:t.jsx("p",{className:"font-bold text-white tracking-wider text-[clamp(0.875rem,3vmin,1.125rem)]",children:a})});if(e.mode===M.Dice&&e.gameStatus==="dice_placing"&&e.dice)return t.jsxs("div",{className:`${m} ${h} px-4 gap-1`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[": ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:e.dice.dice1})]}),t.jsx("div",{className:`w-px h-5 ${p?"bg-stone-600":"bg-border-color"}`}),t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[" : ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:e.stonesToPlace})]})]}),d&&t.jsx("div",{className:"w-full h-1 bg-tertiary rounded-full mt-1",children:t.jsx("div",{className:"h-1 bg-red-500 rounded-full",style:{width:`${l}%`}})})]});if(e.mode===M.Thief&&e.gameStatus==="thief_placing"&&e.dice){const{dice1:g,dice2:x}=e.dice,j=x>0?`${g}, ${x}`:`${g}`;return t.jsxs("div",{className:`${m} ${h} px-4 gap-2`,children:[t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[": ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:j})]}),t.jsx("div",{className:`w-px h-5 ${p?"bg-stone-600":"bg-border-color"}`}),t.jsxs("span",{className:"font-bold text-tertiary text-[clamp(0.8rem,2.5vmin,1rem)]",children:[" : ",t.jsx("span",{className:`${y} text-[clamp(0.9rem,3vmin,1.1rem)]`,children:e.stonesToPlace})]})]})}if(u){let g=" ";e.gameStatus==="hidden_placing"&&(g=" "),e.gameStatus==="scanning"&&(g=" "),e.gameStatus==="missile_selecting"&&(g=" ");const x=n/30*100;return t.jsxs("div",{className:`${m} ${h} px-4 gap-2`,children:[t.jsx("span",{className:`font-bold ${y} tracking-wider flex-shrink-0 text-[clamp(0.8rem,2.5vmin,1rem)]`,children:g}),t.jsx("div",{className:`w-full bg-tertiary rounded-full h-[clamp(0.5rem,1.5vh,0.75rem)] relative overflow-hidden border-2 ${p?"border-black/20":"border-tertiary"}`,children:t.jsx("div",{className:"absolute inset-0 bg-highlight rounded-full",style:{width:`${x}%`,transition:"width 0.5s linear"}})}),t.jsxs("span",{className:"font-mono font-bold text-primary w-[clamp(2rem,8vmin,2.5rem)] text-center text-[clamp(0.9rem,3vmin,1.1rem)]",children:[n,""]})]})}const v=Vy(e);return t.jsxs("div",{className:`${m} ${h}`,children:[t.jsx("p",{className:`font-bold ${y} tracking-wider text-[clamp(0.8rem,2.5vmin,1rem)] text-center px-2`,children:v}),d&&t.jsx("div",{className:"w-11/12 h-1 bg-tertiary rounded-full mt-1",children:t.jsx("div",{className:"h-1 bg-red-500 rounded-full",style:{width:`${l}%`}})})]})},Ky=({session:e,result:n,onClose:s})=>{var x,j,w;if(!n||!n.scoreDetails||!n.areaScore)return t.jsx(be,{title:"",onClose:s,initialWidth:380,windowId:"analysis-territory",modal:!1,children:t.jsx("p",{className:"text-center text-gray-400",children:"   ..."})});const{scoreDetails:l,winRateChange:r,scoreLead:a}=n,{mode:i,settings:o}=e,c=a??n.areaScore.black-n.areaScore.white,d=c>0?"":"",u=Math.abs(c).toFixed(1),p=n.winRateBlack,m=100-p,h=`rgba(220, 38, 38, ${Math.max(0,(p-50)/50*.7)})`,y=`rgba(59, 130, 246, ${Math.max(0,(m-50)/50*.7)})`,v=i===M.Speed||i===M.Mix&&((x=o.mixedModes)==null?void 0:x.includes(M.Speed)),b=i===M.Base||i===M.Mix&&((j=o.mixedModes)==null?void 0:j.includes(M.Base)),g=i===M.Hidden||i===M.Mix&&((w=o.mixedModes)==null?void 0:w.includes(M.Hidden));return t.jsx(be,{title:"",onClose:s,initialWidth:380,windowId:"analysis-territory",modal:!1,children:t.jsx("div",{className:"text-sm text-white",children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-1 text-xs",children:[t.jsxs("span",{className:"font-semibold text-gray-300",children:[" ",p.toFixed(1),"%"]}),r!==void 0&&t.jsxs("span",{className:`font-bold text-xs ${r>0?"text-green-400":"text-red-400"}`,children:[r>0?"":""," ",Math.abs(r).toFixed(1),"%"]}),t.jsxs("span",{className:"font-semibold text-gray-300",children:[" ",m.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex w-full h-4 bg-gray-700 rounded-full overflow-hidden border-2 border-gray-900",children:[t.jsx("div",{className:"bg-black relative",style:{width:`${p}%`},children:t.jsx("div",{className:"absolute inset-0",style:{backgroundColor:h}})}),t.jsx("div",{className:"bg-white relative",style:{width:`${m}%`},children:t.jsx("div",{className:"absolute inset-0",style:{backgroundColor:y}})})]})]}),t.jsxs("div",{className:"flex justify-between pt-1",children:[t.jsx("span",{className:"font-medium text-gray-300",children:"  "}),t.jsxs("span",{className:"font-mono font-bold text-yellow-300",children:[d," ",u," "]})]}),t.jsx("div",{className:"bg-gray-900/50 p-3 rounded-lg my-2 text-xs",children:t.jsxs("div",{className:"grid grid-cols-2 gap-x-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("h4",{className:"font-bold text-center border-b border-gray-600 pb-1 mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.territory})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{className:"font-mono",children:l.black.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.deadStones??0})]}),b&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.baseStoneBonus})]}),g&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.hiddenStoneBonus})]}),v&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.timeBonus})]}),l.black.itemBonus>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.black.itemBonus})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-500 mt-1 pt-1 font-bold",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:n.areaScore.black.toFixed(1)})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("h4",{className:"font-bold text-center border-b border-gray-600 pb-1 mb-1",children:""}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.territory})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{className:"font-mono",children:l.white.liveCaptures??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.deadStones??0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.komi})]}),b&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.baseStoneBonus})]}),g&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.hiddenStoneBonus})]}),v&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.timeBonus})]}),l.white.itemBonus>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:l.white.itemBonus})]}),t.jsxs("div",{className:"flex justify-between border-t border-gray-500 mt-1 pt-1 font-bold",children:[t.jsx("span",{children:":"})," ",t.jsx("span",{className:"font-mono",children:n.areaScore.white.toFixed(1)})]})]})]})})]})})})},Qy=e=>{if(e<=0)return"READY";const n=Math.ceil(e/1e3),s=Math.floor(n/60),l=n%60;return`${String(s).padStart(2,"0")}:${String(l).padStart(2,"0")}`},Ix=["playing","alkkagi_playing","curling_playing","dice_rolling","dice_placing","thief_rolling","thief_placing"],Jy=({session:e,isSpectator:n,onAction:s,currentUser:l})=>{var b,g;const[r,a]=f.useState("00:00"),{id:i,mode:o,gameStatus:c}=e;f.useEffect(()=>{var k;const x=(k=e.actionButtonCooldownDeadline)==null?void 0:k[l.id];if(!x){a("READY");return}const j=()=>{const C=x-Date.now();a(Qy(C))};j();const w=setInterval(j,1e3);return()=>clearInterval(w)},[e.actionButtonCooldownDeadline,l.id]);const d=["ended","no_contest","rematch_pending"].includes(c),u=at.some(x=>x.mode===o)||St.some(x=>x.mode===o);if(d||n||!u)return null;const p=(b=e.currentActionButtons)==null?void 0:b[l.id],m=p&&p.length>0,h=Ix.includes(c),y=(g=e.actionButtonUsedThisCycle)==null?void 0:g[l.id],v=r==="READY";return t.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[m&&!y?p.map(x=>t.jsx(F,{onClick:()=>s({type:"USE_ACTION_BUTTON",payload:{gameId:i,buttonName:x.name}}),colorScheme:x.type==="manner"?"green":"orange",className:"whitespace-nowrap text-[clamp(0.5rem,1.8vmin,0.75rem)] px-[clamp(0.3rem,1.5vmin,0.5rem)] py-[clamp(0.15rem,1vmin,0.25rem)]",title:x.message,disabled:n||!h,children:x.name},x.name)):t.jsx("span",{className:"text-xs text-gray-400",children:"  ..."}),t.jsx("span",{className:`text-xs font-mono ${v&&!y?"text-green-400":"text-gray-400"}`,children:r})]})},Yy=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{var h,y;const{id:r,gameStatus:a}=e,i=a==="dice_rolling_animating",o=v=>{n&&a==="dice_rolling"&&(Ee.rollDice(1),s({type:"DICE_ROLL",payload:{gameId:r,itemType:v}}))},c=(h=e.diceGoItemUses)==null?void 0:h[l.id],d=(c==null?void 0:c.odd)??0,u=(c==null?void 0:c.even)??0,p=n&&a==="dice_rolling",m=i?null:(y=e.dice)==null?void 0:y.dice1;return t.jsxs("div",{className:`flex flex-row items-center justify-center gap-3 transition-all ${p?"animate-pulse-border-yellow":"border-2 border-transparent p-2 rounded-lg"}`,children:[t.jsx("div",{className:"flex flex-col items-center",children:t.jsx(Yn,{value:m??null,isRolling:i,size:48,onClick:()=>o(),disabled:!p})}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(Yn,{displayText:"",color:"blue",value:null,isRolling:i,size:48,onClick:()=>o("odd"),disabled:!p||d<=0}),t.jsxs("span",{className:"text-xs mt-1 font-bold",children:[d,""]})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(Yn,{displayText:"",color:"yellow",value:null,isRolling:i,size:48,onClick:()=>o("even"),disabled:!p||u<=0}),t.jsxs("span",{className:"text-xs mt-1 font-bold",children:[u,""]})]})]})},Xy=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{var w,k;const{id:r,gameStatus:a,activeAlkkagiItems:i}=e,o=(w=e.alkkagiItemUses)==null?void 0:w[l.id],c=(o==null?void 0:o.slow)??e.settings.alkkagiSlowItemCount??0,d=(o==null?void 0:o.aimingLine)??e.settings.alkkagiAimingLineItemCount??0,u=(i==null?void 0:i[l.id])||[],p=C=>{s({type:"USE_ALKKAGI_ITEM",payload:{gameId:r,itemType:C}})},m=u.includes("slow"),h=u.includes("aimingLine"),y=n&&a==="alkkagi_playing",v="whitespace-nowrap text-[clamp(0.6rem,2.2vmin,0.875rem)] px-[clamp(0.4rem,1.8vmin,0.75rem)] py-[clamp(0.3rem,1.2vmin,0.625rem)]",b=e.settings.alkkagiRounds||1;if(b<=1)return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(F,{onClick:()=>p("slow"),disabled:!y||c<=0||m,colorScheme:m?"green":"blue",className:v,title:`   50% .  : ${c}`,children:[" (",c,")"]}),t.jsxs(F,{onClick:()=>p("aimingLine"),disabled:!y||d<=0||h,colorScheme:h?"green":"purple",className:v,title:`  1000% .  : ${d}`,children:[" (",d,")"]})]});const g=b-1,x=((k=e.alkkagiRefillsUsed)==null?void 0:k[l.id])||0,j=g-x;return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"flex flex-col text-center text-xs font-semibold",children:t.jsxs("span",{className:"text-yellow-300",children:[": ",j," / ",g]})}),t.jsx("div",{className:"h-8 w-px bg-gray-600 mx-2"}),t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(F,{onClick:()=>p("slow"),disabled:!y||c<=0||m,colorScheme:m?"green":"blue",className:v,title:`   50% .  : ${c}`,children:[" (",c,")"]}),t.jsxs(F,{onClick:()=>p("aimingLine"),disabled:!y||d<=0||h,colorScheme:h?"green":"purple",className:v,title:`  1000% .  : ${d}`,children:[" (",d,")"]})]})]})},Zy=({session:e,currentUser:n})=>null,eb=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{const{id:r,gameStatus:a,animation:i,currentPlayer:o,blackPlayerId:c,whitePlayerId:d,thiefPlayerId:u}=e,p=(i==null?void 0:i.type)==="dice_roll_main"?i:null,m=!!p&&Date.now()<p.startTime+p.duration,v=((o===$.Black?c:d)===u?"thief":"police")==="thief"?1:2,b=()=>{n&&a==="thief_rolling"&&(Ee.rollDice(v),s({type:"THIEF_ROLL_DICE",payload:{gameId:r}}))};return t.jsx("div",{className:"flex items-center justify-center gap-2",children:Array.from({length:v}).map((g,x)=>{var k;const j=x===0?"dice1":"dice2",w=p?p.dice[j]:(k=e.dice)==null?void 0:k[j];return t.jsx(Yn,{value:w??null,isRolling:m,size:48,onClick:b,disabled:!n||a!=="thief_rolling"},x)})})},tb=({session:e,isMyTurn:n,onAction:s,currentUser:l})=>{var b;const{id:r,gameStatus:a,activeCurlingItems:i}=e,o=(b=e.curlingItemUses)==null?void 0:b[l.id],c=(o==null?void 0:o.slow)??e.settings.curlingSlowItemCount??0,d=(o==null?void 0:o.aimingLine)??e.settings.curlingAimingLineItemCount??0,u=(i==null?void 0:i[l.id])||[],p=g=>{s({type:"USE_CURLING_ITEM",payload:{gameId:r,itemType:g}})},m=u.includes("slow"),h=u.includes("aimingLine"),y=n&&a==="curling_playing",v="whitespace-nowrap text-[clamp(0.6rem,2.2vmin,0.875rem)] px-[clamp(0.4rem,1.8vmin,0.75rem)] py-[clamp(0.3rem,1.2vmin,0.625rem)]";return t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsxs(F,{onClick:()=>p("slow"),disabled:!y||c<=0||m,colorScheme:m?"green":"blue",className:v,title:`   50% .  : ${c}`,children:[" (",c,")"]}),t.jsxs(F,{onClick:()=>p("aimingLine"),disabled:!y||d<=0||h,colorScheme:h?"green":"purple",className:v,title:`  1000% .  : ${d}`,children:[" (",d,")"]})]})},nb=e=>{var z;const{session:n,isMyTurn:s,isSpectator:l,onAction:r,setShowResultModal:a,setConfirmModalType:i,currentUser:o,onlineUsers:c,pendingMove:d,onConfirmMove:u,onCancelMove:p,isMobile:m,settings:h}=e,{id:y,mode:v,gameStatus:b,blackPlayerId:g,whitePlayerId:x,player1:j,player2:w}=n;M.Mix;const k=["ended","no_contest","rematch_pending"].includes(b),C=Ix.includes(b),S=!C&&!k,P=at.some(H=>H.mode===v),_=()=>{s&&!l&&b==="playing"&&r({type:"PASS_TURN",payload:{gameId:y}})},I=()=>{!l&&!n.isAiGame&&C&&i("resign")},T=H=>{if(b!=="playing")return;r({type:H==="hidden"?"START_HIDDEN_PLACEMENT":H==="scan"?"START_SCANNING":"START_MISSILE_SELECTION",payload:{gameId:y}})},R=(o.id===g?$.Black:$.White)===$.Black?$.White:$.Black,A=f.useMemo(()=>!n.hiddenMoves||!n.moveHistory?!1:Object.entries(n.hiddenMoves).some(([H,ne])=>{var fe,ye;if(!ne)return!1;const oe=n.moveHistory[parseInt(H)];if(!oe||oe.player!==R)return!1;const{x:me,y:ve}=oe;return((fe=n.boardState[ve])==null?void 0:fe[me])!==R?!1:!((ye=n.permanentlyRevealedStones)==null?void 0:ye.some(K=>K.x===me&&K.y===ve))}),[n.hiddenMoves,n.moveHistory,n.boardState,n.permanentlyRevealedStones,R]),L="whitespace-nowrap text-[clamp(0.6rem,2.2vmin,0.875rem)] px-[clamp(0.4rem,1.8vmin,0.75rem)] py-[clamp(0.2rem,0.8vmin,0.4rem)]",Q=()=>{const H=v===M.Hidden||v===M.Mix&&(n.settings.mixedModes||[]).includes(M.Hidden),ne=v===M.Missile||v===M.Mix&&(n.settings.mixedModes||[]).includes(M.Missile),oe=n.player1.id,me=o.id===oe?n.hidden_stones_used_p1??0:n.hidden_stones_used_p2??0,ve=o.id===oe?n.scans_p1:n.scans_p2,J=o.id===oe?n.missiles_p1:n.missiles_p2,fe=(n.settings.hiddenStoneCount||0)-me;return t.jsxs(t.Fragment,{children:[" ",H&&t.jsxs(F,{onClick:()=>T("hidden"),disabled:!s||l||b!=="playing"||fe<=0,colorScheme:"purple",className:L,children:[" (",fe,")"]})," ",H&&t.jsxs(F,{onClick:()=>T("scan"),disabled:!s||l||b!=="playing"||(ve??0)<=0||!A,colorScheme:"purple",className:L,children:[" (",ve??0,")"]})," ",ne&&t.jsxs(F,{onClick:()=>T("missile"),disabled:!s||l||b!=="playing"||(J??0)<=0,colorScheme:"orange",className:L,children:[" (",J??0,")"]})," "]})},q=v===M.Hidden||v===M.Missile||v===M.Mix&&(n.settings.mixedModes||[]).some(H=>[M.Hidden,M.Missile].includes(H));if(l&&!o.isAdmin)return null;const O=(n.maxActionButtonUses??0)-(((z=n.actionButtonUses)==null?void 0:z[o.id])??0),U=n.maxActionButtonUses,G=typeof O=="number"&&typeof U=="number"?`(${O})`:"";return n.isAnalyzing,t.jsxs("footer",{className:"responsive-controls flex-shrink-0 bg-gray-800 rounded-lg p-1 flex flex-col items-stretch justify-center gap-1 w-full",children:[m&&h.features.mobileConfirm&&d&&t.jsxs("div",{className:"flex gap-4 p-2 justify-center",children:[t.jsx(F,{onClick:p,colorScheme:"red",className:"!py-3 !px-6",children:""}),t.jsx(F,{onClick:u,colorScheme:"green",className:"!py-3 !px-6 animate-pulse",children:""})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-md p-2 flex flex-row items-center gap-4 w-full",children:[t.jsxs("h3",{className:"text-xs font-bold text-gray-300 whitespace-nowrap",children:["  ",G]}),t.jsx("div",{className:"flex-grow flex items-center justify-center",children:t.jsx(Jy,{session:n,isSpectator:l,onAction:r,currentUser:o})})]}),t.jsxs("div",{className:"flex flex-col lg:flex-row gap-1 w-full",children:[t.jsxs("div",{className:"bg-gray-900/50 rounded-md p-2 flex flex-row items-center gap-4 flex-1 min-w-0",children:[t.jsx("h3",{className:"text-xs font-bold text-gray-300 whitespace-nowrap",children:" "}),t.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap flex-grow",children:k?t.jsx(F,{onClick:()=>a(!0),colorScheme:"yellow",className:L,children:" "}):t.jsxs(t.Fragment,{children:[P&&v!==M.Capture&&t.jsx(F,{onClick:_,disabled:!s||l||S,colorScheme:"blue",className:L,children:""}),t.jsx(F,{onClick:I,disabled:l||n.isAiGame||S,colorScheme:"red",className:L,children:""})]})})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-md p-2 flex flex-row items-center gap-4 flex-1 min-w-0",children:[t.jsx("h3",{className:"text-xs font-bold text-gray-300 whitespace-nowrap",children:P?" ":" "}),t.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap flex-grow",children:P?t.jsx(t.Fragment,{children:!k&&q&&Q()}):v===M.Dice?t.jsx(Yy,{session:n,isMyTurn:s,onAction:r,currentUser:o}):v===M.Thief?t.jsx(eb,{session:n,isMyTurn:s,onAction:r,currentUser:o}):v===M.Curling?t.jsx(tb,{session:n,isMyTurn:s,onAction:r,currentUser:o}):v===M.Alkkagi?t.jsx(Xy,{session:n,isMyTurn:s,onAction:r,currentUser:o}):t.jsx(Zy,{session:n,currentUser:o})})]})]}),l&&o.isAdmin&&C&&t.jsxs("div",{className:"bg-purple-900/50 rounded-md p-2 flex flex-row items-center gap-4 w-full mt-1",children:[t.jsx("h3",{className:"text-xs font-bold text-purple-300 whitespace-nowrap",children:" "}),t.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap flex-grow",children:[t.jsxs(F,{onClick:()=>{window.confirm(`${j.nickname}  ?`)&&r({type:"ADMIN_FORCE_WIN",payload:{gameId:y,winnerId:j.id}})},colorScheme:"purple",className:L,children:[j.nickname," "]}),t.jsxs(F,{onClick:()=>{window.confirm(`${w.nickname}  ?`)&&r({type:"ADMIN_FORCE_WIN",payload:{gameId:y,winnerId:w.id}})},colorScheme:"purple",className:L,children:[w.nickname," "]})]})]})]})},sb=({session:e,currentUser:n})=>{const{disconnectionState:s,player1:l,player2:r,disconnectionCounts:a}=e,[i,o]=f.useState(90);if(!s)return null;const c=s.disconnectedPlayerId===l.id?l:r,d=c.id===n.id,u=(a==null?void 0:a[c.id])||1;return f.useEffect(()=>{const p=()=>{const h=(Date.now()-s.timerStartedAt)/1e3,y=Math.max(0,90-Math.floor(h));o(y)},m=setInterval(p,1e3);return p(),()=>clearInterval(m)},[s.timerStartedAt]),t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-md p-8 border border-gray-700 text-center",children:[t.jsxs("h2",{className:"text-2xl font-bold text-yellow-400 mb-4",children:["   (",u,"/3)"]}),t.jsx("div",{className:"flex justify-center items-center my-6",children:t.jsx("div",{className:"animate-pulse rounded-full h-16 w-16 border-4 border-yellow-400 flex items-center justify-center",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-yellow-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),t.jsxs("p",{className:"text-lg text-white mb-2",children:[t.jsx("span",{className:"font-bold",children:c.nickname}),"   ."]}),t.jsx("p",{className:"text-gray-300",children:"  ..."}),t.jsxs("p",{className:"text-4xl font-mono font-bold my-4 text-white",children:[i,""]}),d&&t.jsx("p",{className:"text-sm text-red-400 bg-red-900/50 p-2 rounded-md",children:"  ."})]})})},lb=({session:e,onAction:n,currentUser:s})=>{if(e.gameStatus==="ended"||e.gameStatus==="no_contest"){const u=e.winner===$.Black,p=Jl.findIndex(g=>g.id===e.stageId),m=Jl[p+1],h=u&&m&&(s.singlePlayerProgress??0)>p,y=()=>{n({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:e.stageId}})},v=()=>{h&&n({type:"START_SINGLE_PLAYER_GAME",payload:{stageId:m.id}})},b=()=>{sessionStorage.setItem("postGameRedirect","#/singleplayer"),n({type:"LEAVE_AI_GAME",payload:{gameId:e.id}})};return t.jsxs("div",{className:"bg-stone-800/60 backdrop-blur-sm rounded-lg p-2 flex items-center justify-center gap-2 w-full border border-stone-700/50",children:[t.jsx(F,{onClick:b,colorScheme:"gray",className:"flex-1 !text-sm",children:""}),t.jsx(F,{onClick:y,colorScheme:"yellow",className:"flex-1 !text-sm",children:""}),t.jsxs(F,{onClick:v,colorScheme:"accent",disabled:!h,className:"flex-1 !text-sm",children:[" ",m?`: ${m.name.replace(" ","")}`:""]})]})}const l=e.singlePlayerPlacementRefreshesUsed||0,r=e.moveHistory.length===0&&l<5,i=[0,50,100,200,300][l]||0,o=s.gold>=i,c=()=>{r&&o&&n({type:"SINGLE_PLAYER_REFRESH_PLACEMENT",payload:{gameId:e.id}})},d=()=>{window.confirm("    ?")&&(window.location.hash="#/singleplayer")};return t.jsxs("div",{className:"bg-stone-800/60 backdrop-blur-sm rounded-lg p-2 flex items-center justify-between gap-4 w-full h-full border border-stone-700/50",children:[t.jsx(F,{onClick:d,colorScheme:"red",className:"!text-sm",children:""}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"text-xs text-stone-400",children:[" : ",r?i:"-"]}),t.jsxs(F,{onClick:c,colorScheme:"accent",className:"!text-sm",disabled:!r||!o,title:o?"":" .",children:["  (",5-l,"/5)"]})]})]})},Au=[{term:"()",meaning:"   ."},{term:"()",meaning:"    ,   ."},{term:"()",meaning:"        ."},{term:"()",meaning:"        ."},{term:"()",meaning:"     ."},{term:"()",meaning:"      ."},{term:"()",meaning:",    ."},{term:"()",meaning:"      ."},{term:"()",meaning:"      ."},{term:"()",meaning:"       ."},{term:"()",meaning:"        ."},{term:"   ",meaning:"       ."}],rb=({session:e})=>{const{settings:n}=e;return t.jsxs("div",{className:"h-full bg-stone-800/60 backdrop-blur-sm p-3 rounded-md flex-shrink-0 border border-stone-700/50 text-stone-300",children:[t.jsx("h3",{className:"text-base font-bold border-b border-stone-600/50 pb-1 mb-2 text-amber-300 text-center",children:" "}),t.jsxs("div",{className:"grid grid-cols-2 gap-x-3 gap-y-0.5 text-xs",children:[t.jsx("div",{className:"font-semibold text-stone-400",children:" :"}),t.jsxs("div",{children:[n.boardSize,"x",n.boardSize]}),t.jsx("div",{className:"font-semibold text-stone-400",children:"AI :"}),t.jsx("div",{children:n.aiDifficulty}),t.jsx("div",{className:"font-semibold text-stone-400",children:" :"}),t.jsxs("div",{children:[n.captureTarget,""]})]})]})},ab=()=>{const[e,n]=f.useState(0);f.useEffect(()=>{const l=setInterval(()=>{n(r=>(r+1)%Au.length)},15e3);return()=>clearInterval(l)},[]);const s=Au[e];return t.jsxs("div",{className:"bg-stone-800/60 backdrop-blur-sm p-3 rounded-md flex-1 border border-stone-700/50 text-stone-300 flex flex-col items-center justify-center text-center",children:[t.jsx("h3",{className:"text-base font-bold border-b border-stone-600/50 pb-1 mb-2 text-amber-300",children:" "}),t.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center",children:[t.jsx("p",{className:"text-2xl font-semibold text-stone-100",children:s.term}),t.jsx("p",{className:"text-sm text-stone-300 mt-2",children:s.meaning})]})]})},ib=({session:e})=>t.jsxs("div",{className:"flex flex-col md:flex-row h-full gap-2",children:[t.jsx(rb,{session:e}),t.jsx(ab,{})]}),ob=e=>{const[n,s]=f.useState({black:e.blackTimeLeft,white:e.whiteTimeLeft});return f.useEffect(()=>{if(["ended","no_contest","scoring"].includes(e.gameStatus)){s({black:e.blackTimeLeft,white:e.whiteTimeLeft});return}const r=e.turnDeadline||e.alkkagiTurnDeadline||e.curlingTurnDeadline||e.alkkagiPlacementDeadline||e.turnChoiceDeadline||e.guessDeadline||e.basePlacementDeadline||e.captureBidDeadline||e.itemUseDeadline;if(!r){s({black:e.blackTimeLeft,white:e.whiteTimeLeft});return}const a=["base_placement","komi_bidding","capture_bidding","alkkagi_simultaneous_placement"].includes(e.gameStatus);let i;const o=()=>{const c=Math.max(0,(r-Date.now())/1e3);a?s({black:c,white:c}):e.currentPlayer===$.Black?s({black:c,white:e.whiteTimeLeft}):e.currentPlayer===$.White?s({black:e.blackTimeLeft,white:c}):s({black:e.blackTimeLeft,white:e.whiteTimeLeft}),i=requestAnimationFrame(o)};return i=requestAnimationFrame(o),()=>cancelAnimationFrame(i)},[e.turnDeadline,e.alkkagiTurnDeadline,e.curlingTurnDeadline,e.alkkagiPlacementDeadline,e.turnChoiceDeadline,e.guessDeadline,e.basePlacementDeadline,e.captureBidDeadline,e.itemUseDeadline,e.currentPlayer,e.blackTimeLeft,e.whiteTimeLeft,e.gameStatus]),{clientTimes:n}};function Bn(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const cb=({session:e})=>{var Se,qe,Be,He;const{currentUser:n,currentUserWithStatus:s,handlers:l,onlineUsers:r,waitingRoomChats:a,gameChats:i,negotiations:o,activeNegotiation:c,settings:d}=De(),{id:u,currentPlayer:p,gameStatus:m,player1:h,player2:y,mode:v,blackPlayerId:b,whitePlayerId:g}=e;if(!(h!=null&&h.id)||!(y!=null&&y.id)||!n||!s)return t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"   ..."});const[x,j]=f.useState(null),w=ob(e),[k,C]=f.useState(!1),[S,P]=f.useState(!1),[_,I]=f.useState(!1),[T,B]=f.useState(null),[R,A]=f.useState(!1),L=Bn(m);Bn(p);const Q=Bn(e.captures),q=Bn((Se=e.animation)==null?void 0:Se.type),O=f.useRef(!1),U=Bn((qe=e.moveHistory)==null?void 0:qe.length),G=f.useMemo(()=>(s==null?void 0:s.status)==="spectating",[s]),z=e.isSinglePlayer,[H,ne]=f.useState(window.innerWidth<1024),[oe,me]=f.useState(!1),[ve,J]=f.useState(!1),fe=f.useMemo(()=>i[e.id]||[],[i,e.id]),ye=Bn(fe.length);f.useEffect(()=>{const se=()=>ne(window.innerWidth<1024);return window.addEventListener("resize",se),()=>window.removeEventListener("resize",se)},[]),f.useEffect(()=>{!oe&&ye!==void 0&&fe.length>ye&&J(!0)},[fe.length,ye,oe]);const K=()=>{me(!0),J(!1)};f.useEffect(()=>{(m==="ended"||m==="no_contest")&&L!=="ended"&&L!=="no_contest"&&L!=="rematch_pending"&&(C(!0),P(!0))},[m,L]);const W=f.useMemo(()=>{var se;return G?$.None:b===n.id?$.Black:g===n.id?$.White:(v===M.Base||v===M.Mix&&((se=e.settings.mixedModes)!=null&&se.includes(M.Base)))&&m==="base_placement"?n.id===h.id?$.Black:$.White:$.None},[n.id,b,g,G,v,m,h.id,y.id,e.settings.mixedModes]),D=f.useMemo(()=>{var se,Me;if(G)return!1;if(m==="alkkagi_simultaneous_placement"&&e.settings.alkkagiPlacementType===" "){const _e=(e.alkkagiStones||[]).filter(it=>it.player===W).length,Ge=((se=n.id===h.id?e.alkkagiStones_p1:e.alkkagiStones_p2)==null?void 0:se.length)||0;return _e+Ge<(e.settings.alkkagiStoneCount||5)}switch(m){case"dice_turn_rolling":return((Me=e.turnOrderRolls)==null?void 0:Me[n.id])===null;case"dice_turn_choice":return e.turnChooserId===n.id;case"playing":case"hidden_placing":case"scanning":case"missile_selecting":case"alkkagi_placement":case"alkkagi_playing":case"curling_playing":case"dice_rolling":case"dice_placing":case"thief_rolling":case"thief_placing":return W!==$.None&&W===p;case"base_placement":{const _e=n.id===h.id?e.baseStones_p1:e.baseStones_p2;return((_e==null?void 0:_e.length)||0)<(e.settings.baseStones||4)}default:return!1}},[W,p,m,G,e,n.id,h.id,e.settings]),V=Bn(D);f.useEffect(()=>{D&&!V&&[M.Dice,M.Thief,M.Alkkagi,M.Curling].includes(e.mode)&&Ee.myTurn()},[D,V,e.mode]);const Y=Bn(e.lastMove);f.useEffect(()=>{e.lastMove&&e.lastMove.x!==-1&&JSON.stringify(e.lastMove)!==JSON.stringify(Y)&&(at.some(Me=>Me.mode===e.mode)||[M.Omok,M.Ttamok,M.Dice,M.Thief].includes(e.mode))&&Ee.placeStone()},[e.lastMove,Y,e.mode]),f.useEffect(()=>{},[e.captures,Q,e.justCaptured,e.blackPlayerId,n.id]),f.useEffect(()=>(m==="scanning"&&L!=="scanning"?Ee.playScanBgm():m!=="scanning"&&L==="scanning"&&Ee.stopScanBgm(),()=>{m==="scanning"&&Ee.stopScanBgm()}),[m,L]),f.useEffect(()=>{const se=e.animation;if(se&&se.type!==q)switch(se.type){case"missile":case"hidden_missile":Ee.launchMissile();break;case"hidden_reveal":_||Ee.revealHiddenStone();break;case"scan":I(!0),setTimeout(()=>I(!1),1e3),se.success?Ee.scanSuccess():Ee.scanFail();break}},[e.animation,q,_]),f.useEffect(()=>{const se=["playing","alkkagi_placement","alkkagi_simultaneous_placement","curling_playing","dice_rolling","thief_rolling"];se.includes(m)&&(L===void 0||!se.includes(L))&&Ee.gameStart()},[m,L]),f.useEffect(()=>()=>Ee.stopScanBgm(),[]),f.useEffect(()=>{const se=["ended","no_contest","scoring"].includes(m),Me=U!==void 0&&e.moveHistory&&e.moveHistory.length>U;if((!D||Me||se)&&O.current&&(Ee.stopTimerWarning(),O.current=!1),D&&!se){const _e=W===$.Black?w.clientTimes.black:w.clientTimes.white;_e<=10&&_e>0&&!O.current&&(Ee.timerWarning(),O.current=!0)}},[D,w.clientTimes,W,e.moveHistory,U,m]);const ie=["hidden_placing","scanning","missile_selecting","missile_animating","scanning_animating"].includes(m),je=f.useCallback((se,Me)=>{if(Ee.stopTimerWarning(),G||m==="missile_animating")return;if(H&&d.features.mobileConfirm&&D&&!ie){if(T&&T.x===se&&T.y===Me)return;B({x:se,y:Me});return}let _e=null,Ge={gameId:u,x:se,y:Me};if((v===M.Omok||v===M.Ttamok)&&m==="playing"&&D)_e="OMOK_PLACE_STONE";else if(m==="scanning"&&D)Ee.stopScanBgm(),_e="SCAN_BOARD";else if(m==="base_placement"){const it=n.id===h.id?e.baseStones_p1:e.baseStones_p2;((it==null?void 0:it.length)||0)<(e.settings.baseStones||4)&&(_e="PLACE_BASE_STONE")}else["playing","hidden_placing"].includes(m)&&D&&(_e="PLACE_STONE",Ge.isHidden=m==="hidden_placing",Ge.isHidden&&Ee.stopScanBgm());_e&&l.handleAction({type:_e,payload:Ge})},[G,m,D,u,l.handleAction,n.id,h.id,e.baseStones_p1,e.baseStones_p2,e.settings.baseStones,v,H,d.features.mobileConfirm,T,ie]),E=f.useCallback(()=>{if(Ee.stopTimerWarning(),!T)return;let se=null,Me={gameId:u,x:T.x,y:T.y};(v===M.Omok||v===M.Ttamok)&&m==="playing"&&D?se="OMOK_PLACE_STONE":["playing","hidden_placing"].includes(m)&&D&&(se="PLACE_STONE",Me.isHidden=m==="hidden_placing"),se&&l.handleAction({type:se,payload:Me}),B(null)},[T,u,l,m,D,v]),Z=f.useCallback(()=>B(null),[]),le=f.useMemo(()=>{var se,Me;return((se=e.analysisResult)==null?void 0:se[n.id])??(["ended","no_contest"].includes(m)?(Me=e.analysisResult)==null?void 0:Me.system:null)},[e.analysisResult,n.id,m]),ae=f.useMemo(()=>{var se;return G||e.isAiGame?!1:!!((se=e.canRequestNoContest)!=null&&se[n.id])},[e.canRequestNoContest,n.id,G,e.isAiGame]),de=f.useCallback(()=>{if(G){l.handleAction({type:"LEAVE_SPECTATING"});return}if(["ended","no_contest","rematch_pending"].includes(m)){const se=e.isAiGame?"LEAVE_AI_GAME":"LEAVE_GAME_ROOM";l.handleAction({type:se,payload:{gameId:u}});return}ae?window.confirm("       ?")&&l.handleAction({type:"REQUEST_NO_CONTEST_LEAVE",payload:{gameId:u}}):j("resign")},[G,l.handleAction,e.isAiGame,u,m,ae]),te=f.useMemo(()=>a.global||[],[a]),pe=f.useCallback(()=>{C(!1),P(!1)},[]),we={session:e,onAction:l.handleAction,currentUser:s,waitingRoomChat:te,gameChat:fe,isSpectator:G,onlineUsers:r,activeNegotiation:c,negotiations:Object.values(o),onViewUser:l.openViewingUser},ue={session:e,isMyTurn:D,isSpectator:G,onAction:l.handleAction,setShowResultModal:C,setConfirmModalType:j,currentUser:s,onlineUsers:r,pendingMove:T,onConfirmMove:E,onCancelMove:Z,settings:d,isMobile:H};return z?t.jsxs("div",{className:"w-full h-dvh flex flex-col p-1 lg:p-4 bg-wood-pattern text-stone-200",children:[t.jsx("button",{onClick:l.openSettingsModal,className:"absolute top-2 right-2 z-30 p-2 rounded-lg text-xl hover:bg-black/20 transition-colors",title:"",children:""}),t.jsxs("main",{className:"flex-1 flex flex-col items-center justify-center gap-2 lg:gap-4 max-w-5xl w-full mx-auto min-h-0",children:[t.jsx("div",{className:"w-full flex-shrink-0",children:t.jsx(Iu,{...we,clientTimes:w.clientTimes,isSinglePlayer:!0})}),t.jsx("div",{className:"flex-1 w-full relative",children:t.jsx("div",{className:"absolute inset-0",children:t.jsx(ku,{...we,isMyTurn:D,myPlayerEnum:W,handleBoardClick:je,isItemModeActive:ie,showTerritoryOverlay:S,isMobile:H,myRevealedMoves:((Be=e.revealedHiddenMoves)==null?void 0:Be[n.id])||[],showLastMoveMarker:d.features.lastMoveMarker})})}),t.jsxs("div",{className:"w-full flex flex-col-reverse md:flex-row gap-2 lg:gap-4 items-stretch flex-shrink-0",children:[t.jsx("div",{className:"flex-1",children:t.jsx(ib,{session:e})}),t.jsxs("div",{className:"flex flex-col gap-2 flex-shrink-0 w-full md:w-auto",children:[t.jsx(_u,{session:e}),t.jsx(lb,{...we,currentUser:s})]})]})]}),t.jsx(Tu,{...we,confirmModalType:x,onHideConfirmModal:()=>j(null),showResultModal:k,onCloseResults:pe})]}):t.jsxs("div",{className:"w-full h-dvh flex flex-col p-1 lg:p-2 relative max-w-full bg-tertiary",children:[e.disconnectionState&&t.jsx(sb,{session:e,currentUser:n}),e.gameStatus==="scoring"&&t.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center z-30",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-gray-100 mb-4"}),t.jsx("p",{className:"text-xl font-bold text-white",children:" ..."})]}),t.jsx("button",{onClick:l.openSettingsModal,className:"absolute top-2 right-2 z-30 p-2 rounded-lg text-xl hover:bg-secondary/50 transition-colors",title:"",children:""}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-2 min-h-0",children:[t.jsx("main",{className:"flex-1 flex items-center justify-center min-w-0 min-h-0",children:t.jsxs("div",{className:"w-full h-full max-h-full max-w-full lg:max-w-[calc(100vh-8rem)] flex flex-col items-center gap-1 lg:gap-2",children:[t.jsx("div",{className:"flex-shrink-0 w-full",children:t.jsx(Iu,{...we,clientTimes:w.clientTimes})}),t.jsx("div",{className:"flex-1 w-full relative",children:t.jsx("div",{className:"absolute inset-0",children:t.jsx(ku,{...we,isMyTurn:D,myPlayerEnum:W,handleBoardClick:je,isItemModeActive:ie,showTerritoryOverlay:S,isMobile:H,myRevealedMoves:((He=e.revealedHiddenMoves)==null?void 0:He[n.id])||[],showLastMoveMarker:d.features.lastMoveMarker})})}),t.jsxs("div",{className:"flex-shrink-0 w-full flex flex-col gap-1",children:[t.jsx(_u,{session:e}),t.jsx(nb,{...ue})]})]})}),!H&&t.jsx("div",{className:"w-full lg:w-[320px] xl:w-[360px] flex-shrink-0",children:t.jsx(Su,{...we,onLeaveOrResign:de,isNoContestLeaveAvailable:ae})}),H&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-0 z-20",children:t.jsx("button",{onClick:K,className:"w-8 h-12 bg-secondary/80 backdrop-blur-sm rounded-l-lg flex items-center justify-center text-primary shadow-lg","aria-label":" ",children:t.jsxs("span",{className:"relative font-bold text-lg",children:["<",ve&&t.jsx("div",{className:"absolute -top-1 -right-1.5 w-2.5 h-2.5 bg-danger rounded-full border-2 border-secondary"})]})})}),t.jsx("div",{className:`fixed top-0 right-0 h-full w-[280px] bg-secondary shadow-2xl z-50 transition-transform duration-300 ease-in-out ${oe?"translate-x-0":"translate-x-full"}`,children:t.jsx(Su,{...we,onLeaveOrResign:de,isNoContestLeaveAvailable:ae,onClose:()=>me(!1)})}),oe&&t.jsx("div",{className:"fixed inset-0 bg-black/60 z-40",onClick:()=>me(!1)})]})]}),R&&le&&t.jsx(Ky,{session:e,result:le,onClose:()=>A(!1)}),t.jsx(Tu,{...we,confirmModalType:x,onHideConfirmModal:()=>j(null),showResultModal:k,onCloseResults:pe})]})},db=({onNavigate:e,onBackToProfile:n,liveGames:s,onAction:l})=>{const r=a=>{window.confirm(`[${a.player1.nickname} vs ${a.player2.nickname}]   ?`)&&l({type:"ADMIN_FORCE_DELETE_GAME",payload:{gameId:a.id}})};return t.jsxs("div",{className:"bg-primary text-primary",children:[t.jsxs("header",{className:"flex justify-between items-center mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold",children:" "}),t.jsx("button",{onClick:n,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{onClick:()=>e("userManagement"),className:"bg-blue-800/50 hover:bg-blue-700/50 p-6 rounded-lg shadow-lg cursor-pointer transition-all transform hover:-translate-y-1 border border-color",children:[t.jsx("h2",{className:"text-2xl font-bold text-blue-300",children:" "}),t.jsx("p",{className:"mt-2 text-gray-400",children:"  ,  ,    ."})]}),t.jsxs("div",{onClick:()=>e("mailSystem"),className:"bg-green-800/50 hover:bg-green-700/50 p-6 rounded-lg shadow-lg cursor-pointer transition-all transform hover:-translate-y-1 border border-color",children:[t.jsx("h2",{className:"text-2xl font-bold text-green-300",children:"  "}),t.jsx("p",{className:"mt-2 text-gray-400",children:"      ."})]}),t.jsxs("div",{onClick:()=>e("serverSettings"),className:"bg-yellow-800/50 hover:bg-yellow-700/50 p-6 rounded-lg shadow-lg cursor-pointer transition-all transform hover:-translate-y-1 border border-color",children:[t.jsx("h2",{className:"text-2xl font-bold text-yellow-300",children:" "}),t.jsx("p",{className:"mt-2 text-gray-400",children:",        ."})]})]}),t.jsxs("div",{className:"mt-8 bg-panel border border-color p-6 rounded-lg shadow-lg",children:[t.jsxs("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2 text-on-panel",children:["  (",s.length,")"]}),t.jsx("div",{className:"max-h-[40vh] overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm text-left text-secondary",children:[t.jsx("thead",{className:"text-xs text-secondary uppercase bg-secondary sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"px-4 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:" "}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:" "}),t.jsx("th",{scope:"col",className:"px-4 py-3",children:""})]})}),t.jsx("tbody",{children:s.map(a=>t.jsxs("tr",{className:"bg-primary border-b border-color hover:bg-secondary/50",children:[t.jsxs("td",{className:"px-4 py-4 font-medium text-primary whitespace-nowrap",children:[a.player1.nickname," vs ",a.player2.nickname]}),t.jsx("td",{className:"px-4 py-4",children:a.mode}),t.jsx("td",{className:"px-4 py-4",children:a.gameStatus}),t.jsx("td",{className:"px-4 py-4",children:new Date(a.createdAt).toLocaleString()}),t.jsx("td",{className:"px-4 py-4",children:t.jsx("button",{onClick:()=>r(a),className:"font-medium text-red-500 hover:underline",children:" "})})]},a.id))})]})})]})]})},ub=({user:e,currentUser:n,onClose:s,onAction:l})=>{var w,k,C;const[r,a]=f.useState(JSON.parse(JSON.stringify(e))),[i,o]=f.useState("general"),c=S=>{const{name:P,value:_}=S.target;a(I=>({...I,[P]:Number(_)}))},d=S=>{const{name:P,value:_}=S.target;a(I=>({...I,[P]:_}))},u=S=>{const{name:P,checked:_}=S.target;a(I=>({...I,[P]:_}))},p=(S,P)=>{a(_=>{const I={..._.stats||{}};return I[S]||(I[S]={wins:0,losses:0,rankingScore:1200}),I[S].rankingScore=Number(P),{..._,stats:I}})},m=(S,P,_,I)=>{a(T=>{const B=JSON.parse(JSON.stringify(T.quests||{}));if(B[S]&&B[S].quests){const R=B[S].quests.find(A=>A.id===P);R&&(R[_]=I)}return{...T,quests:B}})},h=(S,P)=>{a(_=>{const I=JSON.parse(JSON.stringify(_.quests||{}));return I[S]?I[S].activityProgress=P:I[S]||(I[S]={quests:[],activityProgress:P,claimedMilestones:[!1,!1,!1,!1,!1],lastReset:0}),{..._,quests:I}})},y=(S,P,_)=>{a(I=>{const T=JSON.parse(JSON.stringify(I.quests||{}));return T[S]&&T[S].claimedMilestones&&(T[S].claimedMilestones[P]=_),{...I,quests:T}})},v=()=>{l({type:"ADMIN_UPDATE_USER_DETAILS",payload:{targetUserId:e.id,updatedDetails:r}}),s()},b=S=>{const P=S==="full"?` [${e.nickname}]     ?`:` [${e.nickname}]    ?`;window.confirm(P)&&l({type:"ADMIN_RESET_USER_DATA",payload:{targetUserId:e.id,resetType:S}})},g=()=>{window.confirm(` [${e.nickname}]   ?`)&&(l({type:"ADMIN_DELETE_USER",payload:{targetUserId:e.id}}),s())},x=S=>t.jsx("div",{className:"space-y-2",children:S.map(({mode:P})=>{var _,I;return t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[t.jsx("label",{className:"text-secondary col-span-1",children:P}),t.jsx("input",{type:"number",value:((I=(_=r.stats)==null?void 0:_[P])==null?void 0:I.rankingScore)??1200,onChange:T=>p(P,T.target.value),className:"bg-tertiary p-1 rounded col-span-1"})]},P)})}),j=({title:S,questType:P,questData:_})=>t.jsxs("div",{className:"bg-tertiary/50 p-3 rounded-lg",children:[t.jsx("h3",{className:"font-bold text-lg text-highlight mb-2",children:S}),t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("label",{className:"text-sm font-medium text-secondary whitespace-nowrap",children:":"}),t.jsx("input",{type:"number",value:(_==null?void 0:_.activityProgress)||0,onChange:I=>h(P,parseInt(I.target.value,10)||0),className:"bg-secondary p-1 rounded w-full"})]}),t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("label",{className:"text-sm font-medium text-secondary whitespace-nowrap",children:":"}),t.jsx("div",{className:"flex gap-2 flex-wrap",children:Array.from({length:5}).map((I,T)=>{var B;return t.jsxs("label",{className:"flex items-center gap-1 text-xs",children:[t.jsx("input",{type:"checkbox",checked:((B=_==null?void 0:_.claimedMilestones)==null?void 0:B[T])||!1,onChange:R=>y(P,T,R.target.checked),className:"w-4 h-4"}),T+1]},T)})})]}),t.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2 border-t border-color pt-2",children:((_==null?void 0:_.quests)||[]).map(I=>t.jsxs("div",{className:"bg-primary/50 p-2 rounded-md text-xs",children:[t.jsx("p",{className:"font-semibold truncate",title:I.title,children:I.title}),t.jsxs("div",{className:"flex items-center justify-between gap-2 mt-1",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{children:":"}),t.jsx("input",{type:"number",value:I.progress,onChange:T=>m(P,I.id,"progress",parseInt(T.target.value,10)||0),className:"w-16 bg-secondary p-0.5 rounded text-center"}),t.jsxs("span",{children:["/ ",I.target]})]}),t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"checkbox",checked:I.isClaimed,onChange:T=>m(P,I.id,"isClaimed",T.target.checked),className:"w-4 h-4"}),t.jsx("span",{children:""})]})]})]},I.id))})]});return t.jsx(be,{title:`  : ${e.nickname}`,onClose:s,windowId:`user-edit-${e.id}`,initialWidth:600,children:t.jsxs("div",{className:"flex flex-col h-[60vh]",children:[t.jsxs("div",{className:"flex border-b border-color mb-4",children:[t.jsx("button",{onClick:()=>o("general"),className:`px-4 py-2 ${i==="general"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:" "}),t.jsx("button",{onClick:()=>o("strategic"),className:`px-4 py-2 ${i==="strategic"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:" "}),t.jsx("button",{onClick:()=>o("playful"),className:`px-4 py-2 ${i==="playful"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:" "}),t.jsx("button",{onClick:()=>o("quests"),className:`px-4 py-2 ${i==="quests"?"border-b-2 border-accent text-primary":"text-tertiary"}`,children:""}),t.jsx("button",{onClick:()=>o("danger"),className:`px-4 py-2 ${i==="danger"?"border-b-2 border-danger text-danger":"text-tertiary"}`,children:" "})]}),t.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[i==="general"&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:""}),t.jsx("input",{type:"text",name:"nickname",value:r.nickname,onChange:d,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"number",name:"strategyLevel",value:r.strategyLevel,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" XP"}),t.jsx("input",{type:"number",name:"strategyXp",value:r.strategyXp,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"number",name:"playfulLevel",value:r.playfulLevel,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" XP"}),t.jsx("input",{type:"number",name:"playfulXp",value:r.playfulXp,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:""}),t.jsx("input",{type:"number",name:"gold",value:r.gold,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:""}),t.jsx("input",{type:"number",name:"diamonds",value:r.diamonds,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"number",name:"mannerScore",value:r.mannerScore,onChange:c,className:"bg-tertiary p-1 rounded"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center",children:[t.jsx("label",{children:" "}),t.jsx("input",{type:"checkbox",name:"isAdmin",checked:!!r.isAdmin,onChange:u,className:"w-5 h-5",disabled:e.id===n.id,title:e.id===n.id?"     .":""})]})]}),i==="strategic"&&t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center font-bold text-sm mb-2 px-1",children:[t.jsx("span",{className:"col-span-1",children:" "}),t.jsx("span",{children:" "})]}),i==="strategic"&&x(at),i==="playful"&&t.jsxs("div",{className:"grid grid-cols-2 gap-2 items-center font-bold text-sm mb-2 px-1",children:[t.jsx("span",{className:"col-span-1",children:" "}),t.jsx("span",{children:" "})]}),i==="playful"&&x(St),i==="quests"&&t.jsxs("div",{className:"space-y-4",children:[t.jsx(j,{title:" ",questType:"daily",questData:(w=r.quests)==null?void 0:w.daily}),t.jsx(j,{title:" ",questType:"weekly",questData:(k=r.quests)==null?void 0:k.weekly}),t.jsx(j,{title:" ",questType:"monthly",questData:(C=r.quests)==null?void 0:C.monthly})]}),i==="danger"&&t.jsxs("div",{className:"space-y-4 p-4 border border-danger/50 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-bold text-danger",children:":    ."}),t.jsx(F,{onClick:()=>b("stats"),colorScheme:"yellow",className:"w-full",children:"  "}),t.jsx(F,{onClick:()=>b("full"),colorScheme:"orange",className:"w-full",children:"   "}),t.jsx(F,{onClick:g,colorScheme:"red",className:"w-full",children:" "})]})]}),t.jsxs("div",{className:"flex justify-end gap-4 mt-4 pt-4 border-t border-color",children:[t.jsx(F,{onClick:s,colorScheme:"gray",children:""}),t.jsx(F,{onClick:v,colorScheme:"green",children:""})]})]})})},mb=({allUsers:e,onAction:n,onBack:s,currentUser:l})=>{const[r,a]=f.useState(""),[i,o]=f.useState(null),[c,d]=f.useState(""),[u,p]=f.useState(""),[m,h]=f.useState(""),y=b=>{if(b.preventDefault(),!c||!u||!m){alert("  .");return}n({type:"ADMIN_CREATE_USER",payload:{username:c,password:u,nickname:m}}),d(""),p(""),h("")},v=f.useMemo(()=>{if(!r.trim())return e;const b=r.toLowerCase();return e.filter(g=>g.nickname.toLowerCase().includes(b)||g.username.toLowerCase().includes(b))},[e,r]);return t.jsxs("div",{className:"space-y-8 bg-primary text-primary",children:[i&&t.jsx(ub,{user:i,currentUser:l,onClose:()=>o(null),onAction:n}),t.jsxs("header",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-3xl font-bold",children:" "}),t.jsx("button",{onClick:s,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsxs("div",{className:"lg:col-span-2 bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("h2",{className:"text-xl font-semibold",children:["  (",v.length,")"]}),t.jsx("input",{type:"text",placeholder:"   ...",value:r,onChange:b=>a(b.target.value),className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent w-1/3 p-2.5"})]}),t.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:t.jsxs("table",{className:"w-full text-sm text-left text-secondary",children:[t.jsx("thead",{className:"text-xs text-secondary uppercase bg-secondary sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",className:"px-6 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-6 py-3",children:""}),t.jsx("th",{scope:"col",className:"px-6 py-3",children:" (/)"}),t.jsx("th",{scope:"col",className:"px-6 py-3",children:""})]})}),t.jsx("tbody",{children:v.map(b=>t.jsxs("tr",{className:"bg-primary border-b border-color hover:bg-secondary/50",children:[t.jsxs("th",{scope:"row",className:"px-6 py-4 font-medium text-primary whitespace-nowrap",children:[" ",b.nickname," ",b.isAdmin&&t.jsx("span",{className:"text-xs text-purple-400 ml-2",children:"[]"})," "]}),t.jsx("td",{className:"px-6 py-4",children:b.username}),t.jsxs("td",{className:"px-6 py-4",children:["S.",b.strategyLevel," / P.",b.playfulLevel]}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("button",{onClick:()=>o(b),className:"font-medium text-blue-500 hover:underline",children:""})})]},b.id))})]})})]}),t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:"  "}),t.jsxs("form",{onSubmit:y,className:"space-y-4",children:[t.jsx("input",{type:"text",name:"username",value:c,onChange:b=>d(b.target.value),placeholder:"",className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5"}),t.jsx("input",{type:"password",name:"password",value:u,onChange:b=>p(b.target.value),placeholder:"",className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5"}),t.jsx("input",{type:"text",name:"nickname",value:m,onChange:b=>h(b.target.value),placeholder:"",className:"bg-secondary border border-color text-primary text-sm rounded-lg focus:ring-accent focus:border-accent block w-full p-2.5"}),t.jsx(F,{type:"submit",className:"w-full",children:""})]})]})]})]})},fb=({onAddItem:e,onClose:n})=>{const[s,l]=f.useState("equipment"),[r,a]=f.useState(null),[i,o]=f.useState(1),c=f.useMemo(()=>{switch(s){case"equipment":return vc;case"consumable":return vs;case"material":return Object.values(Zt);default:return[]}},[s]),d=()=>{r&&i>0&&(e({...r,quantity:i}),a(null),o(1))};return t.jsx(be,{title:" ",onClose:n,windowId:"mail-item-selection",initialWidth:600,children:t.jsxs("div",{className:"h-[60vh] flex flex-col",children:[t.jsxs("div",{className:"flex bg-tertiary/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>l("equipment"),className:`flex-1 py-2 text-sm font-semibold rounded-md ${s==="equipment"?"bg-accent":"text-tertiary"}`,children:""}),t.jsx("button",{onClick:()=>l("consumable"),className:`flex-1 py-2 text-sm font-semibold rounded-md ${s==="consumable"?"bg-accent":"text-tertiary"}`,children:""}),t.jsx("button",{onClick:()=>l("material"),className:`flex-1 py-2 text-sm font-semibold rounded-md ${s==="material"?"bg-accent":"text-tertiary"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 grid grid-cols-4 gap-2",children:c.map(u=>t.jsxs("div",{onClick:()=>a({name:u.name,type:u.type}),className:`p-2 rounded-lg border-2 ${(r==null?void 0:r.name)===u.name?"border-accent ring-2 ring-accent":"border-color bg-secondary/50"} cursor-pointer flex flex-col items-center`,children:[t.jsx("img",{src:u.image,alt:u.name,className:"w-16 h-16 object-contain"}),t.jsx("span",{className:"text-xs text-center mt-1",children:u.name})]},u.name))}),t.jsxs("div",{className:"flex-shrink-0 mt-4 pt-4 border-t border-color flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{children:": "}),t.jsx("input",{type:"number",value:i,onChange:u=>o(Math.max(1,parseInt(u.target.value,10)||1)),className:"bg-tertiary w-20 p-1 rounded"})]}),t.jsx(F,{onClick:d,disabled:!r,children:"  "})]})]})})},xb=({allUsers:e,onAction:n,onBack:s})=>{const[l,r]=f.useState("all"),[a,i]=f.useState(""),[o,c]=f.useState(""),[d,u]=f.useState(""),[p,m]=f.useState(0),[h,y]=f.useState(0),[v,b]=f.useState(0),[g,x]=f.useState(7),[j,w]=f.useState([]),[k,C]=f.useState(!1),[S,P]=f.useState([]),_=T=>{const B=T.target.value;if(i(B),B.length>1){const R=e.filter(A=>A.nickname.toLowerCase().includes(B.toLowerCase())||A.username.toLowerCase().includes(B.toLowerCase())).map(A=>A.nickname).slice(0,5);w(R)}else w([])},I=T=>{if(T.preventDefault(),!o.trim()||!d.trim()){alert("   .");return}if(l==="specific"&&!a.trim()){alert("       .");return}n({type:"ADMIN_SEND_MAIL",payload:{targetSpecifier:l==="all"?"all":a,title:o,message:d,expiresInDays:g,attachments:{gold:p,diamonds:h,actionPoints:v,items:S}}}),c(""),u(""),m(0),y(0),b(0),x(7),i(""),P([])};return t.jsxs("div",{className:"max-w-4xl mx-auto bg-primary text-primary",children:[k&&t.jsx(fb,{onClose:()=>C(!1),onAddItem:T=>P(B=>[...B,T])}),t.jsxs("header",{className:"flex justify-between items-center mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold",children:"  "}),t.jsx("button",{onClick:s,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsx("div",{className:"bg-panel border border-color p-6 rounded-lg shadow-lg text-on-panel",children:t.jsxs("form",{onSubmit:I,className:"space-y-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"targetType",value:"all",checked:l==="all",onChange:()=>r("all"),className:"mr-2"})," "]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"targetType",value:"specific",checked:l==="specific",onChange:()=>r("specific"),className:"mr-2"})," "]})]})]}),l==="specific"&&t.jsxs("div",{className:"relative",children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:"  "}),t.jsx("input",{type:"text",value:a,onChange:_,className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5",required:!0}),j.length>0&&t.jsx("ul",{className:"absolute z-10 w-full bg-secondary border border-color rounded-lg mt-1",children:j.map(T=>t.jsx("li",{onClick:()=>{i(T),w([])},className:"px-4 py-2 hover:bg-accent cursor-pointer",children:T},T))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:""}),t.jsx("input",{type:"text",value:o,onChange:T=>c(T.target.value),required:!0,className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:""}),t.jsx("textarea",{value:d,onChange:T=>u(T.target.value),rows:4,required:!0,className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:"  (0 = )"}),t.jsx("input",{type:"number",min:"0",value:g,onChange:T=>x(parseInt(T.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsx("input",{type:"number",min:"0",value:v,onChange:T=>b(parseInt(T.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsx("input",{type:"number",min:"0",value:p,onChange:T=>m(parseInt(T.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block mb-1 font-medium text-secondary",children:" "}),t.jsx("input",{type:"number",min:"0",value:h,onChange:T=>y(parseInt(T.target.value,10)||0),className:"bg-secondary border border-color text-primary rounded-lg block w-full p-2.5"})]})]}),t.jsxs("div",{className:"pt-2 border-t border-color",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("label",{className:"block font-medium text-secondary",children:["  (",S.length,")"]}),t.jsx(F,{type:"button",onClick:()=>C(!0),colorScheme:"blue",className:"!py-1 !text-xs",children:" "})]}),t.jsxs("div",{className:"bg-tertiary/50 p-2 rounded-md min-h-[50px] space-y-1",children:[S.map((T,B)=>t.jsxs("div",{className:"flex justify-between items-center bg-primary/50 p-1 rounded",children:[t.jsxs("span",{children:[T.name," x ",T.quantity]}),t.jsx("button",{type:"button",onClick:()=>P(R=>R.filter((A,L)=>L!==B)),className:"text-red-500 hover:text-red-400 font-bold px-2",children:"X"})]},B)),S.length===0&&t.jsx("p",{className:"text-tertiary text-center text-xs py-2",children:"  ."})]})]}),t.jsx(F,{type:"submit",className:"w-full py-3",colorScheme:"green",children:""})]})})]})},pb=e=>{const{gameModeAvailability:n,announcements:s,globalOverrideAnnouncement:l,announcementInterval:r,onAction:a,onBack:i}=e,[o,c]=f.useState(""),[d,u]=f.useState((l==null?void 0:l.message)||""),[p,m]=f.useState(s),[h,y]=f.useState(r),v=f.useRef(null),b=f.useRef(null);f.useEffect(()=>{m(s)},[s]),f.useEffect(()=>{y(r)},[r]),f.useEffect(()=>{u((l==null?void 0:l.message)||"")},[l]);const g=()=>{if(v.current===null||b.current===null||v.current===b.current){v.current=null,b.current=null;return}const k=[...p],C=k.splice(v.current,1)[0];k.splice(b.current,0,C),v.current=null,b.current=null,m(k),a({type:"ADMIN_REORDER_ANNOUNCEMENTS",payload:{announcements:k}})},x=k=>{k.preventDefault(),o.trim()&&(a({type:"ADMIN_ADD_ANNOUNCEMENT",payload:{message:o}}),c(""))},j=k=>{k.preventDefault(),d.trim()&&a({type:"ADMIN_SET_OVERRIDE_ANNOUNCEMENT",payload:{message:d}})},w=f.useMemo(()=>[...at,...St],[]);return t.jsxs("div",{className:"space-y-8 bg-primary text-primary",children:[t.jsxs("header",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-3xl font-bold",children:" "}),t.jsx("button",{onClick:i,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsx("div",{className:"space-y-8",children:t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:"  "}),t.jsx("div",{className:"grid grid-cols-2 gap-3 text-sm",children:w.map(k=>t.jsxs("label",{className:"flex items-center gap-2 p-2 bg-secondary/50 rounded-md",children:[t.jsx("input",{type:"checkbox",checked:n[k.mode]??k.available,onChange:C=>a({type:"ADMIN_TOGGLE_GAME_MODE",payload:{mode:k.mode,isAvailable:C.target.checked}}),className:"w-4 h-4"}),t.jsx("span",{children:k.mode})]},k.mode))})]})}),t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:" "}),t.jsx("div",{className:"space-y-3 mb-4 max-h-60 overflow-y-auto",children:p.map((k,C)=>t.jsxs("div",{draggable:!0,onDragStart:()=>v.current=C,onDragEnter:()=>b.current=C,onDragEnd:g,onDragOver:S=>S.preventDefault(),className:"flex items-center justify-between p-2 bg-secondary/50 rounded-md cursor-grab",children:[t.jsx("span",{className:"text-sm",children:k.message}),t.jsx("button",{onClick:()=>a({type:"ADMIN_REMOVE_ANNOUNCEMENT",payload:{id:k.id}}),className:"text-red-500 hover:text-red-400 font-bold",children:"X"})]},k.id))}),t.jsxs("form",{onSubmit:x,className:"flex gap-2",children:[t.jsx("input",{type:"text",value:o,onChange:k=>c(k.target.value),placeholder:" ...",className:"flex-grow bg-secondary border border-color rounded-lg p-2 text-sm"}),t.jsx(F,{type:"submit",colorScheme:"green",className:"!text-sm",children:""})]}),t.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[t.jsx("label",{className:"text-sm",children:"():"}),t.jsx("input",{type:"number",min:"1",max:"60",value:h,onChange:k=>y(parseInt(k.target.value,10)),className:"w-20 bg-secondary border border-color rounded-lg p-1 text-sm"}),t.jsx(F,{onClick:()=>a({type:"ADMIN_SET_ANNOUNCEMENT_INTERVAL",payload:{interval:h}}),className:"!text-xs",children:""})]})]}),t.jsxs("div",{className:"bg-panel border border-color text-on-panel p-6 rounded-lg shadow-lg",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4 border-b border-color pb-2",children:"  "}),t.jsxs("form",{onSubmit:j,className:"flex gap-2",children:[t.jsx("input",{type:"text",value:d,onChange:k=>u(k.target.value),placeholder:"  ...",className:"flex-grow bg-secondary border border-color rounded-lg p-2 text-sm"}),t.jsx(F,{type:"submit",colorScheme:"yellow",className:"!text-sm",children:""})]}),l&&t.jsx(F,{onClick:()=>a({type:"ADMIN_CLEAR_OVERRIDE_ANNOUNCEMENT"}),colorScheme:"red",className:"mt-2 w-full !text-sm",children:"  "})]})]})]})]})},gb=()=>{const[e,n]=f.useState("dashboard"),{currentUserWithStatus:s,allUsers:l,liveGames:r,adminLogs:a,gameModeAvailability:i,announcements:o,globalOverrideAnnouncement:c,announcementInterval:d,handlers:u}=De(),p=()=>{e==="dashboard"?window.location.hash="#/profile":n("dashboard")},m={currentUser:s,allUsers:l,liveGames:Object.values(r),adminLogs:a,onAction:u.handleAction,onBack:p,gameModeAvailability:i,announcements:o,globalOverrideAnnouncement:c,announcementInterval:d},h=()=>{switch(e){case"userManagement":return t.jsx(mb,{...m});case"mailSystem":return t.jsx(xb,{...m});case"serverSettings":return t.jsx(pb,{...m});case"dashboard":default:return t.jsx(db,{onNavigate:n,onBackToProfile:p,...m})}};return t.jsx("div",{className:"p-4 lg:p-8",children:h()})},hb=({onClose:e,isTopmost:n})=>{const s=l=>{const r=l.rankStart===l.rankEnd?`${l.rankStart}`:`${l.rankStart}-${l.rankEnd}`;let a="",i="";switch(l.outcome){case"promote":a="",i="text-green-400";break;case"maintain":a="",i="text-gray-400";break;case"demote":a="",i="text-red-400";break}return t.jsxs("li",{className:"flex justify-between items-center bg-gray-700/50 px-3 py-1.5 rounded-md",children:[t.jsx("span",{className:"font-semibold",children:r}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"flex items-center gap-1 text-yellow-300",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"}),l.diamonds]}),t.jsx("span",{className:`font-bold w-12 text-center ${i}`,children:a})]})]},l.rankStart)};return t.jsx(be,{title:"  ",onClose:e,windowId:"league-tier-info-modal",initialWidth:550,isTopmost:n,children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-sm text-gray-300 text-center",children:" 16   // ,       ."}),t.jsx("ul",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-2",children:nl.map(l=>{const r=u0[l.tier];return t.jsxs("li",{className:"p-3 bg-gray-900/50 rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("img",{src:l.icon,alt:l.name,className:"w-12 h-12 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold",children:l.name}),t.jsxs("p",{className:"text-xs text-gray-400",children:["  ",l.scoreThreshold.toLocaleString()," "]})]})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700/50",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-400 mb-1.5",children:" "}),t.jsx("ul",{className:"space-y-1 text-xs",children:r.map(s)})]})]},l.tier)})})]})})},yb=()=>{const e=[{arena:"",rank:1,points:32},{arena:"",rank:2,points:28},{arena:"",rank:3,points:24},{arena:"",rank:1,points:46},{arena:"",rank:2,points:40},{arena:"",rank:3,points:34},{arena:"",rank:1,points:58},{arena:"",rank:2,points:50},{arena:"",rank:3,points:42}];return t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full flex flex-col",children:[t.jsx("h3",{className:"text-lg font-bold text-center mb-4 flex-shrink-0",children:"   "}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 space-y-4",children:[{arena:"",title:""},{arena:"",title:""},{arena:"",title:""}].map(n=>t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-md shadow-inner",children:[t.jsx("h4",{className:"text-md font-bold text-accent mb-2 border-b border-accent/50 pb-1",children:n.title}),t.jsx("div",{className:"space-y-1",children:e.filter(s=>s.arena===n.arena).map((s,l)=>{const r=s.rank===1?"text-yellow-400":s.rank===2?"text-gray-400":s.rank===3?"text-amber-600":"";return t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsxs("span",{className:"font-semibold",children:[s.rank,""]}),t.jsxs("span",{className:`font-bold ${r}`,children:[s.points,""]})]},l)})})]},n.arena))})]})},Ir=e=>{let n=0;if(e.length===0)return n;for(let s=0;s<e.length;s++){const l=e.charCodeAt(s);n=(n<<5)-n+l,n|=0}return n},Ss=e=>{const n=Math.sin(e)*1e4;return n-Math.floor(n)},bb=({setHasRankChanged:e})=>{const{currentUserWithStatus:n,allUsers:s,handlers:l}=De(),r=f.useRef(null),[a,i]=f.useState(""),[o,c]=f.useState(()=>{const p=Date.now(),m=new Date(p+324e5);return new Date(m.getFullYear(),m.getMonth(),m.getDate()).getTime()});f.useEffect(()=>{const p=setInterval(()=>{const m=Date.now(),h=new Date(m+324e5),y=new Date(h.getFullYear(),h.getMonth(),h.getDate()).getTime();y!==o&&c(y)},6e4);return()=>clearInterval(p)},[o]),f.useEffect(()=>{const u=()=>{const m=new Date,h=m.getDay(),y=h===0?1:8-h,v=new Date(m.getFullYear(),m.getMonth(),m.getDate()+y);v.setHours(0,0,0,0);const b=v.getTime()-m.getTime(),g=Math.floor(b/(1e3*60*60*24)),x=Math.floor(b%(1e3*60*60*24)/(1e3*60*60)),j=Math.floor(b%(1e3*60*60)/(1e3*60)),w=Math.floor(b%(1e3*60)/1e3);i(`${g}D ${String(x).padStart(2,"0")}:${String(j).padStart(2,"0")}:${String(w).padStart(2,"0")}`)};u();const p=setInterval(u,1e3);return()=>clearInterval(p)},[]);const d=f.useMemo(()=>{if(!(n!=null&&n.weeklyCompetitors))return[];const u=9*60*60*1e3,p=n.lastWeeklyCompetitorsUpdate||o,m=new Date(p+u);m.setHours(0,0,0,0);const h=Math.max(0,o-m.getTime()),y=Math.floor(h/(1e3*60*60*24));let v=n.weeklyCompetitors.map(g=>{if(g.id.startsWith("bot-")){let x=0;for(let k=1;k<=y;k++){const C=`${g.id}-${new Date(m.getTime()+k*24*60*60*1e3).toISOString().slice(0,10)}`,S=Ir(C),P=Ss(S),_=Math.floor(P*26);x+=_}const j=g.initialScore+x,w=j-g.initialScore;return{...g,liveScore:j,scoreChange:w}}else{const x=s.find(k=>k.id===g.id),j=x?x.tournamentScore:g.initialScore,w=j-g.initialScore;return{...g,liveScore:j,scoreChange:w}}});const b=16;if(v.length<b){const g=b-v.length;for(let x=0;x<g;x++){const j=`bot-${o}-${x}`,w=Ir(j),k=1e3+Math.floor(Ss(w)*500),C=Te[Math.floor(Ss(w+1)*Te.length)],S=Re[Math.floor(Ss(w+2)*Re.length)];let P=0;for(let L=1;L<=y;L++){const Q=`${j}-${new Date(m.getTime()+L*24*60*60*1e3).toISOString().slice(0,10)}`,q=Ir(Q),O=Ss(q),U=Math.floor(O*26);P+=U}const _=k+P,I=_-k,T=["","","","","","","","","","","","","","100%","","","","",""];let B=`Bot ${x+1}`;const R=v.filter(L=>L.id.startsWith("bot-")).map(L=>L.nickname),A=T.filter(L=>!R.includes(L));if(A.length>0){const L=Ir(j+"nickname");B=A[Math.floor(Ss(L)*A.length)]}else T.length>0&&(B=`${T[x%T.length]} ${Math.floor(Math.random()*100)}`);v.push({id:j,nickname:B,avatarId:C.id,borderId:S.id,initialScore:k,liveScore:_,scoreChange:I,league:n.league})}}return v.sort((g,x)=>x.liveScore-g.liveScore)},[n==null?void 0:n.weeklyCompetitors,n==null?void 0:n.lastWeeklyCompetitorsUpdate,s,o]);return f.useEffect(()=>{if(!n)return;const u=d.findIndex(p=>p.id===n.id)+1;u>0&&(r.current!==null&&r.current!==u&&e(!0),r.current=u)},[d,n,e]),!n||!n.weeklyCompetitors||n.weeklyCompetitors.length===0?t.jsx("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0 items-center justify-center text-gray-500",children:"     ..."}):t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0",children:[t.jsxs("div",{className:"flex-shrink-0 text-center mb-3 border-b border-gray-700 pb-2",children:[t.jsx("h2",{className:"text-xl font-bold",children:"  "}),t.jsx("p",{className:"text-sm text-yellow-300 font-mono",children:a})]}),t.jsx("ul",{className:"space-y-1.5 overflow-y-auto pr-2 flex-grow min-h-0",children:d.map((u,p)=>{var j,w;const m=p+1,h=u.id===n.id,y=u.scoreChange>0?"text-green-400":u.scoreChange<0?"text-red-400":"text-gray-400",v=u.scoreChange>0?"":u.scoreChange<0?"":"-",b=(j=Te.find(k=>k.id===u.avatarId))==null?void 0:j.url,g=(w=Re.find(k=>k.id===u.borderId))==null?void 0:w.url,x=!h&&!u.id.startsWith("bot-");return t.jsxs("li",{className:`flex items-center gap-3 p-1.5 rounded-md ${h?"bg-blue-900/50":"bg-gray-900/50"} ${x?"transition-colors cursor-pointer hover:bg-gray-700/50":""}`,onClick:x?()=>l.openViewingUser(u.id):void 0,title:x?`${u.nickname}  `:"",children:[t.jsx("span",{className:"font-bold text-lg w-6 text-center flex-shrink-0",children:m}),t.jsx(Ce,{userId:u.id,userName:u.nickname,avatarUrl:b,borderUrl:g,size:28}),t.jsx("span",{className:"flex-grow font-semibold text-sm truncate",children:u.nickname}),t.jsxs("div",{className:"flex items-baseline gap-1 text-xs",children:[t.jsx("span",{className:"font-mono text-yellow-300",children:u.liveScore.toLocaleString()}),t.jsxs("span",{className:y,children:["(",v,Math.abs(u.scoreChange),")"]})]})]},u.id)})})]})},Ru=({user:e,rank:n,isMyRankDisplay:s})=>{var x,j;const{currentUserWithStatus:l,handlers:r}=De();if(!l)return null;const a=e.tournamentScore||0,i=f.useMemo(()=>n===1?t.jsx("span",{className:"text-3xl",role:"img","aria-label":"Gold Trophy",children:""}):n===2?t.jsx("span",{className:"text-3xl",role:"img","aria-label":"Silver Trophy",children:""}):n===3?t.jsx("span",{className:"text-3xl",role:"img","aria-label":"Bronze Trophy",children:""}):t.jsx("span",{className:"text-2xl font-bold text-gray-300",children:n}),[n]),o=!s&&e.id===l.id,c="flex items-center rounded-lg",d="bg-yellow-900/40 border border-yellow-700",u="bg-blue-900/60 border border-blue-600",p="bg-gray-900/50",m=!s&&e.id!==l.id,h=`${c} ${s?d:o?u:p} p-1.5 lg:p-2 ${m?"cursor-pointer hover:bg-gray-700/50":""}`,y=(x=Te.find(w=>w.id===e.avatarId))==null?void 0:x.url,v=(j=Re.find(w=>w.id===e.borderId))==null?void 0:j.url,b=nl.find(w=>w.tier===e.league),g=b==null?void 0:b.icon;return t.jsxs("li",{className:h,onClick:m?()=>r.openViewingUser(e.id):void 0,title:m?`${e.nickname}  `:"",children:[t.jsx("div",{className:"w-12 text-center flex-shrink-0 flex flex-col items-center justify-center",children:i}),g&&t.jsx("img",{src:g,alt:e.league,className:"w-8 h-8 mr-2 flex-shrink-0",title:e.league}),t.jsx(Ce,{userId:e.id,userName:e.nickname,size:32,avatarUrl:y,borderUrl:v}),t.jsxs("div",{className:"ml-2 lg:ml-3 flex-grow overflow-hidden",children:[t.jsx("p",{className:"font-semibold text-sm truncate",children:e.nickname}),t.jsxs("p",{className:"text-xs text-yellow-400 font-mono",children:[a.toLocaleString(),""]})]})]})},vb=()=>{const{currentUserWithStatus:e,allUsers:n,handlers:s}=De(),[l,r]=f.useState(nl[0].tier),[a,i]=f.useState(!1);f.useEffect(()=>{e!=null&&e.league&&r(e.league)},[e==null?void 0:e.league]);const o=f.useMemo(()=>e?[...n].filter(u=>u.league===l&&typeof u.tournamentScore=="number").sort((u,p)=>p.tournamentScore-u.tournamentScore):[],[n,l,e]),c=f.useMemo(()=>{if(!e)return{rank:-1,user:null};const u=[...n].filter(m=>m.league===e.league&&typeof m.tournamentScore=="number").sort((m,h)=>h.tournamentScore-m.tournamentScore),p=u.findIndex(m=>m.id===e.id);return{rank:p!==-1?p+1:-1,user:p!==-1?u[p]:null}},[n,e]);if(!e)return t.jsx("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0 items-center justify-center text-gray-500",children:"   ..."});const d=o.slice(0,100);return t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 flex flex-col shadow-lg h-full min-h-0",children:[a&&t.jsx(hb,{onClose:()=>i(!1)}),t.jsxs("div",{className:"flex justify-between items-center mb-3 border-b border-gray-700 pb-2 flex-shrink-0",children:[t.jsx("h2",{className:"text-xl font-bold",children:" "}),t.jsx("button",{onClick:()=>i(!0),className:"text-xs bg-gray-600 hover:bg-gray-500 text-white font-bold px-2 py-1 rounded-md transition-colors",children:" "})]}),t.jsx("div",{className:"flex flex-nowrap justify-start bg-gray-900/50 p-1 rounded-lg mb-3 flex-shrink-0 gap-1 tier-tabs-container overflow-x-auto",children:nl.map(u=>t.jsx("button",{onClick:()=>r(u.tier),className:`p-1 rounded-md transition-all duration-200 flex-shrink-0 ${l===u.tier?"bg-purple-600 ring-2 ring-purple-400":"hover:bg-gray-600"}`,title:u.name,children:t.jsx("img",{src:u.icon,alt:u.name,className:"w-10 h-10"})},u.tier))}),c.user&&t.jsx("div",{className:"flex-shrink-0 mb-3",children:t.jsx(Ru,{user:c.user,rank:c.rank,isMyRankDisplay:!0})}),t.jsx("ul",{className:"space-y-2 overflow-y-auto pr-2 flex-grow min-h-0",children:d.length>0?d.map((u,p)=>t.jsx(Ru,{user:u,rank:p+1,isMyRankDisplay:!1},u.id)):t.jsxs("p",{className:"text-center text-gray-500 pt-8",children:[l,"    ."]})},l)]})},Ni=({type:e,onClick:n,onContinue:s,inProgress:l})=>{const r=Ml[e],a=l&&l.status==="round_in_progress",i=l&&(l.status==="complete"||l.status==="eliminated"),o=l&&(l.status==="bracket_ready"||l.status==="round_complete");let c="",d=n;return l&&(a?c=" ":i?c=" ":o&&(c=""),d=s),t.jsxs("div",{className:"group bg-gray-800 rounded-lg p-3 flex flex-col text-center transition-all transform hover:-translate-y-1 shadow-lg hover:shadow-purple-500/30 cursor-pointer h-full",onClick:d,children:[t.jsx("h2",{className:"text-lg font-bold mb-2",children:r.name}),t.jsx("div",{className:"w-full aspect-video bg-gray-700 rounded-md flex items-center justify-center text-gray-500 overflow-hidden relative flex-grow",children:t.jsx("img",{src:r.image,alt:r.name,className:"w-full h-full object-cover"})}),t.jsxs("span",{className:"font-bold text-sm mt-2 text-yellow-300",children:[c," "]})]})},ki=e=>e||null,jb=()=>{const{currentUserWithStatus:e,allUsers:n,handlers:s,waitingRoomChats:l}=De(),[r,a]=f.useState(null),[i,o]=f.useState(window.innerWidth<1024),[c,d]=f.useState(!1),[u,p]=f.useState(!1),[m,h]=f.useState(null);if(!e)return t.jsx("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)] relative text-gray-500 items-center justify-center",children:"   ..."});const y=ki(e.lastNeighborhoodTournament),v=ki(e.lastNationalTournament),b=ki(e.lastWorldTournament),g=f.useCallback(async j=>{await s.handleAction({type:"START_TOURNAMENT_SESSION",payload:{type:j}}),window.location.hash=`#/tournament/${j}`},[s]),x=f.useCallback(async j=>{await s.handleAction({type:"START_TOURNAMENT_ROUND",payload:{type:j}}),window.location.hash=`#/tournament/${j}`},[s]);return t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)] relative",children:[t.jsxs("header",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[t.jsx("button",{onClick:()=>window.location.hash="#/profile",className:"transition-transform active:scale-90 filter hover:drop-shadow-lg",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-10 h-10"})}),t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:""}),t.jsx("div",{className:"w-10"})," "]}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-6 min-h-0",children:[t.jsxs("main",{className:"flex-grow grid grid-cols-12 gap-6 min-h-0",children:[t.jsxs("div",{className:"col-span-12 grid grid-cols-3 gap-4 flex-shrink-0",children:[t.jsx(Ni,{type:"neighborhood",onClick:()=>g("neighborhood"),onContinue:()=>x("neighborhood"),inProgress:y||null}),t.jsx(Ni,{type:"national",onClick:()=>g("national"),onContinue:()=>x("national"),inProgress:v||null}),t.jsx(Ni,{type:"world",onClick:()=>g("world"),onContinue:()=>x("world"),inProgress:b||null})]}),t.jsx("div",{className:"col-span-8 bg-gray-800/50 rounded-lg shadow-lg min-h-0",children:t.jsx(Xl,{messages:l.global||[],mode:"global",onAction:s.handleAction,onViewUser:s.openViewingUser,locationPrefix:"[]"})}),t.jsx("div",{className:"col-span-4",children:t.jsx(yb,{})})]}),t.jsxs("aside",{className:"hidden lg:flex flex-col lg:w-[480px] flex-shrink-0 gap-6",children:[t.jsxs("div",{className:"flex-1 flex flex-row gap-4 items-stretch min-h-0",children:[t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(bb,{setHasRankChanged:p})}),t.jsx("div",{className:"w-24 flex-shrink-0",children:t.jsx(Hs,{fillHeight:!0})})]}),t.jsx("div",{className:"flex-1 min-h-0",children:t.jsx(vb,{})})]})]})]})},Ex=({datasets:e,maxStatValue:n=200,size:s=250})=>{const l=s/2,r=Object.values(N),a=r.length,i=Math.PI*2/a,o=(m,h)=>{const y=i*h-Math.PI/2,v=Math.min(m,n)/n*(l*.8);return{x:l+v*Math.cos(y),y:l+v*Math.sin(y)}},c=[],d=[],u=[],p=s<150?8:10;for(let m=0;m<a;m++){const h=o(n,m);c.push(t.jsx("line",{x1:l,y1:l,x2:h.x,y2:h.y,stroke:"rgba(255, 255, 255, 0.2)",strokeWidth:"1"},`axis-${m}`));const y=o(n*1.15,m);d.push(t.jsx("text",{x:y.x,y:y.y,fontSize:p,fill:"rgba(255, 255, 255, 0.7)",textAnchor:"middle",dy:".3em",children:r[m]},`label-${m}`))}for(let m=1;m<=4;m++){const h=m*.25,y=r.map((v,b)=>o(n*h,b));u.push(t.jsx("polygon",{points:y.map(v=>`${v.x},${v.y}`).join(" "),fill:"none",stroke:"rgba(255, 255, 255, 0.2)",strokeWidth:"0.5"},`grid-${m}`))}return t.jsxs("svg",{viewBox:`0 0 ${s} ${s}`,width:"100%",height:"100%",children:[t.jsxs("g",{children:[u,c,d]}),e.map((m,h)=>{const v=r.map((b,g)=>o(m.stats[b]||0,g)).map(b=>`${b.x},${b.y}`).join(" ");return t.jsx("polygon",{points:v,fill:m.fill,stroke:m.color,strokeWidth:"2"},`dataset-${h}`)})]})},wb=e=>{try{const n=e.match(/SZ\[(\d+)\]/),s=n?parseInt(n[1],10):19,l=[],r=/;([BW])\[([a-s]{2})\]/g;let a;for(;(a=r.exec(e))!==null;){const i=a[1]==="B"?$.Black:$.White,o=a[2],c=o.charCodeAt(0)-97,d=o.charCodeAt(1)-97;l.push({player:i,x:c,y:d})}return{boardSize:s,moves:l}}catch(n){return console.error("Failed to parse SGF:",n),null}},Px=(e,n,s)=>{const l=[];return e>0&&l.push({x:e-1,y:n}),e<s-1&&l.push({x:e+1,y:n}),n>0&&l.push({x:e,y:n-1}),n<s-1&&l.push({x:e,y:n+1}),l},Nb=(e,n,s,l,r)=>{var d;if(n<0||n>=r||e<0||e>=r||((d=l[n])==null?void 0:d[e])!==s)return null;const a=[{x:e,y:n}],i=new Set([`${e},${n}`]);let o=0;const c=[{x:e,y:n}];for(;a.length>0;){const{x:u,y:p}=a.shift();for(const m of Px(u,p,r)){const h=`${m.x},${m.y}`,y=l[m.y][m.x];y===$.None?o++:y===s&&(i.has(h)||(i.add(h),a.push(m),c.push(m)))}}return{stones:c,liberties:o}},kb=({timeElapsed:e=0,fileIndex:n,showLastMoveOnly:s})=>{const[l,r]=f.useState(null),[a,i]=f.useState(!0),[o,c]=f.useState(null),d=140;f.useEffect(()=>{(async()=>{if(i(!0),c(null),n==null){r({boardSize:19,moves:[]}),i(!1);return}const C=`/sgf/Gibo${n}.sgf`;try{const S=await fetch(C);if(!S.ok)throw new Error(`Failed to fetch SGF file: ${S.statusText}`);const P=await S.text(),_=wb(P);if(!_)throw new Error("Failed to parse SGF data.");r(_)}catch(S){c(S.message)}finally{i(!1)}})()},[n]);const u=f.useMemo(()=>{if(!l)return 0;if(s)return l.moves.length;if(e===0)return 0;const k=e/d,C=Math.floor(k*l.moves.length);return Math.min(C,l.moves.length)},[e,l,d,s]),p=f.useMemo(()=>{if(!l)return[];const{boardSize:k,moves:C}=l,S=Array(k).fill(null).map(()=>Array(k).fill($.None));for(let P=0;P<u;P++){const _=C[P];S[_.y]&&S[_.y][_.x]!==void 0&&(S[_.y][_.x]=_.player);const I=_.player===$.Black?$.White:$.Black,T=Px(_.x,_.y,k);for(const B of T)if(S[B.y][B.x]===I){const R=Nb(B.x,B.y,I,S,k);if(R&&R.liberties===0)for(const A of R.stones)S[A.y][A.x]=$.None}}return S},[u,l]),m=f.useMemo(()=>{const k=l==null?void 0:l.boardSize;return k?k===19?[{x:3,y:3},{x:9,y:3},{x:15,y:3},{x:3,y:9},{x:9,y:9},{x:15,y:9},{x:3,y:15},{x:9,y:15},{x:15,y:15}]:k===13?[{x:3,y:3},{x:9,y:3},{x:3,y:9},{x:9,y:9},{x:6,y:6}]:k===11?[{x:2,y:2},{x:8,y:2},{x:5,y:5},{x:2,y:8},{x:8,y:8}]:k===9?[{x:2,y:2},{x:6,y:2},{x:4,y:4},{x:2,y:6},{x:6,y:6}]:[]:[]},[l]);if(a)return t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"  ..."});if(o)return t.jsxs("div",{className:"flex items-center justify-center h-full text-red-400",children:[": ",o]});if(!l)return null;const{boardSize:h,moves:y}=l,v=300,b=v/h,g=b/2,x=b*.45,j=k=>({cx:g+k.x*b,cy:g+k.y*b}),w=y.slice(0,u);return t.jsx("div",{className:"w-full h-full bg-gray-900 rounded-lg overflow-hidden border-2 border-gray-700 relative",children:t.jsxs("svg",{viewBox:`0 0 ${v} ${v}`,className:"w-full h-full",children:[t.jsx("rect",{width:v,height:v,fill:"#DDAA77"}),Array.from({length:h}).map((k,C)=>t.jsxs("g",{children:[t.jsx("line",{x1:g+C*b,y1:g,x2:g+C*b,y2:v-g,stroke:"#54432a",strokeWidth:"0.5"}),t.jsx("line",{x1:g,y1:g+C*b,x2:v-g,y2:g+C*b,stroke:"#54432a",strokeWidth:"0.5"})]},C)),m.map((k,C)=>t.jsx("circle",{...j(k),r:h>9?3:2,fill:"#54432a"},`star-${C}`)),p.map((k,C)=>k.map((S,P)=>{if(S===$.None)return null;const{cx:_,cy:I}=j({x:P,y:C});let T=-1;for(let R=w.length-1;R>=0;R--)if(w[R].x===P&&w[R].y===C){T=R;break}const B=T===u-1;return t.jsxs("g",{children:[t.jsx("circle",{cx:_,cy:I,r:x,fill:S===$.Black?"black":"white"}),s&&T!==-1&&t.jsx("text",{x:_,y:I,textAnchor:"middle",dy:".35em",fontSize:x*1.2,fontWeight:"bold",fill:S===$.Black?"white":"black",children:T+1}),B&&t.jsx("circle",{cx:_,cy:I,r:x*.4,fill:"rgba(239, 68, 68, 0.8)",className:"animate-pulse"})]},`${P}-${C}`)}))]})})},Sb={early:[N.CombatPower,N.ThinkingSpeed,N.Concentration],mid:[N.CombatPower,N.Judgment,N.Concentration,N.Stability],end:[N.Calculation,N.Stability,N.Concentration]},Bu=({player:e,initialPlayer:n,allUsers:s,currentUserId:l,onViewUser:r,highlightPhase:a})=>{var m,h;if(!e)return t.jsx("div",{className:"p-2 text-center text-gray-500 flex items-center justify-center h-full bg-gray-900/50 rounded-lg",children:"  ..."});const i=f.useMemo(()=>s.find(y=>y.id===e.id),[s,e.id]),o=f.useMemo(()=>{const y={wins:0,losses:0};return i!=null&&i.stats&&Object.values(i.stats).forEach(v=>{y.wins+=v.wins,y.losses+=v.losses}),y},[i]),c=!e.id.startsWith("bot-")&&e.id!==l,d=(m=Te.find(y=>y.id===e.avatarId))==null?void 0:m.url,u=(h=Re.find(y=>y.id===e.borderId))==null?void 0:h.url,p=y=>a==="none"?!1:Sb[a].includes(y);return t.jsxs("div",{className:`bg-gray-900/50 p-3 rounded-lg flex flex-col items-center gap-2 h-full ${c?"cursor-pointer hover:bg-gray-700/50":""}`,onClick:c?()=>r(e.id):void 0,title:c?`${e.nickname}  `:"",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:d,borderUrl:u,size:40}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-bold text-base truncate",children:e.nickname}),t.jsxs("p",{className:"text-xs text-gray-400",children:["(",o.wins," ",o.losses,")"]})]})]}),t.jsxs("div",{className:"font-bold text-sm mt-1 relative",children:[": ",t.jsx("span",{className:"text-yellow-300",children:e.condition===1e3?"-":e.condition})]}),t.jsx("div",{className:"w-full grid grid-cols-2 gap-x-1 sm:gap-x-3 gap-y-0.5 text-xs mt-2 border-t border-gray-600 pt-2",children:Object.values(N).map(y=>{var x;const v=((x=n==null?void 0:n.stats)==null?void 0:x[y])??e.stats[y],g=e.stats[y]-v;return t.jsxs(Pn.Fragment,{children:[t.jsx("span",{className:`text-gray-400 ${p(y)?"text-yellow-400 font-bold":""}`,children:y}),t.jsxs("div",{className:"flex justify-end items-baseline relative",children:[t.jsx("span",{className:`font-mono text-white ${p(y)?"text-yellow-400 font-bold":""}`,children:e.stats[y]}),n&&g!==0&&t.jsxs("span",{className:`ml-1 font-bold ${g>0?"text-green-400":"text-red-400"}`,children:["(",g>0?"+":"",g,")"]})]})]},y)})})]})},Cb=({timeElapsed:e,totalDuration:n})=>{const s=e/n*100,l=Math.min(s,40/140*100),r=Math.min(Math.max(0,s-40/140*100),60/140*100),a=Math.min(Math.max(0,s-100/140*100),40/140*100);return t.jsxs("div",{children:[t.jsxs("div",{className:"w-full bg-gray-900 rounded-full h-2 flex border border-gray-600",children:[t.jsx("div",{className:"bg-green-500 h-full rounded-l-full",style:{width:`${l}%`},title:""}),t.jsx("div",{className:"bg-yellow-500 h-full",style:{width:`${r}%`},title:""}),t.jsx("div",{className:"bg-red-500 h-full rounded-r-full",style:{width:`${a}%`},title:""})]}),t.jsxs("div",{className:"flex text-xs text-gray-400 mt-1",children:[t.jsx("div",{style:{width:`${40/140*100}%`},children:""}),t.jsx("div",{style:{width:`${60/140*100}%`},className:"text-center",children:""}),t.jsx("div",{style:{width:`${40/140*100}%`},className:"text-right",children:""})]})]})},Ib=({p1Percent:e,p2Percent:n,p1Nickname:s,p2Nickname:l})=>t.jsxs("div",{children:[s&&l&&t.jsxs("div",{className:"flex justify-between text-xs px-1 mb-1 font-bold",children:[t.jsxs("span",{className:"truncate max-w-[45%]",children:[": ",s]}),t.jsxs("span",{className:"truncate max-w-[45%] text-right",children:[": ",l]})]}),t.jsxs("div",{className:"flex w-full h-3 bg-gray-700 rounded-full overflow-hidden border-2 border-black/30 relative",children:[t.jsx("div",{className:"bg-black transition-all duration-500 ease-in-out",style:{width:`${e}%`}}),t.jsx("div",{className:"bg-white transition-all duration-500 ease-in-out",style:{width:`${n}%`}}),t.jsx("div",{className:"absolute top-0 bottom-0 left-1/2 -translate-x-1/2 w-0.5 bg-gray-400/50",title:""})]})]}),Eb=e=>{const{text:n,isRandomEvent:s}=e;if(n.startsWith("  !")||n.startsWith("[]"))return t.jsx("strong",{className:"text-yellow-400",children:n});const l=/(\d+\.\d+|\d+\.5)/g,r=n.split(l);return t.jsx("span",{className:s?"text-cyan-400":"",children:r.map((a,i)=>l.test(a)?t.jsx("strong",{className:"text-yellow-400",children:a},i):a)})},Pb=({commentary:e,isSimulating:n})=>{const s=f.useRef(null);return f.useEffect(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[e]),t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsxs("h4",{className:"text-center font-bold text-sm mb-2 text-gray-400 py-1 flex-shrink-0",children:[" ",n&&t.jsx("span",{className:"ml-2 text-yellow-400 animate-pulse",children:"  ..."})]}),t.jsx("div",{ref:s,className:"flex-grow overflow-y-auto space-y-2 text-sm text-gray-300 p-2 bg-gray-900/40 rounded-md min-h-0",children:e.length>0?e.map((l,r)=>t.jsx("p",{className:"animate-fade-in break-words",children:Eb(l)},r)):t.jsx("p",{className:"text-gray-500 text-center h-full flex items-center justify-center",children:"   ..."})})]})},Tb=({tournamentState:e,currentUser:n,onAction:s})=>{var v;const l=e.status==="complete",r=e.status==="eliminated";if(!l)return r?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("h4",{className:"font-bold text-gray-400 mb-2",children:" "}),t.jsx("p",{className:"text-xs text-gray-500 mt-2 animate-pulse",children:"    ..."})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("h4",{className:"font-bold text-gray-400 mb-2",children:" "}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"   ."})]});const{type:a,rounds:i}=e,o=Ml[a],c=h0[a];let d=-1;if(a==="neighborhood"){const b={};e.players.forEach(j=>{b[j.id]=0}),i[0].matches.forEach(j=>{j.winner&&(b[j.winner.id]=(b[j.winner.id]||0)+1)});const g=[...e.players].sort((j,w)=>b[w.id]-b[j.id]);let x=-1;for(let j=0;j<g.length;j++)if(j===0?x=1:b[g[j].id]<b[g[j-1].id]&&(x=j+1),g[j].id===n.id){d=x;break}}else{const b=i.length;let g=-1;for(let x=0;x<b;x++){const w=i[x].matches.find(k=>k.isUserMatch);if(w&&((v=w.winner)==null?void 0:v.id)!==n.id){g=x;break}}if(g===-1)d=1;else{const x=o.players/Math.pow(2,g);if(b===3&&g===1){const j=i.find(w=>w.name==="3,4");j&&j.matches.some(k=>k.isUserMatch)?d=j.matches.some(C=>{var S;return C.isUserMatch&&((S=C.winner)==null?void 0:S.id)===n.id})?3:4:d=4}else d=x}}let u;a==="neighborhood"?u=d<=3?d:4:a==="national"?u=d<=4?d:5:d<=4?u=d:d<=8?u=5:u=9;const p=c==null?void 0:c.rewards[u];if(!p)return t.jsx("p",{className:"text-gray-500 flex items-center justify-center h-full",children:"  ."});const m=`${a}RewardClaimed`,h=!!n[m],y=()=>{!h&&l&&(Ee.claimReward(),s({type:"CLAIM_TOURNAMENT_REWARD",payload:{tournamentType:a}}))};return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx("h4",{className:"font-bold text-gray-400 mb-2",children:" "}),t.jsx("div",{className:"flex flex-row items-center justify-center gap-4",children:(p.items||[]).map((b,g)=>{const x="itemId"in b?b.itemId:b.name,j=vs.find(k=>k.name===x),w=(j==null?void 0:j.image)||"";return t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsxs("button",{onClick:y,disabled:h||!l,className:"relative w-16 h-16 transition-transform hover:scale-105 disabled:cursor-not-allowed",title:h?" ":l?" ":"      .",children:[t.jsx("img",{src:w,alt:x,className:`w-full h-full object-contain ${h||!l?"filter grayscale":""}`}),h&&t.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center text-3xl text-green-400",children:""})]}),t.jsxs("span",{className:"text-xs text-center",children:[x," x",b.quantity]})]},g)})}),!l&&!h&&t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"    "}),h&&t.jsx("p",{className:"text-xs text-green-400 mt-2",children:" ."})]})},Tx=({match:e,currentUser:n})=>{var c,d;const s=e.players[0],l=e.players[1],r=({player:u,isWinner:p})=>{var b,g;if(!u)return t.jsx("div",{className:"h-8 flex items-center",children:t.jsx("span",{className:"text-gray-600 truncate",children:"..."})});const m=!p&&e.isFinished?"opacity-60":"",h=p?"text-yellow-300":"",y=(b=Te.find(x=>x.id===u.avatarId))==null?void 0:b.url,v=(g=Re.find(x=>x.id===u.borderId))==null?void 0:g.url;return t.jsxs("div",{className:`flex items-center gap-2 ${m}`,children:[t.jsx(Ce,{userId:u.id,userName:u.nickname,avatarUrl:y,borderUrl:v,size:28}),t.jsx("span",{className:`truncate font-semibold ${h}`,children:u.nickname})]})},a=e.isFinished&&((c=e.winner)==null?void 0:c.id)===(s==null?void 0:s.id),i=e.isFinished&&((d=e.winner)==null?void 0:d.id)===(l==null?void 0:l.id),o=(s==null?void 0:s.id)===n.id||(l==null?void 0:l.id)===n.id;return t.jsxs("div",{className:`p-1.5 rounded-lg text-sm space-y-1 ${o?"bg-blue-900/40 border border-blue-700":"bg-gray-700/50"}`,children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(r,{player:s,isWinner:a}),a&&t.jsx("span",{className:"font-bold text-green-400",children:"W"})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(r,{player:l,isWinner:i}),i&&t.jsx("span",{className:"font-bold text-green-400",children:"W"})]})]})},Er=({name:e,matches:n,currentUser:s})=>t.jsxs("div",{className:"flex flex-col justify-around h-full gap-4 flex-shrink-0 w-44",children:[t.jsx("h5",{className:"text-center font-bold text-sm text-gray-400",children:e}),t.jsx("div",{className:"flex flex-col justify-around h-full gap-6",children:n==null?void 0:n.map(l=>t.jsx(Tx,{match:l,currentUser:s},l.id))})]}),Mb=({tournamentState:e,currentUser:n})=>{var v;const[s,l]=f.useState("matches"),{players:r,rounds:a,status:i,currentRoundRobinRound:o}=e,c=((v=a[0])==null?void 0:v.matches)||[],d=f.useMemo(()=>{const b={};return r.forEach(g=>{b[g.id]={wins:0,losses:0}}),c.forEach(g=>{if(g.isFinished&&g.winner){const x=g.winner.id;b[x]&&b[x].wins++;const j=g.players.find(w=>w&&w.id!==x);j&&b[j.id]&&b[j.id].losses++}}),b},[r,c]),u=f.useMemo(()=>[...r].sort((b,g)=>{var x,j;return(((x=d[g.id])==null?void 0:x.wins)||0)-(((j=d[b.id])==null?void 0:j.wins)||0)}),[r,d]),p=[[[0,5],[1,4],[2,3]],[[0,4],[5,3],[1,2]],[[0,3],[4,2],[5,1]],[[0,2],[3,1],[4,5]],[[0,1],[2,5],[3,4]]],m=i==="bracket_ready"?1:o||1,h=p[m-1],y=f.useMemo(()=>h?h.map(b=>{const g=r[b[0]].id,x=r[b[1]].id;return c.find(j=>{var w,k,C,S;return((w=j.players[0])==null?void 0:w.id)===g&&((k=j.players[1])==null?void 0:k.id)===x||((C=j.players[0])==null?void 0:C.id)===x&&((S=j.players[1])==null?void 0:S.id)===g})}).filter(b=>!!b):[],[h,r,c]);return t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsx("h4",{className:"font-bold text-center mb-2 flex-shrink-0 text-gray-300",children:" "}),t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-2 flex-shrink-0",children:[t.jsxs("button",{onClick:()=>l("matches"),className:`flex-1 py-1 text-xs font-semibold rounded-md transition-all ${s==="matches"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:[m,""]}),t.jsx("button",{onClick:()=>l("ranking"),className:`flex-1 py-1 text-xs font-semibold rounded-md transition-all ${s==="ranking"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "})]}),t.jsx("div",{className:"overflow-y-auto pr-2 flex-grow min-h-0",children:s==="matches"?t.jsx("div",{className:"flex flex-col items-center justify-around h-full gap-4",children:y.map(b=>t.jsx(Tx,{match:b,currentUser:n},b.id))}):t.jsx("ul",{className:"space-y-1.5",children:u.map((b,g)=>{const x=d[b.id],j=b.id===n.id;return t.jsxs("li",{className:`flex items-center gap-3 p-1.5 rounded-md ${j?"bg-blue-900/50":"bg-gray-700/50"}`,children:[t.jsx("span",{className:"font-bold text-lg w-6 text-center flex-shrink-0",children:g+1}),t.jsx("span",{className:"flex-grow font-semibold text-sm truncate",children:b.nickname}),t.jsx("div",{className:"flex items-baseline gap-2 text-xs",children:t.jsxs("span",{className:"font-mono",children:[x.wins," ",x.losses,""]})})]},b.id)})})})]})},_b=({rounds:e,currentUser:n,tournamentType:s})=>{const l=f.useMemo(()=>{const d=new Map;e.forEach(m=>d.set(m.name,m.matches));let u=[];if(s==="world")u=["16","8","4","  3/4"];else if(s==="national")u=["8","4","  3/4"];else return null;return u.map(m=>{let h=[];return m==="  3/4"?h=(d.get("")||[]).concat(d.get("3,4")||[]):h=d.get(m)||[],{name:m,matches:h,isInProgress:h.length>0&&h.some(y=>!y.isFinished)}}).filter(m=>m.matches.length>0)},[e,s]),r=f.useMemo(()=>{if(!l)return 0;const d=l.findIndex(u=>u.isInProgress);return d!==-1?d:Math.max(0,l.length-1)},[l]),[a,i]=f.useState(r);if(f.useEffect(()=>{i(r)},[r]),!l){const d=["16","8","4","3,4",""],u=[...e].sort((p,m)=>d.indexOf(p.name)-d.indexOf(m.name));return t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsx("h4",{className:"font-bold text-center mb-2 flex-shrink-0 text-gray-300",children:""}),t.jsx("div",{className:"flex-grow overflow-auto flex items-center justify-center p-2 space-x-4",children:u.map(p=>t.jsx(Er,{name:p.name,matches:p.matches,currentUser:n},p.id))})]})}const o=l[a],c=d=>{if(d.name==="  3/4"){const u=d.matches.filter(m=>{var h;return((h=e.find(y=>y.matches.includes(m)))==null?void 0:h.name)===""}),p=d.matches.filter(m=>{var h;return((h=e.find(y=>y.matches.includes(m)))==null?void 0:h.name)==="3,4"});return t.jsxs("div",{className:"flex flex-col justify-center items-center h-full gap-12 p-4",children:[t.jsx(Er,{name:"",matches:u,currentUser:n}),p.length>0&&t.jsx(Er,{name:"3,4",matches:p,currentUser:n})]})}return t.jsx("div",{className:"flex justify-center items-center h-full gap-4 p-4",children:t.jsx(Er,{name:d.name,matches:d.matches,currentUser:n})})};return t.jsxs("div",{className:"h-full flex flex-col min-h-0",children:[t.jsx("h4",{className:"font-bold text-center mb-2 flex-shrink-0 text-gray-300",children:""}),t.jsx("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-2 flex-shrink-0",children:l.map((d,u)=>t.jsx("button",{onClick:()=>i(u),className:`flex-1 py-1 text-xs font-semibold rounded-md transition-all ${a===u?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:d.name},d.name))}),t.jsx("div",{className:"flex-grow overflow-auto",children:o&&c(o)})]})},Ab=e=>{var oe,me,ve;const{tournament:n,currentUser:s,onBack:l,allUsersForRanking:r,onViewUser:a,onAction:i,onStartNextRound:o,onReset:c,onSkip:d,isMobile:u}=e,[p,m]=f.useState(null),[h,y]=f.useState({p1:null,p2:null}),v=f.useRef(n.status),b=f.useMemo(()=>Array.isArray(n.rounds)?n.rounds:[],[n.rounds]);f.useEffect(()=>(i({type:"ENTER_TOURNAMENT_VIEW"}),()=>{i({type:"LEAVE_TOURNAMENT_VIEW"})}),[i]),f.useEffect(()=>{const J=n.status,fe=v.current;if((J==="round_complete"||J==="eliminated"||J==="complete")&&fe==="round_in_progress"){const ye=[...b].reverse().flatMap(K=>K.matches).find(K=>K.isUserMatch&&K.isFinished);ye&&ye.sgfFileIndex&&m(ye.sgfFileIndex)}else if(J==="bracket_ready")m(null);else if(J==="round_in_progress"&&n.timeElapsed===1){const ye=n.currentSimulatingMatch;if(ye){const K=b[ye.roundIndex].matches[ye.matchIndex],W=n.players.find(V=>{var Y;return V.id===((Y=K.players[0])==null?void 0:Y.id)})||null,D=n.players.find(V=>{var Y;return V.id===((Y=K.players[1])==null?void 0:Y.id)})||null;y({p1:W?JSON.parse(JSON.stringify(W)):null,p2:D?JSON.parse(JSON.stringify(D)):null})}}else J!=="round_in_progress"&&y({p1:null,p2:null});v.current=J},[n,b]);const g=f.useCallback(()=>{n.status==="round_in_progress"?window.confirm(" .  ?     .")&&i({type:"FORFEIT_TOURNAMENT",payload:{type:n.type}}):l()},[l,i,n.status,n.type]),x=f.useCallback(()=>{window.confirm("  ?    .")&&i({type:"FORFEIT_TOURNAMENT",payload:{type:n.type}})},[i,n.type]),j=n.status==="round_in_progress",w=j&&n.currentSimulatingMatch?b[n.currentSimulatingMatch.roundIndex].matches[n.currentSimulatingMatch.matchIndex]:null,k=f.useMemo(()=>[...b].reverse().flatMap(J=>J.matches).find(J=>J.isUserMatch&&J.isFinished),[b]),C=j?w:k||b.flatMap(J=>J.matches).find(J=>J.isUserMatch)||((oe=b[0])==null?void 0:oe.matches[0]),S=f.useMemo(()=>{var J;if(n.status!=="complete")return null;if(n.type==="neighborhood"){const fe={};return n.players.forEach(ye=>fe[ye.id]=0),b[0].matches.forEach(ye=>{ye.winner&&fe[ye.winner.id]++}),[...n.players].sort((ye,K)=>fe[K.id]-fe[ye.id])[0]}else{const fe=b.find(ye=>ye.name==="");return(J=fe==null?void 0:fe.matches[0])==null?void 0:J.winner}},[n.status,n.type,n.players,b]),P=f.useMemo(()=>{var fe,ye;if(n.status==="complete"||n.status==="eliminated"){if(n.type==="neighborhood"){const W=b.flatMap(Z=>Z.matches).filter(Z=>Z.isUserMatch&&Z.isFinished),D=W.filter(Z=>{var le;return((le=Z.winner)==null?void 0:le.id)===s.id}).length,V=W.length-D,Y={};n.players.forEach(Z=>{Y[Z.id]=0}),b[0].matches.forEach(Z=>{Z.winner&&(Y[Z.winner.id]=(Y[Z.winner.id]||0)+1)});const ie=[...n.players].sort((Z,le)=>Y[le.id]-Y[Z.id]);let je=-1,E=1;for(let Z=0;Z<ie.length;Z++)if(Z>0&&Y[ie[Z].id]<Y[ie[Z-1].id]&&(E=Z+1),ie[Z].id===s.id){je=E;break}return`${D} ${V}! ${je}`}if((S==null?void 0:S.id)===s.id)return" !";const K=[...b].reverse().flatMap(W=>W.matches).find(W=>W.isUserMatch&&W.isFinished);if(K){const W=b.find(D=>D.matches.some(V=>V.id===K.id));if((W==null?void 0:W.name)==="")return"!";if((W==null?void 0:W.name)==="4"){const D=b.flatMap(V=>V.matches).find(V=>{const Y=b.find(ie=>ie.matches.some(je=>je.id===V.id));return V.isUserMatch&&(Y==null?void 0:Y.name)==="3,4"});if(D)return((fe=D.winner)==null?void 0:fe.id)===s.id?"3":"4"}return`${(W==null?void 0:W.name)||""} `}return" "}if(n.status==="round_complete"||n.status==="bracket_ready"){const K=[...b].reverse().flatMap(W=>W.matches).find(W=>W.isUserMatch&&W.isFinished);if(K){const W=((ye=K.winner)==null?void 0:ye.id)===s.id;if(n.type==="neighborhood"){const D=b.flatMap(ie=>ie.matches).filter(ie=>ie.isUserMatch&&ie.isFinished),V=D.filter(ie=>{var je;return((je=ie.winner)==null?void 0:je.id)===s.id}).length,Y=D.length-V;return`${D.length} ${W?"":""}! (${V} ${Y})`}else if(W){const D=b.find(V=>V.matches.some(Y=>!Y.isFinished&&Y.players.some(ie=>(ie==null?void 0:ie.id)===s.id)));if(D)return`${D.name} !`}}}const J=b.find(K=>K.matches.some(W=>W.isUserMatch&&!W.isFinished));return J?`${J.name}  `:"  "},[s.id,n,S,b]),_=(C==null?void 0:C.players[0])||null,I=(C==null?void 0:C.players[1])||null,T=_?n.players.find(J=>J.id===_.id)||_:null,B=I?n.players.find(J=>J.id===I.id)||I:null,R=f.useMemo(()=>[{stats:(T==null?void 0:T.stats)||{},color:"#60a5fa",fill:"rgba(59, 130, 246, 0.4)"},{stats:(B==null?void 0:B.stats)||{},color:"#f87171",fill:"rgba(239, 68, 68, 0.4)"}],[T,B]),A=f.useMemo(()=>{if(!T||!B)return 200;const J=[...Object.values(T.stats),...Object.values(B.stats)],fe=Math.max(...J,0);return Math.ceil((fe+50)/50)*50},[T,B]),L=f.useMemo(()=>{if(n.status!=="round_in_progress")return"none";const J=n.timeElapsed;return J<=40?"early":J<=100?"mid":J<=140?"end":"none"},[n.timeElapsed,n.status]),Q=((me=n.currentMatchScores)==null?void 0:me.player1)||0,q=((ve=n.currentMatchScores)==null?void 0:ve.player2)||0,O=Q+q,U=O>0?Q/O*100:50,G=O>0?q/O*100:50,z=()=>{const{status:J}=n;if(J==="round_in_progress")return t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(F,{disabled:!0,colorScheme:"green",children:"  ..."}),t.jsx(F,{onClick:x,colorScheme:"red",children:""})]});if(J==="complete")return t.jsx("button",{onClick:l,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})});if(J==="eliminated")return t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx("button",{onClick:l,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx(F,{onClick:d,colorScheme:"yellow",children:" "})]});const fe=b.some(ye=>ye.matches.some(K=>K.isUserMatch&&!K.isFinished));return(J==="round_complete"||J==="bracket_ready")&&fe?t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(F,{onClick:o,colorScheme:"green",className:"animate-pulse",children:" "}),t.jsx(F,{onClick:x,colorScheme:"red",children:""})]}):t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(F,{disabled:!0,colorScheme:"gray",children:" "}),t.jsx(F,{onClick:d,colorScheme:"yellow",children:" "})]})},H=t.jsxs("main",{className:"flex-1 flex flex-col lg:flex-row gap-4 min-h-0",children:[t.jsxs("aside",{className:"w-full lg:w-[35%] xl:w-[25%] flex-shrink-0 flex flex-col gap-2",children:[t.jsx("div",{className:"flex-1 bg-gray-800/50 rounded-lg p-2 min-h-0",children:n.type==="neighborhood"?t.jsx(Mb,{tournamentState:n,currentUser:s}):t.jsx(_b,{rounds:b,currentUser:s,tournamentType:n.type})}),t.jsxs("div",{className:"h-48 flex-shrink-0 bg-gray-800/50 rounded-lg p-3 text-center flex flex-col items-center justify-center",children:[t.jsx("img",{src:"/images/Ranking.png",alt:"Trophy",className:"w-20 h-20 mb-2"}),t.jsx("h4",{className:"font-bold text-gray-400",children:""}),S?t.jsx("p",{className:"text-xl font-semibold text-yellow-300",children:S.nickname}):t.jsx("p",{className:"text-sm text-gray-500",children:" ..."})]})]}),t.jsxs("div",{className:"flex-grow flex flex-col gap-2 min-h-0 min-w-0",children:[t.jsxs("section",{className:"flex flex-row gap-1 md:gap-2 items-stretch p-2 bg-gray-800/50 rounded-lg",children:[t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(Bu,{player:T,initialPlayer:h.p1,allUsers:r,currentUserId:s.id,onViewUser:a,highlightPhase:L})}),t.jsxs("div",{className:"flex-shrink-0 w-44 sm:w-52 flex flex-col items-center justify-center min-w-0",children:[t.jsx(Ex,{datasets:R,maxStatValue:A,size:u?140:void 0}),t.jsxs("div",{className:"flex justify-center gap-2 sm:gap-4 text-[10px] sm:text-xs mt-1",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 rounded-sm",style:{backgroundColor:"rgba(59, 130, 246, 0.6)"}}),(T==null?void 0:T.nickname)||" 1"]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 rounded-sm",style:{backgroundColor:"rgba(239, 68, 68, 0.6)"}}),(B==null?void 0:B.nickname)||" 2"]})]})]}),t.jsx("div",{className:"flex-1 min-w-0",children:t.jsx(Bu,{player:B,initialPlayer:h.p2,allUsers:r,currentUserId:s.id,onViewUser:a,highlightPhase:L})})]}),t.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-2 min-h-0",children:[t.jsx("div",{className:"w-full h-80 lg:h-full lg:w-2/5 bg-gray-800/50 rounded-lg p-2 flex items-center justify-center",children:t.jsx(kb,{timeElapsed:j?n.timeElapsed:0,fileIndex:j?w==null?void 0:w.sgfFileIndex:p,showLastMoveOnly:!j})}),t.jsxs("div",{className:"w-full lg:w-3/5 flex-1 flex flex-col gap-2 min-h-0",children:[t.jsxs("section",{className:"flex-shrink-0 bg-gray-800/50 rounded-lg p-3",children:[t.jsx(Ib,{p1Percent:U,p2Percent:G,p1Nickname:T==null?void 0:T.nickname,p2Nickname:B==null?void 0:B.nickname}),t.jsx("div",{className:"mt-2",children:t.jsx(Cb,{timeElapsed:n.timeElapsed,totalDuration:140})})]}),t.jsx("div",{className:"h-64 lg:h-auto lg:flex-1 min-h-0 bg-gray-800/50 rounded-lg p-2 flex flex-col",children:t.jsx(Pb,{commentary:n.currentMatchCommentary,isSimulating:n.status==="round_in_progress"})})]})]})]})]}),ne=()=>t.jsxs("footer",{className:"flex-shrink-0 bg-gray-800/50 rounded-lg p-3 grid grid-cols-1 md:grid-cols-3 items-center gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ce,{userId:s.id,userName:s.nickname,size:40}),t.jsxs("div",{className:"text-left",children:[t.jsx("h4",{className:"font-bold",children:s.nickname}),t.jsx("p",{className:"text-xs text-yellow-300",children:P})]})]}),t.jsx("div",{className:"text-center order-first md:order-none",children:z()}),t.jsx("div",{className:"text-right",children:t.jsx(Tb,{tournamentState:n,currentUser:s,onAction:i})})]});return t.jsxs("div",{className:"w-full p-2 flex flex-col gap-2 bg-gray-900 text-white min-h-full",children:[t.jsxs("header",{className:"flex items-center justify-between flex-shrink-0",children:[t.jsx("button",{onClick:g,className:"p-0 flex items-center justify-center w-10 h-10 rounded-full transition-all duration-100 active:shadow-inner active:scale-95 active:translate-y-0.5",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:n.title}),t.jsx("div",{className:"w-28"})]}),u?t.jsxs("div",{className:"flex-1 flex flex-col gap-4 min-h-0",children:[t.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto",children:H}),ne()]}):t.jsxs(t.Fragment,{children:[H,ne()]})]})},Rb=({type:e})=>{const{currentUserWithStatus:n,handlers:s,allUsers:l}=De();let r;switch(e){case"neighborhood":r="lastNeighborhoodTournament";break;case"national":r="lastNationalTournament";break;case"world":r="lastWorldTournament";break;default:return t.jsx("div",{children:"Invalid tournament type"})}const a=n==null?void 0:n[r];return!a||!n?t.jsxs("div",{className:"p-4 text-center",children:[t.jsx("p",{children:"   ..."}),t.jsx(F,{onClick:()=>window.location.hash="#/tournament",className:"mt-4",children:" "})]}):t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)] relative",children:[t.jsxs("header",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[t.jsx(F,{onClick:()=>window.location.hash="#/tournament",colorScheme:"gray",className:"p-0 flex items-center justify-center w-10 h-10 rounded-full",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:a.title}),t.jsx("div",{className:"w-10"})]}),t.jsx("main",{className:"flex-1 flex flex-col items-center justify-center",children:t.jsx(Ab,{tournament:a,currentUser:n,onBack:()=>window.location.hash="#/tournament",allUsersForRanking:l,onViewUser:s.openViewingUser,onAction:s.handleAction,onStartNextRound:()=>s.handleAction({type:"START_TOURNAMENT_ROUND",payload:{type:e}}),onReset:()=>s.handleAction({type:"CLEAR_TOURNAMENT_SESSION",payload:{type:e}}),onSkip:()=>s.handleAction({type:"SKIP_TOURNAMENT_END",payload:{type:e}}),isMobile:!1})})]})},Bb=()=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full flex flex-col items-center justify-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:""}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{className:"text-2xl",children:""}),t.jsx("img",{src:"/images/championship/Champ1.png",alt:"Beginner Class",className:"w-48 h-32"}),t.jsx("button",{className:"text-2xl",children:""})]})]}),Lb=()=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:" "}),t.jsx("div",{className:"grid grid-cols-5 gap-4",children:Array.from({length:20},(e,n)=>t.jsx("div",{className:"aspect-square bg-gray-700 rounded-md flex items-center justify-center",children:n+1},n))})]}),$b=()=>t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 h-full",children:[t.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:" "}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"bg-gray-700 p-2 rounded-md",children:" 1"}),t.jsx("div",{className:"bg-gray-700 p-2 rounded-md",children:" 2"}),t.jsx("div",{className:"bg-gray-700 p-2 rounded-md",children:" 3"})]})]}),Ob=()=>{const e=()=>window.location.hash="#/profile";return t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-screen-2xl mx-auto flex flex-col h-[calc(100vh-5rem)]",children:[t.jsxs("header",{className:"flex justify-between items-center mb-6 flex-shrink-0",children:[t.jsx(F,{onClick:e,colorScheme:"gray",className:"p-0 flex items-center justify-center w-10 h-10 rounded-full",children:t.jsx("img",{src:"/images/button/back.png",alt:"Back",className:"w-6 h-6"})}),t.jsx("h1",{className:"text-3xl lg:text-4xl font-bold",children:""}),t.jsx("div",{className:"w-10"})," "]}),t.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-6 min-h-0",children:[t.jsx("div",{className:"col-span-3",children:t.jsx(Bb,{})}),t.jsx("div",{className:"col-span-6",children:t.jsx(Lb,{})}),t.jsx("div",{className:"col-span-3",children:t.jsx($b,{})})]})]})},Db=()=>t.jsxs("div",{className:"p-4",children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Guild Page"}),t.jsx("p",{children:"Welcome to the Guild page. This feature is under construction."})]}),Lu=()=>{const{currentRoute:e,currentUser:n,activeGame:s}=De();if(!n)return e.view==="register"?t.jsx(S0,{}):t.jsx(N0,{});if(s&&e.view!=="game")return t.jsx("div",{className:"flex items-center justify-center h-full",children:" ..."});switch(e.view){case"profile":return t.jsx(M0,{});case"lobby":const l=e.params.type==="playful"?"playful":"strategic";return t.jsx(A0,{lobbyType:l});case"waiting":return e.params.mode?t.jsx(z0,{mode:e.params.mode}):(window.location.hash="#/profile",null);case"game":return e.params.id&&s&&s.id===e.params.id?t.jsx(cb,{session:s}):(console.warn("Router: Mismatch between route and active game. Redirecting to profile."),window.location.hash="#/profile",null);case"admin":return t.jsx(gb,{});case"tournament":return e.params.type?t.jsx(Rb,{type:e.params.type}):t.jsx(jb,{});case"singleplayer":return t.jsx(Ob,{});case"guild":return t.jsx(Db,{});default:return window.location.hash="#/profile",null}},Mx=({item:e,currentUser:n,onClose:s,onConfirm:l})=>{const[r,a]=f.useState(1),i=!!e.price.gold,o=e.price.gold||e.price.diamonds||0,c=o*r,d=f.useMemo(()=>{var y;const p=i?n.gold:n.diamonds,m=o>0?Math.floor(p/o):1/0;let h=1/0;if(e.type!=="equipment"){const v=n.inventory.filter(x=>x.itemId===e.itemId).length,g=(((y=n.inventorySlots)==null?void 0:y[e.type])||Ds)-v;h=g>0?g:0}return Math.max(1,Math.min(e.limit||1/0,m,h,999))},[e,n,i,o]),u=()=>{r>0&&l(e.itemId,r),s()};return t.jsx(be,{title:" ",onClose:s,windowId:"purchase-quantity",initialWidth:400,zIndex:60,children:t.jsxs("div",{className:"text-center flex flex-col items-center",children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:e.name}),t.jsxs("div",{className:"w-full space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-center gap-4",children:[t.jsx(F,{onClick:()=>a(p=>Math.max(1,p-1)),disabled:r<=1,children:"-"}),t.jsx("input",{type:"number",value:r,onChange:p=>a(Math.max(1,Math.min(d,Number(p.target.value)))),className:"w-24 text-center text-2xl font-bold bg-tertiary rounded-md p-2"}),t.jsx(F,{onClick:()=>a(p=>Math.min(d,p+1)),disabled:r>=d,children:"+"}),t.jsx(F,{onClick:()=>a(d),disabled:d<=0,colorScheme:"blue",className:"!py-2 !px-3",children:"Max"})]}),t.jsx("input",{type:"range",min:"1",max:d,value:r,onChange:p=>a(Number(p.target.value)),className:"w-full"})]}),t.jsxs("div",{className:"mt-6 text-lg",children:[t.jsx("p",{children:" :"}),t.jsxs("div",{className:"flex items-center justify-center gap-2 font-bold text-2xl text-yellow-300",children:[t.jsx("img",{src:i?"/images/icon/Gold.png":"/images/icon/Zem.png",alt:i?"":"",className:"w-6 h-6"}),t.jsx("span",{children:c.toLocaleString()})]})]}),t.jsxs("div",{className:"flex w-full gap-4 mt-6",children:[t.jsx(F,{onClick:s,colorScheme:"gray",className:"w-full",children:""}),t.jsx(F,{onClick:u,disabled:r===0||r>d,className:"w-full",children:""})]})]})})},qb=e=>100+Math.max(0,(e-Ds)/ix)*20,$u={normal:0,uncommon:1,rare:2,epic:3,legendary:4,mythic:5},Ub=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-purple-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},zb=({slot:e,item:n})=>{const s=l=>{if(l===0)return null;let r="",a="";return l>=10?(r="/images/equipments/Star4.png",a="prism-text-effect"):l>=7?(r="/images/equipments/Star3.png",a="text-purple-400"):l>=4?(r="/images/equipments/Star2.png",a="text-amber-400"):l>=1&&(r="/images/equipments/Star1.png",a="text-white"),t.jsxs("div",{className:"absolute top-0.5 right-0.5 flex items-center gap-0.5 bg-black/40 rounded-bl-md px-0.5 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:r,alt:"star",className:"w-2.5 h-2.5"}),t.jsx("span",{className:`font-bold text-[10px] leading-none ${a}`,children:l})]})};return n?t.jsxs("div",{className:"relative w-full aspect-square rounded-lg border-2 border-color/50 bg-tertiary/50",title:n.name,children:[t.jsx("img",{src:$a[n.grade],alt:n.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),n.image&&t.jsx("img",{src:n.image,alt:n.name,className:"relative w-full h-full object-contain p-1.5"}),s(n.stars)]}):t.jsx("img",{src:La[e],alt:`${e} empty slot`,className:"w-full aspect-square rounded-lg bg-tertiary/50 border-2 border-color/50"})},Ou=({item:e,title:n,comparisonItem:s})=>{var m;if(!e)return t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:n});const l=Pl[e.grade],r=h=>{if(h===0)return null;let y="",v="";return h>=10?(y="/images/equipments/Star4.png",v="prism-text-effect"):h>=7?(y="/images/equipments/Star3.png",v="text-purple-400"):h>=4?(y="/images/equipments/Star2.png",v="text-amber-400"):h>=1&&(y="/images/equipments/Star1.png",v="text-white"),t.jsxs("div",{className:"absolute top-0.5 right-0.5 flex items-center gap-0.5 bg-black/40 rounded-bl-md px-0.5 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:y,alt:"star",className:"w-2.5 h-2.5"}),t.jsx("span",{className:`font-bold text-[10px] leading-none ${v}`,children:h})]})},a=En[e.grade],i=h=>!h||!h.options?[]:[...h.options.main?[h.options.main]:[],...h.options.combatSubs||[],...h.options.specialSubs||[],...h.options.mythicSubs||[]].filter(Boolean),o=(h,y)=>{if(!h||!h.options)return 0;const b=i(h).find(g=>g.type===y);return b?b.value:0},c=i(e),d=i(s),u=new Map;c.forEach(h=>{u.set(h.type,{current:h})}),d.forEach(h=>{const y=u.get(h.type);y?y.comparison=h:u.set(h.type,{comparison:h})});const p=Array.from(u.keys()).sort();return t.jsxs("div",{className:"flex flex-col h-full text-xs",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:l.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),r(e.stars)]}),t.jsxs("div",{className:"flex-grow text-right ml-2",children:[t.jsx("div",{className:"flex items-baseline justify-end gap-0.5",children:t.jsx("h3",{className:`text-lg font-bold ${l.color}`,children:e.name})}),t.jsxs("p",{className:"text-gray-400 text-xs",children:["[",l.name,"]"]}),t.jsxs("p",{className:"text-[10px] text-gray-500",children:[" (: ",a,")"]}),((m=e.options)==null?void 0:m.main)&&t.jsxs("p",{className:"font-semibold text-yellow-300 text-xs flex justify-between items-center",children:[t.jsxs("span",{children:[e.options.main.display,e.options.main.range&&` [${e.options.main.range[0]}~${e.options.main.range[1]}]`]}),s&&e.options.main.type&&(()=>{const h=o(s,e.options.main.type),y=e.options.main.value-h,v=y>0?` (+${y})`:y<0?` (${y})`:"",b=y>0?"text-green-400":y<0?"text-red-400":"";return y!==0&&t.jsx("span",{className:`font-bold ${b} text-right`,children:v})})()]})]})]}),t.jsx("div",{className:"w-full text-xs text-left space-y-1 bg-gray-900/50 p-2 rounded-lg flex-grow overflow-y-auto",children:p.map(h=>{var b,g;const{current:y,comparison:v}=u.get(h);if(((g=(b=e.options)==null?void 0:b.main)==null?void 0:g.type)===h)return null;if(y&&v){const x=y.value-v.value,j=x>0?` (+${x})`:x<0?` (${x})`:"",w=x>0?"text-green-400":x<0?"text-red-400":"";let k="text-blue-300";return y.type in ze&&(k="text-green-300"),y.type in rt&&(k="text-red-400"),t.jsxs("p",{className:`${k} flex justify-between items-center`,children:[t.jsx("span",{children:y.display}),x!==0&&t.jsx("span",{className:`font-bold ${w} text-right`,children:j})]},h)}else if(y&&!v){let x="text-green-400";return y.type in ze&&(x="text-green-300"),y.type in rt&&(x="text-red-400"),t.jsxs("p",{className:`${x} flex justify-between items-center`,children:[t.jsx("span",{children:y.display})," ",t.jsx("span",{className:"font-bold text-right",children:"(New)"})]},h)}else if(!y&&v){let x="text-red-400";return v.type in ze&&(x="text-green-300"),v.type in rt&&(x="text-red-400"),t.jsx("p",{className:`${x} line-through flex justify-between items-center`,children:t.jsx("span",{children:v.display})},h)}return null})})]})},Fb=["fan","board","top","bottom","bowl","stones"],Gb=({currentUser:e,onClose:n,onAction:s,onStartEnhance:l,enhancementAnimationTarget:r,onAnimationComplete:a,isTopmost:i})=>{const{presets:o,setPresets:c,handlers:d}=De(),{inventorySlots:u={equipment:30,consumable:10,material:10}}=e,[p,m]=f.useState(null),[h,y]=f.useState("all"),[v,b]=f.useState("createdAt"),[g,x]=f.useState(0),[j,w]=f.useState(!1),[k,C]=f.useState(""),[S,P]=f.useState(!1),[_,I]=f.useState(null),[T,B]=f.useState(1),R=K=>{x(K);const W=o[K];W&&d.applyPreset(W)},A=f.useMemo(()=>p&&e.inventory.find(K=>K.id===p)||null,[p,e.inventory]),L=f.useMemo(()=>h==="all"?0:qb(u[h]),[h,u]),{coreStatBonuses:Q}=f.useMemo(()=>gx(e),[e]),q=f.useMemo(()=>{if(!A||A.type!=="material")return[];const K={};for(const D in ha)ha[D].forEach((Y,ie)=>{Y.forEach(je=>{je.name===A.name&&(K[D]||(K[D]=[]),K[D].push(ie+1))})});const W=[];for(const D in K){const V=K[D].sort((Y,ie)=>Y-ie);V.length>0&&W.push(`${Pl[D].name}   : +${V.join("/+")}`)}return W},[A]),O=()=>{h!=="all"&&window.confirm(` ${L}  ${h}  ${ix} ?`)&&s({type:"EXPAND_INVENTORY",payload:{category:h}})},U=()=>{C(o[g].name),w(!0)},G=()=>{const K={...o[g],name:k,equipment:e.equipment};d.handleAction({type:"SAVE_PRESET",payload:{preset:K,index:g}}),w(!1),alert(" .")},z=K=>{const W=e.inventory.find(D=>D.id===K);if(W){if(!W.isEquipped){const D=En[W.grade],V=e.strategyLevel+e.playfulLevel;if(V<D){alert(`   . (: ${D}, : ${V})`);return}}s({type:"TOGGLE_EQUIP_ITEM",payload:{itemId:K}})}},H=f.useMemo(()=>{let K=[...e.inventory];return h!=="all"&&(K=K.filter(W=>W.type===h)),h==="material"&&console.log("Filtered materials:",K),K.sort((W,D)=>{if(v==="createdAt")return D.createdAt-W.createdAt;if(v==="grade"){const V=$u[W.grade],Y=$u[D.grade];return V!==Y?Y-V:D.stars-W.stars}if(v==="type"){const V={equipment:1,consumable:2,material:3};return V[W.type]-V[D.type]}return 0}),K},[e.inventory,h,v]),ne=f.useMemo(()=>{const K=u||{};return h==="all"?(K.equipment||Ds)+(K.consumable||Ds)+(K.material||Ds):K[h]||Ds},[u,h]),oe=f.useMemo(()=>{let K=t0;return h==="consumable"?K=n0:h==="material"&&(K=s0),K},[h]),me=f.useMemo(()=>h==="all"?!1:u[h]<oe,[h,u,oe]),ve=f.useCallback(K=>o.some(W=>Object.values(W.equipment).includes(K)),[o]),J=f.useCallback(K=>{const W=e.equipment[K];if(W)return e.inventory.find(D=>D.id===W)},[e.equipment,e.inventory]),fe=f.useMemo(()=>!A||!A.slot?null:J(A.slot),[A,J]),ye=f.useMemo(()=>{if(!A||A.type!=="equipment")return!1;const K=En[A.grade];return e.strategyLevel+e.playfulLevel>=K},[A,e.strategyLevel,e.playfulLevel]);return t.jsxs(be,{title:"",onClose:n,windowId:"inventory",isTopmost:i,children:[t.jsxs("div",{className:"flex flex-col h-full w-full max-w-[900px]",children:[t.jsxs("div",{className:"h-96 bg-gray-800 p-4 mb-2 rounded-md shadow-inner flex",children:[t.jsxs("div",{className:"w-1/3 pr-4 border-r border-gray-700",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:Fb.map(K=>t.jsx("div",{className:"w-full",children:t.jsx(zb,{slot:K,item:J(K)})},K))}),t.jsxs("div",{className:"mt-4",children:[t.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mb-2",children:Object.values(N).map(K=>{var Y;const W=(e.baseStats[K]||0)+(((Y=e.spentStatPoints)==null?void 0:Y[K])||0),D=Math.floor(W*(Q[K].percent/100))+Q[K].flat,V=W+D;return t.jsxs("div",{className:"bg-tertiary/40 p-1 rounded-md flex items-center justify-between text-xs",children:[t.jsx("span",{className:"font-semibold text-secondary whitespace-nowrap",children:K}),t.jsxs("span",{className:"font-mono font-bold whitespace-nowrap",title:`: ${W}, : ${D}`,children:[V,D>0&&t.jsxs("span",{className:"text-green-400 text-xs ml-0.5",children:["(+",D,")"]})]})]},K)})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("select",{value:g,onChange:K=>R(Number(K.target.value)),className:"bg-secondary border border-color text-xs rounded-md p-1 focus:ring-accent focus:border-accent flex-grow",children:o.map((K,W)=>t.jsx("option",{value:W,children:K.name},W))}),t.jsx(F,{onClick:U,colorScheme:"blue",className:"!text-xs !py-1",children:""})]})]})]}),A&&A.type==="equipment"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col w-1/3 h-full bg-panel-secondary rounded-lg p-3 relative overflow-hidden ml-4 border-r border-gray-700",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:"  "}),fe?t.jsx(Ou,{item:fe,title:"  ",comparisonItem:A}):t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:"  "})]}),t.jsxs("div",{className:"flex flex-col w-1/3 h-full bg-panel-secondary rounded-lg p-3 relative overflow-hidden ml-4",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:" "}),t.jsx(Ou,{item:A,title:"  ",comparisonItem:fe}),t.jsxs("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center gap-2 px-4",children:[A.id===(fe==null?void 0:fe.id)?t.jsx(F,{onClick:()=>z(A.id),colorScheme:"red",className:"w-full !text-xs !py-1",children:""}):t.jsx(F,{onClick:()=>z(A.id),colorScheme:"green",className:"w-full !text-xs !py-1",disabled:!ye,children:""}),t.jsx(F,{onClick:()=>l(A),disabled:A.stars>=10,colorScheme:"yellow",className:"w-full !text-xs !py-1",children:A.stars>=10?" ":""}),t.jsx(F,{onClick:()=>s({type:"SELL_ITEM",payload:{itemId:A.id,quantity:1}}),colorScheme:"red",className:"w-full !text-xs !py-1",children:""})]})]})]}):t.jsx("div",{className:"flex flex-col w-2/3 h-full bg-panel-secondary rounded-lg p-3 relative overflow-hidden ml-4",children:A?A.type==="consumable"||A.type==="material"?t.jsxs(t.Fragment,{children:[t.jsxs("h3",{className:"text-lg font-bold text-on-panel mb-2",children:[" ",A.type==="consumable"?"":""]}),t.jsxs("div",{className:"flex flex-col h-full text-xs",children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:$a[A.grade],alt:A.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),A.image&&t.jsx("img",{src:A.image,alt:A.name,className:"relative w-full h-full object-contain p-1"})]}),t.jsxs("div",{className:"flex-grow text-right ml-2",children:[t.jsx("h3",{className:`text-lg font-bold ${Pl[A.grade].color}`,children:A.name}),t.jsxs("p",{className:"text-gray-400 text-xs",children:["[",Pl[A.grade].name,"]"]}),t.jsx("p",{className:"text-gray-300 text-xs mt-1",children:A.description}),t.jsxs("p",{className:"text-gray-300 text-xs mt-1",children:[" : ",A.quantity]})]})]}),A.type==="material"&&t.jsxs("div",{className:"mt-2 p-2 bg-gray-800/50 rounded-lg flex-grow",style:{maxHeight:"4em"},children:[" ",t.jsx("p",{className:"font-semibold text-secondary mb-1",children:"  :"}),q.length>0?q.slice(0,2).map((K,W)=>t.jsx("p",{className:"text-gray-300 text-xs",children:K},W)):t.jsx("p",{className:"text-gray-300 text-xs",children:"       ."}),q.length>2&&t.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"..."})]}),"                                        "]}),t.jsxs("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center gap-2 px-4",children:[A.type==="consumable"&&t.jsxs(t.Fragment,{children:[t.jsx(F,{onClick:()=>s({type:"USE_ITEM",payload:{itemId:A.id,quantity:1}}),colorScheme:"blue",className:"w-full !text-xs !py-1",children:""}),A.quantity&&A.quantity>1&&t.jsx(F,{onClick:()=>{I(A),P(!0)},colorScheme:"purple",className:"w-full !text-xs !py-1",children:" "})]}),t.jsx(F,{onClick:()=>s({type:"SELL_ITEM",payload:{itemId:A.id,quantity:1}}),colorScheme:"red",className:"w-full !text-xs !py-1",children:""})]})]}):t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:"  "}):t.jsx("div",{className:"h-full flex items-center justify-center text-tertiary text-sm",children:" "})})]}),t.jsxs("div",{className:"flex-grow flex-shrink-0 bg-gray-900 p-4 rounded-b-md overflow-y-auto",children:[t.jsx("div",{className:"flex-shrink-0 p-2 bg-gray-900/50 rounded-md mb-2",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(F,{onClick:()=>y("all"),colorScheme:h==="all"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""}),t.jsx(F,{onClick:()=>y("equipment"),colorScheme:h==="equipment"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""}),t.jsx(F,{onClick:()=>y("consumable"),colorScheme:h==="consumable"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""}),t.jsx(F,{onClick:()=>y("material"),colorScheme:h==="material"?"blue":"gray",className:"!text-xs !py-1 !px-2",children:""})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-sm",children:":"}),t.jsxs("select",{onChange:K=>b(K.target.value),value:v,className:"bg-gray-700 text-white text-sm rounded-md p-1",children:[t.jsx("option",{value:"createdAt",children:""}),t.jsx("option",{value:"grade",children:""}),t.jsx("option",{value:"type",children:""})]}),t.jsx("div",{className:"text-sm text-gray-400",children:`${H.length} / ${ne}`})]})]})}),t.jsx("div",{className:"overflow-y-auto pr-2",style:{height:"116px"},children:t.jsxs("div",{className:"grid grid-cols-5 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2",children:[Array.from({length:ne}).map((K,W)=>{const D=H[W];return D?t.jsx(Wb,{item:D,onClick:()=>m(D.id),isSelected:p===D.id,isEquipped:D.isEquipped||!1,enhancementStars:(r==null?void 0:r.itemId)===D.id?r.stars:void 0,isPresetEquipped:ve(D.id)},D.id):t.jsx("div",{className:"w-full aspect-square rounded-lg bg-gray-800/50 border-2 border-gray-700/50"},`empty-${W}`)}),me&&t.jsx("button",{onClick:O,className:"w-full aspect-square rounded-lg bg-gray-800/50 border-2 border-gray-700/50 flex items-center justify-center text-gray-400 text-4xl hover:bg-gray-700/50 hover:border-accent transition-all duration-200",title:`  (${L} )`,children:"+"},"expand-slot")]})})]})]}),S&&_&&t.jsx(Mx,{isOpen:S,onClose:()=>P(!1),onConfirm:K=>{s({type:"USE_ITEM",payload:{itemId:_.id,quantity:K}}),P(!1),I(null),B(1)},maxQuantity:_.quantity||1,itemName:_.name,initialQuantity:1}),j&&t.jsx(be,{title:"  ",onClose:()=>w(!1),windowId:"renamePreset",isTopmost:!0,children:t.jsxs("div",{className:"p-4 flex flex-col items-center",children:[t.jsx("p",{className:"mb-4 text-on-panel",children:"   :"}),t.jsx("input",{type:"text",value:k,onChange:K=>C(K.target.value),className:"bg-secondary border border-color text-on-panel text-sm rounded-md p-2 mb-4 w-full max-w-xs",maxLength:20}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(F,{onClick:G,colorScheme:"blue",children:""}),t.jsx(F,{onClick:()=>w(!1),colorScheme:"gray",children:""})]})]})})]})},Wb=({item:e,onClick:n,isSelected:s,isEquipped:l,enhancementStars:r,isPresetEquipped:a})=>{const i=Ub(r||e.stars||0);return t.jsxs("div",{onClick:n,className:`relative w-full aspect-square rounded-lg cursor-pointer transition-all duration-200 ${s?"ring-2 ring-accent":"ring-1 ring-transparent"} hover:ring-2 hover:ring-accent/70`,title:e.name,children:[t.jsx("img",{src:$a[e.grade],alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1.5"}),l&&t.jsx("div",{className:"absolute top-0.5 left-0.5 w-4 h-4 bg-green-500 text-white text-xs flex items-center justify-center rounded-full border-2 border-gray-800",children:"E"}),!l&&a&&t.jsx("div",{className:"absolute top-0.5 left-0.5 w-4 h-4 bg-blue-500 text-white text-xs flex items-center justify-center rounded-full border-2 border-gray-800",children:"P"}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 text-center text-xs font-bold text-white bg-black/50 py-0.5",children:t.jsx("span",{className:i.colorClass,children:i.text})})]})},Hb=e=>{const n=Math.max(0,(e-Date.now())/1e3);if(n===0)return"";const s=Math.floor(n/(24*3600)),l=Math.floor(n%(24*3600)/3600),r=Math.floor(n%3600/60);return s>0?`${s} ${l}`:l>0?`${l} ${r}`:`${r}`},Vb=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{var v,b,g,x;const{mail:r}=e,[a,i]=f.useState(r.length>0?r[0]:null),[o,c]=f.useState(null);f.useEffect(()=>{if(a){const j=r.find(w=>w.id===a.id);j?JSON.stringify(j)!==JSON.stringify(a)&&i(j):i(r.length>0?r[0]:null)}else r.length>0&&i(r[0])},[r,a]),f.useEffect(()=>{a&&!a.isRead&&s({type:"MARK_MAIL_AS_READ",payload:{mailId:a.id}})},[a,s]),f.useEffect(()=>{if(a!=null&&a.expiresAt){const j=()=>{c(Hb(a.expiresAt))};j();const w=setInterval(j,6e4);return()=>clearInterval(w)}else c(null)},[a]);const d=()=>{a&&a.attachments&&!a.attachmentsClaimed&&(Ee.claimReward(),s({type:"CLAIM_MAIL_ATTACHMENTS",payload:{mailId:a.id}}))},u=()=>{if(a){const j=r.findIndex(w=>w.id===a.id)-1;s({type:"DELETE_MAIL",payload:{mailId:a.id}}),i(r.length>1?r[Math.max(0,j)]:null)}},p=r.some(j=>j.attachments&&!j.attachmentsClaimed),m=r.some(j=>j.attachmentsClaimed),h=()=>{Ee.claimReward(),s({type:"CLAIM_ALL_MAIL_ATTACHMENTS"})},y=()=>{if(window.confirm("    ?")){s({type:"DELETE_ALL_CLAIMED_MAIL"});const j=r.filter(w=>!w.attachmentsClaimed);i(j.length>0?j[0]:null)}};return t.jsx(be,{title:"",onClose:n,windowId:"mailbox",initialWidth:800,isTopmost:l,children:t.jsxs("div",{className:"flex gap-6 h-[65vh]",children:[t.jsxs("div",{className:"w-1/3 bg-gray-900/50 rounded-lg p-3 flex flex-col",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-2 flex-shrink-0",children:["  (",r.length,")"]}),t.jsxs("div",{className:"flex flex-col gap-2 mb-2 flex-shrink-0",children:[t.jsx(F,{onClick:h,disabled:!p,colorScheme:"green",className:"!text-sm !py-2",children:" "}),t.jsx(F,{onClick:y,disabled:!m,colorScheme:"red",className:"!text-sm !py-2",children:"   "})]}),t.jsx("ul",{className:"space-y-1 overflow-y-auto flex-grow pr-2",children:r.map(j=>t.jsx("li",{children:t.jsxs("button",{onClick:()=>i(j),className:`w-full text-left p-2 rounded-md transition-colors ${(a==null?void 0:a.id)===j.id?"bg-blue-600":"hover:bg-gray-700/50"}`,children:[t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400",children:[t.jsxs("span",{children:["From: ",j.from]}),!j.isRead&&t.jsx("span",{className:"text-yellow-400 font-bold",children:" New"})]}),t.jsx("p",{className:"font-semibold truncate",children:j.title})]})},j.id))})]}),t.jsx("div",{className:"w-2/3 flex flex-col",children:a?t.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4 flex flex-col h-full",children:[t.jsxs("div",{className:"flex-grow flex flex-col mb-4",children:[t.jsx("h2",{className:"text-xl font-bold mb-2 pb-2 border-b border-gray-700",children:a.title}),t.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-400 mb-4",children:[t.jsxs("span",{children:[" : ",a.from]}),o&&t.jsxs("span",{children:[" : ",t.jsx("span",{className:"text-yellow-400 font-semibold",children:o})]})]}),t.jsx("div",{className:"text-sm text-gray-300 flex-grow bg-gray-800/50 p-3 rounded-md overflow-y-auto",children:a.message})]}),t.jsxs("div",{className:"flex-shrink-0 pt-4 border-t border-gray-700",children:[a.attachments&&t.jsxs("div",{className:"bg-gray-800 p-3 rounded-lg mb-4",children:[t.jsx("h4",{className:"font-semibold text-gray-300 mb-2",children:" "}),a.attachmentsClaimed?t.jsx("p",{className:"text-gray-400 text-center",children:"[ ]"}):t.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm",children:[(((v=a.attachments)==null?void 0:v.actionPoints)??0)>0&&t.jsxs("span",{children:[" ",a.attachments.actionPoints.toLocaleString()," "]}),(((b=a.attachments)==null?void 0:b.gold)??0)>0&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4"})," ",a.attachments.gold.toLocaleString()," "]}),(((g=a.attachments)==null?void 0:g.diamonds)??0)>0&&t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",a.attachments.diamonds.toLocaleString()," "]}),(x=a.attachments.items)==null?void 0:x.map((j,w)=>{const k=j;return t.jsxs("span",{className:"flex items-center gap-1",children:[k.image&&t.jsx("img",{src:k.image,alt:k.name,className:"w-4 h-4 object-contain"}),k.name," ",k.quantity&&k.quantity>1?`x${k.quantity}`:""]},w)})]})]}),t.jsxs("div",{className:"flex justify-between items-center gap-3",children:[t.jsx(F,{onClick:u,colorScheme:"red",children:""}),t.jsx(F,{onClick:d,colorScheme:"green",disabled:!a.attachments||a.attachmentsClaimed,children:a.attachmentsClaimed?" ":" "})]})]})]}):t.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900/50 rounded-lg",children:t.jsx("p",{className:"text-gray-400",children:"  ."})})})]})})},Kb=({quest:e,onClaim:n})=>{const s=e.progress>=e.target,l=Math.min(e.progress/e.target*100,100),r=()=>{s&&!e.isClaimed&&(Ee.claimReward(),n(e.id))};return t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-800 rounded-md flex items-center justify-center text-gray-500 text-3xl flex-shrink-0",children:""}),t.jsxs("div",{className:"flex-grow min-w-0",children:[t.jsx("h4",{className:"font-bold truncate",children:e.title}),t.jsx("p",{className:"text-xs text-gray-400 mb-1 truncate",children:e.description}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:t.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${l}%`}})}),t.jsxs("p",{className:"text-xs text-right text-gray-300 mt-1",children:[e.progress," / ",e.target]})]}),t.jsxs("div",{className:"w-28 text-center flex-shrink-0 flex flex-col items-center gap-1 relative",children:[t.jsx(F,{onClick:r,disabled:!s||e.isClaimed,colorScheme:s&&!e.isClaimed?"green":"gray",className:"w-full !text-sm !py-2",children:e.isClaimed?"":s?" ":" "}),t.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs flex-wrap",children:[t.jsxs("span",{className:"text-yellow-300 font-semibold flex items-center gap-1",children:[" +",e.activityPoints]}),e.reward.gold&&t.jsxs("span",{className:"text-yellow-300 font-semibold flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-3 h-3"})," +",e.reward.gold]})]})]})]})},Si=({title:e,questData:n,thresholds:s,rewards:l,questType:r,onClaim:a})=>{if(!n)return null;const{activityProgress:i,claimedMilestones:o}=n,c=s[s.length-1],d=u=>{if(!u.items||u.items.length===0)return"/images/Box/box.png";const p=u.items[0],m="itemId"in p?p.itemId:p.name,h=vs.find(y=>y.name===m);return(h==null?void 0:h.image)??"/images/Box/box.png"};return t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold text-center mb-2",children:e}),t.jsx("div",{className:"flex items-center gap-3 mb-3",children:t.jsxs("div",{className:"w-full bg-gray-700 rounded-full h-4 relative border border-gray-600",children:[t.jsx("div",{className:"bg-green-500 h-full rounded-full",style:{width:`${Math.min(100,i/c*100)}%`}}),t.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold text-white",children:[i," / ",c]})]})}),t.jsx("div",{className:"flex justify-around items-end",children:s.map((u,p)=>{if(!l[p])return null;const m=i>=u,h=o[p],y=m&&!h,v=l[p],b=d(v);return t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("button",{onClick:()=>{y&&(Ee.claimReward(),a(p,r))},disabled:!y,className:`relative w-8 h-8 transition-transform hover:scale-110 disabled:cursor-not-allowed ${y?"animate-pulse":""}`,title:h?" ":m?" ":`${u}  `,children:[t.jsx("img",{src:b,alt:` ${p+1}`,className:`w-full h-full object-contain ${!m&&!h?"filter grayscale":""}`}),h&&t.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center text-xl text-green-400",children:""})]}),t.jsx("span",{className:`text-sm font-bold mt-1 ${m?"text-yellow-300":"text-gray-500"}`,children:u})]},u)})})]})},Qb=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{var u,p,m;const[r,a]=f.useState("daily"),{quests:i}=e,o=h=>{s({type:"CLAIM_QUEST_REWARD",payload:{questId:h}})},c=r==="daily"?((u=i.daily)==null?void 0:u.quests)||[]:r==="weekly"?((p=i.weekly)==null?void 0:p.quests)||[]:((m=i.monthly)==null?void 0:m.quests)||[],d=()=>r==="daily"?t.jsx(Si,{title:" ",questData:i.daily,thresholds:dx,rewards:o0,questType:"daily",onClaim:(h,y)=>s({type:"CLAIM_ACTIVITY_MILESTONE",payload:{milestoneIndex:h,questType:y}})}):r==="weekly"?t.jsx(Si,{title:" ",questData:i.weekly,thresholds:ux,rewards:c0,questType:"weekly",onClaim:(h,y)=>s({type:"CLAIM_ACTIVITY_MILESTONE",payload:{milestoneIndex:h,questType:y}})}):r==="monthly"?t.jsx(Si,{title:" ",questData:i.monthly,thresholds:mx,rewards:d0,questType:"monthly",onClaim:(h,y)=>s({type:"CLAIM_ACTIVITY_MILESTONE",payload:{milestoneIndex:h,questType:y}})}):null;return t.jsx(be,{title:"",onClose:n,windowId:"quests",initialWidth:750,isTopmost:l,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*70)] flex flex-col",children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>a("daily"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="daily"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("weekly"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="weekly"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("monthly"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="monthly"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),r==="monthly"&&t.jsx("div",{className:"flex-shrink-0 text-center text-sm text-yellow-300 mb-4 bg-gray-900/50 p-2 rounded-md",children:t.jsx("p",{children:"   100       50%  ."})}),t.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[d(),c.length>0?t.jsx("ul",{className:"space-y-3",children:c.map(h=>t.jsx("li",{children:t.jsx(Kb,{quest:h,onClaim:o})},h.id))}):t.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:t.jsx("p",{children:"   ."})})]})]})})},Jb=9*60*60*1e3,Du=(e=Date.now())=>{const n=typeof e=="number"?e:e.getTime();return new Date(n+Jb)},Yb=(e,n)=>{if(!e||e===0)return!0;const s=Du(e),l=Du(n);if(s.getUTCFullYear()!==l.getUTCFullYear())return!0;const r=s.getUTCDay(),a=s.getUTCDate()-r+(r===0?-6:1),i=new Date(s);i.setUTCDate(a),i.setUTCHours(0,0,0,0);const o=l.getUTCDay(),c=l.getUTCDate()-o+(o===0?-6:1),d=new Date(l);return d.setUTCDate(c),d.setUTCHours(0,0,0,0),i.getTime()!==d.getTime()},_x=(e,n)=>{if(!e||!n)return!1;const s=9*60*60*1e3,l=new Date(e+s),r=new Date(n+s);return l.getUTCFullYear()===r.getUTCFullYear()&&l.getUTCMonth()===r.getUTCMonth()&&l.getUTCDate()===r.getUTCDate()},Xb=({currentUser:e,onBuy:n})=>{const s=Date.now(),l=_x(e.lastActionPointPurchaseDate||0,s)&&e.actionPointPurchasesToday||0,r=l<nu,a=r?p0[l]:0,i=()=>{if(!r)return;if(!(e.diamonds>=a)){alert(" .");return}n()};return t.jsxs("div",{className:"bg-gray-800/60 rounded-lg p-4 flex flex-col items-center text-center border-2 border-gray-700",children:[t.jsx("div",{className:"w-24 h-24 bg-gray-900/50 rounded-md mb-3 flex items-center justify-center text-6xl",children:""}),t.jsx("h3",{className:"text-lg font-bold text-white",children:" "}),t.jsxs("p",{className:"text-xs text-gray-400 mt-1 flex-grow h-10",children:[" ",g0,"  . (  )"]}),t.jsx("div",{className:"flex flex-col items-center justify-center gap-2 my-3 w-full",children:t.jsx(F,{onClick:i,disabled:!r,colorScheme:"green",className:"w-full",children:r?t.jsxs("span",{className:"flex items-center justify-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",a.toLocaleString()]}):"   "})}),t.jsxs("p",{className:"text-xs text-gray-400",children:["  : ",l,"/",nu]})]})},qu=({item:e,onBuy:n,currentUser:s})=>{var j;const{name:l,description:r,price:a,image:i,dailyLimit:o,weeklyLimit:c}=e,d=!!a.gold,u=a.gold||a.diamonds||0,p=d?t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4"}):t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"}),m=Date.now(),h=(j=s.dailyShopPurchases)==null?void 0:j[e.itemId];let y=0,v=0,b="";c?(y=h&&!Yb(h.date,m)?h.quantity:0,v=c,b=""):o&&(y=h&&_x(h.date,m)?h.quantity:0,v=o,b="");const g=v>0?v-y:e.type==="equipment"?100:void 0,x=()=>{n({...e,limit:g})};return t.jsxs("div",{className:"bg-gray-800/60 rounded-lg p-4 flex flex-col items-center text-center border-2 border-gray-700",children:[t.jsx("div",{className:"w-24 h-24 bg-gray-900/50 rounded-md mb-3 flex items-center justify-center",children:t.jsx("img",{src:i,alt:l,className:"w-full h-full object-contain p-2"})}),t.jsx("h3",{className:"text-lg font-bold text-white",children:l}),t.jsx("p",{className:"text-xs text-gray-400 mt-1 flex-grow h-10",children:r}),t.jsx("div",{className:"flex flex-col items-stretch justify-center gap-2 my-3 w-full",children:t.jsx(F,{onClick:x,disabled:g===0,colorScheme:"green",className:"w-full",children:t.jsxs("div",{className:"flex items-center justify-center gap-1.5 whitespace-nowrap",children:[t.jsx("span",{children:""}),t.jsxs("div",{className:"flex items-center gap-1",children:["(",p," ",u.toLocaleString(),")"]})]})})}),v>0&&t.jsxs("p",{className:"text-xs text-gray-400",children:[b,"  : ",g,"/",v]})]})},Zb=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{const[r,a]=f.useState("equipment"),[i,o]=f.useState(null),[c,d]=f.useState(null);f.useEffect(()=>{if(i){const y=setTimeout(()=>o(null),3e3);return()=>clearTimeout(y)}},[i]);const u=y=>{d(y)},p=(y,v)=>{const b=c;if(!b)return;const g=b.type==="equipment"?"BUY_SHOP_ITEM":"BUY_MATERIAL_BOX";s({type:g,payload:{itemId:y,quantity:v}}),o(" !  .")},m=()=>{s({type:"PURCHASE_ACTION_POINTS"}),o("  !")},h=()=>{const y=[{itemId:"equipment_box_1",name:"  I",description:"~   ",price:{gold:500},image:"/images/Box/EquipmentBox1.png",type:"equipment"},{itemId:"equipment_box_2",name:"  II",description:"~   ",price:{gold:1500},image:"/images/Box/EquipmentBox2.png",type:"equipment"},{itemId:"equipment_box_3",name:"  III",description:"~   ",price:{gold:5e3},image:"/images/Box/EquipmentBox3.png",type:"equipment"},{itemId:"equipment_box_4",name:"  IV",description:"~   ",price:{gold:1e4},image:"/images/Box/EquipmentBox4.png",type:"equipment"},{itemId:"equipment_box_5",name:"  V",description:"~   ",price:{diamonds:100},image:"/images/Box/EquipmentBox5.png",type:"equipment"},{itemId:"equipment_box_6",name:"  VI",description:"~   ",price:{diamonds:500},image:"/images/Box/EquipmentBox6.png",type:"equipment"}],v=[{itemId:"material_box_1",name:"  I",description:" ~   5 ",price:{gold:500},image:"/images/Box/ResourceBox1.png",dailyLimit:10,type:"material"},{itemId:"material_box_2",name:"  II",description:" ~   5 ",price:{gold:1e3},image:"/images/Box/ResourceBox2.png",dailyLimit:10,type:"material"},{itemId:"material_box_3",name:"  III",description:" ~   5 ",price:{gold:3e3},image:"/images/Box/ResourceBox3.png",dailyLimit:10,type:"material"},{itemId:"material_box_4",name:"  IV",description:" ~   5 ",price:{gold:5e3},image:"/images/Box/ResourceBox4.png",dailyLimit:10,type:"material"},{itemId:"material_box_5",name:"  V",description:" ~   5 ",price:{gold:1e4},image:"/images/Box/ResourceBox5.png",dailyLimit:10,type:"material"},{itemId:"material_box_6",name:"  VI",description:" ~   5 ",price:{diamonds:100},image:"/images/Box/ResourceBox6.png",dailyLimit:10,type:"material"}];switch(r){case"equipment":return t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:y.map(b=>t.jsx(qu,{item:b,onBuy:u,currentUser:e},b.itemId))});case"materials":return t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:v.map(b=>t.jsx(qu,{item:b,onBuy:u,currentUser:e},b.itemId))});case"misc":return t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:t.jsx(Xb,{currentUser:e,onBuy:m})});case"consumables":default:return t.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:t.jsx("p",{children:"    ."})})}};return t.jsxs(t.Fragment,{children:[c&&t.jsx(Mx,{item:c,currentUser:e,onClose:()=>d(null),onConfirm:p}),t.jsx(be,{title:"",onClose:n,windowId:"shop",initialWidth:700,isTopmost:l&&!c,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*60)] flex flex-col relative",children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>a("equipment"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="equipment"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("materials"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="materials"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("consumables"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="consumables"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>a("misc"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${r==="misc"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:h()}),i&&t.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg animate-fade-in z-10",children:i})]})})]})},Pr=[{id:"EI",question:"  ?",options:[{text:"   .",value:"E"},{text:"    .",value:"I"}]},{id:"SN",question:"  ?",options:[{text:"    .",value:"S"},{text:"    .",value:"N"}]},{id:"TF",question:"     ?",options:[{text:"    .",value:"T"},{text:"  ,  .",value:"F"}]},{id:"JP",question:"   ?",options:[{text:"    .",value:"J"},{text:"    .",value:"P"}]}],ev={ISTJ:", , ",ISFJ:", , ",INFJ:", ,  ",INTJ:", , ",ISTP:", ,  ",ISFP:", , ",INFP:",  , ",INTP:" , , ",ESTP:", , ",ESFP:", , ",ENFP:",  , ",ENTP:", , ",ESTJ:", , ",ESFJ:", , ",ENFJ:", , ",ENTJ:", , "},So=({onClose:e,isTopmost:n})=>{const{currentUser:s,handlers:l}=De(),[r,a]=f.useState(!1),[i,o]=f.useState(0),[c,d]=f.useState({}),[u,p]=f.useState(!1),[m,h]=f.useState(null),y=f.useMemo(()=>!!(s!=null&&s.mbti),[s]),v=()=>{a(!0),o(0),d({}),p(!1),h(null)},b=(w,k)=>{d(C=>({...C,[w]:k}))},g=()=>{if(i<Pr.length-1)o(w=>w+1);else{const w=x();h(w),p(!0),l.handleAction({type:"UPDATE_MBTI",payload:{mbti:w,isMbtiPublic:!0}}),l.handleAction({type:"CLAIM_MBTI_REWARD"}),console.log("MBTI set:",w,"100 diamonds rewarded!")}},x=()=>{let w="";return Pr.forEach(k=>{w+=c[k.id]||"?"}),w},j=Pr[i];return t.jsx(be,{title:"MBTI  ",onClose:e,windowId:"mbti-info",initialWidth:400,isTopmost:n,children:t.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2",children:[!r&&!y&&t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("p",{className:"text-lg font-bold text-white mb-2",children:"MBTI ?"}),t.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"MBTI(Myers-Briggs Type Indicator)       .             ."}),t.jsx("button",{onClick:v,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200",children:"MBTI "}),t.jsx("p",{className:"text-sm text-yellow-400 mt-2",children:"  100  !"})]}),r&&!u&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{className:"text-lg font-bold text-white",children:j.question}),t.jsx("div",{className:"space-y-2",children:j.options.map(w=>t.jsx("button",{onClick:()=>b(j.id,w.value),className:`block w-full text-left p-3 rounded-md transition-colors duration-200
                                        ${c[j.id]===w.value?"bg-blue-700 text-white":"bg-gray-800 hover:bg-gray-700 text-gray-200"}`,children:w.text},w.value))}),t.jsx("div",{className:"flex justify-end mt-4",children:t.jsx("button",{onClick:g,disabled:!c[j.id],className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:i<Pr.length-1?"":""})})]}),u&&m&&t.jsxs("div",{className:"text-center",children:[t.jsxs("p",{className:"text-2xl font-bold text-yellow-300 mb-4",children:[" MBTI ",m," !"]}),t.jsx("p",{className:"text-lg text-green-400 mb-4",children:"100  !"}),t.jsx("button",{onClick:e,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200",children:""})]}),!r&&(y||u)&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-lg font-bold text-white mb-2",children:[" MBTI: ",s==null?void 0:s.mbti]}),t.jsx("div",{className:"text-center mb-4",children:t.jsx("button",{onClick:v,className:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200",children:"MBTI  "})}),t.jsx("ul",{className:"space-y-2 mt-4",children:Object.entries(ev).map(([w,k])=>t.jsxs("li",{className:"flex items-center gap-4 bg-gray-900/50 p-2 rounded-md",children:[t.jsx("span",{className:"font-bold text-lg text-yellow-300 w-16",children:w}),t.jsx("span",{className:"text-sm text-gray-300",children:k})]},w))})]})]})})},Uu=({level:e,currentXp:n,label:s,colorClass:l})=>{const r=1e3+(e-1)*200,a=Math.min(n/r*100,100);return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-1 text-sm",children:[t.jsxs("span",{className:"font-semibold",children:[s," ",t.jsxs("span",{className:"text-lg font-bold",children:["Lv.",e]})]}),t.jsxs("span",{className:"text-xs font-mono text-gray-400",children:[n," / ",r]})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4 border border-gray-900",children:t.jsx("div",{className:`${l} h-full rounded-full transition-width duration-500`,style:{width:`${a}%`}})})]})},tv={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},nv=e=>{let n="",s="";if(e>=10)n="/images/equipments/Star4.png",s="prism-text-effect";else if(e>=7)n="/images/equipments/Star3.png",s="text-purple-400";else if(e>=4)n="/images/equipments/Star2.png",s="text-amber-400";else if(e>=1)n="/images/equipments/Star1.png",s="text-white";else return t.jsx("img",{src:"/images/equipments/Star1.png",alt:"star",className:"w-4 h-4 inline-block opacity-30",title:""});return t.jsxs("span",{className:"flex items-center gap-0.5",style:{textShadow:"1px 1px 2px black, 0 0 5px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-4 h-4"}),t.jsx("span",{className:`font-bold ${s}`,children:e})]})},Cs=({slot:e,item:n,onClick:s})=>{const l=n&&s?"cursor-pointer hover:scale-105 transition-transform":"";return n?t.jsxs("div",{className:`relative w-full aspect-square rounded-lg border-2 border-gray-700/50 bg-gray-900/50 ${l}`,title:n.name,onClick:s,children:[t.jsx("img",{src:tv[n.grade],alt:n.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),t.jsx("div",{className:"absolute top-1 right-1 text-sm font-bold z-10",children:nv(n.stars)}),n.image&&t.jsx("img",{src:n.image,alt:n.name,className:"relative w-full h-full object-contain p-3"})]}):t.jsx("img",{src:La[e],alt:`${e} empty slot`,className:"w-full aspect-square rounded-lg bg-gray-900/50 border-2 border-gray-700/50"})},zu=({user:e,type:n})=>{const s=n==="strategic"?at:St,l=e.stats||{};let r=0,a=0;const i=s.map(d=>{const u=l[d.mode];return u?(r+=u.wins,a+=u.losses,{mode:d.mode,...u}):{mode:d.mode,wins:0,losses:0,rankingScore:1200}}),o=r+a,c=o>0?Math.round(r/o*100):0;return t.jsxs("div",{className:"space-y-3 text-xs",children:[t.jsx("div",{className:"bg-gray-700/50 p-2 rounded-md text-center",children:t.jsxs("span",{className:"font-bold",children:[" : ",r," ",a," (",c,"%)"]})}),i.map(d=>{if(d.wins===0&&d.losses===0)return null;const u=d.wins+d.losses,p=u>0?Math.round(d.wins/u*100):0;return t.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-900/30 rounded",children:[t.jsx("span",{className:"font-semibold w-28",children:d.mode}),t.jsxs("span",{className:"w-24 text-center",children:[d.wins," ",d.losses," (",p,"%)"]}),t.jsxs("span",{className:"w-16 text-right font-mono text-yellow-300",children:[d.rankingScore,""]})]},d.mode)})]})},sv=({user:e,onClose:n,onViewItem:s,isTopmost:l})=>{const{inventory:r,stats:a,nickname:i,avatarId:o,borderId:c}=e,[d,u]=f.useState("strategic"),[p,m]=f.useState(!1),h=f.useMemo(()=>{var k;return(k=Te.find(C=>C.id===o))==null?void 0:k.url},[o]),y=f.useMemo(()=>{var k;return(k=Re.find(C=>C.id===c))==null?void 0:k.url},[c]),v=f.useMemo(()=>nl.find(k=>k.tier===e.league),[e.league]),b=f.useMemo(()=>(r||[]).filter(k=>k.isEquipped),[r]),g=k=>b.find(C=>C.slot===k),x=Nx(e),j=kc(x),w=kx(x);return t.jsxs(be,{title:`${i} `,onClose:n,windowId:`user-profile-${e.id}`,initialWidth:750,isTopmost:l,children:[p&&t.jsx(So,{onClose:()=>m(!1),isTopmost:!0}),t.jsxs("div",{className:"flex flex-col md:flex-row gap-4 max-h-[calc(var(--vh,1vh)*70)]",children:[t.jsxs("div",{className:"w-full md:w-1/3 flex-shrink-0 flex flex-col gap-4",children:[t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex flex-col items-center text-center",children:[t.jsx(Ce,{userId:e.id,userName:i,size:80,avatarUrl:h,borderUrl:y}),t.jsx("h2",{className:"text-xl font-bold mt-2",children:i}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mt-1",children:[t.jsx("span",{children:": "}),t.jsxs("span",{className:`font-semibold ${j.color}`,children:[x," (",j.rank,")"]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mt-1",children:[t.jsx("span",{children:"MBTI:"}),t.jsxs("span",{className:"font-semibold text-gray-200 flex items-center gap-1",children:[e.mbti?e.mbti:"",!e.mbti&&t.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"})]}),e.mbti&&t.jsx("button",{onClick:()=>m(!0),className:"w-4 h-4 text-xs bg-gray-600 rounded-full text-white flex items-center justify-center hover:bg-gray-500",children:"?"})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5 mt-2 border border-gray-900",children:t.jsx("div",{className:`${w.colorClass} h-full rounded-full`,style:{width:`${w.percentage}%`}})})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 space-y-3",children:[t.jsx(Uu,{level:e.strategyLevel,currentXp:e.strategyXp,label:"",colorClass:"bg-gradient-to-r from-blue-500 to-cyan-400"}),t.jsx(Uu,{level:e.playfulLevel,currentXp:e.playfulXp,label:"",colorClass:"bg-gradient-to-r from-yellow-500 to-orange-400"})]}),v&&t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex flex-col items-center text-center",children:[t.jsx("img",{src:v.icon,alt:v.name,className:"w-16 h-16"}),t.jsx("h3",{className:"font-bold text-purple-300 mt-1",children:v.name}),t.jsxs("p",{className:"text-sm text-gray-300",children:[e.tournamentScore.toLocaleString()," "]})]})]}),t.jsxs("div",{className:"w-full md:w-2/3 flex flex-col gap-4",children:[t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex-grow flex flex-col min-h-0",children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-3 flex-shrink-0",children:[t.jsx("button",{onClick:()=>u("strategic"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md transition-all ${d==="strategic"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "}),t.jsx("button",{onClick:()=>u("playful"),className:`flex-1 py-1.5 text-sm font-semibold rounded-md transition-all ${d==="playful"?"bg-yellow-600":"text-gray-400 hover:bg-gray-700/50"}`,children:" "})]}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:d==="strategic"?t.jsx(zu,{user:e,type:"strategic"}):t.jsx(zu,{user:e,type:"playful"})})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 flex-shrink-0",children:[t.jsx("h3",{className:"text-center font-semibold mb-3 text-gray-300",children:" "}),t.jsxs("div",{className:"grid grid-cols-3 gap-3 w-full max-w-xs mx-auto",children:[t.jsx(Cs,{slot:"fan",item:g("fan"),onClick:()=>g("fan")&&s(g("fan"),!1)}),t.jsx(Cs,{slot:"board",item:g("board"),onClick:()=>g("board")&&s(g("board"),!1)}),t.jsx(Cs,{slot:"top",item:g("top"),onClick:()=>g("top")&&s(g("top"),!1)}),t.jsx(Cs,{slot:"bottom",item:g("bottom"),onClick:()=>g("bottom")&&s(g("bottom"),!1)}),t.jsx(Cs,{slot:"bowl",item:g("bowl"),onClick:()=>g("bowl")&&s(g("bowl"),!1)}),t.jsx(Cs,{slot:"stones",item:g("stones"),onClick:()=>g("stones")&&s(g("stones"),!1)})]})]})]})]})]})},lv=({onClose:e,isTopmost:n})=>{const[s,l]=f.useState("game"),r=[{id:"game",label:""},{id:"level",label:""},{id:"ranking",label:""},{id:"equipment",label:""},{id:"manner",label:""}],a=()=>{switch(s){case"game":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-blue-300",children:" "}),t.jsx("p",{className:"text-sm",children:" ,        .     .      '?'     ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-yellow-300",children:" "}),t.jsx("p",{className:"text-sm",children:" ,       .     .      '?'     ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-purple-300",children:""}),t.jsx("p",{className:"text-sm",children:"AI    .        ,      .       ."})]})]});case"level":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:" "}),t.jsx("p",{className:"text-sm",children:"/     (XP) .  100%   ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-green-300",children:" "}),t.jsx("p",{className:"text-sm",children:"       2    .   ' '   6   ,     ."})]})]});case"ranking":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:" "}),t.jsx("p",{className:"text-sm",children:"     ,    .     ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-purple-300",children:" "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1 pl-2",children:[t.jsx("li",{children:" 3   (1, 2, 3, 4)."}),t.jsxs("li",{children:["     ",t.jsx("strong",{className:"text-yellow-300",children:" 20"}),"        . ( )"]}),t.jsx("li",{children:"20       ''  ."}),t.jsx("li",{children:"  ,             ."}),t.jsx("li",{children:"      (/)   ,  20   ."})]})]})]});case"equipment":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:" "}),t.jsx("p",{className:"text-sm",children:", ,   6        .  , , , , ,   .      ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-cyan-300",children:""}),t.jsx("p",{className:"text-sm",children:"    ()  5   .      ,        ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-orange-300",children:""}),t.jsx("p",{className:"text-sm",children:"          .   ''  2    ."})]})]});case"manner":return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:"  "}),t.jsx("p",{className:"text-sm",children:"      . ''  ,       ( ,   )   .       ."})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg text-gray-200",children:"   "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-2 pl-2",children:[t.jsxs("li",{children:[t.jsx("span",{className:"text-purple-400 font-semibold",children:" (2000 ):"}),"    +20 (   )"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-blue-400 font-semibold",children:" (1600 ~ 1999):"}),"     +10%"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-cyan-400 font-semibold",children:" (1200 ~ 1599):"}),"        +10%"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-teal-400 font-semibold",children:"  (800 ~ 1199):"}),"      +10%"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-green-400 font-semibold",children:" (400 ~ 799):"}),"   +10"]}),t.jsxs("li",{className:"border-t border-gray-600 pt-2",children:[t.jsx("span",{className:"text-gray-300 font-semibold",children:" (200 ~ 399):"}),"  "]}),t.jsxs("li",{className:"border-t border-gray-600 pt-2",children:[t.jsx("span",{className:"text-yellow-400 font-semibold",children:" (100 ~ 199):"}),"        +1  "]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-orange-400 font-semibold",children:" (50 ~ 99):"}),"   50% "]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-500 font-semibold",children:"  (1 ~ 49):"}),"     (20 1)"]}),t.jsxs("li",{children:[t.jsx("span",{className:"text-red-700 font-semibold",children:" (0):"}),"   10% "]})]})]})]});default:return null}};return t.jsx(be,{title:"",onClose:e,windowId:"info-modal",initialWidth:600,isTopmost:n,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*60)] flex flex-col",children:[t.jsx("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:r.map(i=>t.jsx("button",{onClick:()=>l(i.id),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s===i.id?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:i.label},i.id))}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 bg-gray-900/30 p-4 rounded-md",children:a()})]})})},Ax=({isOpen:e,onClose:n,result:s})=>!e||!s?null:t.jsx(be,{title:" ",onClose:n,windowId:"disassemblyResult",isTopmost:!0,children:t.jsxs("div",{className:"p-4 text-on-panel flex flex-col items-center",children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:"  !"}),s.jackpot&&t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("p",{className:"text-yellow-400 text-2xl font-bold animate-pulse",children:"!"}),t.jsx("p",{className:"text-lg text-green-400",children:"   2 !"})]}),t.jsxs("div",{className:"w-full max-h-60 overflow-y-auto bg-gray-800/50 p-3 rounded-lg mb-4",children:[t.jsx("p",{className:"font-semibold text-secondary mb-2",children:" :"}),s.gained.length>0?s.gained.map((l,r)=>{const a=Zt[l.name];return t.jsxs("div",{className:"flex items-center justify-between text-sm py-1 border-b border-gray-700 last:border-b-0",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[(a==null?void 0:a.image)&&t.jsx("img",{src:a.image,alt:l.name,className:"w-6 h-6"}),l.name]}),t.jsxs("span",{className:"font-mono text-primary",children:["x ",l.amount.toLocaleString()]})]},r)}):t.jsx("p",{className:"text-sm text-tertiary",children:"  ."})]}),t.jsx(F,{onClick:n,colorScheme:"blue",className:"w-full max-w-xs",children:""})]})}),rv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{const[r,a]=f.useState(!e.spentStatPoints||Object.keys(e.spentStatPoints).length===0),[i,o]=f.useState(()=>e.spentStatPoints&&Object.keys(e.spentStatPoints).length>0?e.spentStatPoints:{[N.Concentration]:0,[N.ThinkingSpeed]:0,[N.Judgment]:0,[N.Calculation]:0,[N.CombatPower]:0,[N.Stability]:0}),c=1e3,d=2,u=new Date().toDateString(),p=e.lastStatResetDate,m=e.statResetCountToday||0,h=f.useMemo(()=>!(e.gold<c||p===u&&m>=d),[e.diamonds,p,m,u]),y=(e.strategyLevel-1)*2+(e.playfulLevel-1)*2,v=e.mannerMasteryApplied?20:0,b=y+v,g=f.useMemo(()=>Object.values(i).reduce((_,I)=>_+I,0),[i]),x=f.useMemo(()=>r?b-g:0,[r,b,g]),j=(_,I)=>{const T=Number(I)||0;o(B=>{const R=Object.entries(B).filter(([Q])=>Q!==_).reduce((Q,[,q])=>Q+q,0),A=b-R,L=Math.max(0,Math.min(T,A));return{...B,[_]:L}})},w=()=>{if(!h){alert("    .      .");return}window.confirm(` ${c}     ? ( ${d-m} )`)&&(s({type:"RESET_STAT_POINTS"}),o({[N.Concentration]:0,[N.ThinkingSpeed]:0,[N.Judgment]:0,[N.Calculation]:0,[N.CombatPower]:0,[N.Stability]:0}),a(!0))},k=f.useMemo(()=>e.spentStatPoints?Object.values(N).some(_=>i[_]!==e.spentStatPoints[_]):g>0,[i,e.spentStatPoints,g]),C=()=>{s({type:"CONFIRM_STAT_ALLOCATION",payload:{newStatPoints:i}}),n()},S=f.useMemo(()=>{const _={};for(const I of Object.values(N))_[I]=(e.baseStats[I]||0)+(i[I]||0);return _},[e.baseStats,i]),P=f.useMemo(()=>[{stats:S,color:"#60a5fa",fill:"rgba(59, 130, 246, 0.4)"}],[S]);return t.jsx(be,{title:"  ",onClose:n,windowId:"stat-allocation",initialWidth:700,isTopmost:l,children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-6 h-[calc(var(--vh,1vh)*70)]",children:[t.jsxs("div",{className:"w-full md:w-1/2 flex flex-col items-center justify-center bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-bold mb-4",children:" "}),t.jsx(Ex,{datasets:P,maxStatValue:300})]}),t.jsxs("div",{className:"w-full md:w-1/2 flex flex-col",children:[t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg mb-4 text-center",children:[t.jsx("p",{className:"text-gray-300",children:"   "}),t.jsx("p",{className:"text-3xl font-bold text-green-400",children:x})]}),t.jsx("div",{className:"flex-grow space-y-2 overflow-y-auto pr-2",children:Object.values(N).map(_=>{const I=i[_]||0,T=I+x;return t.jsxs("div",{className:"bg-gray-900/40 p-2 md:p-3 rounded-md",children:[t.jsxs("div",{className:"flex justify-between items-center mb-1",children:[t.jsx("span",{className:"font-bold text-gray-200 text-sm md:text-base",children:_}),t.jsx("span",{className:"font-mono font-bold text-lg",title:`: ${e.baseStats[_]}, : ${I}`,children:S[_]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"range",min:"0",max:T,value:I,onChange:B=>j(_,B.target.value),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer",disabled:!r}),t.jsx("input",{type:"number",value:I,onChange:B=>j(_,B.target.value),className:"w-16 bg-gray-700 border border-gray-600 rounded-md p-1 text-center",disabled:!r})]}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:l0[_].description})]},_)})}),t.jsxs("div",{className:"flex justify-between mt-4 pt-4 border-t border-gray-700",children:[t.jsxs("div",{className:"flex flex-col items-start",children:[t.jsxs(F,{onClick:w,colorScheme:"red",disabled:!h,children:[" (",t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-4 h-4 inline-block"}),c,")"]}),t.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[" : ",d-m,"/",d]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(F,{onClick:n,colorScheme:"gray",children:""}),t.jsx(F,{onClick:C,colorScheme:"green",disabled:!r||!k,children:""})]})]})]})]})})},av={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},iv=e=>{if(e===0)return null;let n="",s="";return e>=10?(n="/images/equipments/Star4.png",s="prism-text-effect"):e>=7?(n="/images/equipments/Star3.png",s="text-purple-400"):e>=4?(n="/images/equipments/Star2.png",s="text-amber-400"):e>=1&&(n="/images/equipments/Star1.png",s="text-white"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:`font-bold text-xs leading-none ${s}`,children:e})]})},ov=({item:e,isOwnedByCurrentUser:n,onClose:s,onStartEnhance:l,isTopmost:r})=>{var u,p,m,h;const{currentUserWithStatus:a}=De(),i=av[e.grade],o=En[e.grade],d=((a==null?void 0:a.strategyLevel)||0)+((a==null?void 0:a.playfulLevel)||0)>=o;return t.jsx(be,{title:"  ",onClose:s,windowId:`item-detail-${e.id}`,initialWidth:350,isTopmost:r,children:t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"relative w-24 h-24 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:i.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-2"}),iv(e.stars)]}),t.jsxs("div",{className:"flex-grow text-right ml-4",children:[t.jsx("div",{className:"flex items-baseline justify-end gap-1",children:t.jsx("h3",{className:`text-xl font-bold ${i.color}`,children:e.name})}),t.jsxs("p",{className:"text-gray-400 text-sm",children:["[",i.name,"]"]}),t.jsxs("p",{className:`text-xs ${d?"text-gray-500":"text-red-500"}`,children:["(: ",o,")"]}),((u=e.options)==null?void 0:u.main)&&t.jsx("p",{className:"font-semibold text-yellow-300 text-sm",children:e.options.main.display})]})]}),t.jsxs("div",{className:"w-full text-sm text-left space-y-2 bg-gray-900/50 p-3 rounded-lg flex-grow overflow-y-auto",children:[((p=e.options)==null?void 0:p.combatSubs)&&e.options.combatSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.combatSubs.map((y,v)=>t.jsx("p",{className:"text-blue-300",children:y.display},v))}),((m=e.options)==null?void 0:m.specialSubs)&&e.options.specialSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.specialSubs.map((y,v)=>t.jsx("p",{className:"text-green-300",children:y.display},v))}),((h=e.options)==null?void 0:h.mythicSubs)&&e.options.mythicSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.mythicSubs.map((y,v)=>t.jsx("p",{className:"text-red-400",children:y.display},v))})]}),n&&e.type==="equipment"&&t.jsx("div",{className:"w-full mt-6 pt-4 border-t border-gray-700",children:t.jsx(F,{onClick:()=>l(e),disabled:e.stars>=10,colorScheme:"yellow",className:"w-full",children:e.stars>=10?" ":""})})]})})},Ln=({checked:e,onChange:n,label:s,disabled:l=!1})=>{const r=Pn.useId();return t.jsxs("label",{htmlFor:r,className:`flex items-center ${l?"cursor-not-allowed opacity-60":"cursor-pointer"}`,children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{id:r,type:"checkbox",className:"sr-only",checked:e,onChange:a=>!l&&n(a.target.checked),disabled:l}),t.jsx("div",{className:`block w-12 h-6 rounded-full transition-colors ${e?"bg-accent":"bg-secondary"}`}),t.jsx("div",{className:`dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform ${e?"transform translate-x-6":""}`})]}),s&&t.jsx("span",{className:"ml-3 text-secondary font-medium",children:s})]})},Ci={E:{name:" (E)",general:" .       .",goStyle:"     .        ."},I:{name:" (I)",general:" ,    .         .",goStyle:"     .     ,    ."},S:{name:" (S)",general:" ,    .     .",goStyle:"     .    ,   ."},N:{name:" (N)",general:"  .   ,     .",goStyle:"    .  ,       ."},T:{name:" (T)",general:" ,     .    .",goStyle:"       .      ."},F:{name:" (F)",general:"     .     ,   .",goStyle:"      .       ."},J:{name:" (J)",general:" ,     .       .",goStyle:"      .      ,    ."},P:{name:" (P)",general:"   ,    .     .",goStyle:"       .       ."}},cv=({currentUser:e,onClose:n,onAction:s,isTopmost:l})=>{const{handlers:r}=De(),[a,i]=f.useState("border"),[o,c]=f.useState(e.avatarId),[d,u]=f.useState(e.borderId),[p,m]=f.useState(e.nickname),[h,y]=f.useState(e.isMbtiPublic||!1),v=I=>I&&I.length===4?{ei:I[0],sn:I[1],tf:I[2],jp:I[3]}:{ei:"E",sn:"S",tf:"T",jp:"J"},[b,g]=f.useState(v(e.mbti)),x=150,j=e.diamonds>=x,w=f.useMemo(()=>{var I;return(I=Te.find(T=>T.id===e.avatarId))==null?void 0:I.url},[e.avatarId]),k=()=>{switch(a){case"avatar":o!==e.avatarId&&s({type:"UPDATE_AVATAR",payload:{avatarId:o}});break;case"border":d!==e.borderId&&s({type:"UPDATE_BORDER",payload:{borderId:d}});break;case"nickname":if(p!==e.nickname){if(Yl(p)){alert("    .");return}window.confirm(` ${x}   '${p}'() ?`)&&s({type:"CHANGE_NICKNAME",payload:{newNickname:p}})}break;case"mbti":const I=`${b.ei}${b.sn}${b.tf}${b.jp}`;s({type:"UPDATE_MBTI",payload:{mbti:I,isMbtiPublic:!0}});break}},C=f.useMemo(()=>{switch(a){case"avatar":return o===e.avatarId;case"border":return d===e.borderId;case"nickname":return p===e.nickname||!j||p.trim().length<2||p.trim().length>12;case"mbti":return`${b.ei}${b.sn}${b.tf}${b.jp}`===(e.mbti||"");default:return!0}},[a,o,d,p,e,j,b]),S=f.useMemo(()=>{const I=B=>lu.some(R=>R.id===B.id),T={:[],:[],:[],:[]};return Re.forEach(B=>{B.unlockTier?T..push(B):B.requiredLevelSum?T..push(B):I(B)?T..push(B):T..push(B)}),T},[]),P=()=>{switch(a){case"avatar":return t.jsx("div",{className:"flex flex-wrap justify-center gap-4",children:Te.map(I=>{const T=I.type==="any"||I.type==="strategy"&&e.strategyLevel>=I.requiredLevel||I.type==="playful"&&e.playfulLevel>=I.requiredLevel;return t.jsxs("div",{onClick:()=>T&&c(I.id),className:`relative p-2 rounded-lg border-2 ${o===I.id?"border-blue-500 ring-2 ring-blue-500":"border-gray-700"} ${T?"cursor-pointer hover:bg-gray-700/50":"opacity-50 cursor-not-allowed"}`,children:[t.jsx(Ce,{userId:"preview",userName:I.name,avatarUrl:I.url,size:80}),t.jsx("p",{className:"text-xs text-center mt-1",children:I.name}),!T&&t.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center text-center text-xs p-1 rounded-full",children:[t.jsx("span",{className:"font-bold",children:""}),t.jsxs("span",{children:[I.type==="strategy"?"":""," Lv.",I.requiredLevel]})]})]},I.id)})});case"border":{const{ownedBorders:I,strategyLevel:T,playfulLevel:B,previousSeasonTier:R}=e,A=T+B,L=At.map(Q=>Q.name);return t.jsx("div",{className:"space-y-6",children:Object.keys(S).map(Q=>{const q=S[Q];return q.length===0?null:t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-semibold text-yellow-300 mb-3 border-b border-gray-700 pb-2",children:Q}),t.jsx("div",{className:"flex flex-wrap justify-start gap-4",children:q.map(O=>{var K,W;const U=(I==null?void 0:I.includes(O.id))||O.id==="default"||O.id==="simple_black";let G=!1,z=O.description;if(O.unlockTier){if(z=`  ${O.unlockTier}  `,R){const D=L.indexOf(O.unlockTier),V=L.indexOf(R);D!==-1&&V!==-1&&V<=D&&(G=!0)}}else O.requiredLevelSum&&(z=`  ${O.requiredLevelSum} `,A>=O.requiredLevelSum&&(G=!0));const H=U||G,ne=lu.find(D=>D.id===O.id),oe=ne&&!U,me=()=>{var D;if(H)u(O.id);else if(oe){const V=ne.price.gold?`${ne.price.gold.toLocaleString()} `:`${(D=ne.price.diamonds)==null?void 0:D.toLocaleString()} `;window.confirm(`'${O.name}'  ${V} ?`)&&s({type:"BUY_BORDER",payload:{borderId:O.id}})}},J=H||oe?"cursor-pointer":"cursor-not-allowed",fe=!H&&!oe?"opacity-50":"",ye=H?O.description:oe?` : ${O.description}`:z;return t.jsxs("div",{onClick:me,className:`relative flex flex-col items-center gap-1 p-1 rounded-lg ${J}`,title:ye,children:[t.jsxs("div",{className:`p-1 rounded-full relative ${d===O.id?"border-2 border-blue-500 ring-2 ring-blue-500":"border-2 border-transparent"}`,children:[t.jsx("div",{className:fe,children:t.jsx(Ce,{userId:"preview",userName:O.name,avatarUrl:w,borderUrl:O.url,size:80})}),!H&&!oe&&t.jsx("div",{className:"absolute top-1 right-1 bg-gray-900/80 rounded-full p-1",children:t.jsx("span",{className:"text-base",role:"img","aria-label":"Locked",children:""})}),oe&&t.jsxs("div",{className:"absolute bottom-0 inset-x-0 bg-black/70 rounded-b-md text-xs py-0.5 text-center flex items-center justify-center gap-1",children:[ne.price.gold?t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-3 h-3"}):t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-3 h-3"}),t.jsx("span",{children:((K=ne.price.gold)==null?void 0:K.toLocaleString())||((W=ne.price.diamonds)==null?void 0:W.toLocaleString())})]})]}),t.jsx("p",{className:"text-xs text-center truncate w-24",children:O.name}),!H&&!oe&&t.jsx("p",{className:"text-[10px] text-center text-red-400",children:O.requiredLevelSum?` ${O.requiredLevelSum}`:O.unlockTier?`${O.unlockTier} `:""})]},O.id)})})]},Q)})})}case"nickname":return t.jsxs("div",{className:"space-y-4 max-w-sm mx-auto p-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"nickname-input",className:"block text-sm font-medium text-gray-300 mb-1",children:"  (2-12)"}),t.jsx("input",{id:"nickname-input",type:"text",value:p,onChange:I=>m(I.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-md p-3 focus:ring-blue-500 focus:border-blue-500",maxLength:12,minLength:2})]}),t.jsxs("div",{className:"text-sm p-3 rounded-md bg-gray-900/50",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"}),t.jsxs("span",{className:`font-bold flex items-center gap-1 ${j?"text-cyan-300":"text-red-400"}`,children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",x]})]}),t.jsxs("div",{className:"flex justify-between mt-1",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-4 h-4"})," ",e.diamonds.toLocaleString()]})]})]})]});case"mbti":{const I=({title:B,options:R,selected:A,onSelect:L})=>t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg flex-1",children:[t.jsx("h4",{className:"font-semibold text-lg text-center mb-2",children:B}),t.jsx("div",{className:"flex justify-center gap-2 mb-3",children:R.map(Q=>t.jsx(F,{onClick:()=>L(Q),colorScheme:A===Q?"blue":"gray",className:"w-24",children:Ci[Q].name},Q))}),t.jsxs("div",{className:"bg-gray-800/60 p-2 rounded-md text-xs min-h-[120px]",children:[t.jsx("h5",{className:"font-bold text-yellow-300",children:" "}),t.jsx("p",{className:"text-gray-300",children:Ci[A].general}),t.jsx("h5",{className:"font-bold text-cyan-300 mt-2",children:" "}),t.jsx("p",{className:"text-gray-300",children:Ci[A].goStyle})]})]}),T=`${b.ei}${b.sn}${b.tf}${b.jp}`;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg text-center",children:[t.jsx("h3",{className:"text-lg font-bold text-yellow-300",children:"MBTI?"}),t.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"MBTI 4    16       .      !"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(I,{title:" ",options:["E","I"],selected:b.ei,onSelect:B=>g(R=>({...R,ei:B}))}),t.jsx(I,{title:" ",options:["S","N"],selected:b.sn,onSelect:B=>g(R=>({...R,sn:B}))}),t.jsx(I,{title:" ",options:["T","F"],selected:b.tf,onSelect:B=>g(R=>({...R,tf:B}))}),t.jsx(I,{title:" ",options:["J","P"],selected:b.jp,onSelect:B=>g(R=>({...R,jp:B}))})]}),t.jsxs("div",{className:"p-3 bg-gray-900/50 rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold text-lg",children:" MBTI:"}),t.jsx("span",{className:"font-bold text-2xl text-green-400",children:T})]}),t.jsx(Ln,{label:" MBTI  ",checked:h,onChange:y})]})]})}default:return null}},_=[{id:"avatar",label:""},{id:"border",label:""},{id:"nickname",label:""},{id:"mbti",label:"MBTI"}];return t.jsx(be,{title:"",onClose:n,windowId:"profile-edit",initialWidth:750,isTopmost:l,children:t.jsxs("div",{className:"flex flex-col h-[70vh]",children:[t.jsx("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:_.map(I=>t.jsxs("button",{onClick:()=>i(I.id),className:`relative flex-1 py-2 text-sm font-semibold rounded-md transition-all ${a===I.id?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:[I.label,I.id==="mbti"&&!e.mbti&&t.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]},I.id))}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:P()}),t.jsxs("div",{className:"flex justify-end gap-4 mt-4 pt-4 border-t border-gray-700 flex-shrink-0",children:[t.jsx(F,{onClick:n,colorScheme:"gray",children:""}),t.jsx(F,{onClick:k,colorScheme:"green",disabled:C,children:a==="nickname"&&!j?" ":""})]})]})})},dv={normal:{bg:"bg-gray-700",text:"text-white",shadow:"shadow-gray-900/50",name:"",background:"/images/equipments/normalbgi.png"},uncommon:{bg:"bg-green-700",text:"text-green-200",shadow:"shadow-green-500/50",name:"",background:"/images/equipments/uncommonbgi.png"},rare:{bg:"bg-blue-700",text:"text-blue-200",shadow:"shadow-blue-500/50",name:"",background:"/images/equipments/rarebgi.png"},epic:{bg:"bg-purple-700",text:"text-purple-200",shadow:"shadow-purple-500/50",name:"",background:"/images/equipments/epicbgi.png"},legendary:{bg:"bg-red-800",text:"text-red-200",shadow:"shadow-red-500/50",name:"",background:"/images/equipments/legendarybgi.png"},mythic:{bg:"bg-orange-700",text:"text-orange-200",shadow:"shadow-orange-500/50",name:"",background:"/images/equipments/mythicbgi.png"}},uv={rare:"spinning-border-rare",epic:"spinning-border-epic",legendary:"spinning-border-legendary",mythic:"spinning-border-mythic"},mv=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-blue-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},Tr=({title:e,options:n,color:s})=>n.length===0?null:t.jsxs("div",{children:[t.jsx("h5",{className:`font-semibold ${s} border-b border-gray-600 pb-1 mb-1 text-sm`,children:e}),t.jsx("ul",{className:"list-disc list-inside space-y-0.5 text-gray-300 text-xs",children:n.map((l,r)=>t.jsx("li",{children:l.display},r))})]}),fv=e=>{if(!e.options)return null;const{main:n,combatSubs:s,specialSubs:l,mythicSubs:r}=e.options;return t.jsxs("div",{className:"w-full text-xs text-left space-y-2",children:[t.jsx(Tr,{title:"",options:[n],color:"text-yellow-300"}),t.jsx(Tr,{title:" ",options:s,color:"text-blue-300"}),t.jsx(Tr,{title:" ",options:l,color:"text-green-300"}),t.jsx(Tr,{title:" ",options:r,color:"text-red-400"})]})},xv=({item:e,onClose:n,isTopmost:s})=>{var c;const l=dv[e.grade],r=e.type==="equipment"?En[e.grade]:null,a=mv(e.stars),i=uv[e.grade],o=e.image==="/images/icon/Gold.png"||e.image==="/images/icon/Zem.png";return f.useEffect(()=>{["epic","legendary","mythic"].includes(e.grade)&&Ee.gachaEpicOrHigher()},[e.grade]),t.jsx(be,{title:" ",onClose:n,windowId:"item-obtained",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"p-6 rounded-lg",children:[t.jsxs("div",{className:"relative w-48 h-48 mx-auto rounded-lg mb-4 overflow-hidden",children:[i&&t.jsx("div",{className:`absolute -inset-1 rounded-lg ${i}`}),t.jsxs("div",{className:"relative w-full h-full rounded-lg flex items-center justify-center border-2 border-black/50 overflow-hidden",children:[t.jsx("img",{src:l.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-4"}),o&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-sm p-1",children:t.jsxs("span",{className:"text-white text-3xl font-bold text-center break-words",style:{textShadow:"1px 1px 2px black"},children:["+",(c=e.quantity)==null?void 0:c.toLocaleString()]})})]})]}),t.jsxs("p",{className:`font-bold text-lg ${l.text}`,children:["[",l.name,"]"]}),t.jsxs("div",{className:"flex items-baseline justify-center gap-2",children:[t.jsx("h2",{className:`text-3xl font-bold ${a.colorClass}`,children:e.name}),e.stars>0&&t.jsx("span",{className:`text-2xl font-bold ${a.colorClass}`,children:a.text})]}),r&&t.jsxs("p",{className:"text-xs text-yellow-300",children:["(  : ",r,")"]}),e.type==="equipment"&&t.jsx("div",{className:"w-full text-xs text-left space-y-2 mt-4 max-h-48 overflow-y-auto bg-black/20 p-2 rounded-md",children:fv(e)})]}),t.jsx(F,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},pv={normal:{bg:"bg-gray-700",text:"text-white",shadow:"shadow-gray-900/50",name:"",background:"/images/equipments/normalbgi.png"},uncommon:{bg:"bg-green-700",text:"text-green-200",shadow:"shadow-green-500/50",name:"",background:"/images/equipments/uncommonbgi.png"},rare:{bg:"bg-blue-700",text:"text-blue-200",shadow:"shadow-blue-500/50",name:"",background:"/images/equipments/rarebgi.png"},epic:{bg:"bg-purple-700",text:"text-purple-200",shadow:"shadow-purple-500/50",name:"",background:"/images/equipments/epicbgi.png"},legendary:{bg:"bg-red-800",text:"text-red-200",shadow:"shadow-red-500/50",name:"",background:"/images/equipments/legendarybgi.png"},mythic:{bg:"bg-orange-700",text:"text-orange-200",shadow:"shadow-orange-500/50",name:"",background:"/images/equipments/mythicbgi.png"}},gv={rare:"spinning-border-rare",epic:"spinning-border-epic",legendary:"spinning-border-legendary",mythic:"spinning-border-mythic"},hv=({items:e,onClose:n,isTopmost:s})=>{f.useEffect(()=>{if(e&&e.length>0){const r=["normal","uncommon","rare","epic","legendary","mythic"],a=e.reduce((i,o)=>{const c=i.grade||"normal",d=o.grade||"normal";return r.indexOf(d)>r.indexOf(c)?o:i});["epic","legendary","mythic"].includes(a.grade)&&Ee.gachaEpicOrHigher()}},[e]);const l=f.useMemo(()=>e.reduce((r,a)=>r+(a.quantity||1),0),[e]);return t.jsx(be,{title:"  ",onClose:n,windowId:"bulk-item-obtained",initialWidth:600,closeOnOutsideClick:!1,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsxs("h2",{className:"text-xl font-bold mb-4",children:[" ",l," !"]}),t.jsx("div",{className:"grid grid-cols-5 gap-2 max-h-[60vh] overflow-y-auto p-2 bg-gray-900/50 rounded-lg",children:e.map((r,a)=>{var p;const i=pv[r.grade],o=gv[r.grade],c=r.type==="equipment"?En[r.grade]:null,d=`${r.name}${c?` (  : ${c})`:""}`,u=r.image==="/images/icon/Gold.png"||r.image==="/images/icon/Zem.png";return t.jsxs("div",{className:"relative aspect-square rounded-md overflow-hidden",title:d,children:[o&&t.jsx("div",{className:`absolute -inset-0.5 rounded-md ${o}`}),t.jsxs("div",{className:`relative w-full h-full rounded-md flex items-center justify-center border-2 border-black/20 ${i.bg}`,children:[t.jsx("img",{src:i.background,alt:r.grade,className:"absolute inset-0 w-full h-full object-cover rounded-sm"}),r.image&&t.jsx("img",{src:r.image,alt:r.name,className:"relative w-full h-full object-contain p-1"}),u?t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-sm p-1",children:t.jsxs("span",{className:"text-white text-lg font-bold text-center break-words",style:{textShadow:"1px 1px 2px black"},children:["+",(p=r.quantity)==null?void 0:p.toLocaleString()]})}):r.quantity&&r.quantity>1&&t.jsx("span",{className:"absolute bottom-0 right-0 text-xs font-bold text-white bg-black/60 px-1 rounded-tl-md",children:r.quantity})]})]},a)})}),t.jsx(F,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},Fu={normal:"images/equipments/normalbgi.png",uncommon:"images/equipments/uncommonbgi.png",rare:"images/equipments/rarebgi.png",epic:"images/equipments/epicbgi.png",legendary:"images/equipments/legendarybgi.png",mythic:"images/equipments/mythicbgi.png"},Mr={normal:0,uncommon:1,rare:2,epic:3,legendary:4,mythic:5},yv=({onClose:e,isTopmost:n})=>{const[s,l]=f.useState("equipment"),r=["fan","board","top","bottom","bowl","stones"],a={fan:"",board:"",top:"",bottom:"",bowl:"",stones:""},i=[{id:"",name:""},{id:"",name:""},{id:"",name:""},{id:"",name:""}],o={normal:{name:"",color:"text-gray-300"},uncommon:{name:"",color:"text-green-400"},rare:{name:"",color:"text-blue-400"},epic:{name:"",color:"text-purple-400"},legendary:{name:"",color:"text-red-500"},mythic:{name:"",color:"text-orange-400"}},[c,d]=f.useState("fan"),[u,p]=f.useState(null),[m,h]=f.useState(""),y=f.useMemo(()=>{if(s==="equipment")return vc.filter(x=>x.slot===c).sort((x,j)=>Mr[x.grade]-Mr[j.grade]);if(s==="material")return Object.values(Zt).sort((x,j)=>Mr[x.grade]-Mr[j.grade]);if(s==="consumable"){const j={:" ",:" ",:" ",:" "}[m];return[...vs].filter(k=>k.name.includes(j)).sort((k,C)=>k.name.localeCompare(C.name))}return[]},[s,c,m]);f.useEffect(()=>{y.length>0?(!u||!y.some(x=>x.name===u.name))&&p(y[0]):u&&p(null)},[y,u]);const v=()=>{var T;if(!u||u.type!=="equipment"||!u.slot)return null;const x=a0[u.grade],j=B=>B[0]===B[1]?`${B[0]}`:`${B[0]}~${B[1]}`,w=x.mythicCount[0]>0,k=((T=i0[u.slot])==null?void 0:T[x.combatTier])||[],C=r0[u.slot],S=C.options[u.grade],P=S.value,_=C.isPercentage,I=S.stats.join("  ");return t.jsxs(t.Fragment,{children:[t.jsx("h5",{className:"text-sm md:text-base font-semibold text-yellow-300 mt-3 border-b border-gray-600 pb-1",children:""}),t.jsxs("p",{className:"text-xs md:text-sm text-gray-300 py-1",children:[t.jsx("strong",{className:"text-yellow-400",children:I}),": +",P,_?"%":""]}),t.jsxs("h5",{className:"text-sm md:text-base font-semibold text-blue-300 mt-3 border-b border-gray-600 pb-1",children:[" ( ",j(x.combatCount),")"]}),t.jsx("ul",{className:"space-y-1 text-[10px] md:text-xs text-gray-300 pt-1",children:k.map((B,R)=>t.jsxs("li",{children:[t.jsx("strong",{className:"text-blue-400",children:B.type}),": +",B.range[0],"~",B.range[1],B.isPercentage?"%":""]},`${B.type}-${R}`))}),t.jsxs("h5",{className:"text-sm md:text-base font-semibold text-green-300 mt-3 border-b border-gray-600 pb-1",children:["  ( ",j(x.specialCount),")"]}),t.jsx("ul",{className:"space-y-1 text-[10px] md:text-xs text-gray-300 pt-1",children:Object.entries(ox).map(([B,R])=>t.jsxs("li",{children:[t.jsx("strong",{className:"text-green-400",children:R.name}),": +",R.range[0],"~",R.range[1],R.isPercentage?"%":""]},B))}),w&&t.jsxs(t.Fragment,{children:[t.jsxs("h5",{className:"text-sm md:text-base font-semibold text-red-400 mt-3 border-b border-gray-600 pb-1",children:["  ( ",j(x.mythicCount),")"]}),t.jsx("ul",{className:"space-y-1 text-[10px] md:text-xs text-gray-300 pt-1",children:Object.values(rt).map(B=>{const R=cx[B];return t.jsxs("li",{children:[t.jsx("strong",{className:"text-red-400",children:R.name}),": ",R.description]},B)})})]})]})},b=()=>t.jsxs("div",{className:"text-left text-gray-300 space-y-6 overflow-y-auto pr-2 h-full",children:[t.jsx("h3",{className:"text-2xl font-bold text-center text-yellow-300",children:"    "}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-green-400 border-b-2 border-green-400/50 pb-1 mb-2",children:" "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1",children:[t.jsx("li",{children:"     . (+4, +7, +10   2 )"}),t.jsx("li",{children:"      ."})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-blue-400 border-b-2 border-blue-400/50 pb-1 mb-2",children:" "}),t.jsxs("ul",{className:"list-disc list-inside text-sm space-y-2",children:[t.jsx("li",{children:"     , ,      ."}),t.jsxs("li",{children:[t.jsx("strong",{className:"text-yellow-400",children:" :"}),"             .       ."]}),t.jsxs("li",{children:[t.jsx("strong",{className:"text-yellow-400",children:"/ :"}),"       ."]}),t.jsxs("li",{children:[t.jsx("strong",{className:"text-yellow-400",children:" :"}),"         ."]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-lg font-semibold text-purple-400 border-b-2 border-purple-400/50 pb-1 mb-2",children:"  "}),t.jsxs("div",{className:"space-y-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-yellow-300",children:""}),t.jsx("p",{className:"text-xs text-gray-400 pl-4",children:"1     .    (+4),  (+7),  (+10)    2 ."})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-blue-300",children:""}),t.jsx("p",{className:"text-xs text-gray-400 pl-4",children:" 4 . 1  4     , 4        ."})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-semibold text-green-300",children:"  &  "}),t.jsx("p",{className:"text-xs text-gray-400 pl-4",children:"    .      ."})]})]})]})]});return t.jsxs(be,{title:"",onClose:e,windowId:"encyclopedia",initialWidth:900,isTopmost:n,children:[t.jsxs("div",{className:"flex bg-gray-900/70 p-1 rounded-lg mb-4 flex-shrink-0",children:[t.jsx("button",{onClick:()=>l("equipment"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="equipment"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>l("material"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="material"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>l("consumable"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="consumable"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""}),t.jsx("button",{onClick:()=>l("help"),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${s==="help"?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:""})]}),s==="help"?t.jsx("div",{className:"h-[calc(var(--vh,1vh)*65)] bg-gray-900/50 rounded-lg p-4",children:b()}):t.jsxs("div",{className:"flex gap-4 h-[calc(var(--vh,1vh)*65)] flex-row",children:[t.jsxs("div",{className:"flex flex-col gap-4 w-1/2 h-full",children:[s==="consumable"&&t.jsxs("div",{className:"w-full bg-gray-900/50 rounded-lg p-2 flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold mb-2 hidden md:block",children:""}),t.jsx("div",{className:"flex flex-row md:flex-col gap-2 overflow-x-auto md:overflow-y-auto md:overflow-x-hidden pb-1 md:pb-0 scrollbar-thin",children:i.map(x=>t.jsx("button",{onClick:()=>h(x.id),className:`flex-shrink-0 whitespace-nowrap text-center rounded-md transition-colors px-3 py-1.5 text-xs md:text-left md:w-full md:px-4 md:py-2 md:text-sm ${m===x.id?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:x.name},x.id))})]}),s==="equipment"&&t.jsxs("div",{className:"w-full bg-gray-900/50 rounded-lg p-2 flex-shrink-0",children:[t.jsx("h3",{className:"text-lg font-bold mb-2 hidden md:block",children:""}),t.jsx("div",{className:"flex flex-row md:flex-col gap-2 overflow-x-auto md:overflow-y-auto md:overflow-x-hidden pb-1 md:pb-0 scrollbar-thin",children:r.map(x=>t.jsx("button",{onClick:()=>d(x),className:`flex-shrink-0 whitespace-nowrap text-center rounded-md transition-colors px-3 py-1.5 text-xs md:text-left md:w-full md:px-4 md:py-2 md:text-sm ${c===x?"bg-blue-600":"text-gray-400 hover:bg-gray-700/50"}`,children:a[x]},x))})]}),t.jsxs("div",{className:"w-full bg-gray-900/50 rounded-lg p-2 flex flex-col min-h-0 flex-grow",children:[t.jsx("h3",{className:"text-lg font-bold mb-2 flex-shrink-0",children:" "}),t.jsx("div",{className:"flex flex-col space-y-1 overflow-y-auto pr-2 flex-grow",children:y.map(x=>t.jsxs("button",{onClick:()=>p(x),className:`w-full text-left p-2 rounded-md text-sm flex items-center gap-2 ${(u==null?void 0:u.name)===x.name?"bg-blue-800/80":"hover:bg-gray-700/50"}`,children:[t.jsxs("div",{className:"relative w-8 h-8 flex-shrink-0",children:[t.jsx("img",{src:Fu[x.grade],alt:x.grade,className:"absolute inset-0 w-full h-full object-cover rounded-sm"}),x.image&&t.jsx("img",{src:x.image,alt:x.name,className:"relative w-full h-full object-contain p-0.5"})]}),t.jsx("span",{className:`${o[x.grade].color} truncate`,children:x.name})]},x.name))})]})]}),t.jsx("div",{className:"bg-gray-900/50 rounded-lg flex flex-col items-center min-h-0 w-1/2 h-full p-2",children:u?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:`relative flex-shrink-0 ${s==="equipment"?"w-20 h-20 md:w-40 md:h-40":"w-24 h-24 md:w-40 md:h-40"}`,children:[t.jsx("img",{src:Fu[u.grade],alt:u.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),u.image&&t.jsx("img",{src:u.image,alt:u.name,className:"relative w-full h-full object-contain p-[15%]"})]}),t.jsx("h3",{className:`font-bold mt-2 md:mt-4 ${o[u.grade].color} text-center ${s==="equipment"?"text-lg md:text-2xl":"text-xl md:text-2xl"}`,children:u.name}),t.jsx("p",{className:"text-xs md:text-sm text-gray-400 text-center",children:u.type==="equipment"?`[${o[u.grade].name}] ${u.slot?a[u.slot]:""}`:s==="material"?"":""}),u.type==="equipment"&&t.jsx("p",{className:"text-[10px] md:text-xs text-gray-400 mt-1",children:`  : ${En[u.grade]}`}),t.jsxs("div",{className:"w-full flex-grow overflow-y-auto mt-2 pt-2 border-t border-gray-700 min-h-0 pr-2",children:[u.type==="equipment"&&v(),u.type!=="equipment"&&t.jsx("p",{className:"text-xs md:text-sm text-gray-300 py-1 text-center",children:u.description})]})]}):t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:t.jsx("p",{children:" ."})})})]})]})},bv=({info:e,onClose:n,isTopmost:s})=>{const{user:l,mode:r}=e,a=l.seasonHistory||{},i=Object.keys(a).sort((o,c)=>c.localeCompare(o));return t.jsx(be,{title:"  ",onClose:n,windowId:"past-rankings",initialWidth:450,isTopmost:s,children:t.jsxs("div",{className:"max-h-[calc(var(--vh,1vh)*60)] overflow-y-auto pr-2",children:[t.jsx("h3",{className:"text-lg font-bold text-center mb-4",children:r}),i.length>0?t.jsx("ul",{className:"space-y-2",children:i.map(o=>{var u;const c=(u=a[o])==null?void 0:u[r],d=At.find(p=>p.name===c);return t.jsxs("li",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg",children:[t.jsx("span",{className:"font-semibold text-gray-300",children:o}),c&&d?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:d.icon,alt:c,className:"w-8 h-8"}),t.jsx("span",{className:`font-bold ${d.color}`,children:c})]}):t.jsx("span",{className:"text-gray-500",children:" "})]},o)})}):t.jsx("p",{className:"text-center text-gray-500",children:"    ."})]})})},vv=({user:e,currentUser:n,onClose:s,onAction:l,isTopmost:r})=>{const a=Date.now(),i=e.chatBanUntil&&e.chatBanUntil>a,o=e.connectionBanUntil&&e.connectionBanUntil>a,c=i?Math.ceil((e.chatBanUntil-a)/1e3/60):0,d=o?Math.ceil((e.connectionBanUntil-a)/1e3/60):0,u=(b,g)=>{l({type:"ADMIN_APPLY_SANCTION",payload:{targetUserId:e.id,sanctionType:b,durationMinutes:g}})},p=b=>{l({type:"ADMIN_LIFT_SANCTION",payload:{targetUserId:e.id,sanctionType:b}})},m=f.useMemo(()=>{var b;return(b=Te.find(g=>g.id===e.avatarId))==null?void 0:b.url},[e.avatarId]),h=f.useMemo(()=>{var b;return(b=Re.find(g=>g.id===e.borderId))==null?void 0:b.url},[e.borderId]),y=[{label:"1",minutes:1},{label:"5",minutes:5},{label:"10",minutes:10},{label:"30",minutes:30},{label:"1",minutes:60}],v=[{label:"10",minutes:10},{label:"1",minutes:60},{label:"6",minutes:360},{label:"1",minutes:1440},{label:"3",minutes:4320},{label:"",minutes:999999}];return t.jsx(be,{title:` : ${e.nickname}`,onClose:s,windowId:`admin-mod-${e.id}`,isTopmost:r,children:t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsxs("div",{className:"flex items-center gap-4 bg-gray-900/50 p-3 rounded-lg",children:[t.jsx(Ce,{userId:e.id,userName:e.nickname,avatarUrl:m,borderUrl:h,size:64}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-bold",children:e.nickname}),t.jsxs("p",{className:"text-sm text-gray-400",children:["ID: ",e.username]})]})]}),t.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg space-y-3",children:[t.jsx("h4",{className:"font-bold text-lg border-b border-gray-600 pb-2",children:" "}),i?t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-red-400",children:["  (",c," )"]}),t.jsx(F,{onClick:()=>p("chat"),colorScheme:"yellow",className:"!text-xs !py-1",children:""})]}):t.jsx("div",{className:"grid grid-cols-5 gap-2",children:y.map(b=>t.jsx(F,{onClick:()=>u("chat",b.minutes),className:"!text-xs",children:b.label},b.minutes))})]}),t.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-lg space-y-3",children:[t.jsx("h4",{className:"font-bold text-lg border-b border-gray-600 pb-2",children:" "}),o?t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-red-400",children:["  (",d," )"]}),t.jsx(F,{onClick:()=>p("connection"),colorScheme:"yellow",className:"!text-xs !py-1",children:""})]}):t.jsx("div",{className:"grid grid-cols-3 gap-2",children:v.map(b=>t.jsx(F,{onClick:()=>u("connection",b.minutes),colorScheme:"orange",className:"!text-xs",children:b.label},b.minutes))})]})]})})},jv=({summary:e,onClose:n,isTopmost:s})=>{var i,o;const{reward:l,items:r,title:a}=e;return t.jsx(be,{title:a,onClose:n,windowId:"quest-reward-summary",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:" !"}),t.jsxs("div",{className:"space-y-3 bg-gray-900/50 p-4 rounded-lg text-lg",children:[(l.gold??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-yellow-300",children:["+",l.gold.toLocaleString()]})]}),(l.diamonds??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-cyan-300",children:["+",l.diamonds.toLocaleString()]})]}),(l.actionPoints??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold text-green-300",children:["+",l.actionPoints.toLocaleString()]})]}),((i=l.xp)==null?void 0:i.type)==="blacksmith"&&(((o=l.xp)==null?void 0:o.amount)??0)>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/equipments/moru.png",alt:" ",className:"w-5 h-5"}),"  :"]}),t.jsxs("span",{className:"font-bold text-orange-400",children:["+",l.xp.amount.toLocaleString()]})]})]}),r.length>0&&t.jsxs("div",{className:"mt-4 bg-gray-900/50 p-4 rounded-lg",children:[t.jsx("h3",{className:"font-semibold mb-2",children:" "}),t.jsx("div",{className:"grid grid-cols-4 gap-2",children:r.map((c,d)=>t.jsxs("div",{className:"flex flex-col items-center",title:c.name,children:[t.jsx("img",{src:c.image,alt:c.name,className:"w-12 h-12 object-contain"}),t.jsxs("span",{className:"text-xs",children:[c.name,c.quantity&&c.quantity>1?` x${c.quantity}`:""]})]},d))})]}),t.jsx(F,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},wv={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},Nv=["/images/equipments/Star1.png","/images/equipments/Star2.png","/images/equipments/Star3.png","/images/equipments/Star4.png"],kv=["/images/icon/Gold.png","/images/icon/Zem.png","/images/quest.png","/images/gibo.png","/images/mail.png","/images/store.png","/images/bag.png","/images/BlankEquipmentsSlot.png"],Rx=new Set,Mt=e=>{for(const n of e)n&&typeof n=="string"&&n.startsWith("/")&&Rx.add(n)};Mt(Object.values(La));Mt([Ml.neighborhood.image,Ml.national.image,Ml.world.image]);Mt(at.map(e=>e.image));Mt(St.map(e=>e.image));Mt(nl.map(e=>e.icon));Mt(Te.map(e=>e.url));Mt(Re.map(e=>e.url));Mt(At.map(e=>e.icon));Mt(vc.map(e=>e.image));Mt(vs.map(e=>e.image));Mt(Object.values(Zt).map(e=>e.image));Mt([Oa,Da,wc,Nc,yx,bx,vx,jx,wx]);Mt(Object.values(wv));Mt(Nv);Mt(kv);const Sv=Array.from(Rx),Cv=e=>{const n=e.map(s=>new Promise(l=>{const r=new Image;r.src=s,r.onload=l,r.onerror=a=>l(`Failed to load ${s}: ${a.toString()}`)}));return Promise.all(n)},Iv=({result:e,onClose:n,isTopmost:s})=>{const{gained:l,used:r,craftType:a}=e,i=a==="upgrade"?" ":" ",o=l[0],c=r[0],d=Zt[o.name],u=Zt[c.name];return t.jsx(be,{title:i,onClose:n,windowId:"crafting-result",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"   ."}),t.jsxs("div",{className:"flex items-center justify-around text-center mb-4 bg-gray-900/50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[(u==null?void 0:u.image)&&t.jsx("img",{src:u.image,alt:c.name,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:c.name}),t.jsxs("span",{className:"text-sm text-red-400 mt-1",children:["-",c.amount.toLocaleString(),""]})]}),t.jsx("div",{className:"text-4xl font-bold text-yellow-400 mx-4",children:""}),t.jsxs("div",{className:"flex flex-col items-center",children:[(d==null?void 0:d.image)&&t.jsx("img",{src:d.image,alt:o.name,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:o.name}),t.jsxs("span",{className:"text-sm text-green-400 mt-1",children:["+",o.amount.toLocaleString(),""]})]})]}),t.jsx(F,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})})},Ev=({value:e,min:n,max:s,step:l=1,onChange:r,disabled:a=!1})=>t.jsx("input",{type:"range",min:n,max:s,step:l,value:e,onChange:i=>r(Number(i.target.value)),disabled:a,className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer disabled:opacity-50"}),Pv=[{id:"black",name:"",colors:["#0f172a","#1e293b","#e2e8f0","#eab308"]},{id:"white",name:"",colors:["#f8fafc","#f1f5f9","#0f172a","#ca8a04"]},{id:"sky",name:"",colors:["#f0f9ff","#e0f2fe","#1e3a8a","#f97316"]},{id:"blue",name:" ",colors:["#eff6ff","#dbeafe","#1e40af","#3b82f6"]},{id:"green",name:" ",colors:["#f0fdf4","#dcfce7","#14532d","#d946ef"]}],Tv=({onClose:e,isTopmost:n})=>{const{settings:s,updateTheme:l,updateSoundSetting:r,updateFeatureSetting:a,updatePanelColor:i,updateTextColor:o,resetGraphicsToDefault:c}=De(),[d,u]=f.useState("graphics"),p=[{id:"graphics",label:""},{id:"sound",label:""},{id:"features",label:""}],m=[{key:"stone",label:"// "},{key:"notification",label:"/ "},{key:"item",label:"  "},{key:"countdown",label:"/ "},{key:"turn",label:"   "}],h=()=>{switch(d){case"graphics":return t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary",children:"UI "}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2",children:Pv.map(y=>t.jsxs("label",{className:"flex items-center p-3 bg-tertiary/50 rounded-lg cursor-pointer border-2 border-transparent has-[:checked]:border-accent has-[:checked]:ring-2 has-[:checked]:ring-accent",children:[t.jsx("input",{type:"radio",name:"theme",value:y.id,checked:s.graphics.theme===y.id,onChange:()=>l(y.id),className:"w-5 h-5 text-accent bg-secondary border-color focus:ring-accent"}),t.jsx("span",{className:"ml-3 text-text-primary",children:y.name}),t.jsx("div",{className:"ml-auto flex -space-x-2",children:y.colors.map((v,b)=>t.jsx("div",{style:{backgroundColor:v},className:"w-6 h-6 rounded-full border-2 border-primary"},b))})]},y.id))})]})});case"sound":return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-2",children:" "}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"w-12 text-center font-mono text-text-primary text-lg",children:(s.sound.masterVolume*10).toFixed(0)}),t.jsx(Ev,{min:0,max:1,step:.1,value:s.sound.masterVolume,onChange:y=>r("masterVolume",y),disabled:s.sound.masterMuted})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary",children:" "}),t.jsx(Ln,{checked:!s.sound.masterMuted,onChange:y=>r("masterMuted",!y)})]}),t.jsxs("div",{className:"space-y-3 pt-4 border-t border-color",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-2",children:"  "}),m.map(({key:y,label:v})=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:v}),t.jsx(Ln,{checked:!s.sound.categoryMuted[y],onChange:b=>r("categoryMuted",{...s.sound.categoryMuted,[y]:!b}),disabled:s.sound.masterMuted})]},y))]})]});case"features":return t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-4",children:" "}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"   []  "}),t.jsx(Ln,{checked:s.features.mobileConfirm,onChange:y=>a("mobileConfirm",y)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"  ( )"}),t.jsx(Ln,{checked:s.features.stonePreview,onChange:y=>a("stonePreview",y)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"   "}),t.jsx(Ln,{checked:s.features.lastMoveMarker,onChange:y=>a("lastMoveMarker",y)})]}),t.jsx("h3",{className:"text-lg font-semibold text-text-secondary mb-4 pt-4 border-t border-color",children:""}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"  "}),t.jsx(Ln,{checked:s.features.questNotifications,onChange:y=>a("questNotifications",y)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-text-secondary",children:"   ( )"}),t.jsx(Ln,{checked:s.features.chatNotifications,onChange:y=>a("chatNotifications",y)})]})]})}};return t.jsx(be,{title:"",onClose:e,windowId:"settings",initialWidth:600,isTopmost:n,children:t.jsxs("div",{className:"h-[calc(var(--vh,1vh)*60)] flex flex-col",children:[t.jsx("div",{className:"flex bg-tertiary/70 p-1 rounded-lg mb-4 flex-shrink-0",children:p.map(y=>t.jsx("button",{onClick:()=>u(y.id),className:`flex-1 py-2 text-sm font-semibold rounded-md transition-all ${d===y.id?"bg-accent":"text-tertiary hover:bg-secondary/50"}`,children:y.label},y.id))}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-2 p-2",children:h()}),t.jsx("div",{className:"flex justify-end gap-4 mt-4 pt-4 border-t border-color flex-shrink-0",children:t.jsx(F,{onClick:e,colorScheme:"gray",children:""})})]})})},Gu=({summary:e,onClose:n,isTopmost:s})=>t.jsx(be,{title:"  ",onClose:n,windowId:"claim-all-summary",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"text-center",children:[t.jsx("h2",{className:"text-xl font-bold mb-4",children:"   !"}),t.jsxs("div",{className:"space-y-3 bg-gray-900/50 p-4 rounded-lg text-lg",children:[e.gold>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Gold.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-yellow-300",children:["+",e.gold.toLocaleString()]})]}),e.diamonds>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/icon/Zem.png",alt:"",className:"w-5 h-5"})," :"]}),t.jsxs("span",{className:"font-bold text-cyan-300",children:["+",e.diamonds.toLocaleString()]})]}),e.actionPoints>0&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{children:" :"}),t.jsxs("span",{className:"font-bold text-green-300",children:["+",e.actionPoints.toLocaleString()]})]})]}),t.jsx(F,{onClick:n,className:"w-full mt-6 py-2.5",children:""})]})}),Mv={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},_v=e=>{if(e===0)return null;let n="",s="";return e>=10?(n="/images/equipments/Star4.png",s="prism-text-effect"):e>=7?(n="/images/equipments/Star3.png",s="text-purple-400"):e>=4?(n="/images/equipments/Star2.png",s="text-amber-400"):e>=1&&(n="/images/equipments/Star1.png",s="text-white"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:`font-bold text-xs leading-none ${s}`,children:e})]})},Av=({item:e})=>{var i,o,c,d;const{currentUserWithStatus:n}=De(),s=Mv[e.grade],l=En[e.grade],a=((n==null?void 0:n.strategyLevel)||0)+((n==null?void 0:n.playfulLevel)||0)>=l;return t.jsxs("div",{className:"flex flex-col w-full h-full p-1",children:[t.jsxs("div",{className:"flex mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0 mr-3",children:[t.jsx("img",{src:s.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),_v(e.stars)]}),t.jsxs("div",{className:"flex-grow overflow-hidden pt-2",children:[t.jsx("h3",{className:`text-lg font-bold truncate ${s.color}`,children:e.name}),t.jsxs("p",{className:`text-xs ${a?"text-gray-500":"text-red-500"}`,children:["(: ",l,")"]}),((i=e.options)==null?void 0:i.main)&&t.jsx("p",{className:"font-semibold text-yellow-300 text-sm truncate",children:e.options.main.display})]})]}),t.jsxs("div",{className:"w-full text-sm text-left space-y-1 bg-black/30 p-2 rounded-lg flex-grow overflow-y-auto",children:[((o=e.options)==null?void 0:o.combatSubs)&&e.options.combatSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.combatSubs.map((u,p)=>t.jsx("p",{className:"text-blue-300",children:u.display},`c-${p}`))}),((c=e.options)==null?void 0:c.specialSubs)&&e.options.specialSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.specialSubs.map((u,p)=>t.jsx("p",{className:"text-green-300",children:u.display},`s-${p}`))}),((d=e.options)==null?void 0:d.mythicSubs)&&e.options.mythicSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.mythicSubs.map((u,p)=>t.jsx("p",{className:"text-red-400",children:u.display},`m-${p}`))})]})]})},ba=e=>e>=10?{text:`(${e})`,colorClass:"prism-text-effect"}:e>=7?{text:`(${e})`,colorClass:"text-purple-400"}:e>=4?{text:`(${e})`,colorClass:"text-amber-400"}:e>=1?{text:`(${e})`,colorClass:"text-white"}:{text:"",colorClass:"text-white"},Rv=({outcome:e,onConfirm:n})=>{if(!e)return null;const{success:s,message:l,itemBefore:r,itemAfter:a}=e,i=f.useMemo(()=>{if(!s||!r.options||!a.options)return null;if(a.options.combatSubs.length>r.options.combatSubs.length){const d=a.options.combatSubs.find(u=>!r.options.combatSubs.some(p=>p.type===u.type&&p.isPercentage===u.isPercentage));return d?{type:"new",option:d}:null}for(const d of a.options.combatSubs){const u=r.options.combatSubs.find(p=>p.type===d.type&&p.isPercentage===d.isPercentage);if(!u||u.value!==d.value)return{type:"upgraded",before:u,after:d}}return null},[s,r,a]),o=ba(r.stars),c=ba(a.stars);return t.jsxs("div",{className:"absolute inset-0 bg-gray-900/80 rounded-lg flex flex-col items-center justify-center z-20 animate-fade-in p-4",children:[t.jsx("div",{className:`text-6xl mb-4 ${s?"animate-bounce":""}`,children:s?"":""}),t.jsx("h2",{className:`text-3xl font-bold ${s?"text-green-400":"text-red-400"}`,children:s?" !":" ..."}),t.jsx("p",{className:"text-gray-300 mt-2 text-center",children:l}),s&&t.jsxs("div",{className:"bg-gray-800/50 p-3 rounded-lg mt-4 w-full max-w-sm text-xs space-y-1",children:[t.jsx("h4",{className:"font-bold text-center text-yellow-300 mb-2",children:" "}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"}),t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("span",{className:o.colorClass,children:o.text||"()"}),"",t.jsx("span",{className:c.colorClass,children:c.text})]})]}),r.options&&a.options&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:":"})," ",t.jsxs("span",{className:"truncate",children:[r.options.main.display,"  ",a.options.main.display]})]}),(i==null?void 0:i.type)==="new"&&i.option&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsx("span",{className:"truncate",children:i.option.display})]}),(i==null?void 0:i.type)==="upgraded"&&i.before&&t.jsxs("div",{className:"flex justify-between text-green-300",children:[t.jsx("span",{children:" :"})," ",t.jsxs("span",{className:"truncate",children:[i.before.display,"  ",i.after.display]})]})]}),t.jsx(F,{onClick:n,colorScheme:"green",className:"mt-6 w-full max-w-sm",children:""})]})},Bv=({selectedItem:e,currentUser:n,onAction:s,enhancementOutcome:l,onOutcomeConfirm:r})=>{const[a,i]=f.useState(!1),o=f.useMemo(()=>{var C;return e?(C=ha[e.grade])==null?void 0:C[e.stars]:null},[e]),c=n?n.strategyLevel+n.playfulLevel:0,d=f.useMemo(()=>{if(!e)return 0;const C=e.stars+1;return C===4?3:C===7?8:C===10?15:0},[e]),u=c>=d,p=f.useMemo(()=>{if(!n)return{};const C={};for(const S of Object.keys(Zt))C[S]=n.inventory.filter(P=>P.name===S).reduce((P,_)=>P+(_.quantity||0),0);return C},[n]),m=f.useMemo(()=>!e||!o||d>0&&!u?!1:o.every(C=>p[C.name]>=C.amount),[o,p,d,u,e]),{mainOptionPreview:h,subOptionPreview:y}=f.useMemo(()=>{if(!e)return{mainOptionPreview:"",subOptionPreview:""};if(!e.options||e.stars>=10)return{mainOptionPreview:" ",subOptionPreview:""};const{main:C,combatSubs:S}=e.options,P=C.baseValue;if(!P)return{mainOptionPreview:"N/A",subOptionPreview:"N/A"};let _=1;[3,6,9].includes(e.stars)&&(_=2);const I=P*_,T=C.value+I,B=`${C.type} +${C.value.toFixed(2).replace(/\.00$/,"")}${C.isPercentage?"%":""}`,R=`+${T.toFixed(2).replace(/\.00$/,"")}${C.isPercentage?"%":""}`,A=`${B}  ${R}`,L=S.length<4?"   1 ":"   1 ";return{mainOptionPreview:A,subOptionPreview:L}},[e]),v=f.useMemo(()=>e?ba(e.stars):{text:"",colorClass:"text-white"},[e]),b=f.useMemo(()=>!e||e.stars>=10?null:ba(e.stars+1),[e]),g=f.useMemo(()=>e?a?" ...":e.stars>=10?" ":d>0&&!u?`  ( ${d} )`:o?m?` (+${e.stars+1})`:" ":"  ":"  .",[a,e,d,u,o,m]);if(f.useEffect(()=>{i(!1)},[e]),!e)return t.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:t.jsx("p",{children:"  ."})});const x=Xh[e.stars],j=Zh[e.grade]||.5,w=(e.enhancementFails||0)*j,k=()=>{!m||a||(i(!0),s({type:"ENHANCE_ITEM",payload:{itemId:e.id}}))};return t.jsxs("div",{className:"relative h-full",children:[t.jsx(Rv,{outcome:l,onConfirm:r}),t.jsxs("div",{className:"flex flex-row gap-6 h-full",children:[t.jsx("div",{className:"w-1/2 flex flex-col bg-gray-900/40 p-2 rounded-lg h-full",children:t.jsx(Av,{item:e})}),t.jsxs("div",{className:"w-1/2 space-y-3 flex flex-col",children:[t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-center mb-2 text-green-300",children:"  "}),t.jsxs("div",{className:"space-y-1 text-xs sm:text-sm text-left",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsxs("div",{className:"font-mono text-white flex items-center gap-2",children:[t.jsx("span",{className:v.colorClass,children:v.text||"(0)"}),"",b?t.jsx("span",{className:b.colorClass,children:b.text}):"-"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsx("span",{className:"font-mono text-white",children:h})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsx("span",{className:"font-mono text-white",children:e.stars<10?y:""})]})]})]}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:" "}),t.jsx("div",{className:"space-y-1 text-sm",children:o==null?void 0:o.map(C=>{const S=p[C.name]||0,P=S>=C.amount;return t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("img",{src:Zt[C.name].image,alt:C.name,className:"w-6 h-6"}),C.name]}),t.jsxs("span",{className:`font-mono ${P?"text-green-400":"text-red-400"}`,children:[S.toLocaleString()," / ",C.amount.toLocaleString()]})]},C.name)})})]}),t.jsxs("div",{className:"bg-gray-900/50 p-3 rounded-lg text-center flex-grow flex flex-col justify-center",children:[t.jsx("h4",{className:"font-semibold mb-1",children:"  "}),t.jsxs("p",{className:"text-3xl font-bold text-yellow-300",children:[x,"%",w>0&&t.jsxs("span",{className:"text-xl text-green-400 ml-2",children:["(+",w.toFixed(1).replace(/\.0$/,""),"%)"]})]})]}),t.jsx(F,{onClick:k,disabled:!m||a||e.stars>=10,colorScheme:"yellow",className:"w-full py-3 mt-auto",children:g})]})]})]})},Lv={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},Wu=["fan","board","top","bottom","bowl","stones"],Bx={fan:"",board:"",top:"",bottom:"",bowl:"",stones:""},$v=({item:e,onRemove:n})=>{if(!e)return t.jsx("div",{className:"w-1/3 h-32 border-2 border-dashed border-gray-500 rounded-lg flex items-center justify-center bg-black/20",children:t.jsx("span",{className:"text-gray-400",children:""})});const s=Lv[e.grade];return t.jsxs("div",{className:"w-1/3 h-32 rounded-lg bg-black/20 p-2 flex flex-col items-center justify-center text-center relative",children:[t.jsx("button",{onClick:n,className:"absolute top-1 right-1 text-red-500 hover:text-red-400 z-10",children:""}),t.jsxs("div",{className:"relative w-16 h-16 rounded-lg flex-shrink-0",children:[t.jsx("img",{src:s.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"})]}),t.jsx("p",{className:`text-sm font-bold ${s.color} truncate w-full`,children:e.name}),t.jsx("p",{className:"text-xs text-gray-400",children:Bx[e.slot]||""})]})},Ov=({items:e,isRandom:n})=>{const s=f.useMemo(()=>{const l=e.filter(a=>a!==null);if(l.length!==3)return[];const r=new Map;if(n){const a=1/Wu.length;for(const i of Wu)r.set(i,a)}else{const a=new Map;for(const i of l)i.slot&&a.set(i.slot,(a.get(i.slot)||0)+1);for(const[i,o]of a.entries())r.set(i,o/3)}return Array.from(r.entries()).sort((a,i)=>i[1]-a[1])},[e,n]);return s.length===0?null:t.jsxs("div",{className:"w-full bg-black/20 p-3 rounded-lg mt-4",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:"  "}),t.jsx("div",{className:"grid grid-cols-3 gap-x-4 gap-y-1 text-sm",children:s.map(([l,r])=>t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-gray-400",children:[Bx[l],":"]}),t.jsxs("span",{className:"font-bold text-white",children:[(r*100).toFixed(1),"%"]})]},l))})]})},Dv=({items:e,currentUser:n})=>{const{blacksmithLevel:s}=n,l=f.useMemo(()=>{var d;const r=e.filter(u=>u!==null);if(r.length!==3||new Set(r.map(u=>u.grade)).size!==1)return null;const a=r[0].grade,i=(s??1)-1,o=((d=Ql[i])==null?void 0:d[a])??0;return{successRate:100-o,greatSuccessRate:o}},[e,s]);return l?t.jsxs("div",{className:"w-full bg-black/20 p-3 rounded-lg mt-2",children:[t.jsx("h4",{className:"font-semibold text-center mb-2",children:"  "}),t.jsxs("div",{className:"grid grid-cols-2 gap-x-4 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:":"}),t.jsxs("span",{className:"font-bold text-white",children:[l.successRate.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-yellow-400",children:":"}),t.jsxs("span",{className:"font-bold text-yellow-300",children:[l.greatSuccessRate.toFixed(1),"%"]})]})]})]}):null},qv=({items:e,onRemoveItem:n,onAction:s,currentUser:l})=>{const[r,a]=f.useState(!1),i=()=>{const c=e.map(d=>d==null?void 0:d.id).filter(d=>!!d);c.length===3&&s({type:"COMBINE_ITEMS",payload:{itemIds:c,isRandom:r}})},o=e.every(c=>c!==null)&&new Set(e.map(c=>c==null?void 0:c.grade)).size===1;return t.jsxs("div",{className:"h-full flex flex-col items-center justify-between",children:[t.jsx("div",{className:"w-full flex justify-around items-stretch gap-2",children:e.map((c,d)=>t.jsx($v,{item:c,onRemove:()=>n(d)},d))}),t.jsxs("div",{className:"w-full",children:[t.jsx(Ov,{items:e,isRandom:r}),t.jsx(Dv,{items:e,currentUser:l})]}),t.jsxs("div",{className:"w-full space-y-4 mt-4",children:[t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("input",{type:"checkbox",id:"random-combine",checked:r,onChange:c=>a(c.target.checked),className:"h-4 w-4 rounded text-accent bg-gray-700 border-gray-600 focus:ring-accent"}),t.jsx("label",{htmlFor:"random-combine",className:"ml-2 text-sm text-gray-300",children:"   "})]}),t.jsx(F,{onClick:i,disabled:!o,colorScheme:"blue",className:"w-full",children:""})]})]})},Uv=e=>{if(e.type==="equipment"){const n=e0[e.grade]||0,s=Math.pow(1.2,e.stars);return Math.floor(n*s)}return 0},zv=({selectedIds:e,inventory:n})=>{const{totalMaterials:s,totalSellPrice:l,itemCount:r}=f.useMemo(()=>{var c;const a=n.filter(d=>e.has(d.id)),i={};let o=0;for(const d of a){o+=Uv(d);const u=Math.min(d.stars,9),p=(c=ha[d.grade])==null?void 0:c[u];if(p)for(const m of p){const h=Math.floor(m.amount*.25);h>0&&(i[m.name]=(i[m.name]||0)+h)}}return{totalMaterials:Object.entries(i).map(([d,u])=>({name:d,amount:u})),totalSellPrice:o,itemCount:a.length}},[e,n]);return t.jsxs("div",{className:"w-full h-full bg-secondary/50 rounded-lg p-4 flex flex-col text-center",children:[t.jsx("h3",{className:"font-bold text-lg text-tertiary mb-2",children:" "}),t.jsxs("p",{className:"text-sm text-tertiary mb-4",children:[" : ",r,""]}),t.jsxs("div",{className:"flex-grow w-full bg-tertiary/30 p-3 rounded-md overflow-y-auto space-y-2",children:[t.jsx("h4",{className:"font-semibold text-highlight text-left border-b border-color pb-1",children:"  "}),s.length>0?s.map(({name:a,amount:i})=>{const o=Zt[a];return t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[(o==null?void 0:o.image)&&t.jsx("img",{src:o.image,alt:a,className:"w-6 h-6"}),a]}),t.jsxs("span",{className:"font-mono text-primary",children:["x ",i.toLocaleString()]})]},a)}):t.jsx("p",{className:"text-sm text-tertiary pt-4",children:"  ."}),t.jsx("p",{className:"text-xs text-cyan-300 text-center pt-4",children:"  30%  ''     2 !"})]}),t.jsx("div",{className:"mt-4 text-sm text-tertiary",children:t.jsxs("p",{children:["   : ",t.jsxs("span",{className:"font-bold text-yellow-300",children:[l.toLocaleString()," "]})]})})]})},Fv=["normal","uncommon","rare","epic","legendary"],Gv={normal:"",uncommon:"",rare:"",epic:"",legendary:"",mythic:""},Wv=({onClose:e,onConfirm:n})=>{const[s,l]=f.useState([]),r=i=>{l(o=>o.includes(i)?o.filter(c=>c!==i):[...o,i])},a=()=>{n(s),e()};return t.jsx(be,{title:"  ",onClose:e,windowId:"disassembly-auto-select",initialWidth:400,isTopmost:!0,children:t.jsxs("div",{className:"text-on-panel",children:[t.jsx("p",{className:"text-sm text-tertiary mb-4 text-center",children:"   .   ."}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:Fv.map(i=>t.jsxs("label",{className:"flex items-center gap-3 p-3 bg-tertiary/50 rounded-lg cursor-pointer border-2 border-transparent has-[:checked]:border-accent",children:[t.jsx("input",{type:"checkbox",checked:s.includes(i),onChange:()=>r(i),className:"w-5 h-5 text-accent bg-secondary border-color rounded focus:ring-accent"}),t.jsx("span",{className:"font-semibold",children:Gv[i]})]},i))}),t.jsxs("div",{className:"flex justify-end gap-4 mt-6 pt-4 border-t border-color",children:[t.jsx(F,{onClick:e,colorScheme:"gray",children:""}),t.jsx(F,{onClick:a,colorScheme:"blue",children:" "})]})]})})},Hv=({onAction:e,selectedForDisassembly:n=new Set,onToggleDisassemblySelection:s})=>{const{currentUserWithStatus:l}=De(),[r,a]=f.useState(!1);if(!l)return null;const{inventory:i}=l,o=()=>{n.size===0||Array.from(n).some(u=>{const p=i.find(m=>m.id===u);return p&&(p.grade==="legendary"||p.grade==="mythic")})&&!window.confirm("    .  ?")||window.confirm(`${n.size}  ?`)&&e({type:"DISASSEMBLE_ITEM",payload:{itemIds:Array.from(n)}})},c=d=>{i.filter(p=>p.type==="equipment"&&!p.isEquipped&&d.includes(p.grade)).map(p=>p.id).forEach(p=>s(p)),a(!1)};return t.jsxs("div",{className:"h-full flex flex-col",children:[r&&t.jsx(Wv,{onClose:()=>a(!1),onConfirm:c}),t.jsx("div",{className:"flex-grow",children:t.jsx(zv,{selectedIds:n,inventory:i})}),t.jsxs("div",{className:"flex-shrink-0 border-t border-color py-3 px-2 my-2 flex flex-wrap justify-center items-center gap-2",children:[t.jsx(F,{onClick:()=>a(!0),colorScheme:"blue",children:" "}),t.jsxs(F,{onClick:o,colorScheme:"red",disabled:n.size===0,children:["   (",n.size,")"]})]})]})},Vv=({details:e,inventory:n,onClose:s,onAction:l})=>{const{materialName:r,craftType:a}=e,i=a==="upgrade",o=[" "," "," "," "," "],c=o.indexOf(r),d=r,u=i?o[c+1]:o[c-1],p=Zt[d],m=Zt[u],h=i?10:1,y=i?1:5,v=f.useMemo(()=>n.filter(k=>k.name===d).reduce((k,C)=>k+(C.quantity||0),0),[n,d]),b=Math.floor(v/h),[g,x]=f.useState(b>0?1:0),j=k=>{const C=parseInt(k.target.value,10);isNaN(C)?x(0):x(Math.max(0,Math.min(b,C)))},w=()=>{g>0&&l({type:"CRAFT_MATERIAL",payload:{materialName:r,craftType:a,quantity:g}}),s()};return t.jsx("div",{className:"absolute inset-0 bg-black/80 z-50 flex items-center justify-center",onClick:s,children:t.jsxs("div",{className:"bg-panel rounded-lg shadow-xl p-6 w-full max-w-md border border-color text-on-panel",onClick:k=>k.stopPropagation(),children:[t.jsx("h2",{className:"text-xl font-bold text-center mb-4",children:i?" ":" "}),t.jsxs("div",{className:"flex items-center justify-around text-center mb-4",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("img",{src:p.image,alt:d,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:d}),t.jsxs("span",{className:"text-xs text-tertiary mt-1",children:[": ",v.toLocaleString(),""]})]}),t.jsx("div",{className:"text-4xl font-bold text-highlight mx-4",children:""}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("img",{src:m.image,alt:u,className:"w-16 h-16"}),t.jsx("span",{className:"font-semibold",children:u}),t.jsxs("span",{className:"text-sm text-green-400 mt-1",children:[": ",(g*y).toLocaleString(),""]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{htmlFor:"quantity-slider",className:"block text-sm font-medium text-secondary text-center",children:[i?"":""," ",d,": ",t.jsxs("span",{className:"font-bold text-highlight",children:[(g*h).toLocaleString()," / ",v.toLocaleString()]}),""]}),t.jsx("input",{id:"quantity-slider",type:"range",min:"0",max:b,value:g,onChange:j,disabled:b===0,className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer"}),t.jsxs("div",{className:"flex justify-between text-xs text-tertiary",children:[t.jsx("span",{children:"0"}),t.jsxs("span",{children:[b,""]})]}),t.jsxs("p",{className:"text-center text-sm text-tertiary",children:[i?"":""," : ",g.toLocaleString(),""]})]}),t.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[t.jsx(F,{onClick:s,colorScheme:"gray",children:""}),t.jsxs(F,{onClick:w,colorScheme:i?"blue":"orange",disabled:g===0,children:[g," ",i?"":""]})]})]})})},Kv=({onAction:e})=>{const{currentUserWithStatus:n}=De(),[s,l]=f.useState(null);if(!n)return null;const{inventory:r}=n,a=f.useMemo(()=>{const o={};return r.filter(c=>c.type==="material").forEach(c=>{o[c.name]||(o[c.name]=[]),o[c.name].push(c)}),o},[r]),i=[" "," "," "," "," "];return t.jsxs("div",{className:"h-full flex flex-col",children:[s&&t.jsx(Vv,{details:s,inventory:r,onClose:()=>l(null),onAction:e}),t.jsxs("div",{className:"flex-grow p-4 overflow-y-auto",children:[t.jsx("h3",{className:"text-xl font-bold text-on-panel mb-4",children:" "}),t.jsx("p",{className:"text-sm text-tertiary mb-4",children:"         ."}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map((o,c)=>{const d=a[o]&&a[o].length>0,u=a[o]?a[o].reduce((y,v)=>y+(v.quantity||0),0):0,p=c<i.length-1,m=c>0,h=Zt[o];return t.jsxs("div",{className:"bg-panel-secondary rounded-lg p-4 flex items-center space-x-4",children:[t.jsx("img",{src:h.image,alt:o,className:"w-16 h-16 flex-shrink-0"}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("h4",{className:"font-bold text-secondary text-lg",children:o}),t.jsxs("p",{className:"text-sm text-tertiary",children:[": ",u.toLocaleString(),""]})]}),t.jsxs("div",{className:"flex flex-col space-y-2",children:[p&&t.jsx(F,{onClick:()=>l({materialName:o,craftType:"upgrade"}),colorScheme:"blue",className:"!text-xs !py-1 w-20",disabled:!d||u<10,children:""}),m&&t.jsx(F,{onClick:()=>l({materialName:o,craftType:"downgrade"}),colorScheme:"purple",className:"!text-xs !py-1 w-20",disabled:!d||u<1,children:""})]})]},o)})})]})]})},Qv={normal:"/images/equipments/normalbgi.png",uncommon:"/images/equipments/uncommonbgi.png",rare:"/images/equipments/rarebgi.png",epic:"/images/equipments/epicbgi.png",legendary:"/images/equipments/legendarybgi.png",mythic:"/images/equipments/mythicbgi.png"},Jv=e=>{if(e===0)return null;let n="",s="";return e>=10?(n="/images/equipments/Star4.png",s="prism-text-effect"):e>=7?(n="/images/equipments/Star3.png",s="text-purple-400"):e>=4?(n="/images/equipments/Star2.png",s="text-amber-400"):e>=1&&(n="/images/equipments/Star1.png",s="text-white"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:`font-bold text-xs leading-none ${s}`,children:e})]})},Yv=({inventory:e,inventorySlots:n,onSelectItem:s,selectedItemId:l,disabledItemIds:r=[],selectedItemIdsForDisassembly:a,onToggleDisassemblySelection:i})=>{const o=Array.from({length:n},(c,d)=>e[d]||null);return t.jsx("div",{className:"grid grid-cols-10 gap-1 flex-grow pr-2 bg-tertiary/30 p-2 rounded-md",children:o.map((c,d)=>{const u=c?r.includes(c.id):!1;return t.jsx("div",{onClick:()=>{!c||u||(a&&i?i(c.id):s(c))},className:`relative aspect-square rounded-md transition-all duration-200 ${c?"hover:scale-105":"bg-tertiary/50"} ${u?"filter grayscale opacity-50 pointer-events-none":"cursor-pointer"}`,children:c?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`absolute inset-0 rounded-md border-2 ${l===c.id?"border-accent ring-2 ring-accent":"border-black/20"} ${a!=null&&a.has(c.id)?"bg-gray-700/70":""}`}),t.jsx("img",{src:Qv[c.grade],alt:c.grade,className:"absolute inset-0 w-full h-full object-cover rounded-sm"}),c.image&&t.jsx("img",{src:c.image,alt:c.name,className:"relative w-full h-full object-contain p-1"}),Jv(c.stars),c.isEquipped&&t.jsx("div",{className:"absolute top-0.5 right-0.5 text-xs font-bold text-white bg-blue-600/80 px-1 rounded-bl-md",children:"E"}),c.quantity&&c.quantity>1&&t.jsx("span",{className:"absolute bottom-0 right-0 text-xs font-bold text-white bg-black/60 px-1 rounded-tl-md",children:c.quantity}),(a==null?void 0:a.has(c.id))&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-800/70 rounded-md",children:t.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})})]}):t.jsx("div",{className:"bg-tertiary/50 w-full h-full rounded-md"})},c?c.id:`empty-${d}`)})})},Ii=["normal","uncommon","rare","epic","legendary","mythic"],Xv=({onClose:e,isTopmost:n,selectedItemForEnhancement:s,activeTab:l,onSetActiveTab:r,enhancementOutcome:a})=>{const{currentUserWithStatus:i,handlers:o,modals:c}=De(),[d,u]=f.useState(s),[p,m]=f.useState([null,null,null]),[h,y]=f.useState(new Set);if(!i)return null;f.useEffect(()=>{s&&(u(s),r("enhance"))},[s,r]),f.useEffect(()=>{m([null,null,null])},[l]),f.useEffect(()=>{l==="combine"&&m(O=>O.map(G=>G&&i.inventory.find(z=>z.id===G.id)||null))},[i.inventory,l]);const v=f.useCallback(O=>{if(l==="combine"){const U=p.findIndex(G=>G===null);if(U!==-1){const G=[...p];G[U]=O,m(G)}}else u(O)},[l,p]),b=f.useCallback(O=>{y(U=>{const G=new Set(U);return G.has(O)?G.delete(O):G.add(O),G})},[]),{blacksmithLevel:g,blacksmithXp:x,inventory:j,inventorySlots:w}=i,k={normal:"",uncommon:"",rare:"",epic:"",legendary:"",mythic:""},C=g??1,S=C>=jc,P=C-1,_=S?P:C,I=Tl[P],T=Ii.indexOf(I),B=f.useMemo(()=>{var G;if(l!=="combine")return[];const O=(G=p[0])==null?void 0:G.grade,U=p.map(z=>z==null?void 0:z.id).filter(Boolean);return j.filter(z=>!!(U.includes(z.id)||z.isEquipped||Ii.indexOf(z.grade)>T||O&&z.grade!==O)).map(z=>z.id)},[l,j,p,T]),R=[{id:"enhance",label:" "},{id:"combine",label:" "},{id:"disassemble",label:" "},{id:"convert",label:" "}],A=()=>{switch(l){case"enhance":return t.jsx(Bv,{selectedItem:d,currentUser:i,onAction:o.handleAction,enhancementOutcome:a,onOutcomeConfirm:o.clearEnhancementOutcome});case"combine":return t.jsx(qv,{items:p,onRemoveItem:O=>{const U=[...p];U[O]=null,m(U)},onAction:o.handleAction,currentUser:i});case"disassemble":return t.jsx(Hv,{onAction:o.handleAction,selectedForDisassembly:h,onToggleDisassemblySelection:b});case"convert":return t.jsx(Kv,{onAction:o.handleAction});default:return null}},L=f.useMemo(()=>l==="enhance"||l==="combine"||l==="disassemble"?j.filter(O=>O.type==="equipment"):l==="convert"?j.filter(O=>O.type==="material"):j,[j,l]),Q=(()=>{const O=w||{};return l==="enhance"||l==="combine"||l==="disassemble"?O.equipment||30:l==="convert"&&O.material||30})(),q=f.useMemo(()=>l==="enhance"||l==="combine"||l==="disassemble"?"":l==="convert"?"":"",[l]);return t.jsxs(t.Fragment,{children:[t.jsx(be,{title:"",onClose:e,isTopmost:n&&!c.isBlacksmithHelpOpen,initialWidth:950,windowId:"blacksmith",children:t.jsxs("div",{className:"flex h-[700px]",children:[t.jsxs("div",{className:"w-1/3 bg-tertiary/30 p-4 flex flex-col items-center gap-4",children:[t.jsxs("div",{className:"w-full aspect-w-3 aspect-h-2 prism-border rounded-lg overflow-hidden relative",children:[t.jsx("img",{src:"/images/equipments/moru.png",alt:"Blacksmith",className:"w-full h-full object-cover"}),t.jsx("button",{onClick:o.openBlacksmithHelp,className:"absolute top-2 right-2 text-lg font-bold text-yellow-400 hover:text-yellow-300 bg-black/50 rounded-full w-8 h-8 flex items-center justify-center",children:"?"})]}),t.jsx("div",{className:"text-center",children:t.jsxs("h2",{className:"text-2xl font-bold",children:[" ",t.jsxs("span",{className:"text-yellow-400",children:["Lv.",g??1]})]})}),t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[t.jsx("span",{children:""}),t.jsxs("span",{children:[x??0," / ",su(g??1)]})]}),t.jsx("div",{className:"w-full bg-black/50 rounded-full h-4 border-2 border-color",children:t.jsx("div",{className:"bg-yellow-500 h-full rounded-full",style:{width:`${(x??0)/su(g??1)*100}%`}})})]}),t.jsxs("div",{className:"w-full text-left",children:[t.jsx("h3",{className:"font-bold mb-2 text-center",children:" "}),t.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400 px-2 pb-1 border-b border-gray-600 mb-1",children:[t.jsx("span",{children:""}),t.jsxs("span",{children:["Lv.",C,!S&&t.jsxs("span",{className:"text-yellow-400",children:["  Lv.",C+1]})]})]}),t.jsxs("div",{className:"text-xs text-secondary space-y-2",children:[t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[k[Tl[P]],!S&&t.jsxs("span",{className:"text-yellow-400",children:["  ",k[Tl[_]]]})]})]})}),t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[ya[P],"%",!S&&t.jsxs("span",{className:"text-yellow-400",children:["  ",ya[_],"%"]})]})]})}),t.jsxs("div",{className:"bg-black/20 p-2 rounded-md",children:[t.jsx("p",{className:"font-semibold",children:"  :"}),Ii.map(O=>{var z,H;const U=((z=Ql[P])==null?void 0:z[O])??0,G=(H=Ql[_])==null?void 0:H[O];return t.jsxs("div",{className:"flex justify-between pl-2",children:[t.jsx("span",{children:k[O]}),t.jsxs("span",{children:[U,"%",!S&&G!==void 0&&t.jsxs("span",{className:"text-yellow-400",children:["  ",G,"%"]})]})]},O)})]})]})]})]}),t.jsxs("div",{className:"w-2/3 bg-primary p-4 flex flex-col",children:[t.jsx("div",{className:"flex border-b border-color mb-4",children:R.map(O=>t.jsx("button",{onClick:()=>r(O.id),className:`px-4 py-2 text-sm font-semibold ${l===O.id?"border-b-2 border-accent text-accent":"text-secondary hover:bg-secondary/20"}`,children:O.label},O.id))}),t.jsx("div",{className:"p-4 bg-tertiary/20 rounded-lg flex-1",children:A()}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h3",{className:"text-lg font-bold text-on-panel mb-2",children:q}),t.jsx("div",{className:"h-[140px] overflow-y-auto pr-1",children:t.jsx(Yv,{inventory:L,inventorySlots:Q,onSelectItem:v,selectedItemId:(d==null?void 0:d.id)||null,disabledItemIds:B,selectedItemIdsForDisassembly:l==="disassemble"?h:void 0,onToggleDisassemblySelection:l==="disassemble"?b:void 0})})]})]})]})}),t.jsx(Ax,{isOpen:!!c.disassemblyResult,onClose:o.closeDisassemblyResult,result:c.disassemblyResult})]})},Ei={normal:"",uncommon:"",rare:"",epic:"",legendary:"",mythic:""},Zv=["normal","uncommon","rare","epic","legendary","mythic"],ej=({onClose:e,currentUser:n})=>{const{blacksmithLevel:s}=n,l=s??1,r=l>=jc,a=l-1,i=r?a:l,o=()=>t.jsxs("div",{className:"w-full text-left",children:[t.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-400 px-2 pb-1 border-b border-gray-600 mb-1",children:[t.jsx("span",{children:""}),t.jsxs("span",{children:["Lv.",l,!r&&t.jsxs("span",{className:"text-yellow-400",children:["  Lv.",l+1]})]})]}),t.jsxs("div",{className:"text-xs text-secondary space-y-2",children:[t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[Ei[Tl[a]],!r&&t.jsxs("span",{className:"text-yellow-400",children:["  ",Ei[Tl[i]]]})]})]})}),t.jsx("div",{className:"bg-black/20 p-2 rounded-md",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"  "}),t.jsxs("span",{children:[ya[a],"%",!r&&t.jsxs("span",{className:"text-yellow-400",children:["  ",ya[i],"%"]})]})]})}),t.jsxs("div",{className:"bg-black/20 p-2 rounded-md",children:[t.jsx("p",{className:"font-semibold",children:"  :"}),Zv.map(c=>{var p,m;const d=((p=Ql[a])==null?void 0:p[c])??0,u=(m=Ql[i])==null?void 0:m[c];return t.jsxs("div",{className:"flex justify-between pl-2",children:[t.jsx("span",{children:Ei[c]}),t.jsxs("span",{children:[d,"%",!r&&u!==void 0&&t.jsxs("span",{className:"text-yellow-400",children:["  ",u,"%"]})]})]},c)})]})]})]});return t.jsx(be,{title:" ",onClose:e,windowId:"blacksmith-help",initialWidth:500,zIndex:60,children:t.jsxs("div",{className:"space-y-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-accent mb-2",children:" "}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-gray-300",children:[t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"    () .    ,     ."]}),t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"    3    .        ''   ."]}),t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"      ."]}),t.jsxs("li",{children:[t.jsx("strong",{children:" :"}),"       ."]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-accent mb-2",children:" "}),t.jsx("p",{className:"text-gray-300",children:"  (, , , )      ,    ."}),t.jsxs("div",{className:"text-xs text-gray-400 mt-2 space-y-1 bg-black/20 p-2 rounded-md",children:[t.jsxs("p",{children:[t.jsx("strong",{children:":"})," /    "]}),t.jsxs("p",{children:[t.jsx("strong",{children:":"}),"    "]}),t.jsxs("p",{children:[t.jsx("strong",{children:":"}),"    "]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold text-accent mb-2",children:"  "}),o()]})]})})},tj={normal:{name:"",color:"text-gray-300",background:"/images/equipments/normalbgi.png"},uncommon:{name:"",color:"text-green-400",background:"/images/equipments/uncommonbgi.png"},rare:{name:"",color:"text-blue-400",background:"/images/equipments/rarebgi.png"},epic:{name:"",color:"text-purple-400",background:"/images/equipments/epicbgi.png"},legendary:{name:"",color:"text-red-500",background:"/images/equipments/legendarybgi.png"},mythic:{name:"",color:"text-orange-400",background:"/images/equipments/mythicbgi.png"}},nj=e=>{if(e===0)return null;let n="";return e>=10?n="/images/equipments/Star4.png":e>=7?n="/images/equipments/Star3.png":e>=4?n="/images/equipments/Star2.png":e>=1&&(n="/images/equipments/Star1.png"),t.jsxs("div",{className:"absolute top-0.5 left-0.5 flex items-center gap-0.5 bg-black/40 rounded-br-md px-1 py-0.5 z-10",style:{textShadow:"1px 1px 2px black"},children:[t.jsx("img",{src:n,alt:"star",className:"w-3 h-3"}),t.jsx("span",{className:"font-bold text-xs leading-none",children:e})]})},sj=({item:e})=>{var s,l,r,a;const n=tj[e.grade];return t.jsxs("div",{className:"flex flex-col w-full h-full p-1 bg-black/20 rounded-lg",children:[t.jsxs("div",{className:"flex mb-2",children:[t.jsxs("div",{className:"relative w-20 h-20 rounded-lg flex-shrink-0 mr-3",children:[t.jsx("img",{src:n.background,alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-lg"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),nj(e.stars)]}),t.jsxs("div",{className:"flex-grow overflow-hidden pt-2",children:[t.jsx("h3",{className:`text-lg font-bold truncate ${n.color}`,children:e.name}),((s=e.options)==null?void 0:s.main)&&t.jsx("p",{className:"font-semibold text-yellow-300 text-sm truncate",children:e.options.main.display})]})]}),t.jsxs("div",{className:"w-full text-sm text-left space-y-1 bg-black/30 p-2 rounded-lg flex-grow overflow-y-auto",children:[((l=e.options)==null?void 0:l.combatSubs)&&e.options.combatSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.combatSubs.map((i,o)=>t.jsx("p",{className:"text-blue-300",children:i.display},`c-${o}`))}),((r=e.options)==null?void 0:r.specialSubs)&&e.options.specialSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.specialSubs.map((i,o)=>t.jsx("p",{className:"text-green-300",children:i.display},`s-${o}`))}),((a=e.options)==null?void 0:a.mythicSubs)&&e.options.mythicSubs.length>0&&t.jsx("div",{className:"space-y-0.5",children:e.options.mythicSubs.map((i,o)=>t.jsx("p",{className:"text-red-400",children:i.display},`m-${o}`))})]})]})},lj=({result:e,onClose:n})=>{const{item:s,xpGained:l,isGreatSuccess:r}=e;return t.jsx(be,{title:r?" !":" ",onClose:n,windowId:"combination-result",initialWidth:400,children:t.jsxs("div",{className:"text-center flex flex-col items-center",children:[t.jsx("div",{className:"w-full max-w-xs",children:t.jsx(sj,{item:s})}),t.jsx("div",{className:"mt-4 bg-gray-900/50 p-4 rounded-lg text-lg w-full max-w-xs",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("img",{src:"/images/equipments/moru.png",alt:" ",className:"w-5 h-5"}),"  :"]}),t.jsxs("span",{className:"font-bold text-orange-400",children:["+",l.toLocaleString()]})]})}),t.jsx(F,{onClick:n,className:"w-full mt-6 py-2.5 max-w-xs",children:""})]})})},Hu=({item:e})=>t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("div",{className:"relative w-20 h-20 mb-2",children:[t.jsx("img",{src:$a[e.grade],alt:e.grade,className:"absolute inset-0 w-full h-full object-cover rounded-md"}),e.image&&t.jsx("img",{src:e.image,alt:e.name,className:"relative w-full h-full object-contain p-1"}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 text-center text-xs font-bold text-white bg-black/50 py-0.5",children:t.jsxs("span",{className:"text-white",children:["",e.stars]})})]}),t.jsx("p",{className:`font-bold ${Pl[e.grade].color}`,children:e.name})]}),rj=({result:e,onClose:n,isTopmost:s})=>{const l=e.success?" !":" !",r=e.success?"text-green-400":"text-red-400";return t.jsx(be,{title:l,onClose:n,windowId:"enhancementResult",initialWidth:400,isTopmost:s,children:t.jsxs("div",{className:"p-4 text-center",children:[t.jsx("h3",{className:`text-xl font-bold mb-4 ${r}`,children:e.message}),t.jsxs("div",{className:"flex justify-around items-center mb-4",children:[t.jsx(Hu,{item:e.itemBefore}),t.jsx("span",{className:"text-2xl font-bold mx-4",children:e.success?"->":"X"}),t.jsx(Hu,{item:e.itemAfter})]}),t.jsx("button",{onClick:n,className:"mt-4 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-md",children:""})]})})},_r=({title:e,color:n,children:s})=>{const l=Pn.Children.toArray(s).filter(Boolean);return t.jsxs("div",{className:"flex-1 bg-gray-800/30 p-2 rounded-md flex flex-col min-h-0",children:[t.jsx("h4",{className:`text-center font-semibold mb-1 text-sm flex-shrink-0 ${n}`,children:e}),t.jsx("div",{className:"flex-grow overflow-y-auto pr-1 space-y-1 text-xs",children:l.length>0?l:t.jsx("p",{className:"text-xs text-gray-400 text-center",children:" "})})]})},aj=(e,n)=>{const s=cx[e].description;switch(e){case rt.StrategicGoldBonus:case rt.PlayfulGoldBonus:{const l=20*n.count;return t.jsx("span",{className:"w-full",children:s.replace(/20%/,`${l}%`)})}case rt.MannerActionCooldown:return t.jsxs("div",{className:"flex justify-between items-center w-full",children:[t.jsx("span",{children:s}),t.jsxs("span",{className:"font-mono font-semibold",children:["+",n.totalValue]})]});case rt.DiceGoOddBonus:case rt.AlkkagiSlowBonus:case rt.AlkkagiAimingBonus:return t.jsx("span",{className:"w-full",children:s.replace(/1/g,`${n.totalValue}`)});default:return t.jsx("span",{className:"w-full",children:s})}},ij=({onClose:e,isTopmost:n,mainOptionBonuses:s,combatSubOptionBonuses:l,specialStatBonuses:r,aggregatedMythicStats:a})=>{const i={[N.Concentration]:"",[N.ThinkingSpeed]:"",[N.Judgment]:"",[N.Calculation]:"",[N.CombatPower]:"",[N.Stability]:""},o={[ze.ActionPointMax]:" AP",[ze.ActionPointRegen]:"AP ",[ze.StrategyXpBonus]:" XP",[ze.PlayfulXpBonus]:" XP",[ze.GoldBonus]:" ",[ze.ItemDropRate]:" ",[ze.MaterialDropRate]:" "};return t.jsx(be,{title:"  ",onClose:e,windowId:"equipment-effects",initialWidth:600,isTopmost:n,children:t.jsxs("div",{className:"flex flex-col gap-4 p-2",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsx(_r,{title:" ",color:"text-yellow-300",children:Object.values(N).map(c=>{const d=s[c],u=d?`+${d.value.toFixed(d.isPercentage?1:0).replace(/\.0$/,"")}${d.isPercentage?"%":""}`:"+0";return t.jsxs("div",{className:"flex justify-between items-baseline",children:[t.jsx("span",{className:"text-gray-300",children:i[c]||c}),t.jsx("span",{className:`font-mono font-semibold text-right ${d?"":"text-gray-400"}`,children:u})]},c)})}),t.jsx(_r,{title:"  ",color:"text-blue-300",children:Object.values(N).map(c=>{const d=l[c],u=d?`+${d.value.toFixed(d.isPercentage?1:0).replace(/\.0$/,"")}${d.isPercentage?"%":""}`:"+0";return t.jsxs("div",{className:"flex justify-between items-baseline",children:[t.jsx("span",{className:"text-gray-300",children:i[c]||c}),t.jsx("span",{className:`font-mono font-semibold text-right ${d?"":"text-gray-400"}`,children:u})]},c)})})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsx(_r,{title:"  ",color:"text-green-300",children:Object.entries(r).map(([c,d])=>{if(d.flat===0&&d.percent===0)return null;const u=c,p=ox[u].name,m=o[u];return t.jsxs("div",{className:"flex justify-between items-baseline",title:p,children:[t.jsx("span",{className:"text-gray-300 truncate",children:m}),t.jsxs("span",{className:"font-mono font-semibold text-right text-green-300",children:[d.flat>0&&`+${d.flat.toFixed(0)}`,d.percent>0&&(d.flat>0?", ":"")+`+${d.percent.toFixed(1)}%`]})]},c)})}),t.jsx(_r,{title:"  ",color:"text-red-400",children:Object.entries(a).map(([c,d])=>d.count===0?null:t.jsx("div",{className:"text-red-300 text-[10px] leading-tight",children:aj(c,d)},c))})]})]})})};function oj(e){const n=f.useRef(void 0);return f.useEffect(()=>{n.current=e},[e]),n.current}const cj=()=>{const{currentUser:e,currentUserWithStatus:n,currentRoute:s,error:l,activeNegotiation:r,modals:a,showExitToast:i,enhancementResult:o,enhancementOutcome:c,handlers:d,onlineUsers:u,hasClaimableQuest:p,settings:m,mainOptionBonuses:h,combatSubOptionBonuses:y,specialStatBonuses:v,aggregatedMythicStats:b}=De(),[g,x]=f.useState(!0),[j,w]=f.useState(!1),k=oj(p);f.useEffect(()=>{if(m.features.questNotifications&&p&&!k){w(!0);const I=setTimeout(()=>w(!1),3e3);return()=>clearTimeout(I)}},[p,k,m.features.questNotifications]),f.useEffect(()=>{if(j){const I=setTimeout(()=>w(!1),3e3);return()=>clearTimeout(I)}},[j]),f.useEffect(()=>{const I=()=>{Ee.initialize(),document.removeEventListener("pointerdown",I)};return document.addEventListener("pointerdown",I),()=>{document.removeEventListener("pointerdown",I)}},[]),f.useEffect(()=>{e?Cv(Sv).then(()=>{x(!1)}):x(!1)},[e]);const C=f.useMemo(()=>{const I=[];return r&&I.push("negotiation"),a.isSettingsModalOpen&&I.push("settings"),a.isInventoryOpen&&I.push("inventory"),a.isMailboxOpen&&I.push("mailbox"),a.isQuestsOpen&&I.push("quests"),a.rewardSummary&&I.push("rewardSummary"),a.isClaimAllSummaryOpen&&I.push("claimAllSummary"),a.isShopOpen&&I.push("shop"),a.lastUsedItemResult&&I.push("itemObtained"),a.disassemblyResult&&I.push("disassemblyResult"),a.craftResult&&I.push("craftResult"),a.viewingUser&&I.push("viewingUser"),a.isInfoModalOpen&&I.push("infoModal"),a.isEncyclopediaOpen&&I.push("encyclopedia"),a.isStatAllocationModalOpen&&I.push("statAllocation"),a.isProfileEditModalOpen&&I.push("profileEdit"),a.pastRankingsInfo&&I.push("pastRankings"),a.moderatingUser&&I.push("moderatingUser"),a.viewingItem&&I.push("viewingItem"),a.enhancingItem&&I.push("enhancingItem"),a.isBlacksmithModalOpen&&I.push("blacksmith"),a.combinationResult&&I.push("combinationResult"),I},[a,r]),S=C.length>0?C[C.length-1]:null,P=s.view==="game",_=e?"bg-primary":"bg-login-background";return t.jsxs("div",{className:`font-sans ${_} text-primary h-full flex flex-col`,children:[g&&t.jsxs("div",{className:"fixed inset-0 bg-tertiary z-[100] flex flex-col items-center justify-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-primary"}),t.jsx("p",{className:"mt-4 text-primary",children:"  ..."})]}),l&&t.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 w-full max-w-md z-50 animate-slide-down",children:t.jsx("div",{className:"bg-danger border-2 border-red-500 rounded-lg shadow-2xl p-4 text-white font-bold text-center",children:l})}),j&&t.jsx("div",{onClick:()=>{d.openQuests(),w(!1)},className:"fixed top-20 right-4 w-full max-w-xs z-50 animate-slide-in-right cursor-pointer",children:t.jsx("div",{className:"bg-success border-2 border-green-400 rounded-lg shadow-2xl p-4 text-white font-bold text-center",children:"   !"})}),o&&!a.enhancingItem&&t.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 w-full max-w-md z-50 animate-slide-down",children:t.jsx("div",{className:`${o.success?"bg-accent border-accent":"bg-danger border-red-500"} border-2 rounded-lg shadow-2xl p-4 text-white font-bold text-center`,children:o.message})}),i&&t.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 w-full max-w-md z-50 animate-slide-down-fast",children:t.jsx("div",{className:"bg-primary border-2 border-color rounded-lg shadow-2xl p-3 text-primary font-semibold text-center",children:"     ."})}),e&&!P&&t.jsx(w0,{}),e?t.jsx("main",{className:"flex-1 flex flex-col min-h-0",children:t.jsx(Lu,{})}):t.jsxs("div",{className:"relative h-full w-full flex flex-col items-center justify-center p-4 sm:p-8 bg-tertiary bg-[url('/images/bg/loginbg.png')] bg-cover bg-center",children:[t.jsx("div",{className:"absolute inset-0 bg-black/60"}),t.jsxs("header",{className:"relative text-center z-10 pt-8 md:pt-16 mb-8",children:[t.jsx("h1",{className:"text-4xl sm:text-5xl md:text-6xl font-black text-white tracking-widest uppercase title-glow-secondary",style:{fontFamily:"serif"},children:"SUDAM"}),t.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white tracking-wider mt-2 title-glow-secondary",style:{fontFamily:"serif"},children:"The Ascending Masters"}),t.jsxs("p",{className:"mt-4 text-xs sm:text-sm text-gray-300",children:["Supreme Universe of Dueling Ascending Masters (S.U.D.A.M)",t.jsx("br",{}),"(    )"]})]}),t.jsx("main",{className:"relative flex-1 flex flex-col min-h-0 z-10",children:t.jsx(Lu,{})})]}),n&&t.jsxs(t.Fragment,{children:[a.isSettingsModalOpen&&t.jsx(Tv,{onClose:d.closeSettingsModal,isTopmost:S==="settings"}),a.isInventoryOpen&&t.jsx(Gb,{currentUser:n,onClose:d.closeInventory,onAction:d.handleAction,onStartEnhance:d.openEnhancingItem,enhancementAnimationTarget:a.enhancementAnimationTarget,onAnimationComplete:d.clearEnhancementAnimation,isTopmost:S==="inventory"}),a.isMailboxOpen&&t.jsx(Vb,{currentUser:n,onClose:d.closeMailbox,onAction:d.handleAction,isTopmost:S==="mailbox"}),a.isQuestsOpen&&t.jsx(Qb,{currentUser:n,onClose:d.closeQuests,onAction:d.handleAction,isTopmost:S==="quests"}),a.rewardSummary&&t.jsx(jv,{summary:a.rewardSummary,onClose:d.closeRewardSummary,isTopmost:S==="rewardSummary"}),a.isClaimAllSummaryOpen&&a.claimAllSummary&&t.jsx(Gu,{summary:a.claimAllSummary,onClose:d.closeClaimAllSummary,isTopmost:S==="claimAllSummary"}),a.isShopOpen&&t.jsx(Zb,{currentUser:n,onClose:d.closeShop,onAction:d.handleAction,isTopmost:S==="shop"}),a.lastUsedItemResult&&a.lastUsedItemResult.length===1&&t.jsx(xv,{item:a.lastUsedItemResult[0],onClose:d.closeItemObtained,isTopmost:S==="itemObtained"}),a.lastUsedItemResult&&a.lastUsedItemResult.length>1&&t.jsx(hv,{items:a.lastUsedItemResult,onClose:d.closeItemObtained,isTopmost:S==="itemObtained"}),a.disassemblyResult&&t.jsx(Ax,{result:a.disassemblyResult,onClose:d.closeDisassemblyResult,isTopmost:S==="disassemblyResult"}),a.craftResult&&t.jsx(Iv,{result:a.craftResult,onClose:d.closeCraftResult,isTopmost:S==="craftResult"}),a.viewingUser&&t.jsx(sv,{user:a.viewingUser,onClose:d.closeViewingUser,onViewItem:d.openViewingItem,isTopmost:S==="viewingUser"}),a.isInfoModalOpen&&t.jsx(lv,{onClose:d.closeInfoModal,isTopmost:S==="infoModal"}),a.isEncyclopediaOpen&&t.jsx(yv,{onClose:d.closeEncyclopedia,isTopmost:S==="encyclopedia"}),a.isStatAllocationModalOpen&&t.jsx(rv,{currentUser:n,onClose:d.closeStatAllocationModal,onAction:d.handleAction,isTopmost:S==="statAllocation"}),a.isProfileEditModalOpen&&t.jsx(cv,{currentUser:n,onClose:d.closeProfileEditModal,onAction:d.handleAction,isTopmost:S==="profileEdit"}),a.pastRankingsInfo&&t.jsx(bv,{info:a.pastRankingsInfo,onClose:d.closePastRankings,isTopmost:S==="pastRankings"}),a.moderatingUser&&t.jsx(vv,{user:a.moderatingUser,currentUser:n,onClose:d.closeModerationModal,onAction:d.handleAction,isTopmost:S==="moderatingUser"}),a.viewingItem&&t.jsx(ov,{item:a.viewingItem.item,isOwnedByCurrentUser:a.viewingItem.isOwnedByCurrentUser,onClose:d.closeViewingItem,onStartEnhance:d.openEnhancementFromDetail,isTopmost:S==="viewingItem"}),r&&t.jsx(Cx,{negotiation:r,currentUser:n,onAction:d.handleAction,onlineUsers:u,isTopmost:S==="negotiation"}),a.isMbtiInfoModalOpen&&t.jsx(So,{onClose:d.closeMbtiInfoModal,isTopmost:S==="mbtiInfo"}),a.isBlacksmithModalOpen&&t.jsx(Xv,{onClose:d.closeBlacksmithModal,isTopmost:S==="blacksmith",selectedItemForEnhancement:a.blacksmithSelectedItemForEnhancement,activeTab:a.blacksmithActiveTab,onSetActiveTab:d.setBlacksmithActiveTab,enhancementOutcome:c}),a.combinationResult&&t.jsx(lj,{result:a.combinationResult,onClose:d.closeCombinationResult,isTopmost:S==="combinationResult"}),a.isBlacksmithHelpOpen&&t.jsx(ej,{onClose:d.closeBlacksmithHelp,isTopmost:S==="blacksmithHelp",currentUser:n}),a.isEnhancementResultModalOpen&&c&&t.jsx(rj,{result:c,onClose:d.closeEnhancementModal,isTopmost:S==="enhancementResult"}),a.isClaimAllSummaryOpen&&a.claimAllSummary&&t.jsx(Gu,{summary:a.claimAllSummary,onClose:d.closeClaimAllSummary,isTopmost:S==="claimAllSummary"}),a.isMbtiInfoModalOpen&&t.jsx(So,{onClose:d.closeMbtiInfoModal,isTopmost:S==="mbtiInfo"}),a.isEquipmentEffectsModalOpen&&t.jsx(ij,{onClose:d.closeEquipmentEffectsModal,isTopmost:S==="equipmentEffects",mainOptionBonuses:h,combatSubOptionBonuses:y,specialStatBonuses:v,aggregatedMythicStats:b})]})]})},dj=()=>t.jsx("div",{className:"app-container",children:t.jsx(v0,{children:t.jsx(cj,{})})}),Lx=document.getElementById("root");if(!Lx)throw new Error("Could not find root element to mount to");const uj=Pi.createRoot(Lx);uj.render(t.jsx(Pn.StrictMode,{children:t.jsx(dj,{})}));
